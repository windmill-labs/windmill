"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.db = exports.types = void 0;
const tslib_1 = require("tslib");
// Copyright 2018-2024 the Deno authors. All rights reserved. MIT license.
const mime_db_v1_52_0_js_1 = tslib_1.__importDefault(require("./vendor/mime-db.v1.52.0.js"));
exports.db = mime_db_v1_52_0_js_1.default;
const _util_js_1 = require("./_util.js");
/** A map of the media type for a given extension */
exports.types = new Map();
/** Internal function to populate the maps based on the Mime DB. */
(function populateMaps() {
    const preference = ["nginx", "apache", undefined, "iana"];
    for (const type of Object.keys(mime_db_v1_52_0_js_1.default)) {
        const mime = mime_db_v1_52_0_js_1.default[type];
        const exts = mime.extensions;
        if (!exts || !exts.length) {
            continue;
        }
        // @ts-ignore work around denoland/dnt#148
        _util_js_1.extensions.set(type, exts);
        for (const ext of exts) {
            const current = exports.types.get(ext);
            if (current) {
                const from = preference.indexOf(mime_db_v1_52_0_js_1.default[current].source);
                const to = preference.indexOf(mime.source);
                if (current !== "application/octet-stream" &&
                    (from > to ||
                        // @ts-ignore work around denoland/dnt#148
                        (from === to && current.startsWith("application/")))) {
                    continue;
                }
            }
            exports.types.set(ext, type);
        }
    }
})();
