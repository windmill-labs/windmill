{"version":3,"file":"index.js","sources":["../../../dialog/browser/index.ts"],"sourcesContent":["import CancelButton from \"./CancelButton.ts\";\nimport Dialog, { closeDialog } from \"./Dialog.ts\";\nimport Footer from \"./Footer.ts\";\nimport Input from \"./Input.ts\";\nimport OkButton from \"./OkButton.ts\";\nimport Progress from \"./Progress.ts\";\nimport Text from \"./Text.ts\";\nexport async function alertInBrowser(message) {\n    await new Promise(resolve => {\n        document.body.appendChild(Dialog({\n            onCancel: () => resolve(),\n            onOk: () => resolve(),\n        }, Text(message), Footer(OkButton())));\n    });\n}\nexport async function confirmInBrowser(message) {\n    return new Promise(resolve => {\n        document.body.appendChild(Dialog({\n            onCancel: () => resolve(false),\n            onOk: () => resolve(true),\n        }, Text(message), Footer(CancelButton(), OkButton())));\n    });\n}\nexport async function promptInBrowser(message, options) {\n    const { type, defaultValue } = options;\n    return new Promise(resolve => {\n        document.body.appendChild(Dialog({\n            onCancel: () => resolve(null),\n            onOk: (dialog) => {\n                const input = dialog.querySelector(\"input\");\n                resolve(input.value);\n            },\n        }, Text(message), Input({ type, value: defaultValue }), Footer(CancelButton(), OkButton())));\n    });\n}\nexport async function progressInBrowser(message, fn, options) {\n    const { signal, abort, listenForAbort } = options;\n    const text = Text(message);\n    const { element: progressBar, setValue } = Progress();\n    const dialog = Dialog({ onCancel: abort }, text);\n    const set = (state) => {\n        if (signal.aborted) {\n            return;\n        }\n        if (state.message) {\n            text.innerHTML = state.message.replace(/ /g, \"&nbsp;\").replace(/\\n/g, \"<br />\");\n        }\n        if (state.percent !== undefined) {\n            setValue(state.percent);\n        }\n    };\n    if (abort) {\n        dialog.appendChild(Footer(progressBar, CancelButton()));\n    }\n    else {\n        dialog.appendChild(progressBar);\n    }\n    document.body.appendChild(dialog);\n    let job = fn(set, signal);\n    if (listenForAbort) {\n        job = Promise.race([job, listenForAbort()]);\n    }\n    try {\n        return await job;\n    }\n    finally {\n        signal.aborted || closeDialog(dialog, \"OK\");\n    }\n}\n//# sourceMappingURL=index.js.map"],"names":["Dialog","Text","Footer","OkButton","CancelButton","Input","Progress","closeDialog"],"mappings":";;;;;;;;;;AAOO,eAAe,cAAc,CAAC,OAAO,EAAE;AAC9C,IAAI,MAAM,IAAI,OAAO,CAAC,OAAO,IAAI;AACjC,QAAQ,QAAQ,CAAC,IAAI,CAAC,WAAW,CAACA,6BAAM,CAAC;AACzC,YAAY,QAAQ,EAAE,MAAM,OAAO,EAAE;AACrC,YAAY,IAAI,EAAE,MAAM,OAAO,EAAE;AACjC,SAAS,EAAEC,2BAAI,CAAC,OAAO,CAAC,EAAEC,6BAAM,CAACC,+BAAQ,EAAE,CAAC,CAAC,CAAC,CAAC;AAC/C,KAAK,CAAC,CAAC;AACP,CAAC;AACM,eAAe,gBAAgB,CAAC,OAAO,EAAE;AAChD,IAAI,OAAO,IAAI,OAAO,CAAC,OAAO,IAAI;AAClC,QAAQ,QAAQ,CAAC,IAAI,CAAC,WAAW,CAACH,6BAAM,CAAC;AACzC,YAAY,QAAQ,EAAE,MAAM,OAAO,CAAC,KAAK,CAAC;AAC1C,YAAY,IAAI,EAAE,MAAM,OAAO,CAAC,IAAI,CAAC;AACrC,SAAS,EAAEC,2BAAI,CAAC,OAAO,CAAC,EAAEC,6BAAM,CAACE,mCAAY,EAAE,EAAED,+BAAQ,EAAE,CAAC,CAAC,CAAC,CAAC;AAC/D,KAAK,CAAC,CAAC;AACP,CAAC;AACM,eAAe,eAAe,CAAC,OAAO,EAAE,OAAO,EAAE;AACxD,IAAI,MAAM,EAAE,IAAI,EAAE,YAAY,EAAE,GAAG,OAAO,CAAC;AAC3C,IAAI,OAAO,IAAI,OAAO,CAAC,OAAO,IAAI;AAClC,QAAQ,QAAQ,CAAC,IAAI,CAAC,WAAW,CAACH,6BAAM,CAAC;AACzC,YAAY,QAAQ,EAAE,MAAM,OAAO,CAAC,IAAI,CAAC;AACzC,YAAY,IAAI,EAAE,CAAC,MAAM,KAAK;AAC9B,gBAAgB,MAAM,KAAK,GAAG,MAAM,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;AAC5D,gBAAgB,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;AACrC,aAAa;AACb,SAAS,EAAEC,2BAAI,CAAC,OAAO,CAAC,EAAEI,4BAAK,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,YAAY,EAAE,CAAC,EAAEH,6BAAM,CAACE,mCAAY,EAAE,EAAED,+BAAQ,EAAE,CAAC,CAAC,CAAC,CAAC;AACrG,KAAK,CAAC,CAAC;AACP,CAAC;AACM,eAAe,iBAAiB,CAAC,OAAO,EAAE,EAAE,EAAE,OAAO,EAAE;AAC9D,IAAI,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,cAAc,EAAE,GAAG,OAAO,CAAC;AACtD,IAAI,MAAM,IAAI,GAAGF,2BAAI,CAAC,OAAO,CAAC,CAAC;AAC/B,IAAI,MAAM,EAAE,OAAO,EAAE,WAAW,EAAE,QAAQ,EAAE,GAAGK,+BAAQ,EAAE,CAAC;AAC1D,IAAI,MAAM,MAAM,GAAGN,6BAAM,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,EAAE,IAAI,CAAC,CAAC;AACrD,IAAI,MAAM,GAAG,GAAG,CAAC,KAAK,KAAK;AAC3B,QAAQ,IAAI,MAAM,CAAC,OAAO,EAAE;AAC5B,YAAY,OAAO;AACnB,SAAS;AACT,QAAQ,IAAI,KAAK,CAAC,OAAO,EAAE;AAC3B,YAAY,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC,OAAO,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;AAC5F,SAAS;AACT,QAAQ,IAAI,KAAK,CAAC,OAAO,KAAK,SAAS,EAAE;AACzC,YAAY,QAAQ,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;AACpC,SAAS;AACT,KAAK,CAAC;AACN,IAAI,IAAI,KAAK,EAAE;AACf,QAAQ,MAAM,CAAC,WAAW,CAACE,6BAAM,CAAC,WAAW,EAAEE,mCAAY,EAAE,CAAC,CAAC,CAAC;AAChE,KAAK;AACL,SAAS;AACT,QAAQ,MAAM,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;AACxC,KAAK;AACL,IAAI,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;AACtC,IAAI,IAAI,GAAG,GAAG,EAAE,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;AAC9B,IAAI,IAAI,cAAc,EAAE;AACxB,QAAQ,GAAG,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC,GAAG,EAAE,cAAc,EAAE,CAAC,CAAC,CAAC;AACpD,KAAK;AACL,IAAI,IAAI;AACR,QAAQ,OAAO,MAAM,GAAG,CAAC;AACzB,KAAK;AACL,YAAY;AACZ,QAAQ,MAAM,CAAC,OAAO,IAAIG,iCAAW,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;AACpD,KAAK;AACL;;;;;;;"}