{"version":3,"file":"server.js","sources":["../../http/server.ts"],"sourcesContent":["var _a, _b, _c;\nimport { until } from \"../async.ts\";\nimport { isBun, isDeno, isNode } from \"../env.ts\";\nimport runtime, { env } from \"../runtime.ts\";\nimport { createRequestContext, createTimingFunctions, listenFetchEvent, withHeaders, patchTimingMetrics } from \"./internal.ts\";\nconst _hostname = Symbol.for(\"hostname\");\nconst _port = Symbol.for(\"port\");\nconst _http = Symbol.for(\"http\");\nconst _controller = Symbol.for(\"controller\");\n/**\n * A unified HTTP server interface.\n */\nexport class Server {\n    constructor(impl, options) {\n        var _d, _e, _f;\n        this[_a] = \"0.0.0.0\";\n        this[_b] = 0;\n        this[_c] = null;\n        this.type = (_d = options.type) !== null && _d !== void 0 ? _d : \"classic\";\n        const { fetch: handle, ws, headers, secure } = options;\n        const onError = (_e = options.onError) !== null && _e !== void 0 ? _e : ((err) => {\n            console.error(err);\n            return new Response(\"Internal Server Error\", {\n                status: 500,\n                statusText: \"Internal Server Error\",\n            });\n        });\n        const defaultOnListen = ({ hostname, port }) => {\n            const _hostname = hostname === \"0.0.0.0\" ? \"localhost\" : hostname;\n            const protocol = secure ? \"https\" : \"http\";\n            console.log(`Server listening on ${protocol}://${_hostname}:${port}`);\n        };\n        const onListen = this.type === \"classic\"\n            ? ((_f = options.onListen) !== null && _f !== void 0 ? _f : defaultOnListen)\n            : defaultOnListen;\n        this[_http] = impl().then(({ http, hostname, port, controller }) => {\n            this[_hostname] = hostname;\n            this[_port] = port;\n            this[_controller] = controller;\n            if (http || isBun) {\n                onListen({ hostname, port });\n            }\n            return http;\n        });\n        if (isDeno) {\n            if (this.type === \"classic\") {\n                delete this.fetch;\n            }\n            else {\n                this.fetch = (req) => {\n                    const { getTimers, time, timeEnd } = createTimingFunctions();\n                    const ctx = createRequestContext(req, {\n                        ws,\n                        remoteAddress: null,\n                        time,\n                        timeEnd,\n                    });\n                    const _handle = withHeaders(handle, headers);\n                    const _onError = withHeaders(onError, headers);\n                    return _handle(req, ctx)\n                        .then(res => patchTimingMetrics(res, getTimers()))\n                        .catch(err => _onError(err, req, ctx));\n                };\n            }\n        }\n        else if (isBun) {\n            if (this.type === \"classic\") {\n                delete this.fetch;\n            }\n            else {\n                this.fetch = (req, server) => {\n                    ws.bunBind(server);\n                    const { getTimers, time, timeEnd } = createTimingFunctions();\n                    const ctx = createRequestContext(req, {\n                        ws,\n                        remoteAddress: server.requestIP(req),\n                        time,\n                        timeEnd,\n                    });\n                    const _handle = withHeaders(handle, headers);\n                    const _onError = withHeaders(onError, headers);\n                    return _handle(req, ctx)\n                        .then(res => patchTimingMetrics(res, getTimers()))\n                        .catch(err => _onError(err, req, ctx));\n                };\n                Object.assign(this, {\n                    // Bun specific properties\n                    websocket: ws.bunListener,\n                });\n            }\n        }\n        else if (isNode) {\n            if (this.type === \"classic\") {\n                delete this.fetch;\n            }\n            else {\n                this.fetch = (req, ctx) => {\n                    const _handle = withHeaders(handle, headers);\n                    const _onError = withHeaders(onError, headers);\n                    return _handle(req, ctx)\n                        .catch(err => _onError(err, req, ctx));\n                };\n            }\n        }\n        else if (typeof addEventListener === \"function\") {\n            if (this.type === \"classic\") {\n                let bindings;\n                if (runtime().identity === \"workerd\") {\n                    bindings = {};\n                    Object.keys(globalThis).forEach((key) => {\n                        if (/^[A-Z][A-Z0-9_]*$/.test(key)) {\n                            // @ts-ignore\n                            bindings[key] = globalThis[key];\n                        }\n                    });\n                    env(bindings);\n                }\n                listenFetchEvent({ ws, fetch: handle, onError, headers, bindings });\n            }\n            else {\n                this.fetch = (req, bindings, _ctx) => {\n                    var _d;\n                    if (bindings && typeof bindings === \"object\" && !Array.isArray(bindings)) {\n                        env(bindings);\n                    }\n                    const address = req.headers.get(\"cf-connecting-ip\");\n                    const { getTimers, time, timeEnd } = createTimingFunctions();\n                    const ctx = createRequestContext(req, {\n                        ws,\n                        remoteAddress: address ? {\n                            family: address.includes(\":\") ? \"IPv6\" : \"IPv4\",\n                            address: address,\n                            port: 0,\n                        } : null,\n                        time,\n                        timeEnd,\n                        waitUntil: (_d = _ctx.waitUntil) === null || _d === void 0 ? void 0 : _d.bind(_ctx),\n                        bindings,\n                    });\n                    const _handle = withHeaders(handle, headers);\n                    const _onError = withHeaders(onError, headers);\n                    return _handle(req, ctx)\n                        .then(res => patchTimingMetrics(res, getTimers()))\n                        .catch(err => _onError(err, req, ctx));\n                };\n            }\n        }\n    }\n    /**\n     * The hostname of which the server is listening on, only available after\n     * the server is ready and the server type is `classic`.\n     */\n    get hostname() {\n        return this[_hostname] || \"\";\n    }\n    /**\n     * The port of which the server is listening on, only available after the\n     * server is ready and the server type is `classic`.\n     */\n    get port() {\n        return this[_port] || (isBun && this.type === \"module\" ? 3000 : 0);\n    }\n    /**\n     * A promise that resolves when the server is ready to accept connections.\n     */\n    get ready() {\n        return this[_http].then(() => this);\n    }\n    /**\n     * Closes the server and stops it from accepting new connections. By default,\n     * this function will wait until all active connections to close before\n     * shutting down the server. However, we can force the server to close all\n     * active connections and shutdown immediately by setting the `force`\n     * parameter to `true`.\n     *\n     * NOTE: In Node.js, the `force` parameter is only available for HTTP\n     * servers, it has no effect on HTTP2 servers.\n     */\n    async close(force = false) {\n        const server = await this[_http];\n        if (!server)\n            return;\n        if (typeof server.stop === \"function\") {\n            const _server = server;\n            _server.stop(force);\n            if (!force) {\n                await until(() => !_server.pendingRequests && !_server.pendingWebSockets);\n            }\n        }\n        else if (typeof server.shutdown === \"function\") {\n            const _server = server;\n            if (force && this[_controller]) {\n                this[_controller].abort();\n            }\n            else {\n                _server.shutdown();\n            }\n            await _server.finished;\n        }\n        else if (typeof server.close === \"function\") {\n            const _server = server;\n            await new Promise((resolve, reject) => {\n                _server.close((err) => err ? reject(err) : resolve());\n                if (force && \"closeAllConnections\" in _server) {\n                    _server.closeAllConnections();\n                }\n            });\n        }\n    }\n    /**\n     * Opposite of `unref()`, calling `ref()` on a previously `unref`ed server\n     * will _not_ let the program exit if it's the only server left (the default\n     * behavior). If the server is `ref`ed calling `ref()` again will have no\n     * effect.\n     */\n    ref() {\n        this[_http].then(server => { var _d; return (_d = server === null || server === void 0 ? void 0 : server.ref) === null || _d === void 0 ? void 0 : _d.call(server); });\n    }\n    /**\n     * Calling `unref()` on a server will allow the program to exit if this is\n     * the only active server in the event system. If the server is already\n     * `unref`ed calling`unref()` again will have no effect.\n     */\n    unref() {\n        this[_http].then(server => { var _d; return (_d = server === null || server === void 0 ? void 0 : server.unref) === null || _d === void 0 ? void 0 : _d.call(server); });\n    }\n}\n_a = _hostname, _b = _port, _c = _controller;\n//# sourceMappingURL=server.js.map"],"names":["isBun","isDeno","createTimingFunctions","createRequestContext","withHeaders","patchTimingMetrics","isNode","runtime","env","listenFetchEvent","until"],"mappings":"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"}