{"version":3,"file":"util.js","sources":["../../reader/util.ts"],"sourcesContent":["import chan from \"../chan.ts\";\nimport { fromErrorEvent } from \"../error.ts\";\nfunction isFunction(val) {\n    return typeof val === \"function\";\n}\nasync function* resolveAsyncIterable(promise) {\n    const stream = await promise;\n    const reader = stream.getReader();\n    try {\n        while (true) {\n            const { done, value } = await reader.read();\n            if (done) {\n                break;\n            }\n            yield value;\n        }\n    }\n    finally {\n        reader.releaseLock();\n    }\n}\nexport function resolveReadableStream(promise) {\n    const { readable, writable } = new TransformStream();\n    promise.then(stream => stream.pipeTo(writable));\n    return readable;\n}\n/**\n * If the given `promise` resolves to a `ReadableStream<Uint8Array>`, this\n * function will return a new `ReadableStream<Uint8Array>` object that can be\n * used to read the byte stream without the need to wait for the promise to\n * resolve.\n *\n * This function is optimized for zero-copy read, so it's recommended to use\n * this function when the source stream is a byte stream.\n */\nexport function resolveByteStream(promise) {\n    let reader;\n    return new ReadableStream({\n        type: \"bytes\",\n        async start() {\n            const source = await promise;\n            try { // zero-copy read from the source stream\n                reader = source.getReader({ mode: \"byob\" });\n            }\n            catch (_a) {\n                reader = source.getReader();\n            }\n        },\n        async pull(controller) {\n            var _a;\n            try {\n                let request;\n                let view;\n                let result;\n                if (\"byobRequest\" in controller && ((_a = controller.byobRequest) === null || _a === void 0 ? void 0 : _a.view)) {\n                    // This stream is requested for zero-copy read.\n                    request = controller.byobRequest;\n                    view = request.view;\n                }\n                else if (reader instanceof ReadableStreamBYOBReader) {\n                    view = new Uint8Array(4096);\n                }\n                if (reader instanceof ReadableStreamBYOBReader) {\n                    // The source stream supports zero-copy read, we can read its\n                    // data directly into the request view's buffer.\n                    result = await reader.read(view);\n                }\n                else {\n                    // The source stream does not support zero-copy read, we need to\n                    // copy its data to a new buffer.\n                    result = await reader.read();\n                }\n                if (request) {\n                    if (result.done) {\n                        controller.close();\n                        // The final chunk may be empty, but still needs to be\n                        // responded in order to close the request reader.\n                        if (result.value !== undefined) {\n                            request.respondWithNewView(result.value);\n                        }\n                        else {\n                            request.respond(0);\n                        }\n                    }\n                    else if (reader instanceof ReadableStreamBYOBReader\n                        || (view && result.value.buffer.byteLength === view.buffer.byteLength)) {\n                        // Respond to the request reader with the same underlying\n                        // buffer of the source stream.\n                        // Or the source stream doesn't support zero-copy read, but\n                        // the result bytes has the same buffer size as the request\n                        // view.\n                        request.respondWithNewView(result.value);\n                    }\n                    else {\n                        // This stream is requested for zero-copy read, but the\n                        // source stream doesn't support it. We need to copy and\n                        // deliver the new buffer instead.\n                        controller.enqueue(result.value);\n                    }\n                }\n                else {\n                    if (result.done) {\n                        controller.close();\n                    }\n                    else {\n                        controller.enqueue(result.value);\n                    }\n                }\n            }\n            catch (err) {\n                reader.releaseLock();\n                controller.error(err);\n            }\n        },\n        cancel(reason = undefined) {\n            reader.cancel(reason);\n            reader.releaseLock();\n        },\n    });\n}\n/**\n * Converts the given `source` into an `AsyncIterable` object if it's not one\n * already, returns `null` if failed.\n */\nexport function asAsyncIterable(source) {\n    if (typeof source[Symbol.asyncIterator] === \"function\") {\n        return source;\n    }\n    else if (typeof source[Symbol.iterator] === \"function\") {\n        return {\n            [Symbol.asyncIterator]: async function* () {\n                for (const value of source) {\n                    yield value;\n                }\n            },\n        };\n    }\n    else if (typeof ReadableStream === \"function\"\n        && source instanceof ReadableStream) {\n        const reader = source.getReader();\n        return {\n            [Symbol.asyncIterator]: async function* () {\n                try {\n                    while (true) {\n                        const { done, value } = await reader.read();\n                        if (done) {\n                            break;\n                        }\n                        yield value;\n                    }\n                }\n                catch (err) {\n                    reader.cancel(err);\n                }\n                finally {\n                    reader.releaseLock();\n                }\n            },\n        };\n    }\n    else if (typeof source[\"then\"] === \"function\") {\n        return resolveAsyncIterable(source);\n    }\n    return null;\n}\nexport function toAsyncIterable(source, eventMap = undefined) {\n    var _a;\n    const iterable = asAsyncIterable(source);\n    if (iterable) {\n        return iterable;\n    }\n    const channel = chan(Infinity);\n    const handleMessage = channel.send.bind(channel);\n    const handleClose = channel.close.bind(channel);\n    const handleBrowserErrorEvent = (ev) => {\n        let err;\n        if (typeof ErrorEvent === \"function\" && ev instanceof ErrorEvent) {\n            err = ev.error || fromErrorEvent(ev);\n        }\n        else {\n            // @ts-ignore\n            err = new Error(\"something went wrong\", { cause: ev });\n        }\n        handleClose(err);\n    };\n    const proto = Object.getPrototypeOf(source);\n    const msgDesc = Object.getOwnPropertyDescriptor(proto, \"onmessage\");\n    if ((msgDesc === null || msgDesc === void 0 ? void 0 : msgDesc.set) && isFunction(source[\"close\"])) { // WebSocket or EventSource\n        const errDesc = Object.getOwnPropertyDescriptor(proto, \"onerror\");\n        const closeDesc = Object.getOwnPropertyDescriptor(proto, \"onclose\");\n        let cleanup;\n        if ((eventMap === null || eventMap === void 0 ? void 0 : eventMap.event) &&\n            (eventMap === null || eventMap === void 0 ? void 0 : eventMap.event) !== \"message\" &&\n            isFunction(source[\"addEventListener\"])) { // for EventSource listening on custom events\n            const es = source;\n            const eventName = eventMap.event;\n            const msgListener = (ev) => {\n                handleMessage(ev.data);\n            };\n            es.addEventListener(eventName, msgListener);\n            cleanup = () => {\n                es.removeEventListener(eventName, msgListener);\n            };\n        }\n        else {\n            msgDesc.set.call(source, (ev) => {\n                handleMessage(ev.data);\n            });\n            cleanup = () => {\n                var _a;\n                (_a = msgDesc.set) === null || _a === void 0 ? void 0 : _a.call(source, null);\n            };\n        }\n        (_a = errDesc === null || errDesc === void 0 ? void 0 : errDesc.set) === null || _a === void 0 ? void 0 : _a.call(source, handleBrowserErrorEvent);\n        if (closeDesc === null || closeDesc === void 0 ? void 0 : closeDesc.set) { // WebSocket\n            closeDesc.set.call(source, () => {\n                var _a, _b;\n                handleClose();\n                (_a = closeDesc.set) === null || _a === void 0 ? void 0 : _a.call(source, null);\n                (_b = errDesc === null || errDesc === void 0 ? void 0 : errDesc.set) === null || _b === void 0 ? void 0 : _b.call(source, null);\n                cleanup === null || cleanup === void 0 ? void 0 : cleanup();\n            });\n        }\n        else if (!(closeDesc === null || closeDesc === void 0 ? void 0 : closeDesc.set) && isFunction(source[\"close\"])) { // EventSource\n            // EventSource by default does not trigger close event, we need to\n            // make sure when it calls the close() function, the iterator is\n            // automatically closed.\n            const es = source;\n            const _close = es.close;\n            Object.defineProperty(es, \"close\", {\n                configurable: true,\n                writable: true,\n                value: function close() {\n                    var _a;\n                    _close.call(es);\n                    handleClose();\n                    Object.defineProperty(es, \"close\", {\n                        configurable: true,\n                        writable: true,\n                        value: _close,\n                    });\n                    (_a = errDesc === null || errDesc === void 0 ? void 0 : errDesc.set) === null || _a === void 0 ? void 0 : _a.call(source, null);\n                    cleanup === null || cleanup === void 0 ? void 0 : cleanup();\n                }\n            });\n        }\n    }\n    else if (isFunction(source[\"send\"]) && isFunction(source[\"close\"])) {\n        // non-standard WebSocket implementation or WebSocket-like object\n        const ws = source;\n        if (typeof ws.addEventListener === \"function\") {\n            const msgListener = (ev) => {\n                handleMessage(ev.data);\n            };\n            ws.addEventListener(\"message\", msgListener);\n            ws.addEventListener(\"error\", handleBrowserErrorEvent);\n            ws.addEventListener(\"close\", () => {\n                handleClose();\n                ws.removeEventListener(\"message\", msgListener);\n                ws.removeEventListener(\"error\", handleBrowserErrorEvent);\n            });\n        }\n        else {\n            ws.onmessage = (ev) => {\n                handleMessage(ev.data);\n            };\n            ws.onerror = handleBrowserErrorEvent;\n            ws.onclose = () => {\n                handleClose();\n                ws.onclose = null;\n                ws.onerror = null;\n                ws.onmessage = null;\n            };\n        }\n    }\n    else if (isFunction(source[\"addEventListener\"])) { // EventTarget\n        const target = source;\n        const msgEvent = (eventMap === null || eventMap === void 0 ? void 0 : eventMap.message) || \"message\";\n        const errEvent = (eventMap === null || eventMap === void 0 ? void 0 : eventMap.error) || \"error\";\n        const closeEvent = (eventMap === null || eventMap === void 0 ? void 0 : eventMap.close) || \"close\";\n        const msgListener = (ev) => {\n            if (ev instanceof MessageEvent) {\n                handleMessage(ev.data);\n            }\n        };\n        target.addEventListener(msgEvent, msgListener);\n        target.addEventListener(errEvent, handleBrowserErrorEvent);\n        target.addEventListener(closeEvent, function closeListener() {\n            handleClose();\n            target.removeEventListener(closeEvent, closeListener);\n            target.removeEventListener(msgEvent, msgListener);\n            target.removeEventListener(errEvent, handleBrowserErrorEvent);\n        });\n    }\n    else if (isFunction(source[\"on\"])) { // EventEmitter\n        const target = source;\n        let dataEvent;\n        let errEvent;\n        let closeEvent;\n        if (typeof process === \"object\" && source === process) {\n            dataEvent = \"message\";\n            errEvent = \"uncaughtException\";\n            closeEvent = \"exit\";\n        }\n        else if ((isFunction(source[\"send\"]) && isFunction(source[\"kill\"])) || // child process\n            (isFunction(source[\"postMessage\"]) && isFunction(source[\"terminate\"])) || // worker thread\n            (isFunction(source[\"postMessage\"]) && isFunction(source[\"close\"])) // message port\n        ) {\n            dataEvent = \"message\";\n            errEvent = \"error\";\n            closeEvent = \"exit\";\n        }\n        else {\n            dataEvent = (eventMap === null || eventMap === void 0 ? void 0 : eventMap.data) || \"data\";\n            errEvent = (eventMap === null || eventMap === void 0 ? void 0 : eventMap.error) || \"error\";\n            closeEvent = (eventMap === null || eventMap === void 0 ? void 0 : eventMap.close) || \"close\";\n        }\n        target.on(dataEvent, handleMessage);\n        target.once(errEvent, handleClose);\n        target.once(closeEvent, () => {\n            handleClose();\n            target.off(dataEvent, handleMessage);\n            target.off(errEvent, handleClose);\n        });\n    }\n    else {\n        throw new TypeError(\"The  source cannot be converted to an async iterable object.\");\n    }\n    return {\n        [Symbol.asyncIterator]: channel[Symbol.asyncIterator].bind(channel),\n    };\n}\n//# sourceMappingURL=util.js.map"],"names":[],"mappings":"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"}