{"version":3,"file":"util.js","sources":["../util.ts"],"sourcesContent":["/**\n * Converts the given `source` into an `AsyncIterable` object if it's not one\n * already, returns `null` if failed.\n */\nexport function asAsyncIterable(source) {\n    if (typeof source[Symbol.asyncIterator] === \"function\") {\n        return source;\n    }\n    else if (typeof source[Symbol.iterator] === \"function\") {\n        return {\n            [Symbol.asyncIterator]: async function* () {\n                for (const value of source) {\n                    yield value;\n                }\n            },\n        };\n    }\n    else if (typeof ReadableStream === \"function\"\n        && source instanceof ReadableStream) {\n        const reader = source.getReader();\n        return {\n            [Symbol.asyncIterator]: async function* () {\n                try {\n                    while (true) {\n                        const { done, value } = await reader.read();\n                        if (done) {\n                            break;\n                        }\n                        yield value;\n                    }\n                }\n                finally {\n                    reader.releaseLock();\n                }\n            },\n        };\n    }\n    return null;\n}\n//# sourceMappingURL=util.js.map"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACO,SAAS,eAAe,CAAC,MAAM,EAAE;AACxC,IAAI,IAAI,OAAO,MAAM,CAAC,MAAM,CAAC,aAAa,CAAC,KAAK,UAAU,EAAE;AAC5D,QAAQ,OAAO,MAAM,CAAC;AACtB,KAAK;AACL,SAAS,IAAI,OAAO,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,KAAK,UAAU,EAAE;AAC5D,QAAQ,OAAO;AACf,YAAY,CAAC,MAAM,CAAC,aAAa,GAAG,mBAAmB;AACvD,gBAAgB,KAAK,MAAM,KAAK,IAAI,MAAM,EAAE;AAC5C,oBAAoB,MAAM,KAAK,CAAC;AAChC,iBAAiB;AACjB,aAAa;AACb,SAAS,CAAC;AACV,KAAK;AACL,SAAS,IAAI,OAAO,cAAc,KAAK,UAAU;AACjD,WAAW,MAAM,YAAY,cAAc,EAAE;AAC7C,QAAQ,MAAM,MAAM,GAAG,MAAM,CAAC,SAAS,EAAE,CAAC;AAC1C,QAAQ,OAAO;AACf,YAAY,CAAC,MAAM,CAAC,aAAa,GAAG,mBAAmB;AACvD,gBAAgB,IAAI;AACpB,oBAAoB,OAAO,IAAI,EAAE;AACjC,wBAAwB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,MAAM,CAAC,IAAI,EAAE,CAAC;AACpE,wBAAwB,IAAI,IAAI,EAAE;AAClC,4BAA4B,MAAM;AAClC,yBAAyB;AACzB,wBAAwB,MAAM,KAAK,CAAC;AACpC,qBAAqB;AACrB,iBAAiB;AACjB,wBAAwB;AACxB,oBAAoB,MAAM,CAAC,WAAW,EAAE,CAAC;AACzC,iBAAiB;AACjB,aAAa;AACb,SAAS,CAAC;AACV,KAAK;AACL,IAAI,OAAO,IAAI,CAAC;AAChB;;;;"}