{
  "db_name": "PostgreSQL",
  "query": "\n        DELETE FROM asset\n        WHERE id IN (\n            SELECT id FROM (\n                SELECT a.id, ROW_NUMBER() OVER (\n                    PARTITION BY a.workspace_id, a.path, a.kind\n                    ORDER BY a.created_at DESC\n                ) as rn,\n                limits.max_n\n                FROM asset a\n                INNER JOIN (\n                    SELECT * FROM UNNEST(\n                        $1::varchar[], \n                        $2::varchar[], \n                        $3::asset_kind[],\n                        $4::int[]\n                    ) AS t(workspace_id, path, kind, max_n)\n                ) limits\n                ON a.workspace_id = limits.workspace_id \n                AND a.path = limits.path \n                AND a.kind = limits.kind\n                WHERE a.asset_detection_kind = 'runtime'\n            ) ranked\n            WHERE rn > max_n\n        )",
  "describe": {
    "columns": [],
    "parameters": {
      "Left": [
        "VarcharArray",
        "VarcharArray",
        {
          "Custom": {
            "name": "asset_kind[]",
            "kind": {
              "Array": {
                "Custom": {
                  "name": "asset_kind",
                  "kind": {
                    "Enum": [
                      "s3object",
                      "resource",
                      "variable",
                      "ducklake",
                      "datatable"
                    ]
                  }
                }
              }
            }
          }
        },
        "Int4Array"
      ]
    },
    "nullable": []
  },
  "hash": "a14d43c1baebcdf7e8cebcb7c752f78a2212fe55d4247c2321b37d182d2a4386"
}
