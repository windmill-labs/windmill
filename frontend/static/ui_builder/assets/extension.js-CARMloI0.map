{"version":3,"file":"extension.js","mappings":"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,EAAkB,EAAI,KAAO,IAC5CA,EAAeA,EAAkB,EAAI,KAAO,IAC5CA,EAAeA,EAAkB,EAAI,KAAO,IAC5CA,EAAeA,EAAkB,EAAI,KAAO,IAC5CA,EAAeA,EAAkB,EAAI,KAAO,IAC5CA,EAAeA,EAAkB,EAAI,KAAO,IAC5CA,EAAeA,EAAkB,EAAI,KAAO,IAC5CA,EAAeA,EAAkB,EAAI,KAAO,IAC5CA,EAAeA,EAAkB,EAAI,KAAO,IAC5CA,EAAeA,EAAkB,EAAI,KAAO,IAC5CA,EAAeA,EAAkB,EAAI,KAAO,IAC5CA,EAAeA,EAAkB,EAAI,KAAO,IAC5CA,EAAeA,EAAkB,EAAI,KAAO,IAC5CA,EAAeA,EAAkB,EAAI,KAAO,IAC5CA,EAAeA,EAAkB,EAAI,KAAO,IAC5CA,EAAeA,EAAkB,EAAI,KAAO,IAC5CA,EAAeA,EAAkB,EAAI,IAAM,IAC3CA,EAAeA,EAAkB,EAAI,IAAM,IAC3CA,EAAeA,EAAkB,EAAI,IAAM,IAC3CA,EAAeA,EAAkB,EAAI,IAAM,IAC3CA,EAAeA,EAAkB,EAAI,IAAM,IAC3CA,EAAeA,EAAkB,EAAI,IAAM,IAC3CA,EAAeA,EAAkB,EAAI,IAAM,IAC3CA,EAAeA,EAAkB,EAAI,IAAM,IAC3CA,EAAeA,EAAkB,EAAI,IAAM,IAC3CA,EAAeA,EAAkB,EAAI,IAAM,IAC3CA,EAAeA,EAAkB,EAAI,IAAM,IAC3CA,EAAeA,EAAkB,EAAI,IAAM,IAC3CA,EAAeA,EAAkB,EAAI,IAAM,IAC3CA,EAAeA,EAAkB,EAAI,IAAM,IAC3CA,EAAeA,EAAkB,EAAI,IAAM,IAC3CA,EAAeA,EAAkB,EAAI,IAAM,IAC3CA,EAAeA,EAAkB,EAAI,IAAM,IAC3CA,EAAeA,EAAkB,EAAI,IAAM,IAC3CA,EAAeA,EAAkB,EAAI,IAAM,IAC3CA,EAAeA,EAAkB,EAAI,IAAM,IAC3CA,EAAeA,EAAkB,EAAI,IAAM,IAC3CA,EAAeA,EAAkB,EAAI,IAAM,IAC3CA,EAAeA,EAAkB,EAAI,IAAM,IAC3CA,EAAeA,EAAkB,EAAI,IAAM,IAC3CA,EAAeA,EAAkB,EAAI,IAAM,IAC3CA,EAAeA,EAAkB,EAAI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","sources":["webpack://typescript-language-features/./node_modules/@microsoft/1ds-core-js/dist-es5/AppInsightsCore.js","webpack://typescript-language-features/./node_modules/@microsoft/1ds-core-js/dist-es5/Enums.js","webpack://typescript-language-features/./node_modules/@microsoft/1ds-core-js/dist-es5/ValueSanitizer.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK.Interfaces/IChannelControls.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK.Enums/LoggingEnums.js","webpack://typescript-language-features/./node_modules/@microsoft/1ds-core-js/dist-es5/InternalConstants.js","webpack://typescript-language-features/./node_modules/@microsoft/1ds-core-js/dist-es5/Utils.js","webpack://typescript-language-features/./node_modules/@microsoft/1ds-core-js/dist-es5/__DynamicConstants.js","webpack://typescript-language-features/./node_modules/@microsoft/1ds-post-js/dist-es5/DataModels.js","webpack://typescript-language-features/./node_modules/@microsoft/1ds-post-js/dist-es5/InternalConstants.js","webpack://typescript-language-features/./node_modules/@microsoft/1ds-post-js/dist-es5/__DynamicConstants.js","webpack://typescript-language-features/./node_modules/@microsoft/1ds-post-js/dist-es5/EventBatch.js","webpack://typescript-language-features/./node_modules/@microsoft/1ds-post-js/dist-es5/ClockSkewManager.js","webpack://typescript-language-features/./node_modules/@microsoft/1ds-post-js/dist-es5/KillSwitch.js","webpack://typescript-language-features/./node_modules/@microsoft/1ds-post-js/dist-es5/RetryPolicy.js","webpack://typescript-language-features/./node_modules/@microsoft/1ds-post-js/dist-es5/Serializer.js","webpack://typescript-language-features/./node_modules/@microsoft/1ds-post-js/dist-es5/HttpManager.js","webpack://typescript-language-features/./node_modules/@microsoft/1ds-post-js/dist-es5/TimeoutOverrideWrapper.js","webpack://typescript-language-features/./node_modules/@microsoft/1ds-post-js/dist-es5/PostChannel.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-common/dist-es5/applicationinsights-common.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/Config/ConfigDefaultHelpers.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/Config/ConfigDefaults.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK/AggregationError.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/Config/DynamicProperty.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/Config/DynamicState.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/Config/DynamicConfig.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/Config/DynamicSupport.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK.Enums/EnumHelperFuncs.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK.Enums/EventsDiscardedReason.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK.Enums/InitActiveStatusEnum.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK/AppInsightsCore.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK/TelemetryInitializerPlugin.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK/AsyncUtils.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK/BaseTelemetryPlugin.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK/Constants.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK/CookieMgr.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK/CoreUtils.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK/DataCacheHelper.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK/DbgExtensionUtils.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK/DiagnosticLogger.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK/EnvUtils.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK/EventHelpers.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK/HelperFuncs.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK/InternalConstants.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK/NotificationManager.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK/PerfManager.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK/ProcessTelemetryContext.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK/RandomHelper.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK/ResponseHelpers.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK/SenderPostManager.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK/TelemetryHelpers.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK/UnloadHandlerContainer.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK/UnloadHookContainer.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/JavaScriptSDK/W3cTraceParent.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-core-js/dist-es5/__DynamicConstants.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-shims/dist-es5/Constants.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-shims/dist-es5/TsLibShims.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-common/dist-es5/Constants.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-common/dist-es5/__DynamicConstants.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-common/dist-es5/Telemetry/Common/DataSanitizer.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-common/dist-es5/Telemetry/Event.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-common/dist-es5/Telemetry/Trace.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-common/dist-es5/HelperFuncs.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-common/dist-es5/Telemetry/PageView.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-common/dist-es5/Telemetry/PageViewPerformance.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-common/dist-es5/Telemetry/Exception.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-common/dist-es5/Telemetry/Common/DataPoint.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-common/dist-es5/Telemetry/Metric.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-common/dist-es5/UrlHelperFuncs.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-common/dist-es5/Util.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-common/dist-es5/Telemetry/RemoteDependencyData.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-common/dist-es5/Offline.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-common/dist-es5/Enums.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-common/dist-es5/StorageHelperFuncs.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-common/dist-es5/RequestResponseHeaders.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-common/dist-es5/Interfaces/Contracts/ContextTagKeys.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-common/dist-es5/Interfaces/PartAExtensions.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-common/dist-es5/Telemetry/Common/Envelope.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-common/dist-es5/Telemetry/Common/Data.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-channel-js/dist-es5/InternalConstants.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-channel-js/dist-es5/__DynamicConstants.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-channel-js/dist-es5/EnvelopeCreator.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-channel-js/dist-es5/SendBuffer.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-channel-js/dist-es5/Sender.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-channel-js/dist-es5/Serializer.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-channel-js/dist-es5/TelemetryProcessors/SamplingScoreGenerators/HashCodeScoreGenerator.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-channel-js/dist-es5/TelemetryProcessors/SamplingScoreGenerators/SamplingScoreGenerator.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-channel-js/dist-es5/TelemetryProcessors/Sample.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-common/dist-es5/ConnectionStringParser.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-web-basic/dist-es5/index.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-web-basic/dist-es5/__DynamicConstants.js","webpack://typescript-language-features/./node_modules/@microsoft/applicationinsights-common/dist-es5/Interfaces/Contracts/SeverityLevel.js","webpack://typescript-language-features/./node_modules/@microsoft/dynamicproto-js/dist-es5/DynamicProto.js","webpack://typescript-language-features/./node_modules/@nevware21/ts-async/dist/es5/mod/ts-async.js","webpack://typescript-language-features/./node_modules/@nevware21/ts-utils/dist/es5/mod/ts-utils.js","webpack://typescript-language-features/./node_modules/@vscode/extension-telemetry/dist/browser/common/baseTelemetrySender.js","webpack://typescript-language-features/./node_modules/@vscode/extension-telemetry/dist/browser/common/util.js","webpack://typescript-language-features/./node_modules/@vscode/extension-telemetry/dist/browser/common/baseTelemetryReporter.js","webpack://typescript-language-features/./node_modules/@vscode/extension-telemetry/dist/browser/browser/telemetryReporter.js","webpack://typescript-language-features/./node_modules/@vscode/extension-telemetry/dist/browser/common/appInsightsClientFactory.js","webpack://typescript-language-features/./node_modules/@vscode/extension-telemetry/dist/browser/common/1dsClientFactory.js","webpack://typescript-language-features/./node_modules/@vscode/sync-api-common/browser.js","webpack://typescript-language-features/./node_modules/@vscode/sync-api-common/lib/browser/connection.js","webpack://typescript-language-features/./node_modules/@vscode/sync-api-common/lib/browser/main.js","webpack://typescript-language-features/./node_modules/@vscode/sync-api-common/lib/browser/messageConnection.js","webpack://typescript-language-features/./node_modules/@vscode/sync-api-common/lib/browser/ril.js","webpack://typescript-language-features/./node_modules/@vscode/sync-api-common/lib/common/api.js","webpack://typescript-language-features/./node_modules/@vscode/sync-api-common/lib/common/connection.js","webpack://typescript-language-features/./node_modules/@vscode/sync-api-common/lib/common/messageCancellation.js","webpack://typescript-language-features/./node_modules/@vscode/sync-api-common/lib/common/messageConnection.js","webpack://typescript-language-features/./node_modules/@vscode/sync-api-common/lib/common/protocol.js","webpack://typescript-language-features/./node_modules/@vscode/sync-api-common/lib/common/ral.js","webpack://typescript-language-features/./node_modules/@vscode/sync-api-service/lib/apiService.js","webpack://typescript-language-features/./node_modules/@vscode/sync-api-service/lib/main.js","webpack://typescript-language-features/./node_modules/@vscode/ts-package-manager/dist/index.js","webpack://typescript-language-features/./node_modules/@vscode/ts-package-manager/node-maintainer/node_maintainer.js","webpack://typescript-language-features/./node_modules/@vscode/ts-package-manager/node-maintainer/snippets/wasm-streams-42e57edbcd526312/inline0.js","webpack://typescript-language-features/./node_modules/jsonc-parser/lib/esm/impl/scanner.js","webpack://typescript-language-features/./node_modules/jsonc-parser/lib/esm/impl/parser.js","webpack://typescript-language-features/./node_modules/jsonc-parser/lib/esm/impl/format.js","webpack://typescript-language-features/./node_modules/jsonc-parser/lib/esm/impl/edit.js","webpack://typescript-language-features/./node_modules/jsonc-parser/lib/esm/main.js","webpack://typescript-language-features/./node_modules/lru-cache/index.js","webpack://typescript-language-features/./node_modules/semver/classes/comparator.js","webpack://typescript-language-features/./node_modules/semver/classes/range.js","webpack://typescript-language-features/./node_modules/semver/classes/semver.js","webpack://typescript-language-features/./node_modules/semver/functions/clean.js","webpack://typescript-language-features/./node_modules/semver/functions/cmp.js","webpack://typescript-language-features/./node_modules/semver/functions/coerce.js","webpack://typescript-language-features/./node_modules/semver/functions/compare-build.js","webpack://typescript-language-features/./node_modules/semver/functions/compare-loose.js","webpack://typescript-language-features/./node_modules/semver/functions/compare.js","webpack://typescript-language-features/./node_modules/semver/functions/diff.js","webpack://typescript-language-features/./node_modules/semver/functions/eq.js","webpack://typescript-language-features/./node_modules/semver/functions/gt.js","webpack://typescript-language-features/./node_modules/semver/functions/gte.js","webpack://typescript-language-features/./node_modules/semver/functions/inc.js","webpack://typescript-language-features/./node_modules/semver/functions/lt.js","webpack://typescript-language-features/./node_modules/semver/functions/lte.js","webpack://typescript-language-features/./node_modules/semver/functions/major.js","webpack://typescript-language-features/./node_modules/semver/functions/minor.js","webpack://typescript-language-features/./node_modules/semver/functions/neq.js","webpack://typescript-language-features/./node_modules/semver/functions/parse.js","webpack://typescript-language-features/./node_modules/semver/functions/patch.js","webpack://typescript-language-features/./node_modules/semver/functions/prerelease.js","webpack://typescript-language-features/./node_modules/semver/functions/rcompare.js","webpack://typescript-language-features/./node_modules/semver/functions/rsort.js","webpack://typescript-language-features/./node_modules/semver/functions/satisfies.js","webpack://typescript-language-features/./node_modules/semver/functions/sort.js","webpack://typescript-language-features/./node_modules/semver/functions/valid.js","webpack://typescript-language-features/./node_modules/semver/index.js","webpack://typescript-language-features/./node_modules/semver/internal/constants.js","webpack://typescript-language-features/./node_modules/semver/internal/debug.js","webpack://typescript-language-features/./node_modules/semver/internal/identifiers.js","webpack://typescript-language-features/./node_modules/semver/internal/parse-options.js","webpack://typescript-language-features/./node_modules/semver/internal/re.js","webpack://typescript-language-features/./node_modules/semver/ranges/gtr.js","webpack://typescript-language-features/./node_modules/semver/ranges/intersects.js","webpack://typescript-language-features/./node_modules/semver/ranges/ltr.js","webpack://typescript-language-features/./node_modules/semver/ranges/max-satisfying.js","webpack://typescript-language-features/./node_modules/semver/ranges/min-satisfying.js","webpack://typescript-language-features/./node_modules/semver/ranges/min-version.js","webpack://typescript-language-features/./node_modules/semver/ranges/outside.js","webpack://typescript-language-features/./node_modules/semver/ranges/simplify.js","webpack://typescript-language-features/./node_modules/semver/ranges/subset.js","webpack://typescript-language-features/./node_modules/semver/ranges/to-comparators.js","webpack://typescript-language-features/./node_modules/semver/ranges/valid.js","webpack://typescript-language-features/./node_modules/vscode-uri/lib/esm/index.js","webpack://typescript-language-features/./node_modules/yallist/iterator.js","webpack://typescript-language-features/./node_modules/yallist/yallist.js","webpack://typescript-language-features/../../node_modules/os-browserify/main.js","webpack://typescript-language-features/../../node_modules/path-browserify/index.js","webpack://typescript-language-features/./src/api.ts","webpack://typescript-language-features/./src/commands/commandManager.ts","webpack://typescript-language-features/./src/commands/configurePlugin.ts","webpack://typescript-language-features/./src/commands/goToProjectConfiguration.ts","webpack://typescript-language-features/./src/commands/index.ts","webpack://typescript-language-features/./src/commands/learnMoreAboutRefactorings.ts","webpack://typescript-language-features/./src/commands/openJsDocLink.ts","webpack://typescript-language-features/./src/commands/openTsServerLog.ts","webpack://typescript-language-features/./src/commands/reloadProject.ts","webpack://typescript-language-features/./src/commands/restartTsServer.ts","webpack://typescript-language-features/./src/commands/selectTypeScriptVersion.ts","webpack://typescript-language-features/./src/commands/tsserverRequests.ts","webpack://typescript-language-features/./src/configuration/configuration.browser.ts","webpack://typescript-language-features/./src/configuration/configuration.ts","webpack://typescript-language-features/./src/configuration/fileSchemes.ts","webpack://typescript-language-features/./src/configuration/languageDescription.ts","webpack://typescript-language-features/./src/configuration/languageIds.ts","webpack://typescript-language-features/./src/configuration/schemes.ts","webpack://typescript-language-features/./src/experimentTelemetryReporter.ts","webpack://typescript-language-features/./src/extension.browser.ts","webpack://typescript-language-features/./src/filesystems/ata.ts","webpack://typescript-language-features/./src/filesystems/autoInstallerFs.ts","webpack://typescript-language-features/./src/filesystems/memFs.ts","webpack://typescript-language-features/./src/languageFeatures/callHierarchy.ts","webpack://typescript-language-features/./src/languageFeatures/codeLens/baseCodeLensProvider.ts","webpack://typescript-language-features/./src/languageFeatures/codeLens/implementationsCodeLens.ts","webpack://typescript-language-features/./src/languageFeatures/codeLens/referencesCodeLens.ts","webpack://typescript-language-features/./src/languageFeatures/completions.ts","webpack://typescript-language-features/./src/languageFeatures/copyPaste.ts","webpack://typescript-language-features/./src/languageFeatures/definitionProviderBase.ts","webpack://typescript-language-features/./src/languageFeatures/definitions.ts","webpack://typescript-language-features/./src/languageFeatures/diagnostics.ts","webpack://typescript-language-features/./src/languageFeatures/directiveCommentCompletions.ts","webpack://typescript-language-features/./src/languageFeatures/documentHighlight.ts","webpack://typescript-language-features/./src/languageFeatures/documentSymbol.ts","webpack://typescript-language-features/./src/languageFeatures/fileConfigurationManager.ts","webpack://typescript-language-features/./src/languageFeatures/fileReferences.ts","webpack://typescript-language-features/./src/languageFeatures/fixAll.ts","webpack://typescript-language-features/./src/languageFeatures/folding.ts","webpack://typescript-language-features/./src/languageFeatures/formatting.ts","webpack://typescript-language-features/./src/languageFeatures/hover.ts","webpack://typescript-language-features/./src/languageFeatures/implementations.ts","webpack://typescript-language-features/./src/languageFeatures/inlayHints.ts","webpack://typescript-language-features/./src/languageFeatures/jsDocCompletions.ts","webpack://typescript-language-features/./src/languageFeatures/linkedEditing.ts","webpack://typescript-language-features/./src/languageFeatures/organizeImports.ts","webpack://typescript-language-features/./src/languageFeatures/quickFix.ts","webpack://typescript-language-features/./src/languageFeatures/refactor.ts","webpack://typescript-language-features/./src/languageFeatures/references.ts","webpack://typescript-language-features/./src/languageFeatures/rename.ts","webpack://typescript-language-features/./src/languageFeatures/semanticTokens.ts","webpack://typescript-language-features/./src/languageFeatures/signatureHelp.ts","webpack://typescript-language-features/./src/languageFeatures/smartSelect.ts","webpack://typescript-language-features/./src/languageFeatures/sourceDefinition.ts","webpack://typescript-language-features/./src/languageFeatures/tagClosing.ts","webpack://typescript-language-features/./src/languageFeatures/tsconfig.ts","webpack://typescript-language-features/./src/languageFeatures/typeDefinitions.ts","webpack://typescript-language-features/./src/languageFeatures/updatePathsOnRename.ts","webpack://typescript-language-features/./src/languageFeatures/util/codeAction.ts","webpack://typescript-language-features/./src/languageFeatures/util/copilot.ts","webpack://typescript-language-features/./src/languageFeatures/util/dependentRegistration.ts","webpack://typescript-language-features/./src/languageFeatures/util/snippetForFunctionCall.ts","webpack://typescript-language-features/./src/languageFeatures/util/textRendering.ts","webpack://typescript-language-features/./src/languageFeatures/workspaceSymbols.ts","webpack://typescript-language-features/./src/languageProvider.ts","webpack://typescript-language-features/./src/lazyClientHost.ts","webpack://typescript-language-features/./src/logging/logLevelMonitor.ts","webpack://typescript-language-features/./src/logging/logger.ts","webpack://typescript-language-features/./src/logging/telemetry.ts","webpack://typescript-language-features/./src/logging/tracer.ts","webpack://typescript-language-features/./src/remoteRepositories.browser.ts","webpack://typescript-language-features/./src/tsServer/api.ts","webpack://typescript-language-features/./src/tsServer/bufferSyncSupport.ts","webpack://typescript-language-features/./src/tsServer/cachedResponse.ts","webpack://typescript-language-features/./src/tsServer/callbackMap.ts","webpack://typescript-language-features/./src/tsServer/cancellation.ts","webpack://typescript-language-features/./src/tsServer/fileWatchingManager.ts","webpack://typescript-language-features/./src/tsServer/logDirectoryProvider.ts","webpack://typescript-language-features/./src/tsServer/nodeManager.ts","webpack://typescript-language-features/./src/tsServer/pluginPathsProvider.ts","webpack://typescript-language-features/./src/tsServer/plugins.ts","webpack://typescript-language-features/./src/tsServer/protocol/errorCodes.ts","webpack://typescript-language-features/./src/tsServer/protocol/fixNames.ts","webpack://typescript-language-features/./src/tsServer/protocol/modifiers.ts","webpack://typescript-language-features/./src/tsServer/protocol/protocol.const.ts","webpack://typescript-language-features/./src/tsServer/requestQueue.ts","webpack://typescript-language-features/./src/tsServer/server.ts","webpack://typescript-language-features/./src/tsServer/serverError.ts","webpack://typescript-language-features/./src/tsServer/serverProcess.browser.ts","webpack://typescript-language-features/./src/tsServer/spawner.ts","webpack://typescript-language-features/./src/tsServer/versionManager.ts","webpack://typescript-language-features/./src/tsServer/versionProvider.ts","webpack://typescript-language-features/./src/tsconfig.ts","webpack://typescript-language-features/./src/typeConverters.ts","webpack://typescript-language-features/./src/typeScriptServiceClientHost.ts","webpack://typescript-language-features/./src/typescriptService.ts","webpack://typescript-language-features/./src/typescriptServiceClient.ts","webpack://typescript-language-features/./src/ui/activeJsTsEditorTracker.ts","webpack://typescript-language-features/./src/ui/intellisenseStatus.ts","webpack://typescript-language-features/./src/ui/largeProjectStatus.ts","webpack://typescript-language-features/./src/ui/managedFileContext.ts","webpack://typescript-language-features/./src/ui/typingsStatus.ts","webpack://typescript-language-features/./src/ui/versionStatus.ts","webpack://typescript-language-features/./src/utils/arrays.ts","webpack://typescript-language-features/./src/utils/async.ts","webpack://typescript-language-features/./src/utils/cancellation.ts","webpack://typescript-language-features/./src/utils/dispose.ts","webpack://typescript-language-features/./src/utils/fs.ts","webpack://typescript-language-features/./src/utils/hash.ts","webpack://typescript-language-features/./src/utils/lazy.ts","webpack://typescript-language-features/./src/utils/memoize.ts","webpack://typescript-language-features/./src/utils/objects.ts","webpack://typescript-language-features/./src/utils/packageInfo.ts","webpack://typescript-language-features/./src/utils/platform.ts","webpack://typescript-language-features/./src/utils/regexp.ts","webpack://typescript-language-features/./src/utils/relativePathResolver.ts","webpack://typescript-language-features/./src/utils/resourceMap.ts","webpack://typescript-language-features/external commonjs \"vscode\"","webpack://typescript-language-features/webpack/bootstrap","webpack://typescript-language-features/webpack/runtime/define property getters","webpack://typescript-language-features/webpack/runtime/global","webpack://typescript-language-features/webpack/runtime/hasOwnProperty shorthand","webpack://typescript-language-features/webpack/runtime/make namespace object","webpack://typescript-language-features/webpack/runtime/importScripts chunk loading","webpack://typescript-language-features/webpack/startup"],"sourcesContent":["/*\n * 1DS JS SDK Core, 4.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n * (Microsoft Internal Only)\n */\nimport { __extendsFn as __extends } from \"@microsoft/applicationinsights-shims\";\r\n/**\r\n* AppInsightsCore.ts\r\n* @author Abhilash Panwar (abpanwar) Hector Hernandez (hectorh)\r\n* @copyright Microsoft 2018\r\n*/\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { AppInsightsCore as InternalCore, _throwInternal, createDynamicConfig, doPerf, dumpObj, throwError } from \"@microsoft/applicationinsights-core-js\";\r\nimport { objDeepFreeze } from \"@nevware21/ts-utils\";\r\nimport { STR_DEFAULT_ENDPOINT_URL, STR_EMPTY, STR_PROPERTIES, STR_VERSION } from \"./InternalConstants\";\r\nimport { FullVersionString, getTime, isLatency } from \"./Utils\";\r\nimport { _DYN_INDEX_OF, _DYN_INITIALIZE, _DYN_LOGGER, _DYN_POLL_INTERNAL_LOGS, _DYN_TIMINGS } from \"./__DynamicConstants\";\r\n/**\r\n * The default settings for the config.\r\n * WE MUST include all defaults here to ensure that the config is created with all of the properties\r\n * defined as dynamic.\r\n */\r\nvar defaultConfig = objDeepFreeze({\r\n    endpointUrl: STR_DEFAULT_ENDPOINT_URL,\r\n    propertyStorageOverride: { isVal: _chkPropOverride }\r\n});\r\nfunction _chkPropOverride(propertyStorageOverride) {\r\n    // Validate property storage override\r\n    if (propertyStorageOverride && (!propertyStorageOverride.getProperty || !propertyStorageOverride.setProperty)) {\r\n        throwError(\"Invalid property storage override passed.\");\r\n    }\r\n    return true;\r\n}\r\n/**\r\n * @group Classes\r\n * @group Entrypoint\r\n */\r\nvar AppInsightsCore = /** @class */ (function (_super) {\r\n    __extends(AppInsightsCore, _super);\r\n    function AppInsightsCore() {\r\n        var _this = _super.call(this) || this;\r\n        dynamicProto(AppInsightsCore, _this, function (_self, _base) {\r\n            _self[_DYN_INITIALIZE /* @min:%2einitialize */] = function (config, extensions, logger, notificationManager) {\r\n                doPerf(_self, function () { return \"AppInsightsCore.initialize\"; }, function () {\r\n                    try {\r\n                        _base[_DYN_INITIALIZE /* @min:%2einitialize */](createDynamicConfig(config, defaultConfig, logger || _self[_DYN_LOGGER /* @min:%2elogger */], false).cfg, extensions, logger, notificationManager);\r\n                    }\r\n                    catch (e) {\r\n                        var logger_1 = _self[_DYN_LOGGER /* @min:%2elogger */];\r\n                        var message = dumpObj(e);\r\n                        if (message[_DYN_INDEX_OF /* @min:%2eindexOf */](\"channels\") !== -1) {\r\n                            // Add some additional context to the underlying reported error\r\n                            message += \"\\n - Channels must be provided through config.channels only!\";\r\n                        }\r\n                        _throwInternal(logger_1, 1 /* eLoggingSeverity.CRITICAL */, 514 /* _eExtendedInternalMessageId.FailedToInitializeSDK */, \"SDK Initialization Failed - no telemetry will be sent: \" + message);\r\n                    }\r\n                }, function () { return ({ config: config, extensions: extensions, logger: logger, notificationManager: notificationManager }); });\r\n            };\r\n            _self.track = function (item) {\r\n                doPerf(_self, function () { return \"AppInsightsCore.track\"; }, function () {\r\n                    var telemetryItem = item;\r\n                    if (telemetryItem) {\r\n                        telemetryItem[_DYN_TIMINGS /* @min:%2etimings */] = telemetryItem[_DYN_TIMINGS /* @min:%2etimings */] || {};\r\n                        telemetryItem[_DYN_TIMINGS /* @min:%2etimings */].trackStart = getTime();\r\n                        if (!isLatency(telemetryItem.latency)) {\r\n                            telemetryItem.latency = 1 /* EventLatencyValue.Normal */;\r\n                        }\r\n                        var itemExt = telemetryItem.ext = telemetryItem.ext || {};\r\n                        itemExt.sdk = itemExt.sdk || {};\r\n                        itemExt.sdk.ver = FullVersionString;\r\n                        var baseData = telemetryItem.baseData = telemetryItem.baseData || {};\r\n                        baseData[STR_PROPERTIES /* @min:%2eproperties */] = baseData[STR_PROPERTIES /* @min:%2eproperties */] || {};\r\n                        var itemProperties = baseData[STR_PROPERTIES /* @min:%2eproperties */];\r\n                        itemProperties[STR_VERSION] = itemProperties[STR_VERSION] || _self.pluginVersionString || STR_EMPTY;\r\n                    }\r\n                    _base.track(telemetryItem);\r\n                }, function () { return ({ item: item }); }, !(item.sync));\r\n            };\r\n            _self[_DYN_POLL_INTERNAL_LOGS /* @min:%2epollInternalLogs */] = function (eventName) {\r\n                return _base[_DYN_POLL_INTERNAL_LOGS /* @min:%2epollInternalLogs */](eventName || \"InternalLog\");\r\n            };\r\n        });\r\n        return _this;\r\n    }\r\n// Removed Stub for AppInsightsCore.prototype.initialize.\r\n// Removed Stub for AppInsightsCore.prototype.track.\r\n// Removed Stub for AppInsightsCore.prototype.pollInternalLogs.\r\n    // This is a workaround for an IE bug when using dynamicProto() with classes that don't have any\n    // non-dynamic functions or static properties/functions when using uglify-js to minify the resulting code.\n    AppInsightsCore.__ieDyn=1;\n\n    return AppInsightsCore;\r\n}(InternalCore));\r\nexport { AppInsightsCore };\r\n//# sourceMappingURL=AppInsightsCore.js.map","/*\n * 1DS JS SDK Core, 4.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n * (Microsoft Internal Only)\n */\n/**\r\n* Enums.ts\r\n* @author Abhilash Panwar (abpanwar)\r\n* @copyright Microsoft 2018\r\n* File containing the enums as constants.\r\n*/\r\nimport { createEnumStyle } from \"@microsoft/applicationinsights-core-js\";\r\n/**\r\n * The ValueKind contains a set of values that specify value kind of the property.\r\n * Either PII (Personal Identifiable Information) or customer content.\r\n */\r\nexport var ValueKind = createEnumStyle({\r\n    NotSet: 0 /* eValueKind.NotSet */,\r\n    Pii_DistinguishedName: 1 /* eValueKind.Pii_DistinguishedName */,\r\n    Pii_GenericData: 2 /* eValueKind.Pii_GenericData */,\r\n    Pii_IPV4Address: 3 /* eValueKind.Pii_IPV4Address */,\r\n    Pii_IPv6Address: 4 /* eValueKind.Pii_IPv6Address */,\r\n    Pii_MailSubject: 5 /* eValueKind.Pii_MailSubject */,\r\n    Pii_PhoneNumber: 6 /* eValueKind.Pii_PhoneNumber */,\r\n    Pii_QueryString: 7 /* eValueKind.Pii_QueryString */,\r\n    Pii_SipAddress: 8 /* eValueKind.Pii_SipAddress */,\r\n    Pii_SmtpAddress: 9 /* eValueKind.Pii_SmtpAddress */,\r\n    Pii_Identity: 10 /* eValueKind.Pii_Identity */,\r\n    Pii_Uri: 11 /* eValueKind.Pii_Uri */,\r\n    Pii_Fqdn: 12 /* eValueKind.Pii_Fqdn */,\r\n    Pii_IPV4AddressLegacy: 13 /* eValueKind.Pii_IPV4AddressLegacy */,\r\n    Pii_IPv6ScrubLastHextets: 14 /* eValueKind.Pii_IPv6ScrubLastHextets */,\r\n    Pii_DropValue: 15 /* eValueKind.Pii_DropValue */,\r\n    CustomerContent_GenericContent: 32 /* eValueKind.CustomerContent_GenericContent */\r\n});\r\n/**\r\n * The EventLatency contains a set of values that specify the latency with which an event is sent.\r\n */\r\nexport var EventLatency = createEnumStyle({\r\n    /**\r\n     * Normal latency.\r\n     */\r\n    Normal: 1 /* EventLatencyValue.Normal */,\r\n    /**\r\n     * Cost deferred latency. At the moment this latency is treated as Normal latency.\r\n     */\r\n    CostDeferred: 2 /* EventLatencyValue.CostDeferred */,\r\n    /**\r\n     * Real time latency.\r\n     */\r\n    RealTime: 3 /* EventLatencyValue.RealTime */,\r\n    /**\r\n     * Bypass normal batching/timing and send as soon as possible, this will still send asynchronously.\r\n     * Added in v3.1.1\r\n     */\r\n    Immediate: 4 /* EventLatencyValue.Immediate */\r\n});\r\n/**\r\n * Enum for property types.\r\n */\r\nexport var EventPropertyType = createEnumStyle({\r\n    Unspecified: 0 /* eEventPropertyType.Unspecified */,\r\n    String: 1 /* eEventPropertyType.String */,\r\n    Int32: 2 /* eEventPropertyType.Int32 */,\r\n    UInt32: 3 /* eEventPropertyType.UInt32 */,\r\n    Int64: 4 /* eEventPropertyType.Int64 */,\r\n    UInt64: 5 /* eEventPropertyType.UInt64 */,\r\n    Double: 6 /* eEventPropertyType.Double */,\r\n    Bool: 7 /* eEventPropertyType.Bool */,\r\n    Guid: 8 /* eEventPropertyType.Guid */,\r\n    DateTime: 9 /* eEventPropertyType.DateTime */\r\n});\r\n/**\r\n * The EventPersistence contains a set of values that specify the event's persistence.\r\n */\r\nexport var EventPersistence = createEnumStyle({\r\n    /**\r\n     * Normal persistence.\r\n     */\r\n    Normal: 1 /* EventPersistenceValue.Normal */,\r\n    /**\r\n     * Critical persistence.\r\n     */\r\n    Critical: 2 /* EventPersistenceValue.Critical */\r\n});\r\nexport var TraceLevel = createEnumStyle({\r\n    NONE: 0 /* eTraceLevel.NONE */,\r\n    ERROR: 1 /* eTraceLevel.ERROR */,\r\n    WARNING: 2 /* eTraceLevel.WARNING */,\r\n    INFORMATION: 3 /* eTraceLevel.INFORMATION */\r\n});\r\n//# sourceMappingURL=Enums.js.map","/*\n * 1DS JS SDK Core, 4.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n * (Microsoft Internal Only)\n */\nimport { isNullOrUndefined, isString, objForEachKey } from \"@microsoft/applicationinsights-core-js\";\r\nimport { arrForEach, arrIncludes, arrIndexOf, getLength } from \"@nevware21/ts-utils\";\r\nimport { STR_EMPTY } from \"./InternalConstants\";\r\nimport { getFieldValueType, isValueAssigned, isValueKind } from \"./Utils\";\r\nimport { _DYN_CAN_HANDLE, _DYN_HANDLE_FIELD, _DYN_KIND, _DYN_LENGTH, _DYN_RM_FIELD_SANITIZER, _DYN_RM_SANITIZER, _DYN_VALUE } from \"./__DynamicConstants\";\r\nvar ValueSanitizer = /** @class */ (function () {\r\n    function ValueSanitizer(fieldSanitizerProvider) {\r\n        var _self = this;\r\n        // To aid with performance this is a lookup map to check if the field value sanitizer supports this field\r\n        var _sanitizerMap = {};\r\n        var _sanitizers = [];\r\n        var _fieldSanitizers = [];\r\n        if (fieldSanitizerProvider) {\r\n            _fieldSanitizers.push(fieldSanitizerProvider);\r\n        }\r\n        function _getFieldSanitizer(path, name) {\r\n            var result;\r\n            var fieldLookup = _sanitizerMap[path];\r\n            if (fieldLookup) {\r\n                result = fieldLookup[name];\r\n            }\r\n            if (!result && result !== null) {\r\n                // Null is a valid result indicating that the value sanitizer does not support this field\r\n                if (isString(path) && isString(name)) {\r\n                    if (_fieldSanitizers[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                        for (var lp = 0; lp < _fieldSanitizers[_DYN_LENGTH /* @min:%2elength */]; lp++) {\r\n                            if (_fieldSanitizers[lp][_DYN_HANDLE_FIELD /* @min:%2ehandleField */](path, name)) {\r\n                                result = {\r\n                                    canHandle: true,\r\n                                    fieldHandler: _fieldSanitizers[lp]\r\n                                };\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                    else if (_sanitizers[_DYN_LENGTH /* @min:%2elength */] === 0) {\r\n                        // Special use-case where there is no sanitizer to pass on to, so just resolving the field\r\n                        // and returning the resulting value (same as sanitizeProperty())\r\n                        result = {\r\n                            canHandle: true\r\n                        };\r\n                    }\r\n                }\r\n                // We still don't have a handler so lets lookup the providers\r\n                if (!result && result !== null) {\r\n                    // Setting the result to null -- which means we and any contained sanitizers can't handle this field\r\n                    result = null;\r\n                    for (var lp = 0; lp < _sanitizers[_DYN_LENGTH /* @min:%2elength */]; lp++) {\r\n                        if (_sanitizers[lp][_DYN_HANDLE_FIELD /* @min:%2ehandleField */](path, name)) {\r\n                            result = {\r\n                                canHandle: true,\r\n                                handler: _sanitizers[lp],\r\n                                fieldHandler: null\r\n                            };\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                if (!fieldLookup) {\r\n                    fieldLookup = _sanitizerMap[path] = {};\r\n                }\r\n                fieldLookup[name] = result;\r\n            }\r\n            return result;\r\n        }\r\n        _self.clearCache = function () {\r\n            _sanitizerMap = {};\r\n        };\r\n        _self.addSanitizer = function (newSanitizer) {\r\n            if (newSanitizer) {\r\n                if (!arrIncludes(_sanitizers, newSanitizer)) {\r\n                    _sanitizers.push(newSanitizer);\r\n                }\r\n                // Invalidate any previously mapped fields\r\n                _sanitizerMap = {};\r\n            }\r\n        };\r\n        _self.addFieldSanitizer = function (fieldSanitizer) {\r\n            if (fieldSanitizer) {\r\n                if (!arrIncludes(_fieldSanitizers, fieldSanitizer)) {\r\n                    _fieldSanitizers.push(fieldSanitizer);\r\n                }\r\n                // Invalidate any previously mapped fields\r\n                _sanitizerMap = {};\r\n            }\r\n        };\r\n        _self[_DYN_RM_SANITIZER /* @min:%2ermSanitizer */] = function (theSanitizer) {\r\n            if (theSanitizer) {\r\n                var idx = arrIndexOf(_sanitizers, theSanitizer);\r\n                if (idx !== -1) {\r\n                    _sanitizers.splice(idx, 1);\r\n                    // Invalidate any previously mapped fields\r\n                    _sanitizerMap = {};\r\n                }\r\n                // Try and remove the sanitizer from any chained sanitizer as well\r\n                arrForEach(_sanitizers, function (sanitizer) {\r\n                    sanitizer && sanitizer[_DYN_RM_SANITIZER /* @min:%2ermSanitizer */] && sanitizer[_DYN_RM_SANITIZER /* @min:%2ermSanitizer */](theSanitizer);\r\n                });\r\n            }\r\n        };\r\n        _self[_DYN_RM_FIELD_SANITIZER /* @min:%2ermFieldSanitizer */] = function (theFieldSanitizer) {\r\n            if (theFieldSanitizer) {\r\n                var idx = arrIndexOf(_fieldSanitizers, theFieldSanitizer);\r\n                if (idx !== -1) {\r\n                    _fieldSanitizers.splice(idx, 1);\r\n                    // Invalidate any previously mapped fields\r\n                    _sanitizerMap = {};\r\n                }\r\n                // Try and remove the field sanitizer from any chained sanitizer as well\r\n                arrForEach(_sanitizers, function (sanitizer) {\r\n                    sanitizer && sanitizer[_DYN_RM_FIELD_SANITIZER /* @min:%2ermFieldSanitizer */] && sanitizer[_DYN_RM_FIELD_SANITIZER /* @min:%2ermFieldSanitizer */](theFieldSanitizer);\r\n                });\r\n            }\r\n        };\r\n        _self.isEmpty = function () {\r\n            return (getLength(_sanitizers) + getLength(_fieldSanitizers)) === 0;\r\n        };\r\n        _self[_DYN_HANDLE_FIELD /* @min:%2ehandleField */] = function (path, name) {\r\n            var mapValue = _getFieldSanitizer(path, name);\r\n            return mapValue ? mapValue[_DYN_CAN_HANDLE /* @min:%2ecanHandle */] : false;\r\n        };\r\n        _self[_DYN_VALUE /* @min:%2evalue */] = function (path, name, value, stringifyObjects) {\r\n            var mapValue = _getFieldSanitizer(path, name);\r\n            if (mapValue && mapValue[_DYN_CAN_HANDLE /* @min:%2ecanHandle */]) {\r\n                if (!mapValue || !mapValue[_DYN_CAN_HANDLE /* @min:%2ecanHandle */]) {\r\n                    return null;\r\n                }\r\n                if (mapValue.handler) {\r\n                    // This value sanitizer can't handle this field so pass it only the next one\r\n                    return mapValue.handler[_DYN_VALUE /* @min:%2evalue */](path, name, value, stringifyObjects);\r\n                }\r\n                // Check that property is valid\r\n                if (!isString(name) || isNullOrUndefined(value) || value === STR_EMPTY) {\r\n                    return null;\r\n                }\r\n                var property = null;\r\n                var fieldType = getFieldValueType(value);\r\n                if ((fieldType & 8192 /* FieldValueSanitizerType.EventProperty */) === 8192 /* FieldValueSanitizerType.EventProperty */) {\r\n                    var subType = fieldType & ~8192 /* FieldValueSanitizerType.EventProperty */;\r\n                    property = value;\r\n                    if (!isValueAssigned(property[_DYN_VALUE /* @min:%2evalue */]) ||\r\n                        (subType !== 1 /* FieldValueSanitizerType.String */ &&\r\n                            subType !== 2 /* FieldValueSanitizerType.Number */ &&\r\n                            subType !== 3 /* FieldValueSanitizerType.Boolean */ &&\r\n                            (subType & 4096 /* FieldValueSanitizerType.Array */) !== 4096 /* FieldValueSanitizerType.Array */)) {\r\n                        // Not a supported IEventProperty type to be able to sanitize\r\n                        return null;\r\n                    }\r\n                }\r\n                else if (fieldType === 1 /* FieldValueSanitizerType.String */ ||\r\n                    fieldType === 2 /* FieldValueSanitizerType.Number */ ||\r\n                    fieldType === 3 /* FieldValueSanitizerType.Boolean */ ||\r\n                    (fieldType & 4096 /* FieldValueSanitizerType.Array */) === 4096 /* FieldValueSanitizerType.Array */) {\r\n                    // If the property isn't IEventProperty (and is either string, number, boolean or array), convert it into one.\r\n                    property = _convertToProperty(path, name, value);\r\n                }\r\n                else if (fieldType === 4 /* FieldValueSanitizerType.Object */) {\r\n                    property = _convertToProperty(path, name, !!stringifyObjects ? JSON.stringify(value) : value);\r\n                }\r\n                if (property) {\r\n                    return _handleProperty(mapValue, path, name, fieldType, property, stringifyObjects);\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n        _self.property = function (path, name, property, stringifyObjects) {\r\n            var mapValue = _getFieldSanitizer(path, name);\r\n            if (!mapValue || !mapValue[_DYN_CAN_HANDLE /* @min:%2ecanHandle */]) {\r\n                return null;\r\n            }\r\n            // Check that property is valid\r\n            if (!isString(name) || isNullOrUndefined(property) || !isValueAssigned(property[_DYN_VALUE /* @min:%2evalue */])) {\r\n                return null;\r\n            }\r\n            var fieldType = getFieldValueType(property[_DYN_VALUE /* @min:%2evalue */]);\r\n            if (fieldType === 0 /* FieldValueSanitizerType.NotSet */) {\r\n                // Not a supported field that we can sanitize or serialize\r\n                return null;\r\n            }\r\n            return _handleProperty(mapValue, path, name, fieldType, property, stringifyObjects);\r\n        };\r\n        function _handleProperty(mapValue, path, name, fieldType, property, stringifyObjects) {\r\n            if (mapValue.handler) {\r\n                // This value sanitizer can't handle this field so pass it only the next one\r\n                return mapValue.handler.property(path, name, property, stringifyObjects);\r\n            }\r\n            // If either pii or cc is set convert value to string (since only string pii/cc is allowed).\r\n            // If the value is a complex type like an array that can't be converted to string we will drop\r\n            // the property.\r\n            if (!isNullOrUndefined(property[_DYN_KIND /* @min:%2ekind */])) {\r\n                if ((fieldType & 4096 /* FieldValueSanitizerType.Array */) === 4096 /* FieldValueSanitizerType.Array */ || !isValueKind(property[_DYN_KIND /* @min:%2ekind */])) {\r\n                    return null;\r\n                }\r\n                // Convert the value to a string and assign back to the original value\r\n                property[_DYN_VALUE /* @min:%2evalue */] = property[_DYN_VALUE /* @min:%2evalue */].toString();\r\n            }\r\n            return _callFieldSanitizer(mapValue.fieldHandler, path, name, fieldType, property);\r\n        }\r\n        function _convertToProperty(path, name, value) {\r\n            if (isValueAssigned(value)) {\r\n                return { value: value };\r\n            }\r\n            return null;\r\n        }\r\n        function _callFieldSanitizer(fieldProvider, path, name, theType, property) {\r\n            if (property && fieldProvider) {\r\n                var sanitizer = fieldProvider.getSanitizer(path, name, theType, property[_DYN_KIND /* @min:%2ekind */], property.propertyType);\r\n                if (sanitizer) {\r\n                    // This is where we the field will call the handler to \"scrub\" the value. This the primary hook for the ClientHashing Plugin to\r\n                    // be able to apply the hashFunc() / Sha256 conversion of the properties value\r\n                    if (theType === 4 /* FieldValueSanitizerType.Object */) {\r\n                        // Special case of an embedded object (ext.metadata, data.properties)\r\n                        var newValue_1 = {};\r\n                        var propValue = property[_DYN_VALUE /* @min:%2evalue */];\r\n                        objForEachKey(propValue, function (propKey, theValue) {\r\n                            var newPath = path + \".\" + name;\r\n                            if (isValueAssigned(theValue)) {\r\n                                var newProp = _convertToProperty(newPath, propKey, theValue);\r\n                                newProp = _callFieldSanitizer(fieldProvider, newPath, propKey, getFieldValueType(theValue), newProp);\r\n                                if (newProp) {\r\n                                    newValue_1[propKey] = newProp[_DYN_VALUE /* @min:%2evalue */];\r\n                                }\r\n                            }\r\n                        });\r\n                        property[_DYN_VALUE /* @min:%2evalue */] = newValue_1;\r\n                    }\r\n                    else {\r\n                        var details = {\r\n                            path: path,\r\n                            name: name,\r\n                            type: theType,\r\n                            prop: property,\r\n                            sanitizer: _self\r\n                        };\r\n                        property = sanitizer.call(_self, details);\r\n                    }\r\n                }\r\n            }\r\n            return property;\r\n        }\r\n    }\r\n    ValueSanitizer.getFieldType = getFieldValueType;\r\n    return ValueSanitizer;\r\n}());\r\nexport { ValueSanitizer };\r\n//# sourceMappingURL=ValueSanitizer.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\"use strict\";\r\nexport var MinChannelPriorty = 100;\r\n//# sourceMappingURL=IChannelControls.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\n//  @skip-file-minify\r\nimport { createEnumStyle } from \"../JavaScriptSDK.Enums/EnumHelperFuncs\";\r\nexport var LoggingSeverity = createEnumStyle({\r\n    DISABLED: 0 /* eLoggingSeverity.DISABLED */,\r\n    CRITICAL: 1 /* eLoggingSeverity.CRITICAL */,\r\n    WARNING: 2 /* eLoggingSeverity.WARNING */,\r\n    DEBUG: 3 /* eLoggingSeverity.DEBUG */\r\n});\r\n//# sourceMappingURL=LoggingEnums.js.map","/*\n * 1DS JS SDK Core, 4.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n * (Microsoft Internal Only)\n */\n\r\n// Licensed under the MIT License.\r\n// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n// Note: DON'T Export these const from the package as we are still targeting ES3 this will export a mutable variables that someone could change!!!\r\n// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n// Generally you should only put values that are used more than 2 times and then only if not already exposed as a constant (such as SdkCoreNames)\r\n// as when using \"short\" named values from here they will be will be minified smaller than the SdkCoreNames[eSdkCoreNames.xxxx] value.\r\nexport var STR_EMPTY = \"\";\r\nexport var STR_DEFAULT_ENDPOINT_URL = \"https://browser.events.data.microsoft.com/OneCollector/1.0/\";\r\nexport var STR_VERSION = \"version\";\r\nexport var STR_PROPERTIES = \"properties\";\r\n//# sourceMappingURL=InternalConstants.js.map","/*\n * 1DS JS SDK Core, 4.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n * (Microsoft Internal Only)\n */\nvar _a;\r\n/**\r\n* Utils.ts\r\n* @author  Abhilash Panwar (abpanwar) Hector Hernandez (hectorh)\r\n* @copyright Microsoft 2018\r\n* File containing utility functions.\r\n*/\r\nimport { arrForEach, getGlobalInst, getNavigator, hasDocument, hasWindow, isArray, isBoolean, isNullOrUndefined, isNumber, isObject, isReactNative, isString, isUndefined, newGuid, objForEachKey, perfNow } from \"@microsoft/applicationinsights-core-js\";\r\nimport { ObjProto, strShimObject } from \"@microsoft/applicationinsights-shims\";\r\nimport { strIndexOf, strLeft } from \"@nevware21/ts-utils\";\r\nimport { STR_EMPTY } from \"./InternalConstants\";\r\nimport { _DYN_INDEX_OF, _DYN_KIND, _DYN_LENGTH, _DYN_PROCESS_TELEMETRY_ST0, _DYN_TIMINGS, _DYN_VALUE } from \"./__DynamicConstants\";\r\nexport var Version = '4.3.4';\r\nexport var FullVersionString = \"1DS-Web-JS-\" + Version;\r\nvar ObjHasOwnProperty = ObjProto.hasOwnProperty;\r\n// Defining here so we don't need to take (import) the ApplicationInsights Common module\r\nvar strDisabledPropertyName = \"Microsoft_ApplicationInsights_BypassAjaxInstrumentation\";\r\nvar strWithCredentials = \"withCredentials\";\r\nvar strTimeout = \"timeout\";\r\n// If value is array just get the type for the first element\r\nvar _fieldTypeEventPropMap = (_a = {},\r\n    _a[0 /* FieldValueSanitizerType.NotSet */] = 0 /* eEventPropertyType.Unspecified */,\r\n    _a[2 /* FieldValueSanitizerType.Number */] = 6 /* eEventPropertyType.Double */,\r\n    _a[1 /* FieldValueSanitizerType.String */] = 1 /* eEventPropertyType.String */,\r\n    _a[3 /* FieldValueSanitizerType.Boolean */] = 7 /* eEventPropertyType.Bool */,\r\n    _a[4096 /* FieldValueSanitizerType.Array */ | 2 /* FieldValueSanitizerType.Number */] = 6 /* eEventPropertyType.Double */,\r\n    _a[4096 /* FieldValueSanitizerType.Array */ | 1 /* FieldValueSanitizerType.String */] = 1 /* eEventPropertyType.String */,\r\n    _a[4096 /* FieldValueSanitizerType.Array */ | 3 /* FieldValueSanitizerType.Boolean */] = 7 /* eEventPropertyType.Bool */,\r\n    _a);\r\n/**\r\n * @ignore\r\n */\r\n// let _uaDisallowsSameSiteNone = null;\r\nvar uInt8ArraySupported = null;\r\n// var _areCookiesAvailable: boolean | undefined;\r\n/**\r\n * Checks if document object is available\r\n */\r\nexport var isDocumentObjectAvailable = hasDocument();\r\n/**\r\n * Checks if window object is available\r\n */\r\nexport var isWindowObjectAvailable = hasWindow();\r\n/**\r\n * Checks if value is assigned to the given param.\r\n * @param value - The token from which the tenant id is to be extracted.\r\n * @returns True/false denoting if value is assigned to the param.\r\n */\r\nexport function isValueAssigned(value) {\r\n    /// <summary> takes a value and checks for undefined, null and empty string </summary>\r\n    /// <param type=\"any\"> value to be tested </param>\r\n    /// <returns> true if value is null undefined or emptyString </returns>\r\n    return !(value === STR_EMPTY || isNullOrUndefined(value));\r\n}\r\n/**\r\n * Gets the tenant id from the tenant token.\r\n * @param apiKey - The token from which the tenant id is to be extracted.\r\n * @returns The tenant id.\r\n */\r\nexport function getTenantId(apiKey) {\r\n    if (apiKey) {\r\n        var indexTenantId = strIndexOf(apiKey, \"-\");\r\n        if (indexTenantId > -1) {\r\n            return strLeft(apiKey, indexTenantId);\r\n        }\r\n    }\r\n    return STR_EMPTY;\r\n}\r\n/**\r\n * Checks if Uint8Array are available in the current environment. Safari and Firefox along with\r\n * ReactNative are known to not support Uint8Array properly.\r\n * @returns True if available, false otherwise.\r\n */\r\nexport function isUint8ArrayAvailable() {\r\n    if (uInt8ArraySupported === null) {\r\n        uInt8ArraySupported = !isUndefined(Uint8Array) && !isSafariOrFirefox() && !isReactNative();\r\n    }\r\n    return uInt8ArraySupported;\r\n}\r\n/**\r\n * Checks if the value is a valid EventLatency.\r\n * @param value - The value that needs to be checked.\r\n * @returns True if the value is in AWTEventLatency, false otherwise.\r\n */\r\nexport function isLatency(value) {\r\n    if (value && isNumber(value) && value >= 1 /* EventLatencyValue.Normal */ && value <= 4 /* EventLatencyValue.Immediate */) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * Sanitizes the Property. It checks the that the property name and value are valid. It also\r\n * checks/populates the correct type and pii of the property value.\r\n * @param name - property name                          - The property name.\r\n * @param property - The property value or an IEventProperty containing value,\r\n * type ,pii and customer content.\r\n * @returns IEventProperty containing valid name, value, pii and type or null if invalid.\r\n */\r\nexport function sanitizeProperty(name, property, stringifyObjects) {\r\n    // Check that property is valid\r\n    if ((!property && !isValueAssigned(property)) || typeof name !== \"string\") {\r\n        return null;\r\n    }\r\n    // Perf optimization -- only need to get the type once not multiple times\r\n    var propType = typeof property;\r\n    // If the property isn't IEventProperty (and is either string, number, boolean or array), convert it into one.\r\n    if (propType === \"string\" || propType === \"number\" || propType === \"boolean\" || isArray(property)) {\r\n        property = { value: property };\r\n    }\r\n    else if (propType === \"object\" && !ObjHasOwnProperty.call(property, \"value\")) {\r\n        property = { value: stringifyObjects ? JSON.stringify(property) : property };\r\n    }\r\n    else if (isNullOrUndefined(property[_DYN_VALUE /* @min:%2evalue */])\r\n        || property[_DYN_VALUE /* @min:%2evalue */] === STR_EMPTY || (!isString(property[_DYN_VALUE /* @min:%2evalue */])\r\n        && !isNumber(property[_DYN_VALUE /* @min:%2evalue */]) && !isBoolean(property[_DYN_VALUE /* @min:%2evalue */])\r\n        && !isArray(property[_DYN_VALUE /* @min:%2evalue */]))) {\r\n        // Since property is IEventProperty, we need to validate its value\r\n        return null;\r\n    }\r\n    // We need to check that if the property value is an array, it is valid\r\n    if (isArray(property[_DYN_VALUE /* @min:%2evalue */]) &&\r\n        !isArrayValid(property[_DYN_VALUE /* @min:%2evalue */])) {\r\n        return null;\r\n    }\r\n    // If either pii or cc is set convert value to string (since only string pii/cc is allowed).\r\n    // If the value is a complex type like an array that can't be converted to string we will drop\r\n    // the property.\r\n    if (!isNullOrUndefined(property[_DYN_KIND /* @min:%2ekind */])) {\r\n        if (isArray(property[_DYN_VALUE /* @min:%2evalue */]) || !isValueKind(property[_DYN_KIND /* @min:%2ekind */])) {\r\n            return null;\r\n        }\r\n        property[_DYN_VALUE /* @min:%2evalue */] = property[_DYN_VALUE /* @min:%2evalue */].toString();\r\n    }\r\n    return property;\r\n}\r\nexport function getCommonSchemaMetaData(value, kind, type) {\r\n    var encodedTypeValue = -1;\r\n    if (!isUndefined(value)) {\r\n        if (kind > 0) {\r\n            if (kind === 32 /* eValueKind.CustomerContent_GenericContent */) {\r\n                // encode customer content. Value can only be string. bit 13-16 are for cc\r\n                encodedTypeValue = (1 << 13);\r\n            }\r\n            else if (kind <= 13) {\r\n                // encode PII. Value can only be string. bits 5-12 are for Pii\r\n                encodedTypeValue = (kind << 5);\r\n            }\r\n        }\r\n        // isDataType checks that the \"type\" is a number so we don't need to check for undefined\r\n        if (isDataType(type)) {\r\n            // Data Type is provided and valid, so use that\r\n            if (encodedTypeValue === -1) {\r\n                // Don't return -1\r\n                encodedTypeValue = 0;\r\n            }\r\n            encodedTypeValue |= type;\r\n        }\r\n        else {\r\n            var propType = _fieldTypeEventPropMap[getFieldValueType(value)] || -1;\r\n            if (encodedTypeValue !== -1 && propType !== -1) {\r\n                // pii exists so we must return correct type\r\n                encodedTypeValue |= propType;\r\n            }\r\n            else if (propType === 6 /* eEventPropertyType.Double */) {\r\n                encodedTypeValue = propType;\r\n            }\r\n        }\r\n    }\r\n    return encodedTypeValue;\r\n}\r\n/**\r\n * Helper to get and decode the cookie value using decodeURIComponent, this is for historical\r\n * backward compatibility where the document.cookie value was decoded before parsing.\r\n * @param cookieMgr - The cookie manager to use\r\n * @param name - The name of the cookie to get\r\n * @param decode - A flag to indicate whether the cookie value should be decoded\r\n * @returns The decoded cookie value (if available) otherwise an empty string.\r\n */\r\nexport function getCookieValue(cookieMgr, name, decode) {\r\n    if (decode === void 0) { decode = true; }\r\n    var cookieValue;\r\n    if (cookieMgr) {\r\n        cookieValue = cookieMgr.get(name);\r\n        if (decode && cookieValue && decodeURIComponent) {\r\n            cookieValue = decodeURIComponent(cookieValue);\r\n        }\r\n    }\r\n    return cookieValue || STR_EMPTY;\r\n}\r\n/**\r\n * Create a new guid.\r\n * @param style - The style of guid to generated, defaults to Digits\r\n * Digits (Default) : 32 digits separated by hyphens: 00000000-0000-0000-0000-000000000000\r\n * Braces - 32 digits separated by hyphens, enclosed in braces: {00000000-0000-0000-0000-000000000000}\r\n * Parentheses - 32 digits separated by hyphens, enclosed in parentheses: (00000000-0000-0000-0000-000000000000)\r\n * Numeric - 32 digits: 00000000000000000000000000000000\r\n * @returns The formatted guid.\r\n */\r\nexport function createGuid(style) {\r\n    if (style === void 0) { style = \"D\" /* GuidStyle.Digits */; }\r\n    var theGuid = newGuid();\r\n    if (style === \"B\" /* GuidStyle.Braces */) {\r\n        theGuid = \"{\" + theGuid + \"}\";\r\n    }\r\n    else if (style === \"P\" /* GuidStyle.Parentheses */) {\r\n        theGuid = \"(\" + theGuid + \")\";\r\n    }\r\n    else if (style === \"N\" /* GuidStyle.Numeric */) {\r\n        theGuid = theGuid.replace(/-/g, STR_EMPTY);\r\n    }\r\n    return theGuid;\r\n}\r\n/**\r\n * Pass in the objects to merge as arguments.\r\n * @param obj1 - object to merge.  Set this argument to 'true' for a deep extend.\r\n * @param obj2 - object to merge.\r\n * @param obj3 - object to merge.\r\n * @param obj4 - object to merge.\r\n * @param obj5 - object to merge.\r\n * @returns The extended object.\r\n */\r\nexport function extend(obj, obj2, obj3, obj4, obj5) {\r\n    // Variables\r\n    var extended = {};\r\n    var deep = false;\r\n    var i = 0;\r\n    var length = arguments[_DYN_LENGTH /* @min:%2elength */];\r\n    var theArgs = arguments;\r\n    // Check if a deep merge\r\n    if (isBoolean(theArgs[0])) {\r\n        deep = theArgs[0];\r\n        i++;\r\n    }\r\n    // Loop through each object and conduct a merge\r\n    for (; i < length; i++) {\r\n        var obj = theArgs[i];\r\n        objForEachKey(obj, function (prop, value) {\r\n            // If deep merge and property is an object, merge properties\r\n            if (deep && value && isObject(value)) {\r\n                if (isArray(value)) {\r\n                    extended[prop] = extended[prop] || [];\r\n                    arrForEach(value, function (arrayValue, arrayIndex) {\r\n                        if (arrayValue && isObject(arrayValue)) {\r\n                            extended[prop][arrayIndex] = extend(true, extended[prop][arrayIndex], arrayValue);\r\n                        }\r\n                        else {\r\n                            extended[prop][arrayIndex] = arrayValue;\r\n                        }\r\n                    });\r\n                }\r\n                else {\r\n                    extended[prop] = extend(true, extended[prop], value);\r\n                }\r\n            }\r\n            else {\r\n                extended[prop] = value;\r\n            }\r\n        });\r\n    }\r\n    return extended;\r\n}\r\nexport var getTime = perfNow;\r\nexport function isValueKind(value) {\r\n    // Always assume that it's a number (no type checking) for performance as this is used during the JSON serialization\r\n    if (value === 0 /* eValueKind.NotSet */ || ((value > 0 /* eValueKind.NotSet */ && value <= 13 /* eValueKind.Pii_IPV4AddressLegacy */) || value === 32 /* eValueKind.CustomerContent_GenericContent */)) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\nfunction isDataType(value) {\r\n    // Remark: 0 returns false, but it doesn't affect encoding anyways\r\n    // Always assume that it's a number (no type checking) for performance as this is used during the JSON serialization\r\n    if (value >= 0 && value <= 9) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\nfunction isSafariOrFirefox() {\r\n    var nav = getNavigator();\r\n    // If non-browser navigator will be undefined\r\n    if (!isUndefined(nav) && nav.userAgent) {\r\n        var ua = nav.userAgent.toLowerCase();\r\n        if ((ua[_DYN_INDEX_OF /* @min:%2eindexOf */](\"safari\") >= 0 || ua[_DYN_INDEX_OF /* @min:%2eindexOf */](\"firefox\") >= 0) && ua[_DYN_INDEX_OF /* @min:%2eindexOf */](\"chrome\") < 0) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nexport function isArrayValid(value) {\r\n    return value[_DYN_LENGTH /* @min:%2elength */] > 0;\r\n}\r\nexport function setProcessTelemetryTimings(event, identifier) {\r\n    var evt = event;\r\n    evt[_DYN_TIMINGS /* @min:%2etimings */] = evt[_DYN_TIMINGS /* @min:%2etimings */] || {};\r\n    evt[_DYN_TIMINGS /* @min:%2etimings */][_DYN_PROCESS_TELEMETRY_ST0 /* @min:%2eprocessTelemetryStart */] = evt[_DYN_TIMINGS /* @min:%2etimings */][_DYN_PROCESS_TELEMETRY_ST0 /* @min:%2eprocessTelemetryStart */] || {};\r\n    evt[_DYN_TIMINGS /* @min:%2etimings */][_DYN_PROCESS_TELEMETRY_ST0 /* @min:%2eprocessTelemetryStart */][identifier] = getTime();\r\n}\r\n/**\r\n * Returns a bitwise value for the FieldValueSanitizerType enum representing the decoded type of the passed value\r\n * @param value The value to determine the type\r\n */\r\nexport function getFieldValueType(value) {\r\n    var theType = 0 /* FieldValueSanitizerType.NotSet */;\r\n    if (value !== null && value !== undefined) {\r\n        var objType = typeof value;\r\n        if (objType === \"string\") {\r\n            theType = 1 /* FieldValueSanitizerType.String */;\r\n        }\r\n        else if (objType === \"number\") {\r\n            theType = 2 /* FieldValueSanitizerType.Number */;\r\n        }\r\n        else if (objType === \"boolean\") {\r\n            theType = 3 /* FieldValueSanitizerType.Boolean */;\r\n        }\r\n        else if (objType === strShimObject) {\r\n            theType = 4 /* FieldValueSanitizerType.Object */;\r\n            if (isArray(value)) {\r\n                theType = 4096 /* FieldValueSanitizerType.Array */;\r\n                if (value[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                    // Empty arrays are not supported and are considered to be the same as null\r\n                    theType |= getFieldValueType(value[0]);\r\n                }\r\n            }\r\n            else if (ObjHasOwnProperty.call(value, \"value\")) {\r\n                // Looks like an IEventProperty\r\n                theType = 8192 /* FieldValueSanitizerType.EventProperty */ | getFieldValueType(value[_DYN_VALUE /* @min:%2evalue */]);\r\n            }\r\n        }\r\n    }\r\n    return theType;\r\n}\r\n/**\r\n * Helper to identify whether we are running in a chromium based browser environment\r\n */\r\nexport function isChromium() {\r\n    return !!getGlobalInst(\"chrome\");\r\n}\r\n/**\r\n * Create and open an XMLHttpRequest object\r\n * @param method - The request method\r\n * @param urlString - The url\r\n * @param withCredentials - Option flag indicating that credentials should be sent\r\n * @param disabled - Optional flag indicating that the XHR object should be marked as disabled and not tracked (default is false)\r\n * @param isSync - Optional flag indicating if the instance should be a synchronous request (defaults to false)\r\n * @param timeout - Optional value identifying the timeout value that should be assigned to the XHR request\r\n * @returns A new opened XHR request\r\n */\r\nexport function openXhr(method, urlString, withCredentials, disabled, isSync, timeout) {\r\n    if (disabled === void 0) { disabled = false; }\r\n    if (isSync === void 0) { isSync = false; }\r\n    function _wrapSetXhrProp(xhr, prop, value) {\r\n        try {\r\n            xhr[prop] = value;\r\n        }\r\n        catch (e) {\r\n            // - Wrapping as depending on the environment setting the property may fail (non-terminally)\r\n        }\r\n    }\r\n    var xhr = new XMLHttpRequest();\r\n    if (disabled) {\r\n        // Tag the instance so it's not tracked (trackDependency)\r\n        // If the environment has locked down the XMLHttpRequest (preventExtensions and/or freeze), this would\r\n        // cause the request to fail and we no telemetry would be sent\r\n        _wrapSetXhrProp(xhr, strDisabledPropertyName, disabled);\r\n    }\r\n    if (withCredentials) {\r\n        // Some libraries require that the withCredentials flag is set \"before\" open and\r\n        // - Wrapping as IE 10 has started throwing when setting before open\r\n        _wrapSetXhrProp(xhr, strWithCredentials, withCredentials);\r\n    }\r\n    xhr.open(method, urlString, !isSync);\r\n    if (withCredentials) {\r\n        // withCredentials should be set AFTER open (https://xhr.spec.whatwg.org/#the-withcredentials-attribute)\r\n        // And older firefox instances from 11+ will throw for sync events (current versions don't) which happens during unload processing\r\n        _wrapSetXhrProp(xhr, strWithCredentials, withCredentials);\r\n    }\r\n    // Only set the timeout for asynchronous requests as\r\n    // \"Timeout shouldn't be used for synchronous XMLHttpRequests requests used in a document environment or it will throw an InvalidAccessError exception.\"\"\r\n    // https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/timeout\r\n    if (!isSync && timeout) {\r\n        _wrapSetXhrProp(xhr, strTimeout, timeout);\r\n    }\r\n    return xhr;\r\n}\r\n/**\r\n * Check to see if the value is > 0\r\n * @param value - The value to check\r\n * @returns true if > 0 otherwise false\r\n */\r\nexport function isGreaterThanZero(value) {\r\n    return value > 0;\r\n}\r\n//# sourceMappingURL=Utils.js.map","/*\n * 1DS JS SDK Core, 4.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n * (Microsoft Internal Only)\n */\n\r\n// Licensed under the MIT License.\r\n// @skip-file-minify\r\n// ##############################################################\r\n// AUTO GENERATED FILE: This file is Auto Generated during build.\r\n// ##############################################################\r\n// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n// Note: DON'T Export these const from the package as we are still targeting ES3 this will export a mutable variables that someone could change!!!\r\n// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\nexport var _DYN_INITIALIZE = \"initialize\"; // Count: 4\r\nexport var _DYN_LOGGER = \"logger\"; // Count: 4\r\nexport var _DYN_INDEX_OF = \"indexOf\"; // Count: 4\r\nexport var _DYN_TIMINGS = \"timings\"; // Count: 4\r\nexport var _DYN_POLL_INTERNAL_LOGS = \"pollInternalLogs\"; // Count: 4\r\nexport var _DYN_VALUE = \"value\"; // Count: 20\r\nexport var _DYN_KIND = \"kind\"; // Count: 5\r\nexport var _DYN_LENGTH = \"length\"; // Count: 7\r\nexport var _DYN_PROCESS_TELEMETRY_ST0 = \"processTelemetryStart\"; // Count: 3\r\nexport var _DYN_HANDLE_FIELD = \"handleField\"; // Count: 3\r\nexport var _DYN_RM_SANITIZER = \"rmSanitizer\"; // Count: 3\r\nexport var _DYN_RM_FIELD_SANITIZER = \"rmFieldSanitizer\"; // Count: 3\r\nexport var _DYN_CAN_HANDLE = \"canHandle\"; // Count: 7\r\n//# sourceMappingURL=__DynamicConstants.js.map","/*\n * 1DS JS SDK POST plugin, 4.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n * (Microsoft Internal Only)\n */\n/**\r\n * Real Time profile (default profile). RealTime Latency events are sent every 1 sec and\r\n * Normal Latency events are sent every 2 sec.\r\n */\r\nexport var RT_PROFILE = \"REAL_TIME\";\r\n/**\r\n * Near Real Time profile. RealTime Latency events are sent every 3 sec and\r\n * Normal Latency events are sent every 6 sec.\r\n */\r\nexport var NRT_PROFILE = \"NEAR_REAL_TIME\";\r\n/**\r\n * Best Effort. RealTime Latency events are sent every 9 sec and\r\n * Normal Latency events are sent every 18 sec.\r\n */\r\nexport var BE_PROFILE = \"BEST_EFFORT\";\r\n//# sourceMappingURL=DataModels.js.map","/*\n * 1DS JS SDK POST plugin, 4.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n * (Microsoft Internal Only)\n */\n\r\n// Licensed under the MIT License.\r\n// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n// Note: DON'T Export these const from the package as we are still targeting ES3 this will export a mutable variables that someone could change!!!\r\n// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n// Generally you should only put values that are used more than 2 times and then only if not already exposed as a constant (such as SdkCoreNames)\r\n// as when using \"short\" named values from here they will be will be minified smaller than the SdkCoreNames[eSdkCoreNames.xxxx] value.\r\nexport var STR_EMPTY = \"\";\r\nexport var STR_POST_METHOD = \"POST\";\r\nexport var STR_DISABLED_PROPERTY_NAME = \"Microsoft_ApplicationInsights_BypassAjaxInstrumentation\";\r\nexport var STR_DROPPED = \"drop\";\r\nexport var STR_SENDING = \"send\";\r\nexport var STR_REQUEUE = \"requeue\";\r\nexport var STR_RESPONSE_FAIL = \"rspFail\";\r\nexport var STR_OTHER = \"oth\";\r\nexport var DEFAULT_CACHE_CONTROL = \"no-cache, no-store\";\r\nexport var DEFAULT_CONTENT_TYPE = \"application/x-json-stream\";\r\nexport var STR_CACHE_CONTROL = \"cache-control\";\r\nexport var STR_CONTENT_TYPE_HEADER = \"content-type\";\r\nexport var STR_KILL_TOKENS_HEADER = \"kill-tokens\";\r\nexport var STR_KILL_DURATION_HEADER = \"kill-duration\";\r\nexport var STR_KILL_DURATION_SECONDS_HEADER = \"kill-duration-seconds\";\r\nexport var STR_TIME_DELTA_HEADER = \"time-delta-millis\";\r\nexport var STR_CLIENT_VERSION = \"client-version\";\r\nexport var STR_CLIENT_ID = \"client-id\";\r\nexport var STR_TIME_DELTA_TO_APPLY = \"time-delta-to-apply-millis\";\r\nexport var STR_UPLOAD_TIME = \"upload-time\";\r\nexport var STR_API_KEY = \"apikey\";\r\nexport var STR_MSA_DEVICE_TICKET = \"AuthMsaDeviceTicket\";\r\nexport var STR_AUTH_WEB_TOKEN = \"WebAuthToken\";\r\nexport var STR_AUTH_XTOKEN = \"AuthXToken\";\r\nexport var STR_SDK_VERSION = \"sdk-version\";\r\nexport var STR_NO_RESPONSE_BODY = \"NoResponseBody\";\r\nexport var STR_MSFPC = \"msfpc\";\r\nexport var STR_TRACE = \"trace\";\r\nexport var STR_USER = \"user\";\r\n//# sourceMappingURL=InternalConstants.js.map","/*\n * 1DS JS SDK POST plugin, 4.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n * (Microsoft Internal Only)\n */\n\r\n// Licensed under the MIT License.\r\n// @skip-file-minify\r\n// ##############################################################\r\n// AUTO GENERATED FILE: This file is Auto Generated during build.\r\n// ##############################################################\r\n// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n// Note: DON'T Export these const from the package as we are still targeting ES3 this will export a mutable variables that someone could change!!!\r\n// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\nexport var _DYN_ALLOW_REQUEST_SENDIN0 = \"allowRequestSending\"; // Count: 3\r\nexport var _DYN_FIRST_REQUEST_SENT = \"firstRequestSent\"; // Count: 2\r\nexport var _DYN_SHOULD_ADD_CLOCK_SKE1 = \"shouldAddClockSkewHeaders\"; // Count: 2\r\nexport var _DYN_GET_CLOCK_SKEW_HEADE2 = \"getClockSkewHeaderValue\"; // Count: 2\r\nexport var _DYN_SET_CLOCK_SKEW = \"setClockSkew\"; // Count: 3\r\nexport var _DYN_LENGTH = \"length\"; // Count: 38\r\nexport var _DYN_CONCAT = \"concat\"; // Count: 7\r\nexport var _DYN_I_KEY = \"iKey\"; // Count: 11\r\nexport var _DYN_COUNT = \"count\"; // Count: 19\r\nexport var _DYN_EVENTS = \"events\"; // Count: 8\r\nexport var _DYN_PUSH = \"push\"; // Count: 15\r\nexport var _DYN_SPLIT = \"split\"; // Count: 6\r\nexport var _DYN_SPLICE = \"splice\"; // Count: 4\r\nexport var _DYN_TO_LOWER_CASE = \"toLowerCase\"; // Count: 3\r\nexport var _DYN_HDRS = \"hdrs\"; // Count: 7\r\nexport var _DYN_USE_HDRS = \"useHdrs\"; // Count: 5\r\nexport var _DYN_INITIALIZE = \"initialize\"; // Count: 5\r\nexport var _DYN_SET_TIMEOUT_OVERRIDE = \"setTimeoutOverride\"; // Count: 3\r\nexport var _DYN_CLEAR_TIMEOUT_OVERRI3 = \"clearTimeoutOverride\"; // Count: 3\r\nexport var _DYN_PAYLOAD_PREPROCESSOR = \"payloadPreprocessor\"; // Count: 2\r\nexport var _DYN_OVERRIDE_ENDPOINT_UR4 = \"overrideEndpointUrl\"; // Count: 3\r\nexport var _DYN_AVOID_OPTIONS = \"avoidOptions\"; // Count: 3\r\nexport var _DYN_DISABLE_EVENT_TIMING5 = \"disableEventTimings\"; // Count: 2\r\nexport var _DYN_STRINGIFY_OBJECTS = \"stringifyObjects\"; // Count: 2\r\nexport var _DYN_ENABLE_COMPOUND_KEY = \"enableCompoundKey\"; // Count: 4\r\nexport var _DYN_DISABLE_XHR_SYNC = \"disableXhrSync\"; // Count: 6\r\nexport var _DYN_DISABLE_FETCH_KEEP_A6 = \"disableFetchKeepAlive\"; // Count: 7\r\nexport var _DYN_ADD_NO_RESPONSE = \"addNoResponse\"; // Count: 3\r\nexport var _DYN_EXCLUDE_CS_META_DATA = \"excludeCsMetaData\"; // Count: 2\r\nexport var _DYN_USE_SEND_BEACON = \"useSendBeacon\"; // Count: 3\r\nexport var _DYN_FETCH_CREDENTIALS = \"fetchCredentials\"; // Count: 4\r\nexport var _DYN_ALWAYS_USE_XHR_OVERR7 = \"alwaysUseXhrOverride\"; // Count: 3\r\nexport var _DYN_UNLOAD_TRANSPORTS = \"unloadTransports\"; // Count: 2\r\nexport var _DYN_SERIALIZE_OFFLINE_EV8 = \"serializeOfflineEvt\"; // Count: 2\r\nexport var _DYN_GET_OFFLINE_REQUEST_9 = \"getOfflineRequestDetails\"; // Count: 2\r\nexport var _DYN_CREATE_PAYLOAD = \"createPayload\"; // Count: 4\r\nexport var _DYN_CREATE_ONE_DSPAYLOAD = \"createOneDSPayload\"; // Count: 4\r\nexport var _DYN_PAYLOAD_BLOB = \"payloadBlob\"; // Count: 3\r\nexport var _DYN_HEADERS = \"headers\"; // Count: 12\r\nexport var _DYN__THE_PAYLOAD = \"_thePayload\"; // Count: 6\r\nexport var _DYN_URL_STRING = \"urlString\"; // Count: 5\r\nexport var _DYN_BATCHES = \"batches\"; // Count: 15\r\nexport var _DYN_SEND_TYPE = \"sendType\"; // Count: 13\r\nexport var _DYN_ADD_HEADER = \"addHeader\"; // Count: 3\r\nexport var _DYN_CAN_SEND_REQUEST = \"canSendRequest\"; // Count: 3\r\nexport var _DYN_SEND_QUEUED_REQUESTS = \"sendQueuedRequests\"; // Count: 5\r\nexport var _DYN_IS_COMPLETELY_IDLE = \"isCompletelyIdle\"; // Count: 2\r\nexport var _DYN_SET_UNLOADING = \"setUnloading\"; // Count: 3\r\nexport var _DYN_IS_TENANT_KILLED = \"isTenantKilled\"; // Count: 3\r\nexport var _DYN_RESUME = \"resume\"; // Count: 4\r\nexport var _DYN_SEND_SYNCHRONOUS_BAT10 = \"sendSynchronousBatch\"; // Count: 2\r\nexport var _DYN__TRANSPORT = \"_transport\"; // Count: 3\r\nexport var _DYN_GET_WPARAM = \"getWParam\"; // Count: 4\r\nexport var _DYN_IS_BEACON = \"isBeacon\"; // Count: 4\r\nexport var _DYN_TIMINGS = \"timings\"; // Count: 4\r\nexport var _DYN_IS_TEARDOWN = \"isTeardown\"; // Count: 3\r\nexport var _DYN_IS_SYNC = \"isSync\"; // Count: 4\r\nexport var _DYN_DATA = \"data\"; // Count: 7\r\nexport var _DYN_TIMEOUT = \"timeout\"; // Count: 4\r\nexport var _DYN__SEND_REASON = \"_sendReason\"; // Count: 4\r\nexport var _DYN_SET_KILL_SWITCH_TENA11 = \"setKillSwitchTenants\"; // Count: 2\r\nexport var _DYN__BACK_OFF_TRANSMISSI12 = \"_backOffTransmission\"; // Count: 2\r\nexport var _DYN_IDENTIFIER = \"identifier\"; // Count: 4\r\nexport var _DYN_DISABLE_OPTIMIZE_OBJ = \"disableOptimizeObj\"; // Count: 2\r\nexport var _DYN_IGNORE_MC1_MS0_COOKI13 = \"ignoreMc1Ms0CookieProcessing\"; // Count: 2\r\nexport var _DYN_EVENTS_LIMIT_IN_MEM = \"eventsLimitInMem\"; // Count: 2\r\nexport var _DYN_AUTO_FLUSH_EVENTS_LI14 = \"autoFlushEventsLimit\"; // Count: 2\r\nexport var _DYN_DISABLE_AUTO_BATCH_F15 = \"disableAutoBatchFlushLimit\"; // Count: 2\r\nexport var _DYN_OVERRIDE_INSTRUMENTA16 = \"overrideInstrumentationKey\"; // Count: 2\r\nexport var _DYN_DISABLE_TELEMETRY = \"disableTelemetry\"; // Count: 2\r\nexport var _DYN_BASE_DATA = \"baseData\"; // Count: 3\r\nexport var _DYN_SEND_ATTEMPT = \"sendAttempt\"; // Count: 4\r\nexport var _DYN_LATENCY = \"latency\"; // Count: 7\r\nexport var _DYN_SYNC = \"sync\"; // Count: 7\r\n//# sourceMappingURL=__DynamicConstants.js.map","/*\n * 1DS JS SDK POST plugin, 4.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n * (Microsoft Internal Only)\n */\n/**\r\n* EventBatch.ts\r\n* @author Nev Wylie (newylie)\r\n* @copyright Microsoft 2020\r\n*/\r\nimport { isNullOrUndefined, isValueAssigned } from \"@microsoft/1ds-core-js\";\r\nimport { STR_EMPTY, STR_MSFPC } from \"./InternalConstants\";\r\nimport { _DYN_CONCAT, _DYN_COUNT, _DYN_EVENTS, _DYN_I_KEY, _DYN_LENGTH, _DYN_PUSH, _DYN_SPLICE, _DYN_SPLIT } from \"./__DynamicConstants\";\r\nfunction _getEventMsfpc(theEvent) {\r\n    var intWeb = ((theEvent.ext || {})[\"intweb\"]);\r\n    if (intWeb && isValueAssigned(intWeb[STR_MSFPC])) {\r\n        return intWeb[STR_MSFPC];\r\n    }\r\n    return null;\r\n}\r\nfunction _getMsfpc(theEvents) {\r\n    var msfpc = null;\r\n    for (var lp = 0; msfpc === null && lp < theEvents[_DYN_LENGTH /* @min:%2elength */]; lp++) {\r\n        msfpc = _getEventMsfpc(theEvents[lp]);\r\n    }\r\n    return msfpc;\r\n}\r\n/**\r\n* This class defines a \"batch\" events related to a specific iKey, it is used by the PostChannel and HttpManager\r\n* to collect and transfer ownership of events without duplicating them in-memory. This reduces the previous\r\n* array duplication and shared ownership issues that occurred due to race conditions caused by the async nature\r\n* of sending requests.\r\n*/\r\nvar EventBatch = /** @class */ (function () {\r\n    /**\r\n     * Private constructor so that caller is forced to use the static create method.\r\n     * @param iKey - The iKey to associate with the events (not validated)\r\n     * @param addEvents - The optional collection of events to assign to this batch - defaults to an empty array.\r\n     */\r\n    function EventBatch(iKey, addEvents) {\r\n        var events = addEvents ? [][_DYN_CONCAT /* @min:%2econcat */](addEvents) : [];\r\n        var _self = this;\r\n        var _msfpc = _getMsfpc(events);\r\n        _self[_DYN_I_KEY /* @min:%2eiKey */] = function () {\r\n            return iKey;\r\n        };\r\n        _self.Msfpc = function () {\r\n            // return the cached value unless it's undefined -- used to avoid cpu\r\n            return _msfpc || STR_EMPTY;\r\n        };\r\n        _self[_DYN_COUNT /* @min:%2ecount */] = function () {\r\n            return events[_DYN_LENGTH /* @min:%2elength */];\r\n        };\r\n        _self[_DYN_EVENTS /* @min:%2eevents */] = function () {\r\n            return events;\r\n        };\r\n        _self.addEvent = function (theEvent) {\r\n            if (theEvent) {\r\n                events[_DYN_PUSH /* @min:%2epush */](theEvent);\r\n                if (!_msfpc) {\r\n                    // Not found so try and find one\r\n                    _msfpc = _getEventMsfpc(theEvent);\r\n                }\r\n                return true;\r\n            }\r\n            return false;\r\n        };\r\n        _self[_DYN_SPLIT /* @min:%2esplit */] = function (fromEvent, numEvents) {\r\n            // Create a new batch with the same iKey\r\n            var theEvents;\r\n            if (fromEvent < events[_DYN_LENGTH /* @min:%2elength */]) {\r\n                var cnt = events[_DYN_LENGTH /* @min:%2elength */] - fromEvent;\r\n                if (!isNullOrUndefined(numEvents)) {\r\n                    cnt = numEvents < cnt ? numEvents : cnt;\r\n                }\r\n                theEvents = events[_DYN_SPLICE /* @min:%2esplice */](fromEvent, cnt);\r\n                // reset the fetched msfpc value\r\n                _msfpc = _getMsfpc(events);\r\n            }\r\n            return new EventBatch(iKey, theEvents);\r\n        };\r\n    }\r\n    /**\r\n     * Creates a new Event Batch object\r\n     * @param iKey The iKey associated with this batch of events\r\n     */\r\n    EventBatch.create = function (iKey, theEvents) {\r\n        return new EventBatch(iKey, theEvents);\r\n    };\r\n    return EventBatch;\r\n}());\r\nexport { EventBatch };\r\n//# sourceMappingURL=EventBatch.js.map","/*\n * 1DS JS SDK POST plugin, 4.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n * (Microsoft Internal Only)\n */\n/**\r\n* ClockSkewManager.ts\r\n* @author Abhilash Panwar (abpanwar)\r\n* @copyright Microsoft 2018\r\n*/\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { _DYN_ALLOW_REQUEST_SENDIN0, _DYN_FIRST_REQUEST_SENT, _DYN_GET_CLOCK_SKEW_HEADE2, _DYN_SET_CLOCK_SKEW, _DYN_SHOULD_ADD_CLOCK_SKE1 } from \"./__DynamicConstants\";\r\n/**\r\n* Class to manage clock skew correction.\r\n*/\r\nvar ClockSkewManager = /** @class */ (function () {\r\n    function ClockSkewManager() {\r\n        var _allowRequestSending = true;\r\n        var _shouldAddClockSkewHeaders = true;\r\n        var _isFirstRequest = true;\r\n        var _clockSkewHeaderValue = \"use-collector-delta\";\r\n        var _clockSkewSet = false;\r\n        dynamicProto(ClockSkewManager, this, function (_self) {\r\n            /**\r\n             * Determine if requests can be sent.\r\n             * @returns True if requests can be sent, false otherwise.\r\n             */\r\n            _self[_DYN_ALLOW_REQUEST_SENDIN0 /* @min:%2eallowRequestSending */] = function () {\r\n                return _allowRequestSending;\r\n            };\r\n            /**\r\n             * Tells the ClockSkewManager that it should assume that the first request has now been sent,\r\n             * If this method had not yet been called AND the clock Skew had not been set this will set\r\n             * allowRequestSending to false until setClockSet() is called.\r\n             */\r\n            _self[_DYN_FIRST_REQUEST_SENT /* @min:%2efirstRequestSent */] = function () {\r\n                if (_isFirstRequest) {\r\n                    _isFirstRequest = false;\r\n                    if (!_clockSkewSet) {\r\n                        // Block sending until we get the first clock Skew\r\n                        _allowRequestSending = false;\r\n                    }\r\n                }\r\n            };\r\n            /**\r\n             * Determine if clock skew headers should be added to the request.\r\n             * @returns True if clock skew headers should be added, false otherwise.\r\n             */\r\n            _self[_DYN_SHOULD_ADD_CLOCK_SKE1 /* @min:%2eshouldAddClockSkewHeaders */] = function () {\r\n                return _shouldAddClockSkewHeaders;\r\n            };\r\n            /**\r\n             * Gets the clock skew header value.\r\n             * @returns The clock skew header value.\r\n             */\r\n            _self[_DYN_GET_CLOCK_SKEW_HEADE2 /* @min:%2egetClockSkewHeaderValue */] = function () {\r\n                return _clockSkewHeaderValue;\r\n            };\r\n            /**\r\n             * Sets the clock skew header value. Once clock skew is set this method\r\n             * is no-op.\r\n             * @param timeDeltaInMillis - Time delta to be saved as the clock skew header value.\r\n             */\r\n            _self[_DYN_SET_CLOCK_SKEW /* @min:%2esetClockSkew */] = function (timeDeltaInMillis) {\r\n                if (!_clockSkewSet) {\r\n                    if (timeDeltaInMillis) {\r\n                        _clockSkewHeaderValue = timeDeltaInMillis;\r\n                        _shouldAddClockSkewHeaders = true;\r\n                        _clockSkewSet = true;\r\n                    }\r\n                    else {\r\n                        _shouldAddClockSkewHeaders = false;\r\n                    }\r\n                    // Unblock sending\r\n                    _allowRequestSending = true;\r\n                }\r\n            };\r\n        });\r\n    }\r\n// Removed Stub for ClockSkewManager.prototype.allowRequestSending.\r\n// Removed Stub for ClockSkewManager.prototype.firstRequestSent.\r\n// Removed Stub for ClockSkewManager.prototype.shouldAddClockSkewHeaders.\r\n// Removed Stub for ClockSkewManager.prototype.getClockSkewHeaderValue.\r\n// Removed Stub for ClockSkewManager.prototype.setClockSkew.\r\n    // This is a workaround for an IE bug when using dynamicProto() with classes that don't have any\n    // non-dynamic functions or static properties/functions when using uglify-js to minify the resulting code.\n    ClockSkewManager.__ieDyn=1;\n\n    return ClockSkewManager;\r\n}());\r\nexport { ClockSkewManager };\r\n//# sourceMappingURL=ClockSkewManager.js.map","/*\n * 1DS JS SDK POST plugin, 4.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n * (Microsoft Internal Only)\n */\n/**\r\n* KillSwitch.ts\r\n* @author Abhilash Panwar (abpanwar)\r\n* @copyright Microsoft 2018\r\n*/\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { arrForEach, dateNow, strTrim } from \"@microsoft/1ds-core-js\";\r\nimport { _DYN_IS_TENANT_KILLED, _DYN_LENGTH, _DYN_PUSH, _DYN_SET_KILL_SWITCH_TENA11, _DYN_SPLIT } from \"./__DynamicConstants\";\r\nvar SecToMsMultiplier = 1000;\r\n/**\r\n* Class to stop certain tenants sending events.\r\n*/\r\nvar KillSwitch = /** @class */ (function () {\r\n    function KillSwitch() {\r\n        var _killedTokenDictionary = {};\r\n        function _normalizeTenants(values) {\r\n            var result = [];\r\n            if (values) {\r\n                arrForEach(values, function (value) {\r\n                    result[_DYN_PUSH /* @min:%2epush */](strTrim(value));\r\n                });\r\n            }\r\n            return result;\r\n        }\r\n        dynamicProto(KillSwitch, this, function (_self) {\r\n            _self[_DYN_SET_KILL_SWITCH_TENA11 /* @min:%2esetKillSwitchTenants */] = function (killTokens, killDuration) {\r\n                if (killTokens && killDuration) {\r\n                    try {\r\n                        var killedTokens = _normalizeTenants(killTokens[_DYN_SPLIT /* @min:%2esplit */](\",\"));\r\n                        if (killDuration === \"this-request-only\") {\r\n                            return killedTokens;\r\n                        }\r\n                        var durationMs = parseInt(killDuration, 10) * SecToMsMultiplier;\r\n                        for (var i = 0; i < killedTokens[_DYN_LENGTH /* @min:%2elength */]; ++i) {\r\n                            _killedTokenDictionary[killedTokens[i]] = dateNow() + durationMs;\r\n                        }\r\n                    }\r\n                    catch (ex) {\r\n                        return [];\r\n                    }\r\n                }\r\n                return [];\r\n            };\r\n            _self[_DYN_IS_TENANT_KILLED /* @min:%2eisTenantKilled */] = function (tenantToken) {\r\n                var killDictionary = _killedTokenDictionary;\r\n                var name = strTrim(tenantToken);\r\n                if (killDictionary[name] !== undefined && killDictionary[name] > dateNow()) {\r\n                    return true;\r\n                }\r\n                delete killDictionary[name];\r\n                return false;\r\n            };\r\n        });\r\n    }\r\n// Removed Stub for KillSwitch.prototype.setKillSwitchTenants.\r\n// Removed Stub for KillSwitch.prototype.isTenantKilled.\r\n    // This is a workaround for an IE bug when using dynamicProto() with classes that don't have any\n    // non-dynamic functions or static properties/functions when using uglify-js to minify the resulting code.\n    KillSwitch.__ieDyn=1;\n\n    return KillSwitch;\r\n}());\r\nexport { KillSwitch };\r\n//# sourceMappingURL=KillSwitch.js.map","/*\n * 1DS JS SDK POST plugin, 4.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n * (Microsoft Internal Only)\n */\n/**\r\n* RetryPolicy.ts\r\n* @author Abhilash Panwar (abpanwar)\r\n* @copyright Microsoft 2018\r\n*/\r\nvar RandomizationLowerThreshold = 0.8;\r\nvar RandomizationUpperThreshold = 1.2;\r\nvar BaseBackoff = 3000;\r\nvar MaxBackoff = 600000;\r\n/**\r\n * Determine if the request should be retried for the given status code.\r\n * The below expression reads that we should only retry for:\r\n *      - HttpStatusCodes that are smaller than 300.\r\n *      - HttpStatusCodes greater or equal to 500 (except for 501-NotImplement\r\n *        and 505-HttpVersionNotSupport).\r\n *      - HttpStatusCode 408-RequestTimeout.\r\n *      - HttpStatusCode 429.\r\n * This is based on Microsoft.WindowsAzure.Storage.RetryPolicies.ExponentialRetry class\r\n * @param httpStatusCode - The status code returned for the request.\r\n * @returns True if request should be retried, false otherwise.\r\n */\r\nexport function retryPolicyShouldRetryForStatus(httpStatusCode) {\r\n    /* tslint:disable:triple-equals */\r\n    // Disabling triple-equals rule to avoid httpOverrides from failing because they are returning a string value\r\n    return !((httpStatusCode >= 300 && httpStatusCode < 500 && httpStatusCode != 429)\r\n        || (httpStatusCode == 501)\r\n        || (httpStatusCode == 505));\r\n    /* tslint:enable:triple-equals */\r\n}\r\n/**\r\n * Gets the number of milliseconds to back off before retrying the request. The\r\n * back off duration is exponentially scaled based on the number of retries already\r\n * done for the request.\r\n * @param retriesSoFar - The number of times the request has already been retried.\r\n * @returns The back off duration for the request before it can be retried.\r\n */\r\nexport function retryPolicyGetMillisToBackoffForRetry(retriesSoFar) {\r\n    var waitDuration = 0;\r\n    var minBackoff = BaseBackoff * RandomizationLowerThreshold;\r\n    var maxBackoff = BaseBackoff * RandomizationUpperThreshold;\r\n    var randomBackoff = Math.floor(Math.random() * (maxBackoff - minBackoff)) + minBackoff;\r\n    waitDuration = Math.pow(2, retriesSoFar) * randomBackoff;\r\n    return Math.min(waitDuration, MaxBackoff);\r\n}\r\n//# sourceMappingURL=RetryPolicy.js.map","/*\n * 1DS JS SDK POST plugin, 4.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n * (Microsoft Internal Only)\n */\n/**\r\n* Serializer.ts\r\n* @author Abhilash Panwar (abpanwar); Hector Hernandez (hectorh); Nev Wylie (newylie)\r\n* @copyright Microsoft 2018-2020\r\n*/\r\n// @skip-file-minify\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { arrIndexOf, doPerf, getCommonSchemaMetaData, getTenantId, isArray, isValueAssigned, objForEachKey, sanitizeProperty, strStartsWith } from \"@microsoft/1ds-core-js\";\r\nimport { EventBatch } from \"./EventBatch\";\r\nimport { STR_EMPTY } from \"./InternalConstants\";\r\nimport { strSubstr } from \"@nevware21/ts-utils\";\r\n/**\r\n * Note: This is an optimization for V8-based browsers. When V8 concatenates a string,\r\n * the strings are only joined logically using a \"cons string\" or \"constructed/concatenated\r\n * string\". These containers keep references to one another and can result in very large\r\n * memory usage. For example, if a 2MB string is constructed by concatenating 4 bytes\r\n * together at a time, the memory usage will be ~44MB; so ~22x increase. The strings are\r\n * only joined together when an operation requiring their joining takes place, such as\r\n * substr(). This function is called when adding data to this buffer to ensure these\r\n * types of strings are periodically joined to reduce the memory footprint.\r\n * Setting to every 20 events as the JSON.stringify() may have joined many strings\r\n * and calling this too much causes a minor delay while processing.\r\n */\r\nvar _MAX_STRING_JOINS = 20;\r\nvar RequestSizeLimitBytes = 3984588; // approx 3.8 Mb\r\nvar BeaconRequestSizeLimitBytes = 65000; // approx 64kb (the current Edge, Firefox and Chrome max limit)\r\nvar MaxRecordSize = 2000000; // approx 2 Mb\r\nvar MaxBeaconRecordSize = Math.min(MaxRecordSize, BeaconRequestSizeLimitBytes);\r\nvar metadata = \"metadata\";\r\nvar f = \"f\";\r\nvar rCheckDot = /\\./;\r\n/**\r\n* Class to handle serialization of event and request.\r\n* Currently uses Bond for serialization. Please note that this may be subject to change.\r\n*/\r\nvar Serializer = /** @class */ (function () {\r\n    /**\r\n     * Constructs a new instance of the Serializer class\r\n     * @param perfManager - The performance manager to use for tracking performance\r\n     * @param valueSanitizer - The value sanitizer to use for sanitizing field values\r\n     * @param stringifyObjects - Should objects be stringified before being sent\r\n     * @param enableCompoundKey - Should compound keys be enabled (defaults to false)\r\n     * @param getEncodedTypeOverride - The callback to get the encoded type for a property defaults to ({@link getCommonSchemaMetaData }(...))\r\n     * @param excludeCsMetaData - (!DANGER!) Should metadata be populated when encoding the event blob (defaults to false) - PII data will NOT be tagged as PII for backend processing\r\n     */\r\n    function Serializer(perfManager, valueSanitizer, stringifyObjects, enableCompoundKey, getEncodedTypeOverride, excludeCsMetaData) {\r\n        var strData = \"data\";\r\n        var strBaseData = \"baseData\";\r\n        var strExt = \"ext\";\r\n        var _checkForCompoundkey = !!enableCompoundKey;\r\n        var _processSubKeys = true;\r\n        var _theSanitizer = valueSanitizer;\r\n        var _isReservedCache = {};\r\n        var _excludeCsMetaData = !!excludeCsMetaData;\r\n        var _getEncodedType = getEncodedTypeOverride || getCommonSchemaMetaData;\r\n        dynamicProto(Serializer, this, function (_self) {\r\n            _self.createPayload = function (retryCnt, isTeardown, isSync, isReducedPayload, sendReason, sendType) {\r\n                return {\r\n                    apiKeys: [],\r\n                    payloadBlob: STR_EMPTY,\r\n                    overflow: null,\r\n                    sizeExceed: [],\r\n                    failedEvts: [],\r\n                    batches: [],\r\n                    numEvents: 0,\r\n                    retryCnt: retryCnt,\r\n                    isTeardown: isTeardown,\r\n                    isSync: isSync,\r\n                    isBeacon: isReducedPayload,\r\n                    sendType: sendType,\r\n                    sendReason: sendReason\r\n                };\r\n            };\r\n            _self.appendPayload = function (payload, theBatch, maxEventsPerBatch) {\r\n                var canAddEvents = payload && theBatch && !payload.overflow;\r\n                if (canAddEvents) {\r\n                    doPerf(perfManager, function () { return \"Serializer:appendPayload\"; }, function () {\r\n                        var theEvents = theBatch.events();\r\n                        var payloadBlob = payload.payloadBlob;\r\n                        var payloadEvents = payload.numEvents;\r\n                        var eventsAdded = false;\r\n                        var sizeExceeded = [];\r\n                        var failedEvts = [];\r\n                        var isBeaconPayload = payload.isBeacon;\r\n                        var requestMaxSize = isBeaconPayload ? BeaconRequestSizeLimitBytes : RequestSizeLimitBytes;\r\n                        var recordMaxSize = isBeaconPayload ? MaxBeaconRecordSize : MaxRecordSize;\r\n                        var lp = 0;\r\n                        var joinCount = 0;\r\n                        while (lp < theEvents.length) {\r\n                            var theEvent = theEvents[lp];\r\n                            if (theEvent) {\r\n                                if (payloadEvents >= maxEventsPerBatch) {\r\n                                    // Maximum events per payload reached, so don't add any more\r\n                                    payload.overflow = theBatch.split(lp);\r\n                                    break;\r\n                                }\r\n                                var eventBlob = _self.getEventBlob(theEvent);\r\n                                if (eventBlob && eventBlob.length <= recordMaxSize) {\r\n                                    // This event will fit into the payload\r\n                                    var blobLength = eventBlob.length;\r\n                                    var currentSize = payloadBlob.length;\r\n                                    if (currentSize + blobLength > requestMaxSize) {\r\n                                        // Request or batch size exceeded, so don't add any more to the payload\r\n                                        payload.overflow = theBatch.split(lp);\r\n                                        break;\r\n                                    }\r\n                                    if (payloadBlob) {\r\n                                        payloadBlob += \"\\n\";\r\n                                    }\r\n                                    payloadBlob += eventBlob;\r\n                                    joinCount++;\r\n                                    // v8 memory optimization only\r\n                                    if (joinCount > _MAX_STRING_JOINS) {\r\n                                        // this substr() should cause the constructed string to join\r\n                                        strSubstr(payloadBlob, 0, 1);\r\n                                        joinCount = 0;\r\n                                    }\r\n                                    eventsAdded = true;\r\n                                    payloadEvents++;\r\n                                }\r\n                                else {\r\n                                    if (eventBlob) {\r\n                                        // Single event size exceeded so remove from the batch\r\n                                        sizeExceeded.push(theEvent);\r\n                                    }\r\n                                    else {\r\n                                        failedEvts.push(theEvent);\r\n                                    }\r\n                                    // We also need to remove this event from the existing array, otherwise a notification will be sent\r\n                                    // indicating that it was successfully sent\r\n                                    theEvents.splice(lp, 1);\r\n                                    lp--;\r\n                                }\r\n                            }\r\n                            lp++;\r\n                        }\r\n                        if (sizeExceeded.length > 0) {\r\n                            payload.sizeExceed.push(EventBatch.create(theBatch.iKey(), sizeExceeded));\r\n                            // Remove the exceeded events from the batch\r\n                        }\r\n                        if (failedEvts.length > 0) {\r\n                            payload.failedEvts.push(EventBatch.create(theBatch.iKey(), failedEvts));\r\n                            // Remove the failed events from the batch\r\n                        }\r\n                        if (eventsAdded) {\r\n                            payload.batches.push(theBatch);\r\n                            payload.payloadBlob = payloadBlob;\r\n                            payload.numEvents = payloadEvents;\r\n                            var apiKey = theBatch.iKey();\r\n                            if (arrIndexOf(payload.apiKeys, apiKey) === -1) {\r\n                                payload.apiKeys.push(apiKey);\r\n                            }\r\n                        }\r\n                    }, function () { return ({ payload: payload, theBatch: { iKey: theBatch.iKey(), evts: theBatch.events() }, max: maxEventsPerBatch }); });\r\n                }\r\n                return canAddEvents;\r\n            };\r\n            _self.getEventBlob = function (eventData) {\r\n                try {\r\n                    return doPerf(perfManager, function () { return \"Serializer.getEventBlob\"; }, function () {\r\n                        var serializedEvent = {};\r\n                        // Adding as dynamic keys for v8 performance\r\n                        serializedEvent.name = eventData.name;\r\n                        serializedEvent.time = eventData.time;\r\n                        serializedEvent.ver = eventData.ver;\r\n                        serializedEvent.iKey = \"o:\" + getTenantId(eventData.iKey);\r\n                        // Assigning local var so usage in part b/c don't throw if there is no ext\r\n                        var serializedExt = {};\r\n                        var _addMetadataCallback;\r\n                        if (!_excludeCsMetaData) {\r\n                            _addMetadataCallback = function (pathKeys, key, value) {\r\n                                _addJSONPropertyMetaData(_getEncodedType, serializedExt, pathKeys, key, value);\r\n                            };\r\n                        }\r\n                        // Part A\r\n                        var eventExt = eventData[strExt];\r\n                        if (eventExt) {\r\n                            // Only assign ext if the event had one (There are tests covering this use case)\r\n                            serializedEvent[strExt] = serializedExt;\r\n                            objForEachKey(eventExt, function (key, value) {\r\n                                var data = serializedExt[key] = {};\r\n                                // Don't include a metadata callback as we don't currently set metadata Part A fields\r\n                                _processPathKeys(value, data, \"ext.\" + key, true, null, null, true);\r\n                            });\r\n                        }\r\n                        var serializedData = serializedEvent[strData] = {};\r\n                        serializedData.baseType = eventData.baseType;\r\n                        var serializedBaseData = serializedData[strBaseData] = {};\r\n                        // Part B\r\n                        _processPathKeys(eventData.baseData, serializedBaseData, strBaseData, false, [strBaseData], _addMetadataCallback, _processSubKeys);\r\n                        // Part C\r\n                        _processPathKeys(eventData.data, serializedData, strData, false, [], _addMetadataCallback, _processSubKeys);\r\n                        return JSON.stringify(serializedEvent);\r\n                    }, function () { return ({ item: eventData }); });\r\n                }\r\n                catch (e) {\r\n                    return null;\r\n                }\r\n            };\r\n            function _isReservedField(path, name) {\r\n                var result = _isReservedCache[path];\r\n                if (result === undefined) {\r\n                    if (path.length >= 7) {\r\n                        // Do not allow the changing of fields located in the ext.metadata or ext.web extension\r\n                        result = strStartsWith(path, \"ext.metadata\") || strStartsWith(path, \"ext.web\");\r\n                    }\r\n                    _isReservedCache[path] = result;\r\n                }\r\n                return result;\r\n            }\r\n            function _processPathKeys(srcObj, target, thePath, checkReserved, metadataPathKeys, metadataCallback, processSubKeys) {\r\n                objForEachKey(srcObj, function (key, srcValue) {\r\n                    var prop = null;\r\n                    if (srcValue || isValueAssigned(srcValue)) {\r\n                        var path = thePath;\r\n                        var name_1 = key;\r\n                        var theMetaPathKeys = metadataPathKeys;\r\n                        var destObj = target;\r\n                        // Handle keys with embedded '.', like \"TestObject.testProperty\"\r\n                        if (_checkForCompoundkey && !checkReserved && rCheckDot.test(key)) {\r\n                            var subKeys = key.split(\".\");\r\n                            var keyLen = subKeys.length;\r\n                            if (keyLen > 1) {\r\n                                if (theMetaPathKeys) {\r\n                                    // Create a copy of the meta path keys so we can add the extra ones\r\n                                    theMetaPathKeys = theMetaPathKeys.slice();\r\n                                }\r\n                                for (var lp = 0; lp < keyLen - 1; lp++) {\r\n                                    var subKey = subKeys[lp];\r\n                                    // Add/reuse the sub key object\r\n                                    destObj = destObj[subKey] = destObj[subKey] || {};\r\n                                    path += \".\" + subKey;\r\n                                    if (theMetaPathKeys) {\r\n                                        theMetaPathKeys.push(subKey);\r\n                                    }\r\n                                }\r\n                                name_1 = subKeys[keyLen - 1];\r\n                            }\r\n                        }\r\n                        var isReserved = checkReserved && _isReservedField(path, name_1);\r\n                        if (!isReserved && _theSanitizer && _theSanitizer.handleField(path, name_1)) {\r\n                            prop = _theSanitizer.value(path, name_1, srcValue, stringifyObjects);\r\n                        }\r\n                        else {\r\n                            prop = sanitizeProperty(name_1, srcValue, stringifyObjects);\r\n                        }\r\n                        if (prop) {\r\n                            // Set the value\r\n                            var newValue = prop.value;\r\n                            destObj[name_1] = newValue;\r\n                            if (metadataCallback) {\r\n                                metadataCallback(theMetaPathKeys, name_1, prop);\r\n                            }\r\n                            if (processSubKeys && typeof newValue === \"object\" && !isArray(newValue)) {\r\n                                var newPath = theMetaPathKeys;\r\n                                if (newPath) {\r\n                                    newPath = newPath.slice();\r\n                                    newPath.push(name_1);\r\n                                }\r\n                                // Make sure we process sub objects as well (for value sanitization and metadata)\r\n                                _processPathKeys(srcValue, newValue, path + \".\" + name_1, checkReserved, newPath, metadataCallback, processSubKeys);\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    }\r\n// Removed Stub for Serializer.prototype.createPayload.\r\n// Removed Stub for Serializer.prototype.appendPayload.\r\n// Removed Stub for Serializer.prototype.getEventBlob.\r\n// Removed Stub for Serializer.prototype.handleField.\r\n// Removed Stub for Serializer.prototype.getSanitizer.\r\n    // This is a workaround for an IE bug when using dynamicProto() with classes that don't have any\n    // non-dynamic functions or static properties/functions when using uglify-js to minify the resulting code.\n    Serializer.__ieDyn=1;\n\n    return Serializer;\r\n}());\r\nexport { Serializer };\r\n/**\r\n * @ignore\r\n * @param getEncodedType - The function to get the encoded type for the property\r\n * @param json - The json object to add the metadata to\r\n * @param propKeys - The property keys to add to the metadata\r\n * @param name - The name of the property\r\n * @param propertyValue - The property value\r\n */\r\nfunction _addJSONPropertyMetaData(getEncodedType, json, propKeys, name, propertyValue) {\r\n    if (propertyValue && json) {\r\n        var encodedTypeValue = getEncodedType(propertyValue.value, propertyValue.kind, propertyValue.propertyType);\r\n        if (encodedTypeValue > -1) {\r\n            // Add the root metadata\r\n            var metaData = json[metadata];\r\n            if (!metaData) {\r\n                // Sets the root 'f'\r\n                metaData = json[metadata] = { f: {} };\r\n            }\r\n            var metaTarget = metaData[f];\r\n            if (!metaTarget) {\r\n                // This can occur if someone has manually added an ext.metadata object\r\n                // Such as ext.metadata.privLevel and ext.metadata.privTags\r\n                metaTarget = metaData[f] = {};\r\n            }\r\n            // Traverse the metadata path and build each object (contains an 'f' key) -- if required\r\n            if (propKeys) {\r\n                for (var lp = 0; lp < propKeys.length; lp++) {\r\n                    var key = propKeys[lp];\r\n                    if (!metaTarget[key]) {\r\n                        metaTarget[key] = { f: {} };\r\n                    }\r\n                    var newTarget = metaTarget[key][f];\r\n                    if (!newTarget) {\r\n                        // Not expected, but can occur if the metadata context was pre-created as part of the event\r\n                        newTarget = metaTarget[key][f] = {};\r\n                    }\r\n                    metaTarget = newTarget;\r\n                }\r\n            }\r\n            metaTarget = metaTarget[name] = {};\r\n            if (isArray(propertyValue.value)) {\r\n                metaTarget[\"a\"] = {\r\n                    t: encodedTypeValue\r\n                };\r\n            }\r\n            else {\r\n                metaTarget[\"t\"] = encodedTypeValue;\r\n            }\r\n        }\r\n    }\r\n}\r\n//# sourceMappingURL=Serializer.js.map","/*\n * 1DS JS SDK POST plugin, 4.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n * (Microsoft Internal Only)\n */\nvar _a;\r\n/**\r\n* HttpManager.ts\r\n* @author Abhilash Panwar (abpanwar); Hector Hernandez (hectorh); Nev Wylie (newylie)\r\n* @copyright Microsoft 2018-2020\r\n*/\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { FullVersionString, SenderPostManager, _getAllResponseHeaders, _throwInternal, _warnToConsole, arrForEach, dateNow, doPerf, dumpObj, extend, getCommonSchemaMetaData, getNavigator, getResponseText, getTime, hasOwnProperty, isBeaconsSupported, isFetchSupported, isNullOrUndefined, isReactNative, isUndefined, isValueAssigned, objForEachKey, objKeys, onConfigChange, optimizeObject, prependTransports, strUndefined } from \"@microsoft/1ds-core-js\";\r\nimport { arrAppend } from \"@nevware21/ts-utils\";\r\nimport { ClockSkewManager } from \"./ClockSkewManager\";\r\nimport { EventBatch } from \"./EventBatch\";\r\nimport { DEFAULT_CACHE_CONTROL, DEFAULT_CONTENT_TYPE, STR_API_KEY, STR_AUTH_XTOKEN, STR_CACHE_CONTROL, STR_CLIENT_ID, STR_CLIENT_VERSION, STR_CONTENT_TYPE_HEADER, STR_DROPPED, STR_EMPTY, STR_KILL_DURATION_HEADER, STR_KILL_TOKENS_HEADER, STR_MSA_DEVICE_TICKET, STR_MSFPC, STR_NO_RESPONSE_BODY, STR_OTHER, STR_REQUEUE, STR_RESPONSE_FAIL, STR_SENDING, STR_TIME_DELTA_HEADER, STR_TIME_DELTA_TO_APPLY, STR_UPLOAD_TIME } from \"./InternalConstants\";\r\nimport { KillSwitch } from \"./KillSwitch\";\r\nimport { retryPolicyGetMillisToBackoffForRetry, retryPolicyShouldRetryForStatus } from \"./RetryPolicy\";\r\nimport { Serializer } from \"./Serializer\";\r\nimport { createTimeoutWrapper } from \"./TimeoutOverrideWrapper\";\r\nimport { _DYN_ADD_HEADER, _DYN_ADD_NO_RESPONSE, _DYN_ALLOW_REQUEST_SENDIN0, _DYN_ALWAYS_USE_XHR_OVERR7, _DYN_AVOID_OPTIONS, _DYN_BATCHES, _DYN_CAN_SEND_REQUEST, _DYN_CLEAR_TIMEOUT_OVERRI3, _DYN_CONCAT, _DYN_COUNT, _DYN_CREATE_ONE_DSPAYLOAD, _DYN_CREATE_PAYLOAD, _DYN_DATA, _DYN_DISABLE_EVENT_TIMING5, _DYN_DISABLE_FETCH_KEEP_A6, _DYN_DISABLE_XHR_SYNC, _DYN_ENABLE_COMPOUND_KEY, _DYN_EVENTS, _DYN_EXCLUDE_CS_META_DATA, _DYN_FETCH_CREDENTIALS, _DYN_FIRST_REQUEST_SENT, _DYN_GET_CLOCK_SKEW_HEADE2, _DYN_GET_OFFLINE_REQUEST_9, _DYN_GET_WPARAM, _DYN_HDRS, _DYN_HEADERS, _DYN_INITIALIZE, _DYN_IS_BEACON, _DYN_IS_COMPLETELY_IDLE, _DYN_IS_SYNC, _DYN_IS_TEARDOWN, _DYN_I_KEY, _DYN_LENGTH, _DYN_OVERRIDE_ENDPOINT_UR4, _DYN_PAYLOAD_BLOB, _DYN_PAYLOAD_PREPROCESSOR, _DYN_PUSH, _DYN_RESUME, _DYN_SEND_QUEUED_REQUESTS, _DYN_SEND_SYNCHRONOUS_BAT10, _DYN_SEND_TYPE, _DYN_SERIALIZE_OFFLINE_EV8, _DYN_SET_CLOCK_SKEW, _DYN_SET_KILL_SWITCH_TENA11, _DYN_SET_TIMEOUT_OVERRIDE, _DYN_SET_UNLOADING, _DYN_SHOULD_ADD_CLOCK_SKE1, _DYN_SPLICE, _DYN_SPLIT, _DYN_STRINGIFY_OBJECTS, _DYN_TIMEOUT, _DYN_TIMINGS, _DYN_TO_LOWER_CASE, _DYN_UNLOAD_TRANSPORTS, _DYN_URL_STRING, _DYN_USE_HDRS, _DYN_USE_SEND_BEACON, _DYN__BACK_OFF_TRANSMISSI12, _DYN__SEND_REASON, _DYN__THE_PAYLOAD, _DYN__TRANSPORT } from \"./__DynamicConstants\";\r\nvar strSendAttempt = \"sendAttempt\";\r\nvar _noResponseQs = \"&\" + STR_NO_RESPONSE_BODY + \"=true\";\r\nvar UrlQueryString = \"?cors=true&\" + STR_CONTENT_TYPE_HEADER[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */]() + \"=\" + DEFAULT_CONTENT_TYPE;\r\n/**\r\n * Identifies the default notification reason to the action names\r\n */\r\nvar _eventActionMap = (_a = {},\r\n    _a[1 /* EventBatchNotificationReason.Paused */] = STR_REQUEUE,\r\n    _a[100 /* EventBatchNotificationReason.RequeueEvents */] = STR_REQUEUE,\r\n    _a[200 /* EventBatchNotificationReason.Complete */] = \"sent\",\r\n    _a[8004 /* EventBatchNotificationReason.KillSwitch */] = STR_DROPPED,\r\n    _a[8003 /* EventBatchNotificationReason.SizeLimitExceeded */] = STR_DROPPED,\r\n    _a);\r\nvar _collectorQsHeaders = {};\r\nvar _collectorHeaderToQs = {};\r\nfunction _addCollectorHeaderQsMapping(qsName, headerName, allowQs) {\r\n    _collectorQsHeaders[qsName] = headerName;\r\n    if (allowQs !== false) {\r\n        _collectorHeaderToQs[headerName] = qsName;\r\n    }\r\n}\r\n_addCollectorHeaderQsMapping(STR_MSA_DEVICE_TICKET, STR_MSA_DEVICE_TICKET, false);\r\n_addCollectorHeaderQsMapping(STR_CLIENT_VERSION, STR_CLIENT_VERSION);\r\n_addCollectorHeaderQsMapping(STR_CLIENT_ID, \"Client-Id\");\r\n_addCollectorHeaderQsMapping(STR_API_KEY, STR_API_KEY);\r\n_addCollectorHeaderQsMapping(STR_TIME_DELTA_TO_APPLY, STR_TIME_DELTA_TO_APPLY);\r\n_addCollectorHeaderQsMapping(STR_UPLOAD_TIME, STR_UPLOAD_TIME);\r\n_addCollectorHeaderQsMapping(STR_AUTH_XTOKEN, STR_AUTH_XTOKEN);\r\nfunction _hasHeader(headers, header) {\r\n    var hasHeader = false;\r\n    if (headers && header) {\r\n        var keys = objKeys(headers);\r\n        if (keys && keys[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n            var lowerHeader = header[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */]();\r\n            for (var lp = 0; lp < keys[_DYN_LENGTH /* @min:%2elength */]; lp++) {\r\n                var value = keys[lp];\r\n                if (value && hasOwnProperty(header, value) &&\r\n                    value[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */]() === lowerHeader) {\r\n                    hasHeader = true;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return hasHeader;\r\n}\r\nfunction _addRequestDetails(details, name, value, useHeaders) {\r\n    if (name && value && value[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n        if (useHeaders && _collectorQsHeaders[name]) {\r\n            details[_DYN_HDRS /* @min:%2ehdrs */][_collectorQsHeaders[name]] = value;\r\n            details[_DYN_USE_HDRS /* @min:%2euseHdrs */] = true;\r\n        }\r\n        else {\r\n            details.url += \"&\" + name + \"=\" + value;\r\n        }\r\n    }\r\n}\r\nfunction _addQueryStringParameter(qsParams, name, value) {\r\n    for (var i = 0; i < qsParams[_DYN_LENGTH /* @min:%2elength */]; i++) {\r\n        if (qsParams[i].name === name) {\r\n            qsParams[i].value = value;\r\n            return;\r\n        }\r\n    }\r\n    qsParams[_DYN_PUSH /* @min:%2epush */]({ name: name, value: value });\r\n}\r\nfunction _removeQueryStringParameter(qsParams, name) {\r\n    for (var i = 0; i < qsParams[_DYN_LENGTH /* @min:%2elength */]; i++) {\r\n        if (qsParams[i].name === name) {\r\n            qsParams[_DYN_SPLICE /* @min:%2esplice */](i, 1);\r\n            return;\r\n        }\r\n    }\r\n}\r\n/**\r\n * Class managing the sending of requests.\r\n */\r\nvar HttpManager = /** @class */ (function () {\r\n    /**\r\n     * @constructor\r\n     * @param requestQueue   - The queue that contains the requests to be sent.\r\n     */\r\n    function HttpManager(maxEventsPerBatch, maxConnections, maxRequestRetriesBeforeBackoff, actions) {\r\n        // ------------------------------------------------------------------------------------------------------------------------\r\n        // Only set \"Default\" values in the _initDefaults() method, unless value are not \"reset\" during unloading\r\n        // ------------------------------------------------------------------------------------------------------------------------\r\n        var _urlString;\r\n        var _killSwitch;\r\n        var _paused;\r\n        var _clockSkewManager;\r\n        var _useBeacons = false;\r\n        var _outstandingRequests; // Holds the number of outstanding async requests that have not returned a response yet\r\n        var _postManager;\r\n        var _logger;\r\n        var _sendInterfaces;\r\n        var _core;\r\n        var _customHttpInterface;\r\n        var _queryStringParameters;\r\n        var _headers;\r\n        var _batchQueue;\r\n        var _serializer;\r\n        var _enableEventTimings;\r\n        var _cookieMgr;\r\n        var _isUnloading;\r\n        var _useHeaders;\r\n        var _xhrTimeout;\r\n        var _disableXhrSync;\r\n        var _disableFetchKeepAlive;\r\n        var _canHaveReducedPayload;\r\n        var _addNoResponse;\r\n        var _unloadHooks;\r\n        var _sendHook;\r\n        var _sendListener;\r\n        var _responseHandlers;\r\n        var _isInitialized;\r\n        var _timeoutWrapper;\r\n        var _excludeCsMetaData;\r\n        var _sendPostMgr;\r\n        var _fetchCredentials;\r\n        dynamicProto(HttpManager, this, function (_self) {\r\n            _initDefaults();\r\n            var _sendCredentials = true;\r\n            _self[_DYN_INITIALIZE /* @min:%2einitialize */] = function (theConfig, core, postChannel) {\r\n                if (!_isInitialized) {\r\n                    _core = core;\r\n                    _cookieMgr = core.getCookieMgr();\r\n                    _postManager = postChannel;\r\n                    _logger = _postManager.diagLog();\r\n                    arrAppend(_unloadHooks, onConfigChange(theConfig, function (details) {\r\n                        var _a;\r\n                        var coreConfig = details.cfg;\r\n                        var channelConfig = details.cfg.extensionConfig[postChannel.identifier];\r\n                        _timeoutWrapper = createTimeoutWrapper(channelConfig[_DYN_SET_TIMEOUT_OVERRIDE /* @min:%2esetTimeoutOverride */], channelConfig[_DYN_CLEAR_TIMEOUT_OVERRI3 /* @min:%2eclearTimeoutOverride */]);\r\n                        if (isValueAssigned(coreConfig.anonCookieName)) {\r\n                            _addQueryStringParameter(_queryStringParameters, \"anoncknm\", coreConfig.anonCookieName);\r\n                        }\r\n                        else {\r\n                            _removeQueryStringParameter(_queryStringParameters, \"anoncknm\");\r\n                        }\r\n                        _sendHook = channelConfig[_DYN_PAYLOAD_PREPROCESSOR /* @min:%2epayloadPreprocessor */];\r\n                        _sendListener = channelConfig.payloadListener;\r\n                        var httpInterface = channelConfig.httpXHROverride;\r\n                        // Override endpointUrl if provided in Post config\r\n                        var endpointUrl = channelConfig[_DYN_OVERRIDE_ENDPOINT_UR4 /* @min:%2eoverrideEndpointUrl */] ? channelConfig[_DYN_OVERRIDE_ENDPOINT_UR4 /* @min:%2eoverrideEndpointUrl */] : coreConfig.endpointUrl;\r\n                        _urlString = endpointUrl + UrlQueryString;\r\n                        _useHeaders = !isUndefined(channelConfig[_DYN_AVOID_OPTIONS /* @min:%2eavoidOptions */]) ? !channelConfig[_DYN_AVOID_OPTIONS /* @min:%2eavoidOptions */] : true;\r\n                        _enableEventTimings = !channelConfig[_DYN_DISABLE_EVENT_TIMING5 /* @min:%2edisableEventTimings */];\r\n                        var valueSanitizer = channelConfig.valueSanitizer;\r\n                        var stringifyObjects = channelConfig[_DYN_STRINGIFY_OBJECTS /* @min:%2estringifyObjects */];\r\n                        var enableCompoundKey = !!coreConfig[_DYN_ENABLE_COMPOUND_KEY /* @min:%2eenableCompoundKey */];\r\n                        if (!isUndefined(channelConfig[_DYN_ENABLE_COMPOUND_KEY /* @min:%2eenableCompoundKey */])) {\r\n                            enableCompoundKey = !!channelConfig[_DYN_ENABLE_COMPOUND_KEY /* @min:%2eenableCompoundKey */];\r\n                        }\r\n                        _xhrTimeout = channelConfig.xhrTimeout;\r\n                        _disableXhrSync = !!channelConfig[_DYN_DISABLE_XHR_SYNC /* @min:%2edisableXhrSync */];\r\n                        _disableFetchKeepAlive = !!channelConfig[_DYN_DISABLE_FETCH_KEEP_A6 /* @min:%2edisableFetchKeepAlive */];\r\n                        _addNoResponse = channelConfig[_DYN_ADD_NO_RESPONSE /* @min:%2eaddNoResponse */] !== false;\r\n                        _excludeCsMetaData = !!channelConfig[_DYN_EXCLUDE_CS_META_DATA /* @min:%2eexcludeCsMetaData */];\r\n                        if (!!core.getPlugin(\"LocalStorage\")) {\r\n                            // Always disable fetch keep alive when persisten storage is available\r\n                            _disableFetchKeepAlive = true;\r\n                        }\r\n                        _useBeacons = !isReactNative(); // Only use beacons if not running in React Native\r\n                        _serializer = new Serializer(_core, valueSanitizer, stringifyObjects, enableCompoundKey, getCommonSchemaMetaData, _excludeCsMetaData);\r\n                        if (!isNullOrUndefined(channelConfig[_DYN_USE_SEND_BEACON /* @min:%2euseSendBeacon */])) {\r\n                            _useBeacons = !!channelConfig[_DYN_USE_SEND_BEACON /* @min:%2euseSendBeacon */];\r\n                        }\r\n                        if (channelConfig[_DYN_FETCH_CREDENTIALS /* @min:%2efetchCredentials */]) {\r\n                            _fetchCredentials = channelConfig[_DYN_FETCH_CREDENTIALS /* @min:%2efetchCredentials */];\r\n                        }\r\n                        var sendPostConfig = _getSendPostMgrConfig();\r\n                        // only init it once\r\n                        if (!_sendPostMgr) {\r\n                            _sendPostMgr = new SenderPostManager();\r\n                            _sendPostMgr[_DYN_INITIALIZE /* @min:%2einitialize */](sendPostConfig, _logger);\r\n                        }\r\n                        else {\r\n                            _sendPostMgr.SetConfig(sendPostConfig);\r\n                        }\r\n                        var syncHttpInterface = httpInterface;\r\n                        var beaconHttpInterface = channelConfig[_DYN_ALWAYS_USE_XHR_OVERR7 /* @min:%2ealwaysUseXhrOverride */] ? httpInterface : null;\r\n                        var fetchSyncHttpInterface = channelConfig[_DYN_ALWAYS_USE_XHR_OVERR7 /* @min:%2ealwaysUseXhrOverride */] ? httpInterface : null;\r\n                        var beaconUnloadTransports = [3 /* TransportType.Beacon */, 2 /* TransportType.Fetch */];\r\n                        if (!httpInterface) {\r\n                            _customHttpInterface = false;\r\n                            // this is handled in SendPostManager now\r\n                            // let location = getLocation();\r\n                            // if (location && location.protocol && location.protocol.toLowerCase() === \"file:\") {\r\n                            //     // Special case where a local html file fails with a CORS error on Chromium browsers\r\n                            //     _sendCredentials = false;\r\n                            // }\r\n                            var theTransports = [];\r\n                            if (isReactNative()) {\r\n                                // Use Fetch or XDR/XHR\r\n                                theTransports = [2 /* TransportType.Fetch */, 1 /* TransportType.Xhr */];\r\n                                beaconUnloadTransports = [2 /* TransportType.Fetch */, 1 /* TransportType.Xhr */, 3 /* TransportType.Beacon */];\r\n                            }\r\n                            else {\r\n                                // Use XDR/XHR, Fetch or beacons\r\n                                theTransports = [1 /* TransportType.Xhr */, 2 /* TransportType.Fetch */, 3 /* TransportType.Beacon */];\r\n                            }\r\n                            // Prefix any user requested transport(s) values\r\n                            theTransports = prependTransports(theTransports, channelConfig.transports);\r\n                            httpInterface = _getSenderInterface(theTransports, false);\r\n                            if (!httpInterface) {\r\n                                _warnToConsole(_logger, \"No available transport to send events\");\r\n                            }\r\n                            syncHttpInterface = _getSenderInterface(theTransports, true);\r\n                        }\r\n                        if (!beaconHttpInterface) {\r\n                            // Allow overriding the usage of sendBeacon\r\n                            beaconUnloadTransports = prependTransports(beaconUnloadTransports, channelConfig[_DYN_UNLOAD_TRANSPORTS /* @min:%2eunloadTransports */]);\r\n                            beaconHttpInterface = _getSenderInterface(beaconUnloadTransports, true);\r\n                        }\r\n                        _canHaveReducedPayload = !_customHttpInterface && ((_useBeacons && isBeaconsSupported()) || (!_disableFetchKeepAlive && isFetchSupported(true)));\r\n                        _sendInterfaces = (_a = {},\r\n                            _a[0 /* EventSendType.Batched */] = httpInterface,\r\n                            _a[1 /* EventSendType.Synchronous */] = syncHttpInterface || _getSenderInterface([1 /* TransportType.Xhr */, 2 /* TransportType.Fetch */, 3 /* TransportType.Beacon */], true),\r\n                            _a[2 /* EventSendType.SendBeacon */] = beaconHttpInterface || syncHttpInterface || _getSenderInterface([1 /* TransportType.Xhr */], true),\r\n                            _a[3 /* EventSendType.SyncFetch */] = fetchSyncHttpInterface || _getSenderInterface([2 /* TransportType.Fetch */, 3 /* TransportType.Beacon */], true) || syncHttpInterface || _getSenderInterface([1 /* TransportType.Xhr */], true),\r\n                            _a);\r\n                    }));\r\n                    _isInitialized = true;\r\n                }\r\n            };\r\n            _self.addResponseHandler = function (responseHandler) {\r\n                _responseHandlers[_DYN_PUSH /* @min:%2epush */](responseHandler);\r\n                return {\r\n                    rm: function () {\r\n                        var index = _responseHandlers.indexOf(responseHandler);\r\n                        if (index >= 0) {\r\n                            _responseHandlers[_DYN_SPLICE /* @min:%2esplice */](index, 1);\r\n                        }\r\n                    }\r\n                };\r\n            };\r\n            _self[_DYN_SERIALIZE_OFFLINE_EV8 /* @min:%2eserializeOfflineEvt */] = function (evt) {\r\n                try {\r\n                    if (_serializer) {\r\n                        return _serializer.getEventBlob(evt);\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    // eslint-disable-next-line no-empty\r\n                }\r\n                return STR_EMPTY;\r\n            };\r\n            _self[_DYN_GET_OFFLINE_REQUEST_9 /* @min:%2egetOfflineRequestDetails */] = function () {\r\n                try {\r\n                    // get current url without paramter\r\n                    var payload = _serializer && _serializer[_DYN_CREATE_PAYLOAD /* @min:%2ecreatePayload */](0, false, false, false, 1 /* SendRequestReason.NormalSchedule */, 0 /* EventSendType.Batched */);\r\n                    return _buildRequestDetails(payload, _useHeaders);\r\n                }\r\n                catch (e) {\r\n                    // eslint-disable-next-line no-empty\r\n                }\r\n                return null;\r\n            };\r\n            _self[_DYN_CREATE_ONE_DSPAYLOAD /* @min:%2ecreateOneDSPayload */] = function (evts, optimize) {\r\n                try {\r\n                    // TODO: optimize\r\n                    var theBatches_1 = [];\r\n                    // create a eventBatch for each event\r\n                    arrForEach(evts, function (evt) {\r\n                        if (optimize) {\r\n                            evt = optimizeObject(evt);\r\n                        }\r\n                        var batch = EventBatch.create(evt[_DYN_I_KEY /* @min:%2eiKey */], [evt]);\r\n                        theBatches_1[_DYN_PUSH /* @min:%2epush */](batch);\r\n                    });\r\n                    var thePayload = null;\r\n                    while (theBatches_1[_DYN_LENGTH /* @min:%2elength */] > 0 && _serializer) {\r\n                        var theBatch = theBatches_1.shift();\r\n                        if (theBatch && theBatch[_DYN_COUNT /* @min:%2ecount */]() > 0) {\r\n                            thePayload = thePayload || _serializer[_DYN_CREATE_PAYLOAD /* @min:%2ecreatePayload */](0, false, false, false, 1 /* SendRequestReason.NormalSchedule */, 0 /* EventSendType.Batched */);\r\n                            _serializer.appendPayload(thePayload, theBatch, maxEventsPerBatch);\r\n                        }\r\n                    }\r\n                    var requestDetails = _buildRequestDetails(thePayload, _useHeaders);\r\n                    var payloadData = {\r\n                        data: thePayload[_DYN_PAYLOAD_BLOB /* @min:%2epayloadBlob */],\r\n                        urlString: requestDetails.url,\r\n                        headers: requestDetails[_DYN_HDRS /* @min:%2ehdrs */],\r\n                        timeout: _xhrTimeout,\r\n                        disableXhrSync: _disableXhrSync,\r\n                        disableFetchKeepAlive: _disableFetchKeepAlive\r\n                    };\r\n                    // Only automatically add the following headers if already sending headers and we are not attempting to avoid an options call\r\n                    if (_useHeaders) {\r\n                        if (!_hasHeader(payloadData[_DYN_HEADERS /* @min:%2eheaders */], STR_CACHE_CONTROL)) {\r\n                            payloadData[_DYN_HEADERS /* @min:%2eheaders */][STR_CACHE_CONTROL] = DEFAULT_CACHE_CONTROL;\r\n                        }\r\n                        if (!_hasHeader(payloadData[_DYN_HEADERS /* @min:%2eheaders */], STR_CONTENT_TYPE_HEADER)) {\r\n                            payloadData[_DYN_HEADERS /* @min:%2eheaders */][STR_CONTENT_TYPE_HEADER] = DEFAULT_CONTENT_TYPE;\r\n                        }\r\n                    }\r\n                    return payloadData;\r\n                }\r\n                catch (e) {\r\n                    // eslint-disable-next-line no-empty\r\n                }\r\n                return null;\r\n            };\r\n            // Special internal method to allow the DebugPlugin to hook embedded objects\r\n            function _getSenderInterface(transports, syncSupport) {\r\n                try {\r\n                    return _sendPostMgr && _sendPostMgr.getSenderInst(transports, syncSupport);\r\n                }\r\n                catch (e) {\r\n                    // eslint-disable-next-line no-empty\r\n                }\r\n                return null;\r\n            }\r\n            _self[\"_getDbgPlgTargets\"] = function () {\r\n                return [_sendInterfaces[0 /* EventSendType.Batched */], _killSwitch, _serializer, _sendInterfaces, _getSendPostMgrConfig(), _urlString];\r\n            };\r\n            function _getSendPostMgrConfig() {\r\n                try {\r\n                    var onCompleteFuncs = {\r\n                        xdrOnComplete: _xdrOncomplete,\r\n                        fetchOnComplete: _fetchOnComplete,\r\n                        xhrOnComplete: _xhrOnComplete,\r\n                        beaconOnRetry: _onBeaconRetry\r\n                    };\r\n                    var config = {\r\n                        enableSendPromise: false,\r\n                        isOneDs: true,\r\n                        disableCredentials: !_sendCredentials,\r\n                        fetchCredentials: _fetchCredentials,\r\n                        disableXhr: false,\r\n                        disableBeacon: !_useBeacons,\r\n                        disableBeaconSync: !_useBeacons,\r\n                        disableFetchKeepAlive: _disableFetchKeepAlive,\r\n                        timeWrapper: _timeoutWrapper,\r\n                        addNoResponse: _addNoResponse,\r\n                        senderOnCompleteCallBack: onCompleteFuncs\r\n                    };\r\n                    return config;\r\n                }\r\n                catch (e) {\r\n                    // eslint-disable-next-line no-empty\r\n                }\r\n                return null;\r\n            }\r\n            function _xdrOncomplete(xdr, oncomplete, payload) {\r\n                var response = getResponseText(xdr);\r\n                _doOnComplete(oncomplete, 200, {}, response);\r\n                _handleCollectorResponse(response);\r\n            }\r\n            function _initDefaults() {\r\n                var undefValue;\r\n                _urlString = null;\r\n                _killSwitch = new KillSwitch();\r\n                _paused = false;\r\n                _clockSkewManager = new ClockSkewManager();\r\n                _useBeacons = false;\r\n                _outstandingRequests = 0; // Holds the number of outstanding async requests that have not returned a response yet\r\n                _postManager = null;\r\n                _logger = null;\r\n                _sendInterfaces = null;\r\n                _core = null;\r\n                _customHttpInterface = true;\r\n                _queryStringParameters = [];\r\n                _headers = {};\r\n                _batchQueue = [];\r\n                _serializer = null;\r\n                _enableEventTimings = false;\r\n                _cookieMgr = null;\r\n                _isUnloading = false;\r\n                _useHeaders = false;\r\n                _xhrTimeout = undefValue;\r\n                _disableXhrSync = undefValue;\r\n                _disableFetchKeepAlive = undefValue;\r\n                _canHaveReducedPayload = undefValue;\r\n                _addNoResponse = undefValue;\r\n                _unloadHooks = [];\r\n                _sendHook = undefValue;\r\n                _sendListener = undefValue;\r\n                _responseHandlers = [];\r\n                _isInitialized = false;\r\n                _timeoutWrapper = createTimeoutWrapper();\r\n                _excludeCsMetaData = false;\r\n                _sendPostMgr = null;\r\n            }\r\n            function _fetchOnComplete(response, onComplete, resValue, payload) {\r\n                var handleResponse = function (status, headerMap, responseText) {\r\n                    _doOnComplete(onComplete, status, headerMap, responseText);\r\n                    _handleCollectorResponse(responseText);\r\n                };\r\n                var headerMap = {};\r\n                var headers = response[_DYN_HEADERS /* @min:%2eheaders */];\r\n                if (headers) {\r\n                    headers[\"forEach\"](function (value, name) {\r\n                        headerMap[name] = value;\r\n                    });\r\n                }\r\n                handleResponse(response.status, headerMap, resValue || STR_EMPTY);\r\n            }\r\n            function _xhrOnComplete(request, oncomplete, payload) {\r\n                var response = getResponseText(request);\r\n                _doOnComplete(oncomplete, request.status, _getAllResponseHeaders(request, true), response);\r\n                _handleCollectorResponse(response);\r\n            }\r\n            function _doOnComplete(oncomplete, status, headers, response) {\r\n                try {\r\n                    oncomplete(status, headers, response);\r\n                }\r\n                catch (e) {\r\n                    _throwInternal(_logger, 2 /* eLoggingSeverity.WARNING */, 518 /* _eExtendedInternalMessageId.SendPostOnCompleteFailure */, dumpObj(e));\r\n                }\r\n            }\r\n            function _onBeaconRetry(payload, onComplete, canSend) {\r\n                // Custom headers not supported in sendBeacon payload.headers would be ignored\r\n                var internalPayloadData = payload;\r\n                var status = 200;\r\n                var thePayload = internalPayloadData[_DYN__THE_PAYLOAD /* @min:%2e_thePayload */];\r\n                var theUrl = payload[_DYN_URL_STRING /* @min:%2eurlString */] + (_addNoResponse ? _noResponseQs : STR_EMPTY);\r\n                try {\r\n                    var nav_1 = getNavigator();\r\n                    if (thePayload) {\r\n                        var persistStorage = !!_core.getPlugin(\"LocalStorage\");\r\n                        // Failed to send entire payload so try and split data and try to send as much events as possible\r\n                        var droppedBatches_1 = [];\r\n                        var sentBatches_1 = [];\r\n                        arrForEach(thePayload[_DYN_BATCHES /* @min:%2ebatches */], function (theBatch) {\r\n                            if (droppedBatches_1 && theBatch && theBatch[_DYN_COUNT /* @min:%2ecount */]() > 0) {\r\n                                var theEvents = theBatch[_DYN_EVENTS /* @min:%2eevents */]();\r\n                                for (var lp = 0; lp < theEvents[_DYN_LENGTH /* @min:%2elength */]; lp++) {\r\n                                    if (!nav_1.sendBeacon(theUrl, _serializer.getEventBlob(theEvents[lp]))) {\r\n                                        // Can't send anymore, so split the batch and drop the rest\r\n                                        droppedBatches_1[_DYN_PUSH /* @min:%2epush */](theBatch[_DYN_SPLIT /* @min:%2esplit */](lp));\r\n                                        break;\r\n                                    }\r\n                                    else {\r\n                                        sentBatches_1[_DYN_PUSH /* @min:%2epush */](theBatch[lp]);\r\n                                    }\r\n                                }\r\n                            }\r\n                            else {\r\n                                // Remove all of the events from the existing batch in the payload as the copy includes the original\r\n                                droppedBatches_1[_DYN_PUSH /* @min:%2epush */](theBatch[_DYN_SPLIT /* @min:%2esplit */](0));\r\n                            }\r\n                        });\r\n                        if (sentBatches_1[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                            // Update the payload with the sent batches\r\n                            thePayload.sentEvts = sentBatches_1;\r\n                        }\r\n                        if (!persistStorage) {\r\n                            _sendBatchesNotification(droppedBatches_1, 8003 /* EventBatchNotificationReason.SizeLimitExceeded */, thePayload[_DYN_SEND_TYPE /* @min:%2esendType */], true);\r\n                        }\r\n                    }\r\n                    else {\r\n                        status = 0;\r\n                    }\r\n                }\r\n                catch (ex) {\r\n                    _warnToConsole(_logger, \"Failed to send telemetry using sendBeacon API. Ex:\" + dumpObj(ex));\r\n                    status = 0;\r\n                }\r\n                finally {\r\n                    _doOnComplete(onComplete, status, {}, STR_EMPTY);\r\n                }\r\n            }\r\n            function _isBeaconPayload(sendType) {\r\n                // Sync Fetch has the same payload limitation as sendBeacon -- 64kb limit, so treat both as a beacon send\r\n                return sendType === 2 /* EventSendType.SendBeacon */ || sendType === 3 /* EventSendType.SyncFetch */;\r\n            }\r\n            function _adjustSendType(sendType) {\r\n                if (_isUnloading && _isBeaconPayload(sendType)) {\r\n                    sendType = 2 /* EventSendType.SendBeacon */;\r\n                }\r\n                return sendType;\r\n            }\r\n            _self[_DYN_ADD_HEADER /* @min:%2eaddHeader */] = function (name, value) {\r\n                _headers[name] = value;\r\n            };\r\n            _self.removeHeader = function (name) {\r\n                delete _headers[name];\r\n            };\r\n            _self[_DYN_CAN_SEND_REQUEST /* @min:%2ecanSendRequest */] = function () {\r\n                return _hasIdleConnection() && _clockSkewManager[_DYN_ALLOW_REQUEST_SENDIN0 /* @min:%2eallowRequestSending */]();\r\n            };\r\n            _self[_DYN_SEND_QUEUED_REQUESTS /* @min:%2esendQueuedRequests */] = function (sendType, sendReason) {\r\n                if (isUndefined(sendType)) {\r\n                    sendType = 0 /* EventSendType.Batched */;\r\n                }\r\n                if (_isUnloading) {\r\n                    sendType = _adjustSendType(sendType);\r\n                    sendReason = 2 /* SendRequestReason.Unload */;\r\n                }\r\n                if (_canSendPayload(_batchQueue, sendType, 0)) {\r\n                    _sendBatches(_clearQueue(), 0, false, sendType, sendReason || 0 /* SendRequestReason.Undefined */);\r\n                }\r\n            };\r\n            _self[_DYN_IS_COMPLETELY_IDLE /* @min:%2eisCompletelyIdle */] = function () {\r\n                return !_paused && _outstandingRequests === 0 && _batchQueue[_DYN_LENGTH /* @min:%2elength */] === 0;\r\n            };\r\n            _self[_DYN_SET_UNLOADING /* @min:%2esetUnloading */] = function (value) {\r\n                _isUnloading = value;\r\n            };\r\n            _self.addBatch = function (theBatch) {\r\n                if (theBatch && theBatch[_DYN_COUNT /* @min:%2ecount */]() > 0) {\r\n                    // Try and kill the event faster\r\n                    if (_killSwitch.isTenantKilled(theBatch[_DYN_I_KEY /* @min:%2eiKey */]())) {\r\n                        return false;\r\n                    }\r\n                    _batchQueue[_DYN_PUSH /* @min:%2epush */](theBatch);\r\n                }\r\n                return true;\r\n            };\r\n            /**\r\n             * Queue all the remaining requests to be sent. The requests will be\r\n             * sent using HTML5 Beacons if they are available.\r\n             */\r\n            _self.teardown = function () {\r\n                if (_batchQueue[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                    _sendBatches(_clearQueue(), 0, true, 2 /* EventSendType.SendBeacon */, 2 /* SendRequestReason.Unload */);\r\n                }\r\n                arrForEach(_unloadHooks, function (hook) {\r\n                    hook && hook.rm && hook.rm();\r\n                });\r\n                _unloadHooks = [];\r\n            };\r\n            /**\r\n             * Pause the sending of requests. No new requests will be sent.\r\n             */\r\n            _self.pause = function () {\r\n                _paused = true;\r\n            };\r\n            /**\r\n             * Resume the sending of requests.\r\n             */\r\n            _self[_DYN_RESUME /* @min:%2eresume */] = function () {\r\n                _paused = false;\r\n                _self[_DYN_SEND_QUEUED_REQUESTS /* @min:%2esendQueuedRequests */](0 /* EventSendType.Batched */, 4 /* SendRequestReason.Resumed */);\r\n            };\r\n            /**\r\n             * Sends a request synchronously to the Aria collector. This api is used to send\r\n             * a request containing a single immediate event.\r\n             *\r\n             * @param batch - The request to be sent.\r\n             * @param sendReason   - The token used to send the request.\r\n             */\r\n            _self[_DYN_SEND_SYNCHRONOUS_BAT10 /* @min:%2esendSynchronousBatch */] = function (batch, sendType, sendReason) {\r\n                // This will not take into account the max connections restriction. Since this is sync, we can\r\n                // only send one of this request at a time and thus should not worry about multiple connections\r\n                // being used to send synchronous events.\r\n                // Increment active connection since we are still going to use a connection to send the request.\r\n                if (batch && batch[_DYN_COUNT /* @min:%2ecount */]() > 0) {\r\n                    if (isNullOrUndefined(sendType)) {\r\n                        sendType = 1 /* EventSendType.Synchronous */;\r\n                    }\r\n                    if (_isUnloading) {\r\n                        sendType = _adjustSendType(sendType);\r\n                        sendReason = 2 /* SendRequestReason.Unload */;\r\n                    }\r\n                    // For sync requests we will not wait for the clock skew.\r\n                    _sendBatches([batch], 0, false, sendType, sendReason || 0 /* SendRequestReason.Undefined */);\r\n                }\r\n            };\r\n            function _hasIdleConnection() {\r\n                return !_paused && _outstandingRequests < maxConnections;\r\n            }\r\n            function _clearQueue() {\r\n                var theQueue = _batchQueue;\r\n                _batchQueue = [];\r\n                return theQueue;\r\n            }\r\n            function _canSendPayload(theBatches, sendType, retryCnt) {\r\n                var result = false;\r\n                if (theBatches && theBatches[_DYN_LENGTH /* @min:%2elength */] > 0 && !_paused && _sendInterfaces[sendType] && _serializer) {\r\n                    // Always attempt to send synchronous events don't wait for idle or clockSkew\r\n                    // and don't block retry requests if clockSkew is not yet set\r\n                    result = (sendType !== 0 /* EventSendType.Batched */) || (_hasIdleConnection() && (retryCnt > 0 || _clockSkewManager[_DYN_ALLOW_REQUEST_SENDIN0 /* @min:%2eallowRequestSending */]()));\r\n                }\r\n                return result;\r\n            }\r\n            function _createDebugBatches(theBatches) {\r\n                var values = {};\r\n                if (theBatches) {\r\n                    arrForEach(theBatches, function (theBatch, idx) {\r\n                        values[idx] = {\r\n                            iKey: theBatch[_DYN_I_KEY /* @min:%2eiKey */](),\r\n                            evts: theBatch[_DYN_EVENTS /* @min:%2eevents */]()\r\n                        };\r\n                    });\r\n                }\r\n                return values;\r\n            }\r\n            function _sendBatches(theBatches, retryCount, isTeardown, sendType, sendReason) {\r\n                if (!theBatches || theBatches[_DYN_LENGTH /* @min:%2elength */] === 0) {\r\n                    // Nothing to do\r\n                    return;\r\n                }\r\n                if (_paused) {\r\n                    _sendBatchesNotification(theBatches, 1 /* EventBatchNotificationReason.Paused */, sendType);\r\n                    return;\r\n                }\r\n                // Make sure that if we are unloading the sendType is a supported version\r\n                sendType = _adjustSendType(sendType);\r\n                try {\r\n                    var orgBatches_1 = theBatches;\r\n                    var isSynchronous_1 = sendType !== 0 /* EventSendType.Batched */;\r\n                    doPerf(_core, function () { return \"HttpManager:_sendBatches\"; }, function (perfEvt) {\r\n                        if (perfEvt) {\r\n                            // Perf Monitoring is enabled, so create a \"Quick\" copy of the original batches so we still report\r\n                            // the original values as part of the perfEvent. This is because theBatches uses .shift() to remove each\r\n                            // batch as they are processed - removing from the original array, so by the time the _createDebugBatches()\r\n                            // function is called the passed in value has changed and therefore the reported value for the perfEvent is incorrect\r\n                            theBatches = theBatches.slice(0);\r\n                        }\r\n                        var droppedBatches = [];\r\n                        var thePayload = null;\r\n                        var serializationStart = getTime();\r\n                        var sendInterface = _sendInterfaces[sendType] || (isSynchronous_1 ? _sendInterfaces[1 /* EventSendType.Synchronous */] : _sendInterfaces[0 /* EventSendType.Batched */]);\r\n                        var sendTransport = sendInterface && sendInterface[_DYN__TRANSPORT /* @min:%2e_transport */];\r\n                        // Sync Fetch has the same payload limitation as sendBeacon -- 64kb limit\r\n                        var isReducedPayload = _canHaveReducedPayload && (_isUnloading || _isBeaconPayload(sendType) || (sendTransport === 3 /* TransportType.Beacon */ || (sendInterface._isSync && sendTransport === 2 /* TransportType.Fetch */)));\r\n                        while (_canSendPayload(theBatches, sendType, retryCount)) {\r\n                            var theBatch = theBatches.shift();\r\n                            if (theBatch && theBatch[_DYN_COUNT /* @min:%2ecount */]() > 0) {\r\n                                if (!_killSwitch.isTenantKilled(theBatch[_DYN_I_KEY /* @min:%2eiKey */]())) {\r\n                                    // Make sure we have a payload object\r\n                                    thePayload = thePayload || _serializer[_DYN_CREATE_PAYLOAD /* @min:%2ecreatePayload */](retryCount, isTeardown, isSynchronous_1, isReducedPayload, sendReason, sendType);\r\n                                    // Add the batch to the current payload\r\n                                    if (!_serializer.appendPayload(thePayload, theBatch, maxEventsPerBatch)) {\r\n                                        // Entire batch was not added so send the payload and retry adding this batch\r\n                                        _doPayloadSend(thePayload, serializationStart, getTime(), sendReason);\r\n                                        serializationStart = getTime();\r\n                                        theBatches = [theBatch][_DYN_CONCAT /* @min:%2econcat */](theBatches);\r\n                                        thePayload = null;\r\n                                    }\r\n                                    else if (thePayload.overflow !== null) {\r\n                                        // Total Payload size was exceeded so send the payload and add the unsent as the next batch to send\r\n                                        theBatches = [thePayload.overflow][_DYN_CONCAT /* @min:%2econcat */](theBatches);\r\n                                        thePayload.overflow = null;\r\n                                        _doPayloadSend(thePayload, serializationStart, getTime(), sendReason);\r\n                                        serializationStart = getTime();\r\n                                        thePayload = null;\r\n                                    }\r\n                                }\r\n                                else {\r\n                                    droppedBatches[_DYN_PUSH /* @min:%2epush */](theBatch);\r\n                                }\r\n                            }\r\n                        }\r\n                        // Make sure to flush any remaining payload\r\n                        if (thePayload) {\r\n                            _doPayloadSend(thePayload, serializationStart, getTime(), sendReason);\r\n                        }\r\n                        if (theBatches[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                            // Add any unsent batches back to the head of the queue\r\n                            _batchQueue = theBatches[_DYN_CONCAT /* @min:%2econcat */](_batchQueue);\r\n                        }\r\n                        // Now send notification about any dropped events\r\n                        _sendBatchesNotification(droppedBatches, 8004 /* EventBatchNotificationReason.KillSwitch */, sendType);\r\n                    }, function () { return ({ batches: _createDebugBatches(orgBatches_1), retryCount: retryCount, isTeardown: isTeardown, isSynchronous: isSynchronous_1, sendReason: sendReason, useSendBeacon: _isBeaconPayload(sendType), sendType: sendType }); }, !isSynchronous_1);\r\n                }\r\n                catch (ex) {\r\n                    _throwInternal(_logger, 2 /* eLoggingSeverity.WARNING */, 48 /* _eInternalMessageId.CannotSerializeObject */, \"Unexpected Exception sending batch: \" + dumpObj(ex));\r\n                }\r\n            }\r\n            function _buildRequestDetails(thePayload, useHeaders) {\r\n                var requestDetails = {\r\n                    url: _urlString,\r\n                    hdrs: {},\r\n                    useHdrs: false // Assume no headers\r\n                };\r\n                if (!useHeaders) {\r\n                    // Attempt to map headers to a query string if possible\r\n                    objForEachKey(_headers, function (name, value) {\r\n                        if (_collectorHeaderToQs[name]) {\r\n                            _addRequestDetails(requestDetails, _collectorHeaderToQs[name], value, false);\r\n                        }\r\n                        else {\r\n                            // No mapping, so just include in the headers anyway (may not get sent if using sendBeacon())\r\n                            requestDetails[_DYN_HDRS /* @min:%2ehdrs */][name] = value;\r\n                            requestDetails[_DYN_USE_HDRS /* @min:%2euseHdrs */] = true;\r\n                        }\r\n                    });\r\n                }\r\n                else {\r\n                    // Copy the pre-defined headers into the payload headers\r\n                    requestDetails[_DYN_HDRS /* @min:%2ehdrs */] = extend(requestDetails[_DYN_HDRS /* @min:%2ehdrs */], _headers);\r\n                    requestDetails.useHdrs = (objKeys(requestDetails.hdrs)[_DYN_LENGTH /* @min:%2elength */] > 0);\r\n                }\r\n                _addRequestDetails(requestDetails, STR_CLIENT_ID, \"NO_AUTH\", useHeaders);\r\n                _addRequestDetails(requestDetails, STR_CLIENT_VERSION, FullVersionString, useHeaders);\r\n                var apiQsKeys = STR_EMPTY;\r\n                arrForEach(thePayload.apiKeys, function (apiKey) {\r\n                    if (apiQsKeys[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                        apiQsKeys += \",\";\r\n                    }\r\n                    apiQsKeys += apiKey;\r\n                });\r\n                _addRequestDetails(requestDetails, STR_API_KEY, apiQsKeys, useHeaders);\r\n                _addRequestDetails(requestDetails, STR_UPLOAD_TIME, dateNow().toString(), useHeaders);\r\n                var msfpc = _getMsfpc(thePayload);\r\n                if (isValueAssigned(msfpc)) {\r\n                    requestDetails.url += \"&ext.intweb.msfpc=\" + msfpc;\r\n                }\r\n                if (_clockSkewManager[_DYN_SHOULD_ADD_CLOCK_SKE1 /* @min:%2eshouldAddClockSkewHeaders */]()) {\r\n                    _addRequestDetails(requestDetails, STR_TIME_DELTA_TO_APPLY, _clockSkewManager[_DYN_GET_CLOCK_SKEW_HEADE2 /* @min:%2egetClockSkewHeaderValue */](), useHeaders);\r\n                }\r\n                if (_core[_DYN_GET_WPARAM /* @min:%2egetWParam */]) {\r\n                    var wParam = _core[_DYN_GET_WPARAM /* @min:%2egetWParam */]();\r\n                    if (wParam >= 0) {\r\n                        requestDetails.url += \"&w=\" + wParam;\r\n                    }\r\n                }\r\n                for (var i = 0; i < _queryStringParameters[_DYN_LENGTH /* @min:%2elength */]; i++) {\r\n                    requestDetails.url += \"&\" + _queryStringParameters[i].name + \"=\" + _queryStringParameters[i].value;\r\n                }\r\n                return requestDetails;\r\n            }\r\n            function _setTimingValue(timings, name, value) {\r\n                timings[name] = timings[name] || {};\r\n                timings[name][_postManager.identifier] = value;\r\n            }\r\n            function _doPayloadSend(thePayload, serializationStart, serializationCompleted, sendReason) {\r\n                if (thePayload && thePayload.payloadBlob && thePayload.payloadBlob[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                    var useSendHook_1 = !!_sendHook;\r\n                    var sendInterface_1 = _sendInterfaces[thePayload.sendType];\r\n                    // Send all data using a beacon style transport if closing mode is on or channel was teared down\r\n                    if (!_isBeaconPayload(thePayload[_DYN_SEND_TYPE /* @min:%2esendType */]) && thePayload[_DYN_IS_BEACON /* @min:%2eisBeacon */] && thePayload.sendReason === 2 /* SendRequestReason.Unload */) {\r\n                        sendInterface_1 = _sendInterfaces[2 /* EventSendType.SendBeacon */] || _sendInterfaces[3 /* EventSendType.SyncFetch */] || sendInterface_1;\r\n                    }\r\n                    var useHeaders_1 = _useHeaders;\r\n                    // Disable header usage if we know we are using sendBeacon as additional headers are not supported\r\n                    if (thePayload.isBeacon || sendInterface_1[_DYN__TRANSPORT /* @min:%2e_transport */] === 3 /* TransportType.Beacon */) {\r\n                        useHeaders_1 = false;\r\n                    }\r\n                    var requestDetails_1 = _buildRequestDetails(thePayload, useHeaders_1);\r\n                    useHeaders_1 = useHeaders_1 || requestDetails_1[_DYN_USE_HDRS /* @min:%2euseHdrs */];\r\n                    var sendEventStart_1 = getTime();\r\n                    doPerf(_core, function () { return \"HttpManager:_doPayloadSend\"; }, function () {\r\n                        // Increment the send attempt count and add timings after packaging (So it's not serialized in the 1st attempt)\r\n                        for (var batchLp = 0; batchLp < thePayload.batches[_DYN_LENGTH /* @min:%2elength */]; batchLp++) {\r\n                            var theBatch = thePayload[_DYN_BATCHES /* @min:%2ebatches */][batchLp];\r\n                            var theEvents = theBatch[_DYN_EVENTS /* @min:%2eevents */]();\r\n                            for (var evtLp = 0; evtLp < theEvents[_DYN_LENGTH /* @min:%2elength */]; evtLp++) {\r\n                                var telemetryItem = theEvents[evtLp];\r\n                                if (_enableEventTimings) {\r\n                                    var timings = telemetryItem[_DYN_TIMINGS /* @min:%2etimings */] = telemetryItem[_DYN_TIMINGS /* @min:%2etimings */] || {};\r\n                                    _setTimingValue(timings, \"sendEventStart\", sendEventStart_1);\r\n                                    _setTimingValue(timings, \"serializationStart\", serializationStart);\r\n                                    _setTimingValue(timings, \"serializationCompleted\", serializationCompleted);\r\n                                }\r\n                                telemetryItem[strSendAttempt] > 0 ? telemetryItem[strSendAttempt]++ : telemetryItem[strSendAttempt] = 1;\r\n                            }\r\n                        }\r\n                        // Note: always sending this notification in a synchronous manner.\r\n                        _sendBatchesNotification(thePayload[_DYN_BATCHES /* @min:%2ebatches */], (1000 /* EventBatchNotificationReason.SendingUndefined */ + (sendReason || 0 /* SendRequestReason.Undefined */)), thePayload[_DYN_SEND_TYPE /* @min:%2esendType */], true);\r\n                        // Disabling the use of const because of Issue:\r\n                        // - Task 9227844: [1DS] Some environments and packagers automatically \"freeze\" objects which are defined as const which causes any mutations to throw\r\n                        // eslint-disable-next-line prefer-const\r\n                        var orgPayloadData = {\r\n                            data: thePayload[_DYN_PAYLOAD_BLOB /* @min:%2epayloadBlob */],\r\n                            urlString: requestDetails_1.url,\r\n                            headers: requestDetails_1[_DYN_HDRS /* @min:%2ehdrs */],\r\n                            _thePayload: thePayload,\r\n                            _sendReason: sendReason,\r\n                            timeout: _xhrTimeout,\r\n                            disableXhrSync: _disableXhrSync,\r\n                            disableFetchKeepAlive: _disableFetchKeepAlive\r\n                        };\r\n                        // Only automatically add the following headers if already sending headers and we are not attempting to avoid an options call\r\n                        if (useHeaders_1) {\r\n                            if (!_hasHeader(orgPayloadData[_DYN_HEADERS /* @min:%2eheaders */], STR_CACHE_CONTROL)) {\r\n                                orgPayloadData[_DYN_HEADERS /* @min:%2eheaders */][STR_CACHE_CONTROL] = DEFAULT_CACHE_CONTROL;\r\n                            }\r\n                            if (!_hasHeader(orgPayloadData[_DYN_HEADERS /* @min:%2eheaders */], STR_CONTENT_TYPE_HEADER)) {\r\n                                orgPayloadData[_DYN_HEADERS /* @min:%2eheaders */][STR_CONTENT_TYPE_HEADER] = DEFAULT_CONTENT_TYPE;\r\n                            }\r\n                        }\r\n                        var sender = null;\r\n                        if (sendInterface_1) {\r\n                            // Send sync requests if the request is immediate or we are tearing down telemetry.\r\n                            sender = function (payload) {\r\n                                // Notify the clock skew manager that we are sending the first request (Potentially blocking all further requests)\r\n                                _clockSkewManager[_DYN_FIRST_REQUEST_SENT /* @min:%2efirstRequestSent */]();\r\n                                var onComplete = function (status, headers) {\r\n                                    _retryRequestIfNeeded(status, headers, thePayload, sendReason);\r\n                                };\r\n                                var isSync = thePayload[_DYN_IS_TEARDOWN /* @min:%2eisTeardown */] || thePayload[_DYN_IS_SYNC /* @min:%2eisSync */];\r\n                                try {\r\n                                    sendInterface_1.sendPOST(payload, onComplete, isSync);\r\n                                    if (_sendListener) {\r\n                                        // Send the original payload to the listener\r\n                                        _sendListener(orgPayloadData, payload, isSync, thePayload[_DYN_IS_BEACON /* @min:%2eisBeacon */]);\r\n                                    }\r\n                                }\r\n                                catch (ex) {\r\n                                    _warnToConsole(_logger, \"Unexpected exception sending payload. Ex:\" + dumpObj(ex));\r\n                                    _doOnComplete(onComplete, 0, {});\r\n                                }\r\n                            };\r\n                        }\r\n                        doPerf(_core, function () { return \"HttpManager:_doPayloadSend.sender\"; }, function () {\r\n                            if (sender) {\r\n                                if (thePayload[_DYN_SEND_TYPE /* @min:%2esendType */] === 0 /* EventSendType.Batched */) {\r\n                                    _outstandingRequests++;\r\n                                }\r\n                                // Only call the hook if it's defined and we are not using sendBeacon as additional headers are not supported\r\n                                if (useSendHook_1 && !thePayload.isBeacon && sendInterface_1[_DYN__TRANSPORT /* @min:%2e_transport */] !== 3 /* TransportType.Beacon */) {\r\n                                    // Create a new IPayloadData that is sent into the hook method, so that the hook method\r\n                                    // can't change the object references to the orgPayloadData (it can still change the content -- mainly the headers)\r\n                                    // Disabling the use of const because of Issue:\r\n                                    // - Task 9227844: [1DS] Some environments and packagers automatically \"freeze\" objects which are defined as const which causes any mutations to throw\r\n                                    // eslint-disable-next-line prefer-const\r\n                                    var hookData_1 = {\r\n                                        data: orgPayloadData[_DYN_DATA /* @min:%2edata */],\r\n                                        urlString: orgPayloadData[_DYN_URL_STRING /* @min:%2eurlString */],\r\n                                        headers: extend({}, orgPayloadData[_DYN_HEADERS /* @min:%2eheaders */]),\r\n                                        timeout: orgPayloadData[_DYN_TIMEOUT /* @min:%2etimeout */],\r\n                                        disableXhrSync: orgPayloadData[_DYN_DISABLE_XHR_SYNC /* @min:%2edisableXhrSync */],\r\n                                        disableFetchKeepAlive: orgPayloadData[_DYN_DISABLE_FETCH_KEEP_A6 /* @min:%2edisableFetchKeepAlive */]\r\n                                    };\r\n                                    var senderCalled_1 = false;\r\n                                    doPerf(_core, function () { return \"HttpManager:_doPayloadSend.sendHook\"; }, function () {\r\n                                        try {\r\n                                            _sendHook(hookData_1, function (payload) {\r\n                                                senderCalled_1 = true;\r\n                                                // Add back the internal properties\r\n                                                if (!_customHttpInterface && !payload[_DYN__THE_PAYLOAD /* @min:%2e_thePayload */]) {\r\n                                                    payload[_DYN__THE_PAYLOAD /* @min:%2e_thePayload */] = payload[_DYN__THE_PAYLOAD /* @min:%2e_thePayload */] || orgPayloadData[_DYN__THE_PAYLOAD /* @min:%2e_thePayload */];\r\n                                                    payload[_DYN__SEND_REASON /* @min:%2e_sendReason */] = payload[_DYN__SEND_REASON /* @min:%2e_sendReason */] || orgPayloadData[_DYN__SEND_REASON /* @min:%2e_sendReason */];\r\n                                                }\r\n                                                sender(payload);\r\n                                            }, thePayload.isSync || thePayload[_DYN_IS_TEARDOWN /* @min:%2eisTeardown */]);\r\n                                        }\r\n                                        catch (ex) {\r\n                                            if (!senderCalled_1) {\r\n                                                // The hook never called the sender -- assume that it never will\r\n                                                sender(orgPayloadData);\r\n                                            }\r\n                                        }\r\n                                    });\r\n                                }\r\n                                else {\r\n                                    sender(orgPayloadData);\r\n                                }\r\n                            }\r\n                        });\r\n                    }, function () { return ({ thePayload: thePayload, serializationStart: serializationStart, serializationCompleted: serializationCompleted, sendReason: sendReason }); }, thePayload[_DYN_IS_SYNC /* @min:%2eisSync */]);\r\n                }\r\n                if (thePayload.sizeExceed && thePayload.sizeExceed[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                    // Ensure that we send any discard events for oversize events even when there was no payload to send\r\n                    _sendBatchesNotification(thePayload.sizeExceed, 8003 /* EventBatchNotificationReason.SizeLimitExceeded */, thePayload[_DYN_SEND_TYPE /* @min:%2esendType */]);\r\n                }\r\n                if (thePayload.failedEvts && thePayload.failedEvts[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                    // Ensure that we send any discard events for events that could not be serialized even when there was no payload to send\r\n                    _sendBatchesNotification(thePayload.failedEvts, 8002 /* EventBatchNotificationReason.InvalidEvent */, thePayload[_DYN_SEND_TYPE /* @min:%2esendType */]);\r\n                }\r\n            }\r\n            function _addEventCompletedTimings(theEvents, sendEventCompleted) {\r\n                if (_enableEventTimings) {\r\n                    arrForEach(theEvents, function (theEvent) {\r\n                        var timings = theEvent[_DYN_TIMINGS /* @min:%2etimings */] = theEvent[_DYN_TIMINGS /* @min:%2etimings */] || {};\r\n                        _setTimingValue(timings, \"sendEventCompleted\", sendEventCompleted);\r\n                    });\r\n                }\r\n            }\r\n            function _retryRequestIfNeeded(status, headers, thePayload, sendReason) {\r\n                var reason = 9000 /* EventBatchNotificationReason.ResponseFailure */;\r\n                var droppedBatches = null;\r\n                var isRetrying = false;\r\n                var backOffTrans = false;\r\n                try {\r\n                    var shouldRetry = true;\r\n                    if (typeof status !== strUndefined) {\r\n                        if (headers) {\r\n                            _clockSkewManager[_DYN_SET_CLOCK_SKEW /* @min:%2esetClockSkew */](headers[STR_TIME_DELTA_HEADER]);\r\n                            var killDuration = headers[STR_KILL_DURATION_HEADER] || headers[\"kill-duration-seconds\"];\r\n                            arrForEach(_killSwitch[_DYN_SET_KILL_SWITCH_TENA11 /* @min:%2esetKillSwitchTenants */](headers[STR_KILL_TOKENS_HEADER], killDuration), function (killToken) {\r\n                                arrForEach(thePayload[_DYN_BATCHES /* @min:%2ebatches */], function (theBatch) {\r\n                                    if (theBatch[_DYN_I_KEY /* @min:%2eiKey */]() === killToken) {\r\n                                        // Make sure we have initialized the array\r\n                                        droppedBatches = droppedBatches || [];\r\n                                        // Create a copy of the batch with all of the events (and more importantly the action functions)\r\n                                        var removedEvents = theBatch[_DYN_SPLIT /* @min:%2esplit */](0);\r\n                                        // And then remove the events for the payload batch and reduce the actual number of processed\r\n                                        thePayload.numEvents -= removedEvents[_DYN_COUNT /* @min:%2ecount */]();\r\n                                        droppedBatches[_DYN_PUSH /* @min:%2epush */](removedEvents);\r\n                                    }\r\n                                });\r\n                            });\r\n                        }\r\n                        // Disabling triple-equals rule to avoid httpOverrides from failing because they are returning a string value\r\n                        // tslint:disable-next-line:triple-equals\r\n                        if (status == 200 || status == 204) {\r\n                            // Response was successfully sent\r\n                            reason = 200 /* EventBatchNotificationReason.Complete */;\r\n                            return;\r\n                        }\r\n                        if (!retryPolicyShouldRetryForStatus(status) || thePayload.numEvents <= 0) {\r\n                            // Only retry for specific response codes and if there is still events after kill switch processing\r\n                            shouldRetry = false;\r\n                        }\r\n                        // Derive the notification response from the HttpStatus Code\r\n                        reason = 9000 /* EventBatchNotificationReason.ResponseFailure */ + (status % 1000);\r\n                    }\r\n                    if (shouldRetry) {\r\n                        // The events should be retried -- so change notification to requeue them\r\n                        reason = 100 /* EventBatchNotificationReason.RequeueEvents */;\r\n                        var retryCount_1 = thePayload.retryCnt;\r\n                        if (thePayload[_DYN_SEND_TYPE /* @min:%2esendType */] === 0 /* EventSendType.Batched */) {\r\n                            // attempt to resend the entire batch\r\n                            if (retryCount_1 < maxRequestRetriesBeforeBackoff) {\r\n                                isRetrying = true;\r\n                                _doAction(function () {\r\n                                    // try to resend the same batches\r\n                                    if (thePayload[_DYN_SEND_TYPE /* @min:%2esendType */] === 0 /* EventSendType.Batched */) {\r\n                                        // Reduce the outstanding request count (if this was an async request) as we didn't reduce the count\r\n                                        // previously and we are about to reschedule our retry attempt and we want an attempt to send\r\n                                        // to occur, it's also required to ensure that a follow up handleRequestFinished() call occurs\r\n                                        _outstandingRequests--;\r\n                                    }\r\n                                    _sendBatches(thePayload[_DYN_BATCHES /* @min:%2ebatches */], retryCount_1 + 1, thePayload[_DYN_IS_TEARDOWN /* @min:%2eisTeardown */], _isUnloading ? 2 /* EventSendType.SendBeacon */ : thePayload[_DYN_SEND_TYPE /* @min:%2esendType */], 5 /* SendRequestReason.Retry */);\r\n                                }, _isUnloading, retryPolicyGetMillisToBackoffForRetry(retryCount_1));\r\n                            }\r\n                            else {\r\n                                backOffTrans = true;\r\n                                if (_isUnloading) {\r\n                                    // we are unloading so don't try and requeue the events otherwise let the events get requeued and resent during the backoff sending\r\n                                    // This will also cause the events to be purged based on the priority (if necessary)\r\n                                    reason = 8001 /* EventBatchNotificationReason.NonRetryableStatus */;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                finally {\r\n                    if (!isRetrying) {\r\n                        // Make sure the clockSkewManager doesn't blocking further sending of requests once we have a proper response\r\n                        // This won't override any previously sent clock Skew value\r\n                        _clockSkewManager[_DYN_SET_CLOCK_SKEW /* @min:%2esetClockSkew */]();\r\n                        _handleRequestFinished(thePayload, reason, sendReason, backOffTrans);\r\n                    }\r\n                    _sendBatchesNotification(droppedBatches, 8004 /* EventBatchNotificationReason.KillSwitch */, thePayload[_DYN_SEND_TYPE /* @min:%2esendType */]);\r\n                }\r\n            }\r\n            function _handleRequestFinished(thePayload, batchReason, sendReason, backOffTrans) {\r\n                try {\r\n                    if (backOffTrans) {\r\n                        // Slow down the transmission requests\r\n                        _postManager[_DYN__BACK_OFF_TRANSMISSI12 /* @min:%2e_backOffTransmission */]();\r\n                    }\r\n                    var theBatches = thePayload[_DYN_BATCHES /* @min:%2ebatches */];\r\n                    if (batchReason === 200 /* EventBatchNotificationReason.Complete */) {\r\n                        theBatches = thePayload.sentEvts || thePayload[_DYN_BATCHES /* @min:%2ebatches */];\r\n                        if (!backOffTrans && !thePayload[_DYN_IS_SYNC /* @min:%2eisSync */]) {\r\n                            // We have a successful async response, so the lets open the floodgates\r\n                            // The reason for checking isSync is to avoid unblocking if beacon send occurred as it\r\n                            // doesn't wait for a response.\r\n                            _postManager._clearBackOff();\r\n                        }\r\n                        _addCompleteTimings(theBatches);\r\n                    }\r\n                    // Send the notifications synchronously\r\n                    _sendBatchesNotification(theBatches, batchReason, thePayload[_DYN_SEND_TYPE /* @min:%2esendType */], true);\r\n                }\r\n                finally {\r\n                    if (thePayload[_DYN_SEND_TYPE /* @min:%2esendType */] === 0 /* EventSendType.Batched */) {\r\n                        // we always need to decrement this value otherwise the httpmanager locks up and won't send any more events\r\n                        _outstandingRequests--;\r\n                        // Don't try to send additional queued events if this is a retry operation as the retried\r\n                        // response will eventually call _handleRequestFinished for the retried event\r\n                        if (sendReason !== 5 /* SendRequestReason.Retry */) {\r\n                            // Try and send any other queued batched events\r\n                            _self.sendQueuedRequests(thePayload[_DYN_SEND_TYPE /* @min:%2esendType */], sendReason);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            function _addCompleteTimings(theBatches) {\r\n                if (_enableEventTimings) {\r\n                    var sendEventCompleted_1 = getTime();\r\n                    arrForEach(theBatches, function (theBatch) {\r\n                        if (theBatch && theBatch[_DYN_COUNT /* @min:%2ecount */]() > 0) {\r\n                            _addEventCompletedTimings(theBatch[_DYN_EVENTS /* @min:%2eevents */](), sendEventCompleted_1);\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n            function _doAction(cb, isSync, interval) {\r\n                if (isSync) {\r\n                    cb();\r\n                }\r\n                else {\r\n                    _timeoutWrapper.set(cb, interval);\r\n                }\r\n            }\r\n            function _getMsfpc(thePayload) {\r\n                for (var lp = 0; lp < thePayload.batches[_DYN_LENGTH /* @min:%2elength */]; lp++) {\r\n                    var msfpc = thePayload[_DYN_BATCHES /* @min:%2ebatches */][lp].Msfpc();\r\n                    if (msfpc) {\r\n                        return encodeURIComponent(msfpc);\r\n                    }\r\n                }\r\n                return STR_EMPTY;\r\n            }\r\n            function _handleCollectorResponse(responseText) {\r\n                var responseHandlers = _responseHandlers;\r\n                try {\r\n                    for (var i = 0; i < responseHandlers[_DYN_LENGTH /* @min:%2elength */]; i++) {\r\n                        try {\r\n                            responseHandlers[i](responseText);\r\n                        }\r\n                        catch (e) {\r\n                            _throwInternal(_logger, 1 /* eLoggingSeverity.CRITICAL */, 519 /* _eExtendedInternalMessageId.PostResponseHandler */, \"Response handler failed: \" + e);\r\n                        }\r\n                    }\r\n                    if (responseText) {\r\n                        var response = JSON.parse(responseText);\r\n                        if (isValueAssigned(response.webResult) && isValueAssigned(response.webResult[STR_MSFPC])) {\r\n                            // Set cookie\r\n                            _cookieMgr.set(\"MSFPC\", response.webResult[STR_MSFPC], 365 * 86400);\r\n                        }\r\n                    }\r\n                }\r\n                catch (ex) {\r\n                    // Doing nothing\r\n                }\r\n            }\r\n            function _sendBatchesNotification(theBatches, batchReason, sendType, sendSync) {\r\n                if (theBatches && theBatches[_DYN_LENGTH /* @min:%2elength */] > 0 && actions) {\r\n                    var theAction_1 = actions[_getNotificationAction(batchReason)];\r\n                    if (theAction_1) {\r\n                        var isSyncRequest_1 = sendType !== 0 /* EventSendType.Batched */;\r\n                        doPerf(_core, function () { return \"HttpManager:_sendBatchesNotification\"; }, function () {\r\n                            _doAction(function () {\r\n                                try {\r\n                                    theAction_1.call(actions, theBatches, batchReason, isSyncRequest_1, sendType);\r\n                                }\r\n                                catch (e) {\r\n                                    _throwInternal(_logger, 1 /* eLoggingSeverity.CRITICAL */, 74 /* _eInternalMessageId.NotificationException */, \"send request notification failed: \" + e);\r\n                                }\r\n                            }, sendSync || isSyncRequest_1, 0);\r\n                        }, function () { return ({ batches: _createDebugBatches(theBatches), reason: batchReason, isSync: isSyncRequest_1, sendSync: sendSync, sendType: sendType }); }, !isSyncRequest_1);\r\n                    }\r\n                }\r\n            }\r\n            function _getNotificationAction(reason) {\r\n                var action = _eventActionMap[reason];\r\n                if (!isValueAssigned(action)) {\r\n                    action = STR_OTHER;\r\n                    if (reason >= 9000 /* EventBatchNotificationReason.ResponseFailure */ && reason <= 9999 /* EventBatchNotificationReason.ResponseFailureMax */) {\r\n                        action = STR_RESPONSE_FAIL;\r\n                    }\r\n                    else if (reason >= 8000 /* EventBatchNotificationReason.EventsDropped */ && reason <= 8999 /* EventBatchNotificationReason.EventsDroppedMax */) {\r\n                        action = STR_DROPPED;\r\n                    }\r\n                    else if (reason >= 1000 /* EventBatchNotificationReason.SendingUndefined */ && reason <= 1999 /* EventBatchNotificationReason.SendingEventMax */) {\r\n                        action = STR_SENDING;\r\n                    }\r\n                }\r\n                return action;\r\n            }\r\n        });\r\n    }\r\n// Removed Stub for HttpManager.prototype.initialize.\r\n// Removed Stub for HttpManager.prototype.addHeader.\r\n// Removed Stub for HttpManager.prototype.removeHeader.\r\n// Removed Stub for HttpManager.prototype.addResponseHandler.\r\n// Removed Stub for HttpManager.prototype.addBatch.\r\n// Removed Stub for HttpManager.prototype.canSendRequest.\r\n// Removed Stub for HttpManager.prototype.sendQueuedRequests.\r\n// Removed Stub for HttpManager.prototype.isCompletelyIdle.\r\n// Removed Stub for HttpManager.prototype.setUnloading.\r\n// Removed Stub for HttpManager.prototype.teardown.\r\n// Removed Stub for HttpManager.prototype.pause.\r\n// Removed Stub for HttpManager.prototype.resume.\r\n// Removed Stub for HttpManager.prototype.sendSynchronousBatch.\r\n// Removed Stub for HttpManager.prototype.serializeOfflineEvt.\r\n// Removed Stub for HttpManager.prototype.getOfflineRequestDetails.\r\n// Removed Stub for HttpManager.prototype.createOneDSPayload.\r\n    // This is a workaround for an IE bug when using dynamicProto() with classes that don't have any\n    // non-dynamic functions or static properties/functions when using uglify-js to minify the resulting code.\n    HttpManager.__ieDyn=1;\n\n    return HttpManager;\r\n}());\r\nexport { HttpManager };\r\n//# sourceMappingURL=HttpManager.js.map","/*\n * 1DS JS SDK POST plugin, 4.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n * (Microsoft Internal Only)\n */\n/**\r\n* TimeoutOverrideWrapper.ts\r\n* @author  Nev Wylie (newylie)\r\n* @copyright Microsoft 2022\r\n* Simple internal timeout wrapper\r\n*/\r\nimport { scheduleTimeoutWith } from \"@nevware21/ts-utils\";\r\nexport function createTimeoutWrapper(argSetTimeout, argClearTimeout) {\r\n    return {\r\n        set: function (callback, ms) {\r\n            var args = [];\r\n            for (var _i = 2; _i < arguments.length; _i++) {\r\n                args[_i - 2] = arguments[_i];\r\n            }\r\n            return scheduleTimeoutWith([argSetTimeout, argClearTimeout], callback, ms, args);\r\n        }\r\n    };\r\n}\r\n//# sourceMappingURL=TimeoutOverrideWrapper.js.map","/*\n * 1DS JS SDK POST plugin, 4.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n * (Microsoft Internal Only)\n */\nimport { __extendsFn as __extends } from \"@microsoft/applicationinsights-shims\";\r\n/**\r\n* PostManager.ts\r\n* @author Abhilash Panwar (abpanwar); Hector Hernandez (hectorh); Nev Wylie (newylie)\r\n* @copyright Microsoft 2018-2020\r\n*/\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { BaseTelemetryPlugin, EventsDiscardedReason, _throwInternal, addPageHideEventListener, addPageShowEventListener, addPageUnloadEventListener, arrForEach, createProcessTelemetryContext, createUniqueNamespace, doPerf, getWindow, isChromium, isGreaterThanZero, isNumber, mergeEvtNamespace, objForEachKey, onConfigChange, optimizeObject, proxyFunctions, removePageHideEventListener, removePageShowEventListener, removePageUnloadEventListener, setProcessTelemetryTimings } from \"@microsoft/1ds-core-js\";\r\nimport { createPromise } from \"@nevware21/ts-async\";\r\nimport { isPromiseLike, objDeepFreeze } from \"@nevware21/ts-utils\";\r\nimport { BE_PROFILE, NRT_PROFILE, RT_PROFILE } from \"./DataModels\";\r\nimport { EventBatch } from \"./EventBatch\";\r\nimport { HttpManager } from \"./HttpManager\";\r\nimport { STR_AUTH_WEB_TOKEN, STR_MSA_DEVICE_TICKET, STR_TRACE, STR_USER } from \"./InternalConstants\";\r\nimport { retryPolicyGetMillisToBackoffForRetry } from \"./RetryPolicy\";\r\nimport { createTimeoutWrapper } from \"./TimeoutOverrideWrapper\";\r\nimport { _DYN_ADD_HEADER, _DYN_AUTO_FLUSH_EVENTS_LI14, _DYN_BASE_DATA, _DYN_BATCHES, _DYN_CAN_SEND_REQUEST, _DYN_CLEAR_TIMEOUT_OVERRI3, _DYN_CONCAT, _DYN_COUNT, _DYN_CREATE_ONE_DSPAYLOAD, _DYN_DATA, _DYN_DISABLE_AUTO_BATCH_F15, _DYN_DISABLE_OPTIMIZE_OBJ, _DYN_DISABLE_TELEMETRY, _DYN_EVENTS, _DYN_EVENTS_LIMIT_IN_MEM, _DYN_GET_OFFLINE_REQUEST_9, _DYN_GET_WPARAM, _DYN_IDENTIFIER, _DYN_IGNORE_MC1_MS0_COOKI13, _DYN_INITIALIZE, _DYN_IS_COMPLETELY_IDLE, _DYN_I_KEY, _DYN_LATENCY, _DYN_LENGTH, _DYN_OVERRIDE_INSTRUMENTA16, _DYN_PUSH, _DYN_RESUME, _DYN_SEND_ATTEMPT, _DYN_SEND_QUEUED_REQUESTS, _DYN_SEND_SYNCHRONOUS_BAT10, _DYN_SERIALIZE_OFFLINE_EV8, _DYN_SET_TIMEOUT_OVERRIDE, _DYN_SET_UNLOADING, _DYN_SPLICE, _DYN_SPLIT, _DYN_SYNC, _DYN__BACK_OFF_TRANSMISSI12 } from \"./__DynamicConstants\";\r\nvar FlushCheckTimer = 0.250; // This needs to be in seconds, so this is 250ms\r\nvar MaxNumberEventPerBatch = 500;\r\nvar EventsDroppedAtOneTime = 20;\r\nvar MaxSendAttempts = 6;\r\nvar MaxSyncUnloadSendAttempts = 2; // Assuming 2 based on beforeunload and unload\r\nvar MaxBackoffCount = 4;\r\nvar MaxConnections = 2;\r\nvar MaxRequestRetriesBeforeBackoff = 1;\r\nvar MaxEventsLimitInMem = 10000;\r\nvar strEventsDiscarded = \"eventsDiscarded\";\r\nvar EMPTY_STR = \"\";\r\nvar undefValue = undefined;\r\n/**\r\n * The default settings for the config.\r\n * WE MUST include all defaults here to ensure that the config is created with all of the properties\r\n * defined as dynamic.\r\n */\r\nvar defaultPostChannelConfig = objDeepFreeze({\r\n    eventsLimitInMem: { isVal: isGreaterThanZero, v: MaxEventsLimitInMem },\r\n    immediateEventLimit: { isVal: isGreaterThanZero, v: 500 },\r\n    autoFlushEventsLimit: { isVal: isGreaterThanZero, v: 0 },\r\n    disableAutoBatchFlushLimit: false,\r\n    httpXHROverride: { isVal: isOverrideFn, v: undefValue },\r\n    overrideInstrumentationKey: undefValue,\r\n    overrideEndpointUrl: undefValue,\r\n    disableTelemetry: false,\r\n    ignoreMc1Ms0CookieProcessing: false,\r\n    setTimeoutOverride: undefValue,\r\n    clearTimeoutOverride: undefValue,\r\n    payloadPreprocessor: undefValue,\r\n    payloadListener: undefValue,\r\n    disableEventTimings: undefValue,\r\n    valueSanitizer: undefValue,\r\n    stringifyObjects: undefValue,\r\n    enableCompoundKey: undefValue,\r\n    disableOptimizeObj: false,\r\n    fetchCredentials: undefValue,\r\n    // disableCacheHeader: undefValue, // See Task #7178858 - Collector requires a change to support this\r\n    transports: undefValue,\r\n    unloadTransports: undefValue,\r\n    useSendBeacon: undefValue,\r\n    disableFetchKeepAlive: undefValue,\r\n    avoidOptions: false,\r\n    xhrTimeout: undefValue,\r\n    disableXhrSync: undefValue,\r\n    alwaysUseXhrOverride: false,\r\n    maxEventRetryAttempts: { isVal: isNumber, v: MaxSendAttempts },\r\n    maxUnloadEventRetryAttempts: { isVal: isNumber, v: MaxSyncUnloadSendAttempts },\r\n    addNoResponse: undefValue,\r\n    excludeCsMetaData: undefValue\r\n});\r\nfunction isOverrideFn(httpXHROverride) {\r\n    return httpXHROverride && httpXHROverride.sendPOST;\r\n}\r\n/**\r\n * Class that manages adding events to inbound queues and batching of events\r\n * into requests.\r\n * @group Classes\r\n * @group Entrypoint\r\n */\r\nvar PostChannel = /** @class */ (function (_super) {\r\n    __extends(PostChannel, _super);\r\n    function PostChannel() {\r\n        var _this = _super.call(this) || this;\r\n        _this.identifier = \"PostChannel\";\r\n        _this.priority = 1011;\r\n        _this.version = '4.3.4';\r\n        var _postConfig;\r\n        var _isTeardownCalled = false;\r\n        var _flushCallbackQueue = [];\r\n        var _flushCallbackTimer;\r\n        var _paused = false;\r\n        var _immediateQueueSize = 0;\r\n        var _immediateQueueSizeLimit;\r\n        var _queueSize = 0;\r\n        var _queueSizeLimit;\r\n        var _profiles = {};\r\n        var _currentProfile = RT_PROFILE;\r\n        var _scheduledTimer;\r\n        var _immediateTimer;\r\n        var _currentBackoffCount;\r\n        var _timerCount;\r\n        var _httpManager;\r\n        var _batchQueues;\r\n        var _autoFlushEventsLimit;\r\n        // either MaxBatchSize * (1+ Max Connections) or _queueLimit / 6 (where 3 latency Queues [normal, realtime, cost deferred] * 2 [allow half full -- allow for retry])\r\n        var _autoFlushBatchLimit;\r\n        var _delayedBatchSendLatency;\r\n        var _delayedBatchReason;\r\n        var _optimizeObject;\r\n        var _isPageUnloadTriggered;\r\n        var _maxEventSendAttempts;\r\n        var _maxUnloadEventSendAttempts;\r\n        var _evtNamespace;\r\n        var _timeoutWrapper;\r\n        var _ignoreMc1Ms0CookieProcessing;\r\n        var _disableAutoBatchFlushLimit;\r\n        var _notificationManager;\r\n        var _unloadHandlersAdded;\r\n        var _overrideInstrumentationKey;\r\n        var _disableTelemetry;\r\n        dynamicProto(PostChannel, _this, function (_self, _base) {\r\n            _initDefaults();\r\n            // Special internal method to allow the DebugPlugin to hook embedded objects\r\n            _self[\"_getDbgPlgTargets\"] = function () {\r\n                return [_httpManager, _postConfig];\r\n            };\r\n            _self[_DYN_INITIALIZE /* @min:%2einitialize */] = function (theConfig, core, extensions) {\r\n                doPerf(core, function () { return \"PostChannel:initialize\"; }, function () {\r\n                    _base[_DYN_INITIALIZE /* @min:%2einitialize */](theConfig, core, extensions);\r\n                    _notificationManager = core.getNotifyMgr();\r\n                    try {\r\n                        _evtNamespace = mergeEvtNamespace(createUniqueNamespace(_self[_DYN_IDENTIFIER /* @min:%2eidentifier */]), core.evtNamespace && core.evtNamespace());\r\n                        _self._addHook(onConfigChange(theConfig, function (details) {\r\n                            var coreConfig = details.cfg;\r\n                            var ctx = createProcessTelemetryContext(null, coreConfig, core);\r\n                            _postConfig = ctx.getExtCfg(_self[_DYN_IDENTIFIER /* @min:%2eidentifier */], defaultPostChannelConfig);\r\n                            _timeoutWrapper = createTimeoutWrapper(_postConfig[_DYN_SET_TIMEOUT_OVERRIDE /* @min:%2esetTimeoutOverride */], _postConfig[_DYN_CLEAR_TIMEOUT_OVERRI3 /* @min:%2eclearTimeoutOverride */]);\r\n                            // Only try and use the optimizeObject() if this appears to be a chromium based browser and it has not been explicitly disabled\r\n                            _optimizeObject = !_postConfig[_DYN_DISABLE_OPTIMIZE_OBJ /* @min:%2edisableOptimizeObj */] && isChromium();\r\n                            _ignoreMc1Ms0CookieProcessing = _postConfig[_DYN_IGNORE_MC1_MS0_COOKI13 /* @min:%2eignoreMc1Ms0CookieProcessing */];\r\n                            _hookWParam(core); // _hookWParam uses _ignoreMc1Ms0CookieProcessing\r\n                            _queueSizeLimit = _postConfig[_DYN_EVENTS_LIMIT_IN_MEM /* @min:%2eeventsLimitInMem */];\r\n                            _immediateQueueSizeLimit = _postConfig.immediateEventLimit;\r\n                            _autoFlushEventsLimit = _postConfig[_DYN_AUTO_FLUSH_EVENTS_LI14 /* @min:%2eautoFlushEventsLimit */];\r\n                            _maxEventSendAttempts = _postConfig.maxEventRetryAttempts;\r\n                            _maxUnloadEventSendAttempts = _postConfig.maxUnloadEventRetryAttempts;\r\n                            _disableAutoBatchFlushLimit = _postConfig[_DYN_DISABLE_AUTO_BATCH_F15 /* @min:%2edisableAutoBatchFlushLimit */];\r\n                            if (isPromiseLike(coreConfig.endpointUrl)) {\r\n                                _self.pause();\r\n                            }\r\n                            else if (!!_paused) {\r\n                                // if previous url is promise, resume\r\n                                _self[_DYN_RESUME /* @min:%2eresume */]();\r\n                            }\r\n                            _setAutoLimits();\r\n                            // Override iKey if provided in Post config if provided for during initialization\r\n                            _overrideInstrumentationKey = _postConfig[_DYN_OVERRIDE_INSTRUMENTA16 /* @min:%2eoverrideInstrumentationKey */];\r\n                            // DisableTelemetry was defined in the config provided during initialization\r\n                            _disableTelemetry = !!_postConfig[_DYN_DISABLE_TELEMETRY /* @min:%2edisableTelemetry */];\r\n                            if (_unloadHandlersAdded) {\r\n                                _removeUnloadHandlers();\r\n                            }\r\n                            var excludePageUnloadEvents = coreConfig.disablePageUnloadEvents || [];\r\n                            // When running in Web browsers try to send all telemetry if page is unloaded\r\n                            _unloadHandlersAdded = addPageUnloadEventListener(_handleUnloadEvents, excludePageUnloadEvents, _evtNamespace);\r\n                            _unloadHandlersAdded = addPageHideEventListener(_handleUnloadEvents, excludePageUnloadEvents, _evtNamespace) || _unloadHandlersAdded;\r\n                            _unloadHandlersAdded = addPageShowEventListener(_handleShowEvents, coreConfig.disablePageShowEvents, _evtNamespace) || _unloadHandlersAdded;\r\n                        }));\r\n                        // only initialize the manager once\r\n                        _httpManager[_DYN_INITIALIZE /* @min:%2einitialize */](theConfig, _self.core, _self);\r\n                    }\r\n                    catch (e) {\r\n                        // resetting the initialized state because of failure\r\n                        _self.setInitialized(false);\r\n                        throw e;\r\n                    }\r\n                }, function () { return ({ theConfig: theConfig, core: core, extensions: extensions }); });\r\n            };\r\n            _self.processTelemetry = function (ev, itemCtx) {\r\n                setProcessTelemetryTimings(ev, _self[_DYN_IDENTIFIER /* @min:%2eidentifier */]);\r\n                itemCtx = itemCtx || _self._getTelCtx(itemCtx);\r\n                var event = ev;\r\n                if (!_disableTelemetry && !_isTeardownCalled) {\r\n                    // Override iKey if provided in Post config if provided for during initialization\r\n                    if (_overrideInstrumentationKey) {\r\n                        event[_DYN_I_KEY /* @min:%2eiKey */] = _overrideInstrumentationKey;\r\n                    }\r\n                    _addEventToQueues(event, true);\r\n                    if (_isPageUnloadTriggered) {\r\n                        // Unload event has been received so we need to try and flush new events\r\n                        _releaseAllQueues(2 /* EventSendType.SendBeacon */, 2 /* SendRequestReason.Unload */);\r\n                    }\r\n                    else {\r\n                        _scheduleTimer();\r\n                    }\r\n                }\r\n                _self.processNext(event, itemCtx);\r\n            };\r\n            _self.getOfflineSupport = function () {\r\n                try {\r\n                    var details_1 = _httpManager && _httpManager[_DYN_GET_OFFLINE_REQUEST_9 /* @min:%2egetOfflineRequestDetails */]();\r\n                    if (_httpManager) {\r\n                        return {\r\n                            getUrl: function () {\r\n                                if (details_1) {\r\n                                    return details_1.url;\r\n                                }\r\n                                return null;\r\n                            },\r\n                            serialize: _serialize,\r\n                            batch: _batch,\r\n                            shouldProcess: function (evt) {\r\n                                return !_disableTelemetry;\r\n                            },\r\n                            createPayload: function (evt) {\r\n                                return null;\r\n                            },\r\n                            createOneDSPayload: function (evts) {\r\n                                if (_httpManager[_DYN_CREATE_ONE_DSPAYLOAD /* @min:%2ecreateOneDSPayload */]) {\r\n                                    return _httpManager[_DYN_CREATE_ONE_DSPAYLOAD /* @min:%2ecreateOneDSPayload */](evts, _optimizeObject);\r\n                                }\r\n                            }\r\n                        };\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    // eslint-disable-next-line no-empty\r\n                }\r\n                return null;\r\n            };\r\n            _self._doTeardown = function (unloadCtx, unloadState) {\r\n                _releaseAllQueues(2 /* EventSendType.SendBeacon */, 2 /* SendRequestReason.Unload */);\r\n                _isTeardownCalled = true;\r\n                _httpManager.teardown();\r\n                _removeUnloadHandlers();\r\n                // Just register to remove all events associated with this namespace\r\n                _initDefaults();\r\n            };\r\n            function _removeUnloadHandlers() {\r\n                removePageUnloadEventListener(null, _evtNamespace);\r\n                removePageHideEventListener(null, _evtNamespace);\r\n                removePageShowEventListener(null, _evtNamespace);\r\n            }\r\n            function _hookWParam(core) {\r\n                var existingGetWParamMethod = core[_DYN_GET_WPARAM /* @min:%2egetWParam */];\r\n                core[_DYN_GET_WPARAM /* @min:%2egetWParam */] = function () {\r\n                    var wparam = 0;\r\n                    if (_ignoreMc1Ms0CookieProcessing) {\r\n                        wparam = wparam | 2;\r\n                    }\r\n                    return wparam | existingGetWParamMethod.call(core);\r\n                };\r\n            }\r\n            function _batch(arr) {\r\n                var rlt = EMPTY_STR;\r\n                if (arr && arr[_DYN_LENGTH /* @min:%2elength */]) {\r\n                    arrForEach(arr, function (item) {\r\n                        if (rlt) {\r\n                            rlt += \"\\n\";\r\n                        }\r\n                        rlt += item;\r\n                    });\r\n                }\r\n                return rlt;\r\n            }\r\n            function _serialize(event) {\r\n                var rlt = EMPTY_STR;\r\n                try {\r\n                    _cleanEvent(event);\r\n                    rlt = _httpManager[_DYN_SERIALIZE_OFFLINE_EV8 /* @min:%2eserializeOfflineEvt */](event);\r\n                }\r\n                catch (e) {\r\n                    // eslint-disable-next-line no-empty\r\n                }\r\n                return rlt;\r\n            }\r\n            // Moving event handlers out from the initialize closure so that any local variables can be garbage collected\r\n            function _handleUnloadEvents(evt) {\r\n                var theEvt = evt || getWindow().event; // IE 8 does not pass the event\r\n                if (theEvt.type !== \"beforeunload\") {\r\n                    // Only set the unload trigger if not beforeunload event as beforeunload can be cancelled while the other events can't\r\n                    _isPageUnloadTriggered = true;\r\n                    _httpManager[_DYN_SET_UNLOADING /* @min:%2esetUnloading */](_isPageUnloadTriggered);\r\n                }\r\n                _releaseAllQueues(2 /* EventSendType.SendBeacon */, 2 /* SendRequestReason.Unload */);\r\n            }\r\n            function _handleShowEvents(evt) {\r\n                // Handle the page becoming visible again\r\n                _isPageUnloadTriggered = false;\r\n                _httpManager[_DYN_SET_UNLOADING /* @min:%2esetUnloading */](_isPageUnloadTriggered);\r\n            }\r\n            function _cleanEvent(event) {\r\n                if (event.ext && event.ext[STR_TRACE]) {\r\n                    delete (event.ext[STR_TRACE]);\r\n                }\r\n                if (event.ext && event.ext[STR_USER] && event.ext[STR_USER][\"id\"]) {\r\n                    delete (event.ext[STR_USER][\"id\"]);\r\n                }\r\n                // v8 performance optimization for iterating over the keys\r\n                if (_optimizeObject) {\r\n                    event.ext = optimizeObject(event.ext);\r\n                    if (event[_DYN_BASE_DATA /* @min:%2ebaseData */]) {\r\n                        event[_DYN_BASE_DATA /* @min:%2ebaseData */] = optimizeObject(event[_DYN_BASE_DATA /* @min:%2ebaseData */]);\r\n                    }\r\n                    if (event[_DYN_DATA /* @min:%2edata */]) {\r\n                        event[_DYN_DATA /* @min:%2edata */] = optimizeObject(event[_DYN_DATA /* @min:%2edata */]);\r\n                    }\r\n                }\r\n            }\r\n            function _addEventToQueues(event, append) {\r\n                // If send attempt field is undefined we should set it to 0.\r\n                if (!event[_DYN_SEND_ATTEMPT /* @min:%2esendAttempt */]) {\r\n                    event[_DYN_SEND_ATTEMPT /* @min:%2esendAttempt */] = 0;\r\n                }\r\n                // Add default latency\r\n                if (!event[_DYN_LATENCY /* @min:%2elatency */]) {\r\n                    event[_DYN_LATENCY /* @min:%2elatency */] = 1 /* EventLatencyValue.Normal */;\r\n                }\r\n                _cleanEvent(event);\r\n                if (event[_DYN_SYNC /* @min:%2esync */]) {\r\n                    // If the transmission is backed off then do not send synchronous events.\r\n                    // We will convert these events to Real time latency instead.\r\n                    if (_currentBackoffCount || _paused) {\r\n                        event[_DYN_LATENCY /* @min:%2elatency */] = 3 /* EventLatencyValue.RealTime */;\r\n                        event[_DYN_SYNC /* @min:%2esync */] = false;\r\n                    }\r\n                    else {\r\n                        // Log the event synchronously\r\n                        if (_httpManager) {\r\n                            // v8 performance optimization for iterating over the keys\r\n                            if (_optimizeObject) {\r\n                                event = optimizeObject(event);\r\n                            }\r\n                            _httpManager[_DYN_SEND_SYNCHRONOUS_BAT10 /* @min:%2esendSynchronousBatch */](EventBatch.create(event[_DYN_I_KEY /* @min:%2eiKey */], [event]), event[_DYN_SYNC /* @min:%2esync */] === true ? 1 /* EventSendType.Synchronous */ : event[_DYN_SYNC /* @min:%2esync */], 3 /* SendRequestReason.SyncEvent */);\r\n                            return;\r\n                        }\r\n                    }\r\n                }\r\n                var evtLatency = event[_DYN_LATENCY /* @min:%2elatency */];\r\n                var queueSize = _queueSize;\r\n                var queueLimit = _queueSizeLimit;\r\n                if (evtLatency === 4 /* EventLatencyValue.Immediate */) {\r\n                    queueSize = _immediateQueueSize;\r\n                    queueLimit = _immediateQueueSizeLimit;\r\n                }\r\n                var eventDropped = false;\r\n                // Only add the event if the queue isn't full or it's a direct event (which don't add to the queue sizes)\r\n                if (queueSize < queueLimit) {\r\n                    eventDropped = !_addEventToProperQueue(event, append);\r\n                }\r\n                else {\r\n                    var dropLatency = 1 /* EventLatencyValue.Normal */;\r\n                    var dropNumber = EventsDroppedAtOneTime;\r\n                    if (evtLatency === 4 /* EventLatencyValue.Immediate */) {\r\n                        // Only drop other immediate events as they are not technically sharing the general queue\r\n                        dropLatency = 4 /* EventLatencyValue.Immediate */;\r\n                        dropNumber = 1;\r\n                    }\r\n                    // Drop old event from lower or equal latency\r\n                    eventDropped = true;\r\n                    if (_dropEventWithLatencyOrLess(event[_DYN_I_KEY /* @min:%2eiKey */], event[_DYN_LATENCY /* @min:%2elatency */], dropLatency, dropNumber)) {\r\n                        eventDropped = !_addEventToProperQueue(event, append);\r\n                    }\r\n                }\r\n                if (eventDropped) {\r\n                    // Can't drop events from current queues because the all the slots are taken by queues that are being flushed.\r\n                    _notifyEvents(strEventsDiscarded, [event], EventsDiscardedReason.QueueFull);\r\n                }\r\n            }\r\n            _self.setEventQueueLimits = function (eventLimit, autoFlushLimit) {\r\n                _postConfig[_DYN_EVENTS_LIMIT_IN_MEM /* @min:%2eeventsLimitInMem */] = _queueSizeLimit = isGreaterThanZero(eventLimit) ? eventLimit : MaxEventsLimitInMem;\r\n                _postConfig[_DYN_AUTO_FLUSH_EVENTS_LI14 /* @min:%2eautoFlushEventsLimit */] = _autoFlushEventsLimit = isGreaterThanZero(autoFlushLimit) ? autoFlushLimit : 0;\r\n                _setAutoLimits();\r\n                // We only do this check here as during normal event addition if the queue is > then events start getting dropped\r\n                var doFlush = _queueSize > eventLimit;\r\n                if (!doFlush && _autoFlushBatchLimit > 0) {\r\n                    // Check the auto flush max batch size\r\n                    for (var latency = 1 /* EventLatencyValue.Normal */; !doFlush && latency <= 3 /* EventLatencyValue.RealTime */; latency++) {\r\n                        var batchQueue = _batchQueues[latency];\r\n                        if (batchQueue && batchQueue[_DYN_BATCHES /* @min:%2ebatches */]) {\r\n                            arrForEach(batchQueue[_DYN_BATCHES /* @min:%2ebatches */], function (theBatch) {\r\n                                if (theBatch && theBatch[_DYN_COUNT /* @min:%2ecount */]() >= _autoFlushBatchLimit) {\r\n                                    // If any 1 batch is > than the limit then trigger an auto flush\r\n                                    doFlush = true;\r\n                                }\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n                _performAutoFlush(true, doFlush);\r\n            };\r\n            _self.pause = function () {\r\n                _clearScheduledTimer();\r\n                _paused = true;\r\n                _httpManager && _httpManager.pause();\r\n            };\r\n            _self[_DYN_RESUME /* @min:%2eresume */] = function () {\r\n                _paused = false;\r\n                _httpManager && _httpManager[_DYN_RESUME /* @min:%2eresume */]();\r\n                _scheduleTimer();\r\n            };\r\n            _self._loadTransmitProfiles = function (profiles) {\r\n                _resetTransmitProfiles();\r\n                objForEachKey(profiles, function (profileName, profileValue) {\r\n                    var profLen = profileValue[_DYN_LENGTH /* @min:%2elength */];\r\n                    if (profLen >= 2) {\r\n                        var directValue = (profLen > 2 ? profileValue[2] : 0);\r\n                        profileValue[_DYN_SPLICE /* @min:%2esplice */](0, profLen - 2);\r\n                        // Make sure if a higher latency is set to not send then don't send lower latency\r\n                        if (profileValue[1] < 0) {\r\n                            profileValue[0] = -1;\r\n                        }\r\n                        // Make sure each latency is multiple of the latency higher then it. If not a multiple\r\n                        // we round up so that it becomes a multiple.\r\n                        if (profileValue[1] > 0 && profileValue[0] > 0) {\r\n                            var timerMultiplier = profileValue[0] / profileValue[1];\r\n                            profileValue[0] = Math.ceil(timerMultiplier) * profileValue[1];\r\n                        }\r\n                        // Add back the direct profile timeout\r\n                        if (directValue >= 0 && profileValue[1] >= 0 && directValue > profileValue[1]) {\r\n                            // Make sure if it's not disabled (< 0) then make sure it's not larger than RealTime\r\n                            directValue = profileValue[1];\r\n                        }\r\n                        profileValue[_DYN_PUSH /* @min:%2epush */](directValue);\r\n                        _profiles[profileName] = profileValue;\r\n                    }\r\n                });\r\n            };\r\n            _self.flush = function (async, callback, sendReason) {\r\n                if (async === void 0) { async = true; }\r\n                var result;\r\n                if (!_paused) {\r\n                    sendReason = sendReason || 1 /* SendRequestReason.ManualFlush */;\r\n                    if (async) {\r\n                        if (!callback) {\r\n                            result = createPromise(function (resolve) {\r\n                                // Set the callback to the promise resolve callback\r\n                                callback = resolve;\r\n                            });\r\n                        }\r\n                        if (_flushCallbackTimer == null) {\r\n                            // Clear the normal schedule timer as we are going to try and flush ASAP\r\n                            _clearScheduledTimer();\r\n                            // Move all queued events to the HttpManager so that we don't discard new events (Auto flush scenario)\r\n                            _queueBatches(1 /* EventLatencyValue.Normal */, 0 /* EventSendType.Batched */, sendReason);\r\n                            _flushCallbackTimer = _createTimer(function () {\r\n                                _flushCallbackTimer = null;\r\n                                _flushImpl(callback, sendReason);\r\n                            }, 0);\r\n                        }\r\n                        else {\r\n                            // Even if null (no callback) this will ensure after the flushImpl finishes waiting\r\n                            // for a completely idle connection it will attempt to re-flush any queued events on the next cycle\r\n                            _flushCallbackQueue[_DYN_PUSH /* @min:%2epush */](callback);\r\n                        }\r\n                    }\r\n                    else {\r\n                        // Clear the normal schedule timer as we are going to try and flush ASAP\r\n                        var cleared = _clearScheduledTimer();\r\n                        // Now cause all queued events to be sent synchronously\r\n                        _sendEventsForLatencyAndAbove(1 /* EventLatencyValue.Normal */, 1 /* EventSendType.Synchronous */, sendReason);\r\n                        callback && callback();\r\n                        if (cleared) {\r\n                            // restart the normal event timer if it was cleared\r\n                            _scheduleTimer();\r\n                        }\r\n                    }\r\n                }\r\n                return result;\r\n            };\r\n            _self.setMsaAuthTicket = function (ticket) {\r\n                _httpManager[_DYN_ADD_HEADER /* @min:%2eaddHeader */](STR_MSA_DEVICE_TICKET, ticket);\r\n            };\r\n            _self.setAuthPluginHeader = function (token) {\r\n                _httpManager[_DYN_ADD_HEADER /* @min:%2eaddHeader */](STR_AUTH_WEB_TOKEN, token);\r\n            };\r\n            _self.removeAuthPluginHeader = function () {\r\n                _httpManager.removeHeader(STR_AUTH_WEB_TOKEN);\r\n            };\r\n            _self.hasEvents = _hasEvents;\r\n            _self._setTransmitProfile = function (profileName) {\r\n                if (_currentProfile !== profileName && _profiles[profileName] !== undefined) {\r\n                    _clearScheduledTimer();\r\n                    _currentProfile = profileName;\r\n                    _scheduleTimer();\r\n                }\r\n            };\r\n            proxyFunctions(_self, function () { return _httpManager; }, [\"addResponseHandler\"]);\r\n            /**\r\n             * Batch and send events currently in the queue for the given latency.\r\n             * @param latency - Latency for which to send events.\r\n             */\r\n            function _sendEventsForLatencyAndAbove(latency, sendType, sendReason) {\r\n                var queued = _queueBatches(latency, sendType, sendReason);\r\n                // Always trigger the request as while the post channel may not have queued additional events, the httpManager may already have waiting events\r\n                _httpManager[_DYN_SEND_QUEUED_REQUESTS /* @min:%2esendQueuedRequests */](sendType, sendReason);\r\n                return queued;\r\n            }\r\n            function _hasEvents() {\r\n                return _queueSize > 0;\r\n            }\r\n            /**\r\n             * Try to schedule the timer after which events will be sent. If there are\r\n             * no events to be sent, or there is already a timer scheduled, or the\r\n             * http manager doesn't have any idle connections this method is no-op.\r\n             */\r\n            function _scheduleTimer() {\r\n                // If we had previously attempted to send requests, but the http manager didn't have any idle connections then the requests where delayed\r\n                // so try and requeue then again now\r\n                if (_delayedBatchSendLatency >= 0 && _queueBatches(_delayedBatchSendLatency, 0 /* EventSendType.Batched */, _delayedBatchReason)) {\r\n                    _httpManager[_DYN_SEND_QUEUED_REQUESTS /* @min:%2esendQueuedRequests */](0 /* EventSendType.Batched */, _delayedBatchReason);\r\n                }\r\n                if (_immediateQueueSize > 0 && !_immediateTimer && !_paused) {\r\n                    // During initialization _profiles enforce that the direct [2] is less than real time [1] timer value\r\n                    // If the immediateTimeout is disabled the immediate events will be sent with Real Time events\r\n                    var immediateTimeOut = _profiles[_currentProfile][2];\r\n                    if (immediateTimeOut >= 0) {\r\n                        _immediateTimer = _createTimer(function () {\r\n                            _immediateTimer = null;\r\n                            // Only try to send direct events\r\n                            _sendEventsForLatencyAndAbove(4 /* EventLatencyValue.Immediate */, 0 /* EventSendType.Batched */, 1 /* SendRequestReason.NormalSchedule */);\r\n                            _scheduleTimer();\r\n                        }, immediateTimeOut);\r\n                    }\r\n                }\r\n                // During initialization the _profiles enforce that the normal [0] is a multiple of the real time [1] timer value\r\n                var timeOut = _profiles[_currentProfile][1];\r\n                if (!_scheduledTimer && !_flushCallbackTimer && timeOut >= 0 && !_paused) {\r\n                    if (_hasEvents()) {\r\n                        _scheduledTimer = _createTimer(function () {\r\n                            _scheduledTimer = null;\r\n                            _sendEventsForLatencyAndAbove(_timerCount === 0 ? 3 /* EventLatencyValue.RealTime */ : 1 /* EventLatencyValue.Normal */, 0 /* EventSendType.Batched */, 1 /* SendRequestReason.NormalSchedule */);\r\n                            // Increment the count for next cycle\r\n                            _timerCount++;\r\n                            _timerCount %= 2;\r\n                            _scheduleTimer();\r\n                        }, timeOut);\r\n                    }\r\n                    else {\r\n                        _timerCount = 0;\r\n                    }\r\n                }\r\n            }\r\n            _self[_DYN__BACK_OFF_TRANSMISSI12 /* @min:%2e_backOffTransmission */] = function () {\r\n                if (_currentBackoffCount < MaxBackoffCount) {\r\n                    _currentBackoffCount++;\r\n                    _clearScheduledTimer();\r\n                    _scheduleTimer();\r\n                }\r\n            };\r\n            _self._clearBackOff = function () {\r\n                if (_currentBackoffCount) {\r\n                    _currentBackoffCount = 0;\r\n                    _clearScheduledTimer();\r\n                    _scheduleTimer();\r\n                }\r\n            };\r\n            function _initDefaults() {\r\n                _postConfig = null;\r\n                _isTeardownCalled = false;\r\n                _flushCallbackQueue = [];\r\n                _flushCallbackTimer = null;\r\n                _paused = false;\r\n                _immediateQueueSize = 0;\r\n                _immediateQueueSizeLimit = 500;\r\n                _queueSize = 0;\r\n                _queueSizeLimit = MaxEventsLimitInMem;\r\n                _profiles = {};\r\n                _currentProfile = RT_PROFILE;\r\n                _scheduledTimer = null;\r\n                _immediateTimer = null;\r\n                _currentBackoffCount = 0;\r\n                _timerCount = 0;\r\n                _batchQueues = {};\r\n                _autoFlushEventsLimit = 0;\r\n                _unloadHandlersAdded = false;\r\n                // either MaxBatchSize * (1+ Max Connections) or _queueLimit / 6 (where 3 latency Queues [normal, realtime, cost deferred] * 2 [allow half full -- allow for retry])\r\n                _autoFlushBatchLimit = 0;\r\n                _delayedBatchSendLatency = -1;\r\n                _delayedBatchReason = null;\r\n                _optimizeObject = true;\r\n                _isPageUnloadTriggered = false;\r\n                _maxEventSendAttempts = MaxSendAttempts;\r\n                _maxUnloadEventSendAttempts = MaxSyncUnloadSendAttempts;\r\n                _evtNamespace = null;\r\n                _overrideInstrumentationKey = null;\r\n                _disableTelemetry = false;\r\n                _timeoutWrapper = createTimeoutWrapper();\r\n                _httpManager = new HttpManager(MaxNumberEventPerBatch, MaxConnections, MaxRequestRetriesBeforeBackoff, {\r\n                    requeue: _requeueEvents,\r\n                    send: _sendingEvent,\r\n                    sent: _eventsSentEvent,\r\n                    drop: _eventsDropped,\r\n                    rspFail: _eventsResponseFail,\r\n                    oth: _otherEvent\r\n                });\r\n                _initializeProfiles();\r\n                _clearQueues();\r\n                _setAutoLimits();\r\n            }\r\n            function _createTimer(theTimerFunc, timeOut) {\r\n                // If the transmission is backed off make the timer at least 1 sec to allow for back off.\r\n                if (timeOut === 0 && _currentBackoffCount) {\r\n                    timeOut = 1;\r\n                }\r\n                var timerMultiplier = 1000;\r\n                if (_currentBackoffCount) {\r\n                    timerMultiplier = retryPolicyGetMillisToBackoffForRetry(_currentBackoffCount - 1);\r\n                }\r\n                return _timeoutWrapper.set(theTimerFunc, timeOut * timerMultiplier);\r\n            }\r\n            function _clearScheduledTimer() {\r\n                if (_scheduledTimer !== null) {\r\n                    _scheduledTimer.cancel();\r\n                    _scheduledTimer = null;\r\n                    _timerCount = 0;\r\n                    return true;\r\n                }\r\n                return false;\r\n            }\r\n            // Try to send all queued events using beacons if available\r\n            function _releaseAllQueues(sendType, sendReason) {\r\n                _clearScheduledTimer();\r\n                // Cancel all flush callbacks\r\n                if (_flushCallbackTimer) {\r\n                    _flushCallbackTimer.cancel();\r\n                    _flushCallbackTimer = null;\r\n                }\r\n                if (!_paused) {\r\n                    // Queue all the remaining requests to be sent. The requests will be sent using HTML5 Beacons if they are available.\r\n                    _sendEventsForLatencyAndAbove(1 /* EventLatencyValue.Normal */, sendType, sendReason);\r\n                }\r\n            }\r\n            /**\r\n             * Add empty queues for all latencies in the inbound queues map. This is called\r\n             * when Transmission Manager is being flushed. This ensures that new events added\r\n             * after flush are stored separately till we flush the current events.\r\n             */\r\n            function _clearQueues() {\r\n                _batchQueues[4 /* EventLatencyValue.Immediate */] = {\r\n                    batches: [],\r\n                    iKeyMap: {}\r\n                };\r\n                _batchQueues[3 /* EventLatencyValue.RealTime */] = {\r\n                    batches: [],\r\n                    iKeyMap: {}\r\n                };\r\n                _batchQueues[2 /* EventLatencyValue.CostDeferred */] = {\r\n                    batches: [],\r\n                    iKeyMap: {}\r\n                };\r\n                _batchQueues[1 /* EventLatencyValue.Normal */] = {\r\n                    batches: [],\r\n                    iKeyMap: {}\r\n                };\r\n            }\r\n            function _getEventBatch(iKey, latency, create) {\r\n                var batchQueue = _batchQueues[latency];\r\n                if (!batchQueue) {\r\n                    latency = 1 /* EventLatencyValue.Normal */;\r\n                    batchQueue = _batchQueues[latency];\r\n                }\r\n                var eventBatch = batchQueue.iKeyMap[iKey];\r\n                if (!eventBatch && create) {\r\n                    eventBatch = EventBatch.create(iKey);\r\n                    batchQueue.batches[_DYN_PUSH /* @min:%2epush */](eventBatch);\r\n                    batchQueue.iKeyMap[iKey] = eventBatch;\r\n                }\r\n                return eventBatch;\r\n            }\r\n            function _performAutoFlush(isAsync, doFlush) {\r\n                // Only perform the auto flush check if the httpManager has an idle connection and we are not in a backoff situation\r\n                if (_httpManager[_DYN_CAN_SEND_REQUEST /* @min:%2ecanSendRequest */]() && !_currentBackoffCount) {\r\n                    if (_autoFlushEventsLimit > 0 && _queueSize > _autoFlushEventsLimit) {\r\n                        // Force flushing\r\n                        doFlush = true;\r\n                    }\r\n                    if (doFlush && _flushCallbackTimer == null) {\r\n                        // Auto flush the queue, adding a callback to avoid the creation of a promise\r\n                        _self.flush(isAsync, function () { }, 20 /* SendRequestReason.MaxQueuedEvents */);\r\n                    }\r\n                }\r\n            }\r\n            function _addEventToProperQueue(event, append) {\r\n                // v8 performance optimization for iterating over the keys\r\n                if (_optimizeObject) {\r\n                    event = optimizeObject(event);\r\n                }\r\n                var latency = event[_DYN_LATENCY /* @min:%2elatency */];\r\n                var eventBatch = _getEventBatch(event[_DYN_I_KEY /* @min:%2eiKey */], latency, true);\r\n                if (eventBatch.addEvent(event)) {\r\n                    if (latency !== 4 /* EventLatencyValue.Immediate */) {\r\n                        _queueSize++;\r\n                        // Check for auto flushing based on total events in the queue, but not for requeued or retry events\r\n                        if (append && event[_DYN_SEND_ATTEMPT /* @min:%2esendAttempt */] === 0) {\r\n                            // Force the flushing of the batch if the batch (specific iKey / latency combination) reaches it's auto flush limit\r\n                            _performAutoFlush(!event.sync, _autoFlushBatchLimit > 0 && eventBatch[_DYN_COUNT /* @min:%2ecount */]() >= _autoFlushBatchLimit);\r\n                        }\r\n                    }\r\n                    else {\r\n                        // Direct events don't need auto flushing as they are scheduled (by default) for immediate delivery\r\n                        _immediateQueueSize++;\r\n                    }\r\n                    return true;\r\n                }\r\n                return false;\r\n            }\r\n            function _dropEventWithLatencyOrLess(iKey, latency, currentLatency, dropNumber) {\r\n                while (currentLatency <= latency) {\r\n                    var eventBatch = _getEventBatch(iKey, latency, true);\r\n                    if (eventBatch && eventBatch[_DYN_COUNT /* @min:%2ecount */]() > 0) {\r\n                        // Dropped oldest events from lowest possible latency\r\n                        var droppedEvents = eventBatch[_DYN_SPLIT /* @min:%2esplit */](0, dropNumber);\r\n                        var droppedCount = droppedEvents[_DYN_COUNT /* @min:%2ecount */]();\r\n                        if (droppedCount > 0) {\r\n                            if (currentLatency === 4 /* EventLatencyValue.Immediate */) {\r\n                                _immediateQueueSize -= droppedCount;\r\n                            }\r\n                            else {\r\n                                _queueSize -= droppedCount;\r\n                            }\r\n                            _notifyBatchEvents(strEventsDiscarded, [droppedEvents], EventsDiscardedReason.QueueFull);\r\n                            return true;\r\n                        }\r\n                    }\r\n                    currentLatency++;\r\n                }\r\n                // Unable to drop any events -- lets just make sure the queue counts are correct to avoid exhaustion\r\n                _resetQueueCounts();\r\n                return false;\r\n            }\r\n            /**\r\n             * Internal helper to reset the queue counts, used as a backstop to avoid future queue exhaustion errors\r\n             * that might occur because of counting issues.\r\n             */\r\n            function _resetQueueCounts() {\r\n                var immediateQueue = 0;\r\n                var normalQueue = 0;\r\n                var _loop_1 = function (latency) {\r\n                    var batchQueue = _batchQueues[latency];\r\n                    if (batchQueue && batchQueue[_DYN_BATCHES /* @min:%2ebatches */]) {\r\n                        arrForEach(batchQueue[_DYN_BATCHES /* @min:%2ebatches */], function (theBatch) {\r\n                            if (latency === 4 /* EventLatencyValue.Immediate */) {\r\n                                immediateQueue += theBatch[_DYN_COUNT /* @min:%2ecount */]();\r\n                            }\r\n                            else {\r\n                                normalQueue += theBatch[_DYN_COUNT /* @min:%2ecount */]();\r\n                            }\r\n                        });\r\n                    }\r\n                };\r\n                for (var latency = 1 /* EventLatencyValue.Normal */; latency <= 4 /* EventLatencyValue.Immediate */; latency++) {\r\n                    _loop_1(latency);\r\n                }\r\n                _queueSize = normalQueue;\r\n                _immediateQueueSize = immediateQueue;\r\n            }\r\n            function _queueBatches(latency, sendType, sendReason) {\r\n                var eventsQueued = false;\r\n                var isAsync = sendType === 0 /* EventSendType.Batched */;\r\n                // Only queue batches (to the HttpManager) if this is a sync request or the httpManager has an idle connection\r\n                // Thus keeping the events within the PostChannel until the HttpManager has a connection available\r\n                // This is so we can drop \"old\" events if the queue is getting full because we can't successfully send events\r\n                if (!isAsync || _httpManager[_DYN_CAN_SEND_REQUEST /* @min:%2ecanSendRequest */]()) {\r\n                    doPerf(_self.core, function () { return \"PostChannel._queueBatches\"; }, function () {\r\n                        var droppedEvents = [];\r\n                        var latencyToProcess = 4 /* EventLatencyValue.Immediate */;\r\n                        while (latencyToProcess >= latency) {\r\n                            var batchQueue = _batchQueues[latencyToProcess];\r\n                            if (batchQueue && batchQueue.batches && batchQueue.batches[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                                arrForEach(batchQueue[_DYN_BATCHES /* @min:%2ebatches */], function (theBatch) {\r\n                                    // Add the batch to the http manager to send the requests\r\n                                    if (!_httpManager.addBatch(theBatch)) {\r\n                                        // The events from this iKey are being dropped (killed)\r\n                                        droppedEvents = droppedEvents[_DYN_CONCAT /* @min:%2econcat */](theBatch[_DYN_EVENTS /* @min:%2eevents */]());\r\n                                    }\r\n                                    else {\r\n                                        eventsQueued = eventsQueued || (theBatch && theBatch[_DYN_COUNT /* @min:%2ecount */]() > 0);\r\n                                    }\r\n                                    if (latencyToProcess === 4 /* EventLatencyValue.Immediate */) {\r\n                                        _immediateQueueSize -= theBatch[_DYN_COUNT /* @min:%2ecount */]();\r\n                                    }\r\n                                    else {\r\n                                        _queueSize -= theBatch[_DYN_COUNT /* @min:%2ecount */]();\r\n                                    }\r\n                                });\r\n                                // Remove all batches from this Queue\r\n                                batchQueue[_DYN_BATCHES /* @min:%2ebatches */] = [];\r\n                                batchQueue.iKeyMap = {};\r\n                            }\r\n                            latencyToProcess--;\r\n                        }\r\n                        if (droppedEvents[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                            _notifyEvents(strEventsDiscarded, droppedEvents, EventsDiscardedReason.KillSwitch);\r\n                        }\r\n                        if (eventsQueued && _delayedBatchSendLatency >= latency) {\r\n                            // We have queued events at the same level as the delayed values so clear the setting\r\n                            _delayedBatchSendLatency = -1;\r\n                            _delayedBatchReason = 0 /* SendRequestReason.Undefined */;\r\n                        }\r\n                    }, function () { return ({ latency: latency, sendType: sendType, sendReason: sendReason }); }, !isAsync);\r\n                }\r\n                else {\r\n                    // remember the min latency so that we can re-trigger later\r\n                    _delayedBatchSendLatency = _delayedBatchSendLatency >= 0 ? Math.min(_delayedBatchSendLatency, latency) : latency;\r\n                    _delayedBatchReason = Math.max(_delayedBatchReason, sendReason);\r\n                }\r\n                return eventsQueued;\r\n            }\r\n            /**\r\n             * This is the callback method is called as part of the manual flushing process.\r\n             * @param callback\r\n             * @param sendReason\r\n             */\r\n            function _flushImpl(callback, sendReason) {\r\n                // Add any additional queued events and cause all queued events to be sent asynchronously\r\n                _sendEventsForLatencyAndAbove(1 /* EventLatencyValue.Normal */, 0 /* EventSendType.Batched */, sendReason);\r\n                // All events (should) have been queue -- lets just make sure the queue counts are correct to avoid queue exhaustion (previous bug #9685112)\r\n                _resetQueueCounts();\r\n                _waitForIdleManager(function () {\r\n                    // Only called AFTER the httpManager does not have any outstanding requests\r\n                    if (callback) {\r\n                        callback();\r\n                    }\r\n                    if (_flushCallbackQueue[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                        _flushCallbackTimer = _createTimer(function () {\r\n                            _flushCallbackTimer = null;\r\n                            _flushImpl(_flushCallbackQueue.shift(), sendReason);\r\n                        }, 0);\r\n                    }\r\n                    else {\r\n                        // No more flush requests\r\n                        _flushCallbackTimer = null;\r\n                        // Restart the normal timer schedule\r\n                        _scheduleTimer();\r\n                    }\r\n                });\r\n            }\r\n            function _waitForIdleManager(callback) {\r\n                if (_httpManager[_DYN_IS_COMPLETELY_IDLE /* @min:%2eisCompletelyIdle */]()) {\r\n                    callback();\r\n                }\r\n                else {\r\n                    _flushCallbackTimer = _createTimer(function () {\r\n                        _flushCallbackTimer = null;\r\n                        _waitForIdleManager(callback);\r\n                    }, FlushCheckTimer);\r\n                }\r\n            }\r\n            /**\r\n             * Resets the transmit profiles to the default profiles of Real Time, Near Real Time\r\n             * and Best Effort. This removes all the custom profiles that were loaded.\r\n             */\r\n            function _resetTransmitProfiles() {\r\n                _clearScheduledTimer();\r\n                _initializeProfiles();\r\n                _currentProfile = RT_PROFILE;\r\n                _scheduleTimer();\r\n            }\r\n            function _initializeProfiles() {\r\n                _profiles = {};\r\n                _profiles[RT_PROFILE] = [2, 1, 0];\r\n                _profiles[NRT_PROFILE] = [6, 3, 0];\r\n                _profiles[BE_PROFILE] = [18, 9, 0];\r\n            }\r\n            /**\r\n             * The notification handler for requeue events\r\n             * @ignore\r\n             */\r\n            function _requeueEvents(batches, reason) {\r\n                var droppedEvents = [];\r\n                var maxSendAttempts = _maxEventSendAttempts;\r\n                if (_isPageUnloadTriggered) {\r\n                    // If a page unlaod has been triggered reduce the number of times we try to \"retry\"\r\n                    maxSendAttempts = _maxUnloadEventSendAttempts;\r\n                }\r\n                arrForEach(batches, function (theBatch) {\r\n                    if (theBatch && theBatch[_DYN_COUNT /* @min:%2ecount */]() > 0) {\r\n                        arrForEach(theBatch[_DYN_EVENTS /* @min:%2eevents */](), function (theEvent) {\r\n                            if (theEvent) {\r\n                                // Check if the request being added back is for a sync event in which case mark it no longer a sync event\r\n                                if (theEvent[_DYN_SYNC /* @min:%2esync */]) {\r\n                                    theEvent[_DYN_LATENCY /* @min:%2elatency */] = 4 /* EventLatencyValue.Immediate */;\r\n                                    theEvent[_DYN_SYNC /* @min:%2esync */] = false;\r\n                                }\r\n                                if (theEvent[_DYN_SEND_ATTEMPT /* @min:%2esendAttempt */] < maxSendAttempts) {\r\n                                    // Reset the event timings\r\n                                    setProcessTelemetryTimings(theEvent, _self[_DYN_IDENTIFIER /* @min:%2eidentifier */]);\r\n                                    _addEventToQueues(theEvent, false);\r\n                                }\r\n                                else {\r\n                                    droppedEvents[_DYN_PUSH /* @min:%2epush */](theEvent);\r\n                                }\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n                if (droppedEvents[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                    _notifyEvents(strEventsDiscarded, droppedEvents, EventsDiscardedReason.NonRetryableStatus);\r\n                }\r\n                if (_isPageUnloadTriggered) {\r\n                    // Unload event has been received so we need to try and flush new events\r\n                    _releaseAllQueues(2 /* EventSendType.SendBeacon */, 2 /* SendRequestReason.Unload */);\r\n                }\r\n            }\r\n            function _callNotification(evtName, theArgs) {\r\n                var manager = (_notificationManager || {});\r\n                var notifyFunc = manager[evtName];\r\n                if (notifyFunc) {\r\n                    try {\r\n                        notifyFunc.apply(manager, theArgs);\r\n                    }\r\n                    catch (e) {\r\n                        _throwInternal(_self.diagLog(), 1 /* eLoggingSeverity.CRITICAL */, 74 /* _eInternalMessageId.NotificationException */, evtName + \" notification failed: \" + e);\r\n                    }\r\n                }\r\n            }\r\n            function _notifyEvents(evtName, theEvents) {\r\n                var extraArgs = [];\r\n                for (var _i = 2; _i < arguments.length; _i++) {\r\n                    extraArgs[_i - 2] = arguments[_i];\r\n                }\r\n                if (theEvents && theEvents[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                    _callNotification(evtName, [theEvents][_DYN_CONCAT /* @min:%2econcat */](extraArgs));\r\n                }\r\n            }\r\n            function _notifyBatchEvents(evtName, batches) {\r\n                var extraArgs = [];\r\n                for (var _i = 2; _i < arguments.length; _i++) {\r\n                    extraArgs[_i - 2] = arguments[_i];\r\n                }\r\n                if (batches && batches[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                    arrForEach(batches, function (theBatch) {\r\n                        if (theBatch && theBatch[_DYN_COUNT /* @min:%2ecount */]() > 0) {\r\n                            _callNotification(evtName, [theBatch.events()][_DYN_CONCAT /* @min:%2econcat */](extraArgs));\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n            /**\r\n             * The notification handler for when batches are about to be sent\r\n             * @ignore\r\n             */\r\n            function _sendingEvent(batches, reason, isSyncRequest) {\r\n                if (batches && batches[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                    _callNotification(\"eventsSendRequest\", [(reason >= 1000 /* EventBatchNotificationReason.SendingUndefined */ && reason <= 1999 /* EventBatchNotificationReason.SendingEventMax */ ?\r\n                            reason - 1000 /* EventBatchNotificationReason.SendingUndefined */ :\r\n                            0 /* SendRequestReason.Undefined */), isSyncRequest !== true]);\r\n                }\r\n            }\r\n            /**\r\n             * This event represents that a batch of events have been successfully sent and a response received\r\n             * @param batches The notification handler for when the batches have been successfully sent\r\n             * @param reason For this event the reason will always be EventBatchNotificationReason.Complete\r\n             */\r\n            function _eventsSentEvent(batches, reason) {\r\n                _notifyBatchEvents(\"eventsSent\", batches, reason);\r\n                // Try and schedule the processing timer if we have events\r\n                _scheduleTimer();\r\n            }\r\n            function _eventsDropped(batches, reason) {\r\n                _notifyBatchEvents(strEventsDiscarded, batches, (reason >= 8000 /* EventBatchNotificationReason.EventsDropped */ && reason <= 8999 /* EventBatchNotificationReason.EventsDroppedMax */ ?\r\n                    reason - 8000 /* EventBatchNotificationReason.EventsDropped */ :\r\n                    EventsDiscardedReason.Unknown));\r\n            }\r\n            function _eventsResponseFail(batches) {\r\n                _notifyBatchEvents(strEventsDiscarded, batches, EventsDiscardedReason.NonRetryableStatus);\r\n                // Try and schedule the processing timer if we have events\r\n                _scheduleTimer();\r\n            }\r\n            function _otherEvent(batches, reason) {\r\n                _notifyBatchEvents(strEventsDiscarded, batches, EventsDiscardedReason.Unknown);\r\n                // Try and schedule the processing timer if we have events\r\n                _scheduleTimer();\r\n            }\r\n            function _setAutoLimits() {\r\n                if (!_disableAutoBatchFlushLimit) {\r\n                    _autoFlushBatchLimit = Math.max(MaxNumberEventPerBatch * (MaxConnections + 1), _queueSizeLimit / 6);\r\n                }\r\n                else {\r\n                    _autoFlushBatchLimit = 0;\r\n                }\r\n            }\r\n        });\r\n        return _this;\r\n    }\r\n// Removed Stub for PostChannel.prototype.initialize.\r\n// Removed Stub for PostChannel.prototype.processTelemetry.\r\n// Removed Stub for PostChannel.prototype.setEventQueueLimits.\r\n// Removed Stub for PostChannel.prototype.pause.\r\n// Removed Stub for PostChannel.prototype.resume.\r\n// Removed Stub for PostChannel.prototype.addResponseHandler.\r\n// Removed Stub for PostChannel.prototype.flush.\r\n// Removed Stub for PostChannel.prototype.setMsaAuthTicket.\r\n// Removed Stub for PostChannel.prototype.setAuthPluginHeader.\r\n// Removed Stub for PostChannel.prototype.removeAuthPluginHeader.\r\n// Removed Stub for PostChannel.prototype.hasEvents.\r\n// Removed Stub for PostChannel.prototype._loadTransmitProfiles.\r\n// Removed Stub for PostChannel.prototype._setTransmitProfile.\r\n// Removed Stub for PostChannel.prototype._backOffTransmission.\r\n// Removed Stub for PostChannel.prototype._clearBackOff.\r\n// Removed Stub for PostChannel.prototype.getOfflineSupport.\r\n    // This is a workaround for an IE bug when using dynamicProto() with classes that don't have any\n    // non-dynamic functions or static properties/functions when using uglify-js to minify the resulting code.\n    PostChannel.__ieDyn=1;\n\n    return PostChannel;\r\n}(BaseTelemetryPlugin));\r\nexport { PostChannel };\r\n//# sourceMappingURL=PostChannel.js.map","/*\n * Application Insights JavaScript SDK - Common, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n// Licensed under the\r\nexport { correlationIdSetPrefix, correlationIdGetPrefix, correlationIdCanIncludeCorrelationHeader, correlationIdGetCorrelationContext, correlationIdGetCorrelationContextValue, dateTimeUtilsNow, dateTimeUtilsDuration, isInternalApplicationInsightsEndpoint, createDistributedTraceContextFromTrace } from \"./Util\";\r\nexport { ThrottleMgr } from \"./ThrottleMgr\";\r\nexport { parseConnectionString, ConnectionStringParser } from \"./ConnectionStringParser\";\r\nexport { RequestHeaders } from \"./RequestResponseHeaders\";\r\nexport { DisabledPropertyName, ProcessLegacy, SampleRate, HttpMethod, DEFAULT_BREEZE_ENDPOINT, DEFAULT_BREEZE_PATH, strNotSpecified } from \"./Constants\";\r\nexport { Envelope } from \"./Telemetry/Common/Envelope\";\r\nexport { Event } from \"./Telemetry/Event\";\r\nexport { Exception } from \"./Telemetry/Exception\";\r\nexport { Metric } from \"./Telemetry/Metric\";\r\nexport { PageView } from \"./Telemetry/PageView\";\r\nexport { RemoteDependencyData } from \"./Telemetry/RemoteDependencyData\";\r\nexport { Trace } from \"./Telemetry/Trace\";\r\nexport { PageViewPerformance } from \"./Telemetry/PageViewPerformance\";\r\nexport { Data } from \"./Telemetry/Common/Data\";\r\nexport { SeverityLevel } from \"./Interfaces/Contracts/SeverityLevel\";\r\nexport { ConfigurationManager } from \"./Interfaces/IConfig\";\r\nexport { ContextTagKeys } from \"./Interfaces/Contracts/ContextTagKeys\";\r\nexport { dataSanitizeKeyAndAddUniqueness, dataSanitizeKey, dataSanitizeString, dataSanitizeUrl, dataSanitizeMessage, dataSanitizeException, dataSanitizeProperties, dataSanitizeMeasurements, dataSanitizeId, dataSanitizeInput, dsPadNumber } from \"./Telemetry/Common/DataSanitizer\";\r\nexport { TelemetryItemCreator, createTelemetryItem } from \"./TelemetryItemCreator\";\r\nexport { CtxTagKeys, Extensions } from \"./Interfaces/PartAExtensions\";\r\nexport { DistributedTracingModes, EventPersistence } from \"./Enums\";\r\nexport { stringToBoolOrDefault, msToTimeSpan, getExtensionByName, isCrossOriginError } from \"./HelperFuncs\";\r\nexport { isBeaconsSupported as isBeaconApiSupported, createTraceParent, parseTraceParent, isValidTraceId, isValidSpanId, isValidTraceParent, isSampledFlag, formatTraceParent, findW3cTraceParent, findAllScripts } from \"@microsoft/applicationinsights-core-js\";\r\nexport { createDomEvent } from \"./DomHelperFuncs\";\r\nexport { utlDisableStorage, utlEnableStorage, utlCanUseLocalStorage, utlGetLocalStorage, utlSetLocalStorage, utlRemoveStorage, utlCanUseSessionStorage, utlGetSessionStorageKeys, utlGetSessionStorage, utlSetSessionStorage, utlRemoveSessionStorage, utlSetStoragePrefix } from \"./StorageHelperFuncs\";\r\nexport { urlParseUrl, urlGetAbsoluteUrl, urlGetPathName, urlGetCompleteUrl, urlParseHost, urlParseFullHost } from \"./UrlHelperFuncs\";\r\nexport { createOfflineListener } from \"./Offline\";\r\nexport var PropertiesPluginIdentifier = \"AppInsightsPropertiesPlugin\";\r\nexport var BreezeChannelIdentifier = \"AppInsightsChannelPlugin\";\r\nexport var AnalyticsPluginIdentifier = \"ApplicationInsightsAnalytics\";\r\n//# sourceMappingURL=applicationinsights-common.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { asString, isBoolean, isFunction, isNullOrUndefined, isString } from \"@nevware21/ts-utils\";\r\nimport { STR_EMPTY } from \"../JavaScriptSDK/InternalConstants\";\r\nimport { _DYN_BLK_VAL, _DYN_TO_LOWER_CASE } from \"../__DynamicConstants\";\r\n/**\r\n * @internal\r\n * @ignore\r\n * @param str\r\n * @param defaultValue\r\n * @returns\r\n */\r\nfunction _stringToBoolOrDefault(theValue, defaultValue, theConfig) {\r\n    if (!theValue && isNullOrUndefined(theValue)) {\r\n        return defaultValue;\r\n    }\r\n    if (isBoolean(theValue)) {\r\n        return theValue;\r\n    }\r\n    return asString(theValue)[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */]() === \"true\";\r\n}\r\n/**\r\n * Helper which returns an IConfigDefaultCheck instance with the field defined as an object\r\n * that should be merged\r\n * @param defaultValue - The default value to apply it not provided or it's not valid\r\n * @returns a new IConfigDefaultCheck structure\r\n */\r\nexport function cfgDfMerge(defaultValue) {\r\n    return {\r\n        mrg: true,\r\n        v: defaultValue\r\n    };\r\n}\r\n/**\r\n * Helper which returns an IConfigDefaultCheck instance with the provided field set function\r\n * @param setter - The IConfigCheckFn function to validate the user provided value\r\n * @param defaultValue - The default value to apply it not provided or it's not valid\r\n * @returns a new IConfigDefaultCheck structure\r\n */\r\nexport function cfgDfSet(setter, defaultValue) {\r\n    return {\r\n        set: setter,\r\n        v: defaultValue\r\n    };\r\n}\r\n/**\r\n * Helper which returns an IConfigDefaultCheck instance with the provided field validator\r\n * @param validator - The IConfigCheckFn function to validate the user provided value\r\n * @param defaultValue - The default value to apply it not provided or it's not valid\r\n * @param fallBackName - The fallback configuration name if the current value is not available\r\n * @returns a new IConfigDefaultCheck structure\r\n */\r\nexport function cfgDfValidate(validator, defaultValue, fallBackName) {\r\n    return {\r\n        fb: fallBackName,\r\n        isVal: validator,\r\n        v: defaultValue\r\n    };\r\n}\r\n/**\r\n * Helper which returns an IConfigDefaultCheck instance that will validate and convert the user\r\n * provided value to a boolean from a string or boolean value\r\n * @param defaultValue - The default value to apply it not provided or it's not valid\r\n * @param fallBackName - The fallback configuration name if the current value is not available\r\n * @returns a new IConfigDefaultCheck structure\r\n */\r\nexport function cfgDfBoolean(defaultValue, fallBackName) {\r\n    return {\r\n        fb: fallBackName,\r\n        set: _stringToBoolOrDefault,\r\n        v: !!defaultValue\r\n    };\r\n}\r\n/**\r\n * Helper which returns an IConfigDefaultCheck instance that will validate that the user\r\n * provided value is a function.\r\n * @param defaultValue - The default value to apply it not provided or it's not valid\r\n * @returns a new IConfigDefaultCheck structure\r\n */\r\nexport function cfgDfFunc(defaultValue) {\r\n    return {\r\n        isVal: isFunction,\r\n        v: defaultValue || null\r\n    };\r\n}\r\n/**\r\n * Helper which returns an IConfigDefaultCheck instance that will validate that the user\r\n * provided value is a function.\r\n * @param defaultValue - The default string value to apply it not provided or it's not valid, defaults to an empty string\r\n * @returns a new IConfigDefaultCheck structure\r\n */\r\nexport function cfgDfString(defaultValue) {\r\n    return {\r\n        isVal: isString,\r\n        v: asString(defaultValue || STR_EMPTY)\r\n    };\r\n}\r\n/**\r\n * Helper which returns an IConfigDefaultCheck instance identifying that value associated with this property\r\n * should not have it's properties converted into a dynamic config properties.\r\n * @param defaultValue - The default value to apply it not provided or it's not valid\r\n * @returns a new IConfigDefaultCheck structure\r\n */\r\nexport function cfgDfBlockPropValue(defaultValue) {\r\n    var _a;\r\n    return _a = {},\r\n        _a[_DYN_BLK_VAL /* @min:blkVal */] = true,\r\n        _a.v = defaultValue,\r\n        _a;\r\n}\r\n//# sourceMappingURL=ConfigDefaultHelpers.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { asString, isArray, isDefined, isNullOrUndefined, isObject, isPlainObject, isUndefined, objForEachKey, objHasOwn } from \"@nevware21/ts-utils\";\r\nimport { _DYN_BLK_VAL, _DYN_LENGTH, _DYN_RD_ONLY } from \"../__DynamicConstants\";\r\nfunction _isConfigDefaults(value) {\r\n    return (value && isObject(value) && (value.isVal || value.fb || objHasOwn(value, \"v\") || objHasOwn(value, \"mrg\") || objHasOwn(value, \"ref\") || value.set));\r\n}\r\nfunction _getDefault(dynamicHandler, theConfig, cfgDefaults) {\r\n    var defValue;\r\n    var isDefaultValid = cfgDefaults.dfVal || isDefined;\r\n    // There is a fallback config key so try and grab that first\r\n    if (theConfig && cfgDefaults.fb) {\r\n        var fallbacks = cfgDefaults.fb;\r\n        if (!isArray(fallbacks)) {\r\n            fallbacks = [fallbacks];\r\n        }\r\n        for (var lp = 0; lp < fallbacks[_DYN_LENGTH /* @min:%2elength */]; lp++) {\r\n            var fallback = fallbacks[lp];\r\n            var fbValue = theConfig[fallback];\r\n            if (isDefaultValid(fbValue)) {\r\n                defValue = fbValue;\r\n            }\r\n            else if (dynamicHandler) {\r\n                // Needed to ensure that the fallback value (and potentially) new field is also dynamic even if null/undefined\r\n                fbValue = dynamicHandler.cfg[fallback];\r\n                if (isDefaultValid(fbValue)) {\r\n                    defValue = fbValue;\r\n                }\r\n                // Needed to ensure that the fallback value (and potentially) new field is also dynamic even if null/undefined\r\n                dynamicHandler.set(dynamicHandler.cfg, asString(fallback), fbValue);\r\n            }\r\n            if (isDefaultValid(defValue)) {\r\n                // We have a valid default so break out of the look\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    // If the value is still not defined and we have a default value then use that\r\n    if (!isDefaultValid(defValue) && isDefaultValid(cfgDefaults.v)) {\r\n        defValue = cfgDefaults.v;\r\n    }\r\n    return defValue;\r\n}\r\n/**\r\n * Recursively resolve the default value\r\n * @param dynamicHandler\r\n * @param theConfig\r\n * @param cfgDefaults\r\n * @returns\r\n */\r\nfunction _resolveDefaultValue(dynamicHandler, theConfig, cfgDefaults) {\r\n    var theValue = cfgDefaults;\r\n    if (cfgDefaults && _isConfigDefaults(cfgDefaults)) {\r\n        theValue = _getDefault(dynamicHandler, theConfig, cfgDefaults);\r\n    }\r\n    if (theValue) {\r\n        if (_isConfigDefaults(theValue)) {\r\n            theValue = _resolveDefaultValue(dynamicHandler, theConfig, theValue);\r\n        }\r\n        var newValue_1;\r\n        if (isArray(theValue)) {\r\n            newValue_1 = [];\r\n            newValue_1[_DYN_LENGTH /* @min:%2elength */] = theValue[_DYN_LENGTH /* @min:%2elength */];\r\n        }\r\n        else if (isPlainObject(theValue)) {\r\n            newValue_1 = {};\r\n        }\r\n        if (newValue_1) {\r\n            objForEachKey(theValue, function (key, value) {\r\n                if (value && _isConfigDefaults(value)) {\r\n                    value = _resolveDefaultValue(dynamicHandler, theConfig, value);\r\n                }\r\n                newValue_1[key] = value;\r\n            });\r\n            theValue = newValue_1;\r\n        }\r\n    }\r\n    return theValue;\r\n}\r\n/**\r\n * Applies the default value on the config property and makes sure that it's dynamic\r\n * @param theConfig\r\n * @param name\r\n * @param defaultValue\r\n */\r\nexport function _applyDefaultValue(dynamicHandler, theConfig, name, defaultValue) {\r\n    // Resolve the initial config value from the provided value or use the defined default\r\n    var isValid;\r\n    var setFn;\r\n    var defValue;\r\n    var cfgDefaults = defaultValue;\r\n    var mergeDf;\r\n    var reference;\r\n    var readOnly;\r\n    var blkDynamicValue;\r\n    if (_isConfigDefaults(cfgDefaults)) {\r\n        // looks like a IConfigDefault\r\n        isValid = cfgDefaults.isVal;\r\n        setFn = cfgDefaults.set;\r\n        readOnly = cfgDefaults[_DYN_RD_ONLY /* @min:%2erdOnly */];\r\n        blkDynamicValue = cfgDefaults[_DYN_BLK_VAL /* @min:%2eblkVal */];\r\n        mergeDf = cfgDefaults.mrg;\r\n        reference = cfgDefaults.ref;\r\n        if (!reference && isUndefined(reference)) {\r\n            reference = !!mergeDf;\r\n        }\r\n        defValue = _getDefault(dynamicHandler, theConfig, cfgDefaults);\r\n    }\r\n    else {\r\n        defValue = defaultValue;\r\n    }\r\n    if (blkDynamicValue) {\r\n        // Mark the property so that any value assigned will be blocked from conversion, we need to do this\r\n        // before assigning or fetching the value to ensure it's not converted\r\n        dynamicHandler[_DYN_BLK_VAL /* @min:%2eblkVal */](theConfig, name);\r\n    }\r\n    // Set the value to the default value;\r\n    var theValue;\r\n    var usingDefault = true;\r\n    var cfgValue = theConfig[name];\r\n    // try and get and user provided values\r\n    if (cfgValue || !isNullOrUndefined(cfgValue)) {\r\n        // Use the defined theConfig[name] value\r\n        theValue = cfgValue;\r\n        usingDefault = false;\r\n        // The values are different and we have a special default value check, which is used to\r\n        // override config values like empty strings to continue using the default\r\n        if (isValid && theValue !== defValue && !isValid(theValue)) {\r\n            theValue = defValue;\r\n            usingDefault = true;\r\n        }\r\n        if (setFn) {\r\n            theValue = setFn(theValue, defValue, theConfig);\r\n            usingDefault = theValue === defValue;\r\n        }\r\n    }\r\n    if (!usingDefault) {\r\n        if (isPlainObject(theValue) || isArray(defValue)) {\r\n            // we are using the user supplied value and it's an object\r\n            if (mergeDf && defValue && (isPlainObject(defValue) || isArray(defValue))) {\r\n                // Resolve/apply the defaults\r\n                objForEachKey(defValue, function (dfName, dfValue) {\r\n                    // Sets the value and makes it dynamic (if it doesn't already exist)\r\n                    _applyDefaultValue(dynamicHandler, theValue, dfName, dfValue);\r\n                });\r\n            }\r\n        }\r\n    }\r\n    else if (defValue) {\r\n        // Just resolve the default\r\n        theValue = _resolveDefaultValue(dynamicHandler, theConfig, defValue);\r\n    }\r\n    else {\r\n        theValue = defValue;\r\n    }\r\n    // if (theValue && usingDefault && (isPlainObject(theValue) || isArray(theValue))) {\r\n    //     theValue = _cfgDeepCopy(theValue);\r\n    // }\r\n    // Needed to ensure that the (potentially) new field is dynamic even if null/undefined\r\n    dynamicHandler.set(theConfig, name, theValue);\r\n    if (reference) {\r\n        dynamicHandler.ref(theConfig, name);\r\n    }\r\n    if (readOnly) {\r\n        dynamicHandler[_DYN_RD_ONLY /* @min:%2erdOnly */](theConfig, name);\r\n    }\r\n}\r\n//# sourceMappingURL=ConfigDefaults.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { arrForEach, createCustomError, dumpObj } from \"@nevware21/ts-utils\";\r\nimport { _DYN_LENGTH } from \"../__DynamicConstants\";\r\nvar aggregationErrorType;\r\n/**\r\n * Throws an Aggregation Error which includes all of the errors that led to this error occurring\r\n * @param message - The message describing the aggregation error (the sourceError details are added to this)\r\n * @param sourceErrors - An array of the errors that caused this situation\r\n */\r\nexport function throwAggregationError(message, sourceErrors) {\r\n    if (!aggregationErrorType) {\r\n        aggregationErrorType = createCustomError(\"AggregationError\", function (self, args) {\r\n            if (args[_DYN_LENGTH /* @min:%2elength */] > 1) {\r\n                // Save the provided errors\r\n                self.errors = args[1];\r\n            }\r\n        });\r\n    }\r\n    var theMessage = message || \"One or more errors occurred.\";\r\n    arrForEach(sourceErrors, function (srcError, idx) {\r\n        theMessage += \"\\n\".concat(idx, \" > \").concat(dumpObj(srcError));\r\n    });\r\n    throw new aggregationErrorType(theMessage, sourceErrors || []);\r\n}\r\n//# sourceMappingURL=AggregationError.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { arrForEach, arrIndexOf, dumpObj, isArray, objDefine, objDefineProp, objForEachKey, objGetOwnPropertyDescriptor } from \"@nevware21/ts-utils\";\r\nimport { UNDEFINED_VALUE } from \"../JavaScriptSDK/InternalConstants\";\r\nimport { _DYN_APPLY, _DYN_HDLR, _DYN_LOGGER, _DYN_PUSH, _DYN_SPLICE, _DYN_THROW_INTERNAL } from \"../__DynamicConstants\";\r\nimport { CFG_HANDLER_LINK, _canMakeDynamic, blockDynamicConversion, throwInvalidAccess } from \"./DynamicSupport\";\r\nvar arrayMethodsToPatch = [\r\n    \"push\",\r\n    \"pop\",\r\n    \"shift\",\r\n    \"unshift\",\r\n    \"splice\"\r\n];\r\nexport var _throwDynamicError = function (logger, name, desc, e) {\r\n    logger && logger[_DYN_THROW_INTERNAL /* @min:%2ethrowInternal */](3 /* eLoggingSeverity.DEBUG */, 108 /* _eInternalMessageId.DynamicConfigException */, \"\".concat(desc, \" [\").concat(name, \"] failed - \") + dumpObj(e));\r\n};\r\nfunction _patchArray(state, target, name) {\r\n    if (isArray(target)) {\r\n        // Monkey Patch the methods that might change the array\r\n        arrForEach(arrayMethodsToPatch, function (method) {\r\n            var orgMethod = target[method];\r\n            target[method] = function () {\r\n                var args = [];\r\n                for (var _i = 0; _i < arguments.length; _i++) {\r\n                    args[_i] = arguments[_i];\r\n                }\r\n                var result = orgMethod[_DYN_APPLY /* @min:%2eapply */](this, args);\r\n                // items may be added, removed or moved so need to make some new dynamic properties\r\n                _makeDynamicObject(state, target, name, \"Patching\");\r\n                return result;\r\n            };\r\n        });\r\n    }\r\n}\r\nfunction _getOwnPropGetter(target, name) {\r\n    var propDesc = objGetOwnPropertyDescriptor(target, name);\r\n    return propDesc && propDesc.get;\r\n}\r\nfunction _createDynamicProperty(state, theConfig, name, value) {\r\n    // Does not appear to be dynamic so lets make it so\r\n    var detail = {\r\n        n: name,\r\n        h: [],\r\n        trk: function (handler) {\r\n            if (handler && handler.fn) {\r\n                if (arrIndexOf(detail.h, handler) === -1) {\r\n                    // Add this handler to the collection that should be notified when the value changes\r\n                    detail.h[_DYN_PUSH /* @min:%2epush */](handler);\r\n                }\r\n                state.trk(handler, detail);\r\n            }\r\n        },\r\n        clr: function (handler) {\r\n            var idx = arrIndexOf(detail.h, handler);\r\n            if (idx !== -1) {\r\n                detail.h[_DYN_SPLICE /* @min:%2esplice */](idx, 1);\r\n            }\r\n        }\r\n    };\r\n    // Flag to optimize lookup response time by avoiding additional function calls\r\n    var checkDynamic = true;\r\n    var isObjectOrArray = false;\r\n    function _getProperty() {\r\n        if (checkDynamic) {\r\n            isObjectOrArray = isObjectOrArray || _canMakeDynamic(_getProperty, state, value);\r\n            // Make sure that if it's an object that we make it dynamic\r\n            if (value && !value[CFG_HANDLER_LINK] && isObjectOrArray) {\r\n                // It doesn't look like it's already dynamic so lets make sure it's converted the object into a dynamic Config as well\r\n                value = _makeDynamicObject(state, value, name, \"Converting\");\r\n            }\r\n            // If it needed to be converted it now has been\r\n            checkDynamic = false;\r\n        }\r\n        // If there is an active handler then add it to the tracking set of handlers\r\n        var activeHandler = state.act;\r\n        if (activeHandler) {\r\n            detail.trk(activeHandler);\r\n        }\r\n        return value;\r\n    }\r\n    // Tag this getter as our dynamic property and provide shortcut for notifying a change\r\n    _getProperty[state.prop] = {\r\n        chng: function () {\r\n            state.add(detail);\r\n        }\r\n    };\r\n    function _setProperty(newValue) {\r\n        if (value !== newValue) {\r\n            if (!!_getProperty[state.ro] && !state.upd) {\r\n                // field is marked as readonly so return false\r\n                throwInvalidAccess(\"[\" + name + \"] is read-only:\" + dumpObj(theConfig));\r\n            }\r\n            if (checkDynamic) {\r\n                isObjectOrArray = isObjectOrArray || _canMakeDynamic(_getProperty, state, value);\r\n                checkDynamic = false;\r\n            }\r\n            // The value must be a plain object or an array to enforce the reference (in-place updates)\r\n            var isReferenced = isObjectOrArray && _getProperty[state.rf];\r\n            if (isObjectOrArray) {\r\n                // We are about to replace a plain object or an array\r\n                if (isReferenced) {\r\n                    // Reassign the properties from the current value to the same properties from the newValue\r\n                    // This will set properties not in the newValue to undefined\r\n                    objForEachKey(value, function (key) {\r\n                        value[key] = newValue ? newValue[key] : UNDEFINED_VALUE;\r\n                    });\r\n                    // Now assign / re-assign value with all of the keys from newValue\r\n                    try {\r\n                        objForEachKey(newValue, function (key, theValue) {\r\n                            _setDynamicProperty(state, value, key, theValue);\r\n                        });\r\n                        // Now drop newValue so when we assign value later it keeps the existing reference\r\n                        newValue = value;\r\n                    }\r\n                    catch (e) {\r\n                        // Unable to convert to dynamic property so just leave as non-dynamic\r\n                        _throwDynamicError((state.hdlr || {})[_DYN_LOGGER /* @min:%2elogger */], name, \"Assigning\", e);\r\n                        // Mark as not an object or array so we don't try and do this again\r\n                        isObjectOrArray = false;\r\n                    }\r\n                }\r\n                else if (value && value[CFG_HANDLER_LINK]) {\r\n                    // As we are replacing the value, if it's already dynamic then we need to notify the listeners\r\n                    // for every property it has already\r\n                    objForEachKey(value, function (key) {\r\n                        // Check if the value is dynamic\r\n                        var getter = _getOwnPropGetter(value, key);\r\n                        if (getter) {\r\n                            // And if it is tell it's listeners that the value has changed\r\n                            var valueState = getter[state.prop];\r\n                            valueState && valueState.chng();\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n            if (newValue !== value) {\r\n                var newIsObjectOrArray = newValue && _canMakeDynamic(_getProperty, state, newValue);\r\n                if (!isReferenced && newIsObjectOrArray) {\r\n                    // As the newValue is an object/array lets preemptively make it dynamic\r\n                    newValue = _makeDynamicObject(state, newValue, name, \"Converting\");\r\n                }\r\n                // Now assign the internal \"value\" to the newValue\r\n                value = newValue;\r\n                isObjectOrArray = newIsObjectOrArray;\r\n            }\r\n            // Cause any listeners to be scheduled for notification\r\n            state.add(detail);\r\n        }\r\n    }\r\n    objDefine(theConfig, detail.n, { g: _getProperty, s: _setProperty });\r\n}\r\nexport function _setDynamicProperty(state, target, name, value) {\r\n    if (target) {\r\n        // To be a dynamic property it needs to have a get function\r\n        var getter = _getOwnPropGetter(target, name);\r\n        var isDynamic = getter && !!getter[state.prop];\r\n        if (!isDynamic) {\r\n            _createDynamicProperty(state, target, name, value);\r\n        }\r\n        else {\r\n            // Looks like it's already dynamic just assign the new value\r\n            target[name] = value;\r\n        }\r\n    }\r\n    return target;\r\n}\r\nexport function _setDynamicPropertyState(state, target, name, flags) {\r\n    if (target) {\r\n        // To be a dynamic property it needs to have a get function\r\n        var getter = _getOwnPropGetter(target, name);\r\n        var isDynamic = getter && !!getter[state.prop];\r\n        var inPlace = flags && flags[0 /* _eSetDynamicPropertyFlags.inPlace */];\r\n        var rdOnly = flags && flags[1 /* _eSetDynamicPropertyFlags.readOnly */];\r\n        var blkProp = flags && flags[2 /* _eSetDynamicPropertyFlags.blockDynamicProperty */];\r\n        if (!isDynamic) {\r\n            if (blkProp) {\r\n                try {\r\n                    // Attempt to mark the target as blocked from conversion\r\n                    blockDynamicConversion(target);\r\n                }\r\n                catch (e) {\r\n                    _throwDynamicError((state.hdlr || {})[_DYN_LOGGER /* @min:%2elogger */], name, \"Blocking\", e);\r\n                }\r\n            }\r\n            try {\r\n                // Make sure it's dynamic so that we can tag the property as per the state\r\n                _setDynamicProperty(state, target, name, target[name]);\r\n                getter = _getOwnPropGetter(target, name);\r\n            }\r\n            catch (e) {\r\n                // Unable to convert to dynamic property so just leave as non-dynamic\r\n                _throwDynamicError((state.hdlr || {})[_DYN_LOGGER /* @min:%2elogger */], name, \"State\", e);\r\n            }\r\n        }\r\n        // Assign the optional flags if true\r\n        if (inPlace) {\r\n            getter[state.rf] = inPlace;\r\n        }\r\n        if (rdOnly) {\r\n            getter[state.ro] = rdOnly;\r\n        }\r\n        if (blkProp) {\r\n            getter[state.blkVal] = true;\r\n        }\r\n    }\r\n    return target;\r\n}\r\nexport function _makeDynamicObject(state, target, name, desc) {\r\n    try {\r\n        // Assign target with new value properties (converting into dynamic properties in the process)\r\n        objForEachKey(target, function (key, value) {\r\n            // Assign and/or make the property dynamic\r\n            _setDynamicProperty(state, target, key, value);\r\n        });\r\n        if (!target[CFG_HANDLER_LINK]) {\r\n            // Link the config back to the dynamic config details\r\n            objDefineProp(target, CFG_HANDLER_LINK, {\r\n                get: function () {\r\n                    return state[_DYN_HDLR /* @min:%2ehdlr */];\r\n                }\r\n            });\r\n            _patchArray(state, target, name);\r\n        }\r\n    }\r\n    catch (e) {\r\n        // Unable to convert to dynamic property so just leave as non-dynamic\r\n        _throwDynamicError((state.hdlr || {})[_DYN_LOGGER /* @min:%2elogger */], name, desc, e);\r\n    }\r\n    return target;\r\n}\r\n//# sourceMappingURL=DynamicProperty.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { arrForEach, arrIndexOf, dumpObj, newSymbol, scheduleTimeout } from \"@nevware21/ts-utils\";\r\nimport { throwAggregationError } from \"../JavaScriptSDK/AggregationError\";\r\nimport { _DYN_BLK_VAL, _DYN_CANCEL, _DYN_HDLR, _DYN_LENGTH, _DYN_LOGGER, _DYN_NOTIFY, _DYN_PUSH, _DYN_RD_ONLY, _DYN_SET_DF, _DYN_THROW_INTERNAL } from \"../__DynamicConstants\";\r\nvar symPrefix = \"[[ai_\";\r\nvar symPostfix = \"]]\";\r\nexport function _createState(cfgHandler) {\r\n    var _a;\r\n    var dynamicPropertySymbol = newSymbol(symPrefix + \"get\" + cfgHandler.uid + symPostfix);\r\n    var dynamicPropertyReadOnly = newSymbol(symPrefix + \"ro\" + cfgHandler.uid + symPostfix);\r\n    var dynamicPropertyReferenced = newSymbol(symPrefix + \"rf\" + cfgHandler.uid + symPostfix);\r\n    var dynamicPropertyBlockValue = newSymbol(symPrefix + \"blkVal\" + cfgHandler.uid + symPostfix);\r\n    var dynamicPropertyDetail = newSymbol(symPrefix + \"dtl\" + cfgHandler.uid + symPostfix);\r\n    var _waitingHandlers = null;\r\n    var _watcherTimer = null;\r\n    var theState;\r\n    function _useHandler(activeHandler, callback) {\r\n        var prevWatcher = theState.act;\r\n        try {\r\n            theState.act = activeHandler;\r\n            if (activeHandler && activeHandler[dynamicPropertyDetail]) {\r\n                // Clear out the previously tracked details for this handler, so that access are re-evaluated\r\n                arrForEach(activeHandler[dynamicPropertyDetail], function (detail) {\r\n                    detail.clr(activeHandler);\r\n                });\r\n                activeHandler[dynamicPropertyDetail] = [];\r\n            }\r\n            callback({\r\n                cfg: cfgHandler.cfg,\r\n                set: cfgHandler.set.bind(cfgHandler),\r\n                setDf: cfgHandler[_DYN_SET_DF /* @min:%2esetDf */].bind(cfgHandler),\r\n                ref: cfgHandler.ref.bind(cfgHandler),\r\n                rdOnly: cfgHandler[_DYN_RD_ONLY /* @min:%2erdOnly */].bind(cfgHandler)\r\n            });\r\n        }\r\n        catch (e) {\r\n            var logger = cfgHandler[_DYN_LOGGER /* @min:%2elogger */];\r\n            if (logger) {\r\n                // Don't let one individual failure break everyone\r\n                logger[_DYN_THROW_INTERNAL /* @min:%2ethrowInternal */](1 /* eLoggingSeverity.CRITICAL */, 107 /* _eInternalMessageId.ConfigWatcherException */, dumpObj(e));\r\n            }\r\n            // Re-throw the exception so that any true \"error\" is reported back to the called\r\n            throw e;\r\n        }\r\n        finally {\r\n            theState.act = prevWatcher || null;\r\n        }\r\n    }\r\n    function _notifyWatchers() {\r\n        if (_waitingHandlers) {\r\n            var notifyHandlers = _waitingHandlers;\r\n            _waitingHandlers = null;\r\n            // Stop any timer as we are running them now anyway\r\n            _watcherTimer && _watcherTimer[_DYN_CANCEL /* @min:%2ecancel */]();\r\n            _watcherTimer = null;\r\n            var watcherFailures_1 = [];\r\n            // Now run the handlers\r\n            arrForEach(notifyHandlers, function (handler) {\r\n                if (handler) {\r\n                    if (handler[dynamicPropertyDetail]) {\r\n                        arrForEach(handler[dynamicPropertyDetail], function (detail) {\r\n                            // Clear out this handler from  previously tracked details, so that access are re-evaluated\r\n                            detail.clr(handler);\r\n                        });\r\n                        handler[dynamicPropertyDetail] = null;\r\n                    }\r\n                    // The handler may have self removed as part of another handler so re-check\r\n                    if (handler.fn) {\r\n                        try {\r\n                            _useHandler(handler, handler.fn);\r\n                        }\r\n                        catch (e) {\r\n                            // Don't let a single failing watcher cause other watches to fail\r\n                            watcherFailures_1[_DYN_PUSH /* @min:%2epush */](e);\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n            // During notification we may have had additional updates -- so notify those updates as well\r\n            if (_waitingHandlers) {\r\n                try {\r\n                    _notifyWatchers();\r\n                }\r\n                catch (e) {\r\n                    watcherFailures_1[_DYN_PUSH /* @min:%2epush */](e);\r\n                }\r\n            }\r\n            if (watcherFailures_1[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                throwAggregationError(\"Watcher error(s): \", watcherFailures_1);\r\n            }\r\n        }\r\n    }\r\n    function _addWatcher(detail) {\r\n        if (detail && detail.h[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n            if (!_waitingHandlers) {\r\n                _waitingHandlers = [];\r\n            }\r\n            if (!_watcherTimer) {\r\n                _watcherTimer = scheduleTimeout(function () {\r\n                    _watcherTimer = null;\r\n                    _notifyWatchers();\r\n                }, 0);\r\n            }\r\n            // Add all of the handlers for this detail (if not already present) - using normal for-loop for performance\r\n            for (var idx = 0; idx < detail.h[_DYN_LENGTH /* @min:%2elength */]; idx++) {\r\n                var handler = detail.h[idx];\r\n                // Add this handler to the collection of handlers to re-execute\r\n                if (handler && arrIndexOf(_waitingHandlers, handler) === -1) {\r\n                    _waitingHandlers[_DYN_PUSH /* @min:%2epush */](handler);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    function _trackHandler(handler, detail) {\r\n        if (handler) {\r\n            var details = handler[dynamicPropertyDetail] = handler[dynamicPropertyDetail] || [];\r\n            if (arrIndexOf(details, detail) === -1) {\r\n                // If this detail is not already listed as tracked then add it so that we re-evaluate it's usage\r\n                details[_DYN_PUSH /* @min:%2epush */](detail);\r\n            }\r\n        }\r\n    }\r\n    theState = (_a = {\r\n            prop: dynamicPropertySymbol,\r\n            ro: dynamicPropertyReadOnly,\r\n            rf: dynamicPropertyReferenced\r\n        },\r\n        _a[_DYN_BLK_VAL /* @min:blkVal */] = dynamicPropertyBlockValue,\r\n        _a[_DYN_HDLR /* @min:hdlr */] = cfgHandler,\r\n        _a.add = _addWatcher,\r\n        _a[_DYN_NOTIFY /* @min:notify */] = _notifyWatchers,\r\n        _a.use = _useHandler,\r\n        _a.trk = _trackHandler,\r\n        _a);\r\n    return theState;\r\n}\r\n//# sourceMappingURL=DynamicState.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { dumpObj, isUndefined, objDefine, objForEachKey } from \"@nevware21/ts-utils\";\r\nimport { createUniqueNamespace } from \"../JavaScriptSDK/DataCacheHelper\";\r\nimport { STR_NOT_DYNAMIC_ERROR } from \"../JavaScriptSDK/InternalConstants\";\r\nimport { _DYN_BLK_VAL, _DYN_LOGGER, _DYN_NOTIFY, _DYN_RD_ONLY, _DYN_SET_DF, _DYN_THROW_INTERNAL, _DYN_WARN_TO_CONSOLE, _DYN_WATCH } from \"../__DynamicConstants\";\r\nimport { _applyDefaultValue } from \"./ConfigDefaults\";\r\nimport { _makeDynamicObject, _setDynamicProperty, _setDynamicPropertyState, _throwDynamicError } from \"./DynamicProperty\";\r\nimport { _createState } from \"./DynamicState\";\r\nimport { CFG_HANDLER_LINK, _cfgDeepCopy, getDynamicConfigHandler, throwInvalidAccess } from \"./DynamicSupport\";\r\n/**\r\n * Identifies a function which will be re-called whenever any of it's accessed configuration values\r\n * change.\r\n * @param configHandler - The callback that will be called for the initial request and then whenever any\r\n * accessed configuration changes are identified.\r\n */\r\nfunction _createAndUseHandler(state, configHandler) {\r\n    var handler = {\r\n        fn: configHandler,\r\n        rm: function () {\r\n            // Clear all references to the handler so it can be garbage collected\r\n            // This will also cause this handler to never get called and eventually removed\r\n            handler.fn = null;\r\n            state = null;\r\n            configHandler = null;\r\n        }\r\n    };\r\n    objDefine(handler, \"toJSON\", { v: function () { return \"WatcherHandler\" + (handler.fn ? \"\" : \"[X]\"); } });\r\n    state.use(handler, configHandler);\r\n    return handler;\r\n}\r\n/**\r\n * Creates the dynamic config handler and associates with the target config as the root object\r\n * @param target - The config that you want to be root of the dynamic config\r\n * @param inPlace - Should the passed config be converted in-place or a new proxy returned\r\n * @returns The existing dynamic handler or a new instance with the provided config values\r\n */\r\nfunction _createDynamicHandler(logger, target, inPlace) {\r\n    var _a;\r\n    var dynamicHandler = getDynamicConfigHandler(target);\r\n    if (dynamicHandler) {\r\n        // The passed config is already dynamic so return it's tracker\r\n        return dynamicHandler;\r\n    }\r\n    var uid = createUniqueNamespace(\"dyncfg\", true);\r\n    var newTarget = (target && inPlace !== false) ? target : _cfgDeepCopy(target);\r\n    var theState;\r\n    function _notifyWatchers() {\r\n        theState[_DYN_NOTIFY /* @min:%2enotify */]();\r\n    }\r\n    function _setValue(target, name, value) {\r\n        try {\r\n            target = _setDynamicProperty(theState, target, name, value);\r\n        }\r\n        catch (e) {\r\n            // Unable to convert to dynamic property so just leave as non-dynamic\r\n            _throwDynamicError(logger, name, \"Setting value\", e);\r\n        }\r\n        return target[name];\r\n    }\r\n    function _watch(configHandler) {\r\n        return _createAndUseHandler(theState, configHandler);\r\n    }\r\n    function _block(configHandler, allowUpdate) {\r\n        theState.use(null, function (details) {\r\n            var prevUpd = theState.upd;\r\n            try {\r\n                if (!isUndefined(allowUpdate)) {\r\n                    theState.upd = allowUpdate;\r\n                }\r\n                configHandler(details);\r\n            }\r\n            finally {\r\n                theState.upd = prevUpd;\r\n            }\r\n        });\r\n    }\r\n    function _ref(target, name) {\r\n        var _a;\r\n        // Make sure it's dynamic and mark as referenced with it's current value\r\n        return _setDynamicPropertyState(theState, target, name, (_a = {}, _a[0 /* _eSetDynamicPropertyFlags.inPlace */] = true, _a))[name];\r\n    }\r\n    function _rdOnly(target, name) {\r\n        var _a;\r\n        // Make sure it's dynamic and mark as readonly with it's current value\r\n        return _setDynamicPropertyState(theState, target, name, (_a = {}, _a[1 /* _eSetDynamicPropertyFlags.readOnly */] = true, _a))[name];\r\n    }\r\n    function _blkPropValue(target, name) {\r\n        var _a;\r\n        // Make sure it's dynamic and mark as readonly with it's current value\r\n        return _setDynamicPropertyState(theState, target, name, (_a = {}, _a[2 /* _eSetDynamicPropertyFlags.blockDynamicProperty */] = true, _a))[name];\r\n    }\r\n    function _applyDefaults(theConfig, defaultValues) {\r\n        if (defaultValues) {\r\n            // Resolve/apply the defaults\r\n            objForEachKey(defaultValues, function (name, value) {\r\n                // Sets the value and makes it dynamic (if it doesn't already exist)\r\n                _applyDefaultValue(cfgHandler, theConfig, name, value);\r\n            });\r\n        }\r\n        return theConfig;\r\n    }\r\n    var cfgHandler = (_a = {\r\n            uid: null,\r\n            cfg: newTarget\r\n        },\r\n        _a[_DYN_LOGGER /* @min:logger */] = logger,\r\n        _a[_DYN_NOTIFY /* @min:notify */] = _notifyWatchers,\r\n        _a.set = _setValue,\r\n        _a[_DYN_SET_DF /* @min:setDf */] = _applyDefaults,\r\n        _a[_DYN_WATCH /* @min:watch */] = _watch,\r\n        _a.ref = _ref,\r\n        _a[_DYN_RD_ONLY /* @min:rdOnly */] = _rdOnly,\r\n        _a[_DYN_BLK_VAL /* @min:blkVal */] = _blkPropValue,\r\n        _a._block = _block,\r\n        _a);\r\n    objDefine(cfgHandler, \"uid\", {\r\n        c: false,\r\n        e: false,\r\n        w: false,\r\n        v: uid\r\n    });\r\n    theState = _createState(cfgHandler);\r\n    // Setup tracking for all defined default keys\r\n    _makeDynamicObject(theState, newTarget, \"config\", \"Creating\");\r\n    return cfgHandler;\r\n}\r\n/**\r\n * Log an invalid access message to the console\r\n * @param message\r\n */\r\nfunction _logInvalidAccess(logger, message) {\r\n    if (logger) {\r\n        logger[_DYN_WARN_TO_CONSOLE /* @min:%2ewarnToConsole */](message);\r\n        logger[_DYN_THROW_INTERNAL /* @min:%2ethrowInternal */](2 /* eLoggingSeverity.WARNING */, 108 /* _eInternalMessageId.DynamicConfigException */, message);\r\n    }\r\n    else {\r\n        // We don't have a logger so just throw an exception\r\n        throwInvalidAccess(message);\r\n    }\r\n}\r\n/**\r\n * Create or return a dynamic version of the passed config, if it is not already dynamic\r\n * @param config - The config to be converted into a dynamic config\r\n * @param defaultConfig - The default values to apply on the config if the properties don't already exist\r\n * @param inPlace - Should the config be converted in-place into a dynamic config or a new instance returned, defaults to true\r\n * @returns The dynamic config handler for the config (whether new or existing)\r\n */\r\nexport function createDynamicConfig(config, defaultConfig, logger, inPlace) {\r\n    var dynamicHandler = _createDynamicHandler(logger, config || {}, inPlace);\r\n    if (defaultConfig) {\r\n        dynamicHandler[_DYN_SET_DF /* @min:%2esetDf */](dynamicHandler.cfg, defaultConfig);\r\n    }\r\n    return dynamicHandler;\r\n}\r\n/**\r\n * Watch and track changes for accesses to the current config, the provided config MUST already be\r\n * a dynamic config or a child accessed via the dynamic config\r\n * @param config\r\n * @param configHandler\r\n * @param logger - The logger instance to use if there is no existing handler\r\n * @returns A watcher handler instance that can be used to remove itself when being unloaded\r\n * @throws TypeError if the provided config is not a dynamic config instance\r\n */\r\nexport function onConfigChange(config, configHandler, logger) {\r\n    var handler = config[CFG_HANDLER_LINK] || config;\r\n    if (handler.cfg && (handler.cfg === config || handler.cfg[CFG_HANDLER_LINK] === handler)) {\r\n        return handler[_DYN_WATCH /* @min:%2ewatch */](configHandler);\r\n    }\r\n    _logInvalidAccess(logger, STR_NOT_DYNAMIC_ERROR + dumpObj(config));\r\n    return createDynamicConfig(config, null, logger)[_DYN_WATCH /* @min:%2ewatch */](configHandler);\r\n}\r\n//# sourceMappingURL=DynamicConfig.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { isArray, isPlainObject, objForEachKey, symbolFor, throwTypeError } from \"@nevware21/ts-utils\";\r\nimport { _DYN_LENGTH } from \"../__DynamicConstants\";\r\n// Using Symbol.for so that if the same symbol was already created it would be returned\r\n// To handle multiple instances using potentially different versions we are not using\r\n// createUniqueNamespace()\r\nexport var CFG_HANDLER_LINK = symbolFor(\"[[ai_dynCfg_1]]\");\r\n/**\r\n * @internal\r\n * @ignore\r\n * The symbol to tag objects / arrays with if they should not be converted\r\n */\r\nvar BLOCK_DYNAMIC = symbolFor(\"[[ai_blkDynCfg_1]]\");\r\n/**\r\n * @internal\r\n * @ignore\r\n * The symbol to tag objects to indicate that when included into the configuration that\r\n * they should be converted into a trackable dynamic object.\r\n */\r\nvar FORCE_DYNAMIC = symbolFor(\"[[ai_frcDynCfg_1]]\");\r\nexport function _cfgDeepCopy(source) {\r\n    if (source) {\r\n        var target_1;\r\n        if (isArray(source)) {\r\n            target_1 = [];\r\n            target_1[_DYN_LENGTH /* @min:%2elength */] = source[_DYN_LENGTH /* @min:%2elength */];\r\n        }\r\n        else if (isPlainObject(source)) {\r\n            target_1 = {};\r\n        }\r\n        if (target_1) {\r\n            // Copying index values by property name as the extensionConfig can be an array or object\r\n            objForEachKey(source, function (key, value) {\r\n                // Perform a deep copy of the object\r\n                target_1[key] = _cfgDeepCopy(value);\r\n            });\r\n            return target_1;\r\n        }\r\n    }\r\n    return source;\r\n}\r\n/**\r\n * @internal\r\n * Get the dynamic config handler if the value is already dynamic\r\n * @param value\r\n * @returns\r\n */\r\nexport function getDynamicConfigHandler(value) {\r\n    if (value) {\r\n        var handler = value[CFG_HANDLER_LINK] || value;\r\n        if (handler.cfg && (handler.cfg === value || handler.cfg[CFG_HANDLER_LINK] === handler)) {\r\n            return handler;\r\n        }\r\n    }\r\n    return null;\r\n}\r\n/**\r\n * Mark the provided value so that if it's included into the configuration it will NOT have\r\n * its properties converted into a dynamic (reactive) object. If the object is not a plain object\r\n * or an array (ie. a class) this function has not affect as only Objects and Arrays are converted\r\n * into dynamic objects in the dynamic configuration.\r\n *\r\n * When you have tagged a value as both {@link forceDynamicConversion} and blocked force will take precedence.\r\n *\r\n * You should only need to use this function, if you are creating dynamic \"classes\" from objects\r\n * which confirm to the require interface. A common case for this is during unit testing where it's\r\n * easier to create mock extensions.\r\n *\r\n * If `value` is falsy (null / undefined / 0 / empty string etc) it will not be tagged and\r\n * if there is an exception adding the property to the value (because its frozen etc) the\r\n * exception will be swallowed\r\n *\r\n * @example\r\n * ```ts\r\n * // This is a valid \"extension\", but it is technically an object\r\n * // So when included in the config.extensions it WILL be cloned and then\r\n * // converted into a dynamic object, where all of its properties will become\r\n * // get/set object properties and will be tracked. While this WILL still\r\n * // function, when attempt to use a mocking framework on top of this the\r\n * // functions are now technically get accessors which return a function\r\n * // and this can cause some mocking frameworks to fail.\r\n * let mockChannel = {\r\n *      pause: () => { },\r\n*      resume: () => { },\r\n*      teardown: () => { },\r\n*      flush: (async: any, callBack: any) => { },\r\n*      processTelemetry: (env: any) => { },\r\n*      setNextPlugin: (next: any) => { },\r\n*      initialize: (config: any, core: any, extensions: any) => { },\r\n*      identifier: \"testChannel\",\r\n*      priority: 1003\r\n* };\r\n * ```\r\n * @param value - The object that you want to block from being converted into a\r\n * trackable dynamic object\r\n * @returns The original value\r\n */\r\nexport function blockDynamicConversion(value) {\r\n    if (value && (isPlainObject(value) || isArray(value))) {\r\n        try {\r\n            value[BLOCK_DYNAMIC] = true;\r\n        }\r\n        catch (e) {\r\n            // Don't throw for this case as it's an ask only\r\n        }\r\n    }\r\n    return value;\r\n}\r\n/**\r\n * This is the reverse case of {@link blockDynamicConversion} in that this will tag an\r\n * object to indicate that it should always be converted into a dynamic trackable object\r\n * even when not an object or array. So all properties of this object will become\r\n * get / set accessor functions.\r\n *\r\n * When you have tagged a value as both {@link forceDynamicConversion} and blocked force will take precedence.\r\n *\r\n * If `value` is falsy (null / undefined / 0 / empty string etc) it will not be tagged and\r\n * if there is an exception adding the property to the value (because its frozen etc) the\r\n * exception will be swallowed.\r\n * @param value - The object that should be tagged and converted if included into a dynamic\r\n * configuration.\r\n * @returns The original value\r\n */\r\nexport function forceDynamicConversion(value) {\r\n    if (value) {\r\n        try {\r\n            value[FORCE_DYNAMIC] = true;\r\n        }\r\n        catch (e) {\r\n            // Don't throw for this case as it's an ask only\r\n        }\r\n    }\r\n    return value;\r\n}\r\n/**\r\n * @internal\r\n * @ignore\r\n * Helper function to check whether an object can or should be converted into a dynamic\r\n * object.\r\n * @param value - The object to check whether it should be converted\r\n * @returns `true` if the value should be converted otherwise `false`.\r\n */\r\nexport function _canMakeDynamic(getFunc, state, value) {\r\n    var result = false;\r\n    // Object must exist and be truthy\r\n    if (value && !getFunc[state.blkVal]) {\r\n        // Tagged as always convert\r\n        result = value[FORCE_DYNAMIC];\r\n        // Check that it's not explicitly tagged as blocked\r\n        if (!result && !value[BLOCK_DYNAMIC]) {\r\n            // Only convert plain objects or arrays by default\r\n            result = isPlainObject(value) || isArray(value);\r\n        }\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * Throws an invalid access exception\r\n * @param message - The message to include in the exception\r\n */\r\nexport function throwInvalidAccess(message) {\r\n    throwTypeError(\"InvalidAccess:\" + message);\r\n}\r\n//# sourceMappingURL=DynamicSupport.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { createEnum, createTypeMap } from \"@nevware21/ts-utils\";\r\n/**\r\n * Create an enum style object which has both the key => value and value => key mappings\r\n * @param values - The values to populate on the new object\r\n * @returns\r\n */\r\nexport var createEnumStyle = createEnum;\r\n/**\r\n * Create a 2 index map that maps an enum's key and value to the defined map value, X[\"key\"] => mapValue and X[0] => mapValue.\r\n * Generic values\r\n * - E = the const enum type (typeof eRequestHeaders);\r\n * - V = Identifies the valid values for the keys, this should include both the enum numeric and string key of the type. The\r\n * resulting \"Value\" of each entry identifies the valid values withing the assignments.\r\n * @param values - The values to populate on the new object\r\n * @returns\r\n */\r\nexport var createValueMap = createTypeMap;\r\n//# sourceMappingURL=EnumHelperFuncs.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { createEnumStyle } from \"../JavaScriptSDK.Enums/EnumHelperFuncs\";\r\n/**\r\n * The EventsDiscardedReason enumeration contains a set of values that specify the reason for discarding an event.\r\n */\r\nexport var EventsDiscardedReason = createEnumStyle({\r\n    /**\r\n     * Unknown.\r\n     */\r\n    Unknown: 0 /* eEventsDiscardedReason.Unknown */,\r\n    /**\r\n     * Status set to non-retryable.\r\n     */\r\n    NonRetryableStatus: 1 /* eEventsDiscardedReason.NonRetryableStatus */,\r\n    /**\r\n     * The event is invalid.\r\n     */\r\n    InvalidEvent: 2 /* eEventsDiscardedReason.InvalidEvent */,\r\n    /**\r\n     * The size of the event is too large.\r\n     */\r\n    SizeLimitExceeded: 3 /* eEventsDiscardedReason.SizeLimitExceeded */,\r\n    /**\r\n     * The server is not accepting events from this instrumentation key.\r\n     */\r\n    KillSwitch: 4 /* eEventsDiscardedReason.KillSwitch */,\r\n    /**\r\n     * The event queue is full.\r\n     */\r\n    QueueFull: 5 /* eEventsDiscardedReason.QueueFull */\r\n});\r\n/**\r\n *  The eBatchDiscardedReason enumeration contains a set of values that specify the reason for discarding offline batches.\r\n */\r\nexport var BatchDiscardedReason = createEnumStyle({\r\n    /**\r\n     * Unknown.\r\n     */\r\n    Unknown: 0 /* eBatchDiscardedReason.Unknown */,\r\n    /**\r\n      * Status set to non-retryable after sending\r\n      */\r\n    NonRetryableStatus: 1 /* eBatchDiscardedReason.NonRetryableStatus */,\r\n    /**\r\n     * Batches with lower number of critical events are dropped to free up storage space\r\n     */\r\n    CleanStorage: 2 /* eBatchDiscardedReason.CleanStorage */,\r\n    /**\r\n     * The batches in storage exceed max allowed time\r\n     */\r\n    MaxInStorageTimeExceeded: 3 /* eBatchDiscardedReason.MaxInStorageTimeExceeded */\r\n});\r\n//# sourceMappingURL=EventsDiscardedReason.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\nimport { createEnumStyle } from \"./EnumHelperFuncs\";\r\nexport var ActiveStatus = createEnumStyle({\r\n    NONE: 0 /* eActiveStatus.NONE */,\r\n    PENDING: 3 /* eActiveStatus.PENDING */,\r\n    INACTIVE: 1 /* eActiveStatus.INACTIVE */,\r\n    ACTIVE: 2 /* eActiveStatus.ACTIVE */\r\n});\r\n//# sourceMappingURL=InitActiveStatusEnum.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\n\"use strict\";\r\nvar _a;\r\nimport { __spreadArrayFn as __spreadArray } from \"@microsoft/applicationinsights-shims\";\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { createPromise, createSyncAllSettledPromise, doAwaitResponse } from \"@nevware21/ts-async\";\r\nimport { arrAppend, arrForEach, arrIndexOf, createTimeout, deepExtend, hasDocument, isFunction, isNullOrUndefined, isPlainObject, isPromiseLike, objDeepFreeze, objDefine, objForEachKey, objFreeze, objHasOwn, scheduleTimeout, throwError } from \"@nevware21/ts-utils\";\r\nimport { createDynamicConfig, onConfigChange } from \"../Config/DynamicConfig\";\r\nimport { ActiveStatus } from \"../JavaScriptSDK.Enums/InitActiveStatusEnum\";\r\nimport { _DYN_ADD_NOTIFICATION_LIS1, _DYN_CANCEL, _DYN_CREATE_NEW, _DYN_ENABLED, _DYN_GET_NOTIFY_MGR, _DYN_GET_PLUGIN, _DYN_GET_PROCESS_TEL_CONT2, _DYN_IDENTIFIER, _DYN_INITIALIZE, _DYN_INSTRUMENTATION_KEY, _DYN_IS_ASYNC, _DYN_IS_INITIALIZED, _DYN_I_KEY, _DYN_LENGTH, _DYN_LOGGER, _DYN_LOGGING_LEVEL_CONSOL4, _DYN_MESSAGE, _DYN_MESSAGE_ID, _DYN_NAME, _DYN_NOTIFY, _DYN_ON_COMPLETE, _DYN_POLL_INTERNAL_LOGS, _DYN_PROCESS_NEXT, _DYN_PUSH, _DYN_REMOVE_NOTIFICATION_0, _DYN_SET_DF, _DYN_SPLICE, _DYN_STOP_POLLING_INTERNA3, _DYN_TEARDOWN, _DYN_TIME, _DYN_UNLOAD, _DYN_VALUE, _DYN_VERSION, _DYN_WATCH, _DYN__INACTIVE } from \"../__DynamicConstants\";\r\nimport { doUnloadAll, runTargetUnload } from \"./AsyncUtils\";\r\nimport { ChannelControllerPriority } from \"./Constants\";\r\nimport { createCookieMgr } from \"./CookieMgr\";\r\nimport { createUniqueNamespace } from \"./DataCacheHelper\";\r\nimport { getDebugListener } from \"./DbgExtensionUtils\";\r\nimport { DiagnosticLogger, _InternalLogMessage, _throwInternal, _warnToConsole } from \"./DiagnosticLogger\";\r\nimport { getSetValue, isNotNullOrUndefined, proxyFunctionAs, proxyFunctions, toISOString } from \"./HelperFuncs\";\r\nimport { STR_CHANNELS, STR_CORE, STR_CREATE_PERF_MGR, STR_DISABLED, STR_EMPTY, STR_EVENTS_DISCARDED, STR_EXTENSIONS, STR_EXTENSION_CONFIG, STR_GET_PERF_MGR, STR_PRIORITY, UNDEFINED_VALUE } from \"./InternalConstants\";\r\nimport { NotificationManager } from \"./NotificationManager\";\r\nimport { PerfManager, doPerf, getGblPerfMgr } from \"./PerfManager\";\r\nimport { createProcessTelemetryContext, createProcessTelemetryUnloadContext, createProcessTelemetryUpdateContext, createTelemetryProxyChain } from \"./ProcessTelemetryContext\";\r\nimport { _getPluginState, createDistributedTraceContext, initializePlugins, sortPlugins } from \"./TelemetryHelpers\";\r\nimport { TelemetryInitializerPlugin } from \"./TelemetryInitializerPlugin\";\r\nimport { createUnloadHandlerContainer } from \"./UnloadHandlerContainer\";\r\nimport { createUnloadHookContainer } from \"./UnloadHookContainer\";\r\nvar strValidationError = \"Plugins must provide initialize method\";\r\nvar strNotificationManager = \"_notificationManager\";\r\nvar strSdkUnloadingError = \"SDK is still unloading...\";\r\nvar strSdkNotInitialized = \"SDK is not initialized\";\r\nvar maxInitQueueSize = 100;\r\nvar maxInitTimeout = 50000;\r\n// const strPluginUnloadFailed = \"Failed to unload plugin\";\r\n/**\r\n * The default settings for the config.\r\n * WE MUST include all defaults here to ensure that the config is created with all of the properties\r\n * defined as dynamic.\r\n */\r\nvar defaultConfig = objDeepFreeze((_a = {\r\n        cookieCfg: {}\r\n    },\r\n    _a[STR_EXTENSIONS] = { rdOnly: true, ref: true, v: [] },\r\n    _a[STR_CHANNELS] = { rdOnly: true, ref: true, v: [] },\r\n    _a[STR_EXTENSION_CONFIG] = { ref: true, v: {} },\r\n    _a[STR_CREATE_PERF_MGR] = UNDEFINED_VALUE,\r\n    _a.loggingLevelConsole = 0 /* eLoggingSeverity.DISABLED */,\r\n    _a.diagnosticLogInterval = UNDEFINED_VALUE,\r\n    _a));\r\n/**\r\n * Helper to create the default performance manager\r\n * @param core\r\n * @param notificationMgr\r\n */\r\nfunction _createPerfManager(core, notificationMgr) {\r\n    return new PerfManager(notificationMgr);\r\n}\r\nfunction _validateExtensions(logger, channelPriority, allExtensions) {\r\n    var _a;\r\n    // Concat all available extensions\r\n    var coreExtensions = [];\r\n    var channels = [];\r\n    // Check if any two extensions have the same priority, then warn to console\r\n    // And extract the local extensions from the\r\n    var extPriorities = {};\r\n    // Extension validation\r\n    arrForEach(allExtensions, function (ext) {\r\n        // Check for ext.initialize\r\n        if (isNullOrUndefined(ext) || isNullOrUndefined(ext[_DYN_INITIALIZE /* @min:%2einitialize */])) {\r\n            throwError(strValidationError);\r\n        }\r\n        var extPriority = ext[STR_PRIORITY /* @min:%2epriority */];\r\n        var identifier = ext[_DYN_IDENTIFIER /* @min:%2eidentifier */];\r\n        if (ext && extPriority) {\r\n            if (!isNullOrUndefined(extPriorities[extPriority])) {\r\n                _warnToConsole(logger, \"Two extensions have same priority #\" + extPriority + \" - \" + extPriorities[extPriority] + \", \" + identifier);\r\n            }\r\n            else {\r\n                // set a value\r\n                extPriorities[extPriority] = identifier;\r\n            }\r\n        }\r\n        // Split extensions to core and channels\r\n        if (!extPriority || extPriority < channelPriority) {\r\n            // Add to core extension that will be managed by AppInsightsCore\r\n            coreExtensions[_DYN_PUSH /* @min:%2epush */](ext);\r\n        }\r\n        else {\r\n            channels[_DYN_PUSH /* @min:%2epush */](ext);\r\n        }\r\n    });\r\n    return _a = {},\r\n        _a[STR_CORE /* @min:core */] = coreExtensions,\r\n        _a[STR_CHANNELS /* @min:channels */] = channels,\r\n        _a;\r\n}\r\nfunction _isPluginPresent(thePlugin, plugins) {\r\n    var exists = false;\r\n    arrForEach(plugins, function (plugin) {\r\n        if (plugin === thePlugin) {\r\n            exists = true;\r\n            return -1;\r\n        }\r\n    });\r\n    return exists;\r\n}\r\nfunction _deepMergeConfig(details, target, newValues, merge) {\r\n    // Lets assign the new values to the existing config\r\n    if (newValues) {\r\n        objForEachKey(newValues, function (key, value) {\r\n            if (merge) {\r\n                if (isPlainObject(value) && isPlainObject(target[key])) {\r\n                    // The target is an object and it has a value\r\n                    _deepMergeConfig(details, target[key], value, merge);\r\n                }\r\n            }\r\n            if (merge && isPlainObject(value) && isPlainObject(target[key])) {\r\n                // The target is an object and it has a value\r\n                _deepMergeConfig(details, target[key], value, merge);\r\n            }\r\n            else {\r\n                // Just Assign (replace) and/or make the property dynamic\r\n                details.set(target, key, value);\r\n            }\r\n        });\r\n    }\r\n}\r\nfunction _findWatcher(listeners, newWatcher) {\r\n    var theListener = null;\r\n    var idx = -1;\r\n    arrForEach(listeners, function (listener, lp) {\r\n        if (listener.w === newWatcher) {\r\n            theListener = listener;\r\n            idx = lp;\r\n            return -1;\r\n        }\r\n    });\r\n    return { i: idx, l: theListener };\r\n}\r\nfunction _addDelayedCfgListener(listeners, newWatcher) {\r\n    var theListener = _findWatcher(listeners, newWatcher).l;\r\n    if (!theListener) {\r\n        theListener = {\r\n            w: newWatcher,\r\n            rm: function () {\r\n                var fnd = _findWatcher(listeners, newWatcher);\r\n                if (fnd.i !== -1) {\r\n                    listeners[_DYN_SPLICE /* @min:%2esplice */](fnd.i, 1);\r\n                }\r\n            }\r\n        };\r\n        listeners[_DYN_PUSH /* @min:%2epush */](theListener);\r\n    }\r\n    return theListener;\r\n}\r\nfunction _registerDelayedCfgListener(config, listeners, logger) {\r\n    arrForEach(listeners, function (listener) {\r\n        var unloadHdl = onConfigChange(config, listener.w, logger);\r\n        delete listener.w; // Clear the listener reference so it will get garbage collected.\r\n        // replace the remove function\r\n        listener.rm = function () {\r\n            unloadHdl.rm();\r\n        };\r\n    });\r\n}\r\n// Moved this outside of the closure to reduce the retained memory footprint\r\nfunction _initDebugListener(configHandler, unloadContainer, notificationManager, debugListener) {\r\n    // Will get recalled if any referenced config values are changed\r\n    unloadContainer.add(configHandler[_DYN_WATCH /* @min:%2ewatch */](function (details) {\r\n        var disableDbgExt = details.cfg.disableDbgExt;\r\n        if (disableDbgExt === true && debugListener) {\r\n            // Remove any previously loaded debug listener\r\n            notificationManager[_DYN_REMOVE_NOTIFICATION_0 /* @min:%2eremoveNotificationListener */](debugListener);\r\n            debugListener = null;\r\n        }\r\n        if (notificationManager && !debugListener && disableDbgExt !== true) {\r\n            debugListener = getDebugListener(details.cfg);\r\n            notificationManager[_DYN_ADD_NOTIFICATION_LIS1 /* @min:%2eaddNotificationListener */](debugListener);\r\n        }\r\n    }));\r\n    return debugListener;\r\n}\r\n// Moved this outside of the closure to reduce the retained memory footprint\r\nfunction _createUnloadHook(unloadHook) {\r\n    return objDefine({\r\n        rm: function () {\r\n            unloadHook.rm();\r\n        }\r\n    }, \"toJSON\", { v: function () { return \"aicore::onCfgChange<\" + JSON.stringify(unloadHook) + \">\"; } });\r\n}\r\n/**\r\n * @group Classes\r\n * @group Entrypoint\r\n */\r\nvar AppInsightsCore = /** @class */ (function () {\r\n    function AppInsightsCore() {\r\n        // NOTE!: DON'T set default values here, instead set them in the _initDefaults() function as it is also called during teardown()\r\n        var _configHandler;\r\n        var _isInitialized;\r\n        var _logger;\r\n        var _eventQueue;\r\n        var _notificationManager;\r\n        var _perfManager;\r\n        var _cfgPerfManager;\r\n        var _cookieManager;\r\n        var _pluginChain;\r\n        var _configExtensions;\r\n        var _channelConfig;\r\n        var _channels;\r\n        var _isUnloading;\r\n        var _telemetryInitializerPlugin;\r\n        var _internalLogsEventName;\r\n        var _evtNamespace;\r\n        var _unloadHandlers;\r\n        var _hookContainer;\r\n        var _debugListener;\r\n        var _traceCtx;\r\n        var _instrumentationKey;\r\n        var _cfgListeners;\r\n        var _extensions;\r\n        var _pluginVersionStringArr;\r\n        var _pluginVersionString;\r\n        var _activeStatus; // to indicate if ikey or endpoint url promised is resolved or not\r\n        var _endpoint;\r\n        var _initInMemoMaxSize; // max event count limit during wait for init promises to be resolved\r\n        var _isStatusSet; // track if active status is set in case of init timeout and init promises setting the status twice\r\n        var _initTimer;\r\n        /**\r\n         * Internal log poller\r\n         */\r\n        var _internalLogPoller;\r\n        var _internalLogPollerListening;\r\n        var _forceStopInternalLogPoller;\r\n        dynamicProto(AppInsightsCore, this, function (_self) {\r\n            // Set the default values (also called during teardown)\r\n            _initDefaults();\r\n            // Special internal method to allow the unit tests and DebugPlugin to hook embedded objects\r\n            _self[\"_getDbgPlgTargets\"] = function () {\r\n                return [_extensions, _eventQueue];\r\n            };\r\n            _self[_DYN_IS_INITIALIZED /* @min:%2eisInitialized */] = function () { return _isInitialized; };\r\n            // since version 3.3.0\r\n            _self.activeStatus = function () { return _activeStatus; };\r\n            // since version 3.3.0\r\n            // internal\r\n            _self._setPendingStatus = function () {\r\n                _activeStatus = 3 /* eActiveStatus.PENDING */;\r\n            };\r\n            // Creating the self.initialize = ()\r\n            _self[_DYN_INITIALIZE /* @min:%2einitialize */] = function (config, extensions, logger, notificationManager) {\r\n                if (_isUnloading) {\r\n                    throwError(strSdkUnloadingError);\r\n                }\r\n                // Make sure core is only initialized once\r\n                if (_self[_DYN_IS_INITIALIZED /* @min:%2eisInitialized */]()) {\r\n                    throwError(\"Core cannot be initialized more than once\");\r\n                }\r\n                _configHandler = createDynamicConfig(config, defaultConfig, logger || _self[_DYN_LOGGER /* @min:%2elogger */], false);\r\n                // Re-assigning the local config property so we don't have any references to the passed value and it can be garbage collected\r\n                config = _configHandler.cfg;\r\n                // This will be \"re-run\" if the referenced config properties are changed\r\n                _addUnloadHook(_configHandler[_DYN_WATCH /* @min:%2ewatch */](function (details) {\r\n                    var rootCfg = details.cfg;\r\n                    var isPending = _activeStatus === 3 /* eActiveStatus.PENDING */;\r\n                    if (isPending) {\r\n                        // means waiting for previous promises to be resolved, won't apply new changes\r\n                        return;\r\n                    }\r\n                    _initInMemoMaxSize = rootCfg.initInMemoMaxSize || maxInitQueueSize;\r\n                    // app Insights core only handle ikey and endpointurl, aisku will handle cs\r\n                    var ikey = rootCfg[_DYN_INSTRUMENTATION_KEY /* @min:%2einstrumentationKey */];\r\n                    var endpointUrl = rootCfg.endpointUrl; // do not need to validate endpoint url, if it is null, default one will be set by sender\r\n                    if (isNullOrUndefined(ikey)) {\r\n                        _instrumentationKey = null;\r\n                        // if new ikey is null, set status to be inactive, all new events will be saved in memory or dropped\r\n                        _activeStatus = ActiveStatus[_DYN__INACTIVE /* @min:%2eINACTIVE */];\r\n                        var msg = \"Please provide instrumentation key\";\r\n                        if (!_isInitialized) {\r\n                            // only throw error during initialization\r\n                            throwError(msg);\r\n                        }\r\n                        else {\r\n                            _throwInternal(_logger, 1 /* eLoggingSeverity.CRITICAL */, 100 /* _eInternalMessageId.InvalidInstrumentationKey */, msg);\r\n                            _releaseQueues();\r\n                        }\r\n                        return;\r\n                    }\r\n                    var promises = [];\r\n                    if (isPromiseLike(ikey)) {\r\n                        promises[_DYN_PUSH /* @min:%2epush */](ikey);\r\n                        _instrumentationKey = null; // reset current local ikey variable (otherwise it will always be the previous ikeys if timeout is called before promise cb)\r\n                    }\r\n                    else {\r\n                        // string\r\n                        _instrumentationKey = ikey;\r\n                    }\r\n                    if (isPromiseLike(endpointUrl)) {\r\n                        promises[_DYN_PUSH /* @min:%2epush */](endpointUrl);\r\n                        _endpoint = null; // reset current local endpoint variable (otherwise it will always be the previous urls if timeout is called before promise cb)\r\n                    }\r\n                    else {\r\n                        // string or null\r\n                        _endpoint = endpointUrl;\r\n                    }\r\n                    // at least have one promise\r\n                    if (promises[_DYN_LENGTH /* @min:%2elength */]) {\r\n                        // reset to false for new dynamic changes\r\n                        _isStatusSet = false;\r\n                        _activeStatus = 3 /* eActiveStatus.PENDING */;\r\n                        var initTimeout = isNotNullOrUndefined(rootCfg.initTimeOut) ? rootCfg.initTimeOut : maxInitTimeout; // rootCfg.initTimeOut could be 0\r\n                        var allPromises = createSyncAllSettledPromise(promises);\r\n                        _initTimer = scheduleTimeout(function () {\r\n                            // set _isStatusSet to true\r\n                            // set active status\r\n                            // release queues\r\n                            _initTimer = null;\r\n                            if (!_isStatusSet) {\r\n                                _setStatus();\r\n                            }\r\n                        }, initTimeout);\r\n                        doAwaitResponse(allPromises, function (response) {\r\n                            try {\r\n                                if (_isStatusSet) {\r\n                                    // promises take too long to resolve, ignore them\r\n                                    // active status should be set by timeout already\r\n                                    return;\r\n                                }\r\n                                if (!response.rejected) {\r\n                                    var values = response[_DYN_VALUE /* @min:%2evalue */];\r\n                                    if (values && values[_DYN_LENGTH /* @min:%2elength */]) {\r\n                                        // ikey\r\n                                        var ikeyRes = values[0];\r\n                                        _instrumentationKey = ikeyRes && ikeyRes[_DYN_VALUE /* @min:%2evalue */];\r\n                                        // endpoint\r\n                                        if (values[_DYN_LENGTH /* @min:%2elength */] > 1) {\r\n                                            var endpointRes = values[1];\r\n                                            _endpoint = endpointRes && endpointRes[_DYN_VALUE /* @min:%2evalue */];\r\n                                        }\r\n                                    }\r\n                                    if (_instrumentationKey) {\r\n                                        // if ikey is null, no need to trigger extra dynamic changes for extensions\r\n                                        config[_DYN_INSTRUMENTATION_KEY /* @min:%2einstrumentationKey */] = _instrumentationKey; // set config.instrumentationKey for extensions to consume\r\n                                        config.endpointUrl = _endpoint; // set config.endpointUrl for extensions to consume\r\n                                    }\r\n                                }\r\n                                // set _isStatusSet to true\r\n                                // set active status\r\n                                // release queues\r\n                                _setStatus();\r\n                            }\r\n                            catch (e) {\r\n                                if (!_isStatusSet) {\r\n                                    _setStatus();\r\n                                }\r\n                            }\r\n                        });\r\n                    }\r\n                    else {\r\n                        // means no promises\r\n                        _setStatus();\r\n                    }\r\n                    //_instrumentationKey = details.cfg.instrumentationKey;\r\n                    // Mark the extensionConfig and all first level keys as referenced\r\n                    // This is so that calls to getExtCfg() will always return the same object\r\n                    // Even when a user may \"re-assign\" the plugin properties (or it's unloaded/reloaded)\r\n                    var extCfg = details.ref(details.cfg, STR_EXTENSION_CONFIG);\r\n                    objForEachKey(extCfg, function (key) {\r\n                        details.ref(extCfg, key);\r\n                    });\r\n                }));\r\n                _notificationManager = notificationManager;\r\n                // Initialize the debug listener outside of the closure to reduce the retained memory footprint\r\n                _debugListener = _initDebugListener(_configHandler, _hookContainer, _notificationManager && _self[_DYN_GET_NOTIFY_MGR /* @min:%2egetNotifyMgr */](), _debugListener);\r\n                _initPerfManager();\r\n                _self[_DYN_LOGGER /* @min:%2elogger */] = logger;\r\n                var cfgExtensions = config[STR_EXTENSIONS /* @min:%2eextensions */];\r\n                // Extension validation\r\n                _configExtensions = [];\r\n                _configExtensions[_DYN_PUSH /* @min:%2epush */].apply(_configExtensions, __spreadArray(__spreadArray([], extensions, false), cfgExtensions, false));\r\n                _channelConfig = config[STR_CHANNELS /* @min:%2echannels */];\r\n                _initPluginChain(null);\r\n                if (!_channels || _channels[_DYN_LENGTH /* @min:%2elength */] === 0) {\r\n                    throwError(\"No \" + STR_CHANNELS + \" available\");\r\n                }\r\n                if (_channelConfig && _channelConfig[_DYN_LENGTH /* @min:%2elength */] > 1) {\r\n                    var teeController = _self[_DYN_GET_PLUGIN /* @min:%2egetPlugin */](\"TeeChannelController\");\r\n                    if (!teeController || !teeController.plugin) {\r\n                        _throwInternal(_logger, 1 /* eLoggingSeverity.CRITICAL */, 28 /* _eInternalMessageId.SenderNotInitialized */, \"TeeChannel required\");\r\n                    }\r\n                }\r\n                _registerDelayedCfgListener(config, _cfgListeners, _logger);\r\n                _cfgListeners = null;\r\n                _isInitialized = true;\r\n                if (_activeStatus === ActiveStatus.ACTIVE) {\r\n                    _releaseQueues();\r\n                }\r\n            };\r\n            _self.getChannels = function () {\r\n                var controls = [];\r\n                if (_channels) {\r\n                    arrForEach(_channels, function (channel) {\r\n                        controls[_DYN_PUSH /* @min:%2epush */](channel);\r\n                    });\r\n                }\r\n                return objFreeze(controls);\r\n            };\r\n            _self.track = function (telemetryItem) {\r\n                doPerf(_self[STR_GET_PERF_MGR /* @min:%2egetPerfMgr */](), function () { return \"AppInsightsCore:track\"; }, function () {\r\n                    if (telemetryItem === null) {\r\n                        _notifyInvalidEvent(telemetryItem);\r\n                        // throw error\r\n                        throwError(\"Invalid telemetry item\");\r\n                    }\r\n                    // do basic validation before sending it through the pipeline\r\n                    if (!telemetryItem[_DYN_NAME /* @min:%2ename */] && isNullOrUndefined(telemetryItem[_DYN_NAME /* @min:%2ename */])) {\r\n                        _notifyInvalidEvent(telemetryItem);\r\n                        throwError(\"telemetry name required\");\r\n                    }\r\n                    // setup default iKey if not passed in\r\n                    telemetryItem[_DYN_I_KEY /* @min:%2eiKey */] = telemetryItem[_DYN_I_KEY /* @min:%2eiKey */] || _instrumentationKey;\r\n                    // add default timestamp if not passed in\r\n                    telemetryItem[_DYN_TIME /* @min:%2etime */] = telemetryItem[_DYN_TIME /* @min:%2etime */] || toISOString(new Date());\r\n                    // Common Schema 4.0\r\n                    telemetryItem.ver = telemetryItem.ver || \"4.0\";\r\n                    if (!_isUnloading && _self[_DYN_IS_INITIALIZED /* @min:%2eisInitialized */]() && _activeStatus === ActiveStatus.ACTIVE) {\r\n                        // Process the telemetry plugin chain\r\n                        _createTelCtx()[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](telemetryItem);\r\n                    }\r\n                    else if (_activeStatus !== ActiveStatus[_DYN__INACTIVE /* @min:%2eINACTIVE */]) {\r\n                        // Queue events until all extensions are initialized\r\n                        if (_eventQueue[_DYN_LENGTH /* @min:%2elength */] <= _initInMemoMaxSize) {\r\n                            // set limit, if full, stop adding new events\r\n                            _eventQueue[_DYN_PUSH /* @min:%2epush */](telemetryItem);\r\n                        }\r\n                    }\r\n                }, function () { return ({ item: telemetryItem }); }, !(telemetryItem.sync));\r\n            };\r\n            _self[_DYN_GET_PROCESS_TEL_CONT2 /* @min:%2egetProcessTelContext */] = _createTelCtx;\r\n            _self[_DYN_GET_NOTIFY_MGR /* @min:%2egetNotifyMgr */] = function () {\r\n                if (!_notificationManager) {\r\n                    _notificationManager = new NotificationManager(_configHandler.cfg);\r\n                    // For backward compatibility only\r\n                    _self[strNotificationManager] = _notificationManager;\r\n                }\r\n                return _notificationManager;\r\n            };\r\n            /**\r\n             * Adds a notification listener. The SDK calls methods on the listener when an appropriate notification is raised.\r\n             * The added plugins must raise notifications. If the plugins do not implement the notifications, then no methods will be\r\n             * called.\r\n             * @param listener - An INotificationListener object.\r\n             */\r\n            _self[_DYN_ADD_NOTIFICATION_LIS1 /* @min:%2eaddNotificationListener */] = function (listener) {\r\n                _self.getNotifyMgr()[_DYN_ADD_NOTIFICATION_LIS1 /* @min:%2eaddNotificationListener */](listener);\r\n            };\r\n            /**\r\n             * Removes all instances of the listener.\r\n             * @param listener - INotificationListener to remove.\r\n             */\r\n            _self[_DYN_REMOVE_NOTIFICATION_0 /* @min:%2eremoveNotificationListener */] = function (listener) {\r\n                if (_notificationManager) {\r\n                    _notificationManager[_DYN_REMOVE_NOTIFICATION_0 /* @min:%2eremoveNotificationListener */](listener);\r\n                }\r\n            };\r\n            _self.getCookieMgr = function () {\r\n                if (!_cookieManager) {\r\n                    _cookieManager = createCookieMgr(_configHandler.cfg, _self[_DYN_LOGGER /* @min:%2elogger */]);\r\n                }\r\n                return _cookieManager;\r\n            };\r\n            _self.setCookieMgr = function (cookieMgr) {\r\n                if (_cookieManager !== cookieMgr) {\r\n                    runTargetUnload(_cookieManager, false);\r\n                    _cookieManager = cookieMgr;\r\n                }\r\n            };\r\n            _self[STR_GET_PERF_MGR /* @min:%2egetPerfMgr */] = function () {\r\n                return _perfManager || _cfgPerfManager || getGblPerfMgr();\r\n            };\r\n            _self.setPerfMgr = function (perfMgr) {\r\n                _perfManager = perfMgr;\r\n            };\r\n            _self.eventCnt = function () {\r\n                return _eventQueue[_DYN_LENGTH /* @min:%2elength */];\r\n            };\r\n            _self.releaseQueue = function () {\r\n                if (_isInitialized && _eventQueue[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                    var eventQueue = _eventQueue;\r\n                    _eventQueue = [];\r\n                    if (_activeStatus === 2 /* eActiveStatus.ACTIVE */) {\r\n                        arrForEach(eventQueue, function (event) {\r\n                            event[_DYN_I_KEY /* @min:%2eiKey */] = event[_DYN_I_KEY /* @min:%2eiKey */] || _instrumentationKey;\r\n                            _createTelCtx()[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](event);\r\n                        });\r\n                    }\r\n                    else {\r\n                        // new one for msg ikey\r\n                        _throwInternal(_logger, 2 /* eLoggingSeverity.WARNING */, 20 /* _eInternalMessageId.FailedToSendQueuedTelemetry */, \"core init status is not active\");\r\n                    }\r\n                }\r\n            };\r\n            _self[_DYN_POLL_INTERNAL_LOGS /* @min:%2epollInternalLogs */] = function (eventName) {\r\n                _internalLogsEventName = eventName || null;\r\n                _forceStopInternalLogPoller = false;\r\n                _internalLogPoller && _internalLogPoller[_DYN_CANCEL /* @min:%2ecancel */]();\r\n                return _startLogPoller(true);\r\n            };\r\n            function _setStatus() {\r\n                _isStatusSet = true;\r\n                if (isNullOrUndefined(_instrumentationKey)) {\r\n                    _activeStatus = ActiveStatus[_DYN__INACTIVE /* @min:%2eINACTIVE */];\r\n                    _throwInternal(_logger, 1 /* eLoggingSeverity.CRITICAL */, 112 /* _eInternalMessageId.InitPromiseException */, \"ikey can't be resolved from promises\");\r\n                }\r\n                else {\r\n                    _activeStatus = ActiveStatus.ACTIVE;\r\n                }\r\n                _releaseQueues();\r\n            }\r\n            function _releaseQueues() {\r\n                if (_isInitialized) {\r\n                    _self.releaseQueue();\r\n                    _self[_DYN_POLL_INTERNAL_LOGS /* @min:%2epollInternalLogs */]();\r\n                }\r\n            }\r\n            function _startLogPoller(alwaysStart) {\r\n                if ((!_internalLogPoller || !_internalLogPoller[_DYN_ENABLED /* @min:%2eenabled */]) && !_forceStopInternalLogPoller) {\r\n                    var shouldStart = alwaysStart || (_logger && _logger.queue[_DYN_LENGTH /* @min:%2elength */] > 0);\r\n                    if (shouldStart) {\r\n                        if (!_internalLogPollerListening) {\r\n                            _internalLogPollerListening = true;\r\n                            // listen for any configuration changes so that changes to the\r\n                            // interval will cause the timer to be re-initialized\r\n                            _addUnloadHook(_configHandler[_DYN_WATCH /* @min:%2ewatch */](function (details) {\r\n                                var interval = details.cfg.diagnosticLogInterval;\r\n                                if (!interval || !(interval > 0)) {\r\n                                    interval = 10000;\r\n                                }\r\n                                var isRunning = false;\r\n                                if (_internalLogPoller) {\r\n                                    // It was already created so remember it's running and cancel\r\n                                    isRunning = _internalLogPoller[_DYN_ENABLED /* @min:%2eenabled */];\r\n                                    _internalLogPoller[_DYN_CANCEL /* @min:%2ecancel */]();\r\n                                }\r\n                                // Create / reconfigure\r\n                                _internalLogPoller = createTimeout(_flushInternalLogs, interval);\r\n                                _internalLogPoller.unref();\r\n                                // Restart if previously running\r\n                                _internalLogPoller[_DYN_ENABLED /* @min:%2eenabled */] = isRunning;\r\n                            }));\r\n                        }\r\n                        _internalLogPoller[_DYN_ENABLED /* @min:%2eenabled */] = true;\r\n                    }\r\n                }\r\n                return _internalLogPoller;\r\n            }\r\n            _self[_DYN_STOP_POLLING_INTERNA3 /* @min:%2estopPollingInternalLogs */] = function () {\r\n                _forceStopInternalLogPoller = true;\r\n                _internalLogPoller && _internalLogPoller[_DYN_CANCEL /* @min:%2ecancel */]();\r\n                _flushInternalLogs();\r\n            };\r\n            // Add addTelemetryInitializer\r\n            proxyFunctions(_self, function () { return _telemetryInitializerPlugin; }, [\"addTelemetryInitializer\"]);\r\n            _self[_DYN_UNLOAD /* @min:%2eunload */] = function (isAsync, unloadComplete, cbTimeout) {\r\n                var _a;\r\n                if (isAsync === void 0) { isAsync = true; }\r\n                if (!_isInitialized) {\r\n                    // The SDK is not initialized\r\n                    throwError(strSdkNotInitialized);\r\n                }\r\n                // Check if the SDK still unloading so throw\r\n                if (_isUnloading) {\r\n                    // The SDK is already unloading\r\n                    throwError(strSdkUnloadingError);\r\n                }\r\n                var unloadState = (_a = {\r\n                        reason: 50 /* TelemetryUnloadReason.SdkUnload */\r\n                    },\r\n                    _a[_DYN_IS_ASYNC /* @min:isAsync */] = isAsync,\r\n                    _a.flushComplete = false,\r\n                    _a);\r\n                var result;\r\n                if (isAsync && !unloadComplete) {\r\n                    result = createPromise(function (resolve) {\r\n                        // Set the callback to the promise resolve callback\r\n                        unloadComplete = resolve;\r\n                    });\r\n                }\r\n                var processUnloadCtx = createProcessTelemetryUnloadContext(_getPluginChain(), _self);\r\n                processUnloadCtx[_DYN_ON_COMPLETE /* @min:%2eonComplete */](function () {\r\n                    _hookContainer.run(_self[_DYN_LOGGER /* @min:%2elogger */]);\r\n                    // Run any \"unload\" functions for the _cookieManager, _notificationManager and _logger\r\n                    doUnloadAll([_cookieManager, _notificationManager, _logger], isAsync, function () {\r\n                        _initDefaults();\r\n                        unloadComplete && unloadComplete(unloadState);\r\n                    });\r\n                }, _self);\r\n                function _doUnload(flushComplete) {\r\n                    unloadState.flushComplete = flushComplete;\r\n                    _isUnloading = true;\r\n                    // Run all of the unload handlers first (before unloading the plugins)\r\n                    _unloadHandlers.run(processUnloadCtx, unloadState);\r\n                    // Stop polling the internal logs\r\n                    _self[_DYN_STOP_POLLING_INTERNA3 /* @min:%2estopPollingInternalLogs */]();\r\n                    // Start unloading the components, from this point onwards the SDK should be considered to be in an unstable state\r\n                    processUnloadCtx[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](unloadState);\r\n                }\r\n                _flushInternalLogs();\r\n                if (!_flushChannels(isAsync, _doUnload, 6 /* SendRequestReason.SdkUnload */, cbTimeout)) {\r\n                    _doUnload(false);\r\n                }\r\n                return result;\r\n            };\r\n            _self[_DYN_GET_PLUGIN /* @min:%2egetPlugin */] = _getPlugin;\r\n            _self.addPlugin = function (plugin, replaceExisting, isAsync, addCb) {\r\n                if (!plugin) {\r\n                    addCb && addCb(false);\r\n                    _logOrThrowError(strValidationError);\r\n                    return;\r\n                }\r\n                var existingPlugin = _getPlugin(plugin[_DYN_IDENTIFIER /* @min:%2eidentifier */]);\r\n                if (existingPlugin && !replaceExisting) {\r\n                    addCb && addCb(false);\r\n                    _logOrThrowError(\"Plugin [\" + plugin[_DYN_IDENTIFIER /* @min:%2eidentifier */] + \"] is already loaded!\");\r\n                    return;\r\n                }\r\n                var updateState = {\r\n                    reason: 16 /* TelemetryUpdateReason.PluginAdded */\r\n                };\r\n                function _addPlugin(removed) {\r\n                    _configExtensions[_DYN_PUSH /* @min:%2epush */](plugin);\r\n                    updateState.added = [plugin];\r\n                    // Re-Initialize the plugin chain\r\n                    _initPluginChain(updateState);\r\n                    addCb && addCb(true);\r\n                }\r\n                if (existingPlugin) {\r\n                    var removedPlugins_1 = [existingPlugin.plugin];\r\n                    var unloadState = {\r\n                        reason: 2 /* TelemetryUnloadReason.PluginReplace */,\r\n                        isAsync: !!isAsync\r\n                    };\r\n                    _removePlugins(removedPlugins_1, unloadState, function (removed) {\r\n                        if (!removed) {\r\n                            // Previous plugin was successfully removed or was not installed\r\n                            addCb && addCb(false);\r\n                        }\r\n                        else {\r\n                            updateState.removed = removedPlugins_1;\r\n                            updateState.reason |= 32 /* TelemetryUpdateReason.PluginRemoved */;\r\n                            _addPlugin(true);\r\n                        }\r\n                    });\r\n                }\r\n                else {\r\n                    _addPlugin(false);\r\n                }\r\n            };\r\n            _self.updateCfg = function (newConfig, mergeExisting) {\r\n                if (mergeExisting === void 0) { mergeExisting = true; }\r\n                var updateState;\r\n                if (_self[_DYN_IS_INITIALIZED /* @min:%2eisInitialized */]()) {\r\n                    updateState = {\r\n                        reason: 1 /* TelemetryUpdateReason.ConfigurationChanged */,\r\n                        cfg: _configHandler.cfg,\r\n                        oldCfg: deepExtend({}, _configHandler.cfg),\r\n                        newConfig: deepExtend({}, newConfig),\r\n                        merge: mergeExisting\r\n                    };\r\n                    newConfig = updateState.newConfig;\r\n                    var cfg = _configHandler.cfg;\r\n                    // replace the immutable (if initialized) values\r\n                    // We don't currently allow updating the extensions and channels via the update config\r\n                    // So overwriting any user provided values to reuse the existing values\r\n                    newConfig[STR_EXTENSIONS /* @min:%2eextensions */] = cfg[STR_EXTENSIONS /* @min:%2eextensions */];\r\n                    newConfig[STR_CHANNELS /* @min:%2echannels */] = cfg[STR_CHANNELS /* @min:%2echannels */];\r\n                }\r\n                // Explicitly blocking any previous config watchers so that they don't get called because\r\n                // of this bulk update (Probably not necessary)\r\n                _configHandler._block(function (details) {\r\n                    // Lets assign the new values to the existing config either overwriting or re-assigning\r\n                    var theConfig = details.cfg;\r\n                    _deepMergeConfig(details, theConfig, newConfig, mergeExisting);\r\n                    if (!mergeExisting) {\r\n                        // Remove (unassign) the values \"missing\" from the newConfig and also not in the default config\r\n                        objForEachKey(theConfig, function (key) {\r\n                            if (!objHasOwn(newConfig, key)) {\r\n                                // Set the value to undefined\r\n                                details.set(theConfig, key, UNDEFINED_VALUE);\r\n                            }\r\n                        });\r\n                    }\r\n                    // Apply defaults to the new config\r\n                    details[_DYN_SET_DF /* @min:%2esetDf */](theConfig, defaultConfig);\r\n                }, true);\r\n                // Now execute all of the listeners (synchronously) so they update their values immediately\r\n                _configHandler[_DYN_NOTIFY /* @min:%2enotify */]();\r\n                if (updateState) {\r\n                    _doUpdate(updateState);\r\n                }\r\n            };\r\n            _self.evtNamespace = function () {\r\n                return _evtNamespace;\r\n            };\r\n            _self.flush = _flushChannels;\r\n            _self.getTraceCtx = function (createNew) {\r\n                if (!_traceCtx) {\r\n                    _traceCtx = createDistributedTraceContext();\r\n                }\r\n                return _traceCtx;\r\n            };\r\n            _self.setTraceCtx = function (traceCtx) {\r\n                _traceCtx = traceCtx || null;\r\n            };\r\n            _self.addUnloadHook = _addUnloadHook;\r\n            // Create the addUnloadCb\r\n            proxyFunctionAs(_self, \"addUnloadCb\", function () { return _unloadHandlers; }, \"add\");\r\n            _self.onCfgChange = function (handler) {\r\n                var unloadHook;\r\n                if (!_isInitialized) {\r\n                    unloadHook = _addDelayedCfgListener(_cfgListeners, handler);\r\n                }\r\n                else {\r\n                    unloadHook = onConfigChange(_configHandler.cfg, handler, _self[_DYN_LOGGER /* @min:%2elogger */]);\r\n                }\r\n                return _createUnloadHook(unloadHook);\r\n            };\r\n            _self.getWParam = function () {\r\n                return (hasDocument() || !!_configHandler.cfg.enableWParam) ? 0 : -1;\r\n            };\r\n            function _setPluginVersions() {\r\n                var thePlugins = {};\r\n                _pluginVersionStringArr = [];\r\n                var _addPluginVersions = function (plugins) {\r\n                    if (plugins) {\r\n                        arrForEach(plugins, function (plugin) {\r\n                            if (plugin[_DYN_IDENTIFIER /* @min:%2eidentifier */] && plugin[_DYN_VERSION /* @min:%2eversion */] && !thePlugins[plugin.identifier]) {\r\n                                var ver = plugin[_DYN_IDENTIFIER /* @min:%2eidentifier */] + \"=\" + plugin[_DYN_VERSION /* @min:%2eversion */];\r\n                                _pluginVersionStringArr[_DYN_PUSH /* @min:%2epush */](ver);\r\n                                thePlugins[plugin.identifier] = plugin;\r\n                            }\r\n                        });\r\n                    }\r\n                };\r\n                _addPluginVersions(_channels);\r\n                if (_channelConfig) {\r\n                    arrForEach(_channelConfig, function (channels) {\r\n                        _addPluginVersions(channels);\r\n                    });\r\n                }\r\n                _addPluginVersions(_configExtensions);\r\n            }\r\n            function _initDefaults() {\r\n                _isInitialized = false;\r\n                // Use a default logger so initialization errors are not dropped on the floor with full logging\r\n                _configHandler = createDynamicConfig({}, defaultConfig, _self[_DYN_LOGGER /* @min:%2elogger */]);\r\n                // Set the logging level to critical so that any critical initialization failures are displayed on the console\r\n                _configHandler.cfg[_DYN_LOGGING_LEVEL_CONSOL4 /* @min:%2eloggingLevelConsole */] = 1 /* eLoggingSeverity.CRITICAL */;\r\n                // Define _self.config\r\n                objDefine(_self, \"config\", {\r\n                    g: function () { return _configHandler.cfg; },\r\n                    s: function (newValue) {\r\n                        _self.updateCfg(newValue, false);\r\n                    }\r\n                });\r\n                objDefine(_self, \"pluginVersionStringArr\", {\r\n                    g: function () {\r\n                        if (!_pluginVersionStringArr) {\r\n                            _setPluginVersions();\r\n                        }\r\n                        return _pluginVersionStringArr;\r\n                    }\r\n                });\r\n                objDefine(_self, \"pluginVersionString\", {\r\n                    g: function () {\r\n                        if (!_pluginVersionString) {\r\n                            if (!_pluginVersionStringArr) {\r\n                                _setPluginVersions();\r\n                            }\r\n                            _pluginVersionString = _pluginVersionStringArr.join(\";\");\r\n                        }\r\n                        return _pluginVersionString || STR_EMPTY;\r\n                    }\r\n                });\r\n                objDefine(_self, \"logger\", {\r\n                    g: function () {\r\n                        if (!_logger) {\r\n                            _logger = new DiagnosticLogger(_configHandler.cfg);\r\n                            _configHandler[_DYN_LOGGER /* @min:%2elogger */] = _logger;\r\n                        }\r\n                        return _logger;\r\n                    },\r\n                    s: function (newLogger) {\r\n                        _configHandler[_DYN_LOGGER /* @min:%2elogger */] = newLogger;\r\n                        if (_logger !== newLogger) {\r\n                            runTargetUnload(_logger, false);\r\n                            _logger = newLogger;\r\n                        }\r\n                    }\r\n                });\r\n                _self[_DYN_LOGGER /* @min:%2elogger */] = new DiagnosticLogger(_configHandler.cfg);\r\n                _extensions = [];\r\n                var cfgExtensions = _self.config[STR_EXTENSIONS /* @min:%2eextensions */] || [];\r\n                cfgExtensions.splice(0, cfgExtensions[_DYN_LENGTH /* @min:%2elength */]);\r\n                arrAppend(cfgExtensions, _extensions);\r\n                _telemetryInitializerPlugin = new TelemetryInitializerPlugin();\r\n                _eventQueue = [];\r\n                runTargetUnload(_notificationManager, false);\r\n                _notificationManager = null;\r\n                _perfManager = null;\r\n                _cfgPerfManager = null;\r\n                runTargetUnload(_cookieManager, false);\r\n                _cookieManager = null;\r\n                _pluginChain = null;\r\n                _configExtensions = [];\r\n                _channelConfig = null;\r\n                _channels = null;\r\n                _isUnloading = false;\r\n                _internalLogsEventName = null;\r\n                _evtNamespace = createUniqueNamespace(\"AIBaseCore\", true);\r\n                _unloadHandlers = createUnloadHandlerContainer();\r\n                _traceCtx = null;\r\n                _instrumentationKey = null;\r\n                _hookContainer = createUnloadHookContainer();\r\n                _cfgListeners = [];\r\n                _pluginVersionString = null;\r\n                _pluginVersionStringArr = null;\r\n                _forceStopInternalLogPoller = false;\r\n                _internalLogPoller = null;\r\n                _internalLogPollerListening = false;\r\n                _activeStatus = 0 /* eActiveStatus.NONE */; // default is None\r\n                _endpoint = null;\r\n                _initInMemoMaxSize = null;\r\n                _isStatusSet = false;\r\n                _initTimer = null;\r\n            }\r\n            function _createTelCtx() {\r\n                var theCtx = createProcessTelemetryContext(_getPluginChain(), _configHandler.cfg, _self);\r\n                theCtx[_DYN_ON_COMPLETE /* @min:%2eonComplete */](_startLogPoller);\r\n                return theCtx;\r\n            }\r\n            // Initialize or Re-initialize the plugins\r\n            function _initPluginChain(updateState) {\r\n                // Extension validation\r\n                var theExtensions = _validateExtensions(_self[_DYN_LOGGER /* @min:%2elogger */], ChannelControllerPriority, _configExtensions);\r\n                _pluginChain = null;\r\n                _pluginVersionString = null;\r\n                _pluginVersionStringArr = null;\r\n                // Get the primary channel queue and include as part of the normal extensions\r\n                _channels = (_channelConfig || [])[0] || [];\r\n                // Add any channels provided in the extensions and sort them\r\n                _channels = sortPlugins(arrAppend(_channels, theExtensions[STR_CHANNELS /* @min:%2echannels */]));\r\n                // Create an array of all extensions, including the _channels\r\n                var allExtensions = arrAppend(sortPlugins(theExtensions[STR_CORE /* @min:%2ecore */]), _channels);\r\n                // Required to allow plugins to call core.getPlugin() during their own initialization\r\n                _extensions = objFreeze(allExtensions);\r\n                // This has a side effect of adding the extensions passed during initialization\r\n                // into the config.extensions, so you can see all of the extensions loaded.\r\n                // This will also get updated by the addPlugin() and remove plugin code.\r\n                var cfgExtensions = _self.config[STR_EXTENSIONS /* @min:%2eextensions */] || [];\r\n                cfgExtensions.splice(0, cfgExtensions[_DYN_LENGTH /* @min:%2elength */]);\r\n                arrAppend(cfgExtensions, _extensions);\r\n                var rootCtx = _createTelCtx();\r\n                // Initializing the channels first\r\n                if (_channels && _channels[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                    initializePlugins(rootCtx[_DYN_CREATE_NEW /* @min:%2ecreateNew */](_channels), allExtensions);\r\n                }\r\n                // Now initialize the normal extensions (explicitly not including the _channels as this can cause duplicate initialization)\r\n                initializePlugins(rootCtx, allExtensions);\r\n                if (updateState) {\r\n                    _doUpdate(updateState);\r\n                }\r\n            }\r\n            function _getPlugin(pluginIdentifier) {\r\n                var theExt = null;\r\n                var thePlugin = null;\r\n                var channelHosts = [];\r\n                arrForEach(_extensions, function (ext) {\r\n                    if (ext[_DYN_IDENTIFIER /* @min:%2eidentifier */] === pluginIdentifier && ext !== _telemetryInitializerPlugin) {\r\n                        thePlugin = ext;\r\n                        return -1;\r\n                    }\r\n                    if (ext.getChannel) {\r\n                        channelHosts[_DYN_PUSH /* @min:%2epush */](ext);\r\n                    }\r\n                });\r\n                if (!thePlugin && channelHosts[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                    arrForEach(channelHosts, function (host) {\r\n                        thePlugin = host.getChannel(pluginIdentifier);\r\n                        if (!thePlugin) {\r\n                            return -1;\r\n                        }\r\n                    });\r\n                }\r\n                if (thePlugin) {\r\n                    theExt = {\r\n                        plugin: thePlugin,\r\n                        setEnabled: function (enabled) {\r\n                            _getPluginState(thePlugin)[STR_DISABLED] = !enabled;\r\n                        },\r\n                        isEnabled: function () {\r\n                            var pluginState = _getPluginState(thePlugin);\r\n                            return !pluginState[_DYN_TEARDOWN /* @min:%2eteardown */] && !pluginState[STR_DISABLED];\r\n                        },\r\n                        remove: function (isAsync, removeCb) {\r\n                            var _a;\r\n                            if (isAsync === void 0) { isAsync = true; }\r\n                            var pluginsToRemove = [thePlugin];\r\n                            var unloadState = (_a = {\r\n                                    reason: 1 /* TelemetryUnloadReason.PluginUnload */\r\n                                },\r\n                                _a[_DYN_IS_ASYNC /* @min:isAsync */] = isAsync,\r\n                                _a);\r\n                            _removePlugins(pluginsToRemove, unloadState, function (removed) {\r\n                                if (removed) {\r\n                                    // Re-Initialize the plugin chain\r\n                                    _initPluginChain({\r\n                                        reason: 32 /* TelemetryUpdateReason.PluginRemoved */,\r\n                                        removed: pluginsToRemove\r\n                                    });\r\n                                }\r\n                                removeCb && removeCb(removed);\r\n                            });\r\n                        }\r\n                    };\r\n                }\r\n                return theExt;\r\n            }\r\n            function _getPluginChain() {\r\n                if (!_pluginChain) {\r\n                    // copy the collection of extensions\r\n                    var extensions = (_extensions || []).slice();\r\n                    // During add / remove this may get called again, so don't read if already present\r\n                    if (arrIndexOf(extensions, _telemetryInitializerPlugin) === -1) {\r\n                        extensions[_DYN_PUSH /* @min:%2epush */](_telemetryInitializerPlugin);\r\n                    }\r\n                    _pluginChain = createTelemetryProxyChain(sortPlugins(extensions), _configHandler.cfg, _self);\r\n                }\r\n                return _pluginChain;\r\n            }\r\n            function _removePlugins(thePlugins, unloadState, removeComplete) {\r\n                if (thePlugins && thePlugins[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                    var unloadChain = createTelemetryProxyChain(thePlugins, _configHandler.cfg, _self);\r\n                    var unloadCtx = createProcessTelemetryUnloadContext(unloadChain, _self);\r\n                    unloadCtx[_DYN_ON_COMPLETE /* @min:%2eonComplete */](function () {\r\n                        var removed = false;\r\n                        // Remove the listed config extensions\r\n                        var newConfigExtensions = [];\r\n                        arrForEach(_configExtensions, function (plugin, idx) {\r\n                            if (!_isPluginPresent(plugin, thePlugins)) {\r\n                                newConfigExtensions[_DYN_PUSH /* @min:%2epush */](plugin);\r\n                            }\r\n                            else {\r\n                                removed = true;\r\n                            }\r\n                        });\r\n                        _configExtensions = newConfigExtensions;\r\n                        _pluginVersionString = null;\r\n                        _pluginVersionStringArr = null;\r\n                        // Re-Create the channel config\r\n                        var newChannelConfig = [];\r\n                        if (_channelConfig) {\r\n                            arrForEach(_channelConfig, function (queue, idx) {\r\n                                var newQueue = [];\r\n                                arrForEach(queue, function (channel) {\r\n                                    if (!_isPluginPresent(channel, thePlugins)) {\r\n                                        newQueue[_DYN_PUSH /* @min:%2epush */](channel);\r\n                                    }\r\n                                    else {\r\n                                        removed = true;\r\n                                    }\r\n                                });\r\n                                newChannelConfig[_DYN_PUSH /* @min:%2epush */](newQueue);\r\n                            });\r\n                            _channelConfig = newChannelConfig;\r\n                        }\r\n                        removeComplete && removeComplete(removed);\r\n                        _startLogPoller();\r\n                    });\r\n                    unloadCtx[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](unloadState);\r\n                }\r\n                else {\r\n                    removeComplete(false);\r\n                }\r\n            }\r\n            function _flushInternalLogs() {\r\n                if (_logger && _logger.queue) {\r\n                    var queue = _logger.queue.slice(0);\r\n                    _logger.queue[_DYN_LENGTH /* @min:%2elength */] = 0;\r\n                    arrForEach(queue, function (logMessage) {\r\n                        var _a;\r\n                        var item = (_a = {},\r\n                            _a[_DYN_NAME /* @min:name */] = _internalLogsEventName ? _internalLogsEventName : \"InternalMessageId: \" + logMessage[_DYN_MESSAGE_ID /* @min:%2emessageId */],\r\n                            _a[_DYN_I_KEY /* @min:iKey */] = _instrumentationKey,\r\n                            _a[_DYN_TIME /* @min:time */] = toISOString(new Date()),\r\n                            _a.baseType = _InternalLogMessage.dataType,\r\n                            _a.baseData = { message: logMessage[_DYN_MESSAGE /* @min:%2emessage */] },\r\n                            _a);\r\n                        _self.track(item);\r\n                    });\r\n                }\r\n            }\r\n            function _flushChannels(isAsync, callBack, sendReason, cbTimeout) {\r\n                // Setting waiting to one so that we don't call the callBack until we finish iterating\r\n                var waiting = 1;\r\n                var doneIterating = false;\r\n                var cbTimer = null;\r\n                cbTimeout = cbTimeout || 5000;\r\n                function doCallback() {\r\n                    waiting--;\r\n                    if (doneIterating && waiting === 0) {\r\n                        cbTimer && cbTimer[_DYN_CANCEL /* @min:%2ecancel */]();\r\n                        cbTimer = null;\r\n                        callBack && callBack(doneIterating);\r\n                        callBack = null;\r\n                    }\r\n                }\r\n                if (_channels && _channels[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                    var flushCtx = _createTelCtx()[_DYN_CREATE_NEW /* @min:%2ecreateNew */](_channels);\r\n                    flushCtx.iterate(function (plugin) {\r\n                        if (plugin.flush) {\r\n                            waiting++;\r\n                            var handled_1 = false;\r\n                            // Not all channels will call this callback for every scenario\r\n                            if (!plugin.flush(isAsync, function () {\r\n                                handled_1 = true;\r\n                                doCallback();\r\n                            }, sendReason)) {\r\n                                if (!handled_1) {\r\n                                    // If any channel doesn't return true and it didn't call the callback, then we should assume that the callback\r\n                                    // will never be called, so use a timeout to allow the channel(s) some time to \"finish\" before triggering any\r\n                                    // followup function (such as unloading)\r\n                                    if (isAsync && cbTimer == null) {\r\n                                        cbTimer = scheduleTimeout(function () {\r\n                                            cbTimer = null;\r\n                                            doCallback();\r\n                                        }, cbTimeout);\r\n                                    }\r\n                                    else {\r\n                                        doCallback();\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n                doneIterating = true;\r\n                doCallback();\r\n                return true;\r\n            }\r\n            function _initPerfManager() {\r\n                // Save the previous config based performance manager creator to avoid creating new perf manager instances if unchanged\r\n                var prevCfgPerfMgr;\r\n                // Will get recalled if any referenced config values are changed\r\n                _addUnloadHook(_configHandler[_DYN_WATCH /* @min:%2ewatch */](function (details) {\r\n                    var enablePerfMgr = details.cfg.enablePerfMgr;\r\n                    if (enablePerfMgr) {\r\n                        var createPerfMgr = details.cfg[STR_CREATE_PERF_MGR /* @min:%2ecreatePerfMgr */];\r\n                        // for preCfgPerfMgr = createPerfMgr = null\r\n                        // initial createPerfMgr function should be _createPerfManager\r\n                        if ((prevCfgPerfMgr !== createPerfMgr) || !prevCfgPerfMgr) {\r\n                            if (!createPerfMgr) {\r\n                                createPerfMgr = _createPerfManager;\r\n                            }\r\n                            // Set the performance manager creation function if not defined\r\n                            getSetValue(details.cfg, STR_CREATE_PERF_MGR, createPerfMgr);\r\n                            prevCfgPerfMgr = createPerfMgr;\r\n                            // Remove any existing config based performance manager\r\n                            _cfgPerfManager = null;\r\n                        }\r\n                        // Only create the performance manager if it's not already created or manually set\r\n                        if (!_perfManager && !_cfgPerfManager && isFunction(createPerfMgr)) {\r\n                            // Create a new config based performance manager\r\n                            _cfgPerfManager = createPerfMgr(_self, _self[_DYN_GET_NOTIFY_MGR /* @min:%2egetNotifyMgr */]());\r\n                        }\r\n                    }\r\n                    else {\r\n                        // Remove any existing config based performance manager\r\n                        _cfgPerfManager = null;\r\n                        // Clear the previous cached value so it can be GC'd\r\n                        prevCfgPerfMgr = null;\r\n                    }\r\n                }));\r\n            }\r\n            function _doUpdate(updateState) {\r\n                var updateCtx = createProcessTelemetryUpdateContext(_getPluginChain(), _self);\r\n                updateCtx[_DYN_ON_COMPLETE /* @min:%2eonComplete */](_startLogPoller);\r\n                if (!_self._updateHook || _self._updateHook(updateCtx, updateState) !== true) {\r\n                    updateCtx[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](updateState);\r\n                }\r\n            }\r\n            function _logOrThrowError(message) {\r\n                var logger = _self[_DYN_LOGGER /* @min:%2elogger */];\r\n                if (logger) {\r\n                    // there should always be a logger\r\n                    _throwInternal(logger, 2 /* eLoggingSeverity.WARNING */, 73 /* _eInternalMessageId.PluginException */, message);\r\n                    _startLogPoller();\r\n                }\r\n                else {\r\n                    throwError(message);\r\n                }\r\n            }\r\n            function _notifyInvalidEvent(telemetryItem) {\r\n                var manager = _self[_DYN_GET_NOTIFY_MGR /* @min:%2egetNotifyMgr */]();\r\n                if (manager) {\r\n                    manager[STR_EVENTS_DISCARDED /* @min:%2eeventsDiscarded */]([telemetryItem], 2 /* eEventsDiscardedReason.InvalidEvent */);\r\n                }\r\n            }\r\n            function _addUnloadHook(hooks) {\r\n                _hookContainer.add(hooks);\r\n            }\r\n        });\r\n    }\r\n// Removed Stub for AppInsightsCore.prototype.initialize.\r\n// Removed Stub for AppInsightsCore.prototype.getChannels.\r\n// Removed Stub for AppInsightsCore.prototype.track.\r\n// Removed Stub for AppInsightsCore.prototype.getProcessTelContext.\r\n// Removed Stub for AppInsightsCore.prototype.getNotifyMgr.\r\n// Removed Stub for AppInsightsCore.prototype.addNotificationListener.\r\n// Removed Stub for AppInsightsCore.prototype.removeNotificationListener.\r\n// Removed Stub for AppInsightsCore.prototype.getCookieMgr.\r\n// Removed Stub for AppInsightsCore.prototype.setCookieMgr.\r\n// Removed Stub for AppInsightsCore.prototype.getPerfMgr.\r\n// Removed Stub for AppInsightsCore.prototype.setPerfMgr.\r\n// Removed Stub for AppInsightsCore.prototype.eventCnt.\r\n// Removed Stub for AppInsightsCore.prototype.pollInternalLogs.\r\n// Removed Stub for AppInsightsCore.prototype.stopPollingInternalLogs.\r\n// Removed Stub for AppInsightsCore.prototype.addTelemetryInitializer.\r\n// Removed Stub for AppInsightsCore.prototype.unload.\r\n// Removed Stub for AppInsightsCore.prototype.getPlugin.\r\n// Removed Stub for AppInsightsCore.prototype.addPlugin.\r\n// Removed Stub for AppInsightsCore.prototype.updateCfg.\r\n// Removed Stub for AppInsightsCore.prototype.evtNamespace.\r\n// Removed Stub for AppInsightsCore.prototype.addUnloadCb.\r\n// Removed Stub for AppInsightsCore.prototype.flush.\r\n// Removed Stub for AppInsightsCore.prototype.getTraceCtx.\r\n// Removed Stub for AppInsightsCore.prototype.setTraceCtx.\r\n// Removed Stub for AppInsightsCore.prototype.addUnloadHook.\r\n// Removed Stub for AppInsightsCore.prototype.onCfgChange.\r\n// Removed Stub for AppInsightsCore.prototype.activeStatus.\r\n// Removed Stub for AppInsightsCore.prototype._setPendingStatus.\r\n// Removed Stub for AppInsightsCore.prototype.releaseQueue.\r\n// Removed Stub for AppInsightsCore.prototype._updateHook.\r\n    // This is a workaround for an IE bug when using dynamicProto() with classes that don't have any\n    // non-dynamic functions or static properties/functions when using uglify-js to minify the resulting code.\n    AppInsightsCore.__ieDyn=1;\n\n    return AppInsightsCore;\r\n}());\r\nexport { AppInsightsCore };\r\n//# sourceMappingURL=AppInsightsCore.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n// \r\n// \r\nimport { __extendsFn as __extends } from \"@microsoft/applicationinsights-shims\";\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { arrAppend, arrForEach, dumpObj } from \"@nevware21/ts-utils\";\r\nimport { _DYN_APPLY, _DYN_DIAG_LOG, _DYN_LENGTH, _DYN_PROCESS_NEXT, _DYN_SPLICE, _DYN__DO_TEARDOWN } from \"../__DynamicConstants\";\r\nimport { BaseTelemetryPlugin } from \"./BaseTelemetryPlugin\";\r\nimport { _throwInternal } from \"./DiagnosticLogger\";\r\nimport { getExceptionName } from \"./HelperFuncs\";\r\nimport { STR_PROCESS_TELEMETRY } from \"./InternalConstants\";\r\nfunction _addInitializer(_initializers, id, telemetryInitializer) {\r\n    var theInitializer = {\r\n        id: id,\r\n        fn: telemetryInitializer\r\n    };\r\n    arrAppend(_initializers, theInitializer);\r\n    var handler = {\r\n        remove: function () {\r\n            arrForEach(_initializers, function (initializer, idx) {\r\n                if (initializer.id === theInitializer.id) {\r\n                    _initializers[_DYN_SPLICE /* @min:%2esplice */](idx, 1);\r\n                    return -1;\r\n                }\r\n            });\r\n        }\r\n    };\r\n    return handler;\r\n}\r\nfunction _runInitializers(_initializers, item, logger) {\r\n    var doNotSendItem = false;\r\n    var telemetryInitializersCount = _initializers[_DYN_LENGTH /* @min:%2elength */];\r\n    for (var i = 0; i < telemetryInitializersCount; ++i) {\r\n        var telemetryInitializer = _initializers[i];\r\n        if (telemetryInitializer) {\r\n            try {\r\n                if (telemetryInitializer.fn[_DYN_APPLY /* @min:%2eapply */](null, [item]) === false) {\r\n                    doNotSendItem = true;\r\n                    break;\r\n                }\r\n            }\r\n            catch (e) {\r\n                // log error but dont stop executing rest of the telemetry initializers\r\n                // doNotSendItem = true;\r\n                _throwInternal(logger, 2 /* eLoggingSeverity.WARNING */, 64 /* _eInternalMessageId.TelemetryInitializerFailed */, \"Telemetry initializer failed: \" + getExceptionName(e), { exception: dumpObj(e) }, true);\r\n            }\r\n        }\r\n    }\r\n    return !doNotSendItem;\r\n}\r\nvar TelemetryInitializerPlugin = /** @class */ (function (_super) {\r\n    __extends(TelemetryInitializerPlugin, _super);\r\n    function TelemetryInitializerPlugin() {\r\n        var _this = _super.call(this) || this;\r\n        _this.identifier = \"TelemetryInitializerPlugin\";\r\n        _this.priority = 199;\r\n        // NOTE!: DON'T set default values here, instead set them in the _initDefaults() function as it is also called during teardown()\r\n        var _id;\r\n        var _initializers;\r\n        _initDefaults();\r\n        dynamicProto(TelemetryInitializerPlugin, _this, function (_self, _base) {\r\n            _self.addTelemetryInitializer = function (telemetryInitializer) {\r\n                return _addInitializer(_initializers, _id++, telemetryInitializer);\r\n            };\r\n            _self[STR_PROCESS_TELEMETRY /* @min:%2eprocessTelemetry */] = function (item, itemCtx) {\r\n                if (_runInitializers(_initializers, item, itemCtx ? itemCtx[_DYN_DIAG_LOG /* @min:%2ediagLog */]() : _self[_DYN_DIAG_LOG /* @min:%2ediagLog */]())) {\r\n                    _self[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](item, itemCtx);\r\n                }\r\n            };\r\n            _self[_DYN__DO_TEARDOWN /* @min:%2e_doTeardown */] = function () {\r\n                _initDefaults();\r\n            };\r\n        });\r\n        function _initDefaults() {\r\n            _id = 0;\r\n            _initializers = [];\r\n        }\r\n        return _this;\r\n    }\r\n// Removed Stub for TelemetryInitializerPlugin.prototype.addTelemetryInitializer.\r\n// Removed Stub for TelemetryInitializerPlugin.prototype.processTelemetry.\r\n    // This is a workaround for an IE bug when using dynamicProto() with classes that don't have any\n    // non-dynamic functions or static properties/functions when using uglify-js to minify the resulting code.\n    TelemetryInitializerPlugin.__ieDyn=1;\n\n    return TelemetryInitializerPlugin;\r\n}(BaseTelemetryPlugin));\r\nexport { TelemetryInitializerPlugin };\r\n//# sourceMappingURL=TelemetryInitializerPlugin.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { createPromise, doAwaitResponse } from \"@nevware21/ts-async\";\r\nimport { arrSlice, getLength } from \"@nevware21/ts-utils\";\r\nimport { _DYN_UNLOAD } from \"../__DynamicConstants\";\r\n/**\r\n * Run the unload function of the target object if it exists\r\n * @param target - The target object that contains the unload function\r\n * @param isAsync - The caller identifies whether it is expecting the operation to complete synchronously or asynchronously. Even\r\n * if the caller is not waiting the operation may still be performed asynchronously depending on the component and the reverse is\r\n * also true.\r\n * @returns The result of the target function\r\n */\r\nexport function runTargetUnload(target, isAsync) {\r\n    if (target && target[_DYN_UNLOAD /* @min:%2eunload */]) {\r\n        return target[_DYN_UNLOAD /* @min:%2eunload */](isAsync);\r\n    }\r\n}\r\n/**\r\n * Call the unload function on all targets handling any returned [IPromise](https://nevware21.github.io/ts-async/typedoc/interfaces/IPromise.html)\r\n * / Promise before calling the next targets unload\r\n * @param targets - An array of the targets to unload\r\n * @param isAsync - The caller identifies whether it is expecting the operations to complete synchronously or asynchronously.  Even\r\n * if the caller is not waiting the operation may still be performed asynchronously depending on the component and the reverse is\r\n * also true.\r\n * @param done - Optional callback function to call once all of the unload functions have been called.\r\n */\r\nexport function doUnloadAll(targets, isAsync, done) {\r\n    var result;\r\n    if (!done) {\r\n        result = createPromise(function (resolved) {\r\n            done = resolved;\r\n        });\r\n    }\r\n    if (targets && getLength(targets) > 0) {\r\n        doAwaitResponse(runTargetUnload(targets[0], isAsync), function () {\r\n            doUnloadAll(arrSlice(targets, 1), isAsync, done);\r\n        });\r\n    }\r\n    else {\r\n        done();\r\n    }\r\n    return result;\r\n}\r\n//# sourceMappingURL=AsyncUtils.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\n\"use strict\";\r\nvar _a;\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { isFunction, objDefine } from \"@nevware21/ts-utils\";\r\nimport { createDynamicConfig } from \"../Config/DynamicConfig\";\r\nimport { _DYN_CREATE_NEW, _DYN_DIAG_LOG, _DYN_GET_NEXT, _DYN_GET_PROCESS_TEL_CONT2, _DYN_INITIALIZE, _DYN_IS_ASYNC, _DYN_IS_INITIALIZED, _DYN_PROCESS_NEXT, _DYN_SET_NEXT_PLUGIN, _DYN_TEARDOWN, _DYN_UPDATE, _DYN__DO_TEARDOWN } from \"../__DynamicConstants\";\r\nimport { safeGetLogger } from \"./DiagnosticLogger\";\r\nimport { isNotNullOrUndefined, proxyFunctionAs } from \"./HelperFuncs\";\r\nimport { STR_CORE, STR_EXTENSION_CONFIG, STR_PROCESS_TELEMETRY } from \"./InternalConstants\";\r\nimport { createProcessTelemetryContext, createProcessTelemetryUnloadContext, createProcessTelemetryUpdateContext } from \"./ProcessTelemetryContext\";\r\nimport { createUnloadHandlerContainer } from \"./UnloadHandlerContainer\";\r\nimport { createUnloadHookContainer } from \"./UnloadHookContainer\";\r\nvar strGetPlugin = \"getPlugin\";\r\nvar defaultValues = (_a = {},\r\n    _a[STR_EXTENSION_CONFIG] = { isVal: isNotNullOrUndefined, v: {} },\r\n    _a);\r\n/**\r\n * BaseTelemetryPlugin provides a basic implementation of the ITelemetryPlugin interface so that plugins\r\n * can avoid implementation the same set of boiler plate code as well as provide a base\r\n * implementation so that new default implementations can be added without breaking all plugins.\r\n */\r\nvar BaseTelemetryPlugin = /** @class */ (function () {\r\n    function BaseTelemetryPlugin() {\r\n        var _self = this; // Setting _self here as it's used outside of the dynamicProto as well\r\n        // NOTE!: DON'T set default values here, instead set them in the _initDefaults() function as it is also called during teardown()\r\n        var _isinitialized;\r\n        var _rootCtx; // Used as the root context, holding the current config and initialized core\r\n        var _nextPlugin; // Used for backward compatibility where plugins don't call the main pipeline\r\n        var _unloadHandlerContainer;\r\n        var _hookContainer;\r\n        _initDefaults();\r\n        dynamicProto(BaseTelemetryPlugin, _self, function (_self) {\r\n            _self[_DYN_INITIALIZE /* @min:%2einitialize */] = function (config, core, extensions, pluginChain) {\r\n                _setDefaults(config, core, pluginChain);\r\n                _isinitialized = true;\r\n            };\r\n            _self[_DYN_TEARDOWN /* @min:%2eteardown */] = function (unloadCtx, unloadState) {\r\n                var _a;\r\n                // If this plugin has already been torn down (not operational) or is not initialized (core is not set)\r\n                // or the core being used for unload was not the same core used for initialization.\r\n                var core = _self[STR_CORE /* @min:%2ecore */];\r\n                if (!core || (unloadCtx && core !== unloadCtx[STR_CORE /* @min:%2ecore */]())) {\r\n                    // Do Nothing as either the plugin is not initialized or was not initialized by the current core\r\n                    return;\r\n                }\r\n                var result;\r\n                var unloadDone = false;\r\n                var theUnloadCtx = unloadCtx || createProcessTelemetryUnloadContext(null, core, _nextPlugin && _nextPlugin[strGetPlugin] ? _nextPlugin[strGetPlugin]() : _nextPlugin);\r\n                var theUnloadState = unloadState || (_a = {\r\n                        reason: 0 /* TelemetryUnloadReason.ManualTeardown */\r\n                    },\r\n                    _a[_DYN_IS_ASYNC /* @min:isAsync */] = false,\r\n                    _a);\r\n                function _unloadCallback() {\r\n                    if (!unloadDone) {\r\n                        unloadDone = true;\r\n                        _unloadHandlerContainer.run(theUnloadCtx, unloadState);\r\n                        _hookContainer.run(theUnloadCtx[_DYN_DIAG_LOG /* @min:%2ediagLog */]());\r\n                        if (result === true) {\r\n                            theUnloadCtx[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](theUnloadState);\r\n                        }\r\n                        _initDefaults();\r\n                    }\r\n                }\r\n                if (!_self[_DYN__DO_TEARDOWN /* @min:%2e_doTeardown */] || _self[_DYN__DO_TEARDOWN /* @min:%2e_doTeardown */](theUnloadCtx, theUnloadState, _unloadCallback) !== true) {\r\n                    _unloadCallback();\r\n                }\r\n                else {\r\n                    // Tell the caller that we will be calling processNext()\r\n                    result = true;\r\n                }\r\n                return result;\r\n            };\r\n            _self[_DYN_UPDATE /* @min:%2eupdate */] = function (updateCtx, updateState) {\r\n                // If this plugin has already been torn down (not operational) or is not initialized (core is not set)\r\n                // or the core being used for unload was not the same core used for initialization.\r\n                var core = _self[STR_CORE /* @min:%2ecore */];\r\n                if (!core || (updateCtx && core !== updateCtx[STR_CORE /* @min:%2ecore */]())) {\r\n                    // Do Nothing\r\n                    return;\r\n                }\r\n                var result;\r\n                var updateDone = false;\r\n                var theUpdateCtx = updateCtx || createProcessTelemetryUpdateContext(null, core, _nextPlugin && _nextPlugin[strGetPlugin] ? _nextPlugin[strGetPlugin]() : _nextPlugin);\r\n                var theUpdateState = updateState || {\r\n                    reason: 0 /* TelemetryUpdateReason.Unknown */\r\n                };\r\n                function _updateCallback() {\r\n                    if (!updateDone) {\r\n                        updateDone = true;\r\n                        _setDefaults(theUpdateCtx.getCfg(), theUpdateCtx.core(), theUpdateCtx[_DYN_GET_NEXT /* @min:%2egetNext */]());\r\n                    }\r\n                }\r\n                if (!_self._doUpdate || _self._doUpdate(theUpdateCtx, theUpdateState, _updateCallback) !== true) {\r\n                    _updateCallback();\r\n                }\r\n                else {\r\n                    result = true;\r\n                }\r\n                return result;\r\n            };\r\n            proxyFunctionAs(_self, \"_addUnloadCb\", function () { return _unloadHandlerContainer; }, \"add\");\r\n            proxyFunctionAs(_self, \"_addHook\", function () { return _hookContainer; }, \"add\");\r\n            objDefine(_self, \"_unloadHooks\", { g: function () { return _hookContainer; } });\r\n        });\r\n        // These are added after the dynamicProto so that are not moved to the prototype\r\n        _self[_DYN_DIAG_LOG /* @min:%2ediagLog */] = function (itemCtx) {\r\n            return _getTelCtx(itemCtx)[_DYN_DIAG_LOG /* @min:%2ediagLog */]();\r\n        };\r\n        _self[_DYN_IS_INITIALIZED /* @min:%2eisInitialized */] = function () {\r\n            return _isinitialized;\r\n        };\r\n        _self.setInitialized = function (isInitialized) {\r\n            _isinitialized = isInitialized;\r\n        };\r\n        // _self.getNextPlugin = () => DO NOT IMPLEMENT\r\n        // Sub-classes of this base class *should* not be relying on this value and instead\r\n        // should use processNext() function. If you require access to the plugin use the\r\n        // IProcessTelemetryContext.getNext().getPlugin() while in the pipeline, Note getNext() may return null.\r\n        _self[_DYN_SET_NEXT_PLUGIN /* @min:%2esetNextPlugin */] = function (next) {\r\n            _nextPlugin = next;\r\n        };\r\n        _self[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */] = function (env, itemCtx) {\r\n            if (itemCtx) {\r\n                // Normal core execution sequence\r\n                itemCtx[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](env);\r\n            }\r\n            else if (_nextPlugin && isFunction(_nextPlugin[STR_PROCESS_TELEMETRY /* @min:%2eprocessTelemetry */])) {\r\n                // Looks like backward compatibility or out of band processing. And as it looks\r\n                // like a ITelemetryPlugin or ITelemetryPluginChain, just call processTelemetry\r\n                _nextPlugin[STR_PROCESS_TELEMETRY /* @min:%2eprocessTelemetry */](env, null);\r\n            }\r\n        };\r\n        _self._getTelCtx = _getTelCtx;\r\n        function _getTelCtx(currentCtx) {\r\n            if (currentCtx === void 0) { currentCtx = null; }\r\n            var itemCtx = currentCtx;\r\n            if (!itemCtx) {\r\n                var rootCtx = _rootCtx || createProcessTelemetryContext(null, {}, _self[STR_CORE /* @min:%2ecore */]);\r\n                // tslint:disable-next-line: prefer-conditional-expression\r\n                if (_nextPlugin && _nextPlugin[strGetPlugin]) {\r\n                    // Looks like a chain object\r\n                    itemCtx = rootCtx[_DYN_CREATE_NEW /* @min:%2ecreateNew */](null, _nextPlugin[strGetPlugin]);\r\n                }\r\n                else {\r\n                    itemCtx = rootCtx[_DYN_CREATE_NEW /* @min:%2ecreateNew */](null, _nextPlugin);\r\n                }\r\n            }\r\n            return itemCtx;\r\n        }\r\n        function _setDefaults(config, core, pluginChain) {\r\n            // Make sure the extensionConfig exists and the config is dynamic\r\n            createDynamicConfig(config, defaultValues, safeGetLogger(core));\r\n            if (!pluginChain && core) {\r\n                // Get the first plugin from the core\r\n                pluginChain = core[_DYN_GET_PROCESS_TEL_CONT2 /* @min:%2egetProcessTelContext */]()[_DYN_GET_NEXT /* @min:%2egetNext */]();\r\n            }\r\n            var nextPlugin = _nextPlugin;\r\n            if (_nextPlugin && _nextPlugin[strGetPlugin]) {\r\n                // If it looks like a proxy/chain then get the plugin\r\n                nextPlugin = _nextPlugin[strGetPlugin]();\r\n            }\r\n            // Support legacy plugins where core was defined as a property\r\n            _self[STR_CORE /* @min:%2ecore */] = core;\r\n            _rootCtx = createProcessTelemetryContext(pluginChain, config, core, nextPlugin);\r\n        }\r\n        function _initDefaults() {\r\n            _isinitialized = false;\r\n            _self[STR_CORE /* @min:%2ecore */] = null;\r\n            _rootCtx = null;\r\n            _nextPlugin = null;\r\n            _hookContainer = createUnloadHookContainer();\r\n            _unloadHandlerContainer = createUnloadHandlerContainer();\r\n        }\r\n    }\r\n// Removed Stub for BaseTelemetryPlugin.prototype.initialize.\r\n// Removed Stub for BaseTelemetryPlugin.prototype.teardown.\r\n// Removed Stub for BaseTelemetryPlugin.prototype.update.\r\n// Removed Stub for BaseTelemetryPlugin.prototype._addUnloadCb.\r\n// Removed Stub for BaseTelemetryPlugin.prototype._addHook.\r\n    // This is a workaround for an IE bug when using dynamicProto() with classes that don't have any\n    // non-dynamic functions or static properties/functions when using uglify-js to minify the resulting code.\n    BaseTelemetryPlugin.__ieDyn=1;\n\n    return BaseTelemetryPlugin;\r\n}());\r\nexport { BaseTelemetryPlugin };\r\n//# sourceMappingURL=BaseTelemetryPlugin.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nexport var ChannelControllerPriority = 500;\r\nexport var DisabledPropertyName = \"Microsoft_ApplicationInsights_BypassAjaxInstrumentation\";\r\n// export const SampleRate = \"sampleRate\";\r\n// export const ProcessLegacy = \"ProcessLegacy\";\r\n// export const HttpMethod = \"http.method\";\r\n// export const DEFAULT_BREEZE_ENDPOINT = \"https://dc.services.visualstudio.com\";\r\n// export const DEFAULT_BREEZE_PATH = \"/v2/track\";\r\n// export const strNotSpecified = \"not_specified\";\r\n// export const strIkey = \"iKey\";\r\n//# sourceMappingURL=Constants.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\nvar _a, _b;\r\nimport { arrForEach, arrIndexOf, dumpObj, getDocument, getLazy, getNavigator, isArray, isFunction, isNullOrUndefined, isString, isTruthy, isUndefined, objForEachKey, strEndsWith, strIndexOf, strLeft, strSubstring, strTrim, utcNow } from \"@nevware21/ts-utils\";\r\nimport { cfgDfMerge } from \"../Config/ConfigDefaultHelpers\";\r\nimport { createDynamicConfig, onConfigChange } from \"../Config/DynamicConfig\";\r\nimport { _DYN_ENABLED, _DYN_LENGTH, _DYN_LOGGER, _DYN_PROTOCOL, _DYN_SET_DF, _DYN_SPLIT, _DYN_UNLOAD, _DYN_USER_AGENT } from \"../__DynamicConstants\";\r\nimport { _throwInternal } from \"./DiagnosticLogger\";\r\nimport { getLocation, isIE } from \"./EnvUtils\";\r\nimport { getExceptionName, isNotNullOrUndefined, setValue, strContains } from \"./HelperFuncs\";\r\nimport { STR_DOMAIN, STR_EMPTY, STR_PATH, UNDEFINED_VALUE } from \"./InternalConstants\";\r\nvar strToGMTString = \"toGMTString\";\r\nvar strToUTCString = \"toUTCString\";\r\nvar strCookie = \"cookie\";\r\nvar strExpires = \"expires\";\r\nvar strIsCookieUseDisabled = \"isCookieUseDisabled\";\r\nvar strDisableCookiesUsage = \"disableCookiesUsage\";\r\nvar strConfigCookieMgr = \"_ckMgr\";\r\nvar _supportsCookies = null;\r\nvar _allowUaSameSite = null;\r\nvar _parsedCookieValue = null;\r\nvar _doc;\r\nvar _cookieCache = {};\r\nvar _globalCookieConfig = {};\r\n// // `isCookieUseDisabled` is deprecated, so explicitly casting as a key of IConfiguration to avoid typing error\r\n// // when both isCookieUseDisabled and disableCookiesUsage are used disableCookiesUsage will take precedent, which is\r\n// // why its listed first\r\n/**\r\n * Set the supported dynamic config values as undefined (or an empty object) so that\r\n * any listeners will be informed of any changes.\r\n * Explicitly NOT including the deprecated `isCookieUseDisabled` as we don't want to support\r\n * the v1 deprecated field as dynamic for updates\r\n */\r\nvar rootDefaultConfig = (_a = {\r\n        cookieCfg: cfgDfMerge((_b = {},\r\n            _b[STR_DOMAIN] = { fb: \"cookieDomain\", dfVal: isNotNullOrUndefined },\r\n            _b.path = { fb: \"cookiePath\", dfVal: isNotNullOrUndefined },\r\n            _b.enabled = UNDEFINED_VALUE,\r\n            _b.ignoreCookies = UNDEFINED_VALUE,\r\n            _b.blockedCookies = UNDEFINED_VALUE,\r\n            _b)),\r\n        cookieDomain: UNDEFINED_VALUE,\r\n        cookiePath: UNDEFINED_VALUE\r\n    },\r\n    _a[strDisableCookiesUsage] = UNDEFINED_VALUE,\r\n    _a);\r\nfunction _getDoc() {\r\n    !_doc && (_doc = getLazy(function () { return getDocument(); }));\r\n}\r\n/**\r\n * @ignore\r\n * DO NOT USE or export from the module, this is exposed as public to support backward compatibility of previous static utility methods only.\r\n * If you want to manager cookies either use the ICookieMgr available from the core instance via getCookieMgr() or create\r\n * your own instance of the CookieMgr and use that.\r\n * Using this directly for enabling / disabling cookie handling will not only affect your usage but EVERY user of cookies.\r\n * Example, if you are using a shared component that is also using Application Insights you will affect their cookie handling.\r\n * @param logger - The DiagnosticLogger to use for reporting errors.\r\n */\r\nfunction _gblCookieMgr(config, logger) {\r\n    // Stash the global instance against the BaseCookieMgr class\r\n    var inst = createCookieMgr[strConfigCookieMgr] || _globalCookieConfig[strConfigCookieMgr];\r\n    if (!inst) {\r\n        // Note: not using the getSetValue() helper as that would require always creating a temporary cookieMgr\r\n        // that ultimately is never used\r\n        inst = createCookieMgr[strConfigCookieMgr] = createCookieMgr(config, logger);\r\n        _globalCookieConfig[strConfigCookieMgr] = inst;\r\n    }\r\n    return inst;\r\n}\r\nfunction _isMgrEnabled(cookieMgr) {\r\n    if (cookieMgr) {\r\n        return cookieMgr.isEnabled();\r\n    }\r\n    return true;\r\n}\r\nfunction _isIgnoredCookie(cookieMgrCfg, name) {\r\n    if (name && cookieMgrCfg && isArray(cookieMgrCfg.ignoreCookies)) {\r\n        return arrIndexOf(cookieMgrCfg.ignoreCookies, name) !== -1;\r\n    }\r\n    return false;\r\n}\r\nfunction _isBlockedCookie(cookieMgrCfg, name) {\r\n    if (name && cookieMgrCfg && isArray(cookieMgrCfg.blockedCookies)) {\r\n        if (arrIndexOf(cookieMgrCfg.blockedCookies, name) !== -1) {\r\n            return true;\r\n        }\r\n    }\r\n    return _isIgnoredCookie(cookieMgrCfg, name);\r\n}\r\nfunction _isCfgEnabled(rootConfig, cookieMgrConfig) {\r\n    var isCfgEnabled = cookieMgrConfig[_DYN_ENABLED /* @min:%2eenabled */];\r\n    if (isNullOrUndefined(isCfgEnabled)) {\r\n        // Set the enabled from the provided setting or the legacy root values\r\n        var cookieEnabled = void 0;\r\n        // This field is deprecated and dynamic updates will not be fully supported\r\n        if (!isUndefined(rootConfig[strIsCookieUseDisabled])) {\r\n            cookieEnabled = !rootConfig[strIsCookieUseDisabled];\r\n        }\r\n        // If this value is defined it takes precedent over the above\r\n        if (!isUndefined(rootConfig[strDisableCookiesUsage])) {\r\n            cookieEnabled = !rootConfig[strDisableCookiesUsage];\r\n        }\r\n        // Not setting the cookieMgrConfig.enabled as that will update (set) the global dynamic config\r\n        // So future \"updates\" then may not be as expected\r\n        isCfgEnabled = cookieEnabled;\r\n    }\r\n    return isCfgEnabled;\r\n}\r\n/**\r\n * Helper to return the ICookieMgr from the core (if not null/undefined) or a default implementation\r\n * associated with the configuration or a legacy default.\r\n * @param core\r\n * @param config\r\n * @returns\r\n */\r\nexport function safeGetCookieMgr(core, config) {\r\n    var cookieMgr;\r\n    if (core) {\r\n        // Always returns an instance\r\n        cookieMgr = core.getCookieMgr();\r\n    }\r\n    else if (config) {\r\n        var cookieCfg = config.cookieCfg;\r\n        if (cookieCfg && cookieCfg[strConfigCookieMgr]) {\r\n            cookieMgr = cookieCfg[strConfigCookieMgr];\r\n        }\r\n        else {\r\n            cookieMgr = createCookieMgr(config);\r\n        }\r\n    }\r\n    if (!cookieMgr) {\r\n        // Get or initialize the default global (legacy) cookie manager if we couldn't find one\r\n        cookieMgr = _gblCookieMgr(config, (core || {})[_DYN_LOGGER /* @min:%2elogger */]);\r\n    }\r\n    return cookieMgr;\r\n}\r\nexport function createCookieMgr(rootConfig, logger) {\r\n    var _a;\r\n    var cookieMgrConfig;\r\n    var _path;\r\n    var _domain;\r\n    var unloadHandler;\r\n    // Explicitly checking against false, so that setting to undefined will === true\r\n    var _enabled;\r\n    var _getCookieFn;\r\n    var _setCookieFn;\r\n    var _delCookieFn;\r\n    // Make sure the root config is dynamic as it may be the global config\r\n    rootConfig = createDynamicConfig(rootConfig || _globalCookieConfig, null, logger).cfg;\r\n    // Will get recalled if the referenced configuration is changed\r\n    unloadHandler = onConfigChange(rootConfig, function (details) {\r\n        // Make sure the root config has all of the the defaults to the root config to ensure they are dynamic\r\n        details[_DYN_SET_DF /* @min:%2esetDf */](details.cfg, rootDefaultConfig);\r\n        // Create and apply the defaults to the cookieCfg element\r\n        cookieMgrConfig = details.ref(details.cfg, \"cookieCfg\"); // details.setDf(details.cfg.cookieCfg, defaultConfig);\r\n        _path = cookieMgrConfig[STR_PATH /* @min:%2epath */] || \"/\";\r\n        _domain = cookieMgrConfig[STR_DOMAIN /* @min:%2edomain */];\r\n        // Explicitly checking against false, so that setting to undefined will === true\r\n        _enabled = _isCfgEnabled(rootConfig, cookieMgrConfig) !== false;\r\n        _getCookieFn = cookieMgrConfig.getCookie || _getCookieValue;\r\n        _setCookieFn = cookieMgrConfig.setCookie || _setCookieValue;\r\n        _delCookieFn = cookieMgrConfig.delCookie || _setCookieValue;\r\n    }, logger);\r\n    var cookieMgr = (_a = {\r\n            isEnabled: function () {\r\n                var enabled = _isCfgEnabled(rootConfig, cookieMgrConfig) !== false && _enabled && areCookiesSupported(logger);\r\n                // Using an indirect lookup for any global cookie manager to support tree shaking for SDK's\r\n                // that don't use the \"applicationinsights-core\" version of the default cookie function\r\n                var gblManager = _globalCookieConfig[strConfigCookieMgr];\r\n                if (enabled && gblManager && cookieMgr !== gblManager) {\r\n                    // Make sure the GlobalCookie Manager instance (if not this instance) is also enabled.\r\n                    // As the global (deprecated) functions may have been called (for backward compatibility)\r\n                    enabled = _isMgrEnabled(gblManager);\r\n                }\r\n                return enabled;\r\n            },\r\n            setEnabled: function (value) {\r\n                // Explicitly checking against false, so that setting to undefined will === true\r\n                _enabled = value !== false;\r\n                cookieMgrConfig[_DYN_ENABLED /* @min:%2eenabled */] = value;\r\n            },\r\n            set: function (name, value, maxAgeSec, domain, path) {\r\n                var result = false;\r\n                if (_isMgrEnabled(cookieMgr) && !_isBlockedCookie(cookieMgrConfig, name)) {\r\n                    var values = {};\r\n                    var theValue = strTrim(value || STR_EMPTY);\r\n                    var idx = strIndexOf(theValue, \";\");\r\n                    if (idx !== -1) {\r\n                        theValue = strTrim(strLeft(value, idx));\r\n                        values = _extractParts(strSubstring(value, idx + 1));\r\n                    }\r\n                    // Only update domain if not already present (isUndefined) and the value is truthy (not null, undefined or empty string)\r\n                    setValue(values, STR_DOMAIN, domain || _domain, isTruthy, isUndefined);\r\n                    if (!isNullOrUndefined(maxAgeSec)) {\r\n                        var _isIE = isIE();\r\n                        if (isUndefined(values[strExpires])) {\r\n                            var nowMs = utcNow();\r\n                            // Only add expires if not already present\r\n                            var expireMs = nowMs + (maxAgeSec * 1000);\r\n                            // Sanity check, if zero or -ve then ignore\r\n                            if (expireMs > 0) {\r\n                                var expiry = new Date();\r\n                                expiry.setTime(expireMs);\r\n                                setValue(values, strExpires, _formatDate(expiry, !_isIE ? strToUTCString : strToGMTString) || _formatDate(expiry, _isIE ? strToGMTString : strToUTCString) || STR_EMPTY, isTruthy);\r\n                            }\r\n                        }\r\n                        if (!_isIE) {\r\n                            // Only replace if not already present\r\n                            setValue(values, \"max-age\", STR_EMPTY + maxAgeSec, null, isUndefined);\r\n                        }\r\n                    }\r\n                    var location_1 = getLocation();\r\n                    if (location_1 && location_1[_DYN_PROTOCOL /* @min:%2eprotocol */] === \"https:\") {\r\n                        setValue(values, \"secure\", null, null, isUndefined);\r\n                        // Only set same site if not also secure\r\n                        if (_allowUaSameSite === null) {\r\n                            _allowUaSameSite = !uaDisallowsSameSiteNone((getNavigator() || {})[_DYN_USER_AGENT /* @min:%2euserAgent */]);\r\n                        }\r\n                        if (_allowUaSameSite) {\r\n                            setValue(values, \"SameSite\", \"None\", null, isUndefined);\r\n                        }\r\n                    }\r\n                    setValue(values, STR_PATH, path || _path, null, isUndefined);\r\n                    //let setCookieFn = cookieMgrConfig.setCookie || _setCookieValue;\r\n                    _setCookieFn(name, _formatCookieValue(theValue, values));\r\n                    result = true;\r\n                }\r\n                return result;\r\n            },\r\n            get: function (name) {\r\n                var value = STR_EMPTY;\r\n                if (_isMgrEnabled(cookieMgr) && !_isIgnoredCookie(cookieMgrConfig, name)) {\r\n                    value = _getCookieFn(name);\r\n                }\r\n                return value;\r\n            },\r\n            del: function (name, path) {\r\n                var result = false;\r\n                if (_isMgrEnabled(cookieMgr)) {\r\n                    // Only remove the cookie if the manager and cookie support has not been disabled\r\n                    result = cookieMgr.purge(name, path);\r\n                }\r\n                return result;\r\n            },\r\n            purge: function (name, path) {\r\n                var _a;\r\n                var result = false;\r\n                if (areCookiesSupported(logger)) {\r\n                    // Setting the expiration date in the past immediately removes the cookie\r\n                    var values = (_a = {},\r\n                        _a[STR_PATH] = path ? path : \"/\",\r\n                        _a[strExpires] = \"Thu, 01 Jan 1970 00:00:01 GMT\",\r\n                        _a);\r\n                    if (!isIE()) {\r\n                        // Set max age to expire now\r\n                        values[\"max-age\"] = \"0\";\r\n                    }\r\n                    // let delCookie = cookieMgrConfig.delCookie || _setCookieValue;\r\n                    _delCookieFn(name, _formatCookieValue(STR_EMPTY, values));\r\n                    result = true;\r\n                }\r\n                return result;\r\n            }\r\n        },\r\n        _a[_DYN_UNLOAD /* @min:unload */] = function (isAsync) {\r\n            unloadHandler && unloadHandler.rm();\r\n            unloadHandler = null;\r\n        },\r\n        _a);\r\n    // Associated this cookie manager with the config\r\n    cookieMgr[strConfigCookieMgr] = cookieMgr;\r\n    return cookieMgr;\r\n}\r\n/*\r\n* Helper method to tell if document.cookie object is supported by the runtime\r\n*/\r\nexport function areCookiesSupported(logger) {\r\n    if (_supportsCookies === null) {\r\n        _supportsCookies = false;\r\n        !_doc && _getDoc();\r\n        try {\r\n            var doc = _doc.v || {};\r\n            _supportsCookies = doc[strCookie] !== undefined;\r\n        }\r\n        catch (e) {\r\n            _throwInternal(logger, 2 /* eLoggingSeverity.WARNING */, 68 /* _eInternalMessageId.CannotAccessCookie */, \"Cannot access document.cookie - \" + getExceptionName(e), { exception: dumpObj(e) });\r\n        }\r\n    }\r\n    return _supportsCookies;\r\n}\r\nfunction _extractParts(theValue) {\r\n    var values = {};\r\n    if (theValue && theValue[_DYN_LENGTH /* @min:%2elength */]) {\r\n        var parts = strTrim(theValue)[_DYN_SPLIT /* @min:%2esplit */](\";\");\r\n        arrForEach(parts, function (thePart) {\r\n            thePart = strTrim(thePart || STR_EMPTY);\r\n            if (thePart) {\r\n                var idx = strIndexOf(thePart, \"=\");\r\n                if (idx === -1) {\r\n                    values[thePart] = null;\r\n                }\r\n                else {\r\n                    values[strTrim(strLeft(thePart, idx))] = strTrim(strSubstring(thePart, idx + 1));\r\n                }\r\n            }\r\n        });\r\n    }\r\n    return values;\r\n}\r\nfunction _formatDate(theDate, func) {\r\n    if (isFunction(theDate[func])) {\r\n        return theDate[func]();\r\n    }\r\n    return null;\r\n}\r\nfunction _formatCookieValue(value, values) {\r\n    var cookieValue = value || STR_EMPTY;\r\n    objForEachKey(values, function (name, theValue) {\r\n        cookieValue += \"; \" + name + (!isNullOrUndefined(theValue) ? \"=\" + theValue : STR_EMPTY);\r\n    });\r\n    return cookieValue;\r\n}\r\nfunction _getCookieValue(name) {\r\n    var cookieValue = STR_EMPTY;\r\n    !_doc && _getDoc();\r\n    if (_doc.v) {\r\n        var theCookie = _doc.v[strCookie] || STR_EMPTY;\r\n        if (_parsedCookieValue !== theCookie) {\r\n            _cookieCache = _extractParts(theCookie);\r\n            _parsedCookieValue = theCookie;\r\n        }\r\n        cookieValue = strTrim(_cookieCache[name] || STR_EMPTY);\r\n    }\r\n    return cookieValue;\r\n}\r\nfunction _setCookieValue(name, cookieValue) {\r\n    !_doc && _getDoc();\r\n    if (_doc.v) {\r\n        _doc.v[strCookie] = name + \"=\" + cookieValue;\r\n    }\r\n}\r\nexport function uaDisallowsSameSiteNone(userAgent) {\r\n    if (!isString(userAgent)) {\r\n        return false;\r\n    }\r\n    // Cover all iOS based browsers here. This includes:\r\n    // - Safari on iOS 12 for iPhone, iPod Touch, iPad\r\n    // - WkWebview on iOS 12 for iPhone, iPod Touch, iPad\r\n    // - Chrome on iOS 12 for iPhone, iPod Touch, iPad\r\n    // All of which are broken by SameSite=None, because they use the iOS networking stack\r\n    if (strContains(userAgent, \"CPU iPhone OS 12\") || strContains(userAgent, \"iPad; CPU OS 12\")) {\r\n        return true;\r\n    }\r\n    // Cover Mac OS X based browsers that use the Mac OS networking stack. This includes:\r\n    // - Safari on Mac OS X\r\n    // This does not include:\r\n    // - Internal browser on Mac OS X\r\n    // - Chrome on Mac OS X\r\n    // - Chromium on Mac OS X\r\n    // Because they do not use the Mac OS networking stack.\r\n    if (strContains(userAgent, \"Macintosh; Intel Mac OS X 10_14\") && strContains(userAgent, \"Version/\") && strContains(userAgent, \"Safari\")) {\r\n        return true;\r\n    }\r\n    // Cover Mac OS X internal browsers that use the Mac OS networking stack. This includes:\r\n    // - Internal browser on Mac OS X\r\n    // This does not include:\r\n    // - Safari on Mac OS X\r\n    // - Chrome on Mac OS X\r\n    // - Chromium on Mac OS X\r\n    // Because they do not use the Mac OS networking stack.\r\n    if (strContains(userAgent, \"Macintosh; Intel Mac OS X 10_14\") && strEndsWith(userAgent, \"AppleWebKit/605.1.15 (KHTML, like Gecko)\")) {\r\n        return true;\r\n    }\r\n    // Cover Chrome 50-69, because some versions are broken by SameSite=None, and none in this range require it.\r\n    // Note: this covers some pre-Chromium Edge versions, but pre-Chromim Edge does not require SameSite=None, so this is fine.\r\n    // Note: this regex applies to Windows, Mac OS X, and Linux, deliberately.\r\n    if (strContains(userAgent, \"Chrome/5\") || strContains(userAgent, \"Chrome/6\")) {\r\n        return true;\r\n    }\r\n    // Unreal Engine runs Chromium 59, but does not advertise as Chrome until 4.23. Treat versions of Unreal\r\n    // that don't specify their Chrome version as lacking support for SameSite=None.\r\n    if (strContains(userAgent, \"UnrealEngine\") && !strContains(userAgent, \"Chrome\")) {\r\n        return true;\r\n    }\r\n    // UCBrowser < 12.13.2 ignores Set-Cookie headers with SameSite=None\r\n    // NB: this rule isn't complete - you need regex to make a complete rule.\r\n    // See: https://www.chromium.org/updates/same-site/incompatible-clients\r\n    if (strContains(userAgent, \"UCBrowser/12\") || strContains(userAgent, \"UCBrowser/11\")) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n//# sourceMappingURL=CookieMgr.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\n\"use strict\";\r\nimport { strShimUndefined } from \"@microsoft/applicationinsights-shims\";\r\nimport { strSubstr, strSubstring } from \"@nevware21/ts-utils\";\r\nimport { _DYN_LENGTH } from \"../__DynamicConstants\";\r\nimport { STR_EMPTY } from \"./InternalConstants\";\r\nimport { random32 } from \"./RandomHelper\";\r\n// Added to help with minfication\r\nexport var Undefined = strShimUndefined;\r\nexport function newGuid() {\r\n    var uuid = generateW3CId();\r\n    return strSubstring(uuid, 0, 8) + \"-\" + strSubstring(uuid, 8, 12) + \"-\" + strSubstring(uuid, 12, 16) + \"-\" + strSubstring(uuid, 16, 20) + \"-\" + strSubstring(uuid, 20);\r\n}\r\n/**\r\n * The strEndsWith() method determines whether a string ends with the characters of a specified string, returning true or false as appropriate.\r\n * @param value - The value to check whether it ends with the search value.\r\n * @param search - The characters to be searched for at the end of the value.\r\n * @returns true if the given search value is found at the end of the string, otherwise false.\r\n */\r\nexport function strEndsWith(value, search) {\r\n    if (value && search) {\r\n        var len = value[_DYN_LENGTH /* @min:%2elength */];\r\n        var start = len - search[_DYN_LENGTH /* @min:%2elength */];\r\n        return strSubstring(value, start >= 0 ? start : 0, len) === search;\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * generate W3C trace id\r\n */\r\nexport function generateW3CId() {\r\n    var hexValues = [\"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"a\", \"b\", \"c\", \"d\", \"e\", \"f\"];\r\n    // rfc4122 version 4 UUID without dashes and with lowercase letters\r\n    var oct = STR_EMPTY, tmp;\r\n    for (var a = 0; a < 4; a++) {\r\n        tmp = random32();\r\n        oct +=\r\n            hexValues[tmp & 0xF] +\r\n                hexValues[tmp >> 4 & 0xF] +\r\n                hexValues[tmp >> 8 & 0xF] +\r\n                hexValues[tmp >> 12 & 0xF] +\r\n                hexValues[tmp >> 16 & 0xF] +\r\n                hexValues[tmp >> 20 & 0xF] +\r\n                hexValues[tmp >> 24 & 0xF] +\r\n                hexValues[tmp >> 28 & 0xF];\r\n    }\r\n    // \"Set the two most significant bits (bits 6 and 7) of the clock_seq_hi_and_reserved to zero and one, respectively\"\r\n    var clockSequenceHi = hexValues[8 + (random32() & 0x03) | 0];\r\n    return strSubstr(oct, 0, 8) + strSubstr(oct, 9, 4) + \"4\" + strSubstr(oct, 13, 3) + clockSequenceHi + strSubstr(oct, 16, 3) + strSubstr(oct, 19, 12);\r\n}\r\n//# sourceMappingURL=CoreUtils.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { objDefine } from \"@nevware21/ts-utils\";\r\nimport { _DYN_NODE_TYPE } from \"../__DynamicConstants\";\r\nimport { normalizeJsName } from \"./HelperFuncs\";\r\nimport { STR_EMPTY } from \"./InternalConstants\";\r\nimport { newId } from \"./RandomHelper\";\r\nvar version = '3.3.4';\r\nvar instanceName = \".\" + newId(6);\r\nvar _dataUid = 0;\r\n// Accepts only:\r\n//  - Node\r\n//    - Node.ELEMENT_NODE\r\n//    - Node.DOCUMENT_NODE\r\n//  - Object\r\n//    - Any\r\nfunction _canAcceptData(target) {\r\n    return target[_DYN_NODE_TYPE /* @min:%2enodeType */] === 1 || target[_DYN_NODE_TYPE /* @min:%2enodeType */] === 9 || !(+target[_DYN_NODE_TYPE /* @min:%2enodeType */]);\r\n}\r\nfunction _getCache(data, target) {\r\n    var theCache = target[data.id];\r\n    if (!theCache) {\r\n        theCache = {};\r\n        try {\r\n            if (_canAcceptData(target)) {\r\n                objDefine(target, data.id, {\r\n                    e: false,\r\n                    v: theCache\r\n                });\r\n            }\r\n        }\r\n        catch (e) {\r\n            // Not all environments allow extending all objects, so just ignore the cache in those cases\r\n        }\r\n    }\r\n    return theCache;\r\n}\r\nexport function createUniqueNamespace(name, includeVersion) {\r\n    if (includeVersion === void 0) { includeVersion = false; }\r\n    return normalizeJsName(name + (_dataUid++) + (includeVersion ? \".\" + version : STR_EMPTY) + instanceName);\r\n}\r\nexport function createElmNodeData(name) {\r\n    var data = {\r\n        id: createUniqueNamespace(\"_aiData-\" + (name || STR_EMPTY) + \".\" + version),\r\n        accept: function (target) {\r\n            return _canAcceptData(target);\r\n        },\r\n        get: function (target, name, defValue, addDefault) {\r\n            var theCache = target[data.id];\r\n            if (!theCache) {\r\n                if (addDefault) {\r\n                    // Side effect is adds the cache\r\n                    theCache = _getCache(data, target);\r\n                    theCache[normalizeJsName(name)] = defValue;\r\n                }\r\n                return defValue;\r\n            }\r\n            return theCache[normalizeJsName(name)];\r\n        },\r\n        kill: function (target, name) {\r\n            if (target && target[name]) {\r\n                try {\r\n                    delete target[name];\r\n                }\r\n                catch (e) {\r\n                    // Just cleaning up, so if this fails -- ignore\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return data;\r\n}\r\n//# sourceMappingURL=DataCacheHelper.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { getInst } from \"@nevware21/ts-utils\";\r\nimport { _DYN_APPLY, _DYN_LENGTH } from \"../__DynamicConstants\";\r\nimport { STR_EVENTS_DISCARDED, STR_EVENTS_SEND_REQUEST, STR_EVENTS_SENT, STR_PERF_EVENT } from \"./InternalConstants\";\r\nvar listenerFuncs = [STR_EVENTS_SENT, STR_EVENTS_DISCARDED, STR_EVENTS_SEND_REQUEST, STR_PERF_EVENT];\r\nvar _aiNamespace = null;\r\nvar _debugListener;\r\nfunction _listenerProxyFunc(name, config) {\r\n    return function () {\r\n        var args = arguments;\r\n        var dbgExt = getDebugExt(config);\r\n        if (dbgExt) {\r\n            var listener = dbgExt.listener;\r\n            if (listener && listener[name]) {\r\n                listener[name][_DYN_APPLY /* @min:%2eapply */](listener, args);\r\n            }\r\n        }\r\n    };\r\n}\r\nfunction _getExtensionNamespace() {\r\n    // Cache the lookup of the global namespace object\r\n    var target = getInst(\"Microsoft\");\r\n    if (target) {\r\n        _aiNamespace = target[\"ApplicationInsights\"];\r\n    }\r\n    return _aiNamespace;\r\n}\r\nexport function getDebugExt(config) {\r\n    var ns = _aiNamespace;\r\n    if (!ns && config.disableDbgExt !== true) {\r\n        ns = _aiNamespace || _getExtensionNamespace();\r\n    }\r\n    return ns ? ns[\"ChromeDbgExt\"] : null;\r\n}\r\nexport function getDebugListener(config) {\r\n    if (!_debugListener) {\r\n        _debugListener = {};\r\n        for (var lp = 0; lp < listenerFuncs[_DYN_LENGTH /* @min:%2elength */]; lp++) {\r\n            _debugListener[listenerFuncs[lp]] = _listenerProxyFunc(listenerFuncs[lp], config);\r\n        }\r\n    }\r\n    return _debugListener;\r\n}\r\n//# sourceMappingURL=DbgExtensionUtils.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\n\"use strict\";\r\nvar _a;\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { dumpObj, isFunction, isUndefined } from \"@nevware21/ts-utils\";\r\nimport { createDynamicConfig, onConfigChange } from \"../Config/DynamicConfig\";\r\nimport { _DYN_DIAG_LOG, _DYN_LOGGER, _DYN_LOGGING_LEVEL_CONSOL4, _DYN_LOG_INTERNAL_MESSAGE, _DYN_MESSAGE, _DYN_MESSAGE_ID, _DYN_PUSH, _DYN_REPLACE, _DYN_THROW_INTERNAL, _DYN_UNLOAD, _DYN_WARN_TO_CONSOLE } from \"../__DynamicConstants\";\r\nimport { getDebugExt } from \"./DbgExtensionUtils\";\r\nimport { getConsole, getJSON, hasJSON } from \"./EnvUtils\";\r\nimport { STR_EMPTY } from \"./InternalConstants\";\r\nvar STR_WARN_TO_CONSOLE = \"warnToConsole\";\r\n/**\r\n * For user non actionable traces use AI Internal prefix.\r\n */\r\nvar AiNonUserActionablePrefix = \"AI (Internal): \";\r\n/**\r\n * Prefix of the traces in portal.\r\n */\r\nvar AiUserActionablePrefix = \"AI: \";\r\n/**\r\n *  Session storage key for the prefix for the key indicating message type already logged\r\n */\r\nvar AIInternalMessagePrefix = \"AITR_\";\r\nvar defaultValues = {\r\n    loggingLevelConsole: 0,\r\n    loggingLevelTelemetry: 1,\r\n    maxMessageLimit: 25,\r\n    enableDebug: false\r\n};\r\nvar _logFuncs = (_a = {},\r\n    _a[0 /* eLoggingSeverity.DISABLED */] = null,\r\n    _a[1 /* eLoggingSeverity.CRITICAL */] = \"errorToConsole\",\r\n    _a[2 /* eLoggingSeverity.WARNING */] = STR_WARN_TO_CONSOLE,\r\n    _a[3 /* eLoggingSeverity.DEBUG */] = \"debugToConsole\",\r\n    _a);\r\nfunction _sanitizeDiagnosticText(text) {\r\n    if (text) {\r\n        return \"\\\"\" + text[_DYN_REPLACE /* @min:%2ereplace */](/\\\"/g, STR_EMPTY) + \"\\\"\";\r\n    }\r\n    return STR_EMPTY;\r\n}\r\nfunction _logToConsole(func, message) {\r\n    var theConsole = getConsole();\r\n    if (!!theConsole) {\r\n        var logFunc = \"log\";\r\n        if (theConsole[func]) {\r\n            logFunc = func;\r\n        }\r\n        if (isFunction(theConsole[logFunc])) {\r\n            theConsole[logFunc](message);\r\n        }\r\n    }\r\n}\r\nvar _InternalLogMessage = /** @class */ (function () {\r\n    function _InternalLogMessage(msgId, msg, isUserAct, properties) {\r\n        if (isUserAct === void 0) { isUserAct = false; }\r\n        var _self = this;\r\n        _self[_DYN_MESSAGE_ID /* @min:%2emessageId */] = msgId;\r\n        _self[_DYN_MESSAGE /* @min:%2emessage */] =\r\n            (isUserAct ? AiUserActionablePrefix : AiNonUserActionablePrefix) +\r\n                msgId;\r\n        var strProps = STR_EMPTY;\r\n        if (hasJSON()) {\r\n            strProps = getJSON().stringify(properties);\r\n        }\r\n        var diagnosticText = (msg ? \" message:\" + _sanitizeDiagnosticText(msg) : STR_EMPTY) +\r\n            (properties ? \" props:\" + _sanitizeDiagnosticText(strProps) : STR_EMPTY);\r\n        _self[_DYN_MESSAGE /* @min:%2emessage */] += diagnosticText;\r\n    }\r\n    _InternalLogMessage.dataType = \"MessageData\";\r\n    return _InternalLogMessage;\r\n}());\r\nexport { _InternalLogMessage };\r\nexport function safeGetLogger(core, config) {\r\n    return (core || {})[_DYN_LOGGER /* @min:%2elogger */] || new DiagnosticLogger(config);\r\n}\r\nvar DiagnosticLogger = /** @class */ (function () {\r\n    function DiagnosticLogger(config) {\r\n        this.identifier = \"DiagnosticLogger\";\r\n        /**\r\n         * The internal logging queue\r\n         */\r\n        this.queue = [];\r\n        /**\r\n         * Count of internal messages sent\r\n         */\r\n        var _messageCount = 0;\r\n        /**\r\n         * Holds information about what message types were already logged to console or sent to server.\r\n         */\r\n        var _messageLogged = {};\r\n        var _loggingLevelConsole;\r\n        var _loggingLevelTelemetry;\r\n        var _maxInternalMessageLimit;\r\n        var _enableDebug;\r\n        var _unloadHandler;\r\n        dynamicProto(DiagnosticLogger, this, function (_self) {\r\n            _unloadHandler = _setDefaultsFromConfig(config || {});\r\n            _self.consoleLoggingLevel = function () { return _loggingLevelConsole; };\r\n            /**\r\n             * This method will throw exceptions in debug mode or attempt to log the error as a console warning.\r\n             * @param severity - {LoggingSeverity} - The severity of the log message\r\n             * @param message - {_InternalLogMessage} - The log message.\r\n             */\r\n            _self[_DYN_THROW_INTERNAL /* @min:%2ethrowInternal */] = function (severity, msgId, msg, properties, isUserAct) {\r\n                if (isUserAct === void 0) { isUserAct = false; }\r\n                var message = new _InternalLogMessage(msgId, msg, isUserAct, properties);\r\n                if (_enableDebug) {\r\n                    throw dumpObj(message);\r\n                }\r\n                else {\r\n                    // Get the logging function and fallback to warnToConsole of for some reason errorToConsole doesn't exist\r\n                    var logFunc = _logFuncs[severity] || STR_WARN_TO_CONSOLE;\r\n                    if (!isUndefined(message[_DYN_MESSAGE /* @min:%2emessage */])) {\r\n                        if (isUserAct) {\r\n                            // check if this message type was already logged to console for this page view and if so, don't log it again\r\n                            var messageKey = +message[_DYN_MESSAGE_ID /* @min:%2emessageId */];\r\n                            if (!_messageLogged[messageKey] && _loggingLevelConsole >= severity) {\r\n                                _self[logFunc](message[_DYN_MESSAGE /* @min:%2emessage */]);\r\n                                _messageLogged[messageKey] = true;\r\n                            }\r\n                        }\r\n                        else {\r\n                            // Only log traces if the console Logging Level is >= the throwInternal severity level\r\n                            if (_loggingLevelConsole >= severity) {\r\n                                _self[logFunc](message[_DYN_MESSAGE /* @min:%2emessage */]);\r\n                            }\r\n                        }\r\n                        _logInternalMessage(severity, message);\r\n                    }\r\n                    else {\r\n                        _debugExtMsg(\"throw\" + (severity === 1 /* eLoggingSeverity.CRITICAL */ ? \"Critical\" : \"Warning\"), message);\r\n                    }\r\n                }\r\n            };\r\n            _self.debugToConsole = function (message) {\r\n                _logToConsole(\"debug\", message);\r\n                _debugExtMsg(\"warning\", message);\r\n            };\r\n            _self[_DYN_WARN_TO_CONSOLE /* @min:%2ewarnToConsole */] = function (message) {\r\n                _logToConsole(\"warn\", message);\r\n                _debugExtMsg(\"warning\", message);\r\n            };\r\n            _self.errorToConsole = function (message) {\r\n                _logToConsole(\"error\", message);\r\n                _debugExtMsg(\"error\", message);\r\n            };\r\n            _self.resetInternalMessageCount = function () {\r\n                _messageCount = 0;\r\n                _messageLogged = {};\r\n            };\r\n            _self[_DYN_LOG_INTERNAL_MESSAGE /* @min:%2elogInternalMessage */] = _logInternalMessage;\r\n            _self[_DYN_UNLOAD /* @min:%2eunload */] = function (isAsync) {\r\n                _unloadHandler && _unloadHandler.rm();\r\n                _unloadHandler = null;\r\n            };\r\n            function _logInternalMessage(severity, message) {\r\n                if (_areInternalMessagesThrottled()) {\r\n                    return;\r\n                }\r\n                // check if this message type was already logged for this session and if so, don't log it again\r\n                var logMessage = true;\r\n                var messageKey = AIInternalMessagePrefix + message[_DYN_MESSAGE_ID /* @min:%2emessageId */];\r\n                // if the session storage is not available, limit to only one message type per page view\r\n                if (_messageLogged[messageKey]) {\r\n                    logMessage = false;\r\n                }\r\n                else {\r\n                    _messageLogged[messageKey] = true;\r\n                }\r\n                if (logMessage) {\r\n                    // Push the event in the internal queue\r\n                    if (severity <= _loggingLevelTelemetry) {\r\n                        _self.queue[_DYN_PUSH /* @min:%2epush */](message);\r\n                        _messageCount++;\r\n                        _debugExtMsg((severity === 1 /* eLoggingSeverity.CRITICAL */ ? \"error\" : \"warn\"), message);\r\n                    }\r\n                    // When throttle limit reached, send a special event\r\n                    if (_messageCount === _maxInternalMessageLimit) {\r\n                        var throttleLimitMessage = \"Internal events throttle limit per PageView reached for this app.\";\r\n                        var throttleMessage = new _InternalLogMessage(23 /* _eInternalMessageId.MessageLimitPerPVExceeded */, throttleLimitMessage, false);\r\n                        _self.queue[_DYN_PUSH /* @min:%2epush */](throttleMessage);\r\n                        if (severity === 1 /* eLoggingSeverity.CRITICAL */) {\r\n                            _self.errorToConsole(throttleLimitMessage);\r\n                        }\r\n                        else {\r\n                            _self[_DYN_WARN_TO_CONSOLE /* @min:%2ewarnToConsole */](throttleLimitMessage);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            function _setDefaultsFromConfig(config) {\r\n                // make sure the config is dynamic\r\n                return onConfigChange(createDynamicConfig(config, defaultValues, _self).cfg, function (details) {\r\n                    var config = details.cfg;\r\n                    _loggingLevelConsole = config[_DYN_LOGGING_LEVEL_CONSOL4 /* @min:%2eloggingLevelConsole */];\r\n                    _loggingLevelTelemetry = config.loggingLevelTelemetry;\r\n                    _maxInternalMessageLimit = config.maxMessageLimit;\r\n                    _enableDebug = config.enableDebug;\r\n                });\r\n            }\r\n            function _areInternalMessagesThrottled() {\r\n                return _messageCount >= _maxInternalMessageLimit;\r\n            }\r\n            function _debugExtMsg(name, data) {\r\n                var dbgExt = getDebugExt(config || {});\r\n                if (dbgExt && dbgExt[_DYN_DIAG_LOG /* @min:%2ediagLog */]) {\r\n                    dbgExt[_DYN_DIAG_LOG /* @min:%2ediagLog */](name, data);\r\n                }\r\n            }\r\n        });\r\n    }\r\n// Removed Stub for DiagnosticLogger.prototype.consoleLoggingLevel.\r\n// Removed Stub for DiagnosticLogger.prototype.throwInternal.\r\n// Removed Stub for DiagnosticLogger.prototype.debugToConsole.\r\n// Removed Stub for DiagnosticLogger.prototype.warnToConsole.\r\n// Removed Stub for DiagnosticLogger.prototype.errorToConsole.\r\n// Removed Stub for DiagnosticLogger.prototype.resetInternalMessageCount.\r\n// Removed Stub for DiagnosticLogger.prototype.logInternalMessage.\r\n// Removed Stub for DiagnosticLogger.prototype.unload.\r\n    // This is a workaround for an IE bug when using dynamicProto() with classes that don't have any\n    // non-dynamic functions or static properties/functions when using uglify-js to minify the resulting code.\n    DiagnosticLogger.__ieDyn=1;\n\n    return DiagnosticLogger;\r\n}());\r\nexport { DiagnosticLogger };\r\nfunction _getLogger(logger) {\r\n    return (logger || new DiagnosticLogger());\r\n}\r\n/**\r\n * This is a helper method which will call throwInternal on the passed logger, will throw exceptions in\r\n * debug mode or attempt to log the error as a console warning. This helper is provided mostly to better\r\n * support minification as logger.throwInternal() will not compress the publish \"throwInternal\" used throughout\r\n * the code.\r\n * @param logger - The Diagnostic Logger instance to use.\r\n * @param severity - {LoggingSeverity} - The severity of the log message\r\n * @param message - {_InternalLogMessage} - The log message.\r\n */\r\nexport function _throwInternal(logger, severity, msgId, msg, properties, isUserAct) {\r\n    if (isUserAct === void 0) { isUserAct = false; }\r\n    _getLogger(logger)[_DYN_THROW_INTERNAL /* @min:%2ethrowInternal */](severity, msgId, msg, properties, isUserAct);\r\n}\r\n/**\r\n * This is a helper method which will call warnToConsole on the passed logger with the provided message.\r\n * @param logger - The Diagnostic Logger instance to use.\r\n * @param message - {_InternalLogMessage} - The log message.\r\n */\r\nexport function _warnToConsole(logger, message) {\r\n    _getLogger(logger)[_DYN_WARN_TO_CONSOLE /* @min:%2ewarnToConsole */](message);\r\n}\r\n/**\r\n * Logs a message to the internal queue.\r\n * @param logger - The Diagnostic Logger instance to use.\r\n * @param severity - {LoggingSeverity} - The severity of the log message\r\n * @param message - {_InternalLogMessage} - The message to log.\r\n */\r\nexport function _logInternalMessage(logger, severity, message) {\r\n    _getLogger(logger)[_DYN_LOG_INTERNAL_MESSAGE /* @min:%2elogInternalMessage */](severity, message);\r\n}\r\n//# sourceMappingURL=DiagnosticLogger.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\n\"use strict\";\r\nimport { getGlobal, strShimObject, strShimPrototype, strShimUndefined } from \"@microsoft/applicationinsights-shims\";\r\nimport { getDocument, getInst, getNavigator, getPerformance, hasNavigator, isFunction, isString, isUndefined, strIndexOf } from \"@nevware21/ts-utils\";\r\nimport { _DYN_LENGTH, _DYN_NAME, _DYN_SPLIT, _DYN_TO_LOWER_CASE, _DYN_USER_AGENT } from \"../__DynamicConstants\";\r\nimport { strContains } from \"./HelperFuncs\";\r\nimport { STR_EMPTY } from \"./InternalConstants\";\r\n/**\r\n * This file exists to hold environment utilities that are required to check and\r\n * validate the current operating environment. Unless otherwise required, please\r\n * only use defined methods (functions) in this class so that users of these\r\n * functions/properties only need to include those that are used within their own modules.\r\n */\r\nvar strDocumentMode = \"documentMode\";\r\nvar strLocation = \"location\";\r\nvar strConsole = \"console\";\r\nvar strJSON = \"JSON\";\r\nvar strCrypto = \"crypto\";\r\nvar strMsCrypto = \"msCrypto\";\r\nvar strReactNative = \"ReactNative\";\r\nvar strMsie = \"msie\";\r\nvar strTrident = \"trident/\";\r\nvar strXMLHttpRequest = \"XMLHttpRequest\";\r\nvar _isTrident = null;\r\nvar _navUserAgentCheck = null;\r\nvar _enableMocks = false;\r\nvar _useXDomainRequest = null;\r\nvar _beaconsSupported = null;\r\nfunction _hasProperty(theClass, property) {\r\n    var supported = false;\r\n    if (theClass) {\r\n        try {\r\n            supported = property in theClass;\r\n            if (!supported) {\r\n                var proto = theClass[strShimPrototype];\r\n                if (proto) {\r\n                    supported = property in proto;\r\n                }\r\n            }\r\n        }\r\n        catch (e) {\r\n            // Do Nothing\r\n        }\r\n        if (!supported) {\r\n            try {\r\n                var tmp = new theClass();\r\n                supported = !isUndefined(tmp[property]);\r\n            }\r\n            catch (e) {\r\n                // Do Nothing\r\n            }\r\n        }\r\n    }\r\n    return supported;\r\n}\r\n/**\r\n * Enable the lookup of test mock objects if requested\r\n * @param enabled\r\n */\r\nexport function setEnableEnvMocks(enabled) {\r\n    _enableMocks = enabled;\r\n}\r\n/**\r\n * Returns the global location object if it is present otherwise null.\r\n * This helper is used to access the location object without causing an exception\r\n * \"Uncaught ReferenceError: location is not defined\"\r\n */\r\nexport function getLocation(checkForMock) {\r\n    if (checkForMock && _enableMocks) {\r\n        var mockLocation = getInst(\"__mockLocation\");\r\n        if (mockLocation) {\r\n            return mockLocation;\r\n        }\r\n    }\r\n    if (typeof location === strShimObject && location) {\r\n        return location;\r\n    }\r\n    return getInst(strLocation);\r\n}\r\n/**\r\n * Returns the global console object\r\n */\r\nexport function getConsole() {\r\n    if (typeof console !== strShimUndefined) {\r\n        return console;\r\n    }\r\n    return getInst(strConsole);\r\n}\r\n/**\r\n * Checks if JSON object is available, this is required as we support the API running without a\r\n * window /document (eg. Node server, electron webworkers) and if we attempt to assign a history\r\n * object to a local variable or pass as an argument an \"Uncaught ReferenceError: JSON is not defined\"\r\n * exception will be thrown.\r\n * Defined as a function to support lazy / late binding environments.\r\n */\r\nexport function hasJSON() {\r\n    return Boolean((typeof JSON === strShimObject && JSON) || getInst(strJSON) !== null);\r\n}\r\n/**\r\n * Returns the global JSON object if it is present otherwise null.\r\n * This helper is used to access the JSON object without causing an exception\r\n * \"Uncaught ReferenceError: JSON is not defined\"\r\n */\r\nexport function getJSON() {\r\n    if (hasJSON()) {\r\n        return JSON || getInst(strJSON);\r\n    }\r\n    return null;\r\n}\r\n/**\r\n * Returns the crypto object if it is present otherwise null.\r\n * This helper is used to access the crypto object from the current\r\n * global instance which could be window or globalThis for a web worker\r\n */\r\nexport function getCrypto() {\r\n    return getInst(strCrypto);\r\n}\r\n/**\r\n * Returns the crypto object if it is present otherwise null.\r\n * This helper is used to access the crypto object from the current\r\n * global instance which could be window or globalThis for a web worker\r\n */\r\nexport function getMsCrypto() {\r\n    return getInst(strMsCrypto);\r\n}\r\n/**\r\n * Returns whether the environment is reporting that we are running in a React Native Environment\r\n */\r\nexport function isReactNative() {\r\n    // If running in React Native, navigator.product will be populated\r\n    var nav = getNavigator();\r\n    if (nav && nav.product) {\r\n        return nav.product === strReactNative;\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * Identifies whether the current environment appears to be IE\r\n */\r\nexport function isIE() {\r\n    var nav = getNavigator();\r\n    if (nav && (nav[_DYN_USER_AGENT /* @min:%2euserAgent */] !== _navUserAgentCheck || _isTrident === null)) {\r\n        // Added to support test mocking of the user agent\r\n        _navUserAgentCheck = nav[_DYN_USER_AGENT /* @min:%2euserAgent */];\r\n        var userAgent = (_navUserAgentCheck || STR_EMPTY)[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */]();\r\n        _isTrident = (strContains(userAgent, strMsie) || strContains(userAgent, strTrident));\r\n    }\r\n    return _isTrident;\r\n}\r\n/**\r\n * Gets IE version returning the document emulation mode if we are running on IE, or null otherwise\r\n */\r\nexport function getIEVersion(userAgentStr) {\r\n    if (userAgentStr === void 0) { userAgentStr = null; }\r\n    if (!userAgentStr) {\r\n        var navigator_1 = getNavigator() || {};\r\n        userAgentStr = navigator_1 ? (navigator_1.userAgent || STR_EMPTY)[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */]() : STR_EMPTY;\r\n    }\r\n    var ua = (userAgentStr || STR_EMPTY)[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */]();\r\n    // Also check for documentMode in case X-UA-Compatible meta tag was included in HTML.\r\n    if (strContains(ua, strMsie)) {\r\n        var doc = getDocument() || {};\r\n        return Math.max(parseInt(ua[_DYN_SPLIT /* @min:%2esplit */](strMsie)[1]), (doc[strDocumentMode] || 0));\r\n    }\r\n    else if (strContains(ua, strTrident)) {\r\n        var tridentVer = parseInt(ua[_DYN_SPLIT /* @min:%2esplit */](strTrident)[1]);\r\n        if (tridentVer) {\r\n            return tridentVer + 4;\r\n        }\r\n    }\r\n    return null;\r\n}\r\nexport function isSafari(userAgentStr) {\r\n    if (!userAgentStr || !isString(userAgentStr)) {\r\n        var navigator_2 = getNavigator() || {};\r\n        userAgentStr = navigator_2 ? (navigator_2.userAgent || STR_EMPTY)[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */]() : STR_EMPTY;\r\n    }\r\n    var ua = (userAgentStr || STR_EMPTY)[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */]();\r\n    return (strIndexOf(ua, \"safari\") >= 0);\r\n}\r\n/**\r\n * Checks if HTML5 Beacons are supported in the current environment.\r\n * @param useCached - [Optional] used for testing to bypass the cached lookup, when `true` this will\r\n * cause the cached global to be reset.\r\n * @returns True if supported, false otherwise.\r\n */\r\nexport function isBeaconsSupported(useCached) {\r\n    if (_beaconsSupported === null || useCached === false) {\r\n        _beaconsSupported = hasNavigator() && Boolean(getNavigator().sendBeacon);\r\n    }\r\n    return _beaconsSupported;\r\n}\r\n/**\r\n * Checks if the Fetch API is supported in the current environment.\r\n * @param withKeepAlive - [Optional] If True, check if fetch is available and it supports the keepalive feature, otherwise only check if fetch is supported\r\n * @returns True if supported, otherwise false\r\n */\r\nexport function isFetchSupported(withKeepAlive) {\r\n    var isSupported = false;\r\n    try {\r\n        isSupported = !!getInst(\"fetch\");\r\n        var request = getInst(\"Request\");\r\n        if (isSupported && withKeepAlive && request) {\r\n            isSupported = _hasProperty(request, \"keepalive\");\r\n        }\r\n    }\r\n    catch (e) {\r\n        // Just Swallow any failure during availability checks\r\n    }\r\n    return isSupported;\r\n}\r\nexport function useXDomainRequest() {\r\n    if (_useXDomainRequest === null) {\r\n        _useXDomainRequest = (typeof XDomainRequest !== strShimUndefined);\r\n        if (_useXDomainRequest && isXhrSupported()) {\r\n            _useXDomainRequest = _useXDomainRequest && !_hasProperty(getInst(strXMLHttpRequest), \"withCredentials\");\r\n        }\r\n    }\r\n    return _useXDomainRequest;\r\n}\r\n/**\r\n * Checks if XMLHttpRequest is supported\r\n * @returns True if supported, otherwise false\r\n */\r\nexport function isXhrSupported() {\r\n    var isSupported = false;\r\n    try {\r\n        var xmlHttpRequest = getInst(strXMLHttpRequest);\r\n        isSupported = !!xmlHttpRequest;\r\n    }\r\n    catch (e) {\r\n        // Just Swallow any failure during availability checks\r\n    }\r\n    return isSupported;\r\n}\r\nfunction _getNamedValue(values, name) {\r\n    if (values) {\r\n        for (var i = 0; i < values[_DYN_LENGTH /* @min:%2elength */]; i++) {\r\n            var value = values[i];\r\n            if (value[_DYN_NAME /* @min:%2ename */]) {\r\n                if (value[_DYN_NAME /* @min:%2ename */] === name) {\r\n                    return value;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return {};\r\n}\r\n/**\r\n * Helper function to fetch the named meta-tag from the page.\r\n * @param name\r\n */\r\nexport function findMetaTag(name) {\r\n    var doc = getDocument();\r\n    if (doc && name) {\r\n        // Look for a meta-tag\r\n        return _getNamedValue(doc.querySelectorAll(\"meta\"), name).content;\r\n    }\r\n    return null;\r\n}\r\n/**\r\n * Helper function to fetch the named server timing value from the page response (first navigation event).\r\n * @param name\r\n */\r\nexport function findNamedServerTiming(name) {\r\n    var value;\r\n    var perf = getPerformance();\r\n    if (perf) {\r\n        // Try looking for a server-timing header\r\n        var navPerf = perf.getEntriesByType(\"navigation\") || [];\r\n        value = _getNamedValue((navPerf[_DYN_LENGTH /* @min:%2elength */] > 0 ? navPerf[0] : {}).serverTiming, name).description;\r\n    }\r\n    return value;\r\n}\r\n// TODO: should reuse this method for analytics plugin\r\nexport function dispatchEvent(target, evnt) {\r\n    if (target && target.dispatchEvent && evnt) {\r\n        target.dispatchEvent(evnt);\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\nexport function createCustomDomEvent(eventName, details) {\r\n    var event = null;\r\n    var detail = { detail: details || null };\r\n    if (isFunction(CustomEvent)) { // Use CustomEvent constructor when available\r\n        event = new CustomEvent(eventName, detail);\r\n    }\r\n    else { // CustomEvent has no constructor in IE\r\n        var doc = getDocument();\r\n        if (doc && doc.createEvent) {\r\n            event = doc.createEvent(\"CustomEvent\");\r\n            event.initCustomEvent(eventName, true, true, detail);\r\n        }\r\n    }\r\n    return event;\r\n}\r\nexport function sendCustomEvent(evtName, cfg, customDetails) {\r\n    var global = getGlobal();\r\n    if (global && global.CustomEvent) {\r\n        try {\r\n            var details = { cfg: cfg || null, customDetails: customDetails || null };\r\n            return dispatchEvent(global, createCustomDomEvent(evtName, details));\r\n        }\r\n        catch (e) {\r\n            // eslint-disable-next-line no-empty\r\n        }\r\n    }\r\n    return false;\r\n}\r\n//# sourceMappingURL=EnvUtils.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { arrForEach, arrIndexOf, getDocument, getWindow, isArray, objForEachKey, objKeys } from \"@nevware21/ts-utils\";\r\nimport { _DYN_HANDLER, _DYN_LENGTH, _DYN_NAME, _DYN_PUSH, _DYN_REPLACE, _DYN_SPLICE, _DYN_SPLIT, _DYN_TYPE } from \"../__DynamicConstants\";\r\nimport { createElmNodeData, createUniqueNamespace } from \"./DataCacheHelper\";\r\nimport { STR_EMPTY } from \"./InternalConstants\";\r\n// Added to help with minfication\r\nvar strOnPrefix = \"on\";\r\nvar strAttachEvent = \"attachEvent\";\r\nvar strAddEventHelper = \"addEventListener\";\r\nvar strDetachEvent = \"detachEvent\";\r\nvar strRemoveEventListener = \"removeEventListener\";\r\nvar strEvents = \"events\";\r\nvar strVisibilityChangeEvt = \"visibilitychange\";\r\nvar strPageHide = \"pagehide\";\r\nvar strPageShow = \"pageshow\";\r\nvar strUnload = \"unload\";\r\nvar strBeforeUnload = \"beforeunload\";\r\nvar strPageHideNamespace = createUniqueNamespace(\"aiEvtPageHide\");\r\nvar strPageShowNamespace = createUniqueNamespace(\"aiEvtPageShow\");\r\nvar rRemoveEmptyNs = /\\.[\\.]+/g;\r\nvar rRemoveTrailingEmptyNs = /[\\.]+$/;\r\nvar _guid = 1;\r\nvar elmNodeData = createElmNodeData(\"events\");\r\nvar eventNamespace = /^([^.]*)(?:\\.(.+)|)/;\r\nfunction _normalizeNamespace(name) {\r\n    if (name && name[_DYN_REPLACE /* @min:%2ereplace */]) {\r\n        return name[_DYN_REPLACE /* @min:%2ereplace */](/^[\\s\\.]+|(?=[\\s\\.])[\\.\\s]+$/g, STR_EMPTY);\r\n    }\r\n    return name;\r\n}\r\nfunction _getEvtNamespace(eventName, evtNamespace) {\r\n    var _a;\r\n    if (evtNamespace) {\r\n        var theNamespace_1 = STR_EMPTY;\r\n        if (isArray(evtNamespace)) {\r\n            theNamespace_1 = STR_EMPTY;\r\n            arrForEach(evtNamespace, function (name) {\r\n                name = _normalizeNamespace(name);\r\n                if (name) {\r\n                    if (name[0] !== \".\") {\r\n                        name = \".\" + name;\r\n                    }\r\n                    theNamespace_1 += name;\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            theNamespace_1 = _normalizeNamespace(evtNamespace);\r\n        }\r\n        if (theNamespace_1) {\r\n            if (theNamespace_1[0] !== \".\") {\r\n                theNamespace_1 = \".\" + theNamespace_1;\r\n            }\r\n            // We may only have the namespace and not an eventName\r\n            eventName = (eventName || STR_EMPTY) + theNamespace_1;\r\n        }\r\n    }\r\n    var parsedEvent = (eventNamespace.exec(eventName || STR_EMPTY) || []);\r\n    return _a = {},\r\n        _a[_DYN_TYPE /* @min:type */] = parsedEvent[1],\r\n        _a.ns = ((parsedEvent[2] || STR_EMPTY).replace(rRemoveEmptyNs, \".\").replace(rRemoveTrailingEmptyNs, STR_EMPTY)[_DYN_SPLIT /* @min:%2esplit */](\".\").sort()).join(\".\"),\r\n        _a;\r\n}\r\n/**\r\n * Get all of the registered events on the target object, this is primarily used for testing cleanup but may also be used by\r\n * applications to remove their own events\r\n * @param target - The EventTarget that has registered events\r\n * @param eventName - [Optional] The name of the event to return the registered handlers and full name (with namespaces)\r\n * @param evtNamespace - [Optional] Additional namespace(s) to append to the event listeners so they can be uniquely identified and removed based on this namespace,\r\n * if the eventName also includes a namespace the namespace(s) are merged into a single namespace\r\n */\r\nexport function __getRegisteredEvents(target, eventName, evtNamespace) {\r\n    var theEvents = [];\r\n    var eventCache = elmNodeData.get(target, strEvents, {}, false);\r\n    var evtName = _getEvtNamespace(eventName, evtNamespace);\r\n    objForEachKey(eventCache, function (evtType, registeredEvents) {\r\n        arrForEach(registeredEvents, function (value) {\r\n            var _a;\r\n            if (!evtName[_DYN_TYPE /* @min:%2etype */] || evtName[_DYN_TYPE /* @min:%2etype */] === value.evtName[_DYN_TYPE /* @min:%2etype */]) {\r\n                if (!evtName.ns || evtName.ns === evtName.ns) {\r\n                    theEvents[_DYN_PUSH /* @min:%2epush */]((_a = {},\r\n                        _a[_DYN_NAME /* @min:name */] = value.evtName[_DYN_TYPE /* @min:%2etype */] + (value.evtName.ns ? \".\" + value.evtName.ns : STR_EMPTY),\r\n                        _a.handler = value[_DYN_HANDLER /* @min:%2ehandler */],\r\n                        _a));\r\n                }\r\n            }\r\n        });\r\n    });\r\n    return theEvents;\r\n}\r\n// Exported for internal unit testing only\r\nfunction _getRegisteredEvents(target, evtName, addDefault) {\r\n    if (addDefault === void 0) { addDefault = true; }\r\n    var aiEvts = elmNodeData.get(target, strEvents, {}, addDefault);\r\n    var registeredEvents = aiEvts[evtName];\r\n    if (!registeredEvents) {\r\n        registeredEvents = aiEvts[evtName] = [];\r\n    }\r\n    return registeredEvents;\r\n}\r\nfunction _doDetach(obj, evtName, handlerRef, useCapture) {\r\n    if (obj && evtName && evtName[_DYN_TYPE /* @min:%2etype */]) {\r\n        if (obj[strRemoveEventListener]) {\r\n            obj[strRemoveEventListener](evtName[_DYN_TYPE /* @min:%2etype */], handlerRef, useCapture);\r\n        }\r\n        else if (obj[strDetachEvent]) {\r\n            obj[strDetachEvent](strOnPrefix + evtName[_DYN_TYPE /* @min:%2etype */], handlerRef);\r\n        }\r\n    }\r\n}\r\nfunction _doAttach(obj, evtName, handlerRef, useCapture) {\r\n    var result = false;\r\n    if (obj && evtName && evtName[_DYN_TYPE /* @min:%2etype */] && handlerRef) {\r\n        if (obj[strAddEventHelper]) {\r\n            // all browsers except IE before version 9\r\n            obj[strAddEventHelper](evtName[_DYN_TYPE /* @min:%2etype */], handlerRef, useCapture);\r\n            result = true;\r\n        }\r\n        else if (obj[strAttachEvent]) {\r\n            // IE before version 9\r\n            obj[strAttachEvent](strOnPrefix + evtName[_DYN_TYPE /* @min:%2etype */], handlerRef);\r\n            result = true;\r\n        }\r\n    }\r\n    return result;\r\n}\r\nfunction _doUnregister(target, events, evtName, unRegFn) {\r\n    var idx = events[_DYN_LENGTH /* @min:%2elength */];\r\n    while (idx--) {\r\n        var theEvent = events[idx];\r\n        if (theEvent) {\r\n            if (!evtName.ns || evtName.ns === theEvent.evtName.ns) {\r\n                if (!unRegFn || unRegFn(theEvent)) {\r\n                    _doDetach(target, theEvent.evtName, theEvent[_DYN_HANDLER /* @min:%2ehandler */], theEvent.capture);\r\n                    // Remove the registered event\r\n                    events[_DYN_SPLICE /* @min:%2esplice */](idx, 1);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction _unregisterEvents(target, evtName, unRegFn) {\r\n    if (evtName[_DYN_TYPE /* @min:%2etype */]) {\r\n        _doUnregister(target, _getRegisteredEvents(target, evtName[_DYN_TYPE /* @min:%2etype */]), evtName, unRegFn);\r\n    }\r\n    else {\r\n        var eventCache = elmNodeData.get(target, strEvents, {});\r\n        objForEachKey(eventCache, function (evtType, events) {\r\n            _doUnregister(target, events, evtName, unRegFn);\r\n        });\r\n        // Cleanup\r\n        if (objKeys(eventCache)[_DYN_LENGTH /* @min:%2elength */] === 0) {\r\n            elmNodeData.kill(target, strEvents);\r\n        }\r\n    }\r\n}\r\nexport function mergeEvtNamespace(theNamespace, namespaces) {\r\n    var newNamespaces;\r\n    if (namespaces) {\r\n        if (isArray(namespaces)) {\r\n            newNamespaces = [theNamespace].concat(namespaces);\r\n        }\r\n        else {\r\n            newNamespaces = [theNamespace, namespaces];\r\n        }\r\n        // resort the namespaces so they are always in order\r\n        newNamespaces = (_getEvtNamespace(\"xx\", newNamespaces).ns)[_DYN_SPLIT /* @min:%2esplit */](\".\");\r\n    }\r\n    else {\r\n        newNamespaces = theNamespace;\r\n    }\r\n    return newNamespaces;\r\n}\r\n/**\r\n * Binds the specified function to an event, so that the function gets called whenever the event fires on the object\r\n * @param obj - Object to add the event too.\r\n * @param eventName - String that specifies any of the standard DHTML Events without \"on\" prefix, if may also include an optional (dot \".\" prefixed)\r\n * namespaces \"click\" \"click.mynamespace\" in addition to specific namespaces.\r\n * @param handlerRef - Pointer that specifies the function to call when event fires\r\n * @param evtNamespace - [Optional] Additional namespace(s) to append to the event listeners so they can be uniquely identified and removed based on this namespace,\r\n * if the eventName also includes a namespace the namespace(s) are merged into a single namespace\r\n * @param useCapture - [Optional] Defaults to false\r\n * @returns True if the function was bound successfully to the event, otherwise false\r\n */\r\nexport function eventOn(target, eventName, handlerRef, evtNamespace, useCapture) {\r\n    var _a;\r\n    if (useCapture === void 0) { useCapture = false; }\r\n    var result = false;\r\n    if (target) {\r\n        try {\r\n            var evtName = _getEvtNamespace(eventName, evtNamespace);\r\n            result = _doAttach(target, evtName, handlerRef, useCapture);\r\n            if (result && elmNodeData.accept(target)) {\r\n                var registeredEvent = (_a = {\r\n                        guid: _guid++,\r\n                        evtName: evtName\r\n                    },\r\n                    _a[_DYN_HANDLER /* @min:handler */] = handlerRef,\r\n                    _a.capture = useCapture,\r\n                    _a);\r\n                _getRegisteredEvents(target, evtName.type)[_DYN_PUSH /* @min:%2epush */](registeredEvent);\r\n            }\r\n        }\r\n        catch (e) {\r\n            // Just Ignore any error so that we don't break any execution path\r\n        }\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * Removes an event handler for the specified event\r\n * @param Object - to remove the event from\r\n * @param eventName - {string} - The name of the event, with optional namespaces or just the namespaces,\r\n * such as \"click\", \"click.mynamespace\" or \".mynamespace\"\r\n * @param handlerRef - {any} - The callback function that needs to be removed from the given event, when using a\r\n * namespace (with or without a qualifying event) this may be null to remove all previously attached event handlers\r\n * otherwise this will only remove events with this specific handler.\r\n * @param evtNamespace - [Optional] Additional namespace(s) to append to the event listeners so they can be uniquely identified and removed based on this namespace,\r\n * if the eventName also includes a namespace the namespace(s) are merged into a single namespace\r\n * @param useCapture - [Optional] Defaults to false\r\n */\r\nexport function eventOff(target, eventName, handlerRef, evtNamespace, useCapture) {\r\n    if (useCapture === void 0) { useCapture = false; }\r\n    if (target) {\r\n        try {\r\n            var evtName_1 = _getEvtNamespace(eventName, evtNamespace);\r\n            var found_1 = false;\r\n            _unregisterEvents(target, evtName_1, function (regEvent) {\r\n                if ((evtName_1.ns && !handlerRef) || regEvent[_DYN_HANDLER /* @min:%2ehandler */] === handlerRef) {\r\n                    found_1 = true;\r\n                    return true;\r\n                }\r\n                return false;\r\n            });\r\n            if (!found_1) {\r\n                // fallback to try and remove as requested\r\n                _doDetach(target, evtName_1, handlerRef, useCapture);\r\n            }\r\n        }\r\n        catch (e) {\r\n            // Just Ignore any error so that we don't break any execution path\r\n        }\r\n    }\r\n}\r\n/**\r\n * Binds the specified function to an event, so that the function gets called whenever the event fires on the object\r\n * @param obj - Object to add the event too.\r\n * @param eventNameWithoutOn - String that specifies any of the standard DHTML Events without \"on\" prefix and optional (dot \".\" prefixed) namespaces \"click\" \"click.mynamespace\".\r\n * @param handlerRef - Pointer that specifies the function to call when event fires\r\n * @param useCapture - [Optional] Defaults to false\r\n * @returns True if the function was bound successfully to the event, otherwise false\r\n */\r\nexport function attachEvent(obj, eventNameWithoutOn, handlerRef, useCapture) {\r\n    if (useCapture === void 0) { useCapture = false; }\r\n    return eventOn(obj, eventNameWithoutOn, handlerRef, null, useCapture);\r\n}\r\n/**\r\n * Removes an event handler for the specified event\r\n * @param Object - to remove the event from\r\n * @param eventNameWithoutOn - {string} - The name of the event, with optional namespaces or just the namespaces,\r\n * such as \"click\", \"click.mynamespace\" or \".mynamespace\"\r\n * @param handlerRef - {any} - The callback function that needs to be removed from the given event, when using a\r\n * namespace (with or without a qualifying event) this may be null to remove all previously attached event handlers\r\n * otherwise this will only remove events with this specific handler.\r\n * @param useCapture - [Optional] Defaults to false\r\n */\r\nexport function detachEvent(obj, eventNameWithoutOn, handlerRef, useCapture) {\r\n    if (useCapture === void 0) { useCapture = false; }\r\n    eventOff(obj, eventNameWithoutOn, handlerRef, null, useCapture);\r\n}\r\n/**\r\n * Trys to add an event handler for the specified event to the window, body and document\r\n * @param eventName - {string} - The name of the event\r\n * @param callback - {any} - The callback function that needs to be executed for the given event\r\n * @param evtNamespace - [Optional] Namespace(s) to append to the event listeners so they can be uniquely identified and removed based on this namespace.\r\n * @return {boolean} - true if the handler was successfully added\r\n */\r\nexport function addEventHandler(eventName, callback, evtNamespace) {\r\n    var result = false;\r\n    var w = getWindow();\r\n    if (w) {\r\n        result = eventOn(w, eventName, callback, evtNamespace);\r\n        result = eventOn(w[\"body\"], eventName, callback, evtNamespace) || result;\r\n    }\r\n    var doc = getDocument();\r\n    if (doc) {\r\n        result = eventOn(doc, eventName, callback, evtNamespace) || result;\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * Trys to remove event handler(s) for the specified event/namespace to the window, body and document\r\n * @param eventName - {string} - The name of the event, with optional namespaces or just the namespaces,\r\n * such as \"click\", \"click.mynamespace\" or \".mynamespace\"\r\n * @param callback - {any} - - The callback function that needs to be removed from the given event, when using a\r\n * namespace (with or without a qualifying event) this may be null to remove all previously attached event handlers\r\n * otherwise this will only remove events with this specific handler.\r\n * @param evtNamespace - [Optional] Namespace(s) to append to the event listeners so they can be uniquely identified and removed based on this namespace.\r\n */\r\nexport function removeEventHandler(eventName, callback, evtNamespace) {\r\n    var w = getWindow();\r\n    if (w) {\r\n        eventOff(w, eventName, callback, evtNamespace);\r\n        eventOff(w[\"body\"], eventName, callback, evtNamespace);\r\n    }\r\n    var doc = getDocument();\r\n    if (doc) {\r\n        eventOff(doc, eventName, callback, evtNamespace);\r\n    }\r\n}\r\n/**\r\n * Bind the listener to the array of events\r\n * @param events - An string array of event names to bind the listener to\r\n * @param listener - The event callback to call when the event is triggered\r\n * @param excludeEvents - [Optional] An array of events that should not be hooked (if possible), unless no other events can be.\r\n * @param evtNamespace - [Optional] Namespace(s) to append to the event listeners so they can be uniquely identified and removed based on this namespace.\r\n * @returns true - when at least one of the events was registered otherwise false\r\n */\r\nfunction _addEventListeners(events, listener, excludeEvents, evtNamespace) {\r\n    var added = false;\r\n    if (listener && events && events[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n        arrForEach(events, function (name) {\r\n            if (name) {\r\n                if (!excludeEvents || arrIndexOf(excludeEvents, name) === -1) {\r\n                    added = addEventHandler(name, listener, evtNamespace) || added;\r\n                }\r\n            }\r\n        });\r\n    }\r\n    return added;\r\n}\r\n/**\r\n * Bind the listener to the array of events\r\n * @param events - An string array of event names to bind the listener to\r\n * @param listener - The event callback to call when the event is triggered\r\n * @param excludeEvents - [Optional] An array of events that should not be hooked (if possible), unless no other events can be.\r\n * @param evtNamespace - [Optional] Namespace(s) to append to the event listeners so they can be uniquely identified and removed based on this namespace.\r\n * @returns true - when at least one of the events was registered otherwise false\r\n */\r\nexport function addEventListeners(events, listener, excludeEvents, evtNamespace) {\r\n    var added = false;\r\n    if (listener && events && isArray(events)) {\r\n        added = _addEventListeners(events, listener, excludeEvents, evtNamespace);\r\n        if (!added && excludeEvents && excludeEvents[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n            // Failed to add any listeners and we excluded some, so just attempt to add the excluded events\r\n            added = _addEventListeners(events, listener, null, evtNamespace);\r\n        }\r\n    }\r\n    return added;\r\n}\r\n/**\r\n * Remove the listener from the array of events\r\n * @param events - An string array of event names to bind the listener to\r\n * @param listener - The event callback to call when the event is triggered\r\n * @param evtNamespace - [Optional] Namespace(s) to append to the event listeners so they can be uniquely identified and removed based on this namespace.\r\n */\r\nexport function removeEventListeners(events, listener, evtNamespace) {\r\n    if (events && isArray(events)) {\r\n        arrForEach(events, function (name) {\r\n            if (name) {\r\n                removeEventHandler(name, listener, evtNamespace);\r\n            }\r\n        });\r\n    }\r\n}\r\n/**\r\n * Listen to the 'beforeunload', 'unload' and 'pagehide' events which indicates a page unload is occurring,\r\n * this does NOT listen to the 'visibilitychange' event as while it does indicate that the page is being hidden\r\n * it does not *necessarily* mean that the page is being completely unloaded, it can mean that the user is\r\n * just navigating to a different Tab and may come back (without unloading the page). As such you may also\r\n * need to listen to the 'addPageHideEventListener' and 'addPageShowEventListener' events.\r\n * @param listener - The event callback to call when a page unload event is triggered\r\n * @param excludeEvents - [Optional] An array of events that should not be hooked, unless no other events can be.\r\n * @param evtNamespace - [Optional] Namespace(s) to append to the event listeners so they can be uniquely identified and removed based on this namespace.\r\n * @returns true - when at least one of the events was registered otherwise false\r\n */\r\nexport function addPageUnloadEventListener(listener, excludeEvents, evtNamespace) {\r\n    // Hook the unload event for the document, window and body to ensure that the client events are flushed to the server\r\n    // As just hooking the window does not always fire (on chrome) for page navigation's.\r\n    return addEventListeners([strBeforeUnload, strUnload, strPageHide], listener, excludeEvents, evtNamespace);\r\n}\r\n/**\r\n * Remove any matching 'beforeunload', 'unload' and 'pagehide' events that may have been added via addEventListener,\r\n * addEventListeners, addPageUnloadEventListener or addPageHideEventListener.\r\n * @param listener - The specific event callback to to be removed\r\n * @param evtNamespace - [Optional] Namespace(s) uniquely identified and removed based on this namespace.\r\n * @returns true - when at least one of the events was registered otherwise false\r\n */\r\nexport function removePageUnloadEventListener(listener, evtNamespace) {\r\n    removeEventListeners([strBeforeUnload, strUnload, strPageHide], listener, evtNamespace);\r\n}\r\n/**\r\n * Listen to the pagehide and visibility changing to 'hidden' events, because the 'visibilitychange' uses\r\n * an internal proxy to detect the visibility state you SHOULD use a unique namespace when if you plan to call\r\n * removePageShowEventListener as the remove ignores the listener argument for the 'visibilitychange' event.\r\n * @param listener - The event callback to call when a page hide event is triggered\r\n * @param excludeEvents - [Optional] An array of events that should not be hooked (if possible), unless no other events can be.\r\n * @param evtNamespace - [Optional] A Namespace to append to the event listeners so they can be uniquely identified and removed\r\n * based on this namespace. This call also adds an additional unique \"pageshow\" namespace to the events\r\n * so that only the matching \"removePageHideEventListener\" can remove these events.\r\n * Suggestion: pass as true if you are also calling addPageUnloadEventListener as that also hooks pagehide\r\n * @returns true - when at least one of the events was registered otherwise false\r\n */\r\nexport function addPageHideEventListener(listener, excludeEvents, evtNamespace) {\r\n    function _handlePageVisibility(evt) {\r\n        var doc = getDocument();\r\n        if (listener && doc && doc.visibilityState === \"hidden\") {\r\n            listener(evt);\r\n        }\r\n    }\r\n    // add the unique page show namespace to any provided namespace so we can only remove the ones added by \"pagehide\"\r\n    var newNamespaces = mergeEvtNamespace(strPageHideNamespace, evtNamespace);\r\n    var pageUnloadAdded = _addEventListeners([strPageHide], listener, excludeEvents, newNamespaces);\r\n    if (!excludeEvents || arrIndexOf(excludeEvents, strVisibilityChangeEvt) === -1) {\r\n        pageUnloadAdded = _addEventListeners([strVisibilityChangeEvt], _handlePageVisibility, excludeEvents, newNamespaces) || pageUnloadAdded;\r\n    }\r\n    if (!pageUnloadAdded && excludeEvents) {\r\n        // Failed to add any listeners and we where requested to exclude some, so just call again without excluding anything\r\n        pageUnloadAdded = addPageHideEventListener(listener, null, evtNamespace);\r\n    }\r\n    return pageUnloadAdded;\r\n}\r\n/**\r\n * Removes the pageHide event listeners added by addPageHideEventListener, because the 'visibilitychange' uses\r\n * an internal proxy to detect the visibility state you SHOULD use a unique namespace when calling addPageHideEventListener\r\n * as the remove ignores the listener argument for the 'visibilitychange' event.\r\n * @param listener - The specific listener to remove for the 'pageshow' event only (ignored for 'visibilitychange')\r\n * @param evtNamespace - The unique namespace used when calling addPageShowEventListener\r\n */\r\nexport function removePageHideEventListener(listener, evtNamespace) {\r\n    // add the unique page show namespace to any provided namespace so we only remove the ones added by \"pagehide\"\r\n    var newNamespaces = mergeEvtNamespace(strPageHideNamespace, evtNamespace);\r\n    removeEventListeners([strPageHide], listener, newNamespaces);\r\n    removeEventListeners([strVisibilityChangeEvt], null, newNamespaces);\r\n}\r\n/**\r\n * Listen to the pageshow and visibility changing to 'visible' events, because the 'visibilitychange' uses\r\n * an internal proxy to detect the visibility state you SHOULD use a unique namespace when if you plan to call\r\n * removePageShowEventListener as the remove ignores the listener argument for the 'visibilitychange' event.\r\n * @param listener - The event callback to call when a page is show event is triggered\r\n * @param excludeEvents - [Optional] An array of events that should not be hooked (if possible), unless no other events can be.\r\n * @param evtNamespace - [Optional/Recommended] A Namespace to append to the event listeners so they can be uniquely\r\n * identified and removed based on this namespace. This call also adds an additional unique \"pageshow\" namespace to the events\r\n * so that only the matching \"removePageShowEventListener\" can remove these events.\r\n * @returns true - when at least one of the events was registered otherwise false\r\n */\r\nexport function addPageShowEventListener(listener, excludeEvents, evtNamespace) {\r\n    function _handlePageVisibility(evt) {\r\n        var doc = getDocument();\r\n        if (listener && doc && doc.visibilityState === \"visible\") {\r\n            listener(evt);\r\n        }\r\n    }\r\n    // add the unique page show namespace to any provided namespace so we can only remove the ones added by \"pageshow\"\r\n    var newNamespaces = mergeEvtNamespace(strPageShowNamespace, evtNamespace);\r\n    var pageShowAdded = _addEventListeners([strPageShow], listener, excludeEvents, newNamespaces);\r\n    pageShowAdded = _addEventListeners([strVisibilityChangeEvt], _handlePageVisibility, excludeEvents, newNamespaces) || pageShowAdded;\r\n    if (!pageShowAdded && excludeEvents) {\r\n        // Failed to add any listeners and we where requested to exclude some, so just call again without excluding anything\r\n        pageShowAdded = addPageShowEventListener(listener, null, evtNamespace);\r\n    }\r\n    return pageShowAdded;\r\n}\r\n/**\r\n * Removes the pageShow event listeners added by addPageShowEventListener, because the 'visibilitychange' uses\r\n * an internal proxy to detect the visibility state you SHOULD use a unique namespace when calling addPageShowEventListener\r\n * as the remove ignores the listener argument for the 'visibilitychange' event.\r\n * @param listener - The specific listener to remove for the 'pageshow' event only (ignored for 'visibilitychange')\r\n * @param evtNamespace - The unique namespace used when calling addPageShowEventListener\r\n */\r\nexport function removePageShowEventListener(listener, evtNamespace) {\r\n    // add the unique page show namespace to any provided namespace so we only remove the ones added by \"pageshow\"\r\n    var newNamespaces = mergeEvtNamespace(strPageShowNamespace, evtNamespace);\r\n    removeEventListeners([strPageShow], listener, newNamespaces);\r\n    removeEventListeners([strVisibilityChangeEvt], null, newNamespaces);\r\n}\r\n//# sourceMappingURL=EventHelpers.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { ObjAssign, ObjClass } from \"@microsoft/applicationinsights-shims\";\r\nimport { arrForEach, asString as asString21, isArray, isBoolean, isError, isFunction, isNullOrUndefined, isNumber, isObject, isPlainObject, isString, isUndefined, objDeepFreeze, objDefine, objForEachKey, objHasOwn, strIndexOf, strTrim } from \"@nevware21/ts-utils\";\r\nimport { _DYN_APPLY, _DYN_GET_ALL_RESPONSE_HEA5, _DYN_GET_RESPONSE_HEADER, _DYN_LENGTH, _DYN_NAME, _DYN_REPLACE, _DYN_SPLIT, _DYN_STATUS, _DYN_TO_LOWER_CASE } from \"../__DynamicConstants\";\r\nimport { STR_EMPTY } from \"./InternalConstants\";\r\n// RESTRICT and AVOID circular dependencies you should not import other contained modules or export the contents of this file directly\r\n// Added to help with minification\r\nvar strGetPrototypeOf = \"getPrototypeOf\";\r\nvar rCamelCase = /-([a-z])/g;\r\nvar rNormalizeInvalid = /([^\\w\\d_$])/g;\r\nvar rLeadingNumeric = /^(\\d+[\\w\\d_$])/;\r\nexport var _getObjProto = Object[strGetPrototypeOf];\r\nexport function isNotUndefined(value) {\r\n    return !isUndefined(value);\r\n}\r\nexport function isNotNullOrUndefined(value) {\r\n    return !isNullOrUndefined(value);\r\n}\r\n/**\r\n * Validates that the string name conforms to the JS IdentifierName specification and if not\r\n * normalizes the name so that it would. This method does not identify or change any keywords\r\n * meaning that if you pass in a known keyword the same value will be returned.\r\n * This is a simplified version\r\n * @param name - The name to validate\r\n */\r\nexport function normalizeJsName(name) {\r\n    var value = name;\r\n    if (value && isString(value)) {\r\n        // CamelCase everything after the \"-\" and remove the dash\r\n        value = value[_DYN_REPLACE /* @min:%2ereplace */](rCamelCase, function (_all, letter) {\r\n            return letter.toUpperCase();\r\n        });\r\n        value = value[_DYN_REPLACE /* @min:%2ereplace */](rNormalizeInvalid, \"_\");\r\n        value = value[_DYN_REPLACE /* @min:%2ereplace */](rLeadingNumeric, function (_all, match) {\r\n            return \"_\" + match;\r\n        });\r\n    }\r\n    return value;\r\n}\r\n/**\r\n * A simple wrapper (for minification support) to check if the value contains the search string.\r\n * @param value - The string value to check for the existence of the search value\r\n * @param search - The value search within the value\r\n */\r\nexport function strContains(value, search) {\r\n    if (value && search) {\r\n        return strIndexOf(value, search) !== -1;\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * Convert a date to I.S.O. format in IE8\r\n */\r\nexport function toISOString(date) {\r\n    return date && date.toISOString() || \"\";\r\n}\r\nexport var deepFreeze = objDeepFreeze;\r\n/**\r\n * Returns the name of object if it's an Error. Otherwise, returns empty string.\r\n */\r\nexport function getExceptionName(object) {\r\n    if (isError(object)) {\r\n        return object[_DYN_NAME /* @min:%2ename */];\r\n    }\r\n    return STR_EMPTY;\r\n}\r\n/**\r\n * Sets the provided value on the target instance using the field name when the provided chk function returns true, the chk\r\n * function will only be called if the new value is no equal to the original value.\r\n * @param target - The target object\r\n * @param field - The key of the target\r\n * @param value - The value to set\r\n * @param valChk - [Optional] Callback to check the value that if supplied will be called check if the new value can be set\r\n * @param srcChk - [Optional] Callback to check to original value that if supplied will be called if the new value should be set (if allowed)\r\n * @returns The existing or new value, depending what was set\r\n */\r\nexport function setValue(target, field, value, valChk, srcChk) {\r\n    var theValue = value;\r\n    if (target) {\r\n        theValue = target[field];\r\n        if (theValue !== value && (!srcChk || srcChk(theValue)) && (!valChk || valChk(value))) {\r\n            theValue = value;\r\n            target[field] = theValue;\r\n        }\r\n    }\r\n    return theValue;\r\n}\r\n/**\r\n * Returns the current value from the target object if not null or undefined otherwise sets the new value and returns it\r\n * @param target - The target object to return or set the default value\r\n * @param field - The key for the field to set on the target\r\n * @param defValue - [Optional] The value to set if not already present, when not provided a empty object will be added\r\n */\r\nexport function getSetValue(target, field, defValue) {\r\n    var theValue;\r\n    if (target) {\r\n        theValue = target[field];\r\n        if (!theValue && isNullOrUndefined(theValue)) {\r\n            // Supports having the default as null\r\n            theValue = !isUndefined(defValue) ? defValue : {};\r\n            target[field] = theValue;\r\n        }\r\n    }\r\n    else {\r\n        // Expanded for performance so we only check defValue if required\r\n        theValue = !isUndefined(defValue) ? defValue : {};\r\n    }\r\n    return theValue;\r\n}\r\nfunction _createProxyFunction(source, funcName) {\r\n    var srcFunc = null;\r\n    var src = null;\r\n    if (isFunction(source)) {\r\n        srcFunc = source;\r\n    }\r\n    else {\r\n        src = source;\r\n    }\r\n    return function () {\r\n        // Capture the original arguments passed to the method\r\n        var originalArguments = arguments;\r\n        if (srcFunc) {\r\n            src = srcFunc();\r\n        }\r\n        if (src) {\r\n            return src[funcName][_DYN_APPLY /* @min:%2eapply */](src, originalArguments);\r\n        }\r\n    };\r\n}\r\n/**\r\n * Effectively assigns all enumerable properties (not just own properties) and functions (including inherited prototype) from\r\n * the source object to the target, it attempts to use proxy getters / setters (if possible) and proxy functions to avoid potential\r\n * implementation issues by assigning prototype functions as instance ones\r\n *\r\n * This method is the primary method used to \"update\" the snippet proxy with the ultimate implementations.\r\n *\r\n * Special ES3 Notes:\r\n * Updates (setting) of direct property values on the target or indirectly on the source object WILL NOT WORK PROPERLY, updates to the\r\n * properties of \"referenced\" object will work (target.context.newValue = 10 => will be reflected in the source.context as it's the\r\n * same object). ES3 Failures: assigning target.myProp = 3 -> Won't change source.myProp = 3, likewise the reverse would also fail.\r\n * @param target - The target object to be assigned with the source properties and functions\r\n * @param source - The source object which will be assigned / called by setting / calling the targets proxies\r\n * @param chkSet - An optional callback to determine whether a specific property/function should be proxied\r\n */\r\nexport function proxyAssign(target, source, chkSet) {\r\n    if (target && source && isObject(target) && isObject(source)) {\r\n        var _loop_1 = function (field) {\r\n            if (isString(field)) {\r\n                var value = source[field];\r\n                if (isFunction(value)) {\r\n                    if (!chkSet || chkSet(field, true, source, target)) {\r\n                        // Create a proxy function rather than just copying the (possible) prototype to the new object as an instance function\r\n                        target[field] = _createProxyFunction(source, field);\r\n                    }\r\n                }\r\n                else if (!chkSet || chkSet(field, false, source, target)) {\r\n                    if (objHasOwn(target, field)) {\r\n                        // Remove any previous instance property\r\n                        delete target[field];\r\n                    }\r\n                    objDefine(target, field, {\r\n                        g: function () {\r\n                            return source[field];\r\n                        },\r\n                        s: function (theValue) {\r\n                            source[field] = theValue;\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        };\r\n        // effectively apply/proxy full source to the target instance\r\n        for (var field in source) {\r\n            _loop_1(field);\r\n        }\r\n    }\r\n    return target;\r\n}\r\n/**\r\n * Creates a proxy function on the target which internally will call the source version with all arguments passed to the target method.\r\n *\r\n * @param target - The target object to be assigned with the source properties and functions\r\n * @param name - The function name that will be added on the target\r\n * @param source - The source object which will be assigned / called by setting / calling the targets proxies\r\n * @param theFunc - The function name on the source that will be proxied on the target\r\n * @param overwriteTarget - If `false` this will not replace any pre-existing name otherwise (the default) it will overwrite any existing name\r\n */\r\nexport function proxyFunctionAs(target, name, source, theFunc, overwriteTarget) {\r\n    if (target && name && source) {\r\n        if (overwriteTarget !== false || isUndefined(target[name])) {\r\n            target[name] = _createProxyFunction(source, theFunc);\r\n        }\r\n    }\r\n}\r\n/**\r\n * Creates proxy functions on the target which internally will call the source version with all arguments passed to the target method.\r\n *\r\n * @param target - The target object to be assigned with the source properties and functions\r\n * @param source - The source object which will be assigned / called by setting / calling the targets proxies\r\n * @param functionsToProxy - An array of function names that will be proxied on the target\r\n * @param overwriteTarget - If false this will not replace any pre-existing name otherwise (the default) it will overwrite any existing name\r\n */\r\nexport function proxyFunctions(target, source, functionsToProxy, overwriteTarget) {\r\n    if (target && source && isObject(target) && isArray(functionsToProxy)) {\r\n        arrForEach(functionsToProxy, function (theFuncName) {\r\n            if (isString(theFuncName)) {\r\n                proxyFunctionAs(target, theFuncName, source, theFuncName, overwriteTarget);\r\n            }\r\n        });\r\n    }\r\n    return target;\r\n}\r\n/**\r\n * Simpler helper to create a dynamic class that implements the interface and populates the values with the defaults.\r\n * Only instance properties (hasOwnProperty) values are copied from the defaults to the new instance\r\n * @param defaults - Simple helper\r\n */\r\nexport function createClassFromInterface(defaults) {\r\n    return /** @class */ (function () {\r\n        function class_1() {\r\n            var _this = this;\r\n            if (defaults) {\r\n                objForEachKey(defaults, function (field, value) {\r\n                    _this[field] = value;\r\n                });\r\n            }\r\n        }\r\n        return class_1;\r\n    }());\r\n}\r\n/**\r\n * A helper function to assist with JIT performance for objects that have properties added / removed dynamically\r\n * this is primarily for chromium based browsers and has limited effects on Firefox and none of IE. Only call this\r\n * function after you have finished \"updating\" the object, calling this within loops reduces or defeats the benefits.\r\n * This helps when iterating using for..in, objKeys() and objForEach()\r\n * @param theObject - The object to be optimized if possible\r\n */\r\nexport function optimizeObject(theObject) {\r\n    // V8 Optimization to cause the JIT compiler to create a new optimized object for looking up the own properties\r\n    // primarily for object with <= 19 properties for >= 20 the effect is reduced or non-existent\r\n    if (theObject && ObjAssign) {\r\n        theObject = ObjClass(ObjAssign({}, theObject));\r\n    }\r\n    return theObject;\r\n}\r\nexport function objExtend(obj1, obj2, obj3, obj4, obj5, obj6) {\r\n    // Variables\r\n    var theArgs = arguments;\r\n    var extended = theArgs[0] || {};\r\n    var argLen = theArgs[_DYN_LENGTH /* @min:%2elength */];\r\n    var deep = false;\r\n    var idx = 1;\r\n    // Check for \"Deep\" flag\r\n    if (argLen > 0 && isBoolean(extended)) {\r\n        deep = extended;\r\n        extended = theArgs[idx] || {};\r\n        idx++;\r\n    }\r\n    // Handle case when target is a string or something (possible in deep copy)\r\n    if (!isObject(extended)) {\r\n        extended = {};\r\n    }\r\n    // Loop through each remaining object and conduct a merge\r\n    for (; idx < argLen; idx++) {\r\n        var arg = theArgs[idx];\r\n        var isArgArray = isArray(arg);\r\n        var isArgObj = isObject(arg);\r\n        for (var prop in arg) {\r\n            var propOk = (isArgArray && (prop in arg)) || (isArgObj && objHasOwn(arg, prop));\r\n            if (!propOk) {\r\n                continue;\r\n            }\r\n            var newValue = arg[prop];\r\n            var isNewArray = void 0;\r\n            // If deep merge and property is an object, merge properties\r\n            if (deep && newValue && ((isNewArray = isArray(newValue)) || isPlainObject(newValue))) {\r\n                // Grab the current value of the extended object\r\n                var clone = extended[prop];\r\n                if (isNewArray) {\r\n                    if (!isArray(clone)) {\r\n                        // We can't \"merge\" an array with a non-array so overwrite the original\r\n                        clone = [];\r\n                    }\r\n                }\r\n                else if (!isPlainObject(clone)) {\r\n                    // We can't \"merge\" an object with a non-object\r\n                    clone = {};\r\n                }\r\n                // Never move the original objects always clone them\r\n                newValue = objExtend(deep, clone, newValue);\r\n            }\r\n            // Assign the new (or previous) value (unless undefined)\r\n            if (newValue !== undefined) {\r\n                extended[prop] = newValue;\r\n            }\r\n        }\r\n    }\r\n    return extended;\r\n}\r\nexport var asString = asString21;\r\nexport function isFeatureEnabled(feature, cfg) {\r\n    var rlt = false;\r\n    var ft = cfg && cfg.featureOptIn && cfg.featureOptIn[feature];\r\n    if (feature && ft) {\r\n        var mode = ft.mode;\r\n        // NOTE: None will be considered as true\r\n        rlt = (mode == 3 /* FeatureOptInMode.enable */) || (mode == 1 /* FeatureOptInMode.none */);\r\n    }\r\n    return rlt;\r\n}\r\nexport function getResponseText(xhr) {\r\n    try {\r\n        return xhr.responseText;\r\n    }\r\n    catch (e) {\r\n        // Best effort, as XHR may throw while XDR wont so just ignore\r\n    }\r\n    return null;\r\n}\r\nexport function formatErrorMessageXdr(xdr, message) {\r\n    if (xdr) {\r\n        return \"XDomainRequest,Response:\" + getResponseText(xdr) || \"\";\r\n    }\r\n    return message;\r\n}\r\nexport function formatErrorMessageXhr(xhr, message) {\r\n    if (xhr) {\r\n        return \"XMLHttpRequest,Status:\" + xhr[_DYN_STATUS /* @min:%2estatus */] + \",Response:\" + getResponseText(xhr) || xhr.response || \"\";\r\n    }\r\n    return message;\r\n}\r\nexport function prependTransports(theTransports, newTransports) {\r\n    if (newTransports) {\r\n        if (isNumber(newTransports)) {\r\n            theTransports = [newTransports].concat(theTransports);\r\n        }\r\n        else if (isArray(newTransports)) {\r\n            theTransports = newTransports.concat(theTransports);\r\n        }\r\n    }\r\n    return theTransports;\r\n}\r\nvar strDisabledPropertyName = \"Microsoft_ApplicationInsights_BypassAjaxInstrumentation\";\r\nvar strWithCredentials = \"withCredentials\";\r\nvar strTimeout = \"timeout\";\r\n/**\r\n * Create and open an XMLHttpRequest object\r\n * @param method - The request method\r\n * @param urlString - The url\r\n * @param withCredentials - Option flag indicating that credentials should be sent\r\n * @param disabled - Optional flag indicating that the XHR object should be marked as disabled and not tracked (default is false)\r\n * @param isSync - Optional flag indicating if the instance should be a synchronous request (defaults to false)\r\n * @param timeout - Optional value identifying the timeout value that should be assigned to the XHR request\r\n * @returns A new opened XHR request\r\n */\r\nexport function openXhr(method, urlString, withCredentials, disabled, isSync, timeout) {\r\n    if (disabled === void 0) { disabled = false; }\r\n    if (isSync === void 0) { isSync = false; }\r\n    function _wrapSetXhrProp(xhr, prop, value) {\r\n        try {\r\n            xhr[prop] = value;\r\n        }\r\n        catch (e) {\r\n            // - Wrapping as depending on the environment setting the property may fail (non-terminally)\r\n        }\r\n    }\r\n    var xhr = new XMLHttpRequest();\r\n    if (disabled) {\r\n        // Tag the instance so it's not tracked (trackDependency)\r\n        // If the environment has locked down the XMLHttpRequest (preventExtensions and/or freeze), this would\r\n        // cause the request to fail and we no telemetry would be sent\r\n        _wrapSetXhrProp(xhr, strDisabledPropertyName, disabled);\r\n    }\r\n    if (withCredentials) {\r\n        // Some libraries require that the withCredentials flag is set \"before\" open and\r\n        // - Wrapping as IE 10 has started throwing when setting before open\r\n        _wrapSetXhrProp(xhr, strWithCredentials, withCredentials);\r\n    }\r\n    xhr.open(method, urlString, !isSync);\r\n    if (withCredentials) {\r\n        // withCredentials should be set AFTER open (https://xhr.spec.whatwg.org/#the-withcredentials-attribute)\r\n        // And older firefox instances from 11+ will throw for sync events (current versions don't) which happens during unload processing\r\n        _wrapSetXhrProp(xhr, strWithCredentials, withCredentials);\r\n    }\r\n    // Only set the timeout for asynchronous requests as\r\n    // \"Timeout shouldn't be used for synchronous XMLHttpRequests requests used in a document environment or it will throw an InvalidAccessError exception.\"\"\r\n    // https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/timeout\r\n    if (!isSync && timeout) {\r\n        _wrapSetXhrProp(xhr, strTimeout, timeout);\r\n    }\r\n    return xhr;\r\n}\r\n/**\r\n* Converts the XHR getAllResponseHeaders to a map containing the header key and value.\r\n* @internal\r\n*/\r\n// tslint:disable-next-line: align\r\nexport function convertAllHeadersToMap(headersString) {\r\n    var headers = {};\r\n    if (isString(headersString)) {\r\n        var headersArray = strTrim(headersString)[_DYN_SPLIT /* @min:%2esplit */](/[\\r\\n]+/);\r\n        arrForEach(headersArray, function (headerEntry) {\r\n            if (headerEntry) {\r\n                var idx = headerEntry.indexOf(\": \");\r\n                if (idx !== -1) {\r\n                    // The new spec has the headers returning all as lowercase -- but not all browsers do this yet\r\n                    var header = strTrim(headerEntry.substring(0, idx))[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */]();\r\n                    var value = strTrim(headerEntry.substring(idx + 1));\r\n                    headers[header] = value;\r\n                }\r\n                else {\r\n                    headers[strTrim(headerEntry)] = 1;\r\n                }\r\n            }\r\n        });\r\n    }\r\n    return headers;\r\n}\r\n/**\r\n* append the XHR headers.\r\n* @internal\r\n*/\r\nexport function _appendHeader(theHeaders, xhr, name) {\r\n    if (!theHeaders[name] && xhr && xhr[_DYN_GET_RESPONSE_HEADER /* @min:%2egetResponseHeader */]) {\r\n        var value = xhr[_DYN_GET_RESPONSE_HEADER /* @min:%2egetResponseHeader */](name);\r\n        if (value) {\r\n            theHeaders[name] = strTrim(value);\r\n        }\r\n    }\r\n    return theHeaders;\r\n}\r\nvar STR_KILL_DURATION_HEADER = \"kill-duration\";\r\nvar STR_KILL_DURATION_SECONDS_HEADER = \"kill-duration-seconds\";\r\nvar STR_TIME_DELTA_HEADER = \"time-delta-millis\";\r\n/**\r\n* get the XHR getAllResponseHeaders.\r\n* @internal\r\n*/\r\nexport function _getAllResponseHeaders(xhr, isOneDs) {\r\n    var theHeaders = {};\r\n    if (!xhr[_DYN_GET_ALL_RESPONSE_HEA5 /* @min:%2egetAllResponseHeaders */]) {\r\n        // Firefox 2-63 doesn't have getAllResponseHeaders function but it does have getResponseHeader\r\n        // Only call these if getAllResponseHeaders doesn't exist, otherwise we can get invalid response errors\r\n        // as collector is not currently returning the correct header to allow JS to access these headers\r\n        if (!!isOneDs) {\r\n            theHeaders = _appendHeader(theHeaders, xhr, STR_TIME_DELTA_HEADER);\r\n            theHeaders = _appendHeader(theHeaders, xhr, STR_KILL_DURATION_HEADER);\r\n            theHeaders = _appendHeader(theHeaders, xhr, STR_KILL_DURATION_SECONDS_HEADER);\r\n        }\r\n    }\r\n    else {\r\n        theHeaders = convertAllHeadersToMap(xhr[_DYN_GET_ALL_RESPONSE_HEA5 /* @min:%2egetAllResponseHeaders */]());\r\n    }\r\n    return theHeaders;\r\n}\r\n//# sourceMappingURL=HelperFuncs.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\n// ###################################################################################################################################################\r\n// Note: DON'T Export these const from the package as we are still targeting IE/ES5 this will export a mutable variables that someone could change ###\r\n// ###################################################################################################################################################\r\nexport var UNDEFINED_VALUE = undefined;\r\nexport var STR_EMPTY = \"\";\r\nexport var STR_CHANNELS = \"channels\";\r\nexport var STR_CORE = \"core\";\r\nexport var STR_CREATE_PERF_MGR = \"createPerfMgr\";\r\nexport var STR_DISABLED = \"disabled\";\r\nexport var STR_EXTENSION_CONFIG = \"extensionConfig\";\r\nexport var STR_EXTENSIONS = \"extensions\";\r\nexport var STR_PROCESS_TELEMETRY = \"processTelemetry\";\r\nexport var STR_PRIORITY = \"priority\";\r\nexport var STR_EVENTS_SENT = \"eventsSent\";\r\nexport var STR_EVENTS_DISCARDED = \"eventsDiscarded\";\r\nexport var STR_EVENTS_SEND_REQUEST = \"eventsSendRequest\";\r\nexport var STR_PERF_EVENT = \"perfEvent\";\r\nexport var STR_OFFLINE_STORE = \"offlineEventsStored\";\r\nexport var STR_OFFLINE_SENT = \"offlineBatchSent\";\r\nexport var STR_OFFLINE_DROP = \"offlineBatchDrop\";\r\nexport var STR_GET_PERF_MGR = \"getPerfMgr\";\r\nexport var STR_DOMAIN = \"domain\";\r\nexport var STR_PATH = \"path\";\r\nexport var STR_NOT_DYNAMIC_ERROR = \"Not dynamic - \";\r\n//# sourceMappingURL=InternalConstants.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { createAllPromise, createPromise, doAwaitResponse } from \"@nevware21/ts-async\";\r\nimport { arrForEach, arrIndexOf, objDefine, safe, scheduleTimeout } from \"@nevware21/ts-utils\";\r\nimport { createDynamicConfig } from \"../Config/DynamicConfig\";\r\nimport { _DYN_ADD_NOTIFICATION_LIS1, _DYN_CANCEL, _DYN_DATA, _DYN_IS_ASYNC, _DYN_IS_CHILD_EVT, _DYN_LENGTH, _DYN_PUSH, _DYN_REMOVE_NOTIFICATION_0, _DYN_SPLICE, _DYN_UNLOAD, _DYN_WATCH } from \"../__DynamicConstants\";\r\nimport { STR_EVENTS_DISCARDED, STR_EVENTS_SEND_REQUEST, STR_EVENTS_SENT, STR_OFFLINE_DROP, STR_OFFLINE_SENT, STR_OFFLINE_STORE, STR_PERF_EVENT } from \"./InternalConstants\";\r\nvar defaultValues = {\r\n    perfEvtsSendAll: false\r\n};\r\nfunction _runScheduledListeners(asyncNotifications) {\r\n    asyncNotifications.h = null;\r\n    var callbacks = asyncNotifications.cb;\r\n    asyncNotifications.cb = [];\r\n    arrForEach(callbacks, function (cb) {\r\n        // Run the listener in a try-catch to ensure that a single listener failing doesn't prevent the others from running\r\n        safe(cb.fn, [cb.arg]);\r\n    });\r\n}\r\n// This function is used to combine the logic of running the listeners and handling the async notifications so that they don't\r\n// create multiple timers if there are multiple async listeners.\r\nfunction _runListeners(listeners, name, asyncNotifications, callback) {\r\n    arrForEach(listeners, function (listener) {\r\n        if (listener && listener[name]) {\r\n            if (asyncNotifications) {\r\n                // Schedule the callback to be called after the current call stack has cleared.\r\n                asyncNotifications.cb[_DYN_PUSH /* @min:%2epush */]({\r\n                    fn: callback,\r\n                    arg: listener\r\n                });\r\n                asyncNotifications.h = asyncNotifications.h || scheduleTimeout(_runScheduledListeners, 0, asyncNotifications);\r\n            }\r\n            else {\r\n                // Run the listener in a try-catch to ensure that a single listener failing doesn't prevent the others from running\r\n                safe(callback, [listener]);\r\n            }\r\n        }\r\n    });\r\n}\r\n/**\r\n * Class to manage sending notifications to all the listeners.\r\n */\r\nvar NotificationManager = /** @class */ (function () {\r\n    function NotificationManager(config) {\r\n        this.listeners = [];\r\n        var perfEvtsSendAll;\r\n        var unloadHandler;\r\n        var _listeners = [];\r\n        var _asyncNotifications = {\r\n            h: null,\r\n            cb: []\r\n        };\r\n        var cfgHandler = createDynamicConfig(config, defaultValues);\r\n        unloadHandler = cfgHandler[_DYN_WATCH /* @min:%2ewatch */](function (details) {\r\n            perfEvtsSendAll = !!details.cfg.perfEvtsSendAll;\r\n        });\r\n        dynamicProto(NotificationManager, this, function (_self) {\r\n            objDefine(_self, \"listeners\", {\r\n                g: function () { return _listeners; }\r\n            });\r\n            _self[_DYN_ADD_NOTIFICATION_LIS1 /* @min:%2eaddNotificationListener */] = function (listener) {\r\n                _listeners[_DYN_PUSH /* @min:%2epush */](listener);\r\n            };\r\n            /**\r\n             * Removes all instances of the listener.\r\n             * @param listener - AWTNotificationListener to remove.\r\n             */\r\n            _self[_DYN_REMOVE_NOTIFICATION_0 /* @min:%2eremoveNotificationListener */] = function (listener) {\r\n                var index = arrIndexOf(_listeners, listener);\r\n                while (index > -1) {\r\n                    _listeners[_DYN_SPLICE /* @min:%2esplice */](index, 1);\r\n                    index = arrIndexOf(_listeners, listener);\r\n                }\r\n            };\r\n            /**\r\n             * Notification for events sent.\r\n             * @param events - The array of events that have been sent.\r\n             */\r\n            _self[STR_EVENTS_SENT /* @min:%2eeventsSent */] = function (events) {\r\n                _runListeners(_listeners, STR_EVENTS_SENT, _asyncNotifications, function (listener) {\r\n                    listener[STR_EVENTS_SENT /* @min:%2eeventsSent */](events);\r\n                });\r\n            };\r\n            /**\r\n             * Notification for events being discarded.\r\n             * @param events - The array of events that have been discarded by the SDK.\r\n             * @param reason - The reason for which the SDK discarded the events. The EventsDiscardedReason\r\n             * constant should be used to check the different values.\r\n             */\r\n            _self[STR_EVENTS_DISCARDED /* @min:%2eeventsDiscarded */] = function (events, reason) {\r\n                _runListeners(_listeners, STR_EVENTS_DISCARDED, _asyncNotifications, function (listener) {\r\n                    listener[STR_EVENTS_DISCARDED /* @min:%2eeventsDiscarded */](events, reason);\r\n                });\r\n            };\r\n            /**\r\n             * [Optional] A function called when the events have been requested to be sent to the sever.\r\n             * @param sendReason - The reason why the event batch is being sent.\r\n             * @param isAsync - A flag which identifies whether the requests are being sent in an async or sync manner.\r\n             */\r\n            _self[STR_EVENTS_SEND_REQUEST /* @min:%2eeventsSendRequest */] = function (sendReason, isAsync) {\r\n                _runListeners(_listeners, STR_EVENTS_SEND_REQUEST, isAsync ? _asyncNotifications : null, function (listener) {\r\n                    listener[STR_EVENTS_SEND_REQUEST /* @min:%2eeventsSendRequest */](sendReason, isAsync);\r\n                });\r\n            };\r\n            _self[STR_PERF_EVENT /* @min:%2eperfEvent */] = function (perfEvent) {\r\n                if (perfEvent) {\r\n                    // Send all events or only parent events\r\n                    if (perfEvtsSendAll || !perfEvent[_DYN_IS_CHILD_EVT /* @min:%2eisChildEvt */]()) {\r\n                        _runListeners(_listeners, STR_PERF_EVENT, null, function (listener) {\r\n                            if (perfEvent[_DYN_IS_ASYNC /* @min:%2eisAsync */]) {\r\n                                scheduleTimeout(function () { return listener[STR_PERF_EVENT /* @min:%2eperfEvent */](perfEvent); }, 0);\r\n                            }\r\n                            else {\r\n                                listener[STR_PERF_EVENT /* @min:%2eperfEvent */](perfEvent);\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n            };\r\n            _self[STR_OFFLINE_STORE /* @min:%2eofflineEventsStored */] = function (events) {\r\n                if (events && events[_DYN_LENGTH /* @min:%2elength */]) {\r\n                    _runListeners(_listeners, STR_OFFLINE_STORE, _asyncNotifications, function (listener) {\r\n                        listener[STR_OFFLINE_STORE /* @min:%2eofflineEventsStored */](events);\r\n                    });\r\n                }\r\n            };\r\n            _self[STR_OFFLINE_SENT /* @min:%2eofflineBatchSent */] = function (batch) {\r\n                if (batch && batch[_DYN_DATA /* @min:%2edata */]) {\r\n                    _runListeners(_listeners, STR_OFFLINE_SENT, _asyncNotifications, function (listener) {\r\n                        listener[STR_OFFLINE_SENT /* @min:%2eofflineBatchSent */](batch);\r\n                    });\r\n                }\r\n            };\r\n            _self[STR_OFFLINE_DROP /* @min:%2eofflineBatchDrop */] = function (cnt, reason) {\r\n                if (cnt > 0) {\r\n                    var rn_1 = reason || 0; // default is unknown\r\n                    _runListeners(_listeners, STR_OFFLINE_DROP, _asyncNotifications, function (listener) {\r\n                        listener[STR_OFFLINE_DROP /* @min:%2eofflineBatchDrop */](cnt, rn_1);\r\n                    });\r\n                }\r\n            };\r\n            _self[_DYN_UNLOAD /* @min:%2eunload */] = function (isAsync) {\r\n                var _finishUnload = function () {\r\n                    unloadHandler && unloadHandler.rm();\r\n                    unloadHandler = null;\r\n                    _listeners = [];\r\n                    // Clear any async listener\r\n                    _asyncNotifications.h && _asyncNotifications.h[_DYN_CANCEL /* @min:%2ecancel */]();\r\n                    _asyncNotifications.h = null;\r\n                    _asyncNotifications.cb = [];\r\n                };\r\n                var waiting;\r\n                _runListeners(_listeners, \"unload\", null, function (listener) {\r\n                    var asyncUnload = listener[_DYN_UNLOAD /* @min:%2eunload */](isAsync);\r\n                    if (asyncUnload) {\r\n                        if (!waiting) {\r\n                            waiting = [];\r\n                        }\r\n                        waiting[_DYN_PUSH /* @min:%2epush */](asyncUnload);\r\n                    }\r\n                });\r\n                if (waiting) {\r\n                    return createPromise(function (resolve) {\r\n                        return doAwaitResponse(createAllPromise(waiting), function () {\r\n                            _finishUnload();\r\n                            resolve();\r\n                        });\r\n                    });\r\n                }\r\n                else {\r\n                    _finishUnload();\r\n                }\r\n            };\r\n        });\r\n    }\r\n// Removed Stub for NotificationManager.prototype.addNotificationListener.\r\n// Removed Stub for NotificationManager.prototype.removeNotificationListener.\r\n// Removed Stub for NotificationManager.prototype.eventsSent.\r\n// Removed Stub for NotificationManager.prototype.eventsDiscarded.\r\n// Removed Stub for NotificationManager.prototype.eventsSendRequest.\r\n// Removed Stub for NotificationManager.prototype.perfEvent.\r\n// Removed Stub for NotificationManager.prototype.unload.\r\n// Removed Stub for NotificationManager.prototype.offlineEventsStored.\r\n// Removed Stub for NotificationManager.prototype.offlineBatchSent.\r\n// Removed Stub for NotificationManager.prototype.offlineBatchDrop.\r\n    // This is a workaround for an IE bug when using dynamicProto() with classes that don't have any\n    // non-dynamic functions or static properties/functions when using uglify-js to minify the resulting code.\n    NotificationManager.__ieDyn=1;\n\n    return NotificationManager;\r\n}());\r\nexport { NotificationManager };\r\n//# sourceMappingURL=NotificationManager.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { isArray, isFunction, objDefine, utcNow } from \"@nevware21/ts-utils\";\r\nimport { _DYN_COMPLETE, _DYN_GET_CTX, _DYN_IS_ASYNC, _DYN_IS_CHILD_EVT, _DYN_LENGTH, _DYN_NAME, _DYN_PUSH, _DYN_SET_CTX, _DYN_TIME } from \"../__DynamicConstants\";\r\nimport { STR_GET_PERF_MGR, STR_PERF_EVENT } from \"./InternalConstants\";\r\nvar strExecutionContextKey = \"ctx\";\r\nvar strParentContextKey = \"ParentContextKey\";\r\nvar strChildrenContextKey = \"ChildrenContextKey\";\r\nvar _defaultPerfManager = null;\r\nvar PerfEvent = /** @class */ (function () {\r\n    function PerfEvent(name, payloadDetails, isAsync) {\r\n        var _self = this;\r\n        _self.start = utcNow();\r\n        _self[_DYN_NAME /* @min:%2ename */] = name;\r\n        _self[_DYN_IS_ASYNC /* @min:%2eisAsync */] = isAsync;\r\n        _self[_DYN_IS_CHILD_EVT /* @min:%2eisChildEvt */] = function () { return false; };\r\n        if (isFunction(payloadDetails)) {\r\n            // Create an accessor to minimize the potential performance impact of executing the payloadDetails callback\r\n            var theDetails_1;\r\n            objDefine(_self, \"payload\", {\r\n                g: function () {\r\n                    // Delay the execution of the payloadDetails until needed\r\n                    if (!theDetails_1 && isFunction(payloadDetails)) {\r\n                        theDetails_1 = payloadDetails();\r\n                        // clear it out now so the referenced objects can be garbage collected\r\n                        payloadDetails = null;\r\n                    }\r\n                    return theDetails_1;\r\n                }\r\n            });\r\n        }\r\n        _self[_DYN_GET_CTX /* @min:%2egetCtx */] = function (key) {\r\n            if (key) {\r\n                // The parent and child links are located directly on the object (for better viewing in the DebugPlugin)\r\n                if (key === PerfEvent[strParentContextKey] || key === PerfEvent[strChildrenContextKey]) {\r\n                    return _self[key];\r\n                }\r\n                return (_self[strExecutionContextKey] || {})[key];\r\n            }\r\n            return null;\r\n        };\r\n        _self[_DYN_SET_CTX /* @min:%2esetCtx */] = function (key, value) {\r\n            if (key) {\r\n                // Put the parent and child links directly on the object (for better viewing in the DebugPlugin)\r\n                if (key === PerfEvent[strParentContextKey]) {\r\n                    // Simple assumption, if we are setting a parent then we must be a child\r\n                    if (!_self[key]) {\r\n                        _self[_DYN_IS_CHILD_EVT /* @min:%2eisChildEvt */] = function () { return true; };\r\n                    }\r\n                    _self[key] = value;\r\n                }\r\n                else if (key === PerfEvent[strChildrenContextKey]) {\r\n                    _self[key] = value;\r\n                }\r\n                else {\r\n                    var ctx = _self[strExecutionContextKey] = _self[strExecutionContextKey] || {};\r\n                    ctx[key] = value;\r\n                }\r\n            }\r\n        };\r\n        _self[_DYN_COMPLETE /* @min:%2ecomplete */] = function () {\r\n            var childTime = 0;\r\n            var childEvts = _self[_DYN_GET_CTX /* @min:%2egetCtx */](PerfEvent[strChildrenContextKey]);\r\n            if (isArray(childEvts)) {\r\n                for (var lp = 0; lp < childEvts[_DYN_LENGTH /* @min:%2elength */]; lp++) {\r\n                    var childEvt = childEvts[lp];\r\n                    if (childEvt) {\r\n                        childTime += childEvt[_DYN_TIME /* @min:%2etime */];\r\n                    }\r\n                }\r\n            }\r\n            _self[_DYN_TIME /* @min:%2etime */] = utcNow() - _self.start;\r\n            _self.exTime = _self[_DYN_TIME /* @min:%2etime */] - childTime;\r\n            _self[_DYN_COMPLETE /* @min:%2ecomplete */] = function () { };\r\n        };\r\n    }\r\n    PerfEvent.ParentContextKey = \"parent\";\r\n    PerfEvent.ChildrenContextKey = \"childEvts\";\r\n    return PerfEvent;\r\n}());\r\nexport { PerfEvent };\r\nvar PerfManager = /** @class */ (function () {\r\n    function PerfManager(manager) {\r\n        /**\r\n         * General bucket used for execution context set and retrieved via setCtx() and getCtx.\r\n         * Defined as private so it can be visualized via the DebugPlugin\r\n         */\r\n        this.ctx = {};\r\n        dynamicProto(PerfManager, this, function (_self) {\r\n            _self.create = function (src, payloadDetails, isAsync) {\r\n                // TODO (@MSNev): at some point we will want to add additional configuration to \"select\" which events to instrument\r\n                // for now this is just a simple do everything.\r\n                return new PerfEvent(src, payloadDetails, isAsync);\r\n            };\r\n            _self.fire = function (perfEvent) {\r\n                if (perfEvent) {\r\n                    perfEvent[_DYN_COMPLETE /* @min:%2ecomplete */]();\r\n                    if (manager && isFunction(manager[STR_PERF_EVENT /* @min:%2eperfEvent */])) {\r\n                        manager[STR_PERF_EVENT /* @min:%2eperfEvent */](perfEvent);\r\n                    }\r\n                }\r\n            };\r\n            _self[_DYN_SET_CTX /* @min:%2esetCtx */] = function (key, value) {\r\n                if (key) {\r\n                    var ctx = _self[strExecutionContextKey] = _self[strExecutionContextKey] || {};\r\n                    ctx[key] = value;\r\n                }\r\n            };\r\n            _self[_DYN_GET_CTX /* @min:%2egetCtx */] = function (key) {\r\n                return (_self[strExecutionContextKey] || {})[key];\r\n            };\r\n        });\r\n    }\r\n// Removed Stub for PerfManager.prototype.create.\r\n// Removed Stub for PerfManager.prototype.fire.\r\n// Removed Stub for PerfManager.prototype.setCtx.\r\n// Removed Stub for PerfManager.prototype.getCtx.\r\n    // This is a workaround for an IE bug when using dynamicProto() with classes that don't have any\n    // non-dynamic functions or static properties/functions when using uglify-js to minify the resulting code.\n    PerfManager.__ieDyn=1;\n\n    return PerfManager;\r\n}());\r\nexport { PerfManager };\r\nvar doPerfActiveKey = \"CoreUtils.doPerf\";\r\n/**\r\n * Helper function to wrap a function with a perf event\r\n * @param mgrSource - The Performance Manager or a Performance provider source (may be null)\r\n * @param getSource - The callback to create the source name for the event (if perf monitoring is enabled)\r\n * @param func - The function to call and measure\r\n * @param details - A function to return the payload details\r\n * @param isAsync - Is the event / function being call asynchronously or synchronously\r\n */\r\nexport function doPerf(mgrSource, getSource, func, details, isAsync) {\r\n    if (mgrSource) {\r\n        var perfMgr = mgrSource;\r\n        if (perfMgr[STR_GET_PERF_MGR]) {\r\n            // Looks like a perf manager provider object\r\n            perfMgr = perfMgr[STR_GET_PERF_MGR]();\r\n        }\r\n        if (perfMgr) {\r\n            var perfEvt = void 0;\r\n            var currentActive = perfMgr[_DYN_GET_CTX /* @min:%2egetCtx */](doPerfActiveKey);\r\n            try {\r\n                perfEvt = perfMgr.create(getSource(), details, isAsync);\r\n                if (perfEvt) {\r\n                    if (currentActive && perfEvt[_DYN_SET_CTX /* @min:%2esetCtx */]) {\r\n                        perfEvt[_DYN_SET_CTX /* @min:%2esetCtx */](PerfEvent[strParentContextKey], currentActive);\r\n                        if (currentActive[_DYN_GET_CTX /* @min:%2egetCtx */] && currentActive[_DYN_SET_CTX /* @min:%2esetCtx */]) {\r\n                            var children = currentActive[_DYN_GET_CTX /* @min:%2egetCtx */](PerfEvent[strChildrenContextKey]);\r\n                            if (!children) {\r\n                                children = [];\r\n                                currentActive[_DYN_SET_CTX /* @min:%2esetCtx */](PerfEvent[strChildrenContextKey], children);\r\n                            }\r\n                            children[_DYN_PUSH /* @min:%2epush */](perfEvt);\r\n                        }\r\n                    }\r\n                    // Set this event as the active event now\r\n                    perfMgr[_DYN_SET_CTX /* @min:%2esetCtx */](doPerfActiveKey, perfEvt);\r\n                    return func(perfEvt);\r\n                }\r\n            }\r\n            catch (ex) {\r\n                if (perfEvt && perfEvt[_DYN_SET_CTX /* @min:%2esetCtx */]) {\r\n                    perfEvt[_DYN_SET_CTX /* @min:%2esetCtx */](\"exception\", ex);\r\n                }\r\n            }\r\n            finally {\r\n                // fire the perf event\r\n                if (perfEvt) {\r\n                    perfMgr.fire(perfEvt);\r\n                }\r\n                // Reset the active event to the previous value\r\n                perfMgr[_DYN_SET_CTX /* @min:%2esetCtx */](doPerfActiveKey, currentActive);\r\n            }\r\n        }\r\n    }\r\n    return func();\r\n}\r\n/**\r\n * Set the global performance manager to use when there is no core instance or it has not been initialized yet.\r\n * @param perfManager - The IPerfManager instance to use when no performance manager is supplied.\r\n */\r\nexport function setGblPerfMgr(perfManager) {\r\n    _defaultPerfManager = perfManager;\r\n}\r\n/**\r\n * Get the current global performance manager that will be used with no performance manager is supplied.\r\n * @returns - The current default manager\r\n */\r\nexport function getGblPerfMgr() {\r\n    return _defaultPerfManager;\r\n}\r\n//# sourceMappingURL=PerfManager.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\n\"use strict\";\r\nimport { arrForEach, dumpObj, isArray, isFunction, isNullOrUndefined, isUndefined, objForEachKey, objFreeze, objKeys } from \"@nevware21/ts-utils\";\r\nimport { _applyDefaultValue } from \"../Config/ConfigDefaults\";\r\nimport { createDynamicConfig } from \"../Config/DynamicConfig\";\r\nimport { _DYN_CREATE_NEW, _DYN_DIAG_LOG, _DYN_GET_NEXT, _DYN_GET_PLUGIN, _DYN_IDENTIFIER, _DYN_IS_ASYNC, _DYN_IS_INITIALIZED, _DYN_LENGTH, _DYN_LOGGER, _DYN_PROCESS_NEXT, _DYN_PUSH, _DYN_SET_DF, _DYN_SET_NEXT_PLUGIN, _DYN_TEARDOWN, _DYN_UNLOAD, _DYN_UPDATE } from \"../__DynamicConstants\";\r\nimport { _throwInternal, safeGetLogger } from \"./DiagnosticLogger\";\r\nimport { proxyFunctions } from \"./HelperFuncs\";\r\nimport { STR_CORE, STR_DISABLED, STR_EMPTY, STR_EXTENSION_CONFIG, STR_PRIORITY, STR_PROCESS_TELEMETRY } from \"./InternalConstants\";\r\nimport { doPerf } from \"./PerfManager\";\r\nimport { _getPluginState } from \"./TelemetryHelpers\";\r\nvar strTelemetryPluginChain = \"TelemetryPluginChain\";\r\nvar strHasRunFlags = \"_hasRun\";\r\nvar strGetTelCtx = \"_getTelCtx\";\r\nvar _chainId = 0;\r\nfunction _getNextProxyStart(proxy, core, startAt) {\r\n    while (proxy) {\r\n        if (proxy[_DYN_GET_PLUGIN /* @min:%2egetPlugin */]() === startAt) {\r\n            return proxy;\r\n        }\r\n        proxy = proxy[_DYN_GET_NEXT /* @min:%2egetNext */]();\r\n    }\r\n    // This wasn't found in the existing chain so create an isolated one with just this plugin\r\n    return createTelemetryProxyChain([startAt], core.config || {}, core);\r\n}\r\n/**\r\n * @ignore\r\n * @param telemetryChain\r\n * @param dynamicHandler\r\n * @param core\r\n * @param startAt - Identifies the next plugin to execute, if null there is no \"next\" plugin and if undefined it should assume the start of the chain\r\n * @returns\r\n */\r\nfunction _createInternalContext(telemetryChain, dynamicHandler, core, startAt) {\r\n    // We have a special case where we want to start execution from this specific plugin\r\n    // or we simply reuse the existing telemetry plugin chain (normal execution case)\r\n    var _nextProxy = null; // By Default set as no next plugin\r\n    var _onComplete = [];\r\n    if (!dynamicHandler) {\r\n        dynamicHandler = createDynamicConfig({}, null, core[_DYN_LOGGER /* @min:%2elogger */]);\r\n    }\r\n    if (startAt !== null) {\r\n        // There is no next element (null) vs not defined (undefined) so use the full chain\r\n        _nextProxy = startAt ? _getNextProxyStart(telemetryChain, core, startAt) : telemetryChain;\r\n    }\r\n    var context = {\r\n        _next: _moveNext,\r\n        ctx: {\r\n            core: function () {\r\n                return core;\r\n            },\r\n            diagLog: function () {\r\n                return safeGetLogger(core, dynamicHandler.cfg);\r\n            },\r\n            getCfg: function () {\r\n                return dynamicHandler.cfg;\r\n            },\r\n            getExtCfg: _resolveExtCfg,\r\n            getConfig: _getConfig,\r\n            hasNext: function () {\r\n                return !!_nextProxy;\r\n            },\r\n            getNext: function () {\r\n                return _nextProxy;\r\n            },\r\n            setNext: function (nextPlugin) {\r\n                _nextProxy = nextPlugin;\r\n            },\r\n            iterate: _iterateChain,\r\n            onComplete: _addOnComplete\r\n        }\r\n    };\r\n    function _addOnComplete(onComplete, that) {\r\n        var args = [];\r\n        for (var _i = 2; _i < arguments.length; _i++) {\r\n            args[_i - 2] = arguments[_i];\r\n        }\r\n        if (onComplete) {\r\n            _onComplete[_DYN_PUSH /* @min:%2epush */]({\r\n                func: onComplete,\r\n                self: !isUndefined(that) ? that : context.ctx,\r\n                args: args\r\n            });\r\n        }\r\n    }\r\n    function _moveNext() {\r\n        var nextProxy = _nextProxy;\r\n        // Automatically move to the next plugin\r\n        _nextProxy = nextProxy ? nextProxy[_DYN_GET_NEXT /* @min:%2egetNext */]() : null;\r\n        if (!nextProxy) {\r\n            var onComplete = _onComplete;\r\n            if (onComplete && onComplete[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                arrForEach(onComplete, function (completeDetails) {\r\n                    try {\r\n                        completeDetails.func.call(completeDetails.self, completeDetails.args);\r\n                    }\r\n                    catch (e) {\r\n                        _throwInternal(core[_DYN_LOGGER /* @min:%2elogger */], 2 /* eLoggingSeverity.WARNING */, 73 /* _eInternalMessageId.PluginException */, \"Unexpected Exception during onComplete - \" + dumpObj(e));\r\n                    }\r\n                });\r\n                _onComplete = [];\r\n            }\r\n        }\r\n        return nextProxy;\r\n    }\r\n    function _getExtCfg(identifier, createIfMissing) {\r\n        var idCfg = null;\r\n        var cfg = dynamicHandler.cfg;\r\n        if (cfg && identifier) {\r\n            var extCfg = cfg[STR_EXTENSION_CONFIG /* @min:%2eextensionConfig */];\r\n            if (!extCfg && createIfMissing) {\r\n                extCfg = {};\r\n            }\r\n            // Always set the value so that the property always exists\r\n            cfg[STR_EXTENSION_CONFIG] = extCfg; // Note: it is valid for the \"value\" to be undefined\r\n            // Calling `ref()` has a side effect of causing the referenced property to become dynamic  (if not already)\r\n            extCfg = dynamicHandler.ref(cfg, STR_EXTENSION_CONFIG);\r\n            if (extCfg) {\r\n                idCfg = extCfg[identifier];\r\n                if (!idCfg && createIfMissing) {\r\n                    idCfg = {};\r\n                }\r\n                // Always set the value so that the property always exists\r\n                extCfg[identifier] = idCfg; // Note: it is valid for the \"value\" to be undefined\r\n                // Calling `ref()` has a side effect of causing the referenced property to become dynamic  (if not already)\r\n                idCfg = dynamicHandler.ref(extCfg, identifier);\r\n            }\r\n        }\r\n        return idCfg;\r\n    }\r\n    function _resolveExtCfg(identifier, defaultValues) {\r\n        var newConfig = _getExtCfg(identifier, true);\r\n        if (defaultValues) {\r\n            // Enumerate over the defaultValues and if not already populated attempt to\r\n            // find a value from the root config or use the default value\r\n            objForEachKey(defaultValues, function (field, defaultValue) {\r\n                // for each unspecified field, set the default value\r\n                if (isNullOrUndefined(newConfig[field])) {\r\n                    var cfgValue = dynamicHandler.cfg[field];\r\n                    if (cfgValue || !isNullOrUndefined(cfgValue)) {\r\n                        newConfig[field] = cfgValue;\r\n                    }\r\n                }\r\n                _applyDefaultValue(dynamicHandler, newConfig, field, defaultValue);\r\n            });\r\n        }\r\n        return dynamicHandler[_DYN_SET_DF /* @min:%2esetDf */](newConfig, defaultValues);\r\n    }\r\n    function _getConfig(identifier, field, defaultValue) {\r\n        if (defaultValue === void 0) { defaultValue = false; }\r\n        var theValue;\r\n        var extConfig = _getExtCfg(identifier, false);\r\n        var rootConfig = dynamicHandler.cfg;\r\n        if (extConfig && (extConfig[field] || !isNullOrUndefined(extConfig[field]))) {\r\n            theValue = extConfig[field];\r\n        }\r\n        else if (rootConfig[field] || !isNullOrUndefined(rootConfig[field])) {\r\n            theValue = rootConfig[field];\r\n        }\r\n        return (theValue || !isNullOrUndefined(theValue)) ? theValue : defaultValue;\r\n    }\r\n    function _iterateChain(cb) {\r\n        // Keep processing until we reach the end of the chain\r\n        var nextPlugin;\r\n        while (!!(nextPlugin = context._next())) {\r\n            var plugin = nextPlugin[_DYN_GET_PLUGIN /* @min:%2egetPlugin */]();\r\n            if (plugin) {\r\n                // callback with the current on\r\n                cb(plugin);\r\n            }\r\n        }\r\n    }\r\n    return context;\r\n}\r\n/**\r\n * Creates a new Telemetry Item context with the current config, core and plugin execution chain\r\n * @param plugins - The plugin instances that will be executed\r\n * @param config - The current config\r\n * @param core - The current core instance\r\n * @param startAt - Identifies the next plugin to execute, if null there is no \"next\" plugin and if undefined it should assume the start of the chain\r\n */\r\nexport function createProcessTelemetryContext(telemetryChain, cfg, core, startAt) {\r\n    var config = createDynamicConfig(cfg);\r\n    var internalContext = _createInternalContext(telemetryChain, config, core, startAt);\r\n    var context = internalContext.ctx;\r\n    function _processNext(env) {\r\n        var nextPlugin = internalContext._next();\r\n        if (nextPlugin) {\r\n            // Run the next plugin which will call \"processNext()\"\r\n            nextPlugin[STR_PROCESS_TELEMETRY /* @min:%2eprocessTelemetry */](env, context);\r\n        }\r\n        return !nextPlugin;\r\n    }\r\n    function _createNew(plugins, startAt) {\r\n        if (plugins === void 0) { plugins = null; }\r\n        if (isArray(plugins)) {\r\n            plugins = createTelemetryProxyChain(plugins, config.cfg, core, startAt);\r\n        }\r\n        return createProcessTelemetryContext(plugins || context[_DYN_GET_NEXT /* @min:%2egetNext */](), config.cfg, core, startAt);\r\n    }\r\n    context[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */] = _processNext;\r\n    context[_DYN_CREATE_NEW /* @min:%2ecreateNew */] = _createNew;\r\n    return context;\r\n}\r\n/**\r\n * Creates a new Telemetry Item context with the current config, core and plugin execution chain for handling the unloading of the chain\r\n * @param plugins - The plugin instances that will be executed\r\n * @param config - The current config\r\n * @param core - The current core instance\r\n * @param startAt - Identifies the next plugin to execute, if null there is no \"next\" plugin and if undefined it should assume the start of the chain\r\n */\r\nexport function createProcessTelemetryUnloadContext(telemetryChain, core, startAt) {\r\n    var config = createDynamicConfig(core.config);\r\n    var internalContext = _createInternalContext(telemetryChain, config, core, startAt);\r\n    var context = internalContext.ctx;\r\n    function _processNext(unloadState) {\r\n        var nextPlugin = internalContext._next();\r\n        nextPlugin && nextPlugin[_DYN_UNLOAD /* @min:%2eunload */](context, unloadState);\r\n        return !nextPlugin;\r\n    }\r\n    function _createNew(plugins, startAt) {\r\n        if (plugins === void 0) { plugins = null; }\r\n        if (isArray(plugins)) {\r\n            plugins = createTelemetryProxyChain(plugins, config.cfg, core, startAt);\r\n        }\r\n        return createProcessTelemetryUnloadContext(plugins || context[_DYN_GET_NEXT /* @min:%2egetNext */](), core, startAt);\r\n    }\r\n    context[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */] = _processNext;\r\n    context[_DYN_CREATE_NEW /* @min:%2ecreateNew */] = _createNew;\r\n    return context;\r\n}\r\n/**\r\n * Creates a new Telemetry Item context with the current config, core and plugin execution chain for updating the configuration\r\n * @param plugins - The plugin instances that will be executed\r\n * @param config - The current config\r\n * @param core - The current core instance\r\n * @param startAt - Identifies the next plugin to execute, if null there is no \"next\" plugin and if undefined it should assume the start of the chain\r\n */\r\nexport function createProcessTelemetryUpdateContext(telemetryChain, core, startAt) {\r\n    var config = createDynamicConfig(core.config);\r\n    var internalContext = _createInternalContext(telemetryChain, config, core, startAt);\r\n    var context = internalContext.ctx;\r\n    function _processNext(updateState) {\r\n        return context.iterate(function (plugin) {\r\n            if (isFunction(plugin[_DYN_UPDATE /* @min:%2eupdate */])) {\r\n                plugin[_DYN_UPDATE /* @min:%2eupdate */](context, updateState);\r\n            }\r\n        });\r\n    }\r\n    function _createNew(plugins, startAt) {\r\n        if (plugins === void 0) { plugins = null; }\r\n        if (isArray(plugins)) {\r\n            plugins = createTelemetryProxyChain(plugins, config.cfg, core, startAt);\r\n        }\r\n        return createProcessTelemetryUpdateContext(plugins || context[_DYN_GET_NEXT /* @min:%2egetNext */](), core, startAt);\r\n    }\r\n    context[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */] = _processNext;\r\n    context[_DYN_CREATE_NEW /* @min:%2ecreateNew */] = _createNew;\r\n    return context;\r\n}\r\n/**\r\n * Creates an execution chain from the array of plugins\r\n * @param plugins - The array of plugins that will be executed in this order\r\n * @param defItemCtx - The default execution context to use when no telemetry context is passed to processTelemetry(), this\r\n * should be for legacy plugins only. Currently, only used for passing the current core instance and to provide better error\r\n * reporting (hasRun) when errors occur.\r\n */\r\nexport function createTelemetryProxyChain(plugins, config, core, startAt) {\r\n    var firstProxy = null;\r\n    var add = startAt ? false : true;\r\n    if (isArray(plugins) && plugins[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n        // Create the proxies and wire up the next plugin chain\r\n        var lastProxy_1 = null;\r\n        arrForEach(plugins, function (thePlugin) {\r\n            if (!add && startAt === thePlugin) {\r\n                add = true;\r\n            }\r\n            if (add && thePlugin && isFunction(thePlugin[STR_PROCESS_TELEMETRY /* @min:%2eprocessTelemetry */])) {\r\n                // Only add plugins that are processors\r\n                var newProxy = createTelemetryPluginProxy(thePlugin, config, core);\r\n                if (!firstProxy) {\r\n                    firstProxy = newProxy;\r\n                }\r\n                if (lastProxy_1) {\r\n                    // Set this new proxy as the next for the previous one\r\n                    lastProxy_1._setNext(newProxy);\r\n                }\r\n                lastProxy_1 = newProxy;\r\n            }\r\n        });\r\n    }\r\n    if (startAt && !firstProxy) {\r\n        // Special case where the \"startAt\" was not in the original list of plugins\r\n        return createTelemetryProxyChain([startAt], config, core);\r\n    }\r\n    return firstProxy;\r\n}\r\n/**\r\n * Create the processing telemetry proxy instance, the proxy is used to abstract the current plugin to allow monitoring and\r\n * execution plugins while passing around the dynamic execution state (IProcessTelemetryContext), the proxy instance no longer\r\n * contains any execution state and can be reused between requests (this was not the case for 2.7.2 and earlier with the\r\n * TelemetryPluginChain class).\r\n * @param plugin - The plugin instance to proxy\r\n * @param config - The default execution context to use when no telemetry context is passed to processTelemetry(), this\r\n * should be for legacy plugins only. Currently, only used for passing the current core instance and to provide better error\r\n * reporting (hasRun) when errors occur.\r\n * @returns\r\n */\r\nexport function createTelemetryPluginProxy(plugin, config, core) {\r\n    var nextProxy = null;\r\n    var hasProcessTelemetry = isFunction(plugin[STR_PROCESS_TELEMETRY /* @min:%2eprocessTelemetry */]);\r\n    var hasSetNext = isFunction(plugin[_DYN_SET_NEXT_PLUGIN /* @min:%2esetNextPlugin */]);\r\n    var chainId;\r\n    if (plugin) {\r\n        chainId = plugin[_DYN_IDENTIFIER /* @min:%2eidentifier */] + \"-\" + plugin[STR_PRIORITY /* @min:%2epriority */] + \"-\" + _chainId++;\r\n    }\r\n    else {\r\n        chainId = \"Unknown-0-\" + _chainId++;\r\n    }\r\n    var proxyChain = {\r\n        getPlugin: function () {\r\n            return plugin;\r\n        },\r\n        getNext: function () {\r\n            return nextProxy;\r\n        },\r\n        processTelemetry: _processTelemetry,\r\n        unload: _unloadPlugin,\r\n        update: _updatePlugin,\r\n        _id: chainId,\r\n        _setNext: function (nextPlugin) {\r\n            nextProxy = nextPlugin;\r\n        }\r\n    };\r\n    function _getTelCtx() {\r\n        var itemCtx;\r\n        // Looks like a plugin didn't pass the (optional) context, so create a new one\r\n        if (plugin && isFunction(plugin[strGetTelCtx])) {\r\n            // This plugin extends from the BaseTelemetryPlugin so lets use it\r\n            itemCtx = plugin[strGetTelCtx]();\r\n        }\r\n        if (!itemCtx) {\r\n            // Create a temporary one\r\n            itemCtx = createProcessTelemetryContext(proxyChain, config, core);\r\n        }\r\n        return itemCtx;\r\n    }\r\n    function _processChain(itemCtx, processPluginFn, name, details, isAsync) {\r\n        var hasRun = false;\r\n        var identifier = plugin ? plugin[_DYN_IDENTIFIER /* @min:%2eidentifier */] : strTelemetryPluginChain;\r\n        var hasRunContext = itemCtx[strHasRunFlags];\r\n        if (!hasRunContext) {\r\n            // Assign and populate\r\n            hasRunContext = itemCtx[strHasRunFlags] = {};\r\n        }\r\n        // Ensure that we keep the context in sync\r\n        itemCtx.setNext(nextProxy);\r\n        if (plugin) {\r\n            doPerf(itemCtx[STR_CORE /* @min:%2ecore */](), function () { return identifier + \":\" + name; }, function () {\r\n                // Mark this component as having run\r\n                hasRunContext[chainId] = true;\r\n                try {\r\n                    // Set a flag on the next plugin so we know if it was attempted to be executed\r\n                    var nextId = nextProxy ? nextProxy._id : STR_EMPTY;\r\n                    if (nextId) {\r\n                        hasRunContext[nextId] = false;\r\n                    }\r\n                    hasRun = processPluginFn(itemCtx);\r\n                }\r\n                catch (error) {\r\n                    var hasNextRun = nextProxy ? hasRunContext[nextProxy._id] : true;\r\n                    if (hasNextRun) {\r\n                        // The next plugin after us has already run so set this one as complete\r\n                        hasRun = true;\r\n                    }\r\n                    if (!nextProxy || !hasNextRun) {\r\n                        // Either we have no next plugin or the current one did not attempt to call the next plugin\r\n                        // Which means the current one is the root of the failure so log/report this failure\r\n                        _throwInternal(itemCtx[_DYN_DIAG_LOG /* @min:%2ediagLog */](), 1 /* eLoggingSeverity.CRITICAL */, 73 /* _eInternalMessageId.PluginException */, \"Plugin [\" + identifier + \"] failed during \" + name + \" - \" + dumpObj(error) + \", run flags: \" + dumpObj(hasRunContext));\r\n                    }\r\n                }\r\n            }, details, isAsync);\r\n        }\r\n        return hasRun;\r\n    }\r\n    function _processTelemetry(env, itemCtx) {\r\n        itemCtx = itemCtx || _getTelCtx();\r\n        function _callProcessTelemetry(itemCtx) {\r\n            if (!plugin || !hasProcessTelemetry) {\r\n                return false;\r\n            }\r\n            var pluginState = _getPluginState(plugin);\r\n            if (pluginState[_DYN_TEARDOWN /* @min:%2eteardown */] || pluginState[STR_DISABLED]) {\r\n                return false;\r\n            }\r\n            // Ensure that we keep the context in sync (for processNext()), just in case a plugin\r\n            // doesn't calls processTelemetry() instead of itemContext.processNext() or some\r\n            // other form of error occurred\r\n            if (hasSetNext) {\r\n                // Backward compatibility setting the next plugin on the instance\r\n                plugin[_DYN_SET_NEXT_PLUGIN /* @min:%2esetNextPlugin */](nextProxy);\r\n            }\r\n            plugin[STR_PROCESS_TELEMETRY /* @min:%2eprocessTelemetry */](env, itemCtx);\r\n            // Process Telemetry is expected to call itemCtx.processNext() or nextPlugin.processTelemetry()\r\n            return true;\r\n        }\r\n        if (!_processChain(itemCtx, _callProcessTelemetry, \"processTelemetry\", function () { return ({ item: env }); }, !(env.sync))) {\r\n            // The underlying plugin is either not defined, not enabled or does not have a processTelemetry implementation\r\n            // so we still want the next plugin to be executed.\r\n            itemCtx[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](env);\r\n        }\r\n    }\r\n    function _unloadPlugin(unloadCtx, unloadState) {\r\n        function _callTeardown() {\r\n            // Setting default of hasRun as false so the proxyProcessFn() is called as teardown() doesn't have to exist or call unloadNext().\r\n            var hasRun = false;\r\n            if (plugin) {\r\n                var pluginState = _getPluginState(plugin);\r\n                var pluginCore = plugin[STR_CORE] || pluginState[STR_CORE /* @min:%2ecore */];\r\n                // Only teardown the plugin if it was initialized by the current core (i.e. It's not a shared plugin)\r\n                if (plugin && (!pluginCore || pluginCore === unloadCtx.core()) && !pluginState[_DYN_TEARDOWN /* @min:%2eteardown */]) {\r\n                    // Handle plugins that don't extend from the BaseTelemetryPlugin\r\n                    pluginState[STR_CORE /* @min:%2ecore */] = null;\r\n                    pluginState[_DYN_TEARDOWN /* @min:%2eteardown */] = true;\r\n                    pluginState[_DYN_IS_INITIALIZED /* @min:%2eisInitialized */] = false;\r\n                    if (plugin[_DYN_TEARDOWN /* @min:%2eteardown */] && plugin[_DYN_TEARDOWN /* @min:%2eteardown */](unloadCtx, unloadState) === true) {\r\n                        // plugin told us that it was going to (or has) call unloadCtx.processNext()\r\n                        hasRun = true;\r\n                    }\r\n                }\r\n            }\r\n            return hasRun;\r\n        }\r\n        if (!_processChain(unloadCtx, _callTeardown, \"unload\", function () { }, unloadState[_DYN_IS_ASYNC /* @min:%2eisAsync */])) {\r\n            // Only called if we hasRun was not true\r\n            unloadCtx[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](unloadState);\r\n        }\r\n    }\r\n    function _updatePlugin(updateCtx, updateState) {\r\n        function _callUpdate() {\r\n            // Setting default of hasRun as false so the proxyProcessFn() is called as teardown() doesn't have to exist or call unloadNext().\r\n            var hasRun = false;\r\n            if (plugin) {\r\n                var pluginState = _getPluginState(plugin);\r\n                var pluginCore = plugin[STR_CORE] || pluginState[STR_CORE /* @min:%2ecore */];\r\n                // Only update the plugin if it was initialized by the current core (i.e. It's not a shared plugin)\r\n                if (plugin && (!pluginCore || pluginCore === updateCtx.core()) && !pluginState[_DYN_TEARDOWN /* @min:%2eteardown */]) {\r\n                    if (plugin[_DYN_UPDATE /* @min:%2eupdate */] && plugin[_DYN_UPDATE /* @min:%2eupdate */](updateCtx, updateState) === true) {\r\n                        // plugin told us that it was going to (or has) call unloadCtx.processNext()\r\n                        hasRun = true;\r\n                    }\r\n                }\r\n            }\r\n            return hasRun;\r\n        }\r\n        if (!_processChain(updateCtx, _callUpdate, \"update\", function () { }, false)) {\r\n            // Only called if we hasRun was not true\r\n            updateCtx[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](updateState);\r\n        }\r\n    }\r\n    return objFreeze(proxyChain);\r\n}\r\n/**\r\n * This class will be removed!\r\n * @deprecated use createProcessTelemetryContext() instead\r\n */\r\nvar ProcessTelemetryContext = /** @class */ (function () {\r\n    /**\r\n     * Creates a new Telemetry Item context with the current config, core and plugin execution chain\r\n     * @param plugins - The plugin instances that will be executed\r\n     * @param config - The current config\r\n     * @param core - The current core instance\r\n     */\r\n    function ProcessTelemetryContext(pluginChain, config, core, startAt) {\r\n        var _self = this;\r\n        var context = createProcessTelemetryContext(pluginChain, config, core, startAt);\r\n        // Proxy all functions of the context to this object\r\n        proxyFunctions(_self, context, objKeys(context));\r\n    }\r\n    return ProcessTelemetryContext;\r\n}());\r\nexport { ProcessTelemetryContext };\r\n//# sourceMappingURL=ProcessTelemetryContext.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { utcNow } from \"@nevware21/ts-utils\";\r\nimport { _DYN_LENGTH } from \"../__DynamicConstants\";\r\nimport { getCrypto, getMsCrypto, isIE } from \"./EnvUtils\";\r\nimport { STR_EMPTY } from \"./InternalConstants\";\r\nvar UInt32Mask = 0x100000000;\r\nvar MaxUInt32 = 0xffffffff;\r\nvar SEED1 = 123456789;\r\nvar SEED2 = 987654321;\r\n// MWC based Random generator (for IE)\r\nvar _mwcSeeded = false;\r\nvar _mwcW = SEED1;\r\nvar _mwcZ = SEED2;\r\n// Takes any integer\r\nfunction _mwcSeed(seedValue) {\r\n    if (seedValue < 0) {\r\n        // Make sure we end up with a positive number and not -ve one.\r\n        seedValue >>>= 0;\r\n    }\r\n    _mwcW = (SEED1 + seedValue) & MaxUInt32;\r\n    _mwcZ = (SEED2 - seedValue) & MaxUInt32;\r\n    _mwcSeeded = true;\r\n}\r\nfunction _autoSeedMwc() {\r\n    // Simple initialization using default Math.random() - So we inherit any entropy from the browser\r\n    // and bitwise XOR with the current milliseconds\r\n    try {\r\n        var now = utcNow() & 0x7fffffff;\r\n        _mwcSeed(((Math.random() * UInt32Mask) ^ now) + now);\r\n    }\r\n    catch (e) {\r\n        // Don't crash if something goes wrong\r\n    }\r\n}\r\n/**\r\n * Generate a random value between 0 and maxValue, max value should be limited to a 32-bit maximum.\r\n * So maxValue(16) will produce a number from 0..16 (range of 17)\r\n * @param maxValue\r\n */\r\nexport function randomValue(maxValue) {\r\n    if (maxValue > 0) {\r\n        return Math.floor((random32() / MaxUInt32) * (maxValue + 1)) >>> 0;\r\n    }\r\n    return 0;\r\n}\r\n/**\r\n * generate a random 32-bit number (0x000000..0xFFFFFFFF) or (-0x80000000..0x7FFFFFFF), defaults un-unsigned.\r\n * @param signed - True to return a signed 32-bit number (-0x80000000..0x7FFFFFFF) otherwise an unsigned one (0x000000..0xFFFFFFFF)\r\n */\r\nexport function random32(signed) {\r\n    var value = 0;\r\n    var c = getCrypto() || getMsCrypto();\r\n    if (c && c.getRandomValues) {\r\n        // Make sure the number is converted into the specified range (-0x80000000..0x7FFFFFFF)\r\n        value = c.getRandomValues(new Uint32Array(1))[0] & MaxUInt32;\r\n    }\r\n    if (value === 0 && isIE()) {\r\n        // For IE 6, 7, 8 (especially on XP) Math.random is not very random\r\n        if (!_mwcSeeded) {\r\n            // Set the seed for the Mwc algorithm\r\n            _autoSeedMwc();\r\n        }\r\n        // Don't use Math.random for IE\r\n        // Make sure the number is converted into the specified range (-0x80000000..0x7FFFFFFF)\r\n        value = mwcRandom32() & MaxUInt32;\r\n    }\r\n    if (value === 0) {\r\n        // Make sure the number is converted into the specified range (-0x80000000..0x7FFFFFFF)\r\n        value = Math.floor((UInt32Mask * Math.random()) | 0);\r\n    }\r\n    if (!signed) {\r\n        // Make sure we end up with a positive number and not -ve one.\r\n        value >>>= 0;\r\n    }\r\n    return value;\r\n}\r\n/**\r\n * Seed the MWC random number generator with the specified seed or a random value\r\n * @param value - optional the number to used as the seed, if undefined, null or zero a random value will be chosen\r\n */\r\nexport function mwcRandomSeed(value) {\r\n    if (!value) {\r\n        _autoSeedMwc();\r\n    }\r\n    else {\r\n        _mwcSeed(value);\r\n    }\r\n}\r\n/**\r\n * Generate a random 32-bit number between (0x000000..0xFFFFFFFF) or (-0x80000000..0x7FFFFFFF), using MWC (Multiply with carry)\r\n * instead of Math.random() defaults to un-signed.\r\n * Used as a replacement random generator for IE to avoid issues with older IE instances.\r\n * @param signed - True to return a signed 32-bit number (-0x80000000..0x7FFFFFFF) otherwise an unsigned one (0x000000..0xFFFFFFFF)\r\n */\r\nexport function mwcRandom32(signed) {\r\n    _mwcZ = (36969 * (_mwcZ & 0xFFFF) + (_mwcZ >> 16)) & MaxUInt32;\r\n    _mwcW = (18000 * (_mwcW & 0xFFFF) + (_mwcW >> 16)) & MaxUInt32;\r\n    var value = (((_mwcZ << 16) + (_mwcW & 0xFFFF)) >>> 0) & MaxUInt32 | 0;\r\n    if (!signed) {\r\n        // Make sure we end up with a positive number and not -ve one.\r\n        value >>>= 0;\r\n    }\r\n    return value;\r\n}\r\n/**\r\n * Generate random base64 id string.\r\n * The default length is 22 which is 132-bits so almost the same as a GUID but as base64 (the previous default was 5)\r\n * @param maxLength - Optional value to specify the length of the id to be generated, defaults to 22\r\n */\r\nexport function newId(maxLength) {\r\n    if (maxLength === void 0) { maxLength = 22; }\r\n    var base64chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\r\n    // Start with an initial random number, consuming the value in reverse byte order\r\n    var number = random32() >>> 0; // Make sure it's a +ve number\r\n    var chars = 0;\r\n    var result = STR_EMPTY;\r\n    while (result[_DYN_LENGTH /* @min:%2elength */] < maxLength) {\r\n        chars++;\r\n        result += base64chars.charAt(number & 0x3F);\r\n        number >>>= 6; // Zero fill with right shift\r\n        if (chars === 5) {\r\n            // 5 base64 characters === 30 bits so we don't have enough bits for another base64 char\r\n            // So add on another 30 bits and make sure it's +ve\r\n            number = (((random32() << 2) & 0xFFFFFFFF) | (number & 0x03)) >>> 0;\r\n            chars = 0; // We need to reset the number every 5 chars (30 bits)\r\n        }\r\n    }\r\n    return result;\r\n}\r\n//# sourceMappingURL=RandomHelper.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { dumpObj } from \"@nevware21/ts-utils\";\r\nimport { _DYN_ITEMS_RECEIVED, _DYN_LENGTH, _DYN_NAME } from \"../__DynamicConstants\";\r\nimport { _throwInternal } from \"./DiagnosticLogger\";\r\nimport { getJSON } from \"./EnvUtils\";\r\n/**\r\n * Parses the response from the backend.\r\n * @param response - XMLHttpRequest or XDomainRequest response\r\n */\r\nexport function parseResponse(response, diagLog) {\r\n    try {\r\n        if (response && response !== \"\") {\r\n            var result = getJSON().parse(response);\r\n            if (result && result[_DYN_ITEMS_RECEIVED /* @min:%2eitemsReceived */] && result[_DYN_ITEMS_RECEIVED /* @min:%2eitemsReceived */] >= result.itemsAccepted &&\r\n                result.itemsReceived - result.itemsAccepted === result.errors[_DYN_LENGTH /* @min:%2elength */]) {\r\n                return result;\r\n            }\r\n        }\r\n    }\r\n    catch (e) {\r\n        _throwInternal(diagLog, 1 /* eLoggingSeverity.CRITICAL */, 43 /* _eInternalMessageId.InvalidBackendResponse */, \"Cannot parse the response. \" + (e[_DYN_NAME /* @min:%2ename */] || dumpObj(e)), {\r\n            response: response\r\n        });\r\n    }\r\n    return null;\r\n}\r\n//# sourceMappingURL=ResponseHelpers.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { createPromise, doAwaitResponse } from \"@nevware21/ts-async\";\r\nimport { arrForEach, dumpObj, getNavigator, getWindow, isFunction, objKeys } from \"@nevware21/ts-utils\";\r\nimport { _DYN_DATA, _DYN_HEADERS, _DYN_INITIALIZE, _DYN_LENGTH, _DYN_MESSAGE, _DYN_PROTOCOL, _DYN_REPLACE, _DYN_SEND_POST, _DYN_SET_REQUEST_HEADER, _DYN_STATUS, _DYN_TIMEOUT, _DYN_TO_LOWER_CASE, _DYN_URL_STRING, _DYN_VALUE, _DYN__DO_TEARDOWN } from \"../__DynamicConstants\";\r\nimport { DisabledPropertyName } from \"./Constants\";\r\nimport { _throwInternal, _warnToConsole } from \"./DiagnosticLogger\";\r\nimport { getLocation, isBeaconsSupported, isFetchSupported, isXhrSupported, useXDomainRequest } from \"./EnvUtils\";\r\nimport { _getAllResponseHeaders, formatErrorMessageXdr, formatErrorMessageXhr, getResponseText, openXhr } from \"./HelperFuncs\";\r\nvar STR_EMPTY = \"\";\r\nvar STR_NO_RESPONSE_BODY = \"NoResponseBody\";\r\nvar _noResponseQs = \"&\" + STR_NO_RESPONSE_BODY + \"=true\";\r\nvar STR_POST_METHOD = \"POST\";\r\n/**\r\n * This Internal component\r\n * Manager SendPost functions\r\n * SendPostManger\r\n * @internal for internal use only\r\n */\r\nvar SenderPostManager = /** @class */ (function () {\r\n    function SenderPostManager() {\r\n        var _syncFetchPayload = 0; // Keep track of the outstanding sync fetch payload total (as sync fetch has limits)\r\n        var _enableSendPromise;\r\n        var _isInitialized;\r\n        var _diagLog;\r\n        var _isOneDs;\r\n        var _onCompleteFuncs;\r\n        var _disableCredentials;\r\n        var _fetchCredentials;\r\n        var _fallbackInst;\r\n        var _disableXhr;\r\n        var _disableBeacon;\r\n        var _disableBeaconSync;\r\n        var _disableFetchKeepAlive;\r\n        var _addNoResponse;\r\n        var _timeoutWrapper;\r\n        dynamicProto(SenderPostManager, this, function (_self, _base) {\r\n            var _sendCredentials = true; // for 1ds\r\n            _initDefaults();\r\n            _self[_DYN_INITIALIZE /* @min:%2einitialize */] = function (config, diagLog) {\r\n                _diagLog = diagLog;\r\n                if (_isInitialized) {\r\n                    _throwInternal(_diagLog, 1 /* eLoggingSeverity.CRITICAL */, 28 /* _eInternalMessageId.SenderNotInitialized */, \"Sender is already initialized\");\r\n                }\r\n                _self.SetConfig(config);\r\n                _isInitialized = true;\r\n            };\r\n            _self[\"_getDbgPlgTargets\"] = function () {\r\n                return [_isInitialized, _isOneDs, _disableCredentials, _enableSendPromise];\r\n            };\r\n            // This componet might get its config from sender, offline sender, 1ds post\r\n            // so set this function to mock dynamic changes\r\n            _self.SetConfig = function (config) {\r\n                try {\r\n                    _onCompleteFuncs = config.senderOnCompleteCallBack || {};\r\n                    _disableCredentials = !!config.disableCredentials;\r\n                    _fetchCredentials = config.fetchCredentials;\r\n                    _isOneDs = !!config.isOneDs;\r\n                    _enableSendPromise = !!config.enableSendPromise;\r\n                    _disableXhr = !!config.disableXhr;\r\n                    _disableBeacon = !!config.disableBeacon;\r\n                    _disableBeaconSync = !!config.disableBeaconSync;\r\n                    _timeoutWrapper = config.timeWrapper;\r\n                    _addNoResponse = !!config.addNoResponse;\r\n                    _disableFetchKeepAlive = !!config.disableFetchKeepAlive;\r\n                    _fallbackInst = { sendPOST: _xhrSender };\r\n                    if (!_isOneDs) {\r\n                        _sendCredentials = false; // for appInsights, set it to false always\r\n                    }\r\n                    if (_disableCredentials) {\r\n                        var location_1 = getLocation();\r\n                        if (location_1 && location_1.protocol && location_1.protocol[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */]() === \"file:\") {\r\n                            // Special case where a local html file fails with a CORS error on Chromium browsers\r\n                            _sendCredentials = false;\r\n                        }\r\n                    }\r\n                    return true;\r\n                }\r\n                catch (e) {\r\n                    // eslint-disable-next-line no-empty\r\n                }\r\n                return false;\r\n            };\r\n            _self.getSyncFetchPayload = function () {\r\n                return _syncFetchPayload;\r\n            };\r\n            _self.getSenderInst = function (transports, sync) {\r\n                if (transports && transports[_DYN_LENGTH /* @min:%2elength */]) {\r\n                    return _getSenderInterface(transports, sync);\r\n                }\r\n                return null;\r\n            };\r\n            _self.getFallbackInst = function () {\r\n                return _fallbackInst;\r\n            };\r\n            _self[_DYN__DO_TEARDOWN /* @min:%2e_doTeardown */] = function (unloadCtx, unloadState) {\r\n                _initDefaults();\r\n            };\r\n            /**\r\n             * success handler\r\n             */\r\n            function _onSuccess(res, onComplete) {\r\n                _doOnComplete(onComplete, 200, {}, res);\r\n            }\r\n            /**\r\n             * error handler\r\n             */\r\n            function _onError(message, onComplete) {\r\n                _throwInternal(_diagLog, 2 /* eLoggingSeverity.WARNING */, 26 /* _eInternalMessageId.OnError */, \"Failed to send telemetry.\", { message: message });\r\n                _doOnComplete(onComplete, 400, {});\r\n            }\r\n            function _onNoPayloadUrl(onComplete) {\r\n                _onError(\"No endpoint url is provided for the batch\", onComplete);\r\n            }\r\n            function _getSenderInterface(transports, syncSupport) {\r\n                var _a;\r\n                var transportType = 0 /* TransportType.NotSet */;\r\n                var sendPostFunc = null;\r\n                var lp = 0;\r\n                while (sendPostFunc == null && lp < transports[_DYN_LENGTH /* @min:%2elength */]) {\r\n                    transportType = transports[lp];\r\n                    if (!_disableXhr && transportType === 1 /* TransportType.Xhr */) {\r\n                        if (useXDomainRequest()) {\r\n                            // IE 8 and 9\r\n                            sendPostFunc = _xdrSender;\r\n                        }\r\n                        else if (isXhrSupported()) {\r\n                            sendPostFunc = _xhrSender;\r\n                        }\r\n                    }\r\n                    else if (transportType === 2 /* TransportType.Fetch */ && isFetchSupported(syncSupport) && (!syncSupport || !_disableFetchKeepAlive)) {\r\n                        sendPostFunc = _doFetchSender;\r\n                    }\r\n                    else if (transportType === 3 /* TransportType.Beacon */ && isBeaconsSupported() && (syncSupport ? !_disableBeaconSync : !_disableBeacon)) {\r\n                        sendPostFunc = _beaconSender;\r\n                    }\r\n                    lp++;\r\n                }\r\n                if (sendPostFunc) {\r\n                    return _a = {\r\n                            _transport: transportType,\r\n                            _isSync: syncSupport\r\n                        },\r\n                        _a[_DYN_SEND_POST /* @min:sendPOST */] = sendPostFunc,\r\n                        _a;\r\n                }\r\n                return null;\r\n            }\r\n            function _doOnComplete(oncomplete, status, headers, response) {\r\n                try {\r\n                    oncomplete && oncomplete(status, headers, response);\r\n                }\r\n                catch (e) {\r\n                    // eslint-disable-next-line no-empty\r\n                }\r\n            }\r\n            function _doBeaconSend(payload, oncomplete) {\r\n                var nav = getNavigator();\r\n                var url = payload[_DYN_URL_STRING /* @min:%2eurlString */];\r\n                if (!url) {\r\n                    _onNoPayloadUrl(oncomplete);\r\n                    // return true here, because we don't want to retry it with fallback sender\r\n                    return true;\r\n                }\r\n                url = payload[_DYN_URL_STRING /* @min:%2eurlString */] + (_addNoResponse ? _noResponseQs : STR_EMPTY);\r\n                var data = payload[_DYN_DATA /* @min:%2edata */];\r\n                // Chrome only allows CORS-safelisted values for the sendBeacon data argument\r\n                // see: https://bugs.chromium.org/p/chromium/issues/detail?id=720283\r\n                // Chrome only allows CORS-safelisted values for the sendBeacon data argument\r\n                // see: https://bugs.chromium.org/p/chromium/issues/detail?id=720283\r\n                var plainTextBatch = _isOneDs ? data : new Blob([data], { type: \"text/plain;charset=UTF-8\" });\r\n                // The sendBeacon method returns true if the user agent is able to successfully queue the data for transfer. Otherwise it returns false.\r\n                var queued = nav.sendBeacon(url, plainTextBatch);\r\n                return queued;\r\n            }\r\n            /**\r\n             * Send Beacon API request\r\n             * @param payload - {string} - The data payload to be sent.\r\n             * @param sync - {boolean} - not used\r\n             * Note: Beacon API does not support custom headers and we are not able to get\r\n             * appId from the backend for the correct correlation.\r\n             */\r\n            function _beaconSender(payload, oncomplete, sync) {\r\n                var data = payload[_DYN_DATA /* @min:%2edata */];\r\n                try {\r\n                    if (data) {\r\n                        // The sendBeacon method returns true if the user agent is able to successfully queue the data for transfer. Otherwise it returns false.\r\n                        if (!_doBeaconSend(payload, oncomplete)) {\r\n                            var onRetry = _onCompleteFuncs && _onCompleteFuncs.beaconOnRetry;\r\n                            if (onRetry && isFunction(onRetry)) {\r\n                                onRetry(payload, oncomplete, _doBeaconSend);\r\n                            }\r\n                            else {\r\n                                _fallbackInst && _fallbackInst[_DYN_SEND_POST /* @min:%2esendPOST */](payload, oncomplete, true);\r\n                                _throwInternal(_diagLog, 2 /* eLoggingSeverity.WARNING */, 40 /* _eInternalMessageId.TransmissionFailed */, \". \" + \"Failed to send telemetry with Beacon API, retried with normal sender.\");\r\n                            }\r\n                        }\r\n                        else {\r\n                            // if can send\r\n                            _onSuccess(STR_EMPTY, oncomplete);\r\n                        }\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    _isOneDs && _warnToConsole(_diagLog, \"Failed to send telemetry using sendBeacon API. Ex:\" + dumpObj(e));\r\n                    _doOnComplete(oncomplete, _isOneDs ? 0 : 400, {}, STR_EMPTY);\r\n                }\r\n                return;\r\n            }\r\n            /**\r\n             * Send XMLHttpRequest\r\n             * @param payload - {string} - The data payload to be sent.\r\n             * @param sync - {boolean} - Indicates if the request should be sent synchronously\r\n             */\r\n            function _xhrSender(payload, oncomplete, sync) {\r\n                //let  internalPayload = payload as IInternalPayloadData;\r\n                var thePromise;\r\n                var resolveFunc;\r\n                var rejectFunc;\r\n                var headers = payload[_DYN_HEADERS /* @min:%2eheaders */] || {};\r\n                if (!sync && _enableSendPromise) {\r\n                    thePromise = createPromise(function (resolve, reject) {\r\n                        resolveFunc = resolve;\r\n                        rejectFunc = reject;\r\n                    });\r\n                }\r\n                if (_isOneDs && sync && payload.disableXhrSync) {\r\n                    sync = false;\r\n                }\r\n                //const xhr = new XMLHttpRequest();\r\n                var endPointUrl = payload[_DYN_URL_STRING /* @min:%2eurlString */];\r\n                if (!endPointUrl) {\r\n                    _onNoPayloadUrl(oncomplete);\r\n                    resolveFunc && resolveFunc(false);\r\n                    return;\r\n                }\r\n                var xhr = openXhr(STR_POST_METHOD, endPointUrl, _sendCredentials, true, sync, payload[_DYN_TIMEOUT /* @min:%2etimeout */]);\r\n                if (!_isOneDs) {\r\n                    // application/json should NOT add to 1ds post by default\r\n                    xhr[_DYN_SET_REQUEST_HEADER /* @min:%2esetRequestHeader */](\"Content-type\", \"application/json\");\r\n                }\r\n                arrForEach(objKeys(headers), function (headerName) {\r\n                    xhr[_DYN_SET_REQUEST_HEADER /* @min:%2esetRequestHeader */](headerName, headers[headerName]);\r\n                });\r\n                xhr.onreadystatechange = function () {\r\n                    if (!_isOneDs) {\r\n                        _doOnReadyFunc(xhr);\r\n                        if (xhr.readyState === 4) {\r\n                            resolveFunc && resolveFunc(true);\r\n                        }\r\n                    }\r\n                };\r\n                xhr.onload = function () {\r\n                    if (_isOneDs) {\r\n                        _doOnReadyFunc(xhr);\r\n                    }\r\n                };\r\n                function _doOnReadyFunc(xhr) {\r\n                    var onReadyFunc = _onCompleteFuncs && _onCompleteFuncs.xhrOnComplete;\r\n                    var onReadyFuncExist = onReadyFunc && isFunction(onReadyFunc);\r\n                    if (onReadyFuncExist) {\r\n                        onReadyFunc(xhr, oncomplete, payload);\r\n                    }\r\n                    else {\r\n                        var response = getResponseText(xhr);\r\n                        _doOnComplete(oncomplete, xhr[_DYN_STATUS /* @min:%2estatus */], _getAllResponseHeaders(xhr, _isOneDs), response);\r\n                    }\r\n                }\r\n                xhr.onerror = function (event) {\r\n                    _doOnComplete(oncomplete, _isOneDs ? xhr[_DYN_STATUS /* @min:%2estatus */] : 400, _getAllResponseHeaders(xhr, _isOneDs), _isOneDs ? STR_EMPTY : formatErrorMessageXhr(xhr));\r\n                    rejectFunc && rejectFunc(event);\r\n                };\r\n                xhr.ontimeout = function () {\r\n                    _doOnComplete(oncomplete, _isOneDs ? xhr[_DYN_STATUS /* @min:%2estatus */] : 500, _getAllResponseHeaders(xhr, _isOneDs), _isOneDs ? STR_EMPTY : formatErrorMessageXhr(xhr));\r\n                    resolveFunc && resolveFunc(false);\r\n                };\r\n                xhr.send(payload[_DYN_DATA /* @min:%2edata */]);\r\n                return thePromise;\r\n            }\r\n            /**\r\n             * Send fetch API request\r\n             * @param payload - {string} - The data payload to be sent.\r\n             * @param sync - {boolean} - For fetch this identifies whether we are \"unloading\" (false) or a normal request\r\n             */\r\n            function _doFetchSender(payload, oncomplete, sync) {\r\n                var _a;\r\n                var endPointUrl = payload[_DYN_URL_STRING /* @min:%2eurlString */];\r\n                var batch = payload[_DYN_DATA /* @min:%2edata */];\r\n                var plainTextBatch = _isOneDs ? batch : new Blob([batch], { type: \"application/json\" });\r\n                var thePromise;\r\n                var resolveFunc;\r\n                var rejectFunc;\r\n                var requestHeaders = new Headers();\r\n                var batchLength = batch[_DYN_LENGTH /* @min:%2elength */];\r\n                var ignoreResponse = false;\r\n                var responseHandled = false;\r\n                var headers = payload[_DYN_HEADERS /* @min:%2eheaders */] || {};\r\n                //TODO: handle time out for 1ds\r\n                var init = (_a = {\r\n                        method: STR_POST_METHOD,\r\n                        body: plainTextBatch\r\n                    },\r\n                    _a[DisabledPropertyName] = true // Mark so we don't attempt to track this request\r\n                ,\r\n                    _a);\r\n                // Only add headers if there are headers to add, due to issue with some polyfills\r\n                if (payload.headers && objKeys(payload.headers)[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                    arrForEach(objKeys(headers), function (headerName) {\r\n                        requestHeaders.append(headerName, headers[headerName]);\r\n                    });\r\n                    init[_DYN_HEADERS /* @min:%2eheaders */] = requestHeaders;\r\n                }\r\n                if (_fetchCredentials) { // if user passed in this value via post channel (1ds), then use it\r\n                    init.credentials = _fetchCredentials;\r\n                }\r\n                else if (_sendCredentials && _isOneDs) {\r\n                    // for 1ds, Don't send credentials when URL is file://\r\n                    init.credentials = \"include\";\r\n                }\r\n                if (sync) {\r\n                    init.keepalive = true;\r\n                    _syncFetchPayload += batchLength;\r\n                    if (_isOneDs) {\r\n                        if (payload[\"_sendReason\"] === 2 /* SendRequestReason.Unload */) {\r\n                            // As a sync request (during unload), it is unlikely that we will get a chance to process the response so\r\n                            // just like beacon send assume that the events have been accepted and processed\r\n                            ignoreResponse = true;\r\n                            if (_addNoResponse) {\r\n                                endPointUrl += _noResponseQs;\r\n                            }\r\n                        }\r\n                    }\r\n                    else {\r\n                        // for appinsights, set to true for all sync request\r\n                        ignoreResponse = true;\r\n                    }\r\n                }\r\n                var request = new Request(endPointUrl, init);\r\n                try {\r\n                    // Also try and tag the request (just in case the value in init is not copied over)\r\n                    request[DisabledPropertyName] = true;\r\n                }\r\n                catch (e) {\r\n                    // If the environment has locked down the XMLHttpRequest (preventExtensions and/or freeze), this would\r\n                    // cause the request to fail and we no telemetry would be sent\r\n                }\r\n                if (!sync && _enableSendPromise) {\r\n                    thePromise = createPromise(function (resolve, reject) {\r\n                        resolveFunc = resolve;\r\n                        rejectFunc = reject;\r\n                    });\r\n                }\r\n                if (!endPointUrl) {\r\n                    _onNoPayloadUrl(oncomplete);\r\n                    resolveFunc && resolveFunc(false);\r\n                    return;\r\n                }\r\n                function _handleError(res) {\r\n                    // In case there is an error in the request. Set the status to 0 for 1ds and 400 for appInsights\r\n                    // so that the events can be retried later.\r\n                    _doOnComplete(oncomplete, _isOneDs ? 0 : 400, {}, _isOneDs ? STR_EMPTY : res);\r\n                }\r\n                function _onFetchComplete(response, payload, value) {\r\n                    var status = response[_DYN_STATUS /* @min:%2estatus */];\r\n                    var onCompleteFunc = _onCompleteFuncs.fetchOnComplete;\r\n                    if (onCompleteFunc && isFunction(onCompleteFunc)) {\r\n                        onCompleteFunc(response, oncomplete, value || STR_EMPTY, payload);\r\n                    }\r\n                    else {\r\n                        _doOnComplete(oncomplete, status, {}, value || STR_EMPTY);\r\n                    }\r\n                }\r\n                try {\r\n                    doAwaitResponse(fetch(_isOneDs ? endPointUrl : request, _isOneDs ? init : null), function (result) {\r\n                        if (sync) {\r\n                            _syncFetchPayload -= batchLength;\r\n                            batchLength = 0;\r\n                        }\r\n                        if (!responseHandled) {\r\n                            responseHandled = true;\r\n                            if (!result.rejected) {\r\n                                var response_1 = result[_DYN_VALUE /* @min:%2evalue */];\r\n                                try {\r\n                                    /**\r\n                                     * The Promise returned from fetch() wont reject on HTTP error status even if the response is an HTTP 404 or 500.\r\n                                     * Instead, it will resolve normally (with ok status set to false), and it will only reject on network failure\r\n                                     * or if anything prevented the request from completing.\r\n                                     */\r\n                                    if (!_isOneDs && !response_1.ok) {\r\n                                        // this is for appInsights only\r\n                                        _handleError(response_1.statusText);\r\n                                        resolveFunc && resolveFunc(false);\r\n                                    }\r\n                                    else {\r\n                                        if (_isOneDs && !response_1.body) {\r\n                                            _onFetchComplete(response_1, null, STR_EMPTY);\r\n                                            resolveFunc && resolveFunc(true);\r\n                                        }\r\n                                        else {\r\n                                            doAwaitResponse(response_1.text(), function (resp) {\r\n                                                _onFetchComplete(response_1, payload, resp[_DYN_VALUE /* @min:%2evalue */]);\r\n                                                resolveFunc && resolveFunc(true);\r\n                                            });\r\n                                        }\r\n                                    }\r\n                                }\r\n                                catch (e) {\r\n                                    _handleError(dumpObj(e));\r\n                                    rejectFunc && rejectFunc(e);\r\n                                }\r\n                            }\r\n                            else {\r\n                                _handleError(result.reason && result.reason[_DYN_MESSAGE /* @min:%2emessage */]);\r\n                                rejectFunc && rejectFunc(result.reason);\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n                catch (e) {\r\n                    if (!responseHandled) {\r\n                        _handleError(dumpObj(e));\r\n                        rejectFunc && rejectFunc(e);\r\n                    }\r\n                }\r\n                if (ignoreResponse && !responseHandled) {\r\n                    // Assume success during unload processing as we most likely won't get the response\r\n                    responseHandled = true;\r\n                    _doOnComplete(oncomplete, 200, {});\r\n                    resolveFunc && resolveFunc(true);\r\n                }\r\n                if (_isOneDs && !responseHandled && payload[_DYN_TIMEOUT /* @min:%2etimeout */] > 0) {\r\n                    // Simulate timeout\r\n                    _timeoutWrapper && _timeoutWrapper.set(function () {\r\n                        if (!responseHandled) {\r\n                            // Assume a 500 response (which will cause a retry)\r\n                            responseHandled = true;\r\n                            _doOnComplete(oncomplete, 500, {});\r\n                            resolveFunc && resolveFunc(true);\r\n                        }\r\n                    }, payload[_DYN_TIMEOUT /* @min:%2etimeout */]);\r\n                }\r\n                return thePromise;\r\n            }\r\n            /**\r\n             * Send XDomainRequest\r\n             * @param payload - {string} - The data payload to be sent.\r\n             * @param sync - {boolean} - Indicates if the request should be sent synchronously\r\n             *\r\n             * Note: XDomainRequest does not support sync requests. This 'isAsync' parameter is added\r\n             * to maintain consistency with the xhrSender's contract\r\n             * Note: XDomainRequest does not support custom headers and we are not able to get\r\n             * appId from the backend for the correct correlation.\r\n             */\r\n            function _xdrSender(payload, oncomplete, sync) {\r\n                // It doesn't support custom headers, so no action is taken with current requestHeaders\r\n                var _window = getWindow();\r\n                var xdr = new XDomainRequest();\r\n                var data = payload[_DYN_DATA /* @min:%2edata */];\r\n                xdr.onload = function () {\r\n                    var response = getResponseText(xdr);\r\n                    var onloadFunc = _onCompleteFuncs && _onCompleteFuncs.xdrOnComplete;\r\n                    if (onloadFunc && isFunction(onloadFunc)) {\r\n                        onloadFunc(xdr, oncomplete, payload);\r\n                    }\r\n                    else {\r\n                        _doOnComplete(oncomplete, 200, {}, response);\r\n                    }\r\n                };\r\n                xdr.onerror = function () {\r\n                    _doOnComplete(oncomplete, 400, {}, _isOneDs ? STR_EMPTY : formatErrorMessageXdr(xdr));\r\n                };\r\n                xdr.ontimeout = function () {\r\n                    _doOnComplete(oncomplete, 500, {});\r\n                };\r\n                xdr.onprogress = function () { };\r\n                // XDomainRequest requires the same protocol as the hosting page.\r\n                // If the protocol doesn't match, we can't send the telemetry :(.\r\n                var hostingProtocol = _window && _window.location && _window.location[_DYN_PROTOCOL /* @min:%2eprotocol */] || \"\";\r\n                var endpoint = payload[_DYN_URL_STRING /* @min:%2eurlString */];\r\n                if (!endpoint) {\r\n                    _onNoPayloadUrl(oncomplete);\r\n                    return;\r\n                }\r\n                if (!_isOneDs && endpoint.lastIndexOf(hostingProtocol, 0) !== 0) {\r\n                    var msg = \"Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol.\";\r\n                    _throwInternal(_diagLog, 2 /* eLoggingSeverity.WARNING */, 40 /* _eInternalMessageId.TransmissionFailed */, \". \" + msg);\r\n                    _onError(msg, oncomplete);\r\n                    return;\r\n                }\r\n                var endpointUrl = _isOneDs ? endpoint : endpoint[_DYN_REPLACE /* @min:%2ereplace */](/^(https?:)/, \"\");\r\n                xdr.open(STR_POST_METHOD, endpointUrl);\r\n                if (payload[_DYN_TIMEOUT /* @min:%2etimeout */]) {\r\n                    xdr[_DYN_TIMEOUT /* @min:%2etimeout */] = payload[_DYN_TIMEOUT /* @min:%2etimeout */];\r\n                }\r\n                xdr.send(data);\r\n                if (_isOneDs && sync) {\r\n                    _timeoutWrapper && _timeoutWrapper.set(function () {\r\n                        xdr.send(data);\r\n                    }, 0);\r\n                }\r\n                else {\r\n                    xdr.send(data);\r\n                }\r\n            }\r\n            function _initDefaults() {\r\n                _syncFetchPayload = 0;\r\n                _isInitialized = false;\r\n                _enableSendPromise = false;\r\n                _diagLog = null;\r\n                _isOneDs = null;\r\n                _onCompleteFuncs = null;\r\n                _disableCredentials = null;\r\n                _fetchCredentials = null;\r\n                _fallbackInst = null;\r\n                _disableXhr = false;\r\n                _disableBeacon = false;\r\n                _disableBeaconSync = false;\r\n                _disableFetchKeepAlive = false;\r\n                _addNoResponse = false;\r\n                _timeoutWrapper = null;\r\n            }\r\n        });\r\n    }\r\n// Removed Stub for SenderPostManager.prototype.initialize.\r\n// Removed Stub for SenderPostManager.prototype.getSyncFetchPayload.\r\n// Removed Stub for SenderPostManager.prototype.SetConfig.\r\n// Removed Stub for SenderPostManager.prototype.getSenderInst.\r\n// Removed Stub for SenderPostManager.prototype.getFallbackInst.\r\n// Removed Stub for SenderPostManager.prototype._doTeardown.\r\n    // This is a workaround for an IE bug when using dynamicProto() with classes that don't have any\n    // non-dynamic functions or static properties/functions when using uglify-js to minify the resulting code.\n    SenderPostManager.__ieDyn=1;\n\n    return SenderPostManager;\r\n}());\r\nexport { SenderPostManager };\r\n//# sourceMappingURL=SenderPostManager.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\n\"use strict\";\r\nimport { arrForEach, isFunction } from \"@nevware21/ts-utils\";\r\nimport { _DYN_GET_NEXT, _DYN_GET_PLUGIN, _DYN_INITIALIZE, _DYN_IS_INITIALIZED, _DYN_LENGTH, _DYN_NAME, _DYN_PUSH, _DYN_SET_NEXT_PLUGIN, _DYN_SPAN_ID, _DYN_TEARDOWN, _DYN_TRACE_FLAGS, _DYN_TRACE_ID, _DYN__DO_TEARDOWN } from \"../__DynamicConstants\";\r\nimport { createElmNodeData } from \"./DataCacheHelper\";\r\nimport { STR_CORE, STR_PRIORITY, STR_PROCESS_TELEMETRY } from \"./InternalConstants\";\r\nimport { isValidSpanId, isValidTraceId } from \"./W3cTraceParent\";\r\nvar pluginStateData = createElmNodeData(\"plugin\");\r\nexport function _getPluginState(plugin) {\r\n    return pluginStateData.get(plugin, \"state\", {}, true);\r\n}\r\n/**\r\n * Initialize the queue of plugins\r\n * @param plugins - The array of plugins to initialize and setting of the next plugin\r\n * @param config - The current config for the instance\r\n * @param core - THe current core instance\r\n * @param extensions - The extensions\r\n */\r\nexport function initializePlugins(processContext, extensions) {\r\n    // Set the next plugin and identified the uninitialized plugins\r\n    var initPlugins = [];\r\n    var lastPlugin = null;\r\n    var proxy = processContext[_DYN_GET_NEXT /* @min:%2egetNext */]();\r\n    var pluginState;\r\n    while (proxy) {\r\n        var thePlugin = proxy[_DYN_GET_PLUGIN /* @min:%2egetPlugin */]();\r\n        if (thePlugin) {\r\n            if (lastPlugin && lastPlugin[_DYN_SET_NEXT_PLUGIN /* @min:%2esetNextPlugin */] && thePlugin[STR_PROCESS_TELEMETRY /* @min:%2eprocessTelemetry */]) {\r\n                // Set this plugin as the next for the previous one\r\n                lastPlugin[_DYN_SET_NEXT_PLUGIN /* @min:%2esetNextPlugin */](thePlugin);\r\n            }\r\n            pluginState = _getPluginState(thePlugin);\r\n            var isInitialized = !!pluginState[_DYN_IS_INITIALIZED /* @min:%2eisInitialized */];\r\n            if (thePlugin[_DYN_IS_INITIALIZED /* @min:%2eisInitialized */]) {\r\n                isInitialized = thePlugin[_DYN_IS_INITIALIZED /* @min:%2eisInitialized */]();\r\n            }\r\n            if (!isInitialized) {\r\n                initPlugins[_DYN_PUSH /* @min:%2epush */](thePlugin);\r\n            }\r\n            lastPlugin = thePlugin;\r\n            proxy = proxy[_DYN_GET_NEXT /* @min:%2egetNext */]();\r\n        }\r\n    }\r\n    // Now initialize the plugins\r\n    arrForEach(initPlugins, function (thePlugin) {\r\n        var core = processContext[STR_CORE /* @min:%2ecore */]();\r\n        thePlugin[_DYN_INITIALIZE /* @min:%2einitialize */](processContext.getCfg(), core, extensions, processContext[_DYN_GET_NEXT /* @min:%2egetNext */]());\r\n        pluginState = _getPluginState(thePlugin);\r\n        // Only add the core to the state if the plugin didn't set it (doesn't extend from BaseTelemetryPlugin)\r\n        if (!thePlugin[STR_CORE] && !pluginState[STR_CORE]) {\r\n            pluginState[STR_CORE] = core;\r\n        }\r\n        pluginState[_DYN_IS_INITIALIZED /* @min:%2eisInitialized */] = true;\r\n        delete pluginState[_DYN_TEARDOWN /* @min:%2eteardown */];\r\n    });\r\n}\r\nexport function sortPlugins(plugins) {\r\n    // Sort by priority\r\n    return plugins.sort(function (extA, extB) {\r\n        var result = 0;\r\n        if (extB) {\r\n            var bHasProcess = extB[STR_PROCESS_TELEMETRY];\r\n            if (extA[STR_PROCESS_TELEMETRY]) {\r\n                result = bHasProcess ? extA[STR_PRIORITY] - extB[STR_PRIORITY] : 1;\r\n            }\r\n            else if (bHasProcess) {\r\n                result = -1;\r\n            }\r\n        }\r\n        else {\r\n            result = extA ? 1 : -1;\r\n        }\r\n        return result;\r\n    });\r\n    // sort complete\r\n}\r\n/**\r\n * Teardown / Unload helper to perform teardown/unloading operations for the provided components synchronously or asynchronously, this will call any\r\n * _doTeardown() or _doUnload() functions on the provided components to allow them to finish removal.\r\n * @param components - The components you want to unload\r\n * @param unloadCtx - This is the context that should be used during unloading.\r\n * @param unloadState - The details / state of the unload process, it holds details like whether it should be unloaded synchronously or asynchronously and the reason for the unload.\r\n * @param asyncCallback - An optional callback that the plugin must call if it returns true to inform the caller that it has completed any async unload/teardown operations.\r\n * @returns boolean - true if the plugin has or will call asyncCallback, this allows the plugin to perform any asynchronous operations.\r\n */\r\nexport function unloadComponents(components, unloadCtx, unloadState, asyncCallback) {\r\n    var idx = 0;\r\n    function _doUnload() {\r\n        while (idx < components[_DYN_LENGTH /* @min:%2elength */]) {\r\n            var component = components[idx++];\r\n            if (component) {\r\n                var func = component._doUnload || component[_DYN__DO_TEARDOWN /* @min:%2e_doTeardown */];\r\n                if (isFunction(func)) {\r\n                    if (func.call(component, unloadCtx, unloadState, _doUnload) === true) {\r\n                        return true;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return _doUnload();\r\n}\r\n/**\r\n * Creates a IDistributedTraceContext which optionally also \"sets\" the value on a parent\r\n * @param parentCtx - An optional parent distributed trace instance\r\n * @returns A new IDistributedTraceContext instance that uses an internal temporary object\r\n */\r\nexport function createDistributedTraceContext(parentCtx) {\r\n    var trace = {};\r\n    return {\r\n        getName: function () {\r\n            return trace[_DYN_NAME /* @min:%2ename */];\r\n        },\r\n        setName: function (newValue) {\r\n            parentCtx && parentCtx.setName(newValue);\r\n            trace[_DYN_NAME /* @min:%2ename */] = newValue;\r\n        },\r\n        getTraceId: function () {\r\n            return trace[_DYN_TRACE_ID /* @min:%2etraceId */];\r\n        },\r\n        setTraceId: function (newValue) {\r\n            parentCtx && parentCtx.setTraceId(newValue);\r\n            if (isValidTraceId(newValue)) {\r\n                trace[_DYN_TRACE_ID /* @min:%2etraceId */] = newValue;\r\n            }\r\n        },\r\n        getSpanId: function () {\r\n            return trace[_DYN_SPAN_ID /* @min:%2espanId */];\r\n        },\r\n        setSpanId: function (newValue) {\r\n            parentCtx && parentCtx.setSpanId(newValue);\r\n            if (isValidSpanId(newValue)) {\r\n                trace[_DYN_SPAN_ID /* @min:%2espanId */] = newValue;\r\n            }\r\n        },\r\n        getTraceFlags: function () {\r\n            return trace[_DYN_TRACE_FLAGS /* @min:%2etraceFlags */];\r\n        },\r\n        setTraceFlags: function (newTraceFlags) {\r\n            parentCtx && parentCtx.setTraceFlags(newTraceFlags);\r\n            trace[_DYN_TRACE_FLAGS /* @min:%2etraceFlags */] = newTraceFlags;\r\n        }\r\n    };\r\n}\r\n//# sourceMappingURL=TelemetryHelpers.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { arrForEach, dumpObj } from \"@nevware21/ts-utils\";\r\nimport { _DYN_DIAG_LOG, _DYN_PUSH } from \"../__DynamicConstants\";\r\nimport { _throwInternal } from \"./DiagnosticLogger\";\r\nexport function createUnloadHandlerContainer() {\r\n    var handlers = [];\r\n    function _addHandler(handler) {\r\n        if (handler) {\r\n            handlers[_DYN_PUSH /* @min:%2epush */](handler);\r\n        }\r\n    }\r\n    function _runHandlers(unloadCtx, unloadState) {\r\n        arrForEach(handlers, function (handler) {\r\n            try {\r\n                handler(unloadCtx, unloadState);\r\n            }\r\n            catch (e) {\r\n                _throwInternal(unloadCtx[_DYN_DIAG_LOG /* @min:%2ediagLog */](), 2 /* eLoggingSeverity.WARNING */, 73 /* _eInternalMessageId.PluginException */, \"Unexpected error calling unload handler - \" + dumpObj(e));\r\n            }\r\n        });\r\n        handlers = [];\r\n    }\r\n    return {\r\n        add: _addHandler,\r\n        run: _runHandlers\r\n    };\r\n}\r\n//# sourceMappingURL=UnloadHandlerContainer.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { arrAppend, arrForEach, dumpObj } from \"@nevware21/ts-utils\";\r\nimport { _DYN_LENGTH } from \"../__DynamicConstants\";\r\nimport { _throwInternal } from \"./DiagnosticLogger\";\r\nvar _maxHooks;\r\nvar _hookAddMonitor;\r\n/**\r\n * Test hook for setting the maximum number of unload hooks and calling a monitor function when the hooks are added or removed\r\n * This allows for automatic test failure when the maximum number of unload hooks is exceeded\r\n * @param maxHooks - The maximum number of unload hooks\r\n * @param addMonitor - The monitor function to call when hooks are added or removed\r\n */\r\nexport function _testHookMaxUnloadHooksCb(maxHooks, addMonitor) {\r\n    _maxHooks = maxHooks;\r\n    _hookAddMonitor = addMonitor;\r\n}\r\n/**\r\n * Create a IUnloadHookContainer which can be used to remember unload hook functions to be executed during the component unloading\r\n * process.\r\n * @returns A new IUnloadHookContainer instance\r\n */\r\nexport function createUnloadHookContainer() {\r\n    var _hooks = [];\r\n    function _doUnload(logger) {\r\n        var oldHooks = _hooks;\r\n        _hooks = [];\r\n        // Remove all registered unload hooks\r\n        arrForEach(oldHooks, function (fn) {\r\n            // allow either rm or remove callback function\r\n            try {\r\n                (fn.rm || fn.remove).call(fn);\r\n            }\r\n            catch (e) {\r\n                _throwInternal(logger, 2 /* eLoggingSeverity.WARNING */, 73 /* _eInternalMessageId.PluginException */, \"Unloading:\" + dumpObj(e));\r\n            }\r\n        });\r\n        if (_maxHooks && oldHooks[_DYN_LENGTH /* @min:%2elength */] > _maxHooks) {\r\n            _hookAddMonitor ? _hookAddMonitor(\"doUnload\", oldHooks) : _throwInternal(null, 1 /* eLoggingSeverity.CRITICAL */, 48 /* _eInternalMessageId.MaxUnloadHookExceeded */, \"Max unload hooks exceeded. An excessive number of unload hooks has been detected.\");\r\n        }\r\n    }\r\n    function _addHook(hooks) {\r\n        if (hooks) {\r\n            arrAppend(_hooks, hooks);\r\n            if (_maxHooks && _hooks[_DYN_LENGTH /* @min:%2elength */] > _maxHooks) {\r\n                _hookAddMonitor ? _hookAddMonitor(\"Add\", _hooks) : _throwInternal(null, 1 /* eLoggingSeverity.CRITICAL */, 48 /* _eInternalMessageId.MaxUnloadHookExceeded */, \"Max unload hooks exceeded. An excessive number of unload hooks has been detected.\");\r\n            }\r\n        }\r\n    }\r\n    return {\r\n        run: _doUnload,\r\n        add: _addHook\r\n    };\r\n}\r\n//# sourceMappingURL=UnloadHookContainer.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\nimport { arrForEach, isArray, isString, strLeft, strTrim } from \"@nevware21/ts-utils\";\r\nimport { _DYN_GET_ATTRIBUTE, _DYN_LENGTH, _DYN_PUSH, _DYN_SPAN_ID, _DYN_SPLIT, _DYN_TO_LOWER_CASE, _DYN_TRACE_FLAGS, _DYN_TRACE_ID, _DYN_VERSION } from \"../__DynamicConstants\";\r\nimport { generateW3CId } from \"./CoreUtils\";\r\nimport { findMetaTag, findNamedServerTiming } from \"./EnvUtils\";\r\nimport { STR_EMPTY } from \"./InternalConstants\";\r\n// using {0,16} for leading and trailing whitespace just to constrain the possible runtime of a random string\r\nvar TRACE_PARENT_REGEX = /^([\\da-f]{2})-([\\da-f]{32})-([\\da-f]{16})-([\\da-f]{2})(-[^\\s]{1,64})?$/i;\r\nvar DEFAULT_VERSION = \"00\";\r\nvar INVALID_VERSION = \"ff\";\r\nvar INVALID_TRACE_ID = \"00000000000000000000000000000000\";\r\nvar INVALID_SPAN_ID = \"0000000000000000\";\r\nvar SAMPLED_FLAG = 0x01;\r\nfunction _isValid(value, len, invalidValue) {\r\n    if (value && value[_DYN_LENGTH /* @min:%2elength */] === len && value !== invalidValue) {\r\n        return !!value.match(/^[\\da-f]*$/i);\r\n    }\r\n    return false;\r\n}\r\nfunction _formatValue(value, len, defValue) {\r\n    if (_isValid(value, len)) {\r\n        return value;\r\n    }\r\n    return defValue;\r\n}\r\nfunction _formatFlags(value) {\r\n    if (isNaN(value) || value < 0 || value > 255) {\r\n        value = 0x01;\r\n    }\r\n    var result = value.toString(16);\r\n    while (result[_DYN_LENGTH /* @min:%2elength */] < 2) {\r\n        result = \"0\" + result;\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * Create a new ITraceParent instance using the provided values.\r\n * @param traceId - The traceId to use, when invalid a new random W3C id will be generated.\r\n * @param spanId - The parent/span id to use, a new random value will be generated if it is invalid.\r\n * @param flags - The traceFlags to use, defaults to zero (0) if not supplied or invalid\r\n * @param version - The version to used, defaults to version \"01\" if not supplied or invalid.\r\n * @returns\r\n */\r\nexport function createTraceParent(traceId, spanId, flags, version) {\r\n    var _a;\r\n    return _a = {},\r\n        _a[_DYN_VERSION /* @min:version */] = _isValid(version, 2, INVALID_VERSION) ? version : DEFAULT_VERSION,\r\n        _a[_DYN_TRACE_ID /* @min:traceId */] = isValidTraceId(traceId) ? traceId : generateW3CId(),\r\n        _a[_DYN_SPAN_ID /* @min:spanId */] = isValidSpanId(spanId) ? spanId : strLeft(generateW3CId(), 16),\r\n        _a.traceFlags = flags >= 0 && flags <= 0xFF ? flags : 1,\r\n        _a;\r\n}\r\n/**\r\n * Attempt to parse the provided string as a W3C TraceParent header value (https://www.w3.org/TR/trace-context/#traceparent-header)\r\n *\r\n * @param value - The value to be parsed\r\n * @param selectIdx - If the found value is comma separated which is the preferred entry to select, defaults to the first\r\n * @returns\r\n */\r\nexport function parseTraceParent(value, selectIdx) {\r\n    var _a;\r\n    if (!value) {\r\n        // Don't pass a null/undefined or empty string\r\n        return null;\r\n    }\r\n    if (isArray(value)) {\r\n        // The value may have been encoded on the page into an array so handle this automatically\r\n        value = value[0] || \"\";\r\n    }\r\n    if (!value || !isString(value) || value[_DYN_LENGTH /* @min:%2elength */] > 8192) {\r\n        // limit potential processing based on total length\r\n        return null;\r\n    }\r\n    if (value.indexOf(\",\") !== -1) {\r\n        var values = value[_DYN_SPLIT /* @min:%2esplit */](\",\");\r\n        value = values[selectIdx > 0 && values[_DYN_LENGTH /* @min:%2elength */] > selectIdx ? selectIdx : 0];\r\n    }\r\n    // See https://www.w3.org/TR/trace-context/#versioning-of-traceparent\r\n    var match = TRACE_PARENT_REGEX.exec(strTrim(value));\r\n    if (!match || // No match\r\n        match[1] === INVALID_VERSION || // version ff is forbidden\r\n        match[2] === INVALID_TRACE_ID || // All zeros is considered to be invalid\r\n        match[3] === INVALID_SPAN_ID) { // All zeros is considered to be invalid\r\n        return null;\r\n    }\r\n    return _a = {\r\n            version: (match[1] || STR_EMPTY)[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */](),\r\n            traceId: (match[2] || STR_EMPTY)[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */](),\r\n            spanId: (match[3] || STR_EMPTY)[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */]()\r\n        },\r\n        _a[_DYN_TRACE_FLAGS /* @min:traceFlags */] = parseInt(match[4], 16),\r\n        _a;\r\n}\r\n/**\r\n * Is the provided W3c Trace Id a valid string representation, it must be a 32-character string\r\n * of lowercase hexadecimal characters for example, 4bf92f3577b34da6a3ce929d0e0e4736.\r\n * If all characters as zero (00000000000000000000000000000000) it will be considered an invalid value.\r\n * @param value - The W3c trace Id to be validated\r\n * @returns true if valid otherwise false\r\n */\r\nexport function isValidTraceId(value) {\r\n    return _isValid(value, 32, INVALID_TRACE_ID);\r\n}\r\n/**\r\n * Is the provided W3c span id (aka. parent id) a valid string representation, it must be a 16-character\r\n * string of lowercase hexadecimal characters, for example, 00f067aa0ba902b7.\r\n * If all characters are zero (0000000000000000) this is considered an invalid value.\r\n * @param value - The W3c span id to be validated\r\n * @returns true if valid otherwise false\r\n */\r\nexport function isValidSpanId(value) {\r\n    return _isValid(value, 16, INVALID_SPAN_ID);\r\n}\r\n/**\r\n * Validates that the provided ITraceParent instance conforms to the currently supported specifications\r\n * @param value\r\n * @returns\r\n */\r\nexport function isValidTraceParent(value) {\r\n    if (!value ||\r\n        !_isValid(value[_DYN_VERSION /* @min:%2eversion */], 2, INVALID_VERSION) ||\r\n        !_isValid(value[_DYN_TRACE_ID /* @min:%2etraceId */], 32, INVALID_TRACE_ID) ||\r\n        !_isValid(value[_DYN_SPAN_ID /* @min:%2espanId */], 16, INVALID_SPAN_ID) ||\r\n        !_isValid(_formatFlags(value[_DYN_TRACE_FLAGS /* @min:%2etraceFlags */]), 2)) {\r\n        // Each known field must contain a valid value\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n/**\r\n * Is the parsed traceParent indicating that the trace is currently sampled.\r\n * @param value - The parsed traceParent value\r\n * @returns\r\n */\r\nexport function isSampledFlag(value) {\r\n    if (isValidTraceParent(value)) {\r\n        return (value[_DYN_TRACE_FLAGS /* @min:%2etraceFlags */] & SAMPLED_FLAG) === SAMPLED_FLAG;\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * Format the ITraceParent value as a string using the supported and know version formats.\r\n * So even if the passed traceParent is a later version the string value returned from this\r\n * function will convert it to only the known version formats.\r\n * This currently only supports version \"00\" and invalid \"ff\"\r\n * @param value - The parsed traceParent value\r\n * @returns\r\n */\r\nexport function formatTraceParent(value) {\r\n    if (value) {\r\n        // Special Note: This only supports formatting as version 00, future versions should encode any known supported version\r\n        // So parsing a future version will populate the correct version value but reformatting will reduce it to version 00.\r\n        var flags = _formatFlags(value[_DYN_TRACE_FLAGS /* @min:%2etraceFlags */]);\r\n        if (!_isValid(flags, 2)) {\r\n            flags = \"01\";\r\n        }\r\n        var version = value[_DYN_VERSION /* @min:%2eversion */] || DEFAULT_VERSION;\r\n        if (version !== \"00\" && version !== \"ff\") {\r\n            // Reduce version to \"00\"\r\n            version = DEFAULT_VERSION;\r\n        }\r\n        // Format as version 00\r\n        return \"\".concat(version.toLowerCase(), \"-\").concat(_formatValue(value.traceId, 32, INVALID_TRACE_ID).toLowerCase(), \"-\").concat(_formatValue(value.spanId, 16, INVALID_SPAN_ID).toLowerCase(), \"-\").concat(flags.toLowerCase());\r\n    }\r\n    return \"\";\r\n}\r\n/**\r\n * Helper function to fetch the passed traceparent from the page, looking for it as a meta-tag or a Server-Timing header.\r\n * @param selectIdx - If the found value is comma separated which is the preferred entry to select, defaults to the first\r\n * @returns\r\n */\r\nexport function findW3cTraceParent(selectIdx) {\r\n    var name = \"traceparent\";\r\n    var traceParent = parseTraceParent(findMetaTag(name), selectIdx);\r\n    if (!traceParent) {\r\n        traceParent = parseTraceParent(findNamedServerTiming(name), selectIdx);\r\n    }\r\n    return traceParent;\r\n}\r\n/**\r\n * Find all script tags in the provided document and return the information about them.\r\n * @param doc\r\n * @returns\r\n */\r\nexport function findAllScripts(doc) {\r\n    var scripts = doc.getElementsByTagName(\"script\");\r\n    var result = [];\r\n    arrForEach(scripts, function (script) {\r\n        var src = script[_DYN_GET_ATTRIBUTE /* @min:%2egetAttribute */](\"src\");\r\n        if (src) {\r\n            var crossOrigin = script[_DYN_GET_ATTRIBUTE /* @min:%2egetAttribute */](\"crossorigin\");\r\n            var async = script.hasAttribute(\"async\") === true;\r\n            var defer = script.hasAttribute(\"defer\") === true;\r\n            var referrerPolicy = script[_DYN_GET_ATTRIBUTE /* @min:%2egetAttribute */](\"referrerpolicy\");\r\n            var info = { url: src };\r\n            if (crossOrigin) {\r\n                info.crossOrigin = crossOrigin;\r\n            }\r\n            if (async) {\r\n                info.async = async;\r\n            }\r\n            if (defer) {\r\n                info.defer = defer;\r\n            }\r\n            if (referrerPolicy) {\r\n                info.referrerPolicy = referrerPolicy;\r\n            }\r\n            result[_DYN_PUSH /* @min:%2epush */](info);\r\n        }\r\n    });\r\n    return result;\r\n}\r\n//# sourceMappingURL=W3cTraceParent.js.map","/*\n * Application Insights JavaScript SDK - Core, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\n// @skip-file-minify\r\n// ##############################################################\r\n// AUTO GENERATED FILE: This file is Auto Generated during build.\r\n// ##############################################################\r\n// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n// Note: DON'T Export these const from the package as we are still targeting ES3 this will export a mutable variables that someone could change!!!\r\n// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\nexport var _DYN_TO_LOWER_CASE = \"toLowerCase\"; // Count: 11\r\nexport var _DYN_BLK_VAL = \"blkVal\"; // Count: 5\r\nexport var _DYN_LENGTH = \"length\"; // Count: 55\r\nexport var _DYN_RD_ONLY = \"rdOnly\"; // Count: 4\r\nexport var _DYN_NOTIFY = \"notify\"; // Count: 4\r\nexport var _DYN_WARN_TO_CONSOLE = \"warnToConsole\"; // Count: 4\r\nexport var _DYN_THROW_INTERNAL = \"throwInternal\"; // Count: 5\r\nexport var _DYN_SET_DF = \"setDf\"; // Count: 6\r\nexport var _DYN_WATCH = \"watch\"; // Count: 8\r\nexport var _DYN_LOGGER = \"logger\"; // Count: 21\r\nexport var _DYN_APPLY = \"apply\"; // Count: 7\r\nexport var _DYN_PUSH = \"push\"; // Count: 35\r\nexport var _DYN_SPLICE = \"splice\"; // Count: 8\r\nexport var _DYN_HDLR = \"hdlr\"; // Count: 6\r\nexport var _DYN_CANCEL = \"cancel\"; // Count: 6\r\nexport var _DYN_INITIALIZE = \"initialize\"; // Count: 5\r\nexport var _DYN_IDENTIFIER = \"identifier\"; // Count: 8\r\nexport var _DYN_REMOVE_NOTIFICATION_0 = \"removeNotificationListener\"; // Count: 4\r\nexport var _DYN_ADD_NOTIFICATION_LIS1 = \"addNotificationListener\"; // Count: 4\r\nexport var _DYN_IS_INITIALIZED = \"isInitialized\"; // Count: 10\r\nexport var _DYN_INSTRUMENTATION_KEY = \"instrumentationKey\"; // Count: 2\r\nexport var _DYN__INACTIVE = \"INACTIVE\"; // Count: 3\r\nexport var _DYN_VALUE = \"value\"; // Count: 5\r\nexport var _DYN_GET_NOTIFY_MGR = \"getNotifyMgr\"; // Count: 5\r\nexport var _DYN_GET_PLUGIN = \"getPlugin\"; // Count: 6\r\nexport var _DYN_NAME = \"name\"; // Count: 12\r\nexport var _DYN_I_KEY = \"iKey\"; // Count: 5\r\nexport var _DYN_TIME = \"time\"; // Count: 6\r\nexport var _DYN_PROCESS_NEXT = \"processNext\"; // Count: 15\r\nexport var _DYN_GET_PROCESS_TEL_CONT2 = \"getProcessTelContext\"; // Count: 2\r\nexport var _DYN_POLL_INTERNAL_LOGS = \"pollInternalLogs\"; // Count: 2\r\nexport var _DYN_ENABLED = \"enabled\"; // Count: 6\r\nexport var _DYN_STOP_POLLING_INTERNA3 = \"stopPollingInternalLogs\"; // Count: 2\r\nexport var _DYN_UNLOAD = \"unload\"; // Count: 9\r\nexport var _DYN_ON_COMPLETE = \"onComplete\"; // Count: 5\r\nexport var _DYN_VERSION = \"version\"; // Count: 6\r\nexport var _DYN_LOGGING_LEVEL_CONSOL4 = \"loggingLevelConsole\"; // Count: 2\r\nexport var _DYN_CREATE_NEW = \"createNew\"; // Count: 7\r\nexport var _DYN_TEARDOWN = \"teardown\"; // Count: 9\r\nexport var _DYN_MESSAGE_ID = \"messageId\"; // Count: 4\r\nexport var _DYN_MESSAGE = \"message\"; // Count: 7\r\nexport var _DYN_IS_ASYNC = \"isAsync\"; // Count: 6\r\nexport var _DYN_DIAG_LOG = \"diagLog\"; // Count: 10\r\nexport var _DYN__DO_TEARDOWN = \"_doTeardown\"; // Count: 5\r\nexport var _DYN_UPDATE = \"update\"; // Count: 6\r\nexport var _DYN_GET_NEXT = \"getNext\"; // Count: 12\r\nexport var _DYN_SET_NEXT_PLUGIN = \"setNextPlugin\"; // Count: 5\r\nexport var _DYN_PROTOCOL = \"protocol\"; // Count: 3\r\nexport var _DYN_USER_AGENT = \"userAgent\"; // Count: 5\r\nexport var _DYN_SPLIT = \"split\"; // Count: 7\r\nexport var _DYN_NODE_TYPE = \"nodeType\"; // Count: 3\r\nexport var _DYN_REPLACE = \"replace\"; // Count: 9\r\nexport var _DYN_LOG_INTERNAL_MESSAGE = \"logInternalMessage\"; // Count: 2\r\nexport var _DYN_TYPE = \"type\"; // Count: 14\r\nexport var _DYN_HANDLER = \"handler\"; // Count: 5\r\nexport var _DYN_STATUS = \"status\"; // Count: 5\r\nexport var _DYN_GET_RESPONSE_HEADER = \"getResponseHeader\"; // Count: 2\r\nexport var _DYN_GET_ALL_RESPONSE_HEA5 = \"getAllResponseHeaders\"; // Count: 2\r\nexport var _DYN_IS_CHILD_EVT = \"isChildEvt\"; // Count: 3\r\nexport var _DYN_DATA = \"data\"; // Count: 7\r\nexport var _DYN_GET_CTX = \"getCtx\"; // Count: 6\r\nexport var _DYN_SET_CTX = \"setCtx\"; // Count: 10\r\nexport var _DYN_COMPLETE = \"complete\"; // Count: 3\r\nexport var _DYN_ITEMS_RECEIVED = \"itemsReceived\"; // Count: 3\r\nexport var _DYN_URL_STRING = \"urlString\"; // Count: 5\r\nexport var _DYN_SEND_POST = \"sendPOST\"; // Count: 3\r\nexport var _DYN_HEADERS = \"headers\"; // Count: 5\r\nexport var _DYN_TIMEOUT = \"timeout\"; // Count: 6\r\nexport var _DYN_SET_REQUEST_HEADER = \"setRequestHeader\"; // Count: 2\r\nexport var _DYN_TRACE_ID = \"traceId\"; // Count: 5\r\nexport var _DYN_SPAN_ID = \"spanId\"; // Count: 5\r\nexport var _DYN_TRACE_FLAGS = \"traceFlags\"; // Count: 6\r\nexport var _DYN_GET_ATTRIBUTE = \"getAttribute\"; // Count: 3\r\n//# sourceMappingURL=__DynamicConstants.js.map","// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\nexport var strShimFunction = \"function\";\r\nexport var strShimObject = \"object\";\r\nexport var strShimUndefined = \"undefined\";\r\nexport var strShimPrototype = \"prototype\";\r\nexport var strDefault = \"default\";\r\nexport var ObjClass = Object;\r\nexport var ObjProto = ObjClass[strShimPrototype];\r\n//# sourceMappingURL=Constants.js.map","// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\nimport { getGlobal, objAssign, objCreate, objDefineProp, objHasOwnProperty, throwTypeError } from \"@nevware21/ts-utils\";\r\nimport { ObjClass, ObjProto, strDefault, strShimFunction, strShimPrototype } from \"./Constants\";\r\n// Most of these functions have been directly shamelessly \"lifted\" from the https://github.com/@microsoft/tslib and\r\n// modified to be ES5 compatible and applying several minification and tree-shaking techniques so that Application Insights\r\n// can successfully use TypeScript \"importHelpers\" which imports tslib during compilation but it will use these at runtime\r\n// Which is also why all of the functions have not been included as Application Insights currently doesn't use or require\r\n// them.\r\nexport var SymbolObj = (getGlobal() || {})[\"Symbol\"];\r\nexport var ReflectObj = (getGlobal() || {})[\"Reflect\"];\r\nexport var __hasReflect = !!ReflectObj;\r\nvar strDecorate = \"decorate\";\r\nvar strMetadata = \"metadata\";\r\nvar strGetOwnPropertySymbols = \"getOwnPropertySymbols\";\r\nvar strIterator = \"iterator\";\r\nvar strHasOwnProperty = \"hasOwnProperty\";\r\nexport var __objAssignFnImpl = function (t) {\r\n    // tslint:disable-next-line: ban-comma-operator\r\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n        s = arguments[i];\r\n        for (var p in s) {\r\n            if (ObjProto[strHasOwnProperty].call(s, p)) {\r\n                t[p] = s[p];\r\n            }\r\n        }\r\n    }\r\n    return t;\r\n};\r\nexport var __assignFn = objAssign || __objAssignFnImpl;\r\n// tslint:disable-next-line: only-arrow-functions\r\nvar extendStaticsFn = function (d, b) {\r\n    extendStaticsFn = ObjClass[\"setPrototypeOf\"] ||\r\n        // tslint:disable-next-line: only-arrow-functions\r\n        ({ __proto__: [] } instanceof Array && function (d, b) {\r\n            d.__proto__ = b;\r\n        }) ||\r\n        // tslint:disable-next-line: only-arrow-functions\r\n        function (d, b) {\r\n            for (var p in b) {\r\n                if (b[strHasOwnProperty](p)) {\r\n                    d[p] = b[p];\r\n                }\r\n            }\r\n        };\r\n    return extendStaticsFn(d, b);\r\n};\r\nexport function __extendsFn(d, b) {\r\n    if (typeof b !== strShimFunction && b !== null) {\r\n        throwTypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    }\r\n    extendStaticsFn(d, b);\r\n    function __() {\r\n        this.constructor = d;\r\n    }\r\n    // tslint:disable-next-line: ban-comma-operator\r\n    d[strShimPrototype] = b === null ? objCreate(b) : (__[strShimPrototype] = b[strShimPrototype], new __());\r\n}\r\nexport function __restFn(s, e) {\r\n    var t = {};\r\n    for (var k in s) {\r\n        if (objHasOwnProperty(s, k) && e.indexOf(k) < 0) {\r\n            t[k] = s[k];\r\n        }\r\n    }\r\n    if (s != null && typeof ObjClass[strGetOwnPropertySymbols] === strShimFunction) {\r\n        for (var i = 0, p = ObjClass[strGetOwnPropertySymbols](s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && ObjProto[\"propertyIsEnumerable\"].call(s, p[i])) {\r\n                t[p[i]] = s[p[i]];\r\n            }\r\n        }\r\n    }\r\n    return t;\r\n}\r\nexport function __decorateFn(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = ObjClass[\"getOwnPropertyDescriptor\"](target, key) : desc, d;\r\n    if (__hasReflect && typeof ReflectObj[strDecorate] === strShimFunction) {\r\n        r = ReflectObj[strDecorate](decorators, target, key, desc);\r\n    }\r\n    else {\r\n        for (var i = decorators.length - 1; i >= 0; i--) {\r\n            // eslint-disable-next-line no-cond-assign\r\n            if (d = decorators[i]) {\r\n                r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n            }\r\n        }\r\n    }\r\n    // tslint:disable-next-line:ban-comma-operator\r\n    return c > 3 && r && objDefineProp(target, key, r), r;\r\n}\r\nexport function __paramFn(paramIndex, decorator) {\r\n    return function (target, key) {\r\n        decorator(target, key, paramIndex);\r\n    };\r\n}\r\nexport function __metadataFn(metadataKey, metadataValue) {\r\n    if (__hasReflect && ReflectObj[strMetadata] === strShimFunction) {\r\n        return ReflectObj[strMetadata](metadataKey, metadataValue);\r\n    }\r\n}\r\nexport function __exportStarFn(m, o) {\r\n    for (var p in m) {\r\n        if (p !== strDefault && !objHasOwnProperty(o, p)) {\r\n            __createBindingFn(o, m, p);\r\n        }\r\n    }\r\n}\r\nexport function __createBindingFn(o, m, k, k2) {\r\n    if (k2 === undefined) {\r\n        k2 = k;\r\n    }\r\n    if (!!objDefineProp) {\r\n        objDefineProp(o, k2, {\r\n            enumerable: true,\r\n            get: function () {\r\n                return m[k];\r\n            }\r\n        });\r\n    }\r\n    else {\r\n        o[k2] = m[k];\r\n    }\r\n}\r\nexport function __valuesFn(o) {\r\n    var s = typeof SymbolObj === strShimFunction && SymbolObj[strIterator], m = s && o[s], i = 0;\r\n    if (m) {\r\n        return m.call(o);\r\n    }\r\n    if (o && typeof o.length === \"number\") {\r\n        return {\r\n            next: function () {\r\n                if (o && i >= o.length) {\r\n                    o = void 0;\r\n                }\r\n                return { value: o && o[i++], done: !o };\r\n            }\r\n        };\r\n    }\r\n    throwTypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\nexport function __readFn(o, n) {\r\n    var m = typeof SymbolObj === strShimFunction && o[SymbolObj[strIterator]];\r\n    if (!m) {\r\n        return o;\r\n    }\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\r\n            ar.push(r.value);\r\n        }\r\n    }\r\n    catch (error) {\r\n        e = {\r\n            error: error\r\n        };\r\n    }\r\n    finally {\r\n        try {\r\n            // tslint:disable-next-line:no-conditional-assignment\r\n            if (r && !r.done && (m = i[\"return\"])) {\r\n                m.call(i);\r\n            }\r\n        }\r\n        finally {\r\n            if (e) {\r\n                // eslint-disable-next-line no-unsafe-finally\r\n                throw e.error;\r\n            }\r\n        }\r\n    }\r\n    return ar;\r\n}\r\n/** @deprecated */\r\nexport function __spreadArraysFn() {\r\n    var theArgs = arguments;\r\n    // Calculate new total size\r\n    for (var s = 0, i = 0, il = theArgs.length; i < il; i++) {\r\n        s += theArgs[i].length;\r\n    }\r\n    // Create new full array\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++) {\r\n        for (var a = theArgs[i], j = 0, jl = a.length; j < jl; j++, k++) {\r\n            r[k] = a[j];\r\n        }\r\n    }\r\n    return r;\r\n}\r\nexport function __spreadArrayFn(to, from) {\r\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++) {\r\n        to[j] = from[i];\r\n    }\r\n    return to;\r\n}\r\nexport function __makeTemplateObjectFn(cooked, raw) {\r\n    if (objDefineProp) {\r\n        objDefineProp(cooked, \"raw\", { value: raw });\r\n    }\r\n    else {\r\n        cooked.raw = raw;\r\n    }\r\n    return cooked;\r\n}\r\nexport function __importStarFn(mod) {\r\n    if (mod && mod.__esModule) {\r\n        return mod;\r\n    }\r\n    var result = {};\r\n    if (mod != null) {\r\n        for (var k in mod) {\r\n            if (k !== strDefault && Object.prototype.hasOwnProperty.call(mod, k)) {\r\n                __createBindingFn(result, mod, k);\r\n            }\r\n        }\r\n    }\r\n    // Set default module\r\n    if (!!objDefineProp) {\r\n        objDefineProp(result, strDefault, { enumerable: true, value: mod });\r\n    }\r\n    else {\r\n        result[strDefault] = mod;\r\n    }\r\n    return result;\r\n}\r\nexport function __importDefaultFn(mod) {\r\n    return (mod && mod.__esModule) ? mod : { strDefault: mod };\r\n}\r\n//# sourceMappingURL=TsLibShims.js.map","/*\n * Application Insights JavaScript SDK - Common, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\n/**\r\n * This is an internal property used to cause internal (reporting) requests to be ignored from reporting\r\n * additional telemetry, to handle polyfil implementations ALL urls used with a disabled request will\r\n * also be ignored for future requests even when this property is not provided.\r\n * Tagging as Ignore as this is an internal value and is not expected to be used outside of the SDK\r\n * @ignore\r\n */\r\nexport var DisabledPropertyName = \"Microsoft_ApplicationInsights_BypassAjaxInstrumentation\";\r\nexport var SampleRate = \"sampleRate\";\r\nexport var ProcessLegacy = \"ProcessLegacy\";\r\nexport var HttpMethod = \"http.method\";\r\nexport var DEFAULT_BREEZE_ENDPOINT = \"https://dc.services.visualstudio.com\";\r\nexport var DEFAULT_BREEZE_PATH = \"/v2/track\";\r\nexport var strNotSpecified = \"not_specified\";\r\nexport var strIkey = \"iKey\";\r\n//# sourceMappingURL=Constants.js.map","/*\n * Application Insights JavaScript SDK - Common, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\n// @skip-file-minify\r\n// ##############################################################\r\n// AUTO GENERATED FILE: This file is Auto Generated during build.\r\n// ##############################################################\r\n// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n// Note: DON'T Export these const from the package as we are still targeting ES3 this will export a mutable variables that someone could change!!!\r\n// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\nexport var _DYN_SPLIT = \"split\"; // Count: 6\r\nexport var _DYN_LENGTH = \"length\"; // Count: 41\r\nexport var _DYN_TO_LOWER_CASE = \"toLowerCase\"; // Count: 6\r\nexport var _DYN_INGESTIONENDPOINT = \"ingestionendpoint\"; // Count: 6\r\nexport var _DYN_TO_STRING = \"toString\"; // Count: 9\r\nexport var _DYN_PUSH = \"push\"; // Count: 5\r\nexport var _DYN_REMOVE_ITEM = \"removeItem\"; // Count: 3\r\nexport var _DYN_NAME = \"name\"; // Count: 11\r\nexport var _DYN_MESSAGE = \"message\"; // Count: 10\r\nexport var _DYN_COUNT = \"count\"; // Count: 8\r\nexport var _DYN_PRE_TRIGGER_DATE = \"preTriggerDate\"; // Count: 4\r\nexport var _DYN_DISABLED = \"disabled\"; // Count: 3\r\nexport var _DYN_INTERVAL = \"interval\"; // Count: 3\r\nexport var _DYN_DAYS_OF_MONTH = \"daysOfMonth\"; // Count: 3\r\nexport var _DYN_DATE = \"date\"; // Count: 5\r\nexport var _DYN_GET_UTCDATE = \"getUTCDate\"; // Count: 3\r\nexport var _DYN_STRINGIFY = \"stringify\"; // Count: 4\r\nexport var _DYN_PATHNAME = \"pathname\"; // Count: 4\r\nexport var _DYN_CORRELATION_HEADER_E0 = \"correlationHeaderExcludePatterns\"; // Count: 2\r\nexport var _DYN_EXTENSION_CONFIG = \"extensionConfig\"; // Count: 4\r\nexport var _DYN_EXCEPTIONS = \"exceptions\"; // Count: 6\r\nexport var _DYN_PARSED_STACK = \"parsedStack\"; // Count: 13\r\nexport var _DYN_PROPERTIES = \"properties\"; // Count: 9\r\nexport var _DYN_MEASUREMENTS = \"measurements\"; // Count: 9\r\nexport var _DYN_SIZE_IN_BYTES = \"sizeInBytes\"; // Count: 11\r\nexport var _DYN_TYPE_NAME = \"typeName\"; // Count: 11\r\nexport var _DYN_SEVERITY_LEVEL = \"severityLevel\"; // Count: 5\r\nexport var _DYN_PROBLEM_GROUP = \"problemGroup\"; // Count: 3\r\nexport var _DYN_IS_MANUAL = \"isManual\"; // Count: 3\r\nexport var _DYN__CREATE_FROM_INTERFA1 = \"CreateFromInterface\"; // Count: 2\r\nexport var _DYN_ASSEMBLY = \"assembly\"; // Count: 7\r\nexport var _DYN_FILE_NAME = \"fileName\"; // Count: 8\r\nexport var _DYN_HAS_FULL_STACK = \"hasFullStack\"; // Count: 6\r\nexport var _DYN_LEVEL = \"level\"; // Count: 5\r\nexport var _DYN_METHOD = \"method\"; // Count: 7\r\nexport var _DYN_LINE = \"line\"; // Count: 6\r\nexport var _DYN_DURATION = \"duration\"; // Count: 4\r\nexport var _DYN_RECEIVED_RESPONSE = \"receivedResponse\"; // Count: 2\r\n//# sourceMappingURL=__DynamicConstants.js.map","/*\n * Application Insights JavaScript SDK - Common, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { _throwInternal, getJSON, hasJSON, isObject, objForEachKey, strTrim } from \"@microsoft/applicationinsights-core-js\";\r\nimport { asString, strSubstr, strSubstring } from \"@nevware21/ts-utils\";\r\nimport { _DYN_LENGTH, _DYN_STRINGIFY, _DYN_TO_STRING } from \"../../__DynamicConstants\";\r\nexport function dataSanitizeKeyAndAddUniqueness(logger, key, map) {\r\n    var origLength = key[_DYN_LENGTH /* @min:%2elength */];\r\n    var field = dataSanitizeKey(logger, key);\r\n    // validation truncated the length.  We need to add uniqueness\r\n    if (field[_DYN_LENGTH /* @min:%2elength */] !== origLength) {\r\n        var i = 0;\r\n        var uniqueField = field;\r\n        while (map[uniqueField] !== undefined) {\r\n            i++;\r\n            uniqueField = strSubstring(field, 0, 150 /* DataSanitizerValues.MAX_NAME_LENGTH */ - 3) + dsPadNumber(i);\r\n        }\r\n        field = uniqueField;\r\n    }\r\n    return field;\r\n}\r\nexport function dataSanitizeKey(logger, name) {\r\n    var nameTrunc;\r\n    if (name) {\r\n        // Remove any leading or trailing whitespace\r\n        name = strTrim(asString(name));\r\n        // truncate the string to 150 chars\r\n        if (name[_DYN_LENGTH /* @min:%2elength */] > 150 /* DataSanitizerValues.MAX_NAME_LENGTH */) {\r\n            nameTrunc = strSubstring(name, 0, 150 /* DataSanitizerValues.MAX_NAME_LENGTH */);\r\n            _throwInternal(logger, 2 /* eLoggingSeverity.WARNING */, 57 /* _eInternalMessageId.NameTooLong */, \"name is too long.  It has been truncated to \" + 150 /* DataSanitizerValues.MAX_NAME_LENGTH */ + \" characters.\", { name: name }, true);\r\n        }\r\n    }\r\n    return nameTrunc || name;\r\n}\r\nexport function dataSanitizeString(logger, value, maxLength) {\r\n    if (maxLength === void 0) { maxLength = 1024 /* DataSanitizerValues.MAX_STRING_LENGTH */; }\r\n    var valueTrunc;\r\n    if (value) {\r\n        maxLength = maxLength ? maxLength : 1024 /* DataSanitizerValues.MAX_STRING_LENGTH */; // in case default parameters dont work\r\n        value = strTrim(asString(value));\r\n        if (value[_DYN_LENGTH /* @min:%2elength */] > maxLength) {\r\n            valueTrunc = strSubstring(value, 0, maxLength);\r\n            _throwInternal(logger, 2 /* eLoggingSeverity.WARNING */, 61 /* _eInternalMessageId.StringValueTooLong */, \"string value is too long. It has been truncated to \" + maxLength + \" characters.\", { value: value }, true);\r\n        }\r\n    }\r\n    return valueTrunc || value;\r\n}\r\nexport function dataSanitizeUrl(logger, url) {\r\n    return dataSanitizeInput(logger, url, 2048 /* DataSanitizerValues.MAX_URL_LENGTH */, 66 /* _eInternalMessageId.UrlTooLong */);\r\n}\r\nexport function dataSanitizeMessage(logger, message) {\r\n    var messageTrunc;\r\n    if (message) {\r\n        if (message[_DYN_LENGTH /* @min:%2elength */] > 32768 /* DataSanitizerValues.MAX_MESSAGE_LENGTH */) {\r\n            messageTrunc = strSubstring(message, 0, 32768 /* DataSanitizerValues.MAX_MESSAGE_LENGTH */);\r\n            _throwInternal(logger, 2 /* eLoggingSeverity.WARNING */, 56 /* _eInternalMessageId.MessageTruncated */, \"message is too long, it has been truncated to \" + 32768 /* DataSanitizerValues.MAX_MESSAGE_LENGTH */ + \" characters.\", { message: message }, true);\r\n        }\r\n    }\r\n    return messageTrunc || message;\r\n}\r\nexport function dataSanitizeException(logger, exception) {\r\n    var exceptionTrunc;\r\n    if (exception) {\r\n        // Make surte its a string\r\n        var value = \"\" + exception;\r\n        if (value[_DYN_LENGTH /* @min:%2elength */] > 32768 /* DataSanitizerValues.MAX_EXCEPTION_LENGTH */) {\r\n            exceptionTrunc = strSubstring(value, 0, 32768 /* DataSanitizerValues.MAX_EXCEPTION_LENGTH */);\r\n            _throwInternal(logger, 2 /* eLoggingSeverity.WARNING */, 52 /* _eInternalMessageId.ExceptionTruncated */, \"exception is too long, it has been truncated to \" + 32768 /* DataSanitizerValues.MAX_EXCEPTION_LENGTH */ + \" characters.\", { exception: exception }, true);\r\n        }\r\n    }\r\n    return exceptionTrunc || exception;\r\n}\r\nexport function dataSanitizeProperties(logger, properties) {\r\n    if (properties) {\r\n        var tempProps_1 = {};\r\n        objForEachKey(properties, function (prop, value) {\r\n            if (isObject(value) && hasJSON()) {\r\n                // Stringify any part C properties\r\n                try {\r\n                    value = getJSON()[_DYN_STRINGIFY /* @min:%2estringify */](value);\r\n                }\r\n                catch (e) {\r\n                    _throwInternal(logger, 2 /* eLoggingSeverity.WARNING */, 49 /* _eInternalMessageId.CannotSerializeObjectNonSerializable */, \"custom property is not valid\", { exception: e }, true);\r\n                }\r\n            }\r\n            value = dataSanitizeString(logger, value, 8192 /* DataSanitizerValues.MAX_PROPERTY_LENGTH */);\r\n            prop = dataSanitizeKeyAndAddUniqueness(logger, prop, tempProps_1);\r\n            tempProps_1[prop] = value;\r\n        });\r\n        properties = tempProps_1;\r\n    }\r\n    return properties;\r\n}\r\nexport function dataSanitizeMeasurements(logger, measurements) {\r\n    if (measurements) {\r\n        var tempMeasurements_1 = {};\r\n        objForEachKey(measurements, function (measure, value) {\r\n            measure = dataSanitizeKeyAndAddUniqueness(logger, measure, tempMeasurements_1);\r\n            tempMeasurements_1[measure] = value;\r\n        });\r\n        measurements = tempMeasurements_1;\r\n    }\r\n    return measurements;\r\n}\r\nexport function dataSanitizeId(logger, id) {\r\n    return id ? dataSanitizeInput(logger, id, 128 /* DataSanitizerValues.MAX_ID_LENGTH */, 69 /* _eInternalMessageId.IdTooLong */)[_DYN_TO_STRING /* @min:%2etoString */]() : id;\r\n}\r\nexport function dataSanitizeInput(logger, input, maxLength, _msgId) {\r\n    var inputTrunc;\r\n    if (input) {\r\n        input = strTrim(asString(input));\r\n        if (input[_DYN_LENGTH /* @min:%2elength */] > maxLength) {\r\n            inputTrunc = strSubstring(input, 0, maxLength);\r\n            _throwInternal(logger, 2 /* eLoggingSeverity.WARNING */, _msgId, \"input is too long, it has been truncated to \" + maxLength + \" characters.\", { data: input }, true);\r\n        }\r\n    }\r\n    return inputTrunc || input;\r\n}\r\nexport function dsPadNumber(num) {\r\n    var s = \"00\" + num;\r\n    return strSubstr(s, s[_DYN_LENGTH /* @min:%2elength */] - 3);\r\n}\r\n//# sourceMappingURL=DataSanitizer.js.map","/*\n * Application Insights JavaScript SDK - Common, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { strNotSpecified } from \"../Constants\";\r\nimport { _DYN_MEASUREMENTS, _DYN_NAME, _DYN_PROPERTIES } from \"../__DynamicConstants\";\r\nimport { dataSanitizeMeasurements, dataSanitizeProperties, dataSanitizeString } from \"./Common/DataSanitizer\";\r\nvar Event = /** @class */ (function () {\r\n    /**\r\n     * Constructs a new instance of the EventTelemetry object\r\n     */\r\n    function Event(logger, name, properties, measurements) {\r\n        this.aiDataContract = {\r\n            ver: 1 /* FieldType.Required */,\r\n            name: 1 /* FieldType.Required */,\r\n            properties: 0 /* FieldType.Default */,\r\n            measurements: 0 /* FieldType.Default */\r\n        };\r\n        var _self = this;\r\n        _self.ver = 2;\r\n        _self[_DYN_NAME /* @min:%2ename */] = dataSanitizeString(logger, name) || strNotSpecified;\r\n        _self[_DYN_PROPERTIES /* @min:%2eproperties */] = dataSanitizeProperties(logger, properties);\r\n        _self[_DYN_MEASUREMENTS /* @min:%2emeasurements */] = dataSanitizeMeasurements(logger, measurements);\r\n    }\r\n    Event.envelopeType = \"Microsoft.ApplicationInsights.{0}.Event\";\r\n    Event.dataType = \"EventData\";\r\n    return Event;\r\n}());\r\nexport { Event };\r\n//# sourceMappingURL=Event.js.map","/*\n * Application Insights JavaScript SDK - Common, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { strNotSpecified } from \"../Constants\";\r\nimport { _DYN_MEASUREMENTS, _DYN_MESSAGE, _DYN_PROPERTIES, _DYN_SEVERITY_LEVEL } from \"../__DynamicConstants\";\r\nimport { dataSanitizeMeasurements, dataSanitizeMessage, dataSanitizeProperties } from \"./Common/DataSanitizer\";\r\nvar Trace = /** @class */ (function () {\r\n    /**\r\n     * Constructs a new instance of the TraceTelemetry object\r\n     */\r\n    function Trace(logger, message, severityLevel, properties, measurements) {\r\n        this.aiDataContract = {\r\n            ver: 1 /* FieldType.Required */,\r\n            message: 1 /* FieldType.Required */,\r\n            severityLevel: 0 /* FieldType.Default */,\r\n            properties: 0 /* FieldType.Default */\r\n        };\r\n        var _self = this;\r\n        _self.ver = 2;\r\n        message = message || strNotSpecified;\r\n        _self[_DYN_MESSAGE /* @min:%2emessage */] = dataSanitizeMessage(logger, message);\r\n        _self[_DYN_PROPERTIES /* @min:%2eproperties */] = dataSanitizeProperties(logger, properties);\r\n        _self[_DYN_MEASUREMENTS /* @min:%2emeasurements */] = dataSanitizeMeasurements(logger, measurements);\r\n        if (severityLevel) {\r\n            _self[_DYN_SEVERITY_LEVEL /* @min:%2eseverityLevel */] = severityLevel;\r\n        }\r\n    }\r\n    Trace.envelopeType = \"Microsoft.ApplicationInsights.{0}.Message\";\r\n    Trace.dataType = \"MessageData\";\r\n    return Trace;\r\n}());\r\nexport { Trace };\r\n//# sourceMappingURL=Trace.js.map","/*\n * Application Insights JavaScript SDK - Common, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { arrForEach, isString } from \"@microsoft/applicationinsights-core-js\";\r\nimport { _DYN_LENGTH, _DYN_TO_LOWER_CASE } from \"./__DynamicConstants\";\r\nvar strEmpty = \"\";\r\nexport function stringToBoolOrDefault(str, defaultValue) {\r\n    if (defaultValue === void 0) { defaultValue = false; }\r\n    if (str === undefined || str === null) {\r\n        return defaultValue;\r\n    }\r\n    return str.toString()[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */]() === \"true\";\r\n}\r\n/**\r\n * Convert ms to c# time span format\r\n */\r\nexport function msToTimeSpan(totalms) {\r\n    if (isNaN(totalms) || totalms < 0) {\r\n        totalms = 0;\r\n    }\r\n    totalms = Math.round(totalms);\r\n    var ms = strEmpty + totalms % 1000;\r\n    var sec = strEmpty + Math.floor(totalms / 1000) % 60;\r\n    var min = strEmpty + Math.floor(totalms / (1000 * 60)) % 60;\r\n    var hour = strEmpty + Math.floor(totalms / (1000 * 60 * 60)) % 24;\r\n    var days = Math.floor(totalms / (1000 * 60 * 60 * 24));\r\n    ms = ms[_DYN_LENGTH /* @min:%2elength */] === 1 ? \"00\" + ms : ms[_DYN_LENGTH /* @min:%2elength */] === 2 ? \"0\" + ms : ms;\r\n    sec = sec[_DYN_LENGTH /* @min:%2elength */] < 2 ? \"0\" + sec : sec;\r\n    min = min[_DYN_LENGTH /* @min:%2elength */] < 2 ? \"0\" + min : min;\r\n    hour = hour[_DYN_LENGTH /* @min:%2elength */] < 2 ? \"0\" + hour : hour;\r\n    return (days > 0 ? days + \".\" : strEmpty) + hour + \":\" + min + \":\" + sec + \".\" + ms;\r\n}\r\nexport function getExtensionByName(extensions, identifier) {\r\n    var extension = null;\r\n    arrForEach(extensions, function (value) {\r\n        if (value.identifier === identifier) {\r\n            extension = value;\r\n            return -1;\r\n        }\r\n    });\r\n    return extension;\r\n}\r\nexport function isCrossOriginError(message, url, lineNumber, columnNumber, error) {\r\n    return !error && isString(message) && (message === \"Script error.\" || message === \"Script error\");\r\n}\r\n//# sourceMappingURL=HelperFuncs.js.map","/*\n * Application Insights JavaScript SDK - Common, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { strNotSpecified } from \"../Constants\";\r\nimport { msToTimeSpan } from \"../HelperFuncs\";\r\nimport { _DYN_DURATION, _DYN_MEASUREMENTS, _DYN_NAME, _DYN_PROPERTIES } from \"../__DynamicConstants\";\r\nimport { dataSanitizeId, dataSanitizeMeasurements, dataSanitizeProperties, dataSanitizeString, dataSanitizeUrl } from \"./Common/DataSanitizer\";\r\nvar PageView = /** @class */ (function () {\r\n    /**\r\n     * Constructs a new instance of the PageEventTelemetry object\r\n     */\r\n    function PageView(logger, name, url, durationMs, properties, measurements, id) {\r\n        this.aiDataContract = {\r\n            ver: 1 /* FieldType.Required */,\r\n            name: 0 /* FieldType.Default */,\r\n            url: 0 /* FieldType.Default */,\r\n            duration: 0 /* FieldType.Default */,\r\n            properties: 0 /* FieldType.Default */,\r\n            measurements: 0 /* FieldType.Default */,\r\n            id: 0 /* FieldType.Default */\r\n        };\r\n        var _self = this;\r\n        _self.ver = 2;\r\n        _self.id = dataSanitizeId(logger, id);\r\n        _self.url = dataSanitizeUrl(logger, url);\r\n        _self[_DYN_NAME /* @min:%2ename */] = dataSanitizeString(logger, name) || strNotSpecified;\r\n        if (!isNaN(durationMs)) {\r\n            _self[_DYN_DURATION /* @min:%2eduration */] = msToTimeSpan(durationMs);\r\n        }\r\n        _self[_DYN_PROPERTIES /* @min:%2eproperties */] = dataSanitizeProperties(logger, properties);\r\n        _self[_DYN_MEASUREMENTS /* @min:%2emeasurements */] = dataSanitizeMeasurements(logger, measurements);\r\n    }\r\n    PageView.envelopeType = \"Microsoft.ApplicationInsights.{0}.Pageview\";\r\n    PageView.dataType = \"PageviewData\";\r\n    return PageView;\r\n}());\r\nexport { PageView };\r\n//# sourceMappingURL=PageView.js.map","/*\n * Application Insights JavaScript SDK - Common, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { strNotSpecified } from \"../Constants\";\r\nimport { _DYN_DURATION, _DYN_MEASUREMENTS, _DYN_NAME, _DYN_PROPERTIES, _DYN_RECEIVED_RESPONSE } from \"../__DynamicConstants\";\r\nimport { dataSanitizeMeasurements, dataSanitizeProperties, dataSanitizeString, dataSanitizeUrl } from \"./Common/DataSanitizer\";\r\nvar PageViewPerformance = /** @class */ (function () {\r\n    /**\r\n     * Constructs a new instance of the PageEventTelemetry object\r\n     */\r\n    function PageViewPerformance(logger, name, url, unused, properties, measurements, cs4BaseData) {\r\n        this.aiDataContract = {\r\n            ver: 1 /* FieldType.Required */,\r\n            name: 0 /* FieldType.Default */,\r\n            url: 0 /* FieldType.Default */,\r\n            duration: 0 /* FieldType.Default */,\r\n            perfTotal: 0 /* FieldType.Default */,\r\n            networkConnect: 0 /* FieldType.Default */,\r\n            sentRequest: 0 /* FieldType.Default */,\r\n            receivedResponse: 0 /* FieldType.Default */,\r\n            domProcessing: 0 /* FieldType.Default */,\r\n            properties: 0 /* FieldType.Default */,\r\n            measurements: 0 /* FieldType.Default */\r\n        };\r\n        var _self = this;\r\n        _self.ver = 2;\r\n        _self.url = dataSanitizeUrl(logger, url);\r\n        _self[_DYN_NAME /* @min:%2ename */] = dataSanitizeString(logger, name) || strNotSpecified;\r\n        _self[_DYN_PROPERTIES /* @min:%2eproperties */] = dataSanitizeProperties(logger, properties);\r\n        _self[_DYN_MEASUREMENTS /* @min:%2emeasurements */] = dataSanitizeMeasurements(logger, measurements);\r\n        if (cs4BaseData) {\r\n            _self.domProcessing = cs4BaseData.domProcessing;\r\n            _self[_DYN_DURATION /* @min:%2eduration */] = cs4BaseData[_DYN_DURATION /* @min:%2eduration */];\r\n            _self.networkConnect = cs4BaseData.networkConnect;\r\n            _self.perfTotal = cs4BaseData.perfTotal;\r\n            _self[_DYN_RECEIVED_RESPONSE /* @min:%2ereceivedResponse */] = cs4BaseData[_DYN_RECEIVED_RESPONSE /* @min:%2ereceivedResponse */];\r\n            _self.sentRequest = cs4BaseData.sentRequest;\r\n        }\r\n    }\r\n    PageViewPerformance.envelopeType = \"Microsoft.ApplicationInsights.{0}.PageviewPerformance\";\r\n    PageViewPerformance.dataType = \"PageviewPerformanceData\";\r\n    return PageViewPerformance;\r\n}());\r\nexport { PageViewPerformance };\r\n//# sourceMappingURL=PageViewPerformance.js.map","/*\n * Application Insights JavaScript SDK - Common, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { __assignFn as __assign } from \"@microsoft/applicationinsights-shims\";\r\nimport { arrForEach, arrMap, isArray, isError, isFunction, isNullOrUndefined, isObject, isString, strTrim } from \"@microsoft/applicationinsights-core-js\";\r\nimport { getWindow, strIndexOf } from \"@nevware21/ts-utils\";\r\nimport { strNotSpecified } from \"../Constants\";\r\nimport { _DYN_ASSEMBLY, _DYN_EXCEPTIONS, _DYN_FILE_NAME, _DYN_HAS_FULL_STACK, _DYN_IS_MANUAL, _DYN_LENGTH, _DYN_LEVEL, _DYN_LINE, _DYN_MEASUREMENTS, _DYN_MESSAGE, _DYN_METHOD, _DYN_NAME, _DYN_PARSED_STACK, _DYN_PROBLEM_GROUP, _DYN_PROPERTIES, _DYN_PUSH, _DYN_SEVERITY_LEVEL, _DYN_SIZE_IN_BYTES, _DYN_SPLIT, _DYN_STRINGIFY, _DYN_TO_STRING, _DYN_TYPE_NAME, _DYN__CREATE_FROM_INTERFA1 } from \"../__DynamicConstants\";\r\nimport { dataSanitizeException, dataSanitizeMeasurements, dataSanitizeMessage, dataSanitizeProperties, dataSanitizeString } from \"./Common/DataSanitizer\";\r\nvar NoMethod = \"<no_method>\";\r\nvar strError = \"error\";\r\nvar strStack = \"stack\";\r\nvar strStackDetails = \"stackDetails\";\r\nvar strErrorSrc = \"errorSrc\";\r\nvar strMessage = \"message\";\r\nvar strDescription = \"description\";\r\nfunction _stringify(value, convertToString) {\r\n    var result = value;\r\n    if (result && !isString(result)) {\r\n        if (JSON && JSON[_DYN_STRINGIFY /* @min:%2estringify */]) {\r\n            result = JSON[_DYN_STRINGIFY /* @min:%2estringify */](value);\r\n            if (convertToString && (!result || result === \"{}\")) {\r\n                if (isFunction(value[_DYN_TO_STRING /* @min:%2etoString */])) {\r\n                    result = value[_DYN_TO_STRING /* @min:%2etoString */]();\r\n                }\r\n                else {\r\n                    result = \"\" + value;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            result = \"\" + value + \" - (Missing JSON.stringify)\";\r\n        }\r\n    }\r\n    return result || \"\";\r\n}\r\nfunction _formatMessage(theEvent, errorType) {\r\n    var evtMessage = theEvent;\r\n    if (theEvent) {\r\n        if (evtMessage && !isString(evtMessage)) {\r\n            evtMessage = theEvent[strMessage] || theEvent[strDescription] || evtMessage;\r\n        }\r\n        // Make sure the message is a string\r\n        if (evtMessage && !isString(evtMessage)) {\r\n            // tslint:disable-next-line: prefer-conditional-expression\r\n            evtMessage = _stringify(evtMessage, true);\r\n        }\r\n        if (theEvent[\"filename\"]) {\r\n            // Looks like an event object with filename\r\n            evtMessage = evtMessage + \" @\" + (theEvent[\"filename\"] || \"\") + \":\" + (theEvent[\"lineno\"] || \"?\") + \":\" + (theEvent[\"colno\"] || \"?\");\r\n        }\r\n    }\r\n    // Automatically add the error type to the message if it does already appear to be present\r\n    if (errorType && errorType !== \"String\" && errorType !== \"Object\" && errorType !== \"Error\" && strIndexOf(evtMessage || \"\", errorType) === -1) {\r\n        evtMessage = errorType + \": \" + evtMessage;\r\n    }\r\n    return evtMessage || \"\";\r\n}\r\nfunction _isExceptionDetailsInternal(value) {\r\n    try {\r\n        if (isObject(value)) {\r\n            return \"hasFullStack\" in value && \"typeName\" in value;\r\n        }\r\n    }\r\n    catch (e) {\r\n        // This can happen with some native browser objects, but should not happen for the type we are checking for\r\n    }\r\n    return false;\r\n}\r\nfunction _isExceptionInternal(value) {\r\n    try {\r\n        if (isObject(value)) {\r\n            return (\"ver\" in value && \"exceptions\" in value && \"properties\" in value);\r\n        }\r\n    }\r\n    catch (e) {\r\n        // This can happen with some native browser objects, but should not happen for the type we are checking for\r\n    }\r\n    return false;\r\n}\r\nfunction _isStackDetails(details) {\r\n    return details && details.src && isString(details.src) && details.obj && isArray(details.obj);\r\n}\r\nfunction _convertStackObj(errorStack) {\r\n    var src = errorStack || \"\";\r\n    if (!isString(src)) {\r\n        if (isString(src[strStack])) {\r\n            src = src[strStack];\r\n        }\r\n        else {\r\n            src = \"\" + src;\r\n        }\r\n    }\r\n    var items = src[_DYN_SPLIT /* @min:%2esplit */](\"\\n\");\r\n    return {\r\n        src: src,\r\n        obj: items\r\n    };\r\n}\r\nfunction _getOperaStack(errorMessage) {\r\n    var stack = [];\r\n    var lines = errorMessage[_DYN_SPLIT /* @min:%2esplit */](\"\\n\");\r\n    for (var lp = 0; lp < lines[_DYN_LENGTH /* @min:%2elength */]; lp++) {\r\n        var entry = lines[lp];\r\n        if (lines[lp + 1]) {\r\n            entry += \"@\" + lines[lp + 1];\r\n            lp++;\r\n        }\r\n        stack[_DYN_PUSH /* @min:%2epush */](entry);\r\n    }\r\n    return {\r\n        src: errorMessage,\r\n        obj: stack\r\n    };\r\n}\r\nfunction _getStackFromErrorObj(errorObj) {\r\n    var details = null;\r\n    if (errorObj) {\r\n        try {\r\n            /* Using bracket notation is support older browsers (IE 7/8 -- dont remember the version) that throw when using dot\r\n            notation for undefined objects and we don't want to loose the error from being reported */\r\n            if (errorObj[strStack]) {\r\n                // Chrome/Firefox\r\n                details = _convertStackObj(errorObj[strStack]);\r\n            }\r\n            else if (errorObj[strError] && errorObj[strError][strStack]) {\r\n                // Edge error event provides the stack and error object\r\n                details = _convertStackObj(errorObj[strError][strStack]);\r\n            }\r\n            else if (errorObj[\"exception\"] && errorObj.exception[strStack]) {\r\n                details = _convertStackObj(errorObj.exception[strStack]);\r\n            }\r\n            else if (_isStackDetails(errorObj)) {\r\n                details = errorObj;\r\n            }\r\n            else if (_isStackDetails(errorObj[strStackDetails])) {\r\n                details = errorObj[strStackDetails];\r\n            }\r\n            else if (getWindow() && getWindow()[\"opera\"] && errorObj[strMessage]) {\r\n                // Opera\r\n                details = _getOperaStack(errorObj[_DYN_MESSAGE /* @min:%2emessage */]);\r\n            }\r\n            else if (errorObj[\"reason\"] && errorObj.reason[strStack]) {\r\n                // UnhandledPromiseRejection\r\n                details = _convertStackObj(errorObj.reason[strStack]);\r\n            }\r\n            else if (isString(errorObj)) {\r\n                details = _convertStackObj(errorObj);\r\n            }\r\n            else {\r\n                var evtMessage = errorObj[strMessage] || errorObj[strDescription] || \"\";\r\n                if (isString(errorObj[strErrorSrc])) {\r\n                    if (evtMessage) {\r\n                        evtMessage += \"\\n\";\r\n                    }\r\n                    evtMessage += \" from \" + errorObj[strErrorSrc];\r\n                }\r\n                if (evtMessage) {\r\n                    details = _convertStackObj(evtMessage);\r\n                }\r\n            }\r\n        }\r\n        catch (e) {\r\n            // something unexpected happened so to avoid failing to report any error lets swallow the exception\r\n            // and fallback to the callee/caller method\r\n            details = _convertStackObj(e);\r\n        }\r\n    }\r\n    return details || {\r\n        src: \"\",\r\n        obj: null\r\n    };\r\n}\r\nfunction _formatStackTrace(stackDetails) {\r\n    var stack = \"\";\r\n    if (stackDetails) {\r\n        if (stackDetails.obj) {\r\n            arrForEach(stackDetails.obj, function (entry) {\r\n                stack += entry + \"\\n\";\r\n            });\r\n        }\r\n        else {\r\n            stack = stackDetails.src || \"\";\r\n        }\r\n    }\r\n    return stack;\r\n}\r\nfunction _parseStack(stack) {\r\n    var parsedStack;\r\n    var frames = stack.obj;\r\n    if (frames && frames[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n        parsedStack = [];\r\n        var level_1 = 0;\r\n        var totalSizeInBytes_1 = 0;\r\n        arrForEach(frames, function (frame) {\r\n            var theFrame = frame[_DYN_TO_STRING /* @min:%2etoString */]();\r\n            if (_StackFrame.regex.test(theFrame)) {\r\n                var parsedFrame = new _StackFrame(theFrame, level_1++);\r\n                totalSizeInBytes_1 += parsedFrame[_DYN_SIZE_IN_BYTES /* @min:%2esizeInBytes */];\r\n                parsedStack[_DYN_PUSH /* @min:%2epush */](parsedFrame);\r\n            }\r\n        });\r\n        // DP Constraint - exception parsed stack must be < 32KB\r\n        // remove frames from the middle to meet the threshold\r\n        var exceptionParsedStackThreshold = 32 * 1024;\r\n        if (totalSizeInBytes_1 > exceptionParsedStackThreshold) {\r\n            var left = 0;\r\n            var right = parsedStack[_DYN_LENGTH /* @min:%2elength */] - 1;\r\n            var size = 0;\r\n            var acceptedLeft = left;\r\n            var acceptedRight = right;\r\n            while (left < right) {\r\n                // check size\r\n                var lSize = parsedStack[left][_DYN_SIZE_IN_BYTES /* @min:%2esizeInBytes */];\r\n                var rSize = parsedStack[right][_DYN_SIZE_IN_BYTES /* @min:%2esizeInBytes */];\r\n                size += lSize + rSize;\r\n                if (size > exceptionParsedStackThreshold) {\r\n                    // remove extra frames from the middle\r\n                    var howMany = acceptedRight - acceptedLeft + 1;\r\n                    parsedStack.splice(acceptedLeft, howMany);\r\n                    break;\r\n                }\r\n                // update pointers\r\n                acceptedLeft = left;\r\n                acceptedRight = right;\r\n                left++;\r\n                right--;\r\n            }\r\n        }\r\n    }\r\n    return parsedStack;\r\n}\r\nfunction _getErrorType(errorType) {\r\n    // Gets the Error Type by passing the constructor (used to get the true type of native error object).\r\n    var typeName = \"\";\r\n    if (errorType) {\r\n        typeName = errorType.typeName || errorType[_DYN_NAME /* @min:%2ename */] || \"\";\r\n        if (!typeName) {\r\n            try {\r\n                var funcNameRegex = /function (.{1,200})\\(/;\r\n                var results = (funcNameRegex).exec((errorType).constructor[_DYN_TO_STRING /* @min:%2etoString */]());\r\n                typeName = (results && results[_DYN_LENGTH /* @min:%2elength */] > 1) ? results[1] : \"\";\r\n            }\r\n            catch (e) {\r\n                // eslint-disable-next-line no-empty -- Ignoring any failures as nothing we can do\r\n            }\r\n        }\r\n    }\r\n    return typeName;\r\n}\r\n/**\r\n * Formats the provided errorObj for display and reporting, it may be a String, Object, integer or undefined depending on the browser.\r\n * @param errorObj - The supplied errorObj\r\n */\r\nexport function _formatErrorCode(errorObj) {\r\n    if (errorObj) {\r\n        try {\r\n            if (!isString(errorObj)) {\r\n                var errorType = _getErrorType(errorObj);\r\n                var result = _stringify(errorObj, false);\r\n                if (!result || result === \"{}\") {\r\n                    if (errorObj[strError]) {\r\n                        // Looks like an MS Error Event\r\n                        errorObj = errorObj[strError];\r\n                        errorType = _getErrorType(errorObj);\r\n                    }\r\n                    result = _stringify(errorObj, true);\r\n                }\r\n                if (strIndexOf(result, errorType) !== 0 && errorType !== \"String\") {\r\n                    return errorType + \":\" + result;\r\n                }\r\n                return result;\r\n            }\r\n        }\r\n        catch (e) {\r\n            // eslint-disable-next-line no-empty -- Ignoring any failures as nothing we can do\r\n        }\r\n    }\r\n    // Fallback to just letting the object format itself into a string\r\n    return \"\" + (errorObj || \"\");\r\n}\r\nvar Exception = /** @class */ (function () {\r\n    /**\r\n     * Constructs a new instance of the ExceptionTelemetry object\r\n     */\r\n    function Exception(logger, exception, properties, measurements, severityLevel, id) {\r\n        this.aiDataContract = {\r\n            ver: 1 /* FieldType.Required */,\r\n            exceptions: 1 /* FieldType.Required */,\r\n            severityLevel: 0 /* FieldType.Default */,\r\n            properties: 0 /* FieldType.Default */,\r\n            measurements: 0 /* FieldType.Default */\r\n        };\r\n        var _self = this;\r\n        _self.ver = 2; // TODO: handle the CS\"4.0\" ==> breeze 2 conversion in a better way\r\n        if (!_isExceptionInternal(exception)) {\r\n            if (!properties) {\r\n                properties = {};\r\n            }\r\n            if (id) {\r\n                properties.id = id;\r\n            }\r\n            _self[_DYN_EXCEPTIONS /* @min:%2eexceptions */] = [new _ExceptionDetails(logger, exception, properties)];\r\n            _self[_DYN_PROPERTIES /* @min:%2eproperties */] = dataSanitizeProperties(logger, properties);\r\n            _self[_DYN_MEASUREMENTS /* @min:%2emeasurements */] = dataSanitizeMeasurements(logger, measurements);\r\n            if (severityLevel) {\r\n                _self[_DYN_SEVERITY_LEVEL /* @min:%2eseverityLevel */] = severityLevel;\r\n            }\r\n            if (id) {\r\n                _self.id = id;\r\n            }\r\n        }\r\n        else {\r\n            _self[_DYN_EXCEPTIONS /* @min:%2eexceptions */] = exception[_DYN_EXCEPTIONS /* @min:%2eexceptions */] || [];\r\n            _self[_DYN_PROPERTIES /* @min:%2eproperties */] = exception[_DYN_PROPERTIES /* @min:%2eproperties */];\r\n            _self[_DYN_MEASUREMENTS /* @min:%2emeasurements */] = exception[_DYN_MEASUREMENTS /* @min:%2emeasurements */];\r\n            if (exception[_DYN_SEVERITY_LEVEL /* @min:%2eseverityLevel */]) {\r\n                _self[_DYN_SEVERITY_LEVEL /* @min:%2eseverityLevel */] = exception[_DYN_SEVERITY_LEVEL /* @min:%2eseverityLevel */];\r\n            }\r\n            if (exception.id) {\r\n                _self.id = exception.id;\r\n                exception[_DYN_PROPERTIES /* @min:%2eproperties */].id = exception.id;\r\n            }\r\n            if (exception[_DYN_PROBLEM_GROUP /* @min:%2eproblemGroup */]) {\r\n                _self[_DYN_PROBLEM_GROUP /* @min:%2eproblemGroup */] = exception[_DYN_PROBLEM_GROUP /* @min:%2eproblemGroup */];\r\n            }\r\n            // bool/int types, use isNullOrUndefined\r\n            if (!isNullOrUndefined(exception[_DYN_IS_MANUAL /* @min:%2eisManual */])) {\r\n                _self[_DYN_IS_MANUAL /* @min:%2eisManual */] = exception[_DYN_IS_MANUAL /* @min:%2eisManual */];\r\n            }\r\n        }\r\n    }\r\n    Exception.CreateAutoException = function (message, url, lineNumber, columnNumber, error, evt, stack, errorSrc) {\r\n        var _a;\r\n        var errorType = _getErrorType(error || evt || message);\r\n        return _a = {},\r\n            _a[_DYN_MESSAGE /* @min:message */] = _formatMessage(message, errorType),\r\n            _a.url = url,\r\n            _a.lineNumber = lineNumber,\r\n            _a.columnNumber = columnNumber,\r\n            _a.error = _formatErrorCode(error || evt || message),\r\n            _a.evt = _formatErrorCode(evt || message),\r\n            _a[_DYN_TYPE_NAME /* @min:typeName */] = errorType,\r\n            _a.stackDetails = _getStackFromErrorObj(stack || error || evt),\r\n            _a.errorSrc = errorSrc,\r\n            _a;\r\n    };\r\n    Exception.CreateFromInterface = function (logger, exception, properties, measurements) {\r\n        var exceptions = exception[_DYN_EXCEPTIONS /* @min:%2eexceptions */]\r\n            && arrMap(exception[_DYN_EXCEPTIONS /* @min:%2eexceptions */], function (ex) { return _ExceptionDetails[_DYN__CREATE_FROM_INTERFA1 /* @min:%2eCreateFromInterface */](logger, ex); });\r\n        var exceptionData = new Exception(logger, __assign(__assign({}, exception), { exceptions: exceptions }), properties, measurements);\r\n        return exceptionData;\r\n    };\r\n    Exception.prototype.toInterface = function () {\r\n        var _a;\r\n        var _b = this, exceptions = _b.exceptions, properties = _b.properties, measurements = _b.measurements, severityLevel = _b.severityLevel, problemGroup = _b.problemGroup, id = _b.id, isManual = _b.isManual;\r\n        var exceptionDetailsInterface = exceptions instanceof Array\r\n            && arrMap(exceptions, function (exception) { return exception.toInterface(); })\r\n            || undefined;\r\n        return _a = {\r\n                ver: \"4.0\"\r\n            },\r\n            _a[_DYN_EXCEPTIONS /* @min:exceptions */] = exceptionDetailsInterface,\r\n            _a.severityLevel = severityLevel,\r\n            _a.properties = properties,\r\n            _a.measurements = measurements,\r\n            _a.problemGroup = problemGroup,\r\n            _a.id = id,\r\n            _a.isManual = isManual,\r\n            _a;\r\n    };\r\n    /**\r\n     * Creates a simple exception with 1 stack frame. Useful for manual constracting of exception.\r\n     */\r\n    Exception.CreateSimpleException = function (message, typeName, assembly, fileName, details, line) {\r\n        var _a;\r\n        return {\r\n            exceptions: [\r\n                (_a = {},\r\n                    _a[_DYN_HAS_FULL_STACK /* @min:hasFullStack */] = true,\r\n                    _a.message = message,\r\n                    _a.stack = details,\r\n                    _a.typeName = typeName,\r\n                    _a)\r\n            ]\r\n        };\r\n    };\r\n    Exception.envelopeType = \"Microsoft.ApplicationInsights.{0}.Exception\";\r\n    Exception.dataType = \"ExceptionData\";\r\n    Exception.formatError = _formatErrorCode;\r\n    return Exception;\r\n}());\r\nexport { Exception };\r\nvar _ExceptionDetails = /** @class */ (function () {\r\n    function _ExceptionDetails(logger, exception, properties) {\r\n        this.aiDataContract = {\r\n            id: 0 /* FieldType.Default */,\r\n            outerId: 0 /* FieldType.Default */,\r\n            typeName: 1 /* FieldType.Required */,\r\n            message: 1 /* FieldType.Required */,\r\n            hasFullStack: 0 /* FieldType.Default */,\r\n            stack: 0 /* FieldType.Default */,\r\n            parsedStack: 2 /* FieldType.Array */\r\n        };\r\n        var _self = this;\r\n        if (!_isExceptionDetailsInternal(exception)) {\r\n            var error = exception;\r\n            var evt = error && error.evt;\r\n            if (!isError(error)) {\r\n                error = error[strError] || evt || error;\r\n            }\r\n            _self[_DYN_TYPE_NAME /* @min:%2etypeName */] = dataSanitizeString(logger, _getErrorType(error)) || strNotSpecified;\r\n            _self[_DYN_MESSAGE /* @min:%2emessage */] = dataSanitizeMessage(logger, _formatMessage(exception || error, _self[_DYN_TYPE_NAME /* @min:%2etypeName */])) || strNotSpecified;\r\n            var stack = exception[strStackDetails] || _getStackFromErrorObj(exception);\r\n            _self[_DYN_PARSED_STACK /* @min:%2eparsedStack */] = _parseStack(stack);\r\n            // after parsedStack is inited, iterate over each frame object, sanitize its assembly field\r\n            if (isArray(_self[_DYN_PARSED_STACK /* @min:%2eparsedStack */])) {\r\n                arrMap(_self[_DYN_PARSED_STACK /* @min:%2eparsedStack */], function (frame) {\r\n                    frame[_DYN_ASSEMBLY /* @min:%2eassembly */] = dataSanitizeString(logger, frame[_DYN_ASSEMBLY /* @min:%2eassembly */]);\r\n                    frame[_DYN_FILE_NAME /* @min:%2efileName */] = dataSanitizeString(logger, frame[_DYN_FILE_NAME /* @min:%2efileName */]);\r\n                });\r\n            }\r\n            _self[strStack] = dataSanitizeException(logger, _formatStackTrace(stack));\r\n            _self.hasFullStack = isArray(_self.parsedStack) && _self.parsedStack[_DYN_LENGTH /* @min:%2elength */] > 0;\r\n            if (properties) {\r\n                properties[_DYN_TYPE_NAME /* @min:%2etypeName */] = properties[_DYN_TYPE_NAME /* @min:%2etypeName */] || _self[_DYN_TYPE_NAME /* @min:%2etypeName */];\r\n            }\r\n        }\r\n        else {\r\n            _self[_DYN_TYPE_NAME /* @min:%2etypeName */] = exception[_DYN_TYPE_NAME /* @min:%2etypeName */];\r\n            _self[_DYN_MESSAGE /* @min:%2emessage */] = exception[_DYN_MESSAGE /* @min:%2emessage */];\r\n            _self[strStack] = exception[strStack];\r\n            _self[_DYN_PARSED_STACK /* @min:%2eparsedStack */] = exception[_DYN_PARSED_STACK /* @min:%2eparsedStack */] || [];\r\n            _self[_DYN_HAS_FULL_STACK /* @min:%2ehasFullStack */] = exception[_DYN_HAS_FULL_STACK /* @min:%2ehasFullStack */];\r\n        }\r\n    }\r\n    _ExceptionDetails.prototype.toInterface = function () {\r\n        var _a;\r\n        var _self = this;\r\n        var parsedStack = _self[_DYN_PARSED_STACK /* @min:%2eparsedStack */] instanceof Array\r\n            && arrMap(_self[_DYN_PARSED_STACK /* @min:%2eparsedStack */], function (frame) { return frame.toInterface(); });\r\n        var exceptionDetailsInterface = (_a = {\r\n                id: _self.id,\r\n                outerId: _self.outerId,\r\n                typeName: _self[_DYN_TYPE_NAME /* @min:%2etypeName */],\r\n                message: _self[_DYN_MESSAGE /* @min:%2emessage */],\r\n                hasFullStack: _self[_DYN_HAS_FULL_STACK /* @min:%2ehasFullStack */],\r\n                stack: _self[strStack]\r\n            },\r\n            _a[_DYN_PARSED_STACK /* @min:parsedStack */] = parsedStack || undefined,\r\n            _a);\r\n        return exceptionDetailsInterface;\r\n    };\r\n    _ExceptionDetails.CreateFromInterface = function (logger, exception) {\r\n        var parsedStack = (exception[_DYN_PARSED_STACK /* @min:%2eparsedStack */] instanceof Array\r\n            && arrMap(exception[_DYN_PARSED_STACK /* @min:%2eparsedStack */], function (frame) { return _StackFrame[_DYN__CREATE_FROM_INTERFA1 /* @min:%2eCreateFromInterface */](frame); }))\r\n            || exception[_DYN_PARSED_STACK /* @min:%2eparsedStack */];\r\n        var exceptionDetails = new _ExceptionDetails(logger, __assign(__assign({}, exception), { parsedStack: parsedStack }));\r\n        return exceptionDetails;\r\n    };\r\n    return _ExceptionDetails;\r\n}());\r\nexport { _ExceptionDetails };\r\nvar _StackFrame = /** @class */ (function () {\r\n    function _StackFrame(sourceFrame, level) {\r\n        this.aiDataContract = {\r\n            level: 1 /* FieldType.Required */,\r\n            method: 1 /* FieldType.Required */,\r\n            assembly: 0 /* FieldType.Default */,\r\n            fileName: 0 /* FieldType.Default */,\r\n            line: 0 /* FieldType.Default */\r\n        };\r\n        var _self = this;\r\n        _self[_DYN_SIZE_IN_BYTES /* @min:%2esizeInBytes */] = 0;\r\n        // Not converting this to isString() as typescript uses this logic to \"understand\" the different\r\n        // types for the 2 different code paths\r\n        if (typeof sourceFrame === \"string\") {\r\n            var frame = sourceFrame;\r\n            _self[_DYN_LEVEL /* @min:%2elevel */] = level;\r\n            _self[_DYN_METHOD /* @min:%2emethod */] = NoMethod;\r\n            _self[_DYN_ASSEMBLY /* @min:%2eassembly */] = strTrim(frame);\r\n            _self[_DYN_FILE_NAME /* @min:%2efileName */] = \"\";\r\n            _self[_DYN_LINE /* @min:%2eline */] = 0;\r\n            var matches = frame.match(_StackFrame.regex);\r\n            if (matches && matches[_DYN_LENGTH /* @min:%2elength */] >= 5) {\r\n                _self[_DYN_METHOD /* @min:%2emethod */] = strTrim(matches[2]) || _self[_DYN_METHOD /* @min:%2emethod */];\r\n                _self[_DYN_FILE_NAME /* @min:%2efileName */] = strTrim(matches[4]);\r\n                _self[_DYN_LINE /* @min:%2eline */] = parseInt(matches[5]) || 0;\r\n            }\r\n        }\r\n        else {\r\n            _self[_DYN_LEVEL /* @min:%2elevel */] = sourceFrame[_DYN_LEVEL /* @min:%2elevel */];\r\n            _self[_DYN_METHOD /* @min:%2emethod */] = sourceFrame[_DYN_METHOD /* @min:%2emethod */];\r\n            _self[_DYN_ASSEMBLY /* @min:%2eassembly */] = sourceFrame[_DYN_ASSEMBLY /* @min:%2eassembly */];\r\n            _self[_DYN_FILE_NAME /* @min:%2efileName */] = sourceFrame[_DYN_FILE_NAME /* @min:%2efileName */];\r\n            _self[_DYN_LINE /* @min:%2eline */] = sourceFrame[_DYN_LINE /* @min:%2eline */];\r\n            _self[_DYN_SIZE_IN_BYTES /* @min:%2esizeInBytes */] = 0;\r\n        }\r\n        _self.sizeInBytes += _self.method[_DYN_LENGTH /* @min:%2elength */];\r\n        _self.sizeInBytes += _self.fileName[_DYN_LENGTH /* @min:%2elength */];\r\n        _self.sizeInBytes += _self.assembly[_DYN_LENGTH /* @min:%2elength */];\r\n        // todo: these might need to be removed depending on how the back-end settles on their size calculation\r\n        _self[_DYN_SIZE_IN_BYTES /* @min:%2esizeInBytes */] += _StackFrame.baseSize;\r\n        _self.sizeInBytes += _self.level.toString()[_DYN_LENGTH /* @min:%2elength */];\r\n        _self.sizeInBytes += _self.line.toString()[_DYN_LENGTH /* @min:%2elength */];\r\n    }\r\n    _StackFrame.CreateFromInterface = function (frame) {\r\n        return new _StackFrame(frame, null /* level is available in frame interface */);\r\n    };\r\n    _StackFrame.prototype.toInterface = function () {\r\n        var _self = this;\r\n        return {\r\n            level: _self[_DYN_LEVEL /* @min:%2elevel */],\r\n            method: _self[_DYN_METHOD /* @min:%2emethod */],\r\n            assembly: _self[_DYN_ASSEMBLY /* @min:%2eassembly */],\r\n            fileName: _self[_DYN_FILE_NAME /* @min:%2efileName */],\r\n            line: _self[_DYN_LINE /* @min:%2eline */]\r\n        };\r\n    };\r\n    // regex to match stack frames from ie/chrome/ff\r\n    // methodName=$2, fileName=$4, lineNo=$5, column=$6\r\n    _StackFrame.regex = /^([\\s]+at)?[\\s]{0,50}([^\\@\\()]+?)[\\s]{0,50}(\\@|\\()([^\\(\\n]+):([0-9]+):([0-9]+)(\\)?)$/;\r\n    _StackFrame.baseSize = 58; // '{\"method\":\"\",\"level\":,\"assembly\":\"\",\"fileName\":\"\",\"line\":}'.length\r\n    return _StackFrame;\r\n}());\r\nexport { _StackFrame };\r\n//# sourceMappingURL=Exception.js.map","/*\n * Application Insights JavaScript SDK - Common, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nvar DataPoint = /** @class */ (function () {\r\n    function DataPoint() {\r\n        /**\r\n         * The data contract for serializing this object.\r\n         */\r\n        this.aiDataContract = {\r\n            name: 1 /* FieldType.Required */,\r\n            kind: 0 /* FieldType.Default */,\r\n            value: 1 /* FieldType.Required */,\r\n            count: 0 /* FieldType.Default */,\r\n            min: 0 /* FieldType.Default */,\r\n            max: 0 /* FieldType.Default */,\r\n            stdDev: 0 /* FieldType.Default */\r\n        };\r\n        /**\r\n         * Metric type. Single measurement or the aggregated value.\r\n         */\r\n        this.kind = 0 /* DataPointType.Measurement */;\r\n    }\r\n    return DataPoint;\r\n}());\r\nexport { DataPoint };\r\n//# sourceMappingURL=DataPoint.js.map","/*\n * Application Insights JavaScript SDK - Common, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { strNotSpecified } from \"../Constants\";\r\nimport { _DYN_COUNT, _DYN_MEASUREMENTS, _DYN_NAME, _DYN_PROPERTIES } from \"../__DynamicConstants\";\r\nimport { DataPoint } from \"./Common/DataPoint\";\r\nimport { dataSanitizeMeasurements, dataSanitizeProperties, dataSanitizeString } from \"./Common/DataSanitizer\";\r\nvar Metric = /** @class */ (function () {\r\n    /**\r\n     * Constructs a new instance of the MetricTelemetry object\r\n     */\r\n    function Metric(logger, name, value, count, min, max, stdDev, properties, measurements) {\r\n        this.aiDataContract = {\r\n            ver: 1 /* FieldType.Required */,\r\n            metrics: 1 /* FieldType.Required */,\r\n            properties: 0 /* FieldType.Default */\r\n        };\r\n        var _self = this;\r\n        _self.ver = 2;\r\n        var dataPoint = new DataPoint();\r\n        dataPoint[_DYN_COUNT /* @min:%2ecount */] = count > 0 ? count : undefined;\r\n        dataPoint.max = isNaN(max) || max === null ? undefined : max;\r\n        dataPoint.min = isNaN(min) || min === null ? undefined : min;\r\n        dataPoint[_DYN_NAME /* @min:%2ename */] = dataSanitizeString(logger, name) || strNotSpecified;\r\n        dataPoint.value = value;\r\n        dataPoint.stdDev = isNaN(stdDev) || stdDev === null ? undefined : stdDev;\r\n        _self.metrics = [dataPoint];\r\n        _self[_DYN_PROPERTIES /* @min:%2eproperties */] = dataSanitizeProperties(logger, properties);\r\n        _self[_DYN_MEASUREMENTS /* @min:%2emeasurements */] = dataSanitizeMeasurements(logger, measurements);\r\n    }\r\n    Metric.envelopeType = \"Microsoft.ApplicationInsights.{0}.Metric\";\r\n    Metric.dataType = \"MetricData\";\r\n    return Metric;\r\n}());\r\nexport { Metric };\r\n//# sourceMappingURL=Metric.js.map","/*\n * Application Insights JavaScript SDK - Common, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { getDocument, isString } from \"@microsoft/applicationinsights-core-js\";\r\nimport { _DYN_LENGTH, _DYN_PATHNAME, _DYN_TO_LOWER_CASE } from \"./__DynamicConstants\";\r\nvar _document = getDocument() || {};\r\nvar _htmlAnchorIdx = 0;\r\n// Use an array of temporary values as it's possible for multiple calls to parseUrl() will be called with different URLs\r\n// Using a cache size of 5 for now as it current depth usage is at least 2, so adding a minor buffer to handle future updates\r\nvar _htmlAnchorElement = [null, null, null, null, null];\r\nexport function urlParseUrl(url) {\r\n    var anchorIdx = _htmlAnchorIdx;\r\n    var anchorCache = _htmlAnchorElement;\r\n    var tempAnchor = anchorCache[anchorIdx];\r\n    if (!_document.createElement) {\r\n        // Always create the temp instance if createElement is not available\r\n        tempAnchor = { host: urlParseHost(url, true) };\r\n    }\r\n    else if (!anchorCache[anchorIdx]) {\r\n        // Create and cache the unattached anchor instance\r\n        tempAnchor = anchorCache[anchorIdx] = _document.createElement(\"a\");\r\n    }\r\n    tempAnchor.href = url;\r\n    // Move the cache index forward\r\n    anchorIdx++;\r\n    if (anchorIdx >= anchorCache[_DYN_LENGTH /* @min:%2elength */]) {\r\n        anchorIdx = 0;\r\n    }\r\n    _htmlAnchorIdx = anchorIdx;\r\n    return tempAnchor;\r\n}\r\nexport function urlGetAbsoluteUrl(url) {\r\n    var result;\r\n    var a = urlParseUrl(url);\r\n    if (a) {\r\n        result = a.href;\r\n    }\r\n    return result;\r\n}\r\nexport function urlGetPathName(url) {\r\n    var result;\r\n    var a = urlParseUrl(url);\r\n    if (a) {\r\n        result = a[_DYN_PATHNAME /* @min:%2epathname */];\r\n    }\r\n    return result;\r\n}\r\nexport function urlGetCompleteUrl(method, absoluteUrl) {\r\n    if (method) {\r\n        return method.toUpperCase() + \" \" + absoluteUrl;\r\n    }\r\n    return absoluteUrl;\r\n}\r\n// Fallback method to grab host from url if document.createElement method is not available\r\nexport function urlParseHost(url, inclPort) {\r\n    var fullHost = urlParseFullHost(url, inclPort) || \"\";\r\n    if (fullHost) {\r\n        var match = fullHost.match(/(www\\d{0,5}\\.)?([^\\/:]{1,256})(:\\d{1,20})?/i);\r\n        if (match != null && match[_DYN_LENGTH /* @min:%2elength */] > 3 && isString(match[2]) && match[2][_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n            return match[2] + (match[3] || \"\");\r\n        }\r\n    }\r\n    return fullHost;\r\n}\r\nexport function urlParseFullHost(url, inclPort) {\r\n    var result = null;\r\n    if (url) {\r\n        var match = url.match(/(\\w{1,150}):\\/\\/([^\\/:]{1,256})(:\\d{1,20})?/i);\r\n        if (match != null && match[_DYN_LENGTH /* @min:%2elength */] > 2 && isString(match[2]) && match[2][_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n            result = match[2] || \"\";\r\n            if (inclPort && match[_DYN_LENGTH /* @min:%2elength */] > 2) {\r\n                var protocol = (match[1] || \"\")[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */]();\r\n                var port = match[3] || \"\";\r\n                // IE includes the standard port so pass it off if it's the same as the protocol\r\n                if (protocol === \"http\" && port === \":80\") {\r\n                    port = \"\";\r\n                }\r\n                else if (protocol === \"https\" && port === \":443\") {\r\n                    port = \"\";\r\n                }\r\n                result += port;\r\n            }\r\n        }\r\n    }\r\n    return result;\r\n}\r\n//# sourceMappingURL=UrlHelperFuncs.js.map","/*\n * Application Insights JavaScript SDK - Common, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { arrForEach, arrIndexOf, dateNow, getPerformance, isNullOrUndefined, isValidSpanId, isValidTraceId } from \"@microsoft/applicationinsights-core-js\";\r\nimport { strIndexOf } from \"@nevware21/ts-utils\";\r\nimport { DEFAULT_BREEZE_ENDPOINT, DEFAULT_BREEZE_PATH } from \"./Constants\";\r\nimport { RequestHeaders } from \"./RequestResponseHeaders\";\r\nimport { dataSanitizeString } from \"./Telemetry/Common/DataSanitizer\";\r\nimport { urlParseFullHost, urlParseUrl } from \"./UrlHelperFuncs\";\r\nimport { _DYN_CORRELATION_HEADER_E0, _DYN_LENGTH, _DYN_NAME, _DYN_PATHNAME, _DYN_SPLIT, _DYN_TO_LOWER_CASE } from \"./__DynamicConstants\";\r\n// listing only non-geo specific locations\r\nvar _internalEndpoints = [\r\n    DEFAULT_BREEZE_ENDPOINT + DEFAULT_BREEZE_PATH,\r\n    \"https://breeze.aimon.applicationinsights.io\" + DEFAULT_BREEZE_PATH,\r\n    \"https://dc-int.services.visualstudio.com\" + DEFAULT_BREEZE_PATH\r\n];\r\nvar _correlationIdPrefix = \"cid-v1:\";\r\nexport function isInternalApplicationInsightsEndpoint(endpointUrl) {\r\n    return arrIndexOf(_internalEndpoints, endpointUrl[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */]()) !== -1;\r\n}\r\nexport function correlationIdSetPrefix(prefix) {\r\n    _correlationIdPrefix = prefix;\r\n}\r\nexport function correlationIdGetPrefix() {\r\n    return _correlationIdPrefix;\r\n}\r\n/**\r\n * Checks if a request url is not on a excluded domain list and if it is safe to add correlation headers.\r\n * Headers are always included if the current domain matches the request domain. If they do not match (CORS),\r\n * they are regex-ed across correlationHeaderDomains and correlationHeaderExcludedDomains to determine if headers are included.\r\n * Some environments don't give information on currentHost via window.location.host (e.g. Cordova). In these cases, the user must\r\n * manually supply domains to include correlation headers on. Else, no headers will be included at all.\r\n */\r\nexport function correlationIdCanIncludeCorrelationHeader(config, requestUrl, currentHost) {\r\n    if (!requestUrl || (config && config.disableCorrelationHeaders)) {\r\n        return false;\r\n    }\r\n    if (config && config[_DYN_CORRELATION_HEADER_E0 /* @min:%2ecorrelationHeaderExcludePatterns */]) {\r\n        for (var i = 0; i < config.correlationHeaderExcludePatterns[_DYN_LENGTH /* @min:%2elength */]; i++) {\r\n            if (config[_DYN_CORRELATION_HEADER_E0 /* @min:%2ecorrelationHeaderExcludePatterns */][i].test(requestUrl)) {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    var requestHost = urlParseUrl(requestUrl).host[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */]();\r\n    if (requestHost && (strIndexOf(requestHost, \":443\") !== -1 || strIndexOf(requestHost, \":80\") !== -1)) {\r\n        // [Bug #1260] IE can include the port even for http and https URLs so if present\r\n        // try and parse it to remove if it matches the default protocol port\r\n        requestHost = (urlParseFullHost(requestUrl, true) || \"\")[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */]();\r\n    }\r\n    if ((!config || !config.enableCorsCorrelation) && (requestHost && requestHost !== currentHost)) {\r\n        return false;\r\n    }\r\n    var includedDomains = config && config.correlationHeaderDomains;\r\n    if (includedDomains) {\r\n        var matchExists_1;\r\n        arrForEach(includedDomains, function (domain) {\r\n            var regex = new RegExp(domain.toLowerCase().replace(/\\\\/g, \"\\\\\\\\\").replace(/\\./g, \"\\\\.\").replace(/\\*/g, \".*\"));\r\n            matchExists_1 = matchExists_1 || regex.test(requestHost);\r\n        });\r\n        if (!matchExists_1) {\r\n            return false;\r\n        }\r\n    }\r\n    var excludedDomains = config && config.correlationHeaderExcludedDomains;\r\n    if (!excludedDomains || excludedDomains[_DYN_LENGTH /* @min:%2elength */] === 0) {\r\n        return true;\r\n    }\r\n    for (var i = 0; i < excludedDomains[_DYN_LENGTH /* @min:%2elength */]; i++) {\r\n        var regex = new RegExp(excludedDomains[i].toLowerCase().replace(/\\\\/g, \"\\\\\\\\\").replace(/\\./g, \"\\\\.\").replace(/\\*/g, \".*\"));\r\n        if (regex.test(requestHost)) {\r\n            return false;\r\n        }\r\n    }\r\n    // if we don't know anything about the requestHost, require the user to use included/excludedDomains.\r\n    // Previously we always returned false for a falsy requestHost\r\n    return requestHost && requestHost[_DYN_LENGTH /* @min:%2elength */] > 0;\r\n}\r\n/**\r\n * Combines target appId and target role name from response header.\r\n */\r\nexport function correlationIdGetCorrelationContext(responseHeader) {\r\n    if (responseHeader) {\r\n        var correlationId = correlationIdGetCorrelationContextValue(responseHeader, RequestHeaders[1 /* eRequestHeaders.requestContextTargetKey */]);\r\n        if (correlationId && correlationId !== _correlationIdPrefix) {\r\n            return correlationId;\r\n        }\r\n    }\r\n}\r\n/**\r\n * Gets key from correlation response header\r\n */\r\nexport function correlationIdGetCorrelationContextValue(responseHeader, key) {\r\n    if (responseHeader) {\r\n        var keyValues = responseHeader[_DYN_SPLIT /* @min:%2esplit */](\",\");\r\n        for (var i = 0; i < keyValues[_DYN_LENGTH /* @min:%2elength */]; ++i) {\r\n            var keyValue = keyValues[i][_DYN_SPLIT /* @min:%2esplit */](\"=\");\r\n            if (keyValue[_DYN_LENGTH /* @min:%2elength */] === 2 && keyValue[0] === key) {\r\n                return keyValue[1];\r\n            }\r\n        }\r\n    }\r\n}\r\nexport function AjaxHelperParseDependencyPath(logger, absoluteUrl, method, commandName) {\r\n    var target, name = commandName, data = commandName;\r\n    if (absoluteUrl && absoluteUrl[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n        var parsedUrl = urlParseUrl(absoluteUrl);\r\n        target = parsedUrl.host;\r\n        if (!name) {\r\n            if (parsedUrl[_DYN_PATHNAME /* @min:%2epathname */] != null) {\r\n                var pathName = (parsedUrl.pathname[_DYN_LENGTH /* @min:%2elength */] === 0) ? \"/\" : parsedUrl[_DYN_PATHNAME /* @min:%2epathname */];\r\n                if (pathName.charAt(0) !== \"/\") {\r\n                    pathName = \"/\" + pathName;\r\n                }\r\n                data = parsedUrl[_DYN_PATHNAME /* @min:%2epathname */];\r\n                name = dataSanitizeString(logger, method ? method + \" \" + pathName : pathName);\r\n            }\r\n            else {\r\n                name = dataSanitizeString(logger, absoluteUrl);\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        target = commandName;\r\n        name = commandName;\r\n    }\r\n    return {\r\n        target: target,\r\n        name: name,\r\n        data: data\r\n    };\r\n}\r\nexport function dateTimeUtilsNow() {\r\n    // returns the window or webworker performance object\r\n    var perf = getPerformance();\r\n    if (perf && perf.now && perf.timing) {\r\n        var now = perf.now() + perf.timing.navigationStart;\r\n        // Known issue with IE where this calculation can be negative, so if it is then ignore and fallback\r\n        if (now > 0) {\r\n            return now;\r\n        }\r\n    }\r\n    return dateNow();\r\n}\r\nexport function dateTimeUtilsDuration(start, end) {\r\n    var result = null;\r\n    if (start !== 0 && end !== 0 && !isNullOrUndefined(start) && !isNullOrUndefined(end)) {\r\n        result = end - start;\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * Creates a IDistributedTraceContext from an optional telemetryTrace\r\n * @param telemetryTrace - The telemetryTrace instance that is being wrapped\r\n * @param parentCtx - An optional parent distributed trace instance, almost always undefined as this scenario is only used in the case of multiple property handlers.\r\n * @returns A new IDistributedTraceContext instance that is backed by the telemetryTrace or temporary object\r\n */\r\nexport function createDistributedTraceContextFromTrace(telemetryTrace, parentCtx) {\r\n    var trace = telemetryTrace || {};\r\n    return {\r\n        getName: function () {\r\n            return trace[_DYN_NAME /* @min:%2ename */];\r\n        },\r\n        setName: function (newValue) {\r\n            parentCtx && parentCtx.setName(newValue);\r\n            trace[_DYN_NAME /* @min:%2ename */] = newValue;\r\n        },\r\n        getTraceId: function () {\r\n            return trace.traceID;\r\n        },\r\n        setTraceId: function (newValue) {\r\n            parentCtx && parentCtx.setTraceId(newValue);\r\n            if (isValidTraceId(newValue)) {\r\n                trace.traceID = newValue;\r\n            }\r\n        },\r\n        getSpanId: function () {\r\n            return trace.parentID;\r\n        },\r\n        setSpanId: function (newValue) {\r\n            parentCtx && parentCtx.setSpanId(newValue);\r\n            if (isValidSpanId(newValue)) {\r\n                trace.parentID = newValue;\r\n            }\r\n        },\r\n        getTraceFlags: function () {\r\n            return trace.traceFlags;\r\n        },\r\n        setTraceFlags: function (newTraceFlags) {\r\n            parentCtx && parentCtx.setTraceFlags(newTraceFlags);\r\n            trace.traceFlags = newTraceFlags;\r\n        }\r\n    };\r\n}\r\n//# sourceMappingURL=Util.js.map","/*\n * Application Insights JavaScript SDK - Common, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { msToTimeSpan } from \"../HelperFuncs\";\r\nimport { AjaxHelperParseDependencyPath } from \"../Util\";\r\nimport { _DYN_DURATION, _DYN_MEASUREMENTS, _DYN_NAME, _DYN_PROPERTIES } from \"../__DynamicConstants\";\r\nimport { dataSanitizeMeasurements, dataSanitizeProperties, dataSanitizeString, dataSanitizeUrl } from \"./Common/DataSanitizer\";\r\nvar RemoteDependencyData = /** @class */ (function () {\r\n    /**\r\n     * Constructs a new instance of the RemoteDependencyData object\r\n     */\r\n    function RemoteDependencyData(logger, id, absoluteUrl, commandName, value, success, resultCode, method, requestAPI, correlationContext, properties, measurements) {\r\n        if (requestAPI === void 0) { requestAPI = \"Ajax\"; }\r\n        this.aiDataContract = {\r\n            id: 1 /* FieldType.Required */,\r\n            ver: 1 /* FieldType.Required */,\r\n            name: 0 /* FieldType.Default */,\r\n            resultCode: 0 /* FieldType.Default */,\r\n            duration: 0 /* FieldType.Default */,\r\n            success: 0 /* FieldType.Default */,\r\n            data: 0 /* FieldType.Default */,\r\n            target: 0 /* FieldType.Default */,\r\n            type: 0 /* FieldType.Default */,\r\n            properties: 0 /* FieldType.Default */,\r\n            measurements: 0 /* FieldType.Default */,\r\n            kind: 0 /* FieldType.Default */,\r\n            value: 0 /* FieldType.Default */,\r\n            count: 0 /* FieldType.Default */,\r\n            min: 0 /* FieldType.Default */,\r\n            max: 0 /* FieldType.Default */,\r\n            stdDev: 0 /* FieldType.Default */,\r\n            dependencyKind: 0 /* FieldType.Default */,\r\n            dependencySource: 0 /* FieldType.Default */,\r\n            commandName: 0 /* FieldType.Default */,\r\n            dependencyTypeName: 0 /* FieldType.Default */\r\n        };\r\n        var _self = this;\r\n        _self.ver = 2;\r\n        _self.id = id;\r\n        _self[_DYN_DURATION /* @min:%2eduration */] = msToTimeSpan(value);\r\n        _self.success = success;\r\n        _self.resultCode = resultCode + \"\";\r\n        _self.type = dataSanitizeString(logger, requestAPI);\r\n        var dependencyFields = AjaxHelperParseDependencyPath(logger, absoluteUrl, method, commandName);\r\n        _self.data = dataSanitizeUrl(logger, commandName) || dependencyFields.data; // get a value from hosturl if commandName not available\r\n        _self.target = dataSanitizeString(logger, dependencyFields.target);\r\n        if (correlationContext) {\r\n            _self.target = \"\".concat(_self.target, \" | \").concat(correlationContext);\r\n        }\r\n        _self[_DYN_NAME /* @min:%2ename */] = dataSanitizeString(logger, dependencyFields[_DYN_NAME /* @min:%2ename */]);\r\n        _self[_DYN_PROPERTIES /* @min:%2eproperties */] = dataSanitizeProperties(logger, properties);\r\n        _self[_DYN_MEASUREMENTS /* @min:%2emeasurements */] = dataSanitizeMeasurements(logger, measurements);\r\n    }\r\n    RemoteDependencyData.envelopeType = \"Microsoft.ApplicationInsights.{0}.RemoteDependency\";\r\n    RemoteDependencyData.dataType = \"RemoteDependencyData\";\r\n    return RemoteDependencyData;\r\n}());\r\nexport { RemoteDependencyData };\r\n//# sourceMappingURL=RemoteDependencyData.js.map","/*\n * Application Insights JavaScript SDK - Common, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\nimport { arrForEach, createUniqueNamespace, eventOff, eventOn, getDocument, getNavigator, getWindow, isNullOrUndefined, isUndefined, mergeEvtNamespace } from \"@microsoft/applicationinsights-core-js\";\r\nimport { _DYN_PUSH } from \"./__DynamicConstants\";\r\nfunction _disableEvents(target, evtNamespace) {\r\n    eventOff(target, null, null, evtNamespace);\r\n}\r\n/**\r\n * Create a new OfflineListener instance to monitor browser online / offline events\r\n * @param parentEvtNamespace - The parent event namespace to append to any specific events for this instance\r\n */\r\nexport function createOfflineListener(parentEvtNamespace) {\r\n    var _document = getDocument();\r\n    var _navigator = getNavigator(); // Gets the window.navigator or workerNavigator depending on the global\r\n    var _isListening = false;\r\n    var listenerList = [];\r\n    // Set the initial state\r\n    // rState is changed by the browser, both via events and when we check the navigator.onLine property\r\n    var rState = 1 /* eOfflineValue.Online */;\r\n    if (_navigator && !isNullOrUndefined(_navigator.onLine) && !_navigator.onLine) { // navigator.onLine is undefined in react-native\r\n        rState = 2 /* eOfflineValue.Offline */;\r\n    }\r\n    // ustate is changed by the user calling setOnlineState\r\n    var uState = 0 /* eOfflineValue.Unknown */;\r\n    // current state would be updated each time rState or uState is changed\r\n    // it is a resolved value of rState and uState\r\n    var _currentState = calCurrentState();\r\n    var _evtNamespace = mergeEvtNamespace(createUniqueNamespace(\"OfflineListener\"), parentEvtNamespace);\r\n    try {\r\n        if (_enableEvents(getWindow())) {\r\n            _isListening = true;\r\n        }\r\n        if (_document) {\r\n            // Also attach to the document.body or document\r\n            var target = _document.body || _document;\r\n            if (target.ononline) {\r\n                if (_enableEvents(target)) {\r\n                    _isListening = true;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    catch (e) {\r\n        // this makes react-native less angry\r\n        _isListening = false;\r\n    }\r\n    function _enableEvents(target) {\r\n        var enabled = false;\r\n        if (target) {\r\n            enabled = eventOn(target, \"online\", _setOnline, _evtNamespace);\r\n            if (enabled) {\r\n                eventOn(target, \"offline\", _setOffline, _evtNamespace);\r\n            }\r\n        }\r\n        return enabled;\r\n    }\r\n    function _isOnline() {\r\n        return _currentState;\r\n    }\r\n    function calCurrentState() {\r\n        if (uState === 2 /* eOfflineValue.Offline */ || rState === 2 /* eOfflineValue.Offline */) {\r\n            return false;\r\n        }\r\n        return true; // if both unknown, then we assume the network is good\r\n    }\r\n    function listnerNoticeCheck() {\r\n        // we were offline and are now online or we were online and now offline\r\n        var newState = calCurrentState();\r\n        if (_currentState !== newState) {\r\n            _currentState = newState; // use the resolved state to update\r\n            // send all the callbacks with the current state\r\n            arrForEach(listenerList, function (callback) {\r\n                var offlineState = {\r\n                    isOnline: _currentState,\r\n                    rState: rState,\r\n                    uState: uState\r\n                };\r\n                try {\r\n                    callback(offlineState);\r\n                }\r\n                catch (e) {\r\n                    // Do nothing, just making sure we run all of the callbacks\r\n                }\r\n            });\r\n        }\r\n    }\r\n    function setOnlineState(newState) {\r\n        uState = newState;\r\n        listnerNoticeCheck();\r\n    }\r\n    function _setOnline() {\r\n        rState = 1 /* eOfflineValue.Online */;\r\n        listnerNoticeCheck();\r\n    }\r\n    function _setOffline() {\r\n        rState = 2 /* eOfflineValue.Offline */;\r\n        listnerNoticeCheck();\r\n    }\r\n    function _unload() {\r\n        var win = getWindow();\r\n        if (win && _isListening) {\r\n            _disableEvents(win, _evtNamespace);\r\n            if (_document) {\r\n                // Also attach to the document.body or document\r\n                var target = _document.body || _document;\r\n                if (!isUndefined(target.ononline)) {\r\n                    _disableEvents(target, _evtNamespace);\r\n                }\r\n            }\r\n            _isListening = false;\r\n        }\r\n    }\r\n    function addListener(callback) {\r\n        listenerList[_DYN_PUSH /* @min:%2epush */](callback);\r\n        // Define rm as an instance of IUnloadHook\r\n        return {\r\n            rm: function () {\r\n                var index = listenerList.indexOf(callback);\r\n                if (index > -1) {\r\n                    return listenerList.splice(index, 1);\r\n                }\r\n                else {\r\n                    return;\r\n                }\r\n            }\r\n        };\r\n    }\r\n    return {\r\n        isOnline: _isOnline,\r\n        isListening: function () { return _isListening; },\r\n        unload: _unload,\r\n        addListener: addListener,\r\n        setOnlineState: setOnlineState\r\n    };\r\n}\r\n//# sourceMappingURL=Offline.js.map","/*\n * Application Insights JavaScript SDK - Common, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { createEnumStyle } from \"@microsoft/applicationinsights-core-js\";\r\nexport var StorageType = createEnumStyle({\r\n    LocalStorage: 0 /* eStorageType.LocalStorage */,\r\n    SessionStorage: 1 /* eStorageType.SessionStorage */\r\n});\r\nexport var DistributedTracingModes = createEnumStyle({\r\n    AI: 0 /* eDistributedTracingModes.AI */,\r\n    AI_AND_W3C: 1 /* eDistributedTracingModes.AI_AND_W3C */,\r\n    W3C: 2 /* eDistributedTracingModes.W3C */\r\n});\r\n/**\r\n * The EventPersistence contains a set of values that specify the event's persistence.\r\n */\r\nexport var EventPersistence = createEnumStyle({\r\n    /**\r\n     * Normal persistence.\r\n     */\r\n    Normal: 1 /* EventPersistenceValue.Normal */,\r\n    /**\r\n     * Critical persistence.\r\n     */\r\n    Critical: 2 /* EventPersistenceValue.Critical */\r\n});\r\n//# sourceMappingURL=Enums.js.map","/*\n * Application Insights JavaScript SDK - Common, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { _throwInternal, dumpObj, getExceptionName, getGlobal, getGlobalInst, isNullOrUndefined, objForEachKey } from \"@microsoft/applicationinsights-core-js\";\r\nimport { StorageType } from \"./Enums\";\r\nimport { _DYN_PUSH, _DYN_REMOVE_ITEM, _DYN_TO_STRING } from \"./__DynamicConstants\";\r\nvar _canUseLocalStorage = undefined;\r\nvar _canUseSessionStorage = undefined;\r\nvar _storagePrefix = \"\";\r\n/**\r\n * Gets the localStorage object if available\r\n * @return {Storage} - Returns the storage object if available else returns null\r\n */\r\nfunction _getLocalStorageObject() {\r\n    if (utlCanUseLocalStorage()) {\r\n        return _getVerifiedStorageObject(StorageType.LocalStorage);\r\n    }\r\n    return null;\r\n}\r\n/**\r\n * Tests storage object (localStorage or sessionStorage) to verify that it is usable\r\n * More details here: https://mathiasbynens.be/notes/localstorage-pattern\r\n * @param storageType - Type of storage\r\n * @return {Storage} Returns storage object verified that it is usable\r\n */\r\nfunction _getVerifiedStorageObject(storageType) {\r\n    try {\r\n        if (isNullOrUndefined(getGlobal())) {\r\n            return null;\r\n        }\r\n        var uid = (new Date)[_DYN_TO_STRING /* @min:%2etoString */]();\r\n        var storage = getGlobalInst(storageType === StorageType.LocalStorage ? \"localStorage\" : \"sessionStorage\");\r\n        var name_1 = _storagePrefix + uid;\r\n        storage.setItem(name_1, uid);\r\n        var fail = storage.getItem(name_1) !== uid;\r\n        storage[_DYN_REMOVE_ITEM /* @min:%2eremoveItem */](name_1);\r\n        if (!fail) {\r\n            return storage;\r\n        }\r\n    }\r\n    catch (exception) {\r\n        // eslint-disable-next-line no-empty\r\n    }\r\n    return null;\r\n}\r\n/**\r\n * Gets the sessionStorage object if available\r\n * @return {Storage} - Returns the storage object if available else returns null\r\n */\r\nfunction _getSessionStorageObject() {\r\n    if (utlCanUseSessionStorage()) {\r\n        return _getVerifiedStorageObject(StorageType.SessionStorage);\r\n    }\r\n    return null;\r\n}\r\n/**\r\n * Disables the global SDK usage of local or session storage if available\r\n */\r\nexport function utlDisableStorage() {\r\n    _canUseLocalStorage = false;\r\n    _canUseSessionStorage = false;\r\n}\r\nexport function utlSetStoragePrefix(storagePrefix) {\r\n    _storagePrefix = storagePrefix || \"\";\r\n}\r\n/**\r\n * Re-enables the global SDK usage of local or session storage if available\r\n */\r\nexport function utlEnableStorage() {\r\n    _canUseLocalStorage = utlCanUseLocalStorage(true);\r\n    _canUseSessionStorage = utlCanUseSessionStorage(true);\r\n}\r\n/**\r\n * Returns whether LocalStorage can be used, if the reset parameter is passed a true this will override\r\n * any previous disable calls.\r\n * @param reset - Should the usage be reset and determined only based on whether LocalStorage is available\r\n */\r\nexport function utlCanUseLocalStorage(reset) {\r\n    if (reset || _canUseLocalStorage === undefined) {\r\n        _canUseLocalStorage = !!_getVerifiedStorageObject(StorageType.LocalStorage);\r\n    }\r\n    return _canUseLocalStorage;\r\n}\r\nexport function utlGetLocalStorage(logger, name) {\r\n    var storage = _getLocalStorageObject();\r\n    if (storage !== null) {\r\n        try {\r\n            return storage.getItem(name);\r\n        }\r\n        catch (e) {\r\n            _canUseLocalStorage = false;\r\n            _throwInternal(logger, 2 /* eLoggingSeverity.WARNING */, 1 /* _eInternalMessageId.BrowserCannotReadLocalStorage */, \"Browser failed read of local storage. \" + getExceptionName(e), { exception: dumpObj(e) });\r\n        }\r\n    }\r\n    return null;\r\n}\r\nexport function utlSetLocalStorage(logger, name, data) {\r\n    var storage = _getLocalStorageObject();\r\n    if (storage !== null) {\r\n        try {\r\n            storage.setItem(name, data);\r\n            return true;\r\n        }\r\n        catch (e) {\r\n            _canUseLocalStorage = false;\r\n            _throwInternal(logger, 2 /* eLoggingSeverity.WARNING */, 3 /* _eInternalMessageId.BrowserCannotWriteLocalStorage */, \"Browser failed write to local storage. \" + getExceptionName(e), { exception: dumpObj(e) });\r\n        }\r\n    }\r\n    return false;\r\n}\r\nexport function utlRemoveStorage(logger, name) {\r\n    var storage = _getLocalStorageObject();\r\n    if (storage !== null) {\r\n        try {\r\n            storage[_DYN_REMOVE_ITEM /* @min:%2eremoveItem */](name);\r\n            return true;\r\n        }\r\n        catch (e) {\r\n            _canUseLocalStorage = false;\r\n            _throwInternal(logger, 2 /* eLoggingSeverity.WARNING */, 5 /* _eInternalMessageId.BrowserFailedRemovalFromLocalStorage */, \"Browser failed removal of local storage item. \" + getExceptionName(e), { exception: dumpObj(e) });\r\n        }\r\n    }\r\n    return false;\r\n}\r\nexport function utlCanUseSessionStorage(reset) {\r\n    if (reset || _canUseSessionStorage === undefined) {\r\n        _canUseSessionStorage = !!_getVerifiedStorageObject(StorageType.SessionStorage);\r\n    }\r\n    return _canUseSessionStorage;\r\n}\r\nexport function utlGetSessionStorageKeys() {\r\n    var keys = [];\r\n    if (utlCanUseSessionStorage()) {\r\n        objForEachKey(getGlobalInst(\"sessionStorage\"), function (key) {\r\n            keys[_DYN_PUSH /* @min:%2epush */](key);\r\n        });\r\n    }\r\n    return keys;\r\n}\r\nexport function utlGetSessionStorage(logger, name) {\r\n    var storage = _getSessionStorageObject();\r\n    if (storage !== null) {\r\n        try {\r\n            return storage.getItem(name);\r\n        }\r\n        catch (e) {\r\n            _canUseSessionStorage = false;\r\n            _throwInternal(logger, 2 /* eLoggingSeverity.WARNING */, 2 /* _eInternalMessageId.BrowserCannotReadSessionStorage */, \"Browser failed read of session storage. \" + getExceptionName(e), { exception: dumpObj(e) });\r\n        }\r\n    }\r\n    return null;\r\n}\r\nexport function utlSetSessionStorage(logger, name, data) {\r\n    var storage = _getSessionStorageObject();\r\n    if (storage !== null) {\r\n        try {\r\n            storage.setItem(name, data);\r\n            return true;\r\n        }\r\n        catch (e) {\r\n            _canUseSessionStorage = false;\r\n            _throwInternal(logger, 2 /* eLoggingSeverity.WARNING */, 4 /* _eInternalMessageId.BrowserCannotWriteSessionStorage */, \"Browser failed write to session storage. \" + getExceptionName(e), { exception: dumpObj(e) });\r\n        }\r\n    }\r\n    return false;\r\n}\r\nexport function utlRemoveSessionStorage(logger, name) {\r\n    var storage = _getSessionStorageObject();\r\n    if (storage !== null) {\r\n        try {\r\n            storage[_DYN_REMOVE_ITEM /* @min:%2eremoveItem */](name);\r\n            return true;\r\n        }\r\n        catch (e) {\r\n            _canUseSessionStorage = false;\r\n            _throwInternal(logger, 2 /* eLoggingSeverity.WARNING */, 6 /* _eInternalMessageId.BrowserFailedRemovalFromSessionStorage */, \"Browser failed removal of session storage item. \" + getExceptionName(e), { exception: dumpObj(e) });\r\n        }\r\n    }\r\n    return false;\r\n}\r\n//# sourceMappingURL=StorageHelperFuncs.js.map","/*\n * Application Insights JavaScript SDK - Common, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { createValueMap } from \"@microsoft/applicationinsights-core-js\";\r\nexport var RequestHeaders = createValueMap({\r\n    requestContextHeader: [0 /* eRequestHeaders.requestContextHeader */, \"Request-Context\"],\r\n    requestContextTargetKey: [1 /* eRequestHeaders.requestContextTargetKey */, \"appId\"],\r\n    requestContextAppIdFormat: [2 /* eRequestHeaders.requestContextAppIdFormat */, \"appId=cid-v1:\"],\r\n    requestIdHeader: [3 /* eRequestHeaders.requestIdHeader */, \"Request-Id\"],\r\n    traceParentHeader: [4 /* eRequestHeaders.traceParentHeader */, \"traceparent\"],\r\n    traceStateHeader: [5 /* eRequestHeaders.traceStateHeader */, \"tracestate\"],\r\n    sdkContextHeader: [6 /* eRequestHeaders.sdkContextHeader */, \"Sdk-Context\"],\r\n    sdkContextHeaderAppIdRequest: [7 /* eRequestHeaders.sdkContextHeaderAppIdRequest */, \"appId\"],\r\n    requestContextHeaderLowerCase: [8 /* eRequestHeaders.requestContextHeaderLowerCase */, \"request-context\"]\r\n});\r\n//# sourceMappingURL=RequestResponseHeaders.js.map","/*\n * Application Insights JavaScript SDK - Common, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { __extendsFn as __extends } from \"@microsoft/applicationinsights-shims\";\r\nimport { createClassFromInterface } from \"@microsoft/applicationinsights-core-js\";\r\nfunction _aiNameFunc(baseName) {\r\n    var aiName = \"ai.\" + baseName + \".\";\r\n    return function (name) {\r\n        return aiName + name;\r\n    };\r\n}\r\nvar _aiApplication = _aiNameFunc(\"application\");\r\nvar _aiDevice = _aiNameFunc(\"device\");\r\nvar _aiLocation = _aiNameFunc(\"location\");\r\nvar _aiOperation = _aiNameFunc(\"operation\");\r\nvar _aiSession = _aiNameFunc(\"session\");\r\nvar _aiUser = _aiNameFunc(\"user\");\r\nvar _aiCloud = _aiNameFunc(\"cloud\");\r\nvar _aiInternal = _aiNameFunc(\"internal\");\r\nvar ContextTagKeys = /** @class */ (function (_super) {\r\n    __extends(ContextTagKeys, _super);\r\n    function ContextTagKeys() {\r\n        return _super.call(this) || this;\r\n    }\r\n    return ContextTagKeys;\r\n}(createClassFromInterface({\r\n    applicationVersion: _aiApplication(\"ver\"),\r\n    applicationBuild: _aiApplication(\"build\"),\r\n    applicationTypeId: _aiApplication(\"typeId\"),\r\n    applicationId: _aiApplication(\"applicationId\"),\r\n    applicationLayer: _aiApplication(\"layer\"),\r\n    deviceId: _aiDevice(\"id\"),\r\n    deviceIp: _aiDevice(\"ip\"),\r\n    deviceLanguage: _aiDevice(\"language\"),\r\n    deviceLocale: _aiDevice(\"locale\"),\r\n    deviceModel: _aiDevice(\"model\"),\r\n    deviceFriendlyName: _aiDevice(\"friendlyName\"),\r\n    deviceNetwork: _aiDevice(\"network\"),\r\n    deviceNetworkName: _aiDevice(\"networkName\"),\r\n    deviceOEMName: _aiDevice(\"oemName\"),\r\n    deviceOS: _aiDevice(\"os\"),\r\n    deviceOSVersion: _aiDevice(\"osVersion\"),\r\n    deviceRoleInstance: _aiDevice(\"roleInstance\"),\r\n    deviceRoleName: _aiDevice(\"roleName\"),\r\n    deviceScreenResolution: _aiDevice(\"screenResolution\"),\r\n    deviceType: _aiDevice(\"type\"),\r\n    deviceMachineName: _aiDevice(\"machineName\"),\r\n    deviceVMName: _aiDevice(\"vmName\"),\r\n    deviceBrowser: _aiDevice(\"browser\"),\r\n    deviceBrowserVersion: _aiDevice(\"browserVersion\"),\r\n    locationIp: _aiLocation(\"ip\"),\r\n    locationCountry: _aiLocation(\"country\"),\r\n    locationProvince: _aiLocation(\"province\"),\r\n    locationCity: _aiLocation(\"city\"),\r\n    operationId: _aiOperation(\"id\"),\r\n    operationName: _aiOperation(\"name\"),\r\n    operationParentId: _aiOperation(\"parentId\"),\r\n    operationRootId: _aiOperation(\"rootId\"),\r\n    operationSyntheticSource: _aiOperation(\"syntheticSource\"),\r\n    operationCorrelationVector: _aiOperation(\"correlationVector\"),\r\n    sessionId: _aiSession(\"id\"),\r\n    sessionIsFirst: _aiSession(\"isFirst\"),\r\n    sessionIsNew: _aiSession(\"isNew\"),\r\n    userAccountAcquisitionDate: _aiUser(\"accountAcquisitionDate\"),\r\n    userAccountId: _aiUser(\"accountId\"),\r\n    userAgent: _aiUser(\"userAgent\"),\r\n    userId: _aiUser(\"id\"),\r\n    userStoreRegion: _aiUser(\"storeRegion\"),\r\n    userAuthUserId: _aiUser(\"authUserId\"),\r\n    userAnonymousUserAcquisitionDate: _aiUser(\"anonUserAcquisitionDate\"),\r\n    userAuthenticatedUserAcquisitionDate: _aiUser(\"authUserAcquisitionDate\"),\r\n    cloudName: _aiCloud(\"name\"),\r\n    cloudRole: _aiCloud(\"role\"),\r\n    cloudRoleVer: _aiCloud(\"roleVer\"),\r\n    cloudRoleInstance: _aiCloud(\"roleInstance\"),\r\n    cloudEnvironment: _aiCloud(\"environment\"),\r\n    cloudLocation: _aiCloud(\"location\"),\r\n    cloudDeploymentUnit: _aiCloud(\"deploymentUnit\"),\r\n    internalNodeName: _aiInternal(\"nodeName\"),\r\n    internalSdkVersion: _aiInternal(\"sdkVersion\"),\r\n    internalAgentVersion: _aiInternal(\"agentVersion\"),\r\n    internalSnippet: _aiInternal(\"snippet\"),\r\n    internalSdkSrc: _aiInternal(\"sdkSrc\")\r\n})));\r\nexport { ContextTagKeys };\r\n//# sourceMappingURL=ContextTagKeys.js.map","/*\n * Application Insights JavaScript SDK - Common, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\nimport { ContextTagKeys } from \"./Contracts/ContextTagKeys\";\r\nexport var Extensions = {\r\n    UserExt: \"user\",\r\n    DeviceExt: \"device\",\r\n    TraceExt: \"trace\",\r\n    WebExt: \"web\",\r\n    AppExt: \"app\",\r\n    OSExt: \"os\",\r\n    SessionExt: \"ses\",\r\n    SDKExt: \"sdk\"\r\n};\r\nexport var CtxTagKeys = new ContextTagKeys();\r\n//# sourceMappingURL=PartAExtensions.js.map","/*\n * Application Insights JavaScript SDK - Common, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { toISOString } from \"@microsoft/applicationinsights-core-js\";\r\nimport { strNotSpecified } from \"../../Constants\";\r\nimport { _DYN_NAME } from \"../../__DynamicConstants\";\r\nimport { dataSanitizeString } from \"./DataSanitizer\";\r\nvar Envelope = /** @class */ (function () {\r\n    /**\r\n     * Constructs a new instance of telemetry data.\r\n     */\r\n    function Envelope(logger, data, name) {\r\n        var _this = this;\r\n        var _self = this;\r\n        _self.ver = 1;\r\n        _self.sampleRate = 100.0;\r\n        _self.tags = {};\r\n        _self[_DYN_NAME /* @min:%2ename */] = dataSanitizeString(logger, name) || strNotSpecified;\r\n        _self.data = data;\r\n        _self.time = toISOString(new Date());\r\n        _self.aiDataContract = {\r\n            time: 1 /* FieldType.Required */,\r\n            iKey: 1 /* FieldType.Required */,\r\n            name: 1 /* FieldType.Required */,\r\n            sampleRate: function () {\r\n                return (_this.sampleRate === 100) ? 4 /* FieldType.Hidden */ : 1 /* FieldType.Required */;\r\n            },\r\n            tags: 1 /* FieldType.Required */,\r\n            data: 1 /* FieldType.Required */\r\n        };\r\n    }\r\n    return Envelope;\r\n}());\r\nexport { Envelope };\r\n//# sourceMappingURL=Envelope.js.map","/*\n * Application Insights JavaScript SDK - Common, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nvar Data = /** @class */ (function () {\r\n    /**\r\n     * Constructs a new instance of telemetry data.\r\n     */\r\n    function Data(baseType, data) {\r\n        /**\r\n         * The data contract for serializing this object.\r\n         */\r\n        this.aiDataContract = {\r\n            baseType: 1 /* FieldType.Required */,\r\n            baseData: 1 /* FieldType.Required */\r\n        };\r\n        this.baseType = baseType;\r\n        this.baseData = data;\r\n    }\r\n    return Data;\r\n}());\r\nexport { Data };\r\n//# sourceMappingURL=Data.js.map","/*\n * Application Insights JavaScript SDK - Channel, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\n// ###################################################################################################################################################\r\n// Note: DON'T Export these const from the package as we are still targeting IE/ES5 this will export a mutable variables that someone could change ###\r\n// ###################################################################################################################################################\r\n// Generally you should only put values that are used more than 2 times and then only if not already exposed as a constant (such as SdkCoreNames)\r\n// as when using \"short\" named values from here they will be will be minified smaller than the SdkCoreNames[eSdkCoreNames.xxxx] value.\r\nexport var STR_DURATION = \"duration\";\r\n//# sourceMappingURL=InternalConstants.js.map","/*\n * Application Insights JavaScript SDK - Channel, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\n// @skip-file-minify\r\n// ##############################################################\r\n// AUTO GENERATED FILE: This file is Auto Generated during build.\r\n// ##############################################################\r\n// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n// Note: DON'T Export these const from the package as we are still targeting ES3 this will export a mutable variables that someone could change!!!\r\n// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\nexport var _DYN_TAGS = \"tags\"; // Count: 17\r\nexport var _DYN_DEVICE_TYPE = \"deviceType\"; // Count: 3\r\nexport var _DYN_DATA = \"data\"; // Count: 15\r\nexport var _DYN_NAME = \"name\"; // Count: 8\r\nexport var _DYN_TRACE_ID = \"traceID\"; // Count: 5\r\nexport var _DYN_LENGTH = \"length\"; // Count: 38\r\nexport var _DYN_STRINGIFY = \"stringify\"; // Count: 5\r\nexport var _DYN_MEASUREMENTS = \"measurements\"; // Count: 7\r\nexport var _DYN_DATA_TYPE = \"dataType\"; // Count: 10\r\nexport var _DYN_ENVELOPE_TYPE = \"envelopeType\"; // Count: 7\r\nexport var _DYN_TO_STRING = \"toString\"; // Count: 7\r\nexport var _DYN__GET = \"_get\"; // Count: 5\r\nexport var _DYN_ENQUEUE = \"enqueue\"; // Count: 7\r\nexport var _DYN_COUNT = \"count\"; // Count: 7\r\nexport var _DYN_EVENTS_LIMIT_IN_MEM = \"eventsLimitInMem\"; // Count: 2\r\nexport var _DYN_PUSH = \"push\"; // Count: 9\r\nexport var _DYN_ITEM = \"item\"; // Count: 6\r\nexport var _DYN_EMIT_LINE_DELIMITED_0 = \"emitLineDelimitedJson\"; // Count: 3\r\nexport var _DYN_CLEAR = \"clear\"; // Count: 6\r\nexport var _DYN_CREATE_NEW = \"createNew\"; // Count: 3\r\nexport var _DYN_MARK_AS_SENT = \"markAsSent\"; // Count: 4\r\nexport var _DYN_CLEAR_SENT = \"clearSent\"; // Count: 5\r\nexport var _DYN_BUFFER_OVERRIDE = \"bufferOverride\"; // Count: 3\r\nexport var _DYN__BUFFER__KEY = \"BUFFER_KEY\"; // Count: 5\r\nexport var _DYN__SENT__BUFFER__KEY = \"SENT_BUFFER_KEY\"; // Count: 8\r\nexport var _DYN_CONCAT = \"concat\"; // Count: 6\r\nexport var _DYN__MAX__BUFFER__SIZE = \"MAX_BUFFER_SIZE\"; // Count: 5\r\nexport var _DYN_TRIGGER_SEND = \"triggerSend\"; // Count: 5\r\nexport var _DYN_DIAG_LOG = \"diagLog\"; // Count: 16\r\nexport var _DYN_INITIALIZE = \"initialize\"; // Count: 3\r\nexport var _DYN__SENDER = \"_sender\"; // Count: 5\r\nexport var _DYN_ENDPOINT_URL = \"endpointUrl\"; // Count: 5\r\nexport var _DYN_INSTRUMENTATION_KEY = \"instrumentationKey\"; // Count: 5\r\nexport var _DYN_CUSTOM_HEADERS = \"customHeaders\"; // Count: 3\r\nexport var _DYN_MAX_BATCH_SIZE_IN_BY1 = \"maxBatchSizeInBytes\"; // Count: 2\r\nexport var _DYN_ONUNLOAD_DISABLE_BEA2 = \"onunloadDisableBeacon\"; // Count: 3\r\nexport var _DYN_IS_BEACON_API_DISABL3 = \"isBeaconApiDisabled\"; // Count: 3\r\nexport var _DYN_ALWAYS_USE_XHR_OVERR4 = \"alwaysUseXhrOverride\"; // Count: 2\r\nexport var _DYN_DISABLE_XHR = \"disableXhr\"; // Count: 3\r\nexport var _DYN_ENABLE_SESSION_STORA5 = \"enableSessionStorageBuffer\"; // Count: 2\r\nexport var _DYN__BUFFER = \"_buffer\"; // Count: 9\r\nexport var _DYN_ONUNLOAD_DISABLE_FET6 = \"onunloadDisableFetch\"; // Count: 2\r\nexport var _DYN_DISABLE_SEND_BEACON_7 = \"disableSendBeaconSplit\"; // Count: 2\r\nexport var _DYN_ENABLE_SEND_PROMISE = \"enableSendPromise\"; // Count: 2\r\nexport var _DYN_GET_SENDER_INST = \"getSenderInst\"; // Count: 4\r\nexport var _DYN_UNLOAD_TRANSPORTS = \"unloadTransports\"; // Count: 2\r\nexport var _DYN_CONVERT_UNDEFINED = \"convertUndefined\"; // Count: 2\r\nexport var _DYN_MAX_BATCH_INTERVAL = \"maxBatchInterval\"; // Count: 2\r\nexport var _DYN_SERIALIZE = \"serialize\"; // Count: 4\r\nexport var _DYN__ON_ERROR = \"_onError\"; // Count: 7\r\nexport var _DYN__ON_PARTIAL_SUCCESS = \"_onPartialSuccess\"; // Count: 3\r\nexport var _DYN__ON_SUCCESS = \"_onSuccess\"; // Count: 6\r\nexport var _DYN_ITEMS_RECEIVED = \"itemsReceived\"; // Count: 3\r\nexport var _DYN_ITEMS_ACCEPTED = \"itemsAccepted\"; // Count: 3\r\nexport var _DYN_ORI_PAYLOAD = \"oriPayload\"; // Count: 3\r\nexport var _DYN_BASE_TYPE = \"baseType\"; // Count: 4\r\nexport var _DYN_SAMPLE_RATE = \"sampleRate\"; // Count: 4\r\nexport var _DYN_EVENTS_SEND_REQUEST = \"eventsSendRequest\"; // Count: 2\r\nexport var _DYN_GET_SAMPLING_SCORE = \"getSamplingScore\"; // Count: 2\r\nexport var _DYN_GET_HASH_CODE_SCORE = \"getHashCodeScore\"; // Count: 4\r\n//# sourceMappingURL=__DynamicConstants.js.map","/*\n * Application Insights JavaScript SDK - Channel, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\nimport { __assignFn as __assign } from \"@microsoft/applicationinsights-shims\";\r\nimport { CtxTagKeys, Data, Envelope, Event, Exception, HttpMethod, Metric, PageView, PageViewPerformance, RemoteDependencyData, SampleRate, Trace, dataSanitizeString } from \"@microsoft/applicationinsights-common\";\r\nimport { _throwInternal, _warnToConsole, getJSON, hasJSON, isNullOrUndefined, isNumber, isString, isTruthy, objForEachKey, optimizeObject, setValue, toISOString } from \"@microsoft/applicationinsights-core-js\";\r\nimport { STR_DURATION } from \"./InternalConstants\";\r\nimport { _DYN_DATA, _DYN_DATA_TYPE, _DYN_DEVICE_TYPE, _DYN_ENVELOPE_TYPE, _DYN_LENGTH, _DYN_MEASUREMENTS, _DYN_NAME, _DYN_STRINGIFY, _DYN_TAGS, _DYN_TO_STRING, _DYN_TRACE_ID } from \"./__DynamicConstants\";\r\n// these two constants are used to filter out properties not needed when trying to extract custom properties and measurements from the incoming payload\r\nvar strBaseType = \"baseType\";\r\nvar strBaseData = \"baseData\";\r\nvar strProperties = \"properties\";\r\nvar strTrue = \"true\";\r\nfunction _setValueIf(target, field, value) {\r\n    return setValue(target, field, value, isTruthy);\r\n}\r\n/*\r\n * Maps Part A data from CS 4.0\r\n */\r\nfunction _extractPartAExtensions(logger, item, env) {\r\n    // todo: switch to keys from common in this method\r\n    var envTags = env[_DYN_TAGS /* @min:%2etags */] = env[_DYN_TAGS /* @min:%2etags */] || {};\r\n    var itmExt = item.ext = item.ext || {};\r\n    var itmTags = item[_DYN_TAGS /* @min:%2etags */] = item[_DYN_TAGS /* @min:%2etags */] || [];\r\n    var extUser = itmExt.user;\r\n    if (extUser) {\r\n        _setValueIf(envTags, CtxTagKeys.userAuthUserId, extUser.authId);\r\n        _setValueIf(envTags, CtxTagKeys.userId, extUser.id || extUser.localId);\r\n    }\r\n    var extApp = itmExt.app;\r\n    if (extApp) {\r\n        _setValueIf(envTags, CtxTagKeys.sessionId, extApp.sesId);\r\n    }\r\n    var extDevice = itmExt.device;\r\n    if (extDevice) {\r\n        _setValueIf(envTags, CtxTagKeys.deviceId, extDevice.id || extDevice.localId);\r\n        _setValueIf(envTags, CtxTagKeys[_DYN_DEVICE_TYPE /* @min:%2edeviceType */], extDevice.deviceClass);\r\n        _setValueIf(envTags, CtxTagKeys.deviceIp, extDevice.ip);\r\n        _setValueIf(envTags, CtxTagKeys.deviceModel, extDevice.model);\r\n        _setValueIf(envTags, CtxTagKeys[_DYN_DEVICE_TYPE /* @min:%2edeviceType */], extDevice[_DYN_DEVICE_TYPE /* @min:%2edeviceType */]);\r\n    }\r\n    var web = item.ext.web;\r\n    if (web) {\r\n        _setValueIf(envTags, CtxTagKeys.deviceLanguage, web.browserLang);\r\n        _setValueIf(envTags, CtxTagKeys.deviceBrowserVersion, web.browserVer);\r\n        _setValueIf(envTags, CtxTagKeys.deviceBrowser, web.browser);\r\n        var envData = env[_DYN_DATA /* @min:%2edata */] = env[_DYN_DATA /* @min:%2edata */] || {};\r\n        var envBaseData = envData[strBaseData] = envData[strBaseData] || {};\r\n        var envProps = envBaseData[strProperties] = envBaseData[strProperties] || {};\r\n        _setValueIf(envProps, \"domain\", web.domain);\r\n        _setValueIf(envProps, \"isManual\", web.isManual ? strTrue : null);\r\n        _setValueIf(envProps, \"screenRes\", web.screenRes);\r\n        _setValueIf(envProps, \"userConsent\", web.userConsent ? strTrue : null);\r\n    }\r\n    var extOs = itmExt.os;\r\n    if (extOs) {\r\n        _setValueIf(envTags, CtxTagKeys.deviceOS, extOs[_DYN_NAME /* @min:%2ename */]);\r\n        _setValueIf(envTags, CtxTagKeys.deviceOSVersion, extOs.osVer);\r\n    }\r\n    // No support for mapping Trace.traceState to 2.0 as it is currently empty\r\n    var extTrace = itmExt.trace;\r\n    if (extTrace) {\r\n        _setValueIf(envTags, CtxTagKeys.operationParentId, extTrace.parentID);\r\n        _setValueIf(envTags, CtxTagKeys.operationName, dataSanitizeString(logger, extTrace[_DYN_NAME /* @min:%2ename */]));\r\n        _setValueIf(envTags, CtxTagKeys.operationId, extTrace[_DYN_TRACE_ID /* @min:%2etraceID */]);\r\n    }\r\n    // Sample 4.0 schema\r\n    //  {\r\n    //     \"time\" : \"2018-09-05T22:51:22.4936Z\",\r\n    //     \"name\" : \"MetricWithNamespace\",\r\n    //     \"iKey\" : \"ABC-5a4cbd20-e601-4ef5-a3c6-5d6577e4398e\",\r\n    //     \"ext\": {  \"cloud\": {\r\n    //          \"role\": \"WATSON3\",\r\n    //          \"roleInstance\": \"CO4AEAP00000260\"\r\n    //      },\r\n    //      \"device\": {}, \"correlation\": {} },\r\n    //      \"tags\": [\r\n    //        { \"amazon.region\" : \"east2\" },\r\n    //        { \"os.expid\" : \"wp:02df239\" }\r\n    //     ]\r\n    //   }\r\n    var tgs = {};\r\n    // deals with tags.push({object})\r\n    for (var i = itmTags[_DYN_LENGTH /* @min:%2elength */] - 1; i >= 0; i--) {\r\n        var tg = itmTags[i];\r\n        objForEachKey(tg, function (key, value) {\r\n            tgs[key] = value;\r\n        });\r\n        itmTags.splice(i, 1);\r\n    }\r\n    // deals with tags[key]=value (and handles hasOwnProperty)\r\n    objForEachKey(itmTags, function (tg, value) {\r\n        tgs[tg] = value;\r\n    });\r\n    var theTags = __assign(__assign({}, envTags), tgs);\r\n    if (!theTags[CtxTagKeys.internalSdkVersion]) {\r\n        // Append a version in case it is not already set\r\n        theTags[CtxTagKeys.internalSdkVersion] = dataSanitizeString(logger, \"javascript:\".concat(EnvelopeCreator.Version), 64);\r\n    }\r\n    env[_DYN_TAGS /* @min:%2etags */] = optimizeObject(theTags);\r\n}\r\nfunction _extractPropsAndMeasurements(data, properties, measurements) {\r\n    if (!isNullOrUndefined(data)) {\r\n        objForEachKey(data, function (key, value) {\r\n            if (isNumber(value)) {\r\n                measurements[key] = value;\r\n            }\r\n            else if (isString(value)) {\r\n                properties[key] = value;\r\n            }\r\n            else if (hasJSON()) {\r\n                properties[key] = getJSON()[_DYN_STRINGIFY /* @min:%2estringify */](value);\r\n            }\r\n        });\r\n    }\r\n}\r\nfunction _convertPropsUndefinedToCustomDefinedValue(properties, customUndefinedValue) {\r\n    if (!isNullOrUndefined(properties)) {\r\n        objForEachKey(properties, function (key, value) {\r\n            properties[key] = value || customUndefinedValue;\r\n        });\r\n    }\r\n}\r\n// TODO: Do we want this to take logger as arg or use this._logger as nonstatic?\r\nfunction _createEnvelope(logger, envelopeType, telemetryItem, data) {\r\n    var envelope = new Envelope(logger, data, envelopeType);\r\n    _setValueIf(envelope, \"sampleRate\", telemetryItem[SampleRate]);\r\n    if ((telemetryItem[strBaseData] || {}).startTime) {\r\n        // Starting from Version 3.0.3, the time property will be assigned by the startTime value,\r\n        // which records the loadEvent time for the pageView event.\r\n        envelope.time = toISOString(telemetryItem[strBaseData].startTime);\r\n    }\r\n    envelope.iKey = telemetryItem.iKey;\r\n    var iKeyNoDashes = telemetryItem.iKey.replace(/-/g, \"\");\r\n    envelope[_DYN_NAME /* @min:%2ename */] = envelope[_DYN_NAME /* @min:%2ename */].replace(\"{0}\", iKeyNoDashes);\r\n    // extract all extensions from ctx\r\n    _extractPartAExtensions(logger, telemetryItem, envelope);\r\n    // loop through the envelope tags (extension of Part A) and pick out the ones that should go in outgoing envelope tags\r\n    telemetryItem[_DYN_TAGS /* @min:%2etags */] = telemetryItem[_DYN_TAGS /* @min:%2etags */] || [];\r\n    return optimizeObject(envelope);\r\n}\r\nfunction EnvelopeCreatorInit(logger, telemetryItem) {\r\n    if (isNullOrUndefined(telemetryItem[strBaseData])) {\r\n        _throwInternal(logger, 1 /* eLoggingSeverity.CRITICAL */, 46 /* _eInternalMessageId.TelemetryEnvelopeInvalid */, \"telemetryItem.baseData cannot be null.\");\r\n    }\r\n}\r\nexport var EnvelopeCreator = {\r\n    Version: '3.3.4'\r\n};\r\nexport function DependencyEnvelopeCreator(logger, telemetryItem, customUndefinedValue) {\r\n    EnvelopeCreatorInit(logger, telemetryItem);\r\n    var customMeasurements = telemetryItem[strBaseData][_DYN_MEASUREMENTS /* @min:%2emeasurements */] || {};\r\n    var customProperties = telemetryItem[strBaseData][strProperties] || {};\r\n    _extractPropsAndMeasurements(telemetryItem[_DYN_DATA /* @min:%2edata */], customProperties, customMeasurements);\r\n    if (!isNullOrUndefined(customUndefinedValue)) {\r\n        _convertPropsUndefinedToCustomDefinedValue(customProperties, customUndefinedValue);\r\n    }\r\n    var bd = telemetryItem[strBaseData];\r\n    if (isNullOrUndefined(bd)) {\r\n        _warnToConsole(logger, \"Invalid input for dependency data\");\r\n        return null;\r\n    }\r\n    var method = bd[strProperties] && bd[strProperties][HttpMethod] ? bd[strProperties][HttpMethod] : \"GET\";\r\n    var remoteDepData = new RemoteDependencyData(logger, bd.id, bd.target, bd[_DYN_NAME /* @min:%2ename */], bd[STR_DURATION /* @min:%2eduration */], bd.success, bd.responseCode, method, bd.type, bd.correlationContext, customProperties, customMeasurements);\r\n    var data = new Data(RemoteDependencyData[_DYN_DATA_TYPE /* @min:%2edataType */], remoteDepData);\r\n    return _createEnvelope(logger, RemoteDependencyData[_DYN_ENVELOPE_TYPE /* @min:%2eenvelopeType */], telemetryItem, data);\r\n}\r\nexport function EventEnvelopeCreator(logger, telemetryItem, customUndefinedValue) {\r\n    EnvelopeCreatorInit(logger, telemetryItem);\r\n    var customProperties = {};\r\n    var customMeasurements = {};\r\n    if (telemetryItem[strBaseType] !== Event[_DYN_DATA_TYPE /* @min:%2edataType */]) {\r\n        customProperties[\"baseTypeSource\"] = telemetryItem[strBaseType]; // save the passed in base type as a property\r\n    }\r\n    if (telemetryItem[strBaseType] === Event[_DYN_DATA_TYPE /* @min:%2edataType */]) { // take collection\r\n        customProperties = telemetryItem[strBaseData][strProperties] || {};\r\n        customMeasurements = telemetryItem[strBaseData][_DYN_MEASUREMENTS /* @min:%2emeasurements */] || {};\r\n    }\r\n    else { // if its not a known type, convert to custom event\r\n        if (telemetryItem[strBaseData]) {\r\n            _extractPropsAndMeasurements(telemetryItem[strBaseData], customProperties, customMeasurements);\r\n        }\r\n    }\r\n    // Extract root level properties from part C telemetryItem.data\r\n    _extractPropsAndMeasurements(telemetryItem[_DYN_DATA /* @min:%2edata */], customProperties, customMeasurements);\r\n    if (!isNullOrUndefined(customUndefinedValue)) {\r\n        _convertPropsUndefinedToCustomDefinedValue(customProperties, customUndefinedValue);\r\n    }\r\n    var eventName = telemetryItem[strBaseData][_DYN_NAME /* @min:%2ename */];\r\n    var eventData = new Event(logger, eventName, customProperties, customMeasurements);\r\n    var data = new Data(Event[_DYN_DATA_TYPE /* @min:%2edataType */], eventData);\r\n    return _createEnvelope(logger, Event[_DYN_ENVELOPE_TYPE /* @min:%2eenvelopeType */], telemetryItem, data);\r\n}\r\nexport function ExceptionEnvelopeCreator(logger, telemetryItem, customUndefinedValue) {\r\n    EnvelopeCreatorInit(logger, telemetryItem);\r\n    // Extract root level properties from part C telemetryItem.data\r\n    var customMeasurements = telemetryItem[strBaseData][_DYN_MEASUREMENTS /* @min:%2emeasurements */] || {};\r\n    var customProperties = telemetryItem[strBaseData][strProperties] || {};\r\n    _extractPropsAndMeasurements(telemetryItem[_DYN_DATA /* @min:%2edata */], customProperties, customMeasurements);\r\n    if (!isNullOrUndefined(customUndefinedValue)) {\r\n        _convertPropsUndefinedToCustomDefinedValue(customProperties, customUndefinedValue);\r\n    }\r\n    var bd = telemetryItem[strBaseData];\r\n    var exData = Exception.CreateFromInterface(logger, bd, customProperties, customMeasurements);\r\n    var data = new Data(Exception[_DYN_DATA_TYPE /* @min:%2edataType */], exData);\r\n    return _createEnvelope(logger, Exception[_DYN_ENVELOPE_TYPE /* @min:%2eenvelopeType */], telemetryItem, data);\r\n}\r\nexport function MetricEnvelopeCreator(logger, telemetryItem, customUndefinedValue) {\r\n    EnvelopeCreatorInit(logger, telemetryItem);\r\n    var baseData = telemetryItem[strBaseData];\r\n    var props = baseData[strProperties] || {};\r\n    var measurements = baseData[_DYN_MEASUREMENTS /* @min:%2emeasurements */] || {};\r\n    _extractPropsAndMeasurements(telemetryItem[_DYN_DATA /* @min:%2edata */], props, measurements);\r\n    if (!isNullOrUndefined(customUndefinedValue)) {\r\n        _convertPropsUndefinedToCustomDefinedValue(props, customUndefinedValue);\r\n    }\r\n    var baseMetricData = new Metric(logger, baseData[_DYN_NAME /* @min:%2ename */], baseData.average, baseData.sampleCount, baseData.min, baseData.max, baseData.stdDev, props, measurements);\r\n    var data = new Data(Metric[_DYN_DATA_TYPE /* @min:%2edataType */], baseMetricData);\r\n    return _createEnvelope(logger, Metric[_DYN_ENVELOPE_TYPE /* @min:%2eenvelopeType */], telemetryItem, data);\r\n}\r\nexport function PageViewEnvelopeCreator(logger, telemetryItem, customUndefinedValue) {\r\n    EnvelopeCreatorInit(logger, telemetryItem);\r\n    // Since duration is not part of the domain properties in Common Schema, extract it from part C\r\n    var duration;\r\n    var baseData = telemetryItem[strBaseData];\r\n    if (!isNullOrUndefined(baseData) &&\r\n        !isNullOrUndefined(baseData[strProperties]) &&\r\n        !isNullOrUndefined(baseData[strProperties][STR_DURATION])) { // from part B properties\r\n        duration = baseData[strProperties][STR_DURATION];\r\n        delete baseData[strProperties][STR_DURATION];\r\n    }\r\n    else if (!isNullOrUndefined(telemetryItem[_DYN_DATA /* @min:%2edata */]) &&\r\n        !isNullOrUndefined(telemetryItem[_DYN_DATA /* @min:%2edata */][STR_DURATION])) { // from custom properties\r\n        duration = telemetryItem[_DYN_DATA /* @min:%2edata */][STR_DURATION];\r\n        delete telemetryItem[_DYN_DATA /* @min:%2edata */][STR_DURATION];\r\n    }\r\n    var bd = telemetryItem[strBaseData];\r\n    // special case: pageview.id is grabbed from current operation id. Analytics plugin is decoupled from properties plugin, so this is done here instead. This can be made a default telemetry intializer instead if needed to be decoupled from channel\r\n    var currentContextId;\r\n    if (((telemetryItem.ext || {}).trace || {})[_DYN_TRACE_ID /* @min:%2etraceID */]) {\r\n        currentContextId = telemetryItem.ext.trace[_DYN_TRACE_ID /* @min:%2etraceID */];\r\n    }\r\n    var id = bd.id || currentContextId;\r\n    var name = bd[_DYN_NAME /* @min:%2ename */];\r\n    var url = bd.uri;\r\n    var properties = bd[strProperties] || {};\r\n    var measurements = bd[_DYN_MEASUREMENTS /* @min:%2emeasurements */] || {};\r\n    // refUri is a field that Breeze still does not recognize as part of Part B. For now, put it in Part C until it supports it as a domain property\r\n    if (!isNullOrUndefined(bd.refUri)) {\r\n        properties[\"refUri\"] = bd.refUri;\r\n    }\r\n    // pageType is a field that Breeze still does not recognize as part of Part B. For now, put it in Part C until it supports it as a domain property\r\n    if (!isNullOrUndefined(bd.pageType)) {\r\n        properties[\"pageType\"] = bd.pageType;\r\n    }\r\n    // isLoggedIn is a field that Breeze still does not recognize as part of Part B. For now, put it in Part C until it supports it as a domain property\r\n    if (!isNullOrUndefined(bd.isLoggedIn)) {\r\n        properties[\"isLoggedIn\"] = bd.isLoggedIn[_DYN_TO_STRING /* @min:%2etoString */]();\r\n    }\r\n    // pageTags is a field that Breeze still does not recognize as part of Part B. For now, put it in Part C until it supports it as a domain property\r\n    if (!isNullOrUndefined(bd[strProperties])) {\r\n        var pageTags = bd[strProperties];\r\n        objForEachKey(pageTags, function (key, value) {\r\n            properties[key] = value;\r\n        });\r\n    }\r\n    _extractPropsAndMeasurements(telemetryItem[_DYN_DATA /* @min:%2edata */], properties, measurements);\r\n    if (!isNullOrUndefined(customUndefinedValue)) {\r\n        _convertPropsUndefinedToCustomDefinedValue(properties, customUndefinedValue);\r\n    }\r\n    var pageViewData = new PageView(logger, name, url, duration, properties, measurements, id);\r\n    var data = new Data(PageView[_DYN_DATA_TYPE /* @min:%2edataType */], pageViewData);\r\n    return _createEnvelope(logger, PageView[_DYN_ENVELOPE_TYPE /* @min:%2eenvelopeType */], telemetryItem, data);\r\n}\r\nexport function PageViewPerformanceEnvelopeCreator(logger, telemetryItem, customUndefinedValue) {\r\n    EnvelopeCreatorInit(logger, telemetryItem);\r\n    var bd = telemetryItem[strBaseData];\r\n    var name = bd[_DYN_NAME /* @min:%2ename */];\r\n    var url = bd.uri || bd.url;\r\n    var properties = bd[strProperties] || {};\r\n    var measurements = bd[_DYN_MEASUREMENTS /* @min:%2emeasurements */] || {};\r\n    _extractPropsAndMeasurements(telemetryItem[_DYN_DATA /* @min:%2edata */], properties, measurements);\r\n    if (!isNullOrUndefined(customUndefinedValue)) {\r\n        _convertPropsUndefinedToCustomDefinedValue(properties, customUndefinedValue);\r\n    }\r\n    var baseData = new PageViewPerformance(logger, name, url, undefined, properties, measurements, bd);\r\n    var data = new Data(PageViewPerformance[_DYN_DATA_TYPE /* @min:%2edataType */], baseData);\r\n    return _createEnvelope(logger, PageViewPerformance[_DYN_ENVELOPE_TYPE /* @min:%2eenvelopeType */], telemetryItem, data);\r\n}\r\nexport function TraceEnvelopeCreator(logger, telemetryItem, customUndefinedValue) {\r\n    EnvelopeCreatorInit(logger, telemetryItem);\r\n    var message = telemetryItem[strBaseData].message;\r\n    var severityLevel = telemetryItem[strBaseData].severityLevel;\r\n    var props = telemetryItem[strBaseData][strProperties] || {};\r\n    var measurements = telemetryItem[strBaseData][_DYN_MEASUREMENTS /* @min:%2emeasurements */] || {};\r\n    _extractPropsAndMeasurements(telemetryItem[_DYN_DATA /* @min:%2edata */], props, measurements);\r\n    if (!isNullOrUndefined(customUndefinedValue)) {\r\n        _convertPropsUndefinedToCustomDefinedValue(props, customUndefinedValue);\r\n    }\r\n    var baseData = new Trace(logger, message, severityLevel, props, measurements);\r\n    var data = new Data(Trace[_DYN_DATA_TYPE /* @min:%2edataType */], baseData);\r\n    return _createEnvelope(logger, Trace[_DYN_ENVELOPE_TYPE /* @min:%2eenvelopeType */], telemetryItem, data);\r\n}\r\n//# sourceMappingURL=EnvelopeCreator.js.map","/*\n * Application Insights JavaScript SDK - Channel, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\nimport { __extendsFn as __extends } from \"@microsoft/applicationinsights-shims\";\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { utlGetSessionStorage, utlRemoveSessionStorage, utlSetSessionStorage } from \"@microsoft/applicationinsights-common\";\r\nimport { _throwInternal, arrForEach, arrIndexOf, dumpObj, getExceptionName, getJSON, isArray, isFunction, isNullOrUndefined, isString } from \"@microsoft/applicationinsights-core-js\";\r\nimport { _DYN_BUFFER_OVERRIDE, _DYN_CLEAR, _DYN_CLEAR_SENT, _DYN_CONCAT, _DYN_COUNT, _DYN_CREATE_NEW, _DYN_EMIT_LINE_DELIMITED_0, _DYN_ENQUEUE, _DYN_EVENTS_LIMIT_IN_MEM, _DYN_ITEM, _DYN_LENGTH, _DYN_MARK_AS_SENT, _DYN_PUSH, _DYN_STRINGIFY, _DYN__BUFFER__KEY, _DYN__GET, _DYN__MAX__BUFFER__SIZE, _DYN__SENT__BUFFER__KEY } from \"./__DynamicConstants\";\r\nvar BaseSendBuffer = /** @class */ (function () {\r\n    function BaseSendBuffer(logger, config) {\r\n        var _buffer = [];\r\n        var _bufferFullMessageSent = false;\r\n        var _maxRetryCnt = config.maxRetryCnt;\r\n        this[_DYN__GET /* @min:%2e_get */] = function () {\r\n            return _buffer;\r\n        };\r\n        this._set = function (buffer) {\r\n            _buffer = buffer;\r\n            return _buffer;\r\n        };\r\n        dynamicProto(BaseSendBuffer, this, function (_self) {\r\n            _self[_DYN_ENQUEUE /* @min:%2eenqueue */] = function (payload) {\r\n                if (_self[_DYN_COUNT /* @min:%2ecount */]() >= config[_DYN_EVENTS_LIMIT_IN_MEM /* @min:%2eeventsLimitInMem */]) {\r\n                    // sent internal log only once per page view\r\n                    if (!_bufferFullMessageSent) {\r\n                        _throwInternal(logger, 2 /* eLoggingSeverity.WARNING */, 105 /* _eInternalMessageId.InMemoryStorageBufferFull */, \"Maximum in-memory buffer size reached: \" + _self[_DYN_COUNT /* @min:%2ecount */](), true);\r\n                        _bufferFullMessageSent = true;\r\n                    }\r\n                    return;\r\n                }\r\n                payload.cnt = payload.cnt || 0;\r\n                // max retry is defined, and max retry is reached, do not add the payload to buffer\r\n                if (!isNullOrUndefined(_maxRetryCnt)) {\r\n                    if (payload.cnt > _maxRetryCnt) {\r\n                        // TODO: add log here on dropping payloads\r\n                        return;\r\n                    }\r\n                }\r\n                _buffer[_DYN_PUSH /* @min:%2epush */](payload);\r\n                return;\r\n            };\r\n            _self[_DYN_COUNT /* @min:%2ecount */] = function () {\r\n                return _buffer[_DYN_LENGTH /* @min:%2elength */];\r\n            };\r\n            _self.size = function () {\r\n                var size = _buffer[_DYN_LENGTH /* @min:%2elength */];\r\n                for (var lp = 0; lp < _buffer[_DYN_LENGTH /* @min:%2elength */]; lp++) {\r\n                    size += (_buffer[lp].item)[_DYN_LENGTH /* @min:%2elength */];\r\n                }\r\n                if (!config[_DYN_EMIT_LINE_DELIMITED_0 /* @min:%2eemitLineDelimitedJson */]) {\r\n                    size += 2;\r\n                }\r\n                return size;\r\n            };\r\n            _self[_DYN_CLEAR /* @min:%2eclear */] = function () {\r\n                _buffer = [];\r\n                _bufferFullMessageSent = false;\r\n            };\r\n            _self.getItems = function () {\r\n                return _buffer.slice(0);\r\n            };\r\n            _self.batchPayloads = function (payloads) {\r\n                if (payloads && payloads[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                    var payloadStr_1 = [];\r\n                    arrForEach(payloads, function (payload) {\r\n                        payloadStr_1[_DYN_PUSH /* @min:%2epush */](payload[_DYN_ITEM /* @min:%2eitem */]);\r\n                    });\r\n                    var batch = config[_DYN_EMIT_LINE_DELIMITED_0 /* @min:%2eemitLineDelimitedJson */] ?\r\n                        payloadStr_1.join(\"\\n\") :\r\n                        \"[\" + payloadStr_1.join(\",\") + \"]\";\r\n                    return batch;\r\n                }\r\n                return null;\r\n            };\r\n            _self[_DYN_CREATE_NEW /* @min:%2ecreateNew */] = function (newLogger, newConfig, canUseSessionStorage) {\r\n                var items = _buffer.slice(0);\r\n                newLogger = newLogger || logger;\r\n                newConfig = newConfig || {};\r\n                var newBuffer = !!canUseSessionStorage ? new SessionStorageSendBuffer(newLogger, newConfig) : new ArraySendBuffer(newLogger, newConfig);\r\n                arrForEach(items, function (payload) {\r\n                    newBuffer[_DYN_ENQUEUE /* @min:%2eenqueue */](payload);\r\n                });\r\n                return newBuffer;\r\n            };\r\n        });\r\n    }\r\n// Removed Stub for BaseSendBuffer.prototype.enqueue.\r\n// Removed Stub for BaseSendBuffer.prototype.count.\r\n// Removed Stub for BaseSendBuffer.prototype.size.\r\n// Removed Stub for BaseSendBuffer.prototype.clear.\r\n// Removed Stub for BaseSendBuffer.prototype.getItems.\r\n// Removed Stub for BaseSendBuffer.prototype.batchPayloads.\r\n// Removed Stub for BaseSendBuffer.prototype.createNew.\r\n    // This is a workaround for an IE bug when using dynamicProto() with classes that don't have any\n    // non-dynamic functions or static properties/functions when using uglify-js to minify the resulting code.\n    BaseSendBuffer.__ieDyn=1;\n\n    return BaseSendBuffer;\r\n}());\r\n/*\r\n * An array based send buffer.\r\n */\r\nvar ArraySendBuffer = /** @class */ (function (_super) {\r\n    __extends(ArraySendBuffer, _super);\r\n    function ArraySendBuffer(logger, config) {\r\n        var _this = _super.call(this, logger, config) || this;\r\n        dynamicProto(ArraySendBuffer, _this, function (_self, _base) {\r\n            _self[_DYN_MARK_AS_SENT /* @min:%2emarkAsSent */] = function (payload) {\r\n                _base[_DYN_CLEAR /* @min:%2eclear */]();\r\n            };\r\n            _self[_DYN_CLEAR_SENT /* @min:%2eclearSent */] = function (payload) {\r\n                // not supported\r\n            };\r\n        });\r\n        return _this;\r\n    }\r\n// Removed Stub for ArraySendBuffer.prototype.markAsSent.\r\n// Removed Stub for ArraySendBuffer.prototype.clearSent.\r\n    // This is a workaround for an IE bug when using dynamicProto() with classes that don't have any\n    // non-dynamic functions or static properties/functions when using uglify-js to minify the resulting code.\n    ArraySendBuffer.__ieDyn=1;\n\n    return ArraySendBuffer;\r\n}(BaseSendBuffer));\r\nexport { ArraySendBuffer };\r\nvar PREVIOUS_KEYS = [\"AI_buffer\", \"AI_sentBuffer\"];\r\n/*\r\n * Session storage buffer holds a copy of all unsent items in the browser session storage.\r\n */\r\nvar SessionStorageSendBuffer = /** @class */ (function (_super) {\r\n    __extends(SessionStorageSendBuffer, _super);\r\n    function SessionStorageSendBuffer(logger, config) {\r\n        var _this = _super.call(this, logger, config) || this;\r\n        var _bufferFullMessageSent = false;\r\n        //Note: should not use config.namePrefix directly, because it will always refers to the latest namePrefix\r\n        var _namePrefix = config === null || config === void 0 ? void 0 : config.namePrefix;\r\n        // TODO: add remove buffer override as well\r\n        var _b = config[_DYN_BUFFER_OVERRIDE /* @min:%2ebufferOverride */] || { getItem: utlGetSessionStorage, setItem: utlSetSessionStorage }, getItem = _b.getItem, setItem = _b.setItem;\r\n        var _maxRetryCnt = config.maxRetryCnt;\r\n        dynamicProto(SessionStorageSendBuffer, _this, function (_self, _base) {\r\n            var bufferItems = _getBuffer(SessionStorageSendBuffer[_DYN__BUFFER__KEY /* @min:%2eBUFFER_KEY */]);\r\n            var itemsInSentBuffer = _getBuffer(SessionStorageSendBuffer[_DYN__SENT__BUFFER__KEY /* @min:%2eSENT_BUFFER_KEY */]);\r\n            var previousItems = _getPreviousEvents();\r\n            var notDeliveredItems = itemsInSentBuffer[_DYN_CONCAT /* @min:%2econcat */](previousItems);\r\n            var buffer = _self._set(bufferItems[_DYN_CONCAT /* @min:%2econcat */](notDeliveredItems));\r\n            // If the buffer has too many items, drop items from the end.\r\n            if (buffer[_DYN_LENGTH /* @min:%2elength */] > SessionStorageSendBuffer[_DYN__MAX__BUFFER__SIZE /* @min:%2eMAX_BUFFER_SIZE */]) {\r\n                buffer[_DYN_LENGTH /* @min:%2elength */] = SessionStorageSendBuffer[_DYN__MAX__BUFFER__SIZE /* @min:%2eMAX_BUFFER_SIZE */];\r\n            }\r\n            _setBuffer(SessionStorageSendBuffer[_DYN__SENT__BUFFER__KEY /* @min:%2eSENT_BUFFER_KEY */], []);\r\n            _setBuffer(SessionStorageSendBuffer[_DYN__BUFFER__KEY /* @min:%2eBUFFER_KEY */], buffer);\r\n            _self[_DYN_ENQUEUE /* @min:%2eenqueue */] = function (payload) {\r\n                if (_self[_DYN_COUNT /* @min:%2ecount */]() >= SessionStorageSendBuffer[_DYN__MAX__BUFFER__SIZE /* @min:%2eMAX_BUFFER_SIZE */]) {\r\n                    // sent internal log only once per page view\r\n                    if (!_bufferFullMessageSent) {\r\n                        _throwInternal(logger, 2 /* eLoggingSeverity.WARNING */, 67 /* _eInternalMessageId.SessionStorageBufferFull */, \"Maximum buffer size reached: \" + _self[_DYN_COUNT /* @min:%2ecount */](), true);\r\n                        _bufferFullMessageSent = true;\r\n                    }\r\n                    return;\r\n                }\r\n                payload.cnt = payload.cnt || 0;\r\n                // max retry is defined, and max retry is reached, do not add the payload to buffer\r\n                if (!isNullOrUndefined(_maxRetryCnt)) {\r\n                    if (payload.cnt > _maxRetryCnt) {\r\n                        // TODO: add log here on dropping payloads\r\n                        return;\r\n                    }\r\n                }\r\n                _base[_DYN_ENQUEUE /* @min:%2eenqueue */](payload);\r\n                _setBuffer(SessionStorageSendBuffer.BUFFER_KEY, _self[_DYN__GET /* @min:%2e_get */]());\r\n            };\r\n            _self[_DYN_CLEAR /* @min:%2eclear */] = function () {\r\n                _base[_DYN_CLEAR /* @min:%2eclear */]();\r\n                _setBuffer(SessionStorageSendBuffer.BUFFER_KEY, _self[_DYN__GET /* @min:%2e_get */]());\r\n                _setBuffer(SessionStorageSendBuffer[_DYN__SENT__BUFFER__KEY /* @min:%2eSENT_BUFFER_KEY */], []);\r\n                _bufferFullMessageSent = false;\r\n            };\r\n            _self[_DYN_MARK_AS_SENT /* @min:%2emarkAsSent */] = function (payload) {\r\n                _setBuffer(SessionStorageSendBuffer[_DYN__BUFFER__KEY /* @min:%2eBUFFER_KEY */], _self._set(_removePayloadsFromBuffer(payload, _self[_DYN__GET /* @min:%2e_get */]())));\r\n                var sentElements = _getBuffer(SessionStorageSendBuffer[_DYN__SENT__BUFFER__KEY /* @min:%2eSENT_BUFFER_KEY */]);\r\n                if (sentElements instanceof Array && payload instanceof Array) {\r\n                    sentElements = sentElements[_DYN_CONCAT /* @min:%2econcat */](payload);\r\n                    if (sentElements[_DYN_LENGTH /* @min:%2elength */] > SessionStorageSendBuffer[_DYN__MAX__BUFFER__SIZE /* @min:%2eMAX_BUFFER_SIZE */]) {\r\n                        // We send telemetry normally. If the SENT_BUFFER is too big we don't add new elements\r\n                        // until we receive a response from the backend and the buffer has free space again (see clearSent method)\r\n                        _throwInternal(logger, 1 /* eLoggingSeverity.CRITICAL */, 67 /* _eInternalMessageId.SessionStorageBufferFull */, \"Sent buffer reached its maximum size: \" + sentElements[_DYN_LENGTH /* @min:%2elength */], true);\r\n                        sentElements[_DYN_LENGTH /* @min:%2elength */] = SessionStorageSendBuffer[_DYN__MAX__BUFFER__SIZE /* @min:%2eMAX_BUFFER_SIZE */];\r\n                    }\r\n                    _setBuffer(SessionStorageSendBuffer[_DYN__SENT__BUFFER__KEY /* @min:%2eSENT_BUFFER_KEY */], sentElements);\r\n                }\r\n            };\r\n            _self[_DYN_CLEAR_SENT /* @min:%2eclearSent */] = function (payload) {\r\n                var sentElements = _getBuffer(SessionStorageSendBuffer[_DYN__SENT__BUFFER__KEY /* @min:%2eSENT_BUFFER_KEY */]);\r\n                sentElements = _removePayloadsFromBuffer(payload, sentElements);\r\n                _setBuffer(SessionStorageSendBuffer[_DYN__SENT__BUFFER__KEY /* @min:%2eSENT_BUFFER_KEY */], sentElements);\r\n            };\r\n            _self[_DYN_CREATE_NEW /* @min:%2ecreateNew */] = function (newLogger, newConfig, canUseSessionStorage) {\r\n                canUseSessionStorage = !!canUseSessionStorage;\r\n                var unsentItems = _self[_DYN__GET /* @min:%2e_get */]().slice(0);\r\n                var sentItems = _getBuffer(SessionStorageSendBuffer[_DYN__SENT__BUFFER__KEY /* @min:%2eSENT_BUFFER_KEY */]).slice(0);\r\n                newLogger = newLogger || logger;\r\n                newConfig = newConfig || {};\r\n                // to make sure that we do not send duplicated payloads when it is switched back to previous one\r\n                _self[_DYN_CLEAR /* @min:%2eclear */]();\r\n                var newBuffer = canUseSessionStorage ? new SessionStorageSendBuffer(newLogger, newConfig) : new ArraySendBuffer(newLogger, newConfig);\r\n                arrForEach(unsentItems, function (payload) {\r\n                    newBuffer[_DYN_ENQUEUE /* @min:%2eenqueue */](payload);\r\n                });\r\n                if (canUseSessionStorage) {\r\n                    // arr buffer will clear all payloads if markAsSent() is called\r\n                    newBuffer[_DYN_MARK_AS_SENT /* @min:%2emarkAsSent */](sentItems);\r\n                }\r\n                return newBuffer;\r\n            };\r\n            function _removePayloadsFromBuffer(payloads, buffer) {\r\n                var remaining = [];\r\n                var payloadStr = [];\r\n                arrForEach(payloads, function (payload) {\r\n                    payloadStr[_DYN_PUSH /* @min:%2epush */](payload[_DYN_ITEM /* @min:%2eitem */]);\r\n                });\r\n                arrForEach(buffer, function (value) {\r\n                    if (!isFunction(value) && arrIndexOf(payloadStr, value[_DYN_ITEM /* @min:%2eitem */]) === -1) {\r\n                        remaining[_DYN_PUSH /* @min:%2epush */](value);\r\n                    }\r\n                });\r\n                return remaining;\r\n            }\r\n            function _getBuffer(key) {\r\n                var prefixedKey = key;\r\n                prefixedKey = _namePrefix ? _namePrefix + \"_\" + prefixedKey : prefixedKey;\r\n                return _getBufferBase(prefixedKey);\r\n            }\r\n            function _getBufferBase(key) {\r\n                try {\r\n                    var bufferJson = getItem(logger, key);\r\n                    if (bufferJson) {\r\n                        var buffer_1 = getJSON().parse(bufferJson);\r\n                        if (isString(buffer_1)) {\r\n                            // When using some version prototype.js the stringify / parse cycle does not decode array's correctly\r\n                            buffer_1 = getJSON().parse(buffer_1);\r\n                        }\r\n                        if (buffer_1 && isArray(buffer_1)) {\r\n                            return buffer_1;\r\n                        }\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    _throwInternal(logger, 1 /* eLoggingSeverity.CRITICAL */, 42 /* _eInternalMessageId.FailedToRestoreStorageBuffer */, \" storage key: \" + key + \", \" + getExceptionName(e), { exception: dumpObj(e) });\r\n                }\r\n                return [];\r\n            }\r\n            function _setBuffer(key, buffer) {\r\n                var prefixedKey = key;\r\n                try {\r\n                    prefixedKey = _namePrefix ? _namePrefix + \"_\" + prefixedKey : prefixedKey;\r\n                    var bufferJson = JSON[_DYN_STRINGIFY /* @min:%2estringify */](buffer);\r\n                    setItem(logger, prefixedKey, bufferJson);\r\n                }\r\n                catch (e) {\r\n                    // if there was an error, clear the buffer\r\n                    // telemetry is stored in the _buffer array so we won't loose any items\r\n                    setItem(logger, prefixedKey, JSON[_DYN_STRINGIFY /* @min:%2estringify */]([]));\r\n                    _throwInternal(logger, 2 /* eLoggingSeverity.WARNING */, 41 /* _eInternalMessageId.FailedToSetStorageBuffer */, \" storage key: \" + prefixedKey + \", \" + getExceptionName(e) + \". Buffer cleared\", { exception: dumpObj(e) });\r\n                }\r\n            }\r\n            // this removes buffer with prefix+key\r\n            function _getPreviousEvents() {\r\n                var items = [];\r\n                try {\r\n                    arrForEach(PREVIOUS_KEYS, function (key) {\r\n                        var events = _getItemsFromPreviousKey(key);\r\n                        items = items[_DYN_CONCAT /* @min:%2econcat */](events);\r\n                        // to make sure that we also transfer items from old prefixed + key buffer\r\n                        if (_namePrefix) {\r\n                            var prefixedKey = _namePrefix + \"_\" + key;\r\n                            var prefixEvents = _getItemsFromPreviousKey(prefixedKey);\r\n                            items = items[_DYN_CONCAT /* @min:%2econcat */](prefixEvents);\r\n                        }\r\n                    });\r\n                    return items;\r\n                }\r\n                catch (e) {\r\n                    _throwInternal(logger, 2 /* eLoggingSeverity.WARNING */, 41 /* _eInternalMessageId.FailedToSetStorageBuffer */, \"Transfer events from previous buffers: \" + getExceptionName(e) + \". previous Buffer items can not be removed\", { exception: dumpObj(e) });\r\n                }\r\n                return [];\r\n            }\r\n            // transform string[] to IInternalStorageItem[]\r\n            function _getItemsFromPreviousKey(key) {\r\n                try {\r\n                    var items = _getBufferBase(key);\r\n                    var transFormedItems_1 = [];\r\n                    arrForEach(items, function (item) {\r\n                        var internalItem = {\r\n                            item: item,\r\n                            cnt: 0 // previous events will be default to 0 count\r\n                        };\r\n                        transFormedItems_1[_DYN_PUSH /* @min:%2epush */](internalItem);\r\n                    });\r\n                    // remove the session storage if we can add events back\r\n                    utlRemoveSessionStorage(logger, key);\r\n                    return transFormedItems_1;\r\n                }\r\n                catch (e) {\r\n                    // eslint-disable-next-line no-empty\r\n                }\r\n                return [];\r\n            }\r\n        });\r\n        return _this;\r\n    }\r\n// Removed Stub for SessionStorageSendBuffer.prototype.enqueue.\r\n// Removed Stub for SessionStorageSendBuffer.prototype.clear.\r\n// Removed Stub for SessionStorageSendBuffer.prototype.markAsSent.\r\n// Removed Stub for SessionStorageSendBuffer.prototype.clearSent.\r\n// Removed Stub for SessionStorageSendBuffer.prototype.createNew.\r\n    var _a;\r\n    _a = SessionStorageSendBuffer;\r\n    SessionStorageSendBuffer.VERSION = \"_1\";\r\n    SessionStorageSendBuffer.BUFFER_KEY = \"AI_buffer\" + _a.VERSION;\r\n    SessionStorageSendBuffer.SENT_BUFFER_KEY = \"AI_sentBuffer\" + _a.VERSION;\r\n    // Maximum number of payloads stored in the buffer. If the buffer is full, new elements will be dropped.\r\n    SessionStorageSendBuffer.MAX_BUFFER_SIZE = 2000;\r\n    return SessionStorageSendBuffer;\r\n}(BaseSendBuffer));\r\nexport { SessionStorageSendBuffer };\r\n//# sourceMappingURL=SendBuffer.js.map","/*\n * Application Insights JavaScript SDK - Channel, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\nvar _a, _b;\r\nimport { __assignFn as __assign, __extendsFn as __extends } from \"@microsoft/applicationinsights-shims\";\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { BreezeChannelIdentifier, DEFAULT_BREEZE_ENDPOINT, DEFAULT_BREEZE_PATH, Event, Exception, Metric, PageView, PageViewPerformance, ProcessLegacy, RemoteDependencyData, RequestHeaders, SampleRate, Trace, createOfflineListener, isInternalApplicationInsightsEndpoint, utlCanUseSessionStorage, utlSetStoragePrefix } from \"@microsoft/applicationinsights-common\";\r\nimport { ActiveStatus, BaseTelemetryPlugin, SenderPostManager, _throwInternal, _warnToConsole, arrForEach, cfgDfBoolean, cfgDfValidate, createProcessTelemetryContext, createUniqueNamespace, dateNow, dumpObj, formatErrorMessageXdr, formatErrorMessageXhr, getExceptionName, getIEVersion, isArray, isBeaconsSupported, isFetchSupported, isNullOrUndefined, mergeEvtNamespace, objExtend, onConfigChange, parseResponse, prependTransports, runTargetUnload } from \"@microsoft/applicationinsights-core-js\";\r\nimport { isNumber, isPromiseLike, isString, isTruthy, objDeepFreeze, objDefine, scheduleTimeout } from \"@nevware21/ts-utils\";\r\nimport { DependencyEnvelopeCreator, EventEnvelopeCreator, ExceptionEnvelopeCreator, MetricEnvelopeCreator, PageViewEnvelopeCreator, PageViewPerformanceEnvelopeCreator, TraceEnvelopeCreator } from \"./EnvelopeCreator\";\r\nimport { ArraySendBuffer, SessionStorageSendBuffer } from \"./SendBuffer\";\r\nimport { Serializer } from \"./Serializer\";\r\nimport { Sample } from \"./TelemetryProcessors/Sample\";\r\nimport { _DYN_ALWAYS_USE_XHR_OVERR4, _DYN_BASE_TYPE, _DYN_BUFFER_OVERRIDE, _DYN_CLEAR, _DYN_CLEAR_SENT, _DYN_CONVERT_UNDEFINED, _DYN_COUNT, _DYN_CREATE_NEW, _DYN_CUSTOM_HEADERS, _DYN_DATA, _DYN_DIAG_LOG, _DYN_DISABLE_SEND_BEACON_7, _DYN_DISABLE_XHR, _DYN_EMIT_LINE_DELIMITED_0, _DYN_ENABLE_SEND_PROMISE, _DYN_ENABLE_SESSION_STORA5, _DYN_ENDPOINT_URL, _DYN_ENQUEUE, _DYN_EVENTS_LIMIT_IN_MEM, _DYN_EVENTS_SEND_REQUEST, _DYN_GET_SENDER_INST, _DYN_INITIALIZE, _DYN_INSTRUMENTATION_KEY, _DYN_IS_BEACON_API_DISABL3, _DYN_ITEM, _DYN_ITEMS_ACCEPTED, _DYN_ITEMS_RECEIVED, _DYN_LENGTH, _DYN_MARK_AS_SENT, _DYN_MAX_BATCH_INTERVAL, _DYN_MAX_BATCH_SIZE_IN_BY1, _DYN_ONUNLOAD_DISABLE_BEA2, _DYN_ONUNLOAD_DISABLE_FET6, _DYN_ORI_PAYLOAD, _DYN_PUSH, _DYN_SAMPLE_RATE, _DYN_SERIALIZE, _DYN_TAGS, _DYN_TRIGGER_SEND, _DYN_UNLOAD_TRANSPORTS, _DYN__BUFFER, _DYN__ON_ERROR, _DYN__ON_PARTIAL_SUCCESS, _DYN__ON_SUCCESS, _DYN__SENDER } from \"./__DynamicConstants\";\r\nvar UNDEFINED_VALUE = undefined;\r\nvar EMPTY_STR = \"\";\r\nvar FetchSyncRequestSizeLimitBytes = 65000; // approx 64kb (the current Edge, Firefox and Chrome max limit)\r\nfunction _getResponseText(xhr) {\r\n    try {\r\n        return xhr.responseText;\r\n    }\r\n    catch (e) {\r\n        // Best effort, as XHR may throw while XDR wont so just ignore\r\n    }\r\n    return null;\r\n}\r\nfunction isOverrideFn(httpXHROverride) {\r\n    return httpXHROverride && httpXHROverride.sendPOST;\r\n}\r\nvar defaultAppInsightsChannelConfig = objDeepFreeze((_a = {\r\n        // Use the default value (handles empty string in the configuration)\r\n        endpointUrl: cfgDfValidate(isTruthy, DEFAULT_BREEZE_ENDPOINT + DEFAULT_BREEZE_PATH)\r\n    },\r\n    _a[_DYN_EMIT_LINE_DELIMITED_0 /* @min:emitLineDelimitedJson */] = cfgDfBoolean(),\r\n    _a[_DYN_MAX_BATCH_INTERVAL /* @min:maxBatchInterval */] = 15000,\r\n    _a[_DYN_MAX_BATCH_SIZE_IN_BY1 /* @min:maxBatchSizeInBytes */] = 102400,\r\n    _a.disableTelemetry = cfgDfBoolean(),\r\n    _a[_DYN_ENABLE_SESSION_STORA5 /* @min:enableSessionStorageBuffer */] = cfgDfBoolean(true),\r\n    _a.isRetryDisabled = cfgDfBoolean(),\r\n    _a[_DYN_IS_BEACON_API_DISABL3 /* @min:isBeaconApiDisabled */] = cfgDfBoolean(true),\r\n    _a[_DYN_DISABLE_SEND_BEACON_7 /* @min:disableSendBeaconSplit */] = cfgDfBoolean(true),\r\n    _a[_DYN_DISABLE_XHR /* @min:disableXhr */] = cfgDfBoolean(),\r\n    _a[_DYN_ONUNLOAD_DISABLE_FET6 /* @min:onunloadDisableFetch */] = cfgDfBoolean(),\r\n    _a[_DYN_ONUNLOAD_DISABLE_BEA2 /* @min:onunloadDisableBeacon */] = cfgDfBoolean(),\r\n    _a[_DYN_INSTRUMENTATION_KEY /* @min:instrumentationKey */] = UNDEFINED_VALUE,\r\n    _a.namePrefix = UNDEFINED_VALUE,\r\n    _a.samplingPercentage = cfgDfValidate(_chkSampling, 100),\r\n    _a[_DYN_CUSTOM_HEADERS /* @min:customHeaders */] = UNDEFINED_VALUE,\r\n    _a[_DYN_CONVERT_UNDEFINED /* @min:convertUndefined */] = UNDEFINED_VALUE,\r\n    _a[_DYN_EVENTS_LIMIT_IN_MEM /* @min:eventsLimitInMem */] = 10000,\r\n    _a[_DYN_BUFFER_OVERRIDE /* @min:bufferOverride */] = false,\r\n    _a.httpXHROverride = { isVal: isOverrideFn, v: UNDEFINED_VALUE },\r\n    _a[_DYN_ALWAYS_USE_XHR_OVERR4 /* @min:alwaysUseXhrOverride */] = cfgDfBoolean(),\r\n    _a.transports = UNDEFINED_VALUE,\r\n    _a.retryCodes = UNDEFINED_VALUE,\r\n    _a.maxRetryCnt = { isVal: isNumber, v: 10 },\r\n    _a));\r\nfunction _chkSampling(value) {\r\n    return !isNaN(value) && value > 0 && value <= 100;\r\n}\r\nvar EnvelopeTypeCreator = (_b = {},\r\n    _b[Event.dataType] = EventEnvelopeCreator,\r\n    _b[Trace.dataType] = TraceEnvelopeCreator,\r\n    _b[PageView.dataType] = PageViewEnvelopeCreator,\r\n    _b[PageViewPerformance.dataType] = PageViewPerformanceEnvelopeCreator,\r\n    _b[Exception.dataType] = ExceptionEnvelopeCreator,\r\n    _b[Metric.dataType] = MetricEnvelopeCreator,\r\n    _b[RemoteDependencyData.dataType] = DependencyEnvelopeCreator,\r\n    _b);\r\nvar Sender = /** @class */ (function (_super) {\r\n    __extends(Sender, _super);\r\n    function Sender() {\r\n        var _this = _super.call(this) || this;\r\n        _this.priority = 1001;\r\n        _this.identifier = BreezeChannelIdentifier;\r\n        // Don't set the defaults here, set them in the _initDefaults() as this is also called during unload\r\n        var _consecutiveErrors; // How many times in a row a retryable error condition has occurred.\r\n        var _retryAt; // The time to retry at in milliseconds from 1970/01/01 (this makes the timer calculation easy).\r\n        var _lastSend; // The time of the last send operation.\r\n        var _paused; // Flag indicating that the sending should be paused\r\n        var _timeoutHandle; // Handle to the timer for delayed sending of batches of data.\r\n        var _serializer;\r\n        var _stamp_specific_redirects;\r\n        var _headers;\r\n        var _syncFetchPayload = 0; // Keep track of the outstanding sync fetch payload total (as sync fetch has limits)\r\n        var _syncUnloadSender; // The identified sender to use for the synchronous unload stage\r\n        var _offlineListener;\r\n        var _evtNamespace;\r\n        var _endpointUrl;\r\n        var _orgEndpointUrl;\r\n        var _maxBatchSizeInBytes;\r\n        var _beaconSupported;\r\n        var _beaconOnUnloadSupported;\r\n        var _beaconNormalSupported;\r\n        var _customHeaders;\r\n        var _disableTelemetry;\r\n        var _instrumentationKey;\r\n        var _convertUndefined;\r\n        var _isRetryDisabled;\r\n        var _maxBatchInterval;\r\n        var _sessionStorageUsed;\r\n        var _bufferOverrideUsed;\r\n        var _namePrefix;\r\n        var _enableSendPromise;\r\n        var _alwaysUseCustomSend;\r\n        var _disableXhr;\r\n        var _fetchKeepAlive;\r\n        var _xhrSend;\r\n        var _fallbackSend;\r\n        var _disableBeaconSplit;\r\n        var _sendPostMgr;\r\n        var _retryCodes;\r\n        dynamicProto(Sender, _this, function (_self, _base) {\r\n            _initDefaults();\r\n            _self.pause = function () {\r\n                _clearScheduledTimer();\r\n                _paused = true;\r\n            };\r\n            _self.resume = function () {\r\n                if (_paused) {\r\n                    _paused = false;\r\n                    _retryAt = null;\r\n                    // flush if we have exceeded the max-size already\r\n                    _checkMaxSize();\r\n                    _setupTimer();\r\n                }\r\n            };\r\n            _self.flush = function (isAsync, callBack, sendReason) {\r\n                if (isAsync === void 0) { isAsync = true; }\r\n                if (!_paused) {\r\n                    // Clear the normal schedule timer as we are going to try and flush ASAP\r\n                    _clearScheduledTimer();\r\n                    try {\r\n                        return _self[_DYN_TRIGGER_SEND /* @min:%2etriggerSend */](isAsync, null, sendReason || 1 /* SendRequestReason.ManualFlush */);\r\n                    }\r\n                    catch (e) {\r\n                        _throwInternal(_self[_DYN_DIAG_LOG /* @min:%2ediagLog */](), 1 /* eLoggingSeverity.CRITICAL */, 22 /* _eInternalMessageId.FlushFailed */, \"flush failed, telemetry will not be collected: \" + getExceptionName(e), { exception: dumpObj(e) });\r\n                    }\r\n                }\r\n            };\r\n            _self.onunloadFlush = function () {\r\n                if (!_paused) {\r\n                    if (_beaconSupported || _alwaysUseCustomSend) {\r\n                        try {\r\n                            return _self[_DYN_TRIGGER_SEND /* @min:%2etriggerSend */](true, _doUnloadSend, 2 /* SendRequestReason.Unload */);\r\n                        }\r\n                        catch (e) {\r\n                            _throwInternal(_self[_DYN_DIAG_LOG /* @min:%2ediagLog */](), 1 /* eLoggingSeverity.CRITICAL */, 20 /* _eInternalMessageId.FailedToSendQueuedTelemetry */, \"failed to flush with beacon sender on page unload, telemetry will not be collected: \" + getExceptionName(e), { exception: dumpObj(e) });\r\n                        }\r\n                    }\r\n                    else {\r\n                        _self.flush(false);\r\n                    }\r\n                }\r\n            };\r\n            _self.addHeader = function (name, value) {\r\n                _headers[name] = value;\r\n            };\r\n            _self[_DYN_INITIALIZE /* @min:%2einitialize */] = function (config, core, extensions, pluginChain) {\r\n                if (_self.isInitialized()) {\r\n                    _throwInternal(_self[_DYN_DIAG_LOG /* @min:%2ediagLog */](), 1 /* eLoggingSeverity.CRITICAL */, 28 /* _eInternalMessageId.SenderNotInitialized */, \"Sender is already initialized\");\r\n                }\r\n                _base[_DYN_INITIALIZE /* @min:%2einitialize */](config, core, extensions, pluginChain);\r\n                var identifier = _self.identifier;\r\n                _serializer = new Serializer(core.logger);\r\n                _consecutiveErrors = 0;\r\n                _retryAt = null;\r\n                _lastSend = 0;\r\n                _self[_DYN__SENDER /* @min:%2e_sender */] = null;\r\n                _stamp_specific_redirects = 0;\r\n                var diagLog = _self[_DYN_DIAG_LOG /* @min:%2ediagLog */]();\r\n                _evtNamespace = mergeEvtNamespace(createUniqueNamespace(\"Sender\"), core.evtNamespace && core.evtNamespace());\r\n                _offlineListener = createOfflineListener(_evtNamespace);\r\n                // This function will be re-called whenever any referenced configuration is changed\r\n                _self._addHook(onConfigChange(config, function (details) {\r\n                    var config = details.cfg;\r\n                    if (config.storagePrefix) {\r\n                        utlSetStoragePrefix(config.storagePrefix);\r\n                    }\r\n                    var ctx = createProcessTelemetryContext(null, config, core);\r\n                    // getExtCfg only finds undefined values from core\r\n                    var senderConfig = ctx.getExtCfg(identifier, defaultAppInsightsChannelConfig);\r\n                    var curExtUrl = senderConfig[_DYN_ENDPOINT_URL /* @min:%2eendpointUrl */];\r\n                    // if it is not inital change (_endpointUrl has value)\r\n                    // if current sender endpoint url is not changed directly\r\n                    // means ExtCfg is not changed directly\r\n                    // then we need to monitor endpoint url changes from core\r\n                    if (_endpointUrl && curExtUrl === _endpointUrl) {\r\n                        var coreUrl = config[_DYN_ENDPOINT_URL /* @min:%2eendpointUrl */];\r\n                        // if core endpoint url is changed\r\n                        if (coreUrl && coreUrl !== curExtUrl) {\r\n                            // and endpoint promise changes is handled by this as well\r\n                            senderConfig[_DYN_ENDPOINT_URL /* @min:%2eendpointUrl */] = coreUrl;\r\n                        }\r\n                    }\r\n                    if (isPromiseLike(senderConfig[_DYN_INSTRUMENTATION_KEY /* @min:%2einstrumentationKey */])) {\r\n                        // if it is promise, means the endpoint url is from core.endpointurl\r\n                        senderConfig[_DYN_INSTRUMENTATION_KEY /* @min:%2einstrumentationKey */] = config[_DYN_INSTRUMENTATION_KEY /* @min:%2einstrumentationKey */];\r\n                    }\r\n                    objDefine(_self, \"_senderConfig\", {\r\n                        g: function () {\r\n                            return senderConfig;\r\n                        }\r\n                    });\r\n                    // Only update the endpoint if the original config !== the current config\r\n                    // This is so any redirect endpointUrl is not overwritten\r\n                    if (_orgEndpointUrl !== senderConfig[_DYN_ENDPOINT_URL /* @min:%2eendpointUrl */]) {\r\n                        if (_orgEndpointUrl) {\r\n                            // TODO: add doc to remind users to flush before changing endpoint, otherwise all unsent payload will be sent to new endpoint\r\n                        }\r\n                        _endpointUrl = _orgEndpointUrl = senderConfig[_DYN_ENDPOINT_URL /* @min:%2eendpointUrl */];\r\n                    }\r\n                    // or is not string\r\n                    if (core.activeStatus() === ActiveStatus.PENDING) {\r\n                        // waiting for core promises to be resolved\r\n                        // NOTE: if active status is set to pending, stop sending, clear timer here\r\n                        _self.pause();\r\n                    }\r\n                    else if (core.activeStatus() === ActiveStatus.ACTIVE) {\r\n                        // core status changed from pending to other status\r\n                        _self.resume();\r\n                    }\r\n                    if (_customHeaders && _customHeaders !== senderConfig[_DYN_CUSTOM_HEADERS /* @min:%2ecustomHeaders */]) {\r\n                        // Removing any previously defined custom headers as they have changed\r\n                        arrForEach(_customHeaders, function (customHeader) {\r\n                            delete _headers[customHeader.header];\r\n                        });\r\n                    }\r\n                    _maxBatchSizeInBytes = senderConfig[_DYN_MAX_BATCH_SIZE_IN_BY1 /* @min:%2emaxBatchSizeInBytes */];\r\n                    _beaconSupported = (senderConfig[_DYN_ONUNLOAD_DISABLE_BEA2 /* @min:%2eonunloadDisableBeacon */] === false || senderConfig[_DYN_IS_BEACON_API_DISABL3 /* @min:%2eisBeaconApiDisabled */] === false) && isBeaconsSupported();\r\n                    _beaconOnUnloadSupported = senderConfig[_DYN_ONUNLOAD_DISABLE_BEA2 /* @min:%2eonunloadDisableBeacon */] === false && isBeaconsSupported();\r\n                    _beaconNormalSupported = senderConfig[_DYN_IS_BEACON_API_DISABL3 /* @min:%2eisBeaconApiDisabled */] === false && isBeaconsSupported();\r\n                    _alwaysUseCustomSend = senderConfig[_DYN_ALWAYS_USE_XHR_OVERR4 /* @min:%2ealwaysUseXhrOverride */];\r\n                    _disableXhr = !!senderConfig[_DYN_DISABLE_XHR /* @min:%2edisableXhr */];\r\n                    _retryCodes = senderConfig.retryCodes;\r\n                    var bufferOverride = senderConfig[_DYN_BUFFER_OVERRIDE /* @min:%2ebufferOverride */];\r\n                    var canUseSessionStorage = !!senderConfig[_DYN_ENABLE_SESSION_STORA5 /* @min:%2eenableSessionStorageBuffer */] &&\r\n                        (!!bufferOverride || utlCanUseSessionStorage());\r\n                    var namePrefix = senderConfig.namePrefix;\r\n                    //Note: emitLineDelimitedJson and eventsLimitInMem is directly accessed via config in senderBuffer\r\n                    //Therefore, if canUseSessionStorage is not changed, we do not need to re initialize a new one\r\n                    var shouldUpdate = (canUseSessionStorage !== _sessionStorageUsed)\r\n                        || (canUseSessionStorage && (_namePrefix !== namePrefix)) // prefixName is only used in session storage\r\n                        || (canUseSessionStorage && (_bufferOverrideUsed !== bufferOverride));\r\n                    if (_self[_DYN__BUFFER /* @min:%2e_buffer */]) {\r\n                        // case1 (Pre and Now enableSessionStorageBuffer settings are same)\r\n                        // if namePrefix changes, transfer current buffer to new buffer\r\n                        // else no action needed\r\n                        //case2 (Pre and Now enableSessionStorageBuffer settings are changed)\r\n                        // transfer current buffer to new buffer\r\n                        if (shouldUpdate) {\r\n                            try {\r\n                                _self._buffer = _self._buffer[_DYN_CREATE_NEW /* @min:%2ecreateNew */](diagLog, senderConfig, canUseSessionStorage);\r\n                            }\r\n                            catch (e) {\r\n                                _throwInternal(_self[_DYN_DIAG_LOG /* @min:%2ediagLog */](), 1 /* eLoggingSeverity.CRITICAL */, 12 /* _eInternalMessageId.FailedAddingTelemetryToBuffer */, \"failed to transfer telemetry to different buffer storage, telemetry will be lost: \" + getExceptionName(e), { exception: dumpObj(e) });\r\n                            }\r\n                        }\r\n                        _checkMaxSize();\r\n                    }\r\n                    else {\r\n                        _self[_DYN__BUFFER /* @min:%2e_buffer */] = canUseSessionStorage\r\n                            ? new SessionStorageSendBuffer(diagLog, senderConfig) : new ArraySendBuffer(diagLog, senderConfig);\r\n                    }\r\n                    _namePrefix = namePrefix;\r\n                    _sessionStorageUsed = canUseSessionStorage;\r\n                    _bufferOverrideUsed = bufferOverride;\r\n                    _fetchKeepAlive = !senderConfig[_DYN_ONUNLOAD_DISABLE_FET6 /* @min:%2eonunloadDisableFetch */] && isFetchSupported(true);\r\n                    _disableBeaconSplit = !!senderConfig[_DYN_DISABLE_SEND_BEACON_7 /* @min:%2edisableSendBeaconSplit */];\r\n                    _self._sample = new Sample(senderConfig.samplingPercentage, diagLog);\r\n                    _instrumentationKey = senderConfig[_DYN_INSTRUMENTATION_KEY /* @min:%2einstrumentationKey */];\r\n                    if (!isPromiseLike(_instrumentationKey) && !_validateInstrumentationKey(_instrumentationKey, config)) {\r\n                        _throwInternal(diagLog, 1 /* eLoggingSeverity.CRITICAL */, 100 /* _eInternalMessageId.InvalidInstrumentationKey */, \"Invalid Instrumentation key \" + _instrumentationKey);\r\n                    }\r\n                    _customHeaders = senderConfig[_DYN_CUSTOM_HEADERS /* @min:%2ecustomHeaders */];\r\n                    if (isString(_endpointUrl) && !isInternalApplicationInsightsEndpoint(_endpointUrl) && _customHeaders && _customHeaders[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                        arrForEach(_customHeaders, function (customHeader) {\r\n                            _this.addHeader(customHeader.header, customHeader.value);\r\n                        });\r\n                    }\r\n                    else {\r\n                        _customHeaders = null;\r\n                    }\r\n                    _enableSendPromise = senderConfig[_DYN_ENABLE_SEND_PROMISE /* @min:%2eenableSendPromise */];\r\n                    var sendPostConfig = _getSendPostMgrConfig();\r\n                    // only init it once\r\n                    if (!_sendPostMgr) {\r\n                        _sendPostMgr = new SenderPostManager();\r\n                        _sendPostMgr[_DYN_INITIALIZE /* @min:%2einitialize */](sendPostConfig, diagLog);\r\n                    }\r\n                    else {\r\n                        _sendPostMgr.SetConfig(sendPostConfig);\r\n                    }\r\n                    var customInterface = senderConfig.httpXHROverride;\r\n                    var httpInterface = null;\r\n                    var syncInterface = null;\r\n                    // User requested transport(s) values > Beacon > Fetch > XHR\r\n                    // Beacon would be filtered out if user has set disableBeaconApi to true at _getSenderInterface\r\n                    var theTransports = prependTransports([3 /* TransportType.Beacon */, 1 /* TransportType.Xhr */, 2 /* TransportType.Fetch */], senderConfig.transports);\r\n                    httpInterface = _sendPostMgr && _sendPostMgr[_DYN_GET_SENDER_INST /* @min:%2egetSenderInst */](theTransports, false);\r\n                    var xhrInterface = _sendPostMgr && _sendPostMgr.getFallbackInst();\r\n                    _xhrSend = function (payload, isAsync) {\r\n                        return _doSend(xhrInterface, payload, isAsync);\r\n                    };\r\n                    _fallbackSend = function (payload, isAsync) {\r\n                        return _doSend(xhrInterface, payload, isAsync, false);\r\n                    };\r\n                    httpInterface = _alwaysUseCustomSend ? customInterface : (httpInterface || customInterface || xhrInterface);\r\n                    _self[_DYN__SENDER /* @min:%2e_sender */] = function (payload, isAsync) {\r\n                        return _doSend(httpInterface, payload, isAsync);\r\n                    };\r\n                    if (_fetchKeepAlive) {\r\n                        // Try and use the fetch with keepalive\r\n                        _syncUnloadSender = _fetchKeepAliveSender;\r\n                    }\r\n                    var syncTransports = prependTransports([3 /* TransportType.Beacon */, 1 /* TransportType.Xhr */], senderConfig[_DYN_UNLOAD_TRANSPORTS /* @min:%2eunloadTransports */]);\r\n                    if (!_fetchKeepAlive) {\r\n                        // remove fetch from theTransports\r\n                        syncTransports = syncTransports.filter(function (transport) { return transport !== 2 /* TransportType.Fetch */; });\r\n                    }\r\n                    syncInterface = _sendPostMgr && _sendPostMgr[_DYN_GET_SENDER_INST /* @min:%2egetSenderInst */](syncTransports, true);\r\n                    syncInterface = _alwaysUseCustomSend ? customInterface : (syncInterface || customInterface);\r\n                    if ((_alwaysUseCustomSend || senderConfig[_DYN_UNLOAD_TRANSPORTS /* @min:%2eunloadTransports */] || !_syncUnloadSender) && syncInterface) {\r\n                        _syncUnloadSender = function (payload, isAsync) {\r\n                            return _doSend(syncInterface, payload, isAsync);\r\n                        };\r\n                    }\r\n                    if (!_syncUnloadSender) {\r\n                        _syncUnloadSender = _xhrSend;\r\n                    }\r\n                    _disableTelemetry = senderConfig.disableTelemetry;\r\n                    _convertUndefined = senderConfig[_DYN_CONVERT_UNDEFINED /* @min:%2econvertUndefined */] || UNDEFINED_VALUE;\r\n                    _isRetryDisabled = senderConfig.isRetryDisabled;\r\n                    _maxBatchInterval = senderConfig[_DYN_MAX_BATCH_INTERVAL /* @min:%2emaxBatchInterval */];\r\n                }));\r\n            };\r\n            _self.processTelemetry = function (telemetryItem, itemCtx) {\r\n                var _a;\r\n                itemCtx = _self._getTelCtx(itemCtx);\r\n                var diagLogger = itemCtx[_DYN_DIAG_LOG /* @min:%2ediagLog */]();\r\n                try {\r\n                    var isValidate = _validate(telemetryItem, diagLogger);\r\n                    if (!isValidate) {\r\n                        return;\r\n                    }\r\n                    var aiEnvelope = _getEnvelope(telemetryItem, diagLogger);\r\n                    if (!aiEnvelope) {\r\n                        return;\r\n                    }\r\n                    // check if the incoming payload is too large, truncate if necessary\r\n                    var payload = _serializer[_DYN_SERIALIZE /* @min:%2eserialize */](aiEnvelope);\r\n                    // flush if we would exceed the max-size limit by adding this item\r\n                    var buffer = _self[_DYN__BUFFER /* @min:%2e_buffer */];\r\n                    _checkMaxSize(payload);\r\n                    var payloadItem = (_a = {},\r\n                        _a[_DYN_ITEM /* @min:item */] = payload,\r\n                        _a.cnt = 0 // inital cnt will always be 0\r\n                    ,\r\n                        _a);\r\n                    // enqueue the payload\r\n                    buffer[_DYN_ENQUEUE /* @min:%2eenqueue */](payloadItem);\r\n                    // ensure an invocation timeout is set\r\n                    _setupTimer();\r\n                }\r\n                catch (e) {\r\n                    _throwInternal(diagLogger, 2 /* eLoggingSeverity.WARNING */, 12 /* _eInternalMessageId.FailedAddingTelemetryToBuffer */, \"Failed adding telemetry to the sender's buffer, some telemetry will be lost: \" + getExceptionName(e), { exception: dumpObj(e) });\r\n                }\r\n                // hand off the telemetry item to the next plugin\r\n                _self.processNext(telemetryItem, itemCtx);\r\n            };\r\n            _self.isCompletelyIdle = function () {\r\n                return !_paused && _syncFetchPayload === 0 && _self._buffer[_DYN_COUNT /* @min:%2ecount */]() === 0;\r\n            };\r\n            _self.getOfflineListener = function () {\r\n                return _offlineListener;\r\n            };\r\n            /**\r\n             * xhr state changes\r\n             */\r\n            _self._xhrReadyStateChange = function (xhr, payload, countOfItemsInPayload) {\r\n                // since version 3.2.0, this function is no-op\r\n                if (_isStringArr(payload)) {\r\n                    return;\r\n                }\r\n                return _xhrReadyStateChange(xhr, payload, countOfItemsInPayload);\r\n            };\r\n            /**\r\n             * Immediately send buffered data\r\n             * @param async - {boolean} - Indicates if the events should be sent asynchronously\r\n             * @param forcedSender - {SenderFunction} - Indicates the forcedSender, undefined if not passed\r\n             */\r\n            _self[_DYN_TRIGGER_SEND /* @min:%2etriggerSend */] = function (async, forcedSender, sendReason) {\r\n                if (async === void 0) { async = true; }\r\n                var result;\r\n                if (!_paused) {\r\n                    try {\r\n                        var buffer = _self[_DYN__BUFFER /* @min:%2e_buffer */];\r\n                        // Send data only if disableTelemetry is false\r\n                        if (!_disableTelemetry) {\r\n                            if (buffer[_DYN_COUNT /* @min:%2ecount */]() > 0) {\r\n                                var payload = buffer.getItems();\r\n                                _notifySendRequest(sendReason || 0 /* SendRequestReason.Undefined */, async);\r\n                                // invoke send\r\n                                if (forcedSender) {\r\n                                    result = forcedSender.call(_self, payload, async);\r\n                                }\r\n                                else {\r\n                                    result = _self[_DYN__SENDER /* @min:%2e_sender */](payload, async);\r\n                                }\r\n                            }\r\n                            // update lastSend time to enable throttling\r\n                            _lastSend = +new Date;\r\n                        }\r\n                        else {\r\n                            buffer[_DYN_CLEAR /* @min:%2eclear */]();\r\n                        }\r\n                        _clearScheduledTimer();\r\n                    }\r\n                    catch (e) {\r\n                        /* Ignore this error for IE under v10 */\r\n                        var ieVer = getIEVersion();\r\n                        if (!ieVer || ieVer > 9) {\r\n                            _throwInternal(_self[_DYN_DIAG_LOG /* @min:%2ediagLog */](), 1 /* eLoggingSeverity.CRITICAL */, 40 /* _eInternalMessageId.TransmissionFailed */, \"Telemetry transmission failed, some telemetry will be lost: \" + getExceptionName(e), { exception: dumpObj(e) });\r\n                        }\r\n                    }\r\n                }\r\n                return result;\r\n            };\r\n            _self.getOfflineSupport = function () {\r\n                var _a;\r\n                return _a = {\r\n                        getUrl: function () {\r\n                            return _endpointUrl;\r\n                        },\r\n                        createPayload: _createPayload\r\n                    },\r\n                    _a[_DYN_SERIALIZE /* @min:serialize */] = _serialize,\r\n                    _a.batch = _batch,\r\n                    _a.shouldProcess = function (evt) {\r\n                        return !!_validate(evt);\r\n                    },\r\n                    _a;\r\n            };\r\n            _self._doTeardown = function (unloadCtx, unloadState) {\r\n                _self.onunloadFlush();\r\n                runTargetUnload(_offlineListener, false);\r\n                _initDefaults();\r\n            };\r\n            /**\r\n             * error handler\r\n             */\r\n            _self[_DYN__ON_ERROR /* @min:%2e_onError */] = function (payload, message, event) {\r\n                // since version 3.1.3, string[] is no-op\r\n                if (_isStringArr(payload)) {\r\n                    return;\r\n                }\r\n                return _onError(payload, message, event);\r\n            };\r\n            /**\r\n             * partial success handler\r\n             */\r\n            _self[_DYN__ON_PARTIAL_SUCCESS /* @min:%2e_onPartialSuccess */] = function (payload, results) {\r\n                // since version 3.1.3, string[] is no-op\r\n                if (_isStringArr(payload)) {\r\n                    return;\r\n                }\r\n                return _onPartialSuccess(payload, results);\r\n            };\r\n            /**\r\n             * success handler\r\n             */\r\n            _self[_DYN__ON_SUCCESS /* @min:%2e_onSuccess */] = function (payload, countOfItemsInPayload) {\r\n                // since version 3.1.3, string[] is no-op\r\n                if (_isStringArr(payload)) {\r\n                    return;\r\n                }\r\n                return _onSuccess(payload, countOfItemsInPayload);\r\n                //_self._buffer && _self._buffer.clearSent(payload);\r\n            };\r\n            /**\r\n             * xdr state changes\r\n             */\r\n            _self._xdrOnLoad = function (xdr, payload) {\r\n                // since version 3.1.3, string[] is no-op\r\n                if (_isStringArr(payload)) {\r\n                    return;\r\n                }\r\n                return _xdrOnLoad(xdr, payload);\r\n            };\r\n            function _xdrOnLoad(xdr, payload) {\r\n                var responseText = _getResponseText(xdr);\r\n                if (xdr && (responseText + \"\" === \"200\" || responseText === \"\")) {\r\n                    _consecutiveErrors = 0;\r\n                    _self[_DYN__ON_SUCCESS /* @min:%2e_onSuccess */](payload, 0);\r\n                }\r\n                else {\r\n                    var results = parseResponse(responseText);\r\n                    if (results && results[_DYN_ITEMS_RECEIVED /* @min:%2eitemsReceived */] && results[_DYN_ITEMS_RECEIVED /* @min:%2eitemsReceived */] > results[_DYN_ITEMS_ACCEPTED /* @min:%2eitemsAccepted */]\r\n                        && !_isRetryDisabled) {\r\n                        _self[_DYN__ON_PARTIAL_SUCCESS /* @min:%2e_onPartialSuccess */](payload, results);\r\n                    }\r\n                    else {\r\n                        _self[_DYN__ON_ERROR /* @min:%2e_onError */](payload, formatErrorMessageXdr(xdr));\r\n                    }\r\n                }\r\n            }\r\n            function _getSendPostMgrConfig() {\r\n                var _a;\r\n                try {\r\n                    var onCompleteFuncs = {\r\n                        xdrOnComplete: function (xdr, oncomplete, payload) {\r\n                            var data = _getPayloadArr(payload);\r\n                            if (!data) {\r\n                                return;\r\n                            }\r\n                            return _xdrOnLoad(xdr, data);\r\n                        },\r\n                        fetchOnComplete: function (response, onComplete, resValue, payload) {\r\n                            var data = _getPayloadArr(payload);\r\n                            if (!data) {\r\n                                return;\r\n                            }\r\n                            return _checkResponsStatus(response.status, data, response.url, data[_DYN_LENGTH /* @min:%2elength */], response.statusText, resValue || \"\");\r\n                        },\r\n                        xhrOnComplete: function (request, oncomplete, payload) {\r\n                            var data = _getPayloadArr(payload);\r\n                            if (!data) {\r\n                                return;\r\n                            }\r\n                            return _xhrReadyStateChange(request, data, data[_DYN_LENGTH /* @min:%2elength */]);\r\n                        },\r\n                        beaconOnRetry: function (data, onComplete, canSend) {\r\n                            return _onBeaconRetry(data, onComplete, canSend);\r\n                        }\r\n                    };\r\n                    var config = (_a = {},\r\n                        _a[_DYN_ENABLE_SEND_PROMISE /* @min:enableSendPromise */] = _enableSendPromise,\r\n                        _a.isOneDs = false,\r\n                        _a.disableCredentials = false,\r\n                        _a[_DYN_DISABLE_XHR /* @min:disableXhr */] = _disableXhr,\r\n                        _a.disableBeacon = !_beaconNormalSupported,\r\n                        _a.disableBeaconSync = !_beaconOnUnloadSupported,\r\n                        _a.senderOnCompleteCallBack = onCompleteFuncs,\r\n                        _a);\r\n                    return config;\r\n                }\r\n                catch (e) {\r\n                    // eslint-disable-next-line no-empty\r\n                }\r\n                return null;\r\n            }\r\n            /**\r\n             * xhr state changes\r\n             */\r\n            function _xhrReadyStateChange(xhr, payload, countOfItemsInPayload) {\r\n                if (xhr.readyState === 4) {\r\n                    _checkResponsStatus(xhr.status, payload, xhr.responseURL, countOfItemsInPayload, formatErrorMessageXhr(xhr), _getResponseText(xhr) || xhr.response);\r\n                }\r\n            }\r\n            /**\r\n             * error handler\r\n             */\r\n            function _onError(payload, message, event) {\r\n                _throwInternal(_self[_DYN_DIAG_LOG /* @min:%2ediagLog */](), 2 /* eLoggingSeverity.WARNING */, 26 /* _eInternalMessageId.OnError */, \"Failed to send telemetry.\", { message: message });\r\n                _self._buffer && _self._buffer[_DYN_CLEAR_SENT /* @min:%2eclearSent */](payload);\r\n            }\r\n            /**\r\n             * partial success handler\r\n             */\r\n            function _onPartialSuccess(payload, results) {\r\n                var failed = [];\r\n                var retry = [];\r\n                // Iterate through the reversed array of errors so that splicing doesn't have invalid indexes after the first item.\r\n                var errors = results.errors.reverse();\r\n                for (var _i = 0, errors_1 = errors; _i < errors_1.length; _i++) {\r\n                    var error = errors_1[_i];\r\n                    var extracted = payload.splice(error.index, 1)[0];\r\n                    if (_isRetriable(error.statusCode)) {\r\n                        retry[_DYN_PUSH /* @min:%2epush */](extracted);\r\n                    }\r\n                    else {\r\n                        // All other errors, including: 402 (Monthly quota exceeded) and 439 (Too many requests and refresh cache).\r\n                        failed[_DYN_PUSH /* @min:%2epush */](extracted);\r\n                    }\r\n                }\r\n                if (payload[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                    _self[_DYN__ON_SUCCESS /* @min:%2e_onSuccess */](payload, results[_DYN_ITEMS_ACCEPTED /* @min:%2eitemsAccepted */]);\r\n                }\r\n                if (failed[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                    _self[_DYN__ON_ERROR /* @min:%2e_onError */](failed, formatErrorMessageXhr(null, [\"partial success\", results[_DYN_ITEMS_ACCEPTED /* @min:%2eitemsAccepted */], \"of\", results.itemsReceived].join(\" \")));\r\n                }\r\n                if (retry[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                    _resendPayload(retry);\r\n                    _throwInternal(_self[_DYN_DIAG_LOG /* @min:%2ediagLog */](), 2 /* eLoggingSeverity.WARNING */, 40 /* _eInternalMessageId.TransmissionFailed */, \"Partial success. \" +\r\n                        \"Delivered: \" + payload[_DYN_LENGTH /* @min:%2elength */] + \", Failed: \" + failed[_DYN_LENGTH /* @min:%2elength */] +\r\n                        \". Will retry to send \" + retry[_DYN_LENGTH /* @min:%2elength */] + \" our of \" + results[_DYN_ITEMS_RECEIVED /* @min:%2eitemsReceived */] + \" items\");\r\n                }\r\n            }\r\n            /**\r\n             * success handler\r\n             */\r\n            function _onSuccess(payload, countOfItemsInPayload) {\r\n                _self._buffer && _self._buffer[_DYN_CLEAR_SENT /* @min:%2eclearSent */](payload);\r\n            }\r\n            function _getPayloadArr(payload) {\r\n                try {\r\n                    if (payload) {\r\n                        var internalPayload = payload;\r\n                        var arr = internalPayload[_DYN_ORI_PAYLOAD /* @min:%2eoriPayload */];\r\n                        if (arr && arr[_DYN_LENGTH /* @min:%2elength */]) {\r\n                            return arr;\r\n                        }\r\n                        return null;\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    // eslint-disable-next-line no-empty\r\n                }\r\n                return null;\r\n            }\r\n            function _validate(telemetryItem, diagLogger) {\r\n                if (_disableTelemetry) {\r\n                    // Do not send/save data\r\n                    return false;\r\n                }\r\n                // validate input\r\n                if (!telemetryItem) {\r\n                    diagLogger && _throwInternal(diagLogger, 1 /* eLoggingSeverity.CRITICAL */, 7 /* _eInternalMessageId.CannotSendEmptyTelemetry */, \"Cannot send empty telemetry\");\r\n                    return false;\r\n                }\r\n                // validate event\r\n                if (telemetryItem.baseData && !telemetryItem[_DYN_BASE_TYPE /* @min:%2ebaseType */]) {\r\n                    diagLogger && _throwInternal(diagLogger, 1 /* eLoggingSeverity.CRITICAL */, 70 /* _eInternalMessageId.InvalidEvent */, \"Cannot send telemetry without baseData and baseType\");\r\n                    return false;\r\n                }\r\n                if (!telemetryItem[_DYN_BASE_TYPE /* @min:%2ebaseType */]) {\r\n                    // Default\r\n                    telemetryItem[_DYN_BASE_TYPE /* @min:%2ebaseType */] = \"EventData\";\r\n                }\r\n                // ensure a sender was constructed\r\n                if (!_self[_DYN__SENDER /* @min:%2e_sender */]) {\r\n                    diagLogger && _throwInternal(diagLogger, 1 /* eLoggingSeverity.CRITICAL */, 28 /* _eInternalMessageId.SenderNotInitialized */, \"Sender was not initialized\");\r\n                    return false;\r\n                }\r\n                // check if this item should be sampled in, else add sampleRate tag\r\n                if (!_isSampledIn(telemetryItem)) {\r\n                    // Item is sampled out, do not send it\r\n                    diagLogger && _throwInternal(diagLogger, 2 /* eLoggingSeverity.WARNING */, 33 /* _eInternalMessageId.TelemetrySampledAndNotSent */, \"Telemetry item was sampled out and not sent\", { SampleRate: _self._sample[_DYN_SAMPLE_RATE /* @min:%2esampleRate */] });\r\n                    return false;\r\n                }\r\n                else {\r\n                    telemetryItem[SampleRate] = _self._sample[_DYN_SAMPLE_RATE /* @min:%2esampleRate */];\r\n                }\r\n                return true;\r\n            }\r\n            function _getEnvelope(telemetryItem, diagLogger) {\r\n                // construct an envelope that Application Insights endpoint can understand\r\n                // if ikey of telemetry is provided and not empty, envelope will use this iKey instead of senderConfig iKey\r\n                var defaultEnvelopeIkey = telemetryItem.iKey || _instrumentationKey;\r\n                var aiEnvelope = Sender.constructEnvelope(telemetryItem, defaultEnvelopeIkey, diagLogger, _convertUndefined);\r\n                if (!aiEnvelope) {\r\n                    _throwInternal(diagLogger, 1 /* eLoggingSeverity.CRITICAL */, 47 /* _eInternalMessageId.CreateEnvelopeError */, \"Unable to create an AppInsights envelope\");\r\n                    return;\r\n                }\r\n                var doNotSendItem = false;\r\n                // this is for running in legacy mode, where customer may already have a custom initializer present\r\n                if (telemetryItem[_DYN_TAGS /* @min:%2etags */] && telemetryItem[_DYN_TAGS /* @min:%2etags */][ProcessLegacy]) {\r\n                    arrForEach(telemetryItem[_DYN_TAGS /* @min:%2etags */][ProcessLegacy], function (callBack) {\r\n                        try {\r\n                            if (callBack && callBack(aiEnvelope) === false) {\r\n                                doNotSendItem = true;\r\n                                _warnToConsole(diagLogger, \"Telemetry processor check returns false\");\r\n                            }\r\n                        }\r\n                        catch (e) {\r\n                            // log error but dont stop executing rest of the telemetry initializers\r\n                            // doNotSendItem = true;\r\n                            _throwInternal(diagLogger, 1 /* eLoggingSeverity.CRITICAL */, 64 /* _eInternalMessageId.TelemetryInitializerFailed */, \"One of telemetry initializers failed, telemetry item will not be sent: \" + getExceptionName(e), { exception: dumpObj(e) }, true);\r\n                        }\r\n                    });\r\n                    delete telemetryItem[_DYN_TAGS /* @min:%2etags */][ProcessLegacy];\r\n                }\r\n                if (doNotSendItem) {\r\n                    return; // do not send, no need to execute next plugin\r\n                }\r\n                return aiEnvelope;\r\n            }\r\n            function _serialize(item) {\r\n                var rlt = EMPTY_STR;\r\n                var diagLogger = _self[_DYN_DIAG_LOG /* @min:%2ediagLog */]();\r\n                try {\r\n                    var valid = _validate(item, diagLogger);\r\n                    var envelope = null;\r\n                    if (valid) {\r\n                        envelope = _getEnvelope(item, diagLogger);\r\n                    }\r\n                    if (envelope) {\r\n                        rlt = _serializer[_DYN_SERIALIZE /* @min:%2eserialize */](envelope);\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    // eslint-disable-next-line no-empty\r\n                }\r\n                return rlt;\r\n            }\r\n            function _batch(arr) {\r\n                var rlt = EMPTY_STR;\r\n                if (arr && arr[_DYN_LENGTH /* @min:%2elength */]) {\r\n                    rlt = \"[\" + arr.join(\",\") + \"]\";\r\n                }\r\n                return rlt;\r\n            }\r\n            function _createPayload(data) {\r\n                var _a;\r\n                var headers = _getHeaders();\r\n                return _a = {\r\n                        urlString: _endpointUrl\r\n                    },\r\n                    _a[_DYN_DATA /* @min:data */] = data,\r\n                    _a.headers = headers,\r\n                    _a;\r\n            }\r\n            function _isSampledIn(envelope) {\r\n                return _self._sample.isSampledIn(envelope);\r\n            }\r\n            function _getOnComplete(payload, status, headers, response) {\r\n                // ***********************************************************************************************\r\n                //TODO: handle other status codes\r\n                if (status === 200 && payload) {\r\n                    _self._onSuccess(payload, payload[_DYN_LENGTH /* @min:%2elength */]);\r\n                }\r\n                else {\r\n                    response && _self[_DYN__ON_ERROR /* @min:%2e_onError */](payload, response);\r\n                }\r\n            }\r\n            function _doSend(sendInterface, payload, isAsync, markAsSent) {\r\n                if (markAsSent === void 0) { markAsSent = true; }\r\n                var onComplete = function (status, headers, response) {\r\n                    return _getOnComplete(payload, status, headers, response);\r\n                };\r\n                var payloadData = _getPayload(payload);\r\n                var sendPostFunc = sendInterface && sendInterface.sendPOST;\r\n                if (sendPostFunc && payloadData) {\r\n                    // ***********************************************************************************************\r\n                    // mark payload as sent at the beginning of calling each send function\r\n                    if (markAsSent) {\r\n                        _self._buffer[_DYN_MARK_AS_SENT /* @min:%2emarkAsSent */](payload);\r\n                    }\r\n                    return sendPostFunc(payloadData, onComplete, !isAsync);\r\n                }\r\n                return null;\r\n            }\r\n            function _getPayload(payload) {\r\n                var _a;\r\n                if (isArray(payload) && payload[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                    var batch = _self[_DYN__BUFFER /* @min:%2e_buffer */].batchPayloads(payload);\r\n                    var headers = _getHeaders();\r\n                    var payloadData = (_a = {},\r\n                        _a[_DYN_DATA /* @min:data */] = batch,\r\n                        _a.urlString = _endpointUrl,\r\n                        _a.headers = headers,\r\n                        _a.disableXhrSync = _disableXhr,\r\n                        _a.disableFetchKeepAlive = !_fetchKeepAlive,\r\n                        _a[_DYN_ORI_PAYLOAD /* @min:oriPayload */] = payload,\r\n                        _a);\r\n                    return payloadData;\r\n                }\r\n                return null;\r\n            }\r\n            function _getHeaders() {\r\n                try {\r\n                    var headers = _headers || {};\r\n                    if (isInternalApplicationInsightsEndpoint(_endpointUrl)) {\r\n                        headers[RequestHeaders[6 /* eRequestHeaders.sdkContextHeader */]] = RequestHeaders[7 /* eRequestHeaders.sdkContextHeaderAppIdRequest */];\r\n                    }\r\n                    return headers;\r\n                }\r\n                catch (e) {\r\n                    // eslint-disable-next-line no-empty\r\n                }\r\n                return null;\r\n            }\r\n            function _checkMaxSize(incomingPayload) {\r\n                var incomingSize = incomingPayload ? incomingPayload[_DYN_LENGTH /* @min:%2elength */] : 0;\r\n                if ((_self[_DYN__BUFFER /* @min:%2e_buffer */].size() + incomingSize) > _maxBatchSizeInBytes) {\r\n                    if (!_offlineListener || _offlineListener.isOnline()) { // only trigger send when currently online\r\n                        _self[_DYN_TRIGGER_SEND /* @min:%2etriggerSend */](true, null, 10 /* SendRequestReason.MaxBatchSize */);\r\n                    }\r\n                    return true;\r\n                }\r\n                return false;\r\n            }\r\n            function _checkResponsStatus(status, payload, responseUrl, countOfItemsInPayload, errorMessage, res) {\r\n                var response = null;\r\n                if (!_self._appId) {\r\n                    response = parseResponse(res);\r\n                    if (response && response.appId) {\r\n                        _self._appId = response.appId;\r\n                    }\r\n                }\r\n                if ((status < 200 || status >= 300) && status !== 0) {\r\n                    // Update End Point url if permanent redirect or moved permanently\r\n                    // Updates the end point url before retry\r\n                    if (status === 301 || status === 307 || status === 308) {\r\n                        if (!_checkAndUpdateEndPointUrl(responseUrl)) {\r\n                            _self[_DYN__ON_ERROR /* @min:%2e_onError */](payload, errorMessage);\r\n                            return;\r\n                        }\r\n                    }\r\n                    if (_offlineListener && !_offlineListener.isOnline()) { // offline\r\n                        // Note: Don't check for status == 0, since adblock gives this code\r\n                        if (!_isRetryDisabled) {\r\n                            var offlineBackOffMultiplier = 10; // arbritrary number\r\n                            _resendPayload(payload, offlineBackOffMultiplier);\r\n                            _throwInternal(_self[_DYN_DIAG_LOG /* @min:%2ediagLog */](), 2 /* eLoggingSeverity.WARNING */, 40 /* _eInternalMessageId.TransmissionFailed */, \". Offline - Response Code: \".concat(status, \". Offline status: \").concat(!_offlineListener.isOnline(), \". Will retry to send \").concat(payload.length, \" items.\"));\r\n                        }\r\n                        return;\r\n                    }\r\n                    if (!_isRetryDisabled && _isRetriable(status)) {\r\n                        _resendPayload(payload);\r\n                        _throwInternal(_self[_DYN_DIAG_LOG /* @min:%2ediagLog */](), 2 /* eLoggingSeverity.WARNING */, 40 /* _eInternalMessageId.TransmissionFailed */, \". \" +\r\n                            \"Response code \" + status + \". Will retry to send \" + payload[_DYN_LENGTH /* @min:%2elength */] + \" items.\");\r\n                    }\r\n                    else {\r\n                        _self[_DYN__ON_ERROR /* @min:%2e_onError */](payload, errorMessage);\r\n                    }\r\n                }\r\n                else {\r\n                    // check if the xhr's responseURL or fetch's response.url is same as endpoint url\r\n                    // TODO after 10 redirects force send telemetry with 'redirect=false' as query parameter.\r\n                    _checkAndUpdateEndPointUrl(responseUrl);\r\n                    if (status === 206) {\r\n                        if (!response) {\r\n                            response = parseResponse(res);\r\n                        }\r\n                        if (response && !_isRetryDisabled) {\r\n                            _self[_DYN__ON_PARTIAL_SUCCESS /* @min:%2e_onPartialSuccess */](payload, response);\r\n                        }\r\n                        else {\r\n                            _self[_DYN__ON_ERROR /* @min:%2e_onError */](payload, errorMessage);\r\n                        }\r\n                    }\r\n                    else {\r\n                        _consecutiveErrors = 0;\r\n                        _self[_DYN__ON_SUCCESS /* @min:%2e_onSuccess */](payload, countOfItemsInPayload);\r\n                    }\r\n                }\r\n            }\r\n            function _checkAndUpdateEndPointUrl(responseUrl) {\r\n                // Maximum stamp specific redirects allowed(uncomment this when breeze is ready with not allowing redirects feature)\r\n                if (_stamp_specific_redirects >= 10) {\r\n                    //  _self._senderConfig.endpointUrl = () => Sender._getDefaultAppInsightsChannelConfig().endpointUrl()+\"/?redirect=false\";\r\n                    //  _stamp_specific_redirects = 0;\r\n                    return false;\r\n                }\r\n                if (!isNullOrUndefined(responseUrl) && responseUrl !== \"\") {\r\n                    if (responseUrl !== _endpointUrl) {\r\n                        _endpointUrl = responseUrl;\r\n                        ++_stamp_specific_redirects;\r\n                        return true;\r\n                    }\r\n                }\r\n                return false;\r\n            }\r\n            function _doUnloadSend(payload, isAsync) {\r\n                if (_syncUnloadSender) {\r\n                    // We are unloading so always call the sender with sync set to false\r\n                    _syncUnloadSender(payload, false);\r\n                }\r\n                else {\r\n                    // Fallback to the previous beacon Sender (which causes a CORB warning on chrome now)\r\n                    var beaconInst = _sendPostMgr && _sendPostMgr[_DYN_GET_SENDER_INST /* @min:%2egetSenderInst */]([3 /* TransportType.Beacon */], true);\r\n                    return _doSend(beaconInst, payload, isAsync);\r\n                }\r\n            }\r\n            function _onBeaconRetry(payload, onComplete, canSend) {\r\n                var internalPayload = payload;\r\n                var data = internalPayload && internalPayload[_DYN_ORI_PAYLOAD /* @min:%2eoriPayload */];\r\n                if (!_disableBeaconSplit) {\r\n                    // Failed to send entire payload so try and split data and try to send as much events as possible\r\n                    var droppedPayload = [];\r\n                    for (var lp = 0; lp < data[_DYN_LENGTH /* @min:%2elength */]; lp++) {\r\n                        var thePayload = data[lp];\r\n                        var arr = [thePayload];\r\n                        var item = _getPayload(arr);\r\n                        if (!canSend(item, onComplete)) {\r\n                            // Can't send anymore, so split the batch and drop the rest\r\n                            droppedPayload[_DYN_PUSH /* @min:%2epush */](thePayload);\r\n                        }\r\n                        else {\r\n                            _self._onSuccess(arr, arr[_DYN_LENGTH /* @min:%2elength */]);\r\n                        }\r\n                    }\r\n                    if (droppedPayload[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                        _fallbackSend && _fallbackSend(droppedPayload, true);\r\n                        _throwInternal(_self[_DYN_DIAG_LOG /* @min:%2ediagLog */](), 2 /* eLoggingSeverity.WARNING */, 40 /* _eInternalMessageId.TransmissionFailed */, \". \" + \"Failed to send telemetry with Beacon API, retried with normal sender.\");\r\n                    }\r\n                }\r\n                else {\r\n                    _fallbackSend && _fallbackSend(data, true);\r\n                    _throwInternal(_self[_DYN_DIAG_LOG /* @min:%2ediagLog */](), 2 /* eLoggingSeverity.WARNING */, 40 /* _eInternalMessageId.TransmissionFailed */, \". \" + \"Failed to send telemetry with Beacon API, retried with normal sender.\");\r\n                }\r\n            }\r\n            function _isStringArr(arr) {\r\n                try {\r\n                    if (arr && arr[_DYN_LENGTH /* @min:%2elength */]) {\r\n                        return (isString(arr[0]));\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    //TODO: log, sender use IInternalStorageItem instead of string since 3.1.3\r\n                }\r\n                return null;\r\n            }\r\n            function _fetchKeepAliveSender(payload, isAsync) {\r\n                var transport = null;\r\n                if (isArray(payload)) {\r\n                    var payloadSize = payload[_DYN_LENGTH /* @min:%2elength */];\r\n                    for (var lp = 0; lp < payload[_DYN_LENGTH /* @min:%2elength */]; lp++) {\r\n                        payloadSize += payload[lp].item[_DYN_LENGTH /* @min:%2elength */];\r\n                    }\r\n                    var syncFetchPayload = _sendPostMgr.getSyncFetchPayload();\r\n                    if ((syncFetchPayload + payloadSize) <= FetchSyncRequestSizeLimitBytes) {\r\n                        transport = 2 /* TransportType.Fetch */;\r\n                    }\r\n                    else if (isBeaconsSupported()) {\r\n                        // Fallback to beacon sender as we at least get told which events can't be scheduled\r\n                        transport = 3 /* TransportType.Beacon */;\r\n                    }\r\n                    else {\r\n                        // Payload is going to be too big so just try and send via XHR\r\n                        transport = 1 /* TransportType.Xhr */;\r\n                        _throwInternal(_self[_DYN_DIAG_LOG /* @min:%2ediagLog */](), 2 /* eLoggingSeverity.WARNING */, 40 /* _eInternalMessageId.TransmissionFailed */, \". \" + \"Failed to send telemetry with Beacon API, retried with xhrSender.\");\r\n                    }\r\n                    var inst = _sendPostMgr && _sendPostMgr[_DYN_GET_SENDER_INST /* @min:%2egetSenderInst */]([transport], true);\r\n                    return _doSend(inst, payload, isAsync);\r\n                }\r\n                return null;\r\n            }\r\n            /**\r\n             * Resend payload. Adds payload back to the send buffer and setup a send timer (with exponential backoff).\r\n             * @param payload\r\n             */\r\n            function _resendPayload(payload, linearFactor) {\r\n                if (linearFactor === void 0) { linearFactor = 1; }\r\n                if (!payload || payload[_DYN_LENGTH /* @min:%2elength */] === 0) {\r\n                    return;\r\n                }\r\n                var buffer = _self[_DYN__BUFFER /* @min:%2e_buffer */];\r\n                buffer[_DYN_CLEAR_SENT /* @min:%2eclearSent */](payload);\r\n                _consecutiveErrors++;\r\n                for (var _i = 0, payload_1 = payload; _i < payload_1.length; _i++) {\r\n                    var item = payload_1[_i];\r\n                    item.cnt = item.cnt || 0; // to make sure we have cnt for each payload\r\n                    item.cnt++; // when resend, increase cnt\r\n                    buffer[_DYN_ENQUEUE /* @min:%2eenqueue */](item);\r\n                }\r\n                // setup timer\r\n                _setRetryTime(linearFactor);\r\n                _setupTimer();\r\n            }\r\n            /**\r\n             * Calculates the time to wait before retrying in case of an error based on\r\n             * http://en.wikipedia.org/wiki/Exponential_backoff\r\n             */\r\n            function _setRetryTime(linearFactor) {\r\n                var SlotDelayInSeconds = 10;\r\n                var delayInSeconds;\r\n                if (_consecutiveErrors <= 1) {\r\n                    delayInSeconds = SlotDelayInSeconds;\r\n                }\r\n                else {\r\n                    var backOffSlot = (Math.pow(2, _consecutiveErrors) - 1) / 2;\r\n                    // tslint:disable-next-line:insecure-random\r\n                    var backOffDelay = Math.floor(Math.random() * backOffSlot * SlotDelayInSeconds) + 1;\r\n                    backOffDelay = linearFactor * backOffDelay;\r\n                    delayInSeconds = Math.max(Math.min(backOffDelay, 3600), SlotDelayInSeconds);\r\n                }\r\n                // TODO: Log the backoff time like the C# version does.\r\n                var retryAfterTimeSpan = dateNow() + (delayInSeconds * 1000);\r\n                // TODO: Log the retry at time like the C# version does.\r\n                _retryAt = retryAfterTimeSpan;\r\n            }\r\n            /**\r\n             * Sets up the timer which triggers actually sending the data.\r\n             */\r\n            function _setupTimer() {\r\n                if (!_timeoutHandle && !_paused) {\r\n                    var retryInterval = _retryAt ? Math.max(0, _retryAt - dateNow()) : 0;\r\n                    var timerValue = Math.max(_maxBatchInterval, retryInterval);\r\n                    _timeoutHandle = scheduleTimeout(function () {\r\n                        _timeoutHandle = null;\r\n                        _self[_DYN_TRIGGER_SEND /* @min:%2etriggerSend */](true, null, 1 /* SendRequestReason.NormalSchedule */);\r\n                    }, timerValue);\r\n                }\r\n            }\r\n            function _clearScheduledTimer() {\r\n                _timeoutHandle && _timeoutHandle.cancel();\r\n                _timeoutHandle = null;\r\n                _retryAt = null;\r\n            }\r\n            /**\r\n             * Checks if the SDK should resend the payload after receiving this status code from the backend.\r\n             * @param statusCode\r\n             */\r\n            function _isRetriable(statusCode) {\r\n                // retryCodes = [] means should not retry\r\n                if (!isNullOrUndefined(_retryCodes)) {\r\n                    return _retryCodes[_DYN_LENGTH /* @min:%2elength */] && _retryCodes.indexOf(statusCode) > -1;\r\n                }\r\n                return statusCode === 401 // Unauthorized\r\n                    // Removing as private links can return a 403 which causes excessive retries and session storage usage\r\n                    // || statusCode === 403 // Forbidden\r\n                    || statusCode === 408 // Timeout\r\n                    || statusCode === 429 // Too many requests.\r\n                    || statusCode === 500 // Internal server error.\r\n                    || statusCode === 502 // Bad Gateway.\r\n                    || statusCode === 503 // Service unavailable.\r\n                    || statusCode === 504; // Gateway timeout.\r\n            }\r\n            // Using function lookups for backward compatibility as the getNotifyMgr() did not exist until after v2.5.6\r\n            function _getNotifyMgr() {\r\n                var func = \"getNotifyMgr\";\r\n                if (_self.core[func]) {\r\n                    return _self.core[func]();\r\n                }\r\n                // using _self.core['_notificationManager'] for backward compatibility\r\n                return _self.core[\"_notificationManager\"];\r\n            }\r\n            function _notifySendRequest(sendRequest, isAsync) {\r\n                var manager = _getNotifyMgr();\r\n                if (manager && manager[_DYN_EVENTS_SEND_REQUEST /* @min:%2eeventsSendRequest */]) {\r\n                    try {\r\n                        manager[_DYN_EVENTS_SEND_REQUEST /* @min:%2eeventsSendRequest */](sendRequest, isAsync);\r\n                    }\r\n                    catch (e) {\r\n                        _throwInternal(_self[_DYN_DIAG_LOG /* @min:%2ediagLog */](), 1 /* eLoggingSeverity.CRITICAL */, 74 /* _eInternalMessageId.NotificationException */, \"send request notification failed: \" + getExceptionName(e), { exception: dumpObj(e) });\r\n                    }\r\n                }\r\n            }\r\n            /**\r\n             * Validate UUID Format\r\n             * Specs taken from https://tools.ietf.org/html/rfc4122 and breeze repo\r\n             */\r\n            function _validateInstrumentationKey(instrumentationKey, config) {\r\n                var disableValidation = config.disableInstrumentationKeyValidation;\r\n                var disableIKeyValidationFlag = isNullOrUndefined(disableValidation) ? false : disableValidation;\r\n                if (disableIKeyValidationFlag) {\r\n                    return true;\r\n                }\r\n                var UUID_Regex = \"^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$\";\r\n                var regexp = new RegExp(UUID_Regex);\r\n                return regexp.test(instrumentationKey);\r\n            }\r\n            function _initDefaults() {\r\n                _self[_DYN__SENDER /* @min:%2e_sender */] = null;\r\n                _self[_DYN__BUFFER /* @min:%2e_buffer */] = null;\r\n                _self._appId = null;\r\n                _self._sample = null;\r\n                _headers = {};\r\n                _offlineListener = null;\r\n                _consecutiveErrors = 0;\r\n                _retryAt = null;\r\n                _lastSend = null;\r\n                _paused = false;\r\n                _timeoutHandle = null;\r\n                _serializer = null;\r\n                _stamp_specific_redirects = 0;\r\n                _syncFetchPayload = 0;\r\n                _syncUnloadSender = null;\r\n                _evtNamespace = null;\r\n                _endpointUrl = null;\r\n                _orgEndpointUrl = null;\r\n                _maxBatchSizeInBytes = 0;\r\n                _beaconSupported = false;\r\n                _customHeaders = null;\r\n                _disableTelemetry = false;\r\n                _instrumentationKey = null;\r\n                _convertUndefined = UNDEFINED_VALUE;\r\n                _isRetryDisabled = false;\r\n                _sessionStorageUsed = null;\r\n                _namePrefix = UNDEFINED_VALUE;\r\n                _disableXhr = false;\r\n                _fetchKeepAlive = false;\r\n                _disableBeaconSplit = false;\r\n                _xhrSend = null;\r\n                _fallbackSend = null;\r\n                _sendPostMgr = null;\r\n                objDefine(_self, \"_senderConfig\", {\r\n                    g: function () {\r\n                        return objExtend({}, defaultAppInsightsChannelConfig);\r\n                    }\r\n                });\r\n            }\r\n        });\r\n        return _this;\r\n    }\r\n    Sender.constructEnvelope = function (orig, iKey, logger, convertUndefined) {\r\n        var envelope;\r\n        if (iKey !== orig.iKey && !isNullOrUndefined(iKey)) {\r\n            envelope = __assign(__assign({}, orig), { iKey: iKey });\r\n        }\r\n        else {\r\n            envelope = orig;\r\n        }\r\n        var creator = EnvelopeTypeCreator[envelope.baseType] || EventEnvelopeCreator;\r\n        return creator(logger, envelope, convertUndefined);\r\n    };\r\n// Removed Stub for Sender.prototype.pause.\r\n// Removed Stub for Sender.prototype.resume.\r\n// Removed Stub for Sender.prototype.flush.\r\n// Removed Stub for Sender.prototype.onunloadFlush.\r\n// Removed Stub for Sender.prototype.initialize.\r\n// Removed Stub for Sender.prototype.processTelemetry.\r\n// Removed Stub for Sender.prototype._xhrReadyStateChange.\r\n// Removed Stub for Sender.prototype.triggerSend.\r\n// Removed Stub for Sender.prototype._onError.\r\n// Removed Stub for Sender.prototype._onPartialSuccess.\r\n// Removed Stub for Sender.prototype._onSuccess.\r\n// Removed Stub for Sender.prototype._xdrOnLoad.\r\n// Removed Stub for Sender.prototype.addHeader.\r\n// Removed Stub for Sender.prototype.isCompletelyIdle.\r\n// Removed Stub for Sender.prototype.getOfflineSupport.\r\n// Removed Stub for Sender.prototype.getOfflineListener.\r\n    return Sender;\r\n}(BaseTelemetryPlugin));\r\nexport { Sender };\r\n//# sourceMappingURL=Sender.js.map","/*\n * Application Insights JavaScript SDK - Channel, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { _throwInternal, getJSON, isArray, isFunction, isObject, objForEachKey } from \"@microsoft/applicationinsights-core-js\";\r\nimport { _DYN_LENGTH, _DYN_PUSH, _DYN_SERIALIZE, _DYN_STRINGIFY, _DYN_TO_STRING } from \"./__DynamicConstants\";\r\nvar Serializer = /** @class */ (function () {\r\n    function Serializer(logger) {\r\n        dynamicProto(Serializer, this, function (_self) {\r\n            /**\r\n             * Serializes the current object to a JSON string.\r\n             */\r\n            _self[_DYN_SERIALIZE /* @min:%2eserialize */] = function (input) {\r\n                var output = _serializeObject(input, \"root\");\r\n                try {\r\n                    return getJSON()[_DYN_STRINGIFY /* @min:%2estringify */](output);\r\n                }\r\n                catch (e) {\r\n                    // if serialization fails return an empty string\r\n                    _throwInternal(logger, 1 /* eLoggingSeverity.CRITICAL */, 48 /* _eInternalMessageId.CannotSerializeObject */, (e && isFunction(e[_DYN_TO_STRING /* @min:%2etoString */])) ? e[_DYN_TO_STRING /* @min:%2etoString */]() : \"Error serializing object\", null, true);\r\n                }\r\n            };\r\n            function _serializeObject(source, name) {\r\n                var circularReferenceCheck = \"__aiCircularRefCheck\";\r\n                var output = {};\r\n                if (!source) {\r\n                    _throwInternal(logger, 1 /* eLoggingSeverity.CRITICAL */, 48 /* _eInternalMessageId.CannotSerializeObject */, \"cannot serialize object because it is null or undefined\", { name: name }, true);\r\n                    return output;\r\n                }\r\n                if (source[circularReferenceCheck]) {\r\n                    _throwInternal(logger, 2 /* eLoggingSeverity.WARNING */, 50 /* _eInternalMessageId.CircularReferenceDetected */, \"Circular reference detected while serializing object\", { name: name }, true);\r\n                    return output;\r\n                }\r\n                if (!source.aiDataContract) {\r\n                    // special case for measurements/properties/tags\r\n                    if (name === \"measurements\") {\r\n                        output = _serializeStringMap(source, \"number\", name);\r\n                    }\r\n                    else if (name === \"properties\") {\r\n                        output = _serializeStringMap(source, \"string\", name);\r\n                    }\r\n                    else if (name === \"tags\") {\r\n                        output = _serializeStringMap(source, \"string\", name);\r\n                    }\r\n                    else if (isArray(source)) {\r\n                        output = _serializeArray(source, name);\r\n                    }\r\n                    else {\r\n                        _throwInternal(logger, 2 /* eLoggingSeverity.WARNING */, 49 /* _eInternalMessageId.CannotSerializeObjectNonSerializable */, \"Attempting to serialize an object which does not implement ISerializable\", { name: name }, true);\r\n                        try {\r\n                            // verify that the object can be stringified\r\n                            getJSON()[_DYN_STRINGIFY /* @min:%2estringify */](source);\r\n                            output = source;\r\n                        }\r\n                        catch (e) {\r\n                            // if serialization fails return an empty string\r\n                            _throwInternal(logger, 1 /* eLoggingSeverity.CRITICAL */, 48 /* _eInternalMessageId.CannotSerializeObject */, (e && isFunction(e[_DYN_TO_STRING /* @min:%2etoString */])) ? e[_DYN_TO_STRING /* @min:%2etoString */]() : \"Error serializing object\", null, true);\r\n                        }\r\n                    }\r\n                    return output;\r\n                }\r\n                source[circularReferenceCheck] = true;\r\n                objForEachKey(source.aiDataContract, function (field, contract) {\r\n                    var isRequired = (isFunction(contract)) ? (contract() & 1 /* FieldType.Required */) : (contract & 1 /* FieldType.Required */);\r\n                    var isHidden = (isFunction(contract)) ? (contract() & 4 /* FieldType.Hidden */) : (contract & 4 /* FieldType.Hidden */);\r\n                    var isArray = contract & 2 /* FieldType.Array */;\r\n                    var isPresent = source[field] !== undefined;\r\n                    var isObj = isObject(source[field]) && source[field] !== null;\r\n                    if (isRequired && !isPresent && !isArray) {\r\n                        _throwInternal(logger, 1 /* eLoggingSeverity.CRITICAL */, 24 /* _eInternalMessageId.MissingRequiredFieldSpecification */, \"Missing required field specification. The field is required but not present on source\", { field: field, name: name });\r\n                        // If not in debug mode, continue and hope the error is permissible\r\n                    }\r\n                    else if (!isHidden) { // Don't serialize hidden fields\r\n                        var value = void 0;\r\n                        if (isObj) {\r\n                            if (isArray) {\r\n                                // special case; recurse on each object in the source array\r\n                                value = _serializeArray(source[field], field);\r\n                            }\r\n                            else {\r\n                                // recurse on the source object in this field\r\n                                value = _serializeObject(source[field], field);\r\n                            }\r\n                        }\r\n                        else {\r\n                            // assign the source field to the output even if undefined or required\r\n                            value = source[field];\r\n                        }\r\n                        // only emit this field if the value is defined\r\n                        if (value !== undefined) {\r\n                            output[field] = value;\r\n                        }\r\n                    }\r\n                });\r\n                delete source[circularReferenceCheck];\r\n                return output;\r\n            }\r\n            function _serializeArray(sources, name) {\r\n                var output;\r\n                if (!!sources) {\r\n                    if (!isArray(sources)) {\r\n                        _throwInternal(logger, 1 /* eLoggingSeverity.CRITICAL */, 54 /* _eInternalMessageId.ItemNotInArray */, \"This field was specified as an array in the contract but the item is not an array.\\r\\n\", { name: name }, true);\r\n                    }\r\n                    else {\r\n                        output = [];\r\n                        for (var i = 0; i < sources[_DYN_LENGTH /* @min:%2elength */]; i++) {\r\n                            var source = sources[i];\r\n                            var item = _serializeObject(source, name + \"[\" + i + \"]\");\r\n                            output[_DYN_PUSH /* @min:%2epush */](item);\r\n                        }\r\n                    }\r\n                }\r\n                return output;\r\n            }\r\n            function _serializeStringMap(map, expectedType, name) {\r\n                var output;\r\n                if (map) {\r\n                    output = {};\r\n                    objForEachKey(map, function (field, value) {\r\n                        if (expectedType === \"string\") {\r\n                            if (value === undefined) {\r\n                                output[field] = \"undefined\";\r\n                            }\r\n                            else if (value === null) {\r\n                                output[field] = \"null\";\r\n                            }\r\n                            else if (!value[_DYN_TO_STRING /* @min:%2etoString */]) {\r\n                                output[field] = \"invalid field: toString() is not defined.\";\r\n                            }\r\n                            else {\r\n                                output[field] = value[_DYN_TO_STRING /* @min:%2etoString */]();\r\n                            }\r\n                        }\r\n                        else if (expectedType === \"number\") {\r\n                            if (value === undefined) {\r\n                                output[field] = \"undefined\";\r\n                            }\r\n                            else if (value === null) {\r\n                                output[field] = \"null\";\r\n                            }\r\n                            else {\r\n                                var num = parseFloat(value);\r\n                                output[field] = num;\r\n                            }\r\n                        }\r\n                        else {\r\n                            output[field] = \"invalid field: \" + name + \" is of unknown type.\";\r\n                            _throwInternal(logger, 1 /* eLoggingSeverity.CRITICAL */, output[field], null, true);\r\n                        }\r\n                    });\r\n                }\r\n                return output;\r\n            }\r\n        });\r\n    }\r\n// Removed Stub for Serializer.prototype.serialize.\r\n    // This is a workaround for an IE bug when using dynamicProto() with classes that don't have any\n    // non-dynamic functions or static properties/functions when using uglify-js to minify the resulting code.\n    Serializer.__ieDyn=1;\n\n    return Serializer;\r\n}());\r\nexport { Serializer };\r\n//# sourceMappingURL=Serializer.js.map","/*\n * Application Insights JavaScript SDK - Channel, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { _DYN_CONCAT, _DYN_LENGTH } from \"../../__DynamicConstants\";\r\n// (Magic number) DJB algorithm can't work on shorter strings (results in poor distribution\r\nvar MIN_INPUT_LENGTH = 8;\r\nvar HashCodeScoreGenerator = /** @class */ (function () {\r\n    function HashCodeScoreGenerator() {\r\n    }\r\n    HashCodeScoreGenerator.prototype.getHashCodeScore = function (key) {\r\n        var score = this.getHashCode(key) / HashCodeScoreGenerator.INT_MAX_VALUE;\r\n        return score * 100;\r\n    };\r\n    HashCodeScoreGenerator.prototype.getHashCode = function (input) {\r\n        if (input === \"\") {\r\n            return 0;\r\n        }\r\n        while (input[_DYN_LENGTH /* @min:%2elength */] < MIN_INPUT_LENGTH) {\r\n            input = input[_DYN_CONCAT /* @min:%2econcat */](input);\r\n        }\r\n        // 5381 is a magic number: http://stackoverflow.com/questions/10696223/reason-for-5381-number-in-djb-hash-function\r\n        var hash = 5381;\r\n        for (var i = 0; i < input[_DYN_LENGTH /* @min:%2elength */]; ++i) {\r\n            hash = ((hash << 5) + hash) + input.charCodeAt(i);\r\n            // 'hash' is of number type which means 53 bit integer (http://www.ecma-international.org/ecma-262/6.0/#sec-ecmascript-language-types-number-type)\r\n            // 'hash & hash' will keep it 32 bit integer - just to make it clearer what the result is.\r\n            hash = hash & hash;\r\n        }\r\n        return Math.abs(hash);\r\n    };\r\n    // We're using 32 bit math, hence max value is (2^31 - 1)\r\n    HashCodeScoreGenerator.INT_MAX_VALUE = 2147483647;\r\n    return HashCodeScoreGenerator;\r\n}());\r\nexport { HashCodeScoreGenerator };\r\n//# sourceMappingURL=HashCodeScoreGenerator.js.map","/*\n * Application Insights JavaScript SDK - Channel, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { ContextTagKeys } from \"@microsoft/applicationinsights-common\";\r\nimport { _DYN_GET_HASH_CODE_SCORE, _DYN_GET_SAMPLING_SCORE, _DYN_TAGS, _DYN_TRACE_ID } from \"../../__DynamicConstants\";\r\nimport { HashCodeScoreGenerator } from \"./HashCodeScoreGenerator\";\r\nvar SamplingScoreGenerator = /** @class */ (function () {\r\n    function SamplingScoreGenerator() {\r\n        var _self = this;\r\n        var hashCodeGenerator = new HashCodeScoreGenerator();\r\n        var keys = new ContextTagKeys();\r\n        _self[_DYN_GET_SAMPLING_SCORE /* @min:%2egetSamplingScore */] = function (item) {\r\n            var score = 0;\r\n            if (item[_DYN_TAGS /* @min:%2etags */] && item[_DYN_TAGS /* @min:%2etags */][keys.userId]) { // search in tags first, then ext\r\n                score = hashCodeGenerator.getHashCodeScore(item[_DYN_TAGS /* @min:%2etags */][keys.userId]);\r\n            }\r\n            else if (item.ext && item.ext.user && item.ext.user.id) {\r\n                score = hashCodeGenerator[_DYN_GET_HASH_CODE_SCORE /* @min:%2egetHashCodeScore */](item.ext.user.id);\r\n            }\r\n            else if (item[_DYN_TAGS /* @min:%2etags */] && item[_DYN_TAGS /* @min:%2etags */][keys.operationId]) { // search in tags first, then ext\r\n                score = hashCodeGenerator.getHashCodeScore(item[_DYN_TAGS /* @min:%2etags */][keys.operationId]);\r\n            }\r\n            else if (item.ext && item.ext.telemetryTrace && item.ext.telemetryTrace[_DYN_TRACE_ID /* @min:%2etraceID */]) {\r\n                score = hashCodeGenerator.getHashCodeScore(item.ext.telemetryTrace[_DYN_TRACE_ID /* @min:%2etraceID */]);\r\n            }\r\n            else {\r\n                // tslint:disable-next-line:insecure-random\r\n                score = (Math.random() * 100);\r\n            }\r\n            return score;\r\n        };\r\n    }\r\n    return SamplingScoreGenerator;\r\n}());\r\nexport { SamplingScoreGenerator };\r\n//# sourceMappingURL=SamplingScoreGenerator.js.map","/*\n * Application Insights JavaScript SDK - Channel, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { Metric } from \"@microsoft/applicationinsights-common\";\r\nimport { safeGetLogger } from \"@microsoft/applicationinsights-core-js\";\r\nimport { _DYN_DATA_TYPE, _DYN_GET_SAMPLING_SCORE, _DYN_SAMPLE_RATE } from \"../__DynamicConstants\";\r\nimport { SamplingScoreGenerator } from \"./SamplingScoreGenerators/SamplingScoreGenerator\";\r\nvar Sample = /** @class */ (function () {\r\n    function Sample(sampleRate, logger) {\r\n        // We're using 32 bit math, hence max value is (2^31 - 1)\r\n        this.INT_MAX_VALUE = 2147483647;\r\n        var _logger = logger || safeGetLogger(null);\r\n        if (sampleRate > 100 || sampleRate < 0) {\r\n            _logger.throwInternal(2 /* eLoggingSeverity.WARNING */, 58 /* _eInternalMessageId.SampleRateOutOfRange */, \"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.\", { samplingRate: sampleRate }, true);\r\n            sampleRate = 100;\r\n        }\r\n        this[_DYN_SAMPLE_RATE /* @min:%2esampleRate */] = sampleRate;\r\n        this.samplingScoreGenerator = new SamplingScoreGenerator();\r\n    }\r\n    /**\r\n    * Determines if an envelope is sampled in (i.e. will be sent) or not (i.e. will be dropped).\r\n    */\r\n    Sample.prototype.isSampledIn = function (envelope) {\r\n        var samplingPercentage = this[_DYN_SAMPLE_RATE /* @min:%2esampleRate */]; // 0 - 100\r\n        var isSampledIn = false;\r\n        if (samplingPercentage === null || samplingPercentage === undefined || samplingPercentage >= 100) {\r\n            return true;\r\n        }\r\n        else if (envelope.baseType === Metric[_DYN_DATA_TYPE /* @min:%2edataType */]) {\r\n            // exclude MetricData telemetry from sampling\r\n            return true;\r\n        }\r\n        isSampledIn = this.samplingScoreGenerator[_DYN_GET_SAMPLING_SCORE /* @min:%2egetSamplingScore */](envelope) < samplingPercentage;\r\n        return isSampledIn;\r\n    };\r\n    return Sample;\r\n}());\r\nexport { Sample };\r\n//# sourceMappingURL=Sample.js.map","/*\n * Application Insights JavaScript SDK - Common, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { arrReduce, objKeys, strEndsWith } from \"@microsoft/applicationinsights-core-js\";\r\nimport { DEFAULT_BREEZE_ENDPOINT } from \"./Constants\";\r\nimport { _DYN_INGESTIONENDPOINT, _DYN_LENGTH, _DYN_SPLIT, _DYN_TO_LOWER_CASE } from \"./__DynamicConstants\";\r\nvar _FIELDS_SEPARATOR = \";\";\r\nvar _FIELD_KEY_VALUE_SEPARATOR = \"=\";\r\nexport function parseConnectionString(connectionString) {\r\n    if (!connectionString) {\r\n        return {};\r\n    }\r\n    var kvPairs = connectionString[_DYN_SPLIT /* @min:%2esplit */](_FIELDS_SEPARATOR);\r\n    var result = arrReduce(kvPairs, function (fields, kv) {\r\n        var kvParts = kv[_DYN_SPLIT /* @min:%2esplit */](_FIELD_KEY_VALUE_SEPARATOR);\r\n        if (kvParts[_DYN_LENGTH /* @min:%2elength */] === 2) { // only save fields with valid formats\r\n            var key = kvParts[0][_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */]();\r\n            var value = kvParts[1];\r\n            fields[key] = value;\r\n        }\r\n        return fields;\r\n    }, {});\r\n    if (objKeys(result)[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n        // this is a valid connection string, so parse the results\r\n        if (result.endpointsuffix) {\r\n            // apply the default endpoints\r\n            var locationPrefix = result.location ? result.location + \".\" : \"\";\r\n            result[_DYN_INGESTIONENDPOINT /* @min:%2eingestionendpoint */] = result[_DYN_INGESTIONENDPOINT /* @min:%2eingestionendpoint */] || (\"https://\" + locationPrefix + \"dc.\" + result.endpointsuffix);\r\n        }\r\n        // apply user override endpoint or the default endpoints\r\n        result[_DYN_INGESTIONENDPOINT /* @min:%2eingestionendpoint */] = result[_DYN_INGESTIONENDPOINT /* @min:%2eingestionendpoint */] || DEFAULT_BREEZE_ENDPOINT;\r\n        if (strEndsWith(result[_DYN_INGESTIONENDPOINT /* @min:%2eingestionendpoint */], \"/\")) {\r\n            result[_DYN_INGESTIONENDPOINT /* @min:%2eingestionendpoint */] = result[_DYN_INGESTIONENDPOINT /* @min:%2eingestionendpoint */].slice(0, -1);\r\n        }\r\n    }\r\n    return result;\r\n}\r\nexport var ConnectionStringParser = {\r\n    parse: parseConnectionString\r\n};\r\n//# sourceMappingURL=ConnectionStringParser.js.map","/*\n * Application Insights JavaScript Web SDK - Basic, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nvar _a;\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { Sender } from \"@microsoft/applicationinsights-channel-js\";\r\nimport { DEFAULT_BREEZE_PATH, parseConnectionString } from \"@microsoft/applicationinsights-common\";\r\nimport { AppInsightsCore, cfgDfValidate, createDynamicConfig, onConfigChange, proxyFunctions } from \"@microsoft/applicationinsights-core-js\";\r\nimport { createSyncPromise, doAwaitResponse } from \"@nevware21/ts-async\";\r\nimport { isNullOrUndefined, isPromiseLike, isString, objDefine, throwError } from \"@nevware21/ts-utils\";\r\nimport { _DYN_CONNECTION_STRING, _DYN_ENDPOINT_URL, _DYN_INGESTIONENDPOINT, _DYN_INSTRUMENTATIONKEY0, _DYN_INSTRUMENTATION_KEY, _DYN_USER_OVERRIDE_ENDPOI1 } from \"./__DynamicConstants\";\r\nvar UNDEFINED_VALUE = undefined;\r\nvar defaultConfigValues = (_a = {\r\n        diagnosticLogInterval: cfgDfValidate(_chkDiagLevel, 10000)\r\n    },\r\n    _a[_DYN_CONNECTION_STRING /* @min:connectionString */] = UNDEFINED_VALUE,\r\n    _a[_DYN_ENDPOINT_URL /* @min:endpointUrl */] = UNDEFINED_VALUE,\r\n    _a[_DYN_INSTRUMENTATION_KEY /* @min:instrumentationKey */] = UNDEFINED_VALUE,\r\n    _a.extensionConfig = {},\r\n    _a);\r\nfunction _chkDiagLevel(value) {\r\n    // Make sure we have a value > 0\r\n    return value && value > 0;\r\n}\r\n/**\r\n * @export\r\n * @class ApplicationInsights\r\n */\r\nvar ApplicationInsights = /** @class */ (function () {\r\n    /**\r\n     * Creates an instance of ApplicationInsights.\r\n     * @param config\r\n     * @memberof ApplicationInsights\r\n     */\r\n    function ApplicationInsights(config) {\r\n        var core = new AppInsightsCore();\r\n        var _config;\r\n        // initialize the queue and config in case they are undefined\r\n        if (isNullOrUndefined(config) ||\r\n            (isNullOrUndefined(config[_DYN_INSTRUMENTATION_KEY /* @min:%2einstrumentationKey */]) && isNullOrUndefined(config[_DYN_CONNECTION_STRING /* @min:%2econnectionString */]))) {\r\n            throwError(\"Invalid input configuration\");\r\n        }\r\n        dynamicProto(ApplicationInsights, this, function (_self) {\r\n            // Define _self.config\r\n            objDefine(_self, \"config\", {\r\n                g: function () { return _config; }\r\n            });\r\n            _initialize();\r\n            _self.initialize = _initialize;\r\n            _self.track = _track;\r\n            proxyFunctions(_self, core, [\r\n                \"flush\",\r\n                \"pollInternalLogs\",\r\n                \"stopPollingInternalLogs\",\r\n                \"unload\",\r\n                \"getPlugin\",\r\n                \"addPlugin\",\r\n                \"evtNamespace\",\r\n                \"addUnloadCb\",\r\n                \"onCfgChange\",\r\n                \"getTraceCtx\",\r\n                \"updateCfg\",\r\n                \"addTelemetryInitializer\"\r\n            ]);\r\n            function _initialize() {\r\n                var cfgHandler = createDynamicConfig(config || {}, defaultConfigValues);\r\n                _config = cfgHandler.cfg;\r\n                core.addUnloadHook(onConfigChange(cfgHandler, function () {\r\n                    var configCs = _config[_DYN_CONNECTION_STRING /* @min:%2econnectionString */];\r\n                    if (isPromiseLike(configCs)) {\r\n                        var ikeyPromise = createSyncPromise(function (resolve, reject) {\r\n                            doAwaitResponse(configCs, function (res) {\r\n                                var curCs = res.value;\r\n                                var ikey = _config[_DYN_INSTRUMENTATION_KEY /* @min:%2einstrumentationKey */];\r\n                                if (!res.rejected && curCs) {\r\n                                    // replace cs with resolved values in case of circular promises\r\n                                    _config[_DYN_CONNECTION_STRING /* @min:%2econnectionString */] = curCs;\r\n                                    var resolvedCs = parseConnectionString(curCs);\r\n                                    ikey = resolvedCs[_DYN_INSTRUMENTATIONKEY0 /* @min:%2einstrumentationkey */] || ikey;\r\n                                }\r\n                                resolve(ikey);\r\n                            });\r\n                        });\r\n                        var urlPromise = createSyncPromise(function (resolve, reject) {\r\n                            doAwaitResponse(configCs, function (res) {\r\n                                var curCs = res.value;\r\n                                var url = _config[_DYN_ENDPOINT_URL /* @min:%2eendpointUrl */];\r\n                                if (!res.rejected && curCs) {\r\n                                    var resolvedCs = parseConnectionString(curCs);\r\n                                    var ingest = resolvedCs[_DYN_INGESTIONENDPOINT /* @min:%2eingestionendpoint */];\r\n                                    url = ingest ? ingest + DEFAULT_BREEZE_PATH : url;\r\n                                }\r\n                                resolve(url);\r\n                            });\r\n                        });\r\n                        _config[_DYN_INSTRUMENTATION_KEY /* @min:%2einstrumentationKey */] = ikeyPromise;\r\n                        _config[_DYN_ENDPOINT_URL /* @min:%2eendpointUrl */] = _config[_DYN_USER_OVERRIDE_ENDPOI1 /* @min:%2euserOverrideEndpointUrl */] || urlPromise;\r\n                    }\r\n                    if (isString(configCs)) {\r\n                        var cs = parseConnectionString(configCs);\r\n                        var ingest = cs[_DYN_INGESTIONENDPOINT /* @min:%2eingestionendpoint */];\r\n                        _config[_DYN_ENDPOINT_URL /* @min:%2eendpointUrl */] = _config[_DYN_USER_OVERRIDE_ENDPOI1 /* @min:%2euserOverrideEndpointUrl */] ? _config[_DYN_USER_OVERRIDE_ENDPOI1 /* @min:%2euserOverrideEndpointUrl */] : (ingest + DEFAULT_BREEZE_PATH); // only add /v2/track when from connectionstring\r\n                        _config[_DYN_INSTRUMENTATION_KEY /* @min:%2einstrumentationKey */] = cs[_DYN_INSTRUMENTATIONKEY0 /* @min:%2einstrumentationkey */] || _config[_DYN_INSTRUMENTATION_KEY /* @min:%2einstrumentationKey */];\r\n                    }\r\n                    // userOverrideEndpointUrl have the highest priority\r\n                    _config[_DYN_ENDPOINT_URL /* @min:%2eendpointUrl */] = _config[_DYN_USER_OVERRIDE_ENDPOI1 /* @min:%2euserOverrideEndpointUrl */] ? _config[_DYN_USER_OVERRIDE_ENDPOI1 /* @min:%2euserOverrideEndpointUrl */] : _config[_DYN_ENDPOINT_URL /* @min:%2eendpointUrl */];\r\n                }));\r\n                // initialize core\r\n                core.initialize(_config, [new Sender()]);\r\n            }\r\n        });\r\n        function _track(item) {\r\n            if (item) {\r\n                // to pass sender.processTelemetry()\r\n                item.baseData = item.baseData || {};\r\n                item.baseType = item.baseType || \"EventData\";\r\n            }\r\n            core.track(item);\r\n        }\r\n    }\r\n// Removed Stub for ApplicationInsights.prototype.initialize.\r\n// Removed Stub for ApplicationInsights.prototype.track.\r\n// Removed Stub for ApplicationInsights.prototype.flush.\r\n// Removed Stub for ApplicationInsights.prototype.pollInternalLogs.\r\n// Removed Stub for ApplicationInsights.prototype.stopPollingInternalLogs.\r\n// Removed Stub for ApplicationInsights.prototype.unload.\r\n// Removed Stub for ApplicationInsights.prototype.getPlugin.\r\n// Removed Stub for ApplicationInsights.prototype.addPlugin.\r\n// Removed Stub for ApplicationInsights.prototype.evtNamespace.\r\n// Removed Stub for ApplicationInsights.prototype.addUnloadCb.\r\n// Removed Stub for ApplicationInsights.prototype.getTraceCtx.\r\n// Removed Stub for ApplicationInsights.prototype.addTelemetryInitializer.\r\n// Removed Stub for ApplicationInsights.prototype.updateCfg.\r\n// Removed Stub for ApplicationInsights.prototype.onCfgChange.\r\n    // This is a workaround for an IE bug when using dynamicProto() with classes that don't have any\n    // non-dynamic functions or static properties/functions when using uglify-js to minify the resulting code.\n    ApplicationInsights.__ieDyn=1;\n\n    return ApplicationInsights;\r\n}());\r\nexport { ApplicationInsights };\r\nexport { AppInsightsCore, arrForEach, isNullOrUndefined, throwError, proxyFunctions } from \"@microsoft/applicationinsights-core-js\";\r\nexport { SeverityLevel } from \"@microsoft/applicationinsights-common\";\r\nexport { Sender } from \"@microsoft/applicationinsights-channel-js\";\r\n//# sourceMappingURL=index.js.map","/*\n * Application Insights JavaScript Web SDK - Basic, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\n// @skip-file-minify\r\n// ##############################################################\r\n// AUTO GENERATED FILE: This file is Auto Generated during build.\r\n// ##############################################################\r\n// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n// Note: DON'T Export these const from the package as we are still targeting ES3 this will export a mutable variables that someone could change!!!\r\n// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\nexport var _DYN_INSTRUMENTATION_KEY = \"instrumentationKey\"; // Count: 6\r\nexport var _DYN_CONNECTION_STRING = \"connectionString\"; // Count: 4\r\nexport var _DYN_INSTRUMENTATIONKEY0 = \"instrumentationkey\"; // Count: 2\r\nexport var _DYN_ENDPOINT_URL = \"endpointUrl\"; // Count: 6\r\nexport var _DYN_INGESTIONENDPOINT = \"ingestionendpoint\"; // Count: 2\r\nexport var _DYN_USER_OVERRIDE_ENDPOI1 = \"userOverrideEndpointUrl\"; // Count: 5\r\n//# sourceMappingURL=__DynamicConstants.js.map","/*\n * Application Insights JavaScript SDK - Common, 3.3.4\n * Copyright (c) Microsoft and contributors. All rights reserved.\n */\n\r\n\r\nimport { createEnumStyle } from \"@microsoft/applicationinsights-core-js\";\r\n/**\r\n * Defines the level of severity for the event.\r\n */\r\nexport var SeverityLevel = createEnumStyle({\r\n    Verbose: 0 /* eSeverityLevel.Verbose */,\r\n    Information: 1 /* eSeverityLevel.Information */,\r\n    Warning: 2 /* eSeverityLevel.Warning */,\r\n    Error: 3 /* eSeverityLevel.Error */,\r\n    Critical: 4 /* eSeverityLevel.Critical */\r\n});\r\n//# sourceMappingURL=SeverityLevel.js.map","// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\nvar _a;\r\nimport { getGlobal, objCreate, objHasOwnProperty, throwTypeError } from \"@nevware21/ts-utils\";\r\n;\r\nvar UNDEFINED = \"undefined\";\r\n/**\r\n * Constant string defined to support minimization\r\n * @ignore\r\n */\r\nvar Constructor = 'constructor';\r\n/**\r\n * Constant string defined to support minimization\r\n * @ignore\r\n */\r\nvar Prototype = 'prototype';\r\n/**\r\n * Constant string defined to support minimization\r\n * @ignore\r\n */\r\nvar strFunction = 'function';\r\n/**\r\n * Used to define the name of the instance function lookup table\r\n * @ignore\r\n */\r\nvar DynInstFuncTable = '_dynInstFuncs';\r\n/**\r\n * Name used to tag the dynamic prototype function\r\n * @ignore\r\n */\r\nvar DynProxyTag = '_isDynProxy';\r\n/**\r\n * Name added to a prototype to define the dynamic prototype \"class\" name used to lookup the function table\r\n * @ignore\r\n */\r\nvar DynClassName = '_dynClass';\r\n/**\r\n * Prefix added to the classname to avoid any name clashes with other instance level properties\r\n * @ignore\r\n */\r\nvar DynClassNamePrefix = '_dynCls$';\r\n/**\r\n * A tag which is used to check if we have already to attempted to set the instance function if one is not present\r\n * @ignore\r\n */\r\nvar DynInstChkTag = '_dynInstChk';\r\n/**\r\n * A tag which is used to check if we are allows to try and set an instance function is one is not present. Using the same\r\n * tag name as the function level but a different const name for readability only.\r\n */\r\nvar DynAllowInstChkTag = DynInstChkTag;\r\n/**\r\n * The global (imported) instances where the global performance options are stored\r\n */\r\nvar DynProtoDefaultOptions = '_dfOpts';\r\n/**\r\n * Value used as the name of a class when it cannot be determined\r\n * @ignore\r\n */\r\nvar UnknownValue = '_unknown_';\r\n/**\r\n * Constant string defined to support minimization\r\n * @ignore\r\n */\r\nvar str__Proto = \"__proto__\";\r\n/**\r\n * The polyfill version of __proto__ so that it doesn't cause issues for anyone not expecting it to exist\r\n */\r\nvar DynProtoBaseProto = \"_dyn\" + str__Proto;\r\n/**\r\n * Runtime Global holder for dynamicProto settings\r\n */\r\nvar DynProtoGlobalSettings = \"__dynProto$Gbl\";\r\n/**\r\n * Track the current prototype for IE8 as you can't look back to get the prototype\r\n */\r\nvar DynProtoCurrent = \"_dynInstProto\";\r\n/**\r\n * Constant string defined to support minimization\r\n * @ignore\r\n */\r\nvar strUseBaseInst = 'useBaseInst';\r\n/**\r\n * Constant string defined to support minimization\r\n * @ignore\r\n */\r\nvar strSetInstFuncs = 'setInstFuncs';\r\nvar Obj = Object;\r\n/**\r\n * Pre-lookup to check if we are running on a modern browser (i.e. not IE8)\r\n * @ignore\r\n */\r\nvar _objGetPrototypeOf = Obj[\"getPrototypeOf\"];\r\n/**\r\n * Pre-lookup to check for the existence of this function\r\n */\r\nvar _objGetOwnProps = Obj[\"getOwnPropertyNames\"];\r\n// Since 1.1.7 moving these to the runtime global to work around mixed version and module issues\r\n// See Issue https://github.com/microsoft/DynamicProto-JS/issues/57 for details\r\nvar _gbl = getGlobal();\r\nvar _gblInst = _gbl[DynProtoGlobalSettings] || (_gbl[DynProtoGlobalSettings] = {\r\n    o: (_a = {},\r\n        _a[strSetInstFuncs] = true,\r\n        _a[strUseBaseInst] = true,\r\n        _a),\r\n    n: 1000 // Start new global index @ 1000 so we \"fix\" some cases when mixed with 1.1.6 or earlier\r\n});\r\n/**\r\n * Helper used to check whether the target is an Object prototype or Array prototype\r\n * @ignore\r\n */\r\nfunction _isObjectOrArrayPrototype(target) {\r\n    return target && (target === Obj[Prototype] || target === Array[Prototype]);\r\n}\r\n/**\r\n * Helper used to check whether the target is an Object prototype, Array prototype or Function prototype\r\n * @ignore\r\n */\r\nfunction _isObjectArrayOrFunctionPrototype(target) {\r\n    return _isObjectOrArrayPrototype(target) || target === Function[Prototype];\r\n}\r\n/**\r\n * Helper used to get the prototype of the target object as getPrototypeOf is not available in an ES3 environment.\r\n * @ignore\r\n */\r\nfunction _getObjProto(target) {\r\n    var newProto;\r\n    if (target) {\r\n        // This method doesn't exist in older browsers (e.g. IE8)\r\n        if (_objGetPrototypeOf) {\r\n            return _objGetPrototypeOf(target);\r\n        }\r\n        var curProto = target[str__Proto] || target[Prototype] || (target[Constructor] ? target[Constructor][Prototype] : null);\r\n        // Using the pre-calculated value as IE8 doesn't support looking up the prototype of a prototype and thus fails for more than 1 base class\r\n        newProto = target[DynProtoBaseProto] || curProto;\r\n        if (!objHasOwnProperty(target, DynProtoBaseProto)) {\r\n            // As this prototype doesn't have this property then this is from an inherited class so newProto is the base to return so save it\r\n            // so we can look it up value (which for a multiple hierarchy dynamicProto will be the base class)\r\n            delete target[DynProtoCurrent]; // Delete any current value allocated to this instance so we pick up the value from prototype hierarchy\r\n            newProto = target[DynProtoBaseProto] = target[DynProtoCurrent] || target[DynProtoBaseProto];\r\n            target[DynProtoCurrent] = curProto;\r\n        }\r\n    }\r\n    return newProto;\r\n}\r\n/**\r\n * Helper to get the properties of an object, including none enumerable ones as functions on a prototype in ES6\r\n * are not enumerable.\r\n * @param target\r\n */\r\nfunction _forEachProp(target, func) {\r\n    var props = [];\r\n    if (_objGetOwnProps) {\r\n        props = _objGetOwnProps(target);\r\n    }\r\n    else {\r\n        for (var name_1 in target) {\r\n            if (typeof name_1 === \"string\" && objHasOwnProperty(target, name_1)) {\r\n                props.push(name_1);\r\n            }\r\n        }\r\n    }\r\n    if (props && props.length > 0) {\r\n        for (var lp = 0; lp < props.length; lp++) {\r\n            func(props[lp]);\r\n        }\r\n    }\r\n}\r\n/**\r\n * Helper function to check whether the provided function name is a potential candidate for dynamic\r\n * callback and prototype generation.\r\n * @param target The target object, may be a prototype or class object\r\n * @param funcName The function name\r\n * @param skipOwn Skips the check for own property\r\n * @ignore\r\n */\r\nfunction _isDynamicCandidate(target, funcName, skipOwn) {\r\n    return (funcName !== Constructor && typeof target[funcName] === strFunction && (skipOwn || objHasOwnProperty(target, funcName)) && funcName !== str__Proto && funcName !== Prototype);\r\n}\r\n/**\r\n * Helper to throw a TypeError exception\r\n * @param message the message\r\n * @ignore\r\n */\r\nfunction _throwTypeError(message) {\r\n    throwTypeError(\"DynamicProto: \" + message);\r\n}\r\n/**\r\n * Returns a collection of the instance functions that are defined directly on the thisTarget object, it does\r\n * not return any inherited functions\r\n * @param thisTarget The object to get the instance functions from\r\n * @ignore\r\n */\r\nfunction _getInstanceFuncs(thisTarget) {\r\n    // Get the base proto\r\n    var instFuncs = objCreate(null);\r\n    // Save any existing instance functions\r\n    _forEachProp(thisTarget, function (name) {\r\n        // Don't include any dynamic prototype instances - as we only want the real functions\r\n        if (!instFuncs[name] && _isDynamicCandidate(thisTarget, name, false)) {\r\n            // Create an instance callback for passing the base function to the caller\r\n            instFuncs[name] = thisTarget[name];\r\n        }\r\n    });\r\n    return instFuncs;\r\n}\r\n/**\r\n * Returns whether the value is included in the array\r\n * @param values The array of values\r\n * @param value  The value\r\n */\r\nfunction _hasVisited(values, value) {\r\n    for (var lp = values.length - 1; lp >= 0; lp--) {\r\n        if (values[lp] === value) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * Returns an object that contains callback functions for all \"base/super\" functions, this is used to \"save\"\r\n * enabling calling super.xxx() functions without requiring that the base \"class\" has defined a prototype references\r\n * @param target The current instance\r\n * @ignore\r\n */\r\nfunction _getBaseFuncs(classProto, thisTarget, instFuncs, useBaseInst) {\r\n    function _instFuncProxy(target, funcHost, funcName) {\r\n        var theFunc = funcHost[funcName];\r\n        if (theFunc[DynProxyTag] && useBaseInst) {\r\n            // grab and reuse the hosted looking function (if available) otherwise the original passed function\r\n            var instFuncTable = target[DynInstFuncTable] || {};\r\n            if (instFuncTable[DynAllowInstChkTag] !== false) {\r\n                theFunc = (instFuncTable[funcHost[DynClassName]] || {})[funcName] || theFunc;\r\n            }\r\n        }\r\n        return function () {\r\n            // eslint-disable-next-line prefer-rest-params\r\n            return theFunc.apply(target, arguments);\r\n        };\r\n    }\r\n    // Start creating a new baseFuncs by creating proxies for the instance functions (as they may get replaced)\r\n    var baseFuncs = objCreate(null);\r\n    _forEachProp(instFuncs, function (name) {\r\n        // Create an instance callback for passing the base function to the caller\r\n        baseFuncs[name] = _instFuncProxy(thisTarget, instFuncs, name);\r\n    });\r\n    // Get the base prototype functions\r\n    var baseProto = _getObjProto(classProto);\r\n    var visited = [];\r\n    // Don't include base object functions for Object, Array or Function\r\n    while (baseProto && !_isObjectArrayOrFunctionPrototype(baseProto) && !_hasVisited(visited, baseProto)) {\r\n        // look for prototype functions\r\n        _forEachProp(baseProto, function (name) {\r\n            // Don't include any dynamic prototype instances - as we only want the real functions\r\n            // For IE 7/8 the prototype lookup doesn't provide the full chain so we need to bypass the \r\n            // hasOwnProperty check we get all of the methods, main difference is that IE7/8 doesn't return\r\n            // the Object prototype methods while bypassing the check\r\n            if (!baseFuncs[name] && _isDynamicCandidate(baseProto, name, !_objGetPrototypeOf)) {\r\n                // Create an instance callback for passing the base function to the caller\r\n                baseFuncs[name] = _instFuncProxy(thisTarget, baseProto, name);\r\n            }\r\n        });\r\n        // We need to find all possible functions that might be overloaded by walking the entire prototype chain\r\n        // This avoids the caller from needing to check whether it's direct base class implements the function or not\r\n        // by walking the entire chain it simplifies the usage and issues from upgrading any of the base classes.\r\n        visited.push(baseProto);\r\n        baseProto = _getObjProto(baseProto);\r\n    }\r\n    return baseFuncs;\r\n}\r\nfunction _getInstFunc(target, funcName, proto, currentDynProtoProxy) {\r\n    var instFunc = null;\r\n    // We need to check whether the class name is defined directly on this prototype otherwise\r\n    // it will walk the proto chain and return any parent proto classname.\r\n    if (target && objHasOwnProperty(proto, DynClassName)) {\r\n        var instFuncTable = target[DynInstFuncTable] || objCreate(null);\r\n        instFunc = (instFuncTable[proto[DynClassName]] || objCreate(null))[funcName];\r\n        if (!instFunc) {\r\n            // Avoid stack overflow from recursive calling the same function\r\n            _throwTypeError(\"Missing [\" + funcName + \"] \" + strFunction);\r\n        }\r\n        // We have the instance function, lets check it we can speed up further calls\r\n        // by adding the instance function back directly on the instance (avoiding the dynamic func lookup)\r\n        if (!instFunc[DynInstChkTag] && instFuncTable[DynAllowInstChkTag] !== false) {\r\n            // If the instance already has an instance function we can't replace it\r\n            var canAddInst = !objHasOwnProperty(target, funcName);\r\n            // Get current prototype\r\n            var objProto = _getObjProto(target);\r\n            var visited = [];\r\n            // Lookup the function starting at the top (instance level prototype) and traverse down, if the first matching function\r\n            // if nothing is found or if the first hit is a dynamic proto instance then we can safely add an instance shortcut\r\n            while (canAddInst && objProto && !_isObjectArrayOrFunctionPrototype(objProto) && !_hasVisited(visited, objProto)) {\r\n                var protoFunc = objProto[funcName];\r\n                if (protoFunc) {\r\n                    canAddInst = (protoFunc === currentDynProtoProxy);\r\n                    break;\r\n                }\r\n                // We need to find all possible initial functions to ensure that we don't bypass a valid override function\r\n                visited.push(objProto);\r\n                objProto = _getObjProto(objProto);\r\n            }\r\n            try {\r\n                if (canAddInst) {\r\n                    // This instance doesn't have an instance func and the class hierarchy does have a higher level prototype version\r\n                    // so it's safe to directly assign for any subsequent calls (for better performance)\r\n                    target[funcName] = instFunc;\r\n                }\r\n                // Block further attempts to set the instance function for any\r\n                instFunc[DynInstChkTag] = 1;\r\n            }\r\n            catch (e) {\r\n                // Don't crash if the object is readonly or the runtime doesn't allow changing this\r\n                // And set a flag so we don't try again for any function\r\n                instFuncTable[DynAllowInstChkTag] = false;\r\n            }\r\n        }\r\n    }\r\n    return instFunc;\r\n}\r\nfunction _getProtoFunc(funcName, proto, currentDynProtoProxy) {\r\n    var protoFunc = proto[funcName];\r\n    // Check that the prototype function is not a self reference -- try to avoid stack overflow!\r\n    if (protoFunc === currentDynProtoProxy) {\r\n        // It is so lookup the base prototype\r\n        protoFunc = _getObjProto(proto)[funcName];\r\n    }\r\n    if (typeof protoFunc !== strFunction) {\r\n        _throwTypeError(\"[\" + funcName + \"] is not a \" + strFunction);\r\n    }\r\n    return protoFunc;\r\n}\r\n/**\r\n * Add the required dynamic prototype methods to the the class prototype\r\n * @param proto - The class prototype\r\n * @param className - The instance classname\r\n * @param target - The target instance\r\n * @param baseInstFuncs - The base instance functions\r\n * @param setInstanceFunc - Flag to allow prototype function to reset the instance function if one does not exist\r\n * @ignore\r\n */\r\nfunction _populatePrototype(proto, className, target, baseInstFuncs, setInstanceFunc) {\r\n    function _createDynamicPrototype(proto, funcName) {\r\n        var dynProtoProxy = function () {\r\n            // Use the instance or prototype function\r\n            var instFunc = _getInstFunc(this, funcName, proto, dynProtoProxy) || _getProtoFunc(funcName, proto, dynProtoProxy);\r\n            // eslint-disable-next-line prefer-rest-params\r\n            return instFunc.apply(this, arguments);\r\n        };\r\n        // Tag this function as a proxy to support replacing dynamic proxy elements (primary use case is for unit testing\r\n        // via which can dynamically replace the prototype function reference)\r\n        dynProtoProxy[DynProxyTag] = 1;\r\n        return dynProtoProxy;\r\n    }\r\n    if (!_isObjectOrArrayPrototype(proto)) {\r\n        var instFuncTable = target[DynInstFuncTable] = target[DynInstFuncTable] || objCreate(null);\r\n        if (!_isObjectOrArrayPrototype(instFuncTable)) {\r\n            var instFuncs_1 = instFuncTable[className] = (instFuncTable[className] || objCreate(null)); // fetch and assign if as it may not exist yet\r\n            // Set whether we are allow to lookup instances, if someone has set to false then do not re-enable\r\n            if (instFuncTable[DynAllowInstChkTag] !== false) {\r\n                instFuncTable[DynAllowInstChkTag] = !!setInstanceFunc;\r\n            }\r\n            if (!_isObjectOrArrayPrototype(instFuncs_1)) {\r\n                _forEachProp(target, function (name) {\r\n                    // Only add overridden functions\r\n                    if (_isDynamicCandidate(target, name, false) && target[name] !== baseInstFuncs[name]) {\r\n                        // Save the instance Function to the lookup table and remove it from the instance as it's not a dynamic proto function\r\n                        instFuncs_1[name] = target[name];\r\n                        delete target[name];\r\n                        // Add a dynamic proto if one doesn't exist or if a prototype function exists and it's not a dynamic one\r\n                        if (!objHasOwnProperty(proto, name) || (proto[name] && !proto[name][DynProxyTag])) {\r\n                            proto[name] = _createDynamicPrototype(proto, name);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n}\r\n/**\r\n * Checks whether the passed prototype object appears to be correct by walking the prototype hierarchy of the instance\r\n * @param classProto The class prototype instance\r\n * @param thisTarget The current instance that will be checked whether the passed prototype instance is in the hierarchy\r\n * @ignore\r\n */\r\nfunction _checkPrototype(classProto, thisTarget) {\r\n    // This method doesn't existing in older browsers (e.g. IE8)\r\n    if (_objGetPrototypeOf) {\r\n        // As this is primarily a coding time check, don't bother checking if running in IE8 or lower\r\n        var visited = [];\r\n        var thisProto = _getObjProto(thisTarget);\r\n        while (thisProto && !_isObjectArrayOrFunctionPrototype(thisProto) && !_hasVisited(visited, thisProto)) {\r\n            if (thisProto === classProto) {\r\n                return true;\r\n            }\r\n            // This avoids the caller from needing to check whether it's direct base class implements the function or not\r\n            // by walking the entire chain it simplifies the usage and issues from upgrading any of the base classes.\r\n            visited.push(thisProto);\r\n            thisProto = _getObjProto(thisProto);\r\n        }\r\n        return false;\r\n    }\r\n    // If objGetPrototypeOf doesn't exist then just assume everything is ok.\r\n    return true;\r\n}\r\n/**\r\n * Gets the current prototype name using the ES6 name if available otherwise falling back to a use unknown as the name.\r\n * It's not critical for this to return a name, it's used to decorate the generated unique name for easier debugging only.\r\n * @param target\r\n * @param unknownValue\r\n * @ignore\r\n */\r\nfunction _getObjName(target, unknownValue) {\r\n    if (objHasOwnProperty(target, Prototype)) {\r\n        // Look like a prototype\r\n        return target.name || unknownValue || UnknownValue;\r\n    }\r\n    return (((target || {})[Constructor]) || {}).name || unknownValue || UnknownValue;\r\n}\r\n/**\r\n * Helper function when creating dynamic (inline) functions for classes, this helper performs the following tasks :-\r\n * - Saves references to all defined base class functions\r\n * - Calls the delegateFunc with the current target (this) and a base object reference that can be used to call all \"super\" functions.\r\n * - Will populate the class prototype for all overridden functions to support class extension that call the prototype instance.\r\n * Callers should use this helper when declaring all function within the constructor of a class, as mentioned above the delegateFunc is\r\n * passed both the target \"this\" and an object that can be used to call any base (super) functions, using this based object in place of\r\n * super.XXX() (which gets expanded to _super.prototype.XXX()) provides a better minification outcome and also ensures the correct \"this\"\r\n * context is maintained as TypeScript creates incorrect references using super.XXXX() for dynamically defined functions i.e. Functions\r\n * defined in the constructor or some other function (rather than declared as complete typescript functions).\r\n * ### Usage\r\n * ```typescript\r\n * import dynamicProto from \"@microsoft/dynamicproto-js\";\r\n * class ExampleClass extends BaseClass {\r\n *     constructor() {\r\n *         dynamicProto(ExampleClass, this, (_self, base) => {\r\n *             // This will define a function that will be converted to a prototype function\r\n *             _self.newFunc = () => {\r\n *                 // Access any \"this\" instance property\r\n *                 if (_self.someProperty) {\r\n *                     ...\r\n *                 }\r\n *             }\r\n *             // This will define a function that will be converted to a prototype function\r\n *             _self.myFunction = () => {\r\n *                 // Access any \"this\" instance property\r\n *                 if (_self.someProperty) {\r\n *                     // Call the base version of the function that we are overriding\r\n *                     base.myFunction();\r\n *                 }\r\n *                 ...\r\n *             }\r\n *             _self.initialize = () => {\r\n *                 ...\r\n *             }\r\n *             // Warnings: While the following will work as _self is simply a reference to\r\n *             // this, if anyone overrides myFunction() the overridden will be called first\r\n *             // as the normal JavaScript method resolution will occur and the defined\r\n *             // _self.initialize() function is actually gets removed from the instance and\r\n *             // a proxy prototype version is created to reference the created method.\r\n *             _self.initialize();\r\n *         });\r\n *     }\r\n * }\r\n * ```\r\n * @typeparam DPType This is the generic type of the class, used to keep intellisense valid\r\n * @typeparam DPCls The type that contains the prototype of the current class\r\n * @param theClass - This is the current class instance which contains the prototype for the current class\r\n * @param target - The current \"this\" (target) reference, when the class has been extended this.prototype will not be the 'theClass' value.\r\n * @param delegateFunc - The callback function (closure) that will create the dynamic function\r\n * @param options - Additional options to configure how the dynamic prototype operates\r\n */\r\nexport default function dynamicProto(theClass, target, delegateFunc, options) {\r\n    // Make sure that the passed theClass argument looks correct\r\n    if (!objHasOwnProperty(theClass, Prototype)) {\r\n        _throwTypeError(\"theClass is an invalid class definition.\");\r\n    }\r\n    // Quick check to make sure that the passed theClass argument looks correct (this is a common copy/paste error)\r\n    var classProto = theClass[Prototype];\r\n    if (!_checkPrototype(classProto, target)) {\r\n        _throwTypeError(\"[\" + _getObjName(theClass) + \"] not in hierarchy of [\" + _getObjName(target) + \"]\");\r\n    }\r\n    var className = null;\r\n    if (objHasOwnProperty(classProto, DynClassName)) {\r\n        // Only grab the class name if it's defined on this prototype (i.e. don't walk the prototype chain)\r\n        className = classProto[DynClassName];\r\n    }\r\n    else {\r\n        // As not all browser support name on the prototype creating a unique dynamic one if we have not already\r\n        // assigned one, so we can use a simple string as the lookup rather than an object for the dynamic instance\r\n        // function table lookup.\r\n        className = DynClassNamePrefix + _getObjName(theClass, \"_\") + \"$\" + _gblInst.n;\r\n        _gblInst.n++;\r\n        classProto[DynClassName] = className;\r\n    }\r\n    var perfOptions = dynamicProto[DynProtoDefaultOptions];\r\n    var useBaseInst = !!perfOptions[strUseBaseInst];\r\n    if (useBaseInst && options && options[strUseBaseInst] !== undefined) {\r\n        useBaseInst = !!options[strUseBaseInst];\r\n    }\r\n    // Get the current instance functions\r\n    var instFuncs = _getInstanceFuncs(target);\r\n    // Get all of the functions for any base instance (before they are potentially overridden)\r\n    var baseFuncs = _getBaseFuncs(classProto, target, instFuncs, useBaseInst);\r\n    // Execute the delegate passing in both the current target \"this\" and \"base\" function references\r\n    // Note casting the same type as we don't actually have the base class here and this will provide some intellisense support\r\n    delegateFunc(target, baseFuncs);\r\n    // Don't allow setting instance functions for older IE instances\r\n    var setInstanceFunc = !!_objGetPrototypeOf && !!perfOptions[strSetInstFuncs];\r\n    if (setInstanceFunc && options) {\r\n        setInstanceFunc = !!options[strSetInstFuncs];\r\n    }\r\n    // Populate the Prototype for any overridden instance functions\r\n    _populatePrototype(classProto, className, target, instFuncs, setInstanceFunc !== false);\r\n}\r\n/**\r\n * Exposes the default global options to allow global configuration, if the global values are disabled these will override\r\n * any passed values. This is primarily exposed to support unit-testing without the need for individual classes to expose\r\n * their internal usage of dynamic proto.\r\n */\r\ndynamicProto[DynProtoDefaultOptions] = _gblInst.o;\r\n//# sourceMappingURL=DynamicProto.js.map","/*!\n * NevWare21 Solutions LLC - ts-async, 0.5.4\n * https://github.com/nevware21/ts-async\n * Copyright (c) NevWare21 Solutions LLC and contributors. All rights reserved.\n * Licensed under the MIT license.\n */\nimport { isPromiseLike, objDefineProperties, getDocument, createCachedValue, safe, getInst, dumpObj, arrSlice, objDefineProp, hasSymbol, getKnownSymbol, isFunction, throwTypeError, iterForOf, scheduleTimeout, isNode, getWindow, getGlobal, objDefine, objToString, isUndefined, isArray, arrForEach, isIterable, createCustomError, isNumber, scheduleIdleCallback, utcNow, getLength, isIterator, fnCall, arrIndexOf } from '@nevware21/ts-utils';\n\nvar STR_PROMISE = \"Promise\";\nvar DONE = \"done\";\nvar VALUE = \"value\";\nvar RETURN = \"return\";\nvar REJECTED = \"rejected\";\n\nfunction doAwaitResponse(value, cb) {\n    return doAwait(value, function (value) {\n        return cb ? cb({\n            status: \"fulfilled\",\n            rejected: false,\n            value: value\n        }) : value;\n    }, function (reason) {\n        return cb ? cb({\n            status: REJECTED,\n            rejected: true,\n            reason: reason\n        }) : reason;\n    });\n}\nfunction doAwait(value, resolveFn, rejectFn, finallyFn) {\n    var result = value;\n    try {\n        if (isPromiseLike(value)) {\n            if (resolveFn || rejectFn) {\n                result = value.then(resolveFn, rejectFn);\n            }\n        }\n        else {\n            try {\n                if (resolveFn) {\n                    result = resolveFn(value);\n                }\n            }\n            catch (err) {\n                if (rejectFn) {\n                    result = rejectFn(err);\n                }\n                else {\n                    throw err;\n                }\n            }\n        }\n    }\n    finally {\n        if (finallyFn) {\n            doFinally(result, finallyFn);\n        }\n    }\n    return result;\n}\nfunction doFinally(value, finallyFn) {\n    var result = value;\n    if (finallyFn) {\n        if (isPromiseLike(value)) {\n            if (value.finally) {\n                result = value.finally(finallyFn);\n            }\n            else {\n                result = value.then(function (value) {\n                    finallyFn();\n                    return value;\n                }, function (reason) {\n                    finallyFn();\n                    throw reason;\n                });\n            }\n        }\n        else {\n            finallyFn();\n        }\n    }\n    return result;\n}\n\n/*#__NO_SIDE_EFFECTS__*/\nfunction _pureAssign(func1, func2) {\n    return func1 || func2;\n}\n\nvar _debugState;\nvar _debugResult;\nvar _debugHandled;\nvar _promiseDebugEnabled = false;\nfunction _addDebugState$1(thePromise, stateFn, resultFn, handledFn) {\n    _debugState = _debugState || { toString: function () { return \"[[PromiseState]]\"; } };\n    _debugResult = _debugResult || { toString: function () { return \"[[PromiseResult]]\"; } };\n    _debugHandled = _debugHandled || { toString: function () { return \"[[PromiseIsHandled]]\"; } };\n    var props = {};\n    props[_debugState] = { get: stateFn };\n    props[_debugResult] = { get: resultFn };\n    props[_debugHandled] = { get: handledFn };\n    objDefineProperties(thePromise, props);\n}\nfunction setPromiseDebugState(enabled, logger) {\n    _promiseDebugEnabled = enabled;\n}\n\nvar STRING_STATES =  [\n    \"pending\", \"resolving\", \"resolved\", REJECTED\n];\n\nvar DISPATCH_EVENT = \"dispatchEvent\";\nvar _hasInitEvent;\nfunction _hasInitEventFn(doc) {\n    var evt;\n    if (doc && doc.createEvent) {\n        evt = doc.createEvent(\"Event\");\n    }\n    return (!!evt && evt.initEvent);\n}\nfunction emitEvent(target, evtName, populateEvent, useNewEvent) {\n    var doc = getDocument();\n    !_hasInitEvent && (_hasInitEvent = createCachedValue(!!safe(_hasInitEventFn, [doc]).v));\n    var theEvt = _hasInitEvent.v ? doc.createEvent(\"Event\") : (useNewEvent ? new Event(evtName) : {});\n    populateEvent && populateEvent(theEvt);\n    if (_hasInitEvent.v) {\n        theEvt.initEvent(evtName, false, true);\n    }\n    if (theEvt && target[DISPATCH_EVENT]) {\n        target[DISPATCH_EVENT](theEvt);\n    }\n    else {\n        var handler = target[\"on\" + evtName];\n        if (handler) {\n            handler(theEvt);\n        }\n        else {\n            var theConsole = getInst(\"console\");\n            theConsole && (theConsole[\"error\"] || theConsole[\"log\"])(evtName, dumpObj(theEvt));\n        }\n    }\n}\n\nvar NODE_UNHANDLED_REJECTION = \"unhandledRejection\";\nvar UNHANDLED_REJECTION = NODE_UNHANDLED_REJECTION.toLowerCase();\nvar _currentPromiseId = [];\nvar _uniquePromiseId = 0;\nvar _unhandledRejectionTimeout = 10;\nvar _aggregationError;\nvar _hasPromiseRejectionEvent;\nfunction dumpFnObj(value) {\n    if (isFunction(value)) {\n        return value.toString();\n    }\n    return dumpObj(value);\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction _createAggregationError(values) {\n    !_aggregationError && (_aggregationError = createCachedValue(safe(getInst, [\"AggregationError\"]).v || createCustomError(\"AggregationError\", function (self, args) {\n        self.errors = args[0];\n    })));\n    return new _aggregationError.v(values);\n}\nfunction _createPromise(newPromise, processor, executor) {\n    var additionalArgs = arrSlice(arguments, 3);\n    var _state = 0 ;\n    var _hasResolved = false;\n    var _settledValue;\n    var _queue = [];\n    var _id = _uniquePromiseId++;\n    var _parentId = _currentPromiseId.length > 0 ? _currentPromiseId[_currentPromiseId.length - 1] : undefined;\n    var _handled = false;\n    var _unHandledRejectionHandler = null;\n    var _thePromise;\n    function _then(onResolved, onRejected) {\n        try {\n            _currentPromiseId.push(_id);\n            _handled = true;\n            _unHandledRejectionHandler && _unHandledRejectionHandler.cancel();\n            _unHandledRejectionHandler = null;\n            var thenPromise = newPromise(function (resolve, reject) {\n                _queue.push(function () {\n                    try {\n                        var handler = _state === 2  ? onResolved : onRejected;\n                        var value = isUndefined(handler) ? _settledValue : (isFunction(handler) ? handler(_settledValue) : handler);\n                        if (isPromiseLike(value)) {\n                            value.then(resolve, reject);\n                        }\n                        else if (handler) {\n                            resolve(value);\n                        }\n                        else if (_state === 3 ) {\n                            reject(value);\n                        }\n                        else {\n                            resolve(value);\n                        }\n                    }\n                    catch (e) {\n                        reject(e);\n                    }\n                });\n                if (_hasResolved) {\n                    _processQueue();\n                }\n            }, additionalArgs);\n            return thenPromise;\n        }\n        finally {\n            _currentPromiseId.pop();\n        }\n    }\n    function _catch(onRejected) {\n        return _then(undefined, onRejected);\n    }\n    function _finally(onFinally) {\n        var thenFinally = onFinally;\n        var catchFinally = onFinally;\n        if (isFunction(onFinally)) {\n            thenFinally = function (value) {\n                onFinally && onFinally();\n                return value;\n            };\n            catchFinally = function (reason) {\n                onFinally && onFinally();\n                throw reason;\n            };\n        }\n        return _then(thenFinally, catchFinally);\n    }\n    function _strState() {\n        return STRING_STATES[_state];\n    }\n    function _processQueue() {\n        if (_queue.length > 0) {\n            var pending = _queue.slice();\n            _queue = [];\n            _handled = true;\n            _unHandledRejectionHandler && _unHandledRejectionHandler.cancel();\n            _unHandledRejectionHandler = null;\n            processor(pending);\n        }\n    }\n    function _createSettleIfFn(newState, allowState) {\n        return function (theValue) {\n            if (_state === allowState) {\n                if (newState === 2  && isPromiseLike(theValue)) {\n                    _state = 1 ;\n                    theValue.then(_createSettleIfFn(2 , 1 ), _createSettleIfFn(3 , 1 ));\n                    return;\n                }\n                _state = newState;\n                _hasResolved = true;\n                _settledValue = theValue;\n                _processQueue();\n                if (!_handled && newState === 3  && !_unHandledRejectionHandler) {\n                    _unHandledRejectionHandler = scheduleTimeout(_notifyUnhandledRejection, _unhandledRejectionTimeout);\n                }\n            }\n        };\n    }\n    function _notifyUnhandledRejection() {\n        if (!_handled) {\n            _handled = true;\n            if (isNode()) {\n                process.emit(NODE_UNHANDLED_REJECTION, _settledValue, _thePromise);\n            }\n            else {\n                var gbl = getWindow() || getGlobal();\n                !_hasPromiseRejectionEvent && (_hasPromiseRejectionEvent = createCachedValue(safe((getInst), [STR_PROMISE + \"RejectionEvent\"]).v));\n                emitEvent(gbl, UNHANDLED_REJECTION, function (theEvt) {\n                    objDefine(theEvt, \"promise\", { g: function () { return _thePromise; } });\n                    theEvt.reason = _settledValue;\n                    return theEvt;\n                }, !!_hasPromiseRejectionEvent.v);\n            }\n        }\n    }\n    _thePromise = {\n        then: _then,\n        \"catch\": _catch,\n        finally: _finally\n    };\n    objDefineProp(_thePromise, \"state\", {\n        get: _strState\n    });\n    if (_promiseDebugEnabled) {\n        _addDebugState$1(_thePromise, _strState, function () { return objToString(_settledValue); }, function () { return _handled; });\n    }\n    if (hasSymbol()) {\n        _thePromise[getKnownSymbol(11 )] = \"IPromise\";\n    }\n    function _toString() {\n        return \"IPromise\" + (_promiseDebugEnabled ? \"[\" + _id + (!isUndefined(_parentId) ? (\":\" + _parentId) : \"\") + \"]\" : \"\") + \" \" + _strState() + (_hasResolved ? (\" - \" + dumpFnObj(_settledValue)) : \"\") + (\"\");\n    }\n    _thePromise.toString = _toString;\n    (function _initialize() {\n        if (!isFunction(executor)) {\n            throwTypeError(STR_PROMISE + \": executor is not a function - \" + dumpFnObj(executor));\n        }\n        var _rejectFn = _createSettleIfFn(3 , 0 );\n        try {\n            executor.call(_thePromise, _createSettleIfFn(2 , 0 ), _rejectFn);\n        }\n        catch (e) {\n            _rejectFn(e);\n        }\n    })();\n    return _thePromise;\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction _createAllPromise(newPromise) {\n    return function (input) {\n        var additionalArgs = arrSlice(arguments, 1);\n        return newPromise(function (resolve, reject) {\n            try {\n                var values_1 = [];\n                var pending_1 = 1;\n                iterForOf(input, function (item, idx) {\n                    if (item) {\n                        pending_1++;\n                        doAwait(item, function (value) {\n                            values_1[idx] = value;\n                            if (--pending_1 === 0) {\n                                resolve(values_1);\n                            }\n                        }, reject);\n                    }\n                });\n                pending_1--;\n                if (pending_1 === 0) {\n                    resolve(values_1);\n                }\n            }\n            catch (e) {\n                reject(e);\n            }\n        }, additionalArgs);\n    };\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction _createResolvedPromise(newPromise) {\n    return function (value) {\n        var additionalArgs = arrSlice(arguments, 1);\n        if (isPromiseLike(value)) {\n            return value;\n        }\n        return newPromise(function (resolve) {\n            resolve(value);\n        }, additionalArgs);\n    };\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction _createRejectedPromise(newPromise) {\n    return function (reason) {\n        var additionalArgs = arrSlice(arguments, 1);\n        return newPromise(function (_resolve, reject) {\n            reject(reason);\n        }, additionalArgs);\n    };\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction _createAllSettledPromise(newPromise) {\n    return createCachedValue(function (input) {\n        var additionalArgs = arrSlice(arguments, 1);\n        return newPromise(function (resolve, reject) {\n            var values = [];\n            var pending = 1;\n            function processItem(item, idx) {\n                pending++;\n                doAwaitResponse(item, function (value) {\n                    if (value.rejected) {\n                        values[idx] = {\n                            status: REJECTED,\n                            reason: value.reason\n                        };\n                    }\n                    else {\n                        values[idx] = {\n                            status: \"fulfilled\",\n                            value: value.value\n                        };\n                    }\n                    if (--pending === 0) {\n                        resolve(values);\n                    }\n                });\n            }\n            try {\n                if (isArray(input)) {\n                    arrForEach(input, processItem);\n                }\n                else if (isIterable(input)) {\n                    iterForOf(input, processItem);\n                }\n                else {\n                    throwTypeError(\"Input is not an iterable\");\n                }\n                pending--;\n                if (pending === 0) {\n                    resolve(values);\n                }\n            }\n            catch (e) {\n                reject(e);\n            }\n        }, additionalArgs);\n    });\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction _createRacePromise(newPromise) {\n    return createCachedValue(function (input) {\n        var additionalArgs = arrSlice(arguments, 1);\n        return newPromise(function (resolve, reject) {\n            var isDone = false;\n            function processItem(item) {\n                doAwaitResponse(item, function (value) {\n                    if (!isDone) {\n                        isDone = true;\n                        if (value.rejected) {\n                            reject(value.reason);\n                        }\n                        else {\n                            resolve(value.value);\n                        }\n                    }\n                });\n            }\n            try {\n                if (isArray(input)) {\n                    arrForEach(input, processItem);\n                }\n                else if (isIterable(input)) {\n                    iterForOf(input, processItem);\n                }\n                else {\n                    throwTypeError(\"Input is not an iterable\");\n                }\n            }\n            catch (e) {\n                reject(e);\n            }\n        }, additionalArgs);\n    });\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction _createAnyPromise(newPromise) {\n    return createCachedValue(function (input) {\n        var additionalArgs = arrSlice(arguments, 1);\n        return newPromise(function (resolve, reject) {\n            var theErros = [];\n            var pending = 1;\n            var isDone = false;\n            function processItem(item, idx) {\n                pending++;\n                doAwaitResponse(item, function (value) {\n                    if (!value.rejected) {\n                        isDone = true;\n                        resolve(value.value);\n                        return;\n                    }\n                    else {\n                        theErros[idx] = value.reason;\n                    }\n                    if (--pending === 0 && !isDone) {\n                        reject(_createAggregationError(theErros));\n                    }\n                });\n            }\n            try {\n                if (isArray(input)) {\n                    arrForEach(input, processItem);\n                }\n                else if (isIterable(input)) {\n                    iterForOf(input, processItem);\n                }\n                else {\n                    throwTypeError(\"Input is not an iterable\");\n                }\n                pending--;\n                if (pending === 0 && !isDone) {\n                    reject(_createAggregationError(theErros));\n                }\n            }\n            catch (e) {\n                reject(e);\n            }\n        }, additionalArgs);\n    });\n}\n\nfunction syncItemProcessor(pending) {\n    arrForEach(pending, function (fn) {\n        try {\n            fn();\n        }\n        catch (e) {\n        }\n    });\n}\nfunction timeoutItemProcessor(timeout) {\n    var callbackTimeout = isNumber(timeout) ? timeout : 0;\n    return function (pending) {\n        scheduleTimeout(function () {\n            syncItemProcessor(pending);\n        }, callbackTimeout);\n    };\n}\nfunction idleItemProcessor(timeout) {\n    var options;\n    if (timeout >= 0) {\n        options = {\n            timeout: +timeout\n        };\n    }\n    return function (pending) {\n        scheduleIdleCallback(function (deadline) {\n            syncItemProcessor(pending);\n        }, options);\n    };\n}\n\nvar _allAsyncSettledCreator;\nvar _raceAsyncCreator;\nvar _anyAsyncCreator;\nfunction createAsyncPromise(executor, timeout) {\n    return _createPromise(createAsyncPromise, timeoutItemProcessor(timeout), executor, timeout);\n}\nvar createAsyncAllPromise = /*#__PURE__*/ _createAllPromise(createAsyncPromise);\nvar createAsyncResolvedPromise = /*#__PURE__*/ _createResolvedPromise(createAsyncPromise);\nvar createAsyncRejectedPromise = /*#__PURE__*/ _createRejectedPromise(createAsyncPromise);\nfunction createAsyncAllSettledPromise(input, timeout) {\n    !_allAsyncSettledCreator && (_allAsyncSettledCreator = _createAllSettledPromise(createAsyncPromise));\n    return _allAsyncSettledCreator.v(input, timeout);\n}\nfunction createAsyncRacePromise(values, timeout) {\n    !_raceAsyncCreator && (_raceAsyncCreator = _createRacePromise(createAsyncPromise));\n    return _raceAsyncCreator.v(values, timeout);\n}\nfunction createAsyncAnyPromise(values, timeout) {\n    !_anyAsyncCreator && (_anyAsyncCreator = _createAnyPromise(createAsyncPromise));\n    return _anyAsyncCreator.v(values, timeout);\n}\n\nvar _promiseCls;\nvar _allCreator;\nvar _allNativeSettledCreator;\nvar _raceNativeCreator;\nvar _anyNativeCreator;\n/*#__NO_SIDE_EFFECTS__*/\nfunction _createNativePromiseHelper(name, func) {\n    !_promiseCls && (_promiseCls = createCachedValue((safe(getInst, [STR_PROMISE]).v) || null));\n    if (_promiseCls.v && _promiseCls.v[name]) {\n        return createCachedValue(function (input, timeout) {\n            return createNativePromise(function (resolve, reject) {\n                _promiseCls.v[name](input).then(resolve, reject);\n            });\n        });\n    }\n    return func();\n}\nfunction createNativePromise(executor, timeout) {\n    !_promiseCls && (_promiseCls = createCachedValue((safe(getInst, [STR_PROMISE]).v) || null));\n    var PrmCls = _promiseCls.v;\n    if (!PrmCls) {\n        return createAsyncPromise(executor);\n    }\n    if (!isFunction(executor)) {\n        throwTypeError(STR_PROMISE + \": executor is not a function - \" + dumpObj(executor));\n    }\n    var _state = 0 ;\n    function _strState() {\n        return STRING_STATES[_state];\n    }\n    var thePromise = new PrmCls(function (resolve, reject) {\n        function _resolve(value) {\n            _state = 2 ;\n            resolve(value);\n        }\n        function _reject(reason) {\n            _state = 3 ;\n            reject(reason);\n        }\n        executor(_resolve, _reject);\n    });\n    objDefineProp(thePromise, \"state\", {\n        get: _strState\n    });\n    return thePromise;\n}\nfunction createNativeAllPromise(input, timeout) {\n    !_allCreator && (_allCreator = _createNativePromiseHelper(\"all\", function () { return createCachedValue(_createAllPromise(createNativePromise)); }));\n    return _allCreator.v(input, timeout);\n}\nvar createNativeResolvedPromise = /*#__PURE__*/ _createResolvedPromise(createNativePromise);\nvar createNativeRejectedPromise = /*#__PURE__*/ _createRejectedPromise(createNativePromise);\nfunction createNativeAllSettledPromise(input, timeout) {\n    !_allNativeSettledCreator && (_allNativeSettledCreator = _createNativePromiseHelper(\"allSettled\", function () { return _createAllSettledPromise(createNativePromise); }));\n    return _allNativeSettledCreator.v(input, timeout);\n}\nfunction createNativeRacePromise(values, timeout) {\n    !_raceNativeCreator && (_raceNativeCreator = _createNativePromiseHelper(\"race\", function () { return _createRacePromise(createNativePromise); }));\n    return _raceNativeCreator.v(values, timeout);\n}\nfunction createNativeAnyPromise(values, timeout) {\n    !_anyNativeCreator && (_anyNativeCreator = _createNativePromiseHelper(\"any\", function () { return _createAnyPromise(createNativePromise); }));\n    return _anyNativeCreator.v(values, timeout);\n}\n\nvar _allSyncSettledCreator;\nvar _raceSyncCreator;\nvar _anySyncCreator;\nfunction createSyncPromise(executor) {\n    return _createPromise(createSyncPromise, syncItemProcessor, executor);\n}\nvar createSyncAllPromise = /*#__PURE__*/ _createAllPromise(createSyncPromise);\nvar createSyncResolvedPromise = /*#__PURE__*/ _createResolvedPromise(createSyncPromise);\nvar createSyncRejectedPromise = /*#__PURE__*/ _createRejectedPromise(createSyncPromise);\nfunction createSyncAllSettledPromise(input, timeout) {\n    !_allSyncSettledCreator && (_allSyncSettledCreator = _createAllSettledPromise(createSyncPromise));\n    return _allSyncSettledCreator.v(input, timeout);\n}\nfunction createSyncRacePromise(values, timeout) {\n    !_raceSyncCreator && (_raceSyncCreator = _createRacePromise(createSyncPromise));\n    return _raceSyncCreator.v(values, timeout);\n}\nfunction createSyncAnyPromise(values, timeout) {\n    !_anySyncCreator && (_anySyncCreator = _createAnyPromise(createSyncPromise));\n    return _anySyncCreator.v(values, timeout);\n}\n\nvar _defaultIdleTimeout;\nvar _allIdleSettledCreator;\nvar _raceIdleCreator;\nvar _anyIdleCreator;\nfunction setDefaultIdlePromiseTimeout(idleDeadline) {\n    _defaultIdleTimeout = idleDeadline;\n}\nvar setDefaultIdleTimeout = ( /*#__PURE__*/_pureAssign(setDefaultIdlePromiseTimeout));\nfunction createIdlePromise(executor, timeout) {\n    var theTimeout = isUndefined(timeout) ? _defaultIdleTimeout : timeout;\n    return _createPromise(createIdlePromise, idleItemProcessor(theTimeout), executor, theTimeout);\n}\nvar createIdleAllPromise = /*#__PURE__*/ _createAllPromise(createIdlePromise);\nvar createIdleResolvedPromise = /*#__PURE__*/ _createResolvedPromise(createIdlePromise);\nvar createIdleRejectedPromise = /*#__PURE__*/ _createRejectedPromise(createIdlePromise);\nfunction createIdleAllSettledPromise(input, timeout) {\n    !_allIdleSettledCreator && (_allIdleSettledCreator = _createAllSettledPromise(createIdlePromise));\n    return _allIdleSettledCreator.v(input, timeout);\n}\nfunction createIdleRacePromise(values, timeout) {\n    !_raceIdleCreator && (_raceIdleCreator = _createRacePromise(createIdlePromise));\n    return _raceIdleCreator.v(values, timeout);\n}\nfunction createIdleAnyPromise(values, timeout) {\n    !_anyIdleCreator && (_anyIdleCreator = _createAnyPromise(createIdlePromise));\n    return _anyIdleCreator.v(values, timeout);\n}\n\nvar _promiseCreator;\nvar _allSettledCreator;\nvar _raceCreator;\nvar _anyCreator;\nfunction setCreatePromiseImpl(creator) {\n    _promiseCreator = creator ? createCachedValue(creator) : null;\n}\nfunction createPromise(executor, timeout) {\n    !_promiseCreator && (_promiseCreator = createCachedValue(createNativePromise));\n    return _promiseCreator.v.call(this, executor, timeout);\n}\nvar createAllPromise = /*#__PURE__*/ _createAllPromise(createPromise);\nvar createResolvedPromise = /*#__PURE__*/ _createResolvedPromise(createPromise);\nvar createRejectedPromise = /*#__PURE__*/ _createRejectedPromise(createPromise);\nfunction createAllSettledPromise(input, timeout) {\n    !_allSettledCreator && (_allSettledCreator = _createAllSettledPromise(createPromise));\n    return _allSettledCreator.v(input, timeout);\n}\nfunction createRacePromise(values, timeout) {\n    !_raceCreator && (_raceCreator = _createRacePromise(createPromise));\n    return _raceCreator.v(values, timeout);\n}\nfunction createAnyPromise(values, timeout) {\n    !_anyCreator && (_anyCreator = _createAnyPromise(createPromise));\n    return _anyCreator.v(values, timeout);\n}\n\nfunction createTimeoutPromise(timeout, resolveReject, message) {\n    return createPromise(function (resolve, reject) {\n        scheduleTimeout(function () {\n            (resolveReject ? resolve : reject)(!isUndefined(message) ? message : \"Timeout of \" + timeout + \"ms exceeded\");\n        }, timeout);\n    });\n}\n\nfunction _doneChk(isDone, state, value, thisArg) {\n    var result = isDone;\n    state.res = value;\n    if (!result) {\n        if (state.isDone && isFunction(state.isDone)) {\n            return doAwait(state.isDone.call(thisArg, state), function (done) {\n                state.iter++;\n                return !!done;\n            });\n        }\n        else {\n            result = !!state.isDone;\n        }\n    }\n    state.iter++;\n    return result;\n}\nfunction doWhileAsync(callbackFn, isDoneFn, thisArg) {\n    var promise;\n    var resolve;\n    var reject = function (reason) {\n        isDone = true;\n        throw reason;\n    };\n    var isDone = false;\n    var state = {\n        st: utcNow(),\n        iter: 0,\n        isDone: isDoneFn || false\n    };\n    if (callbackFn) {\n        var _createPromise_1 = function () {\n            return createPromise(function (res, rej) {\n                resolve = res;\n                reject = rej;\n            });\n        };\n        var _handleAsyncDone_1 = function (done) {\n            isDone = !!done;\n            if (!isDone) {\n                _processNext_1();\n            }\n            else {\n                resolve(state.res);\n            }\n        };\n        var _processNext_1 = function () {\n            while (!isDone) {\n                try {\n                    var cbResult = callbackFn.call(thisArg, state);\n                    if (isPromiseLike(cbResult)) {\n                        promise = promise || _createPromise_1();\n                        doAwait(cbResult, function (res) {\n                            try {\n                                doAwait(_doneChk(isDone, state, res, thisArg), _handleAsyncDone_1, reject);\n                            }\n                            catch (e) {\n                                reject(e);\n                            }\n                        }, reject);\n                        return promise;\n                    }\n                    else {\n                        var dnRes = _doneChk(isDone, state, cbResult, thisArg);\n                        if (isPromiseLike(dnRes)) {\n                            promise = promise || _createPromise_1();\n                            doAwait(dnRes, _handleAsyncDone_1, reject);\n                            return promise;\n                        }\n                        else {\n                            isDone = !!dnRes;\n                        }\n                    }\n                }\n                catch (e) {\n                    reject(e);\n                    return promise;\n                }\n            }\n            if (isDone && resolve) {\n                resolve(state.res);\n            }\n            return promise || state.res;\n        };\n        return _processNext_1();\n    }\n}\n\nfunction arrForEachAsync(theArray, callbackFn, thisArg) {\n    if (theArray) {\n        var len_1 = getLength(theArray);\n        if (len_1) {\n            var isDone = function (state) {\n                if (state.iter >= len_1 || state.res === -1) {\n                    return true;\n                }\n            };\n            return doWhileAsync(function (state) {\n                var idx = state.iter;\n                if (idx in theArray) {\n                    return callbackFn.call(thisArg || theArray, theArray[idx], idx, theArray);\n                }\n            }, isDone);\n        }\n    }\n}\n\nvar _iterSymbol;\nvar _iterAsyncSymbol;\nfunction iterForOfAsync(iter, callbackFn, thisArg) {\n    var err;\n    var iterResult;\n    var theIter = iter;\n    function onFailed(failed) {\n        err = { e: failed };\n        if (theIter.throw) {\n            iterResult = null;\n            theIter.throw(err);\n        }\n        throw failed;\n    }\n    function onFinally() {\n        try {\n            if (iterResult && !iterResult[DONE]) {\n                theIter[RETURN] && theIter[RETURN](iterResult);\n            }\n        }\n        finally {\n            if (err) {\n                throw err.e;\n            }\n        }\n    }\n    if (iter) {\n        if (!isIterator(iter)) {\n            !_iterAsyncSymbol && (_iterAsyncSymbol = createCachedValue(getKnownSymbol(0 )));\n            theIter = iter[_iterAsyncSymbol.v] ? iter[_iterAsyncSymbol.v]() : null;\n            if (!theIter) {\n                !_iterSymbol && (_iterSymbol = createCachedValue(getKnownSymbol(3 )));\n                theIter = iter[_iterSymbol.v] ? iter[_iterSymbol.v]() : null;\n            }\n        }\n        if (theIter && isIterator(theIter)) {\n            var result = void 0;\n            try {\n                result = doWhileAsync(function (state) {\n                    return doAwait(theIter.next(), function (res) {\n                        iterResult = res;\n                        if (!res[DONE]) {\n                            return fnCall(callbackFn, thisArg || theIter, iterResult[VALUE], state.iter, theIter);\n                        }\n                    }, function (reason) {\n                        state.isDone = true;\n                        onFailed(reason);\n                    });\n                }, function (state) {\n                    if (!iterResult || iterResult[DONE] || state.res === -1) {\n                        onFinally();\n                        return true;\n                    }\n                }, thisArg || theIter);\n                if (isPromiseLike(result)) {\n                    result = doFinally(result.catch(onFailed), onFinally);\n                }\n                return result;\n            }\n            catch (failed) {\n                onFailed(failed);\n            }\n            finally {\n                if (result && !isPromiseLike(result)) {\n                    onFinally();\n                }\n            }\n        }\n    }\n}\n\nvar REJECT = \"reject\";\nvar REJECTED_ERROR = \"Rejected\";\nvar _schedulerId = 0;\nvar _debugName;\nvar _debugIntState;\nvar _customErrors = {};\nfunction _rejectDone() {\n}\nfunction _createError(type, evt, message) {\n    !_customErrors[type] && (_customErrors[type] = createCustomError(type));\n    var now = utcNow();\n    return new (_customErrors[type])(\"Task [\".concat(evt.id, \"] \").concat(message || \"\", \"- \").concat((evt.st ? \"Running\" : \"Waiting\"), \": \").concat(_calcTime(now, evt.st || evt.cr)));\n}\nfunction _calcTime(now, start) {\n    return ((now - start) || \"0\") + \" ms\";\n}\nfunction _abortStaleTasks(taskQueue, staleTimeoutPeriod) {\n    var now = utcNow();\n    var expired = now - staleTimeoutPeriod;\n    arrForEach(taskQueue, function (evt) {\n        if (evt && !evt.rj && (evt.st && evt.st < expired) || (!evt.st && evt.cr && evt.cr < expired)) {\n            evt && evt[REJECT](evt.rj || _createError(\"Aborted\", evt, \"Stale \"));\n        }\n    });\n}\nfunction _removeTask(queue, taskDetail) {\n    var idx = arrIndexOf(queue, taskDetail);\n    if (idx !== -1) {\n        queue.splice(idx, 1);\n    }\n}\nfunction _addDebugState(theScheduler, nameFn, stateFn) {\n    _debugName = _debugName || { toString: function () { return \"[[SchedulerName]]\"; } };\n    _debugIntState = _debugIntState || { toString: function () { return \"[[SchedulerState]]\"; } };\n    objDefineProp(theScheduler, _debugName, { get: nameFn });\n    objDefineProp(theScheduler, _debugIntState, { get: stateFn });\n}\nfunction createTaskScheduler(newPromise, name) {\n    var _theTask;\n    var _running = [];\n    var _waiting = [];\n    var _staleTimeoutPeriod = 600000;\n    var _staleTimeoutCheckPeriod = _staleTimeoutPeriod / 10;\n    var _taskCount = 0;\n    var _schedulerName = (name ? (name + \".\") : \"\") + _schedulerId++;\n    var _blockedTimer;\n    newPromise = newPromise || createPromise;\n    var _startBlockedTimer = function () {\n        var hasTasks = (getLength(_running) + getLength(_waiting)) > 0;\n        if (_staleTimeoutPeriod > 0) {\n            if (!_blockedTimer) {\n                _blockedTimer = scheduleTimeout(function () {\n                    _abortStaleTasks(_running, _staleTimeoutPeriod);\n                    _abortStaleTasks(_waiting, _staleTimeoutPeriod);\n                    _blockedTimer && (_blockedTimer.enabled = ((getLength(_running) + getLength(_waiting)) > 0));\n                }, _staleTimeoutCheckPeriod);\n                _blockedTimer.unref();\n            }\n            _blockedTimer && (_blockedTimer.enabled = hasTasks);\n        }\n    };\n    var _queueTask = function (startAction, taskName, timeout) {\n        var _a;\n        var taskId = _schedulerName + \".\" + _taskCount++;\n        if (taskName) {\n            taskId += \"-(\" + taskName + \")\";\n        }\n        var newTask = (_a = {\n                id: taskId,\n                cr: utcNow(),\n                to: timeout\n            },\n            _a[REJECT] = function (reason) {\n                newTask.rj = reason || _createError(REJECTED_ERROR, newTask);\n                newTask[REJECT] = _rejectDone;\n            },\n            _a);\n        if (!_theTask) {\n            newTask.p = newPromise(_runTask(newTask, startAction));\n        }\n        else {\n            newTask.p = _waitForPreviousTask(newTask, _theTask, startAction);\n        }\n        _theTask = newTask;\n        return newTask.p;\n    };\n    var _runTask = function (taskDetail, startAction) {\n        taskDetail.st = utcNow();\n        _running.push(taskDetail);\n        _startBlockedTimer();\n        return function (onTaskResolve, onTaskReject) {\n            var _promiseReject = function (reason) {\n                taskDetail.rj = taskDetail.rj || reason || _createError(REJECTED_ERROR, taskDetail);\n                taskDetail[REJECT] = _rejectDone;\n                _doCleanup(taskDetail);\n                onTaskResolve = null;\n                onTaskReject && onTaskReject(reason);\n                onTaskReject = null;\n            };\n            var taskId = taskDetail.id;\n            if (taskDetail.rj) {\n                _promiseReject(taskDetail.rj);\n            }\n            else {\n                taskDetail[REJECT] = _promiseReject;\n                try {\n                    var startResult = startAction(taskId);\n                    if (taskDetail.to && isPromiseLike(startResult)) {\n                        taskDetail.t = scheduleTimeout(function () {\n                            _promiseReject(_createError(\"Timeout\", taskDetail));\n                        }, taskDetail.to);\n                    }\n                    doAwait(startResult, function (theResult) {\n                        _doCleanup(taskDetail);\n                        try {\n                            onTaskResolve && onTaskResolve(theResult);\n                        }\n                        catch (e) {\n                            onTaskReject && onTaskReject(e);\n                        }\n                        onTaskReject = null;\n                        onTaskResolve = null;\n                    }, _promiseReject);\n                }\n                catch (e) {\n                    _promiseReject(e);\n                }\n            }\n        };\n    };\n    var _waitForPreviousTask = function (taskDetail, prevTask, startAction) {\n        _waiting.push(taskDetail);\n        _startBlockedTimer();\n        return newPromise(function (onWaitResolve, onWaitReject) {\n            doAwaitResponse(prevTask.p, function () {\n                _removeTask(_waiting, taskDetail);\n                _runTask(taskDetail, startAction)(onWaitResolve, onWaitReject);\n            });\n        });\n    };\n    var _doCleanup = function (taskDetail) {\n        _removeTask(_running, taskDetail);\n        taskDetail.t && taskDetail.t.cancel();\n        taskDetail.t = null;\n        if (_theTask && _theTask === taskDetail) {\n            _theTask = null;\n            if (getLength(_running) + getLength(_waiting) === 0) {\n                _blockedTimer && _blockedTimer.cancel();\n                _blockedTimer = null;\n            }\n        }\n    };\n    var theScheduler = {\n        idle: true,\n        queue: _queueTask,\n        setStaleTimeout: function (staleTimeout, staleCheckPeriod) {\n            _blockedTimer && _blockedTimer.cancel();\n            _blockedTimer = null;\n            _staleTimeoutPeriod = staleTimeout;\n            _staleTimeoutCheckPeriod = staleCheckPeriod || staleTimeout / 10;\n            _startBlockedTimer();\n        }\n    };\n    objDefine(theScheduler, \"idle\", {\n        g: function () {\n            return getLength(_running) + getLength(_waiting) === 0;\n        }\n    });\n    _addDebugState(theScheduler, function () { return _schedulerName; }, function () {\n        return {\n            l: _theTask,\n            r: _running,\n            w: _waiting\n        };\n    });\n    return theScheduler;\n}\n\nvar toStringTagSymbol = getKnownSymbol(11 );\nvar PolyPromise = /*#__PURE__*/ (function () {\n    function PolyPromiseImpl(executor) {\n        this._$ = createAsyncPromise(executor);\n        if (toStringTagSymbol) {\n            this[toStringTagSymbol] = \"Promise\";\n        }\n        objDefineProp(this, \"state\", {\n            get: function () {\n                return this._$.state;\n            }\n        });\n    }\n    PolyPromiseImpl.all = createAsyncAllPromise;\n    PolyPromiseImpl.race = createAsyncRacePromise;\n    PolyPromiseImpl.any = createAsyncAnyPromise;\n    PolyPromiseImpl.reject = createAsyncRejectedPromise;\n    PolyPromiseImpl.resolve = createAsyncResolvedPromise;\n    PolyPromiseImpl.allSettled = createAsyncAllSettledPromise;\n    var theProto = PolyPromiseImpl.prototype;\n    theProto.then = function (onResolved, onRejected) {\n        return this._$.then(onResolved, onRejected);\n    };\n    theProto.catch = function (onRejected) {\n        return this._$.catch(onRejected);\n    };\n    theProto.finally = function (onfinally) {\n        return this._$.finally(onfinally);\n    };\n    return PolyPromiseImpl;\n}());\n\nexport { PolyPromise, arrForEachAsync, createAllPromise, createAllSettledPromise, createAnyPromise, createAsyncAllPromise, createAsyncAllSettledPromise, createAsyncAnyPromise, createAsyncPromise, createAsyncRacePromise, createAsyncRejectedPromise, createAsyncResolvedPromise, createIdleAllPromise, createIdleAllSettledPromise, createIdleAnyPromise, createIdlePromise, createIdleRacePromise, createIdleRejectedPromise, createIdleResolvedPromise, createNativeAllPromise, createNativeAllSettledPromise, createNativeAnyPromise, createNativePromise, createNativeRacePromise, createNativeRejectedPromise, createNativeResolvedPromise, createPromise, createRacePromise, createRejectedPromise, createResolvedPromise, createSyncAllPromise, createSyncAllSettledPromise, createSyncAnyPromise, createSyncPromise, createSyncRacePromise, createSyncRejectedPromise, createSyncResolvedPromise, createTaskScheduler, createTimeoutPromise, doAwait, doAwaitResponse, doFinally, doWhileAsync, iterForOfAsync, setCreatePromiseImpl, setDefaultIdlePromiseTimeout, setDefaultIdleTimeout, setPromiseDebugState };\n//# sourceMappingURL=ts-async.js.map\n","/*! https://github.com/nevware21/ts-utils v0.11.6 */\n/*\n * Copyright (c) NevWare21 Solutions LLC and contributors. All rights reserved.\n * Licensed under the MIT license.\n */\n/*#__NO_SIDE_EFFECTS__*/\nfunction _pureAssign(func1, func2) {\n    return func1 || func2;\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction _pureRef(value, name) {\n    return value[name];\n}\n\nvar UNDEF_VALUE = undefined;\nvar NULL_VALUE = null;\nvar EMPTY = \"\";\nvar FUNCTION = \"function\";\nvar OBJECT = \"object\";\nvar PROTOTYPE = \"prototype\";\nvar __PROTO__ = \"__proto__\";\nvar UNDEFINED = \"undefined\";\nvar CONSTRUCTOR = \"constructor\";\nvar SYMBOL = \"Symbol\";\nvar POLYFILL_TAG = \"_polyfill\";\nvar LENGTH = \"length\";\nvar NAME = \"name\";\nvar CALL = \"call\";\nvar TO_STRING = \"toString\";\nvar ObjClass = ( /*#__PURE__*/_pureAssign(Object));\nvar ObjProto = ( /*#__PURE__*/_pureRef(ObjClass, PROTOTYPE));\nvar StrCls = ( /*#__PURE__*/_pureAssign(String));\nvar StrProto = ( /*#__PURE__*/_pureRef(StrCls, PROTOTYPE));\nvar MathCls = ( /*#__PURE__*/_pureAssign(Math));\nvar ArrCls = ( /*#__PURE__*/_pureAssign(Array));\nvar ArrProto = ( /*#__PURE__*/_pureRef(ArrCls, PROTOTYPE));\nvar ArrSlice = ( /*#__PURE__*/_pureRef(ArrProto, \"slice\"));\n\nfunction safe(func, argArray) {\n    try {\n        return {\n            v: func.apply(this, argArray)\n        };\n    }\n    catch (e) {\n        return { e: e };\n    }\n}\n\n/*#__NO_SIDE_EFFECTS__*/\nfunction safeGet(cb, defValue) {\n    var result = safe(cb);\n    return result.e ? defValue : result.v;\n}\n\nvar _primitiveTypes;\n/*#__NO_SIDE_EFFECTS__*/\nfunction _createIs(theType) {\n    return function (value) {\n        return typeof value === theType;\n    };\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction _createObjIs(theName) {\n    var theType = \"[object \" + theName + \"]\";\n    return function (value) {\n        return !!(value && objToString(value) === theType);\n    };\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction objToString(value) {\n    return ObjProto[TO_STRING].call(value);\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction isTypeof(value, theType) {\n    return typeof value === theType;\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction isUndefined(value) {\n    return typeof value === UNDEFINED || value === UNDEFINED;\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction isStrictUndefined(arg) {\n    return !isDefined(arg);\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction isNullOrUndefined(value) {\n    return value === NULL_VALUE || isUndefined(value);\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction isStrictNullOrUndefined(value) {\n    return value === NULL_VALUE || !isDefined(value);\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction isDefined(arg) {\n    return !!arg || arg !== UNDEF_VALUE;\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction isPrimitive(value) {\n    return value === NULL_VALUE || isPrimitiveType(typeof value);\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction isPrimitiveType(theType) {\n    !_primitiveTypes && (_primitiveTypes = [\"string\", \"number\", \"boolean\", UNDEFINED, \"symbol\", \"bigint\"]);\n    return !!(theType !== OBJECT && _primitiveTypes.indexOf(theType) !== -1);\n}\nvar isString = ( /*#__PURE__*/_createIs(\"string\"));\nvar isFunction = ( /*#__PURE__*/_createIs(FUNCTION));\n/*#__NO_SIDE_EFFECTS__*/\nfunction isObject(value) {\n    if (!value && isNullOrUndefined(value)) {\n        return false;\n    }\n    return !!value && typeof value === OBJECT;\n}\nvar isArray = ( /* #__PURE__*/_pureRef(ArrCls, \"isArray\"));\nvar isDate = ( /*#__PURE__*/_createObjIs(\"Date\"));\nvar isNumber = ( /*#__PURE__*/_createIs(\"number\"));\nvar isBoolean = ( /*#__PURE__*/_createIs(\"boolean\"));\nvar isRegExp = ( /*#__PURE__*/_createObjIs(\"RegExp\"));\nvar isFile = ( /*#__PURE__*/_createObjIs(\"File\"));\nvar isFormData = ( /*#__PURE__*/_createObjIs(\"FormData\"));\nvar isBlob = ( /*#__PURE__*/_createObjIs(\"Blob\"));\nvar isArrayBuffer = ( /*#__PURE__*/_createObjIs(\"ArrayBuffer\"));\nvar isError = ( /*#__PURE__*/_createObjIs(\"Error\"));\n/*#__NO_SIDE_EFFECTS__*/\nfunction isPromiseLike(value) {\n    return !!(value && value.then && isFunction(value.then));\n}\nvar isThenable = isPromiseLike;\n/*#__NO_SIDE_EFFECTS__*/\nfunction isPromise(value) {\n    return !!(value && value.then && value.catch && isFunction(value.then) && isFunction(value.catch));\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction isNotTruthy(value) {\n    return !value || !isTruthy(value);\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction isTruthy(value) {\n    return !(!value || safeGet(function () { return !(value && (0 + value)); }, !value));\n}\n\nvar objGetOwnPropertyDescriptor = ( /* #__PURE__ */_pureRef(ObjClass, \"getOwnPropertyDescriptor\"));\n\n/*#__NO_SIDE_EFFECTS__*/\nfunction objHasOwnProperty(obj, prop) {\n    return !!obj && ObjProto.hasOwnProperty[CALL](obj, prop);\n}\n\nvar objHasOwn = ( /*#__PURE__*/_pureAssign(( /* #__PURE__ */_pureRef(ObjClass, \"hasOwn\")), polyObjHasOwn));\n/*#__NO_SIDE_EFFECTS__*/\nfunction polyObjHasOwn(obj, prop) {\n    return objHasOwnProperty(obj, prop) || !!objGetOwnPropertyDescriptor(obj, prop);\n}\n\nfunction objForEachKey(theObject, callbackfn, thisArg) {\n    if (theObject && isObject(theObject)) {\n        for (var prop in theObject) {\n            if (objHasOwn(theObject, prop)) {\n                if (callbackfn[CALL](thisArg || theObject, prop, theObject[prop]) === -1) {\n                    break;\n                }\n            }\n        }\n    }\n}\n\nvar propMap = {\n    e: \"enumerable\",\n    c: \"configurable\",\n    v: \"value\",\n    w: \"writable\",\n    g: \"get\",\n    s: \"set\"\n};\n/*#__NO_SIDE_EFFECTS__*/\nfunction _createProp(value) {\n    var prop = {};\n    prop[propMap[\"c\"]] = true;\n    prop[propMap[\"e\"]] = true;\n    if (value.l) {\n        prop.get = function () { return value.l.v; };\n        var desc = objGetOwnPropertyDescriptor(value.l, \"v\");\n        if (desc && desc.set) {\n            prop.set = function (newValue) {\n                value.l.v = newValue;\n            };\n        }\n    }\n    objForEachKey(value, function (key, value) {\n        prop[propMap[key]] = isStrictUndefined(value) ? prop[propMap[key]] : value;\n    });\n    return prop;\n}\nvar objDefineProp = ( /*#__PURE__*/_pureRef(ObjClass, \"defineProperty\"));\nvar objDefineProperties = ( /*#__PURE__*/_pureRef(ObjClass, \"defineProperties\"));\nfunction objDefineGet(target, key, value, configurable, enumerable) {\n    var _a;\n    return objDefineProp(target, key, _createProp((_a = {\n            e: enumerable,\n            c: configurable\n        },\n        _a[isFunction(value) ? \"g\" : \"v\"] = value,\n        _a)));\n}\nfunction objDefineAccessors(target, prop, getProp, setProp, configurable, enumerable) {\n    var desc = {\n        e: enumerable,\n        c: configurable\n    };\n    if (getProp) {\n        desc.g = getProp;\n    }\n    if (setProp) {\n        desc.s = setProp;\n    }\n    return objDefineProp(target, prop, _createProp(desc));\n}\nfunction objDefine(target, key, propDesc) {\n    return objDefineProp(target, key, _createProp(propDesc));\n}\nfunction objDefineProps(target, propDescMap) {\n    var props = {};\n    objForEachKey(propDescMap, function (key, value) {\n        props[key] = _createProp(value);\n    });\n    return objDefineProperties(target, props);\n}\n\n/*#__NO_SIDE_EFFECTS__*/\nfunction _createKeyValueMap(values, keyType, valueType, completeFn, writable) {\n    var theMap = {};\n    objForEachKey(values, function (key, value) {\n        _assignMapValue(theMap, key, keyType ? value : key, writable);\n        _assignMapValue(theMap, value, valueType ? value : key, writable);\n    });\n    return completeFn ? completeFn(theMap) : theMap;\n}\nfunction _assignMapValue(theMap, key, value, writable) {\n    objDefineProp(theMap, key, {\n        value: value,\n        enumerable: true,\n        writable: !!writable\n    });\n}\n\nvar asString = ( /* #__PURE__ */_pureAssign(StrCls));\n\nvar ERROR_TYPE = \"[object Error]\";\n/*#__NO_SIDE_EFFECTS__*/\nfunction dumpObj(object, format) {\n    var propertyValueDump = EMPTY;\n    var objType = ObjProto[TO_STRING][CALL](object);\n    if (objType === ERROR_TYPE) {\n        object = { stack: asString(object.stack), message: asString(object.message), name: asString(object.name) };\n    }\n    try {\n        propertyValueDump = JSON.stringify(object, NULL_VALUE, format ? ((typeof format === \"number\") ? format : 4) : UNDEF_VALUE);\n        propertyValueDump = (propertyValueDump ? propertyValueDump.replace(/\"(\\w+)\"\\s*:\\s{0,1}/g, \"$1: \") : NULL_VALUE) || asString(object);\n    }\n    catch (e) {\n        propertyValueDump = \" - \" + dumpObj(e, format);\n    }\n    return objType + \": \" + propertyValueDump;\n}\n\nfunction throwError(message) {\n    throw new Error(message);\n}\nfunction throwTypeError(message) {\n    throw new TypeError(message);\n}\nfunction throwRangeError(message) {\n    throw new RangeError(message);\n}\n\n/*#__NO_SIDE_EFFECTS__*/\nfunction polyObjKeys(obj) {\n    if (!isObject(obj) || obj === NULL_VALUE) {\n        throwTypeError(\"non-object \" + dumpObj(obj));\n    }\n    var result = [];\n    for (var prop in obj) {\n        if (objHasOwn(obj, prop)) {\n            result.push(prop);\n        }\n    }\n    return result;\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction polyObjEntries(value) {\n    var result = [];\n    objForEachKey(value, function (key, value) {\n        result.push([key, value]);\n    });\n    return result;\n}\n\nvar _objFreeze = ( /* #__PURE__ */_pureRef(ObjClass, \"freeze\"));\nfunction _doNothing(value) {\n    return value;\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction _getProto(value) {\n    return value[__PROTO__] || NULL_VALUE;\n}\nvar objAssign = ( /*#__PURE__*/_pureRef(ObjClass, \"assign\"));\nvar objKeys = ( /*#__PURE__*/_pureRef(ObjClass, \"keys\"));\nfunction objDeepFreeze(value) {\n    if (_objFreeze) {\n        objForEachKey(value, function (key, value) {\n            if (isArray(value) || isObject(value)) {\n                objDeepFreeze(value);\n            }\n        });\n    }\n    return objFreeze(value);\n}\nvar objFreeze = ( /* #__PURE__*/_pureAssign(_objFreeze, _doNothing));\nvar objSeal = ( /* #__PURE__*/_pureAssign(( /* #__PURE__*/_pureRef(ObjClass, \"seal\")), _doNothing));\nvar objGetPrototypeOf = ( /* #__PURE__*/_pureAssign(( /* #__PURE__*/_pureRef(ObjClass, \"getPrototypeOf\")), _getProto));\nvar objEntries = ( /* #__PURE__*/_pureAssign(( /* #__PURE__*/_pureRef(ObjClass, \"entries\")), polyObjEntries));\n\n/*#__NO_SIDE_EFFECTS__*/\nfunction createEnum(values) {\n    return _createKeyValueMap(values, 1 , 0 , objFreeze);\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction createEnumKeyMap(values) {\n    return _createKeyValueMap(values, 0 , 0 , objFreeze);\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction createEnumValueMap(values) {\n    return _createKeyValueMap(values, 1 , 1 , objFreeze);\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction createSimpleMap(values) {\n    var mapClass = {};\n    objForEachKey(values, function (key, value) {\n        _assignMapValue(mapClass, key, value[1]);\n        _assignMapValue(mapClass, value[0], value[1]);\n    });\n    return objFreeze(mapClass);\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction createTypeMap(values) {\n    return createSimpleMap(values);\n}\n\nvar _wellKnownSymbolMap = /*#__PURE__*/ createEnumKeyMap({\n    asyncIterator: 0 ,\n    hasInstance: 1 ,\n    isConcatSpreadable: 2 ,\n    iterator: 3 ,\n    match: 4 ,\n    matchAll: 5 ,\n    replace: 6 ,\n    search: 7 ,\n    species: 8 ,\n    split: 9 ,\n    toPrimitive: 10 ,\n    toStringTag: 11 ,\n    unscopables: 12\n});\n\nvar GLOBAL_CONFIG_KEY = \"__tsUtils$gblCfg\";\nvar _globalCfg;\n/*#__NO_SIDE_EFFECTS__*/\nfunction _getGlobalValue() {\n    var result;\n    if (typeof globalThis !== UNDEFINED) {\n        result = globalThis;\n    }\n    if (!result && typeof self !== UNDEFINED) {\n        result = self;\n    }\n    if (!result && typeof window !== UNDEFINED) {\n        result = window;\n    }\n    if (!result && typeof global !== UNDEFINED) {\n        result = global;\n    }\n    return result;\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction _getGlobalConfig() {\n    if (!_globalCfg) {\n        var gbl = safe(_getGlobalValue).v || {};\n        _globalCfg = gbl[GLOBAL_CONFIG_KEY] = gbl[GLOBAL_CONFIG_KEY] || {};\n    }\n    return _globalCfg;\n}\n\nvar _unwrapFunction = ( _unwrapFunctionWithPoly);\n/*#__NO_SIDE_EFFECTS__*/\nfunction _unwrapFunctionWithPoly(funcName, clsProto, polyFunc) {\n    var clsFn = clsProto ? clsProto[funcName] : NULL_VALUE;\n    return function (thisArg) {\n        var theFunc = (thisArg ? thisArg[funcName] : NULL_VALUE) || clsFn;\n        if (theFunc || polyFunc) {\n            var theArgs = arguments;\n            return (theFunc || polyFunc).apply(thisArg, theFunc ? ArrSlice[CALL](theArgs, 1) : theArgs);\n        }\n        throwTypeError(\"\\\"\" + asString(funcName) + \"\\\" not defined for \" + dumpObj(thisArg));\n    };\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction _unwrapProp(propName) {\n    return function (thisArg) {\n        return thisArg[propName];\n    };\n}\n\nvar mathMin = ( /*#__PURE__*/_pureRef(MathCls, \"min\"));\nvar mathMax = ( /*#__PURE__*/_pureRef(MathCls, \"max\"));\n\nvar strSlice = ( /*#__PURE__*/_unwrapFunction(\"slice\", StrProto));\n\nvar strSubstring = ( /*#__PURE__*/_unwrapFunction(\"substring\", StrProto));\nvar strSubstr = ( /*#__PURE__*/_unwrapFunctionWithPoly(\"substr\", StrProto, polyStrSubstr));\n/*#__NO_SIDE_EFFECTS__*/\nfunction polyStrSubstr(value, start, length) {\n    if (isNullOrUndefined(value)) {\n        throwTypeError(\"Invalid \" + dumpObj(value));\n    }\n    if (length < 0) {\n        return EMPTY;\n    }\n    start = start || 0;\n    if (start < 0) {\n        start = mathMax(start + value[LENGTH], 0);\n    }\n    if (isUndefined(length)) {\n        return strSlice(value, start);\n    }\n    return strSlice(value, start, start + length);\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction strLeft(value, count) {\n    return strSubstring(value, 0, count);\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction strRight(value, count) {\n    return count <= 0 ? EMPTY : (value[LENGTH] > count ? strSlice(value, -count) : value);\n}\n\nvar UNIQUE_REGISTRY_ID = \"_urid\";\nvar _polySymbols;\n/*#__NO_SIDE_EFFECTS__*/\nfunction _globalSymbolRegistry() {\n    if (!_polySymbols) {\n        var gblCfg = _getGlobalConfig();\n        _polySymbols = gblCfg.gblSym = gblCfg.gblSym || { k: {}, s: {} };\n    }\n    return _polySymbols;\n}\nvar _wellKnownSymbolCache;\n/*#__NO_SIDE_EFFECTS__*/\nfunction polyNewSymbol(description) {\n    var theSymbol = {\n        description: asString(description),\n        toString: function () { return SYMBOL + \"(\" + description + \")\"; }\n    };\n    theSymbol[POLYFILL_TAG] = true;\n    return theSymbol;\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction polySymbolFor(key) {\n    var registry = _globalSymbolRegistry();\n    if (!objHasOwn(registry.k, key)) {\n        var newSymbol_1 = polyNewSymbol(key);\n        var regId_1 = objKeys(registry.s).length;\n        newSymbol_1[UNIQUE_REGISTRY_ID] = function () { return regId_1 + \"_\" + newSymbol_1[TO_STRING](); };\n        registry.k[key] = newSymbol_1;\n        registry.s[newSymbol_1[UNIQUE_REGISTRY_ID]()] = asString(key);\n    }\n    return registry.k[key];\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction polySymbolKeyFor(sym) {\n    if (!sym || !sym[TO_STRING] || strSubstring(sym[TO_STRING](), 0, 6) != SYMBOL) {\n        throwTypeError(sym + \" is not a symbol\");\n    }\n    var regId = sym[POLYFILL_TAG] && sym[UNIQUE_REGISTRY_ID] && sym[UNIQUE_REGISTRY_ID]();\n    return regId ? _globalSymbolRegistry().s[regId] : undefined;\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction polyGetKnownSymbol(name) {\n    !_wellKnownSymbolCache && (_wellKnownSymbolCache = {});\n    var result;\n    var knownName = _wellKnownSymbolMap[name];\n    if (knownName) {\n        result = _wellKnownSymbolCache[knownName] = _wellKnownSymbolCache[knownName] || polyNewSymbol(SYMBOL + \".\" + knownName);\n    }\n    return result;\n}\n\nvar _globalLazyTestHooks;\nfunction _initTestHooks() {\n    _globalLazyTestHooks = _getGlobalConfig();\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction getLazy(cb) {\n    var lazyValue = {};\n    !_globalLazyTestHooks && _initTestHooks();\n    lazyValue.b = _globalLazyTestHooks.lzy;\n    objDefineProp(lazyValue, \"v\", {\n        configurable: true,\n        get: function () {\n            var result = cb();\n            if (!_globalLazyTestHooks.lzy) {\n                objDefineProp(lazyValue, \"v\", {\n                    value: result\n                });\n            }\n            lazyValue.b = _globalLazyTestHooks.lzy;\n            return result;\n        }\n    });\n    return lazyValue;\n}\nfunction setBypassLazyCache(newValue) {\n    !_globalLazyTestHooks && _initTestHooks();\n    _globalLazyTestHooks.lzy = newValue;\n}\n\n/*#__NO_SIDE_EFFECTS__*/\nfunction createCachedValue(value) {\n    return objDefineProp({\n        toJSON: function () { return value; }\n    }, \"v\", { value: value });\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction createDeferredCachedValue(cb) {\n    var theValue = {\n        toJSON: function () { return theValue.v; }\n    };\n    return objDefineProp(theValue, \"v\", {\n        get: function () {\n            var result = cb();\n            cb = NULL_VALUE;\n            objDefineProp(theValue, \"v\", { value: result });\n            return result;\n        },\n        configurable: true\n    });\n}\n\nvar WINDOW = \"window\";\nvar _cachedGlobal;\nfunction _getGlobalInstFn(getFn, theArgs) {\n    var cachedValue;\n    return function () {\n        !_globalLazyTestHooks && _initTestHooks();\n        if (!cachedValue || _globalLazyTestHooks.lzy) {\n            cachedValue = createCachedValue(safe(getFn, theArgs).v);\n        }\n        return cachedValue.v;\n    };\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction lazySafeGetInst(name) {\n    return getLazy(function () { return safe((getInst), [name]).v || UNDEF_VALUE; });\n}\nfunction getGlobal(useCached) {\n    !_globalLazyTestHooks && _initTestHooks();\n    if (!_cachedGlobal || useCached === false || _globalLazyTestHooks.lzy) {\n        _cachedGlobal = createCachedValue(safe(_getGlobalValue).v || NULL_VALUE);\n    }\n    return _cachedGlobal.v;\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction getInst(name, useCached) {\n    var gbl;\n    if (!_cachedGlobal || useCached === false) {\n        gbl = getGlobal(useCached);\n    }\n    else {\n        gbl = _cachedGlobal.v;\n    }\n    if (gbl && gbl[name]) {\n        return gbl[name];\n    }\n    if (name === WINDOW) {\n        try {\n            return window;\n        }\n        catch (e) {\n        }\n    }\n    return NULL_VALUE;\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction hasDocument() {\n    return !!( /*#__PURE__*/getDocument());\n}\nvar getDocument = ( /*#__PURE__*/_getGlobalInstFn(getInst, [\"document\"]));\n/*#__NO_SIDE_EFFECTS__*/\nfunction hasWindow() {\n    return !!( /*#__PURE__*/getWindow());\n}\nvar getWindow = ( /*#__PURE__*/_getGlobalInstFn(getInst, [WINDOW]));\n/*#__NO_SIDE_EFFECTS__*/\nfunction hasNavigator() {\n    return !!( /*#__PURE__*/getNavigator());\n}\nvar getNavigator = ( /*#__PURE__*/_getGlobalInstFn(getInst, [\"navigator\"]));\n/*#__NO_SIDE_EFFECTS__*/\nfunction hasHistory() {\n    return !!( /*#__PURE__*/getHistory());\n}\nvar getHistory = ( /*#__PURE__*/_getGlobalInstFn(getInst, [\"history\"]));\nvar isNode = ( /*#__PURE__*/_getGlobalInstFn(function () {\n    return !!( /*#__PURE__*/safe(function () { return (process && (process.versions || {}).node); }).v);\n}));\nvar isWebWorker = ( /*#__PURE__*/_getGlobalInstFn(function () {\n    return !!( /*#__PURE__*/safe(function () { return self && self instanceof WorkerGlobalScope; }).v);\n}));\n\nvar _symbol;\nvar _symbolFor;\nvar _symbolKeyFor;\n/*#__NO_SIDE_EFFECTS__*/\nfunction _initSymbol() {\n    _symbol = ( /*#__PURE__*/createCachedValue(safe((getInst), [SYMBOL]).v));\n    return _symbol;\n}\nfunction _getSymbolKey(key) {\n    var gblSym = ((!_globalLazyTestHooks.lzy ? _symbol : 0) || _initSymbol());\n    return (gblSym.v ? gblSym.v[key] : UNDEF_VALUE);\n}\nvar isSymbol = ( /*#__PURE__*/_createIs(\"symbol\"));\n/*#__NO_SIDE_EFFECTS__*/\nfunction hasSymbol() {\n    return !!( /*#__PURE__*/getSymbol());\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction getSymbol() {\n    !_globalLazyTestHooks && _initTestHooks();\n    return ((!_globalLazyTestHooks.lzy ? _symbol : 0) || _initSymbol()).v;\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction getKnownSymbol(name, noPoly) {\n    var knownName = _wellKnownSymbolMap[name];\n    !_globalLazyTestHooks && _initTestHooks();\n    var sym = ((!_globalLazyTestHooks.lzy ? _symbol : 0) || _initSymbol());\n    return sym.v ? sym.v[knownName || name] : (!noPoly ? polyGetKnownSymbol(name) : UNDEF_VALUE);\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction newSymbol(description, noPoly) {\n    !_globalLazyTestHooks && _initTestHooks();\n    var sym = ((!_globalLazyTestHooks.lzy ? _symbol : 0) || _initSymbol());\n    return sym.v ? sym.v(description) : (!noPoly ? polyNewSymbol(description) : NULL_VALUE);\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction symbolFor(key) {\n    !_globalLazyTestHooks && _initTestHooks();\n    _symbolFor = ((!_globalLazyTestHooks.lzy ? _symbolFor : 0) || ( /*#__PURE__*/createCachedValue(safe((_getSymbolKey), [\"for\"]).v)));\n    return (_symbolFor.v || polySymbolFor)(key);\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction symbolKeyFor(sym) {\n    !_globalLazyTestHooks && _initTestHooks();\n    _symbolKeyFor = ((!_globalLazyTestHooks.lzy ? _symbolKeyFor : 0) || ( /*#__PURE__*/createCachedValue(safe((_getSymbolKey), [\"keyFor\"]).v)));\n    return (_symbolKeyFor.v || polySymbolKeyFor)(sym);\n}\n\n/*#__NO_SIDE_EFFECTS__*/\nfunction isIterator(value) {\n    return !!value && isFunction(value.next);\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction isIterable(value) {\n    return !isStrictNullOrUndefined(value) && isFunction(value[getKnownSymbol(3 )]);\n}\n\nvar _iterSymbol$1;\nfunction iterForOf(iter, callbackfn, thisArg) {\n    if (iter) {\n        if (!isIterator(iter)) {\n            !_iterSymbol$1 && (_iterSymbol$1 = createCachedValue(getKnownSymbol(3 )));\n            iter = iter[_iterSymbol$1.v] ? iter[_iterSymbol$1.v]() : NULL_VALUE;\n        }\n        if (isIterator(iter)) {\n            var err = UNDEF_VALUE;\n            var iterResult = UNDEF_VALUE;\n            try {\n                var count = 0;\n                while (!(iterResult = iter.next()).done) {\n                    if (callbackfn[CALL](thisArg || iter, iterResult.value, count, iter) === -1) {\n                        break;\n                    }\n                    count++;\n                }\n            }\n            catch (failed) {\n                err = { e: failed };\n                if (iter.throw) {\n                    iterResult = NULL_VALUE;\n                    iter.throw(err);\n                }\n            }\n            finally {\n                try {\n                    if (iterResult && !iterResult.done) {\n                        iter.return && iter.return(iterResult);\n                    }\n                }\n                finally {\n                    if (err) {\n                        // eslint-disable-next-line no-unsafe-finally\n                        throw err.e;\n                    }\n                }\n            }\n        }\n    }\n}\n\nfunction fnApply(fn, thisArg, argArray) {\n    return fn.apply(thisArg, argArray);\n}\nfunction fnCall(fn, thisArg) {\n    return fn.apply(thisArg, ArrSlice[CALL](arguments, 2));\n}\nfunction fnBind(fn, thisArg) {\n    return fn.bind.apply(fn, ArrSlice[CALL](arguments, 1));\n}\n\nfunction arrAppend(target, elms) {\n    if (!isUndefined(elms) && target) {\n        if (isArray(elms)) {\n            fnApply(target.push, target, elms);\n        }\n        else if (isIterator(elms) || isIterable(elms)) {\n            iterForOf(elms, function (elm) {\n                target.push(elm);\n            });\n        }\n        else {\n            target.push(elms);\n        }\n    }\n    return target;\n}\n\nvar arrEvery = /*#__PURE__*/ _unwrapFunction(\"every\", ArrProto);\nvar arrFilter = /*#__PURE__*/ _unwrapFunction(\"filter\", ArrProto);\n\nfunction arrForEach(theArray, callbackfn, thisArg) {\n    if (theArray) {\n        var len = theArray[LENGTH] >>> 0;\n        for (var idx = 0; idx < len; idx++) {\n            if (idx in theArray) {\n                if (callbackfn[CALL](thisArg || theArray, theArray[idx], idx, theArray) === -1) {\n                    break;\n                }\n            }\n        }\n    }\n}\n\nvar arrIndexOf = ( /*#__PURE__*/_unwrapFunction(\"indexOf\", ArrProto));\nvar arrLastIndexOf = ( /*#__PURE__*/_unwrapFunction(\"lastIndexOf\", ArrProto));\n\nvar arrMap = ( /*#__PURE__*/_unwrapFunction(\"map\", ArrProto));\n\nfunction arrSlice(theArray, start, end) {\n    return ((theArray ? theArray[\"slice\"] : NULL_VALUE) || ArrSlice).apply(theArray, ArrSlice[CALL](arguments, 1));\n}\n\n/*#__NO_SIDE_EFFECTS__*/\nfunction polyIsArray(value) {\n    if (isNullOrUndefined(value)) {\n        return false;\n    }\n    return objToString(value) === \"[object Array]\";\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction polyArrIncludes(theArray, searchElement, fromIndex) {\n    return arrIndexOf(theArray, searchElement, fromIndex) !== -1;\n}\nfunction polyArrFind(theArray, callbackFn, thisArg) {\n    var result;\n    var idx = polyArrFindIndex(theArray, callbackFn, thisArg);\n    return idx !== -1 ? theArray[idx] : result;\n}\nfunction polyArrFindIndex(theArray, callbackFn, thisArg) {\n    var result = -1;\n    arrForEach(theArray, function (value, index) {\n        if (callbackFn[CALL](thisArg | theArray, value, index, theArray)) {\n            result = index;\n            return -1;\n        }\n    });\n    return result;\n}\nfunction polyArrFindLast(theArray, callbackFn, thisArg) {\n    var result;\n    var idx = polyArrFindLastIndex(theArray, callbackFn, thisArg);\n    return idx !== -1 ? theArray[idx] : result;\n}\nfunction polyArrFindLastIndex(theArray, callbackFn, thisArg) {\n    var result = -1;\n    var len = theArray[LENGTH] >>> 0;\n    for (var idx = len - 1; idx >= 0; idx--) {\n        if (idx in theArray && callbackFn[CALL](thisArg | theArray, theArray[idx], idx, theArray)) {\n            result = idx;\n            break;\n        }\n    }\n    return result;\n}\nfunction polyArrFrom(theValue, mapFn, thisArg) {\n    if (isArray(theValue)) {\n        var result_1 = arrSlice(theValue);\n        return mapFn ? arrMap(result_1, mapFn, thisArg) : result_1;\n    }\n    var result = [];\n    iterForOf(theValue, function (value, cnt) {\n        return result.push(mapFn ? mapFn[CALL](thisArg, value, cnt) : value);\n    });\n    return result;\n}\n\nvar arrFind = /*#__PURE__*/ _unwrapFunctionWithPoly(\"find\", ArrProto, polyArrFind);\nvar arrFindIndex = /*#__PURE__*/ _unwrapFunctionWithPoly(\"findIndex\", ArrProto, polyArrFindIndex);\nvar arrFindLast = /*#__PURE__*/ _unwrapFunctionWithPoly(\"findLast\", ArrProto, polyArrFindLast);\nvar arrFindLastIndex = /*#__PURE__*/ _unwrapFunctionWithPoly(\"findLastIndex\", ArrProto, polyArrFindLastIndex);\n\nvar arrFrom = ( /* #__PURE__*/_pureAssign(( /* #__PURE__*/_pureRef(ArrCls, \"from\")), polyArrFrom));\n\nvar arrIncludes = ( /*#__PURE__*/_unwrapFunctionWithPoly(\"includes\", ArrProto, polyArrIncludes));\nvar arrContains = arrIncludes;\n\nvar arrReduce = ( /*#__PURE__*/_unwrapFunction(\"reduce\", ArrProto));\n\nvar arrSome = ( /*#__PURE__*/_unwrapFunction(\"some\", ArrProto));\n\n/*#__NO_SIDE_EFFECTS__*/\nfunction createFnDeferredProxy(hostFn, funcName) {\n    return function () {\n        var theArgs = ArrSlice[CALL](arguments);\n        var theHost = hostFn();\n        return fnApply(theHost[funcName], theHost, theArgs);\n    };\n}\nfunction createProxyFuncs(target, host, funcDefs) {\n    if (target && host && isArray(funcDefs)) {\n        var isDeferred_1 = isFunction(host);\n        arrForEach(funcDefs, function (funcDef) {\n            var targetName = (funcDef.as || funcDef.n);\n            if (funcDef.rp === false && target[targetName]) {\n                return;\n            }\n            target[targetName] = isDeferred_1 ?\n                createFnDeferredProxy(host, funcDef.n) :\n                fnBind(host[funcDef.n], host);\n        });\n    }\n    return target;\n}\n\nvar _iterSymbol;\n/*#__NO_SIDE_EFFECTS__*/\nfunction readArgs(theArgs, start, end) {\n    if (!objHasOwn(theArgs, LENGTH)) {\n        !_iterSymbol && (_iterSymbol = createCachedValue(hasSymbol() && getKnownSymbol(3 )));\n        var iterFn = void 0;\n        if (_iterSymbol.v) {\n            iterFn = theArgs[_iterSymbol.v];\n        }\n        if (iterFn) {\n            var values_1 = [];\n            var from_1 = (start === UNDEF_VALUE || start < 0) ? 0 : start;\n            var to_1 = end < 0 || start < 0 ? UNDEF_VALUE : end;\n            iterForOf(iterFn[CALL](theArgs), function (value, cnt) {\n                if (to_1 !== UNDEF_VALUE && cnt >= to_1) {\n                    return -1;\n                }\n                if (cnt >= from_1) {\n                    values_1.push(value);\n                }\n            });\n            if ((start === UNDEF_VALUE || start >= 0) && (end === UNDEF_VALUE || end >= 0)) {\n                return values_1;\n            }\n            theArgs = values_1;\n        }\n    }\n    return arrSlice(theArgs, start, end);\n}\n\nvar objCreate = ( /* #__PURE__*/_pureAssign(( /* #__PURE__*/_pureRef(ObjClass, \"create\")), polyObjCreate));\n/*#__NO_SIDE_EFFECTS__*/\nfunction polyObjCreate(obj) {\n    if (!obj) {\n        return {};\n    }\n    var type = typeof obj;\n    if (type !== OBJECT && type !== FUNCTION) {\n        throwTypeError(\"Prototype must be an Object or function: \" + dumpObj(obj));\n    }\n    function tempFunc() { }\n    tempFunc[PROTOTYPE] = obj;\n    return new tempFunc();\n}\n\nvar _isProtoArray;\nfunction objSetPrototypeOf(obj, proto) {\n    var fn = ObjClass[\"setPrototypeOf\"] ||\n        function (d, b) {\n            var _a;\n            !_isProtoArray && (_isProtoArray = createCachedValue((_a = {}, _a[__PROTO__] = [], _a) instanceof Array));\n            _isProtoArray.v ? d[__PROTO__] = b : objForEachKey(b, function (key, value) { return d[key] = value; });\n        };\n    return fn(obj, proto);\n}\n\n/*#__NO_SIDE_EFFECTS__*/\nfunction _createCustomError(name, d, b) {\n    safe(objDefine, [d, NAME, { v: name, c: true, e: false }]);\n    d = objSetPrototypeOf(d, b);\n    function __() {\n        this[CONSTRUCTOR] = d;\n        safe(objDefine, [this, NAME, { v: name, c: true, e: false }]);\n    }\n    d[PROTOTYPE] = b === NULL_VALUE ? objCreate(b) : (__[PROTOTYPE] = b[PROTOTYPE], new __());\n    return d;\n}\nfunction _setName(baseClass, name) {\n    name && (baseClass[NAME] = name);\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction createCustomError(name, constructCb, errorBase) {\n    var theBaseClass = errorBase || Error;\n    var orgName = theBaseClass[PROTOTYPE][NAME];\n    var captureFn = Error.captureStackTrace;\n    return _createCustomError(name, function () {\n        var _this = this;\n        var theArgs = arguments;\n        try {\n            safe(_setName, [theBaseClass, name]);\n            var _self = fnApply(theBaseClass, _this, ArrSlice[CALL](theArgs)) || _this;\n            if (_self !== _this) {\n                var orgProto = objGetPrototypeOf(_this);\n                if (orgProto !== objGetPrototypeOf(_self)) {\n                    objSetPrototypeOf(_self, orgProto);\n                }\n            }\n            captureFn && captureFn(_self, _this[CONSTRUCTOR]);\n            constructCb && constructCb(_self, theArgs);\n            return _self;\n        }\n        finally {\n            safe(_setName, [theBaseClass, orgName]);\n        }\n    }, theBaseClass);\n}\nvar _unsupportedError;\nfunction throwUnsupported(message) {\n    if (!_unsupportedError) {\n        _unsupportedError = createCustomError(\"UnsupportedError\");\n    }\n    throw new _unsupportedError(message);\n}\n\n/*#__NO_SIDE_EFFECTS__*/\nfunction utcNow() {\n    return (Date.now || polyUtcNow)();\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction polyUtcNow() {\n    return new Date().getTime();\n}\n\n/*#__NO_SIDE_EFFECTS__*/\nfunction _createTrimFn(exp) {\n    return function _doTrim(value) {\n        if (isNullOrUndefined(value)) {\n            throwTypeError(\"strTrim called [\" + dumpObj(value) + \"]\");\n        }\n        if (value && value.replace) {\n            value = value.replace(exp, EMPTY);\n        }\n        return value;\n    };\n}\nvar polyStrTrim = ( /*#__PURE__*/_createTrimFn(/^\\s+|(?=\\s)\\s+$/g));\nvar polyStrTrimStart = ( /*#__PURE__*/_createTrimFn(/^\\s+/g));\nvar polyStrTrimEnd = ( /*#__PURE__*/_createTrimFn(/(?=\\s)\\s+$/g));\n\nvar strTrim = ( /*#__PURE__*/_unwrapFunctionWithPoly(\"trim\", StrProto, polyStrTrim));\nvar strTrimStart = ( /*#__PURE__*/_unwrapFunctionWithPoly(\"trimStart\", StrProto, polyStrTrimStart));\nvar strTrimLeft = ( /*#__PURE__*/_pureAssign(strTrimStart));\nvar strTrimEnd = ( /*#__PURE__*/_unwrapFunctionWithPoly(\"trimEnd\", StrProto, polyStrTrimEnd));\nvar strTrimRight = ( /*#__PURE__*/_pureAssign(strTrimEnd));\n\nvar strUpper = ( /*#__PURE__*/_unwrapFunction(\"toUpperCase\", StrProto));\nvar strLower = ( /*#__PURE__*/_unwrapFunction(\"toLowerCase\", StrProto));\n\n/*#__NO_SIDE_EFFECTS__*/\nfunction _convertCase(value, newPrefix, upperWord) {\n    return strTrim(asString(value)).replace(/((_|\\W)+(\\w){0,1}|([a-z])([A-Z]))/g, function (_match, _g1, _g2, wordStart, upperPrefix, upperLetter) {\n        var convertMatch = wordStart || upperLetter || EMPTY;\n        if (upperWord) {\n            convertMatch = strUpper(convertMatch);\n        }\n        return (upperPrefix || EMPTY) + newPrefix + convertMatch;\n    });\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction strLetterCase(value) {\n    return asString(value).replace(/(_|\\b)\\w/g, strUpper);\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction strCamelCase(value, upperFirst) {\n    var result = _convertCase(value, \"\", true);\n    return result.replace(/^\\w/, upperFirst ? strUpper : strLower);\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction strKebabCase(value, scream) {\n    var result = _convertCase(value, \"-\");\n    return (scream ? strUpper : strLower)(result);\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction strSnakeCase(value, scream) {\n    var result = _convertCase(value, \"_\");\n    return (scream ? strUpper : strLower)(result);\n}\n\nvar mathFloor = ( /*#__PURE__*/_pureRef(MathCls, \"floor\"));\nvar mathCeil = ( /*#__PURE__*/_pureRef(MathCls, \"ceil\"));\n\nvar mathTrunc = ( /* #__PURE__*/_pureAssign(( /* #__PURE__*/_pureRef(MathCls, \"trunc\")), polyMathTrunc));\n/*#__NO_SIDE_EFFECTS__*/\nfunction polyMathTrunc(value) {\n    var theValue = +value;\n    return (theValue > 0 ? mathFloor : mathCeil)(theValue);\n}\n\n/*#__NO_SIDE_EFFECTS__*/\nfunction mathToInt(value, throwInfinity) {\n    var result = +value;\n    if (result == Infinity && throwInfinity) {\n        throwRangeError(\"invalid value [\" + dumpObj(value) + \"]\");\n    }\n    return result !== result || result === 0 ? 0 : mathTrunc(result);\n}\n\nvar strRepeat = ( /*#__PURE__*/_unwrapFunctionWithPoly(\"repeat\", StrProto, polyStrRepeat));\n/*#__NO_SIDE_EFFECTS__*/\nfunction polyStrRepeat(value, count) {\n    if (isNullOrUndefined(value)) {\n        throwTypeError(\"can't convert [\" + dumpObj(value) + \"]\");\n    }\n    count = mathToInt(count, true);\n    if (count < 0) {\n        throwRangeError(\"invalid count must be >= 0 && < Infinity\");\n    }\n    var pad = isString(value) ? value : asString(value);\n    var result = EMPTY;\n    for (; count > 0; (count >>>= 1) && (pad += pad)) {\n        if (count & 1) {\n            result += pad;\n        }\n    }\n    return result;\n}\n\n/*#__NO_SIDE_EFFECTS__*/\nfunction _padValue(value, targetLength, padString) {\n    var result = EMPTY;\n    targetLength = mathToInt(targetLength, true);\n    targetLength >>= 0;\n    var len = value[LENGTH];\n    if (len < targetLength) {\n        result = isNullOrUndefined(padString) ? \" \" : asString(padString);\n        targetLength = targetLength - len;\n        if (targetLength > result[LENGTH]) {\n            result = strRepeat(result, mathCeil(targetLength / result[LENGTH]));\n        }\n        if (result[LENGTH] > targetLength) {\n            result = strSubstring(result, 0, targetLength);\n        }\n    }\n    return result;\n}\nvar strPadStart = ( /*#__PURE__*/_unwrapFunctionWithPoly(\"padStart\", StrProto, polyStrPadStart));\nvar strPadEnd = ( /*#__PURE__*/_unwrapFunctionWithPoly(\"padEnd\", StrProto, polyStrPadEnd));\n/*#__NO_SIDE_EFFECTS__*/\nfunction polyStrPadStart(value, targetLength, padString) {\n    return _padValue(value, targetLength, padString) + value;\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction polyStrPadEnd(value, targetLength, padString) {\n    return value + _padValue(value, targetLength, padString);\n}\n\nvar DBL_QUOTE = \"\\\"\";\nvar INVALID_JS_NAME = /([^\\w\\d_$])/g;\nvar _htmlEntityCache;\n/*#__NO_SIDE_EFFECTS__*/\nfunction normalizeJsName(jsName, camelCase) {\n    var result = asString(jsName).replace(INVALID_JS_NAME, \"_\");\n    return !isUndefined(camelCase) ? strCamelCase(result, !camelCase) : result;\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction encodeAsJson(value, format) {\n    var result;\n    if (isString(value)) {\n        result = DBL_QUOTE + value.replace(/[^\\w .,\\-!@#$%\\^&*\\(\\)_+={}\\[\\]:;|<>?]/g, function (match) {\n            if (match === DBL_QUOTE || match === \"\\\\\") {\n                return \"\\\\\" + match;\n            }\n            var hex = match.charCodeAt(0)[TO_STRING](16);\n            return \"\\\\u\" + strPadStart(strUpper(hex), 4, \"0\");\n        }) + DBL_QUOTE;\n    }\n    else {\n        try {\n            result = JSON.stringify(value, NULL_VALUE, format ? (isNumber(format) ? format : 4) : UNDEF_VALUE);\n        }\n        catch (e) {\n            result = DBL_QUOTE + dumpObj(e) + DBL_QUOTE;\n        }\n    }\n    return result;\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction encodeAsHtml(value) {\n    !_htmlEntityCache && (_htmlEntityCache = {\n        \"&\": \"amp\",\n        \"<\": \"lt\",\n        \">\": \"gt\",\n        \"\\\"\": \"quot\",\n        \"'\": \"#39\"\n    });\n    return asString(value).replace(/[&<>\"']/g, function (match) { return \"&\" + _htmlEntityCache[match] + \";\"; });\n}\n\nvar _fnToString;\nvar _objCtrFnString;\nvar _gblWindow;\n/*#__NO_SIDE_EFFECTS__*/\nfunction isPlainObject(value) {\n    if (!value || typeof value !== OBJECT) {\n        return false;\n    }\n    if (!_gblWindow) {\n        _gblWindow = hasWindow() ? getWindow() : true;\n    }\n    var result = false;\n    if (value !== _gblWindow) {\n        if (!_objCtrFnString) {\n            _fnToString = Function[PROTOTYPE][TO_STRING];\n            _objCtrFnString = _fnToString[CALL](ObjClass);\n        }\n        try {\n            var proto = objGetPrototypeOf(value);\n            result = !proto;\n            if (!result) {\n                if (objHasOwnProperty(proto, CONSTRUCTOR)) {\n                    proto = proto[CONSTRUCTOR];\n                }\n                result = !!(proto && typeof proto === FUNCTION && _fnToString[CALL](proto) === _objCtrFnString);\n            }\n        }\n        catch (ex) {\n        }\n    }\n    return result;\n}\n\n/*#__NO_SIDE_EFFECTS__*/\nfunction _defaultDeepCopyHandler(details) {\n    details.value && plainObjDeepCopyHandler(details);\n    return true;\n}\nvar defaultDeepCopyHandlers = [\n    arrayDeepCopyHandler,\n    plainObjDeepCopyHandler,\n    functionDeepCopyHandler,\n    dateDeepCopyHandler\n];\n/*#__NO_SIDE_EFFECTS__*/\nfunction _getSetVisited(visitMap, source, newPath, cb) {\n    var theEntry;\n    arrForEach(visitMap, function (entry) {\n        if (entry.k === source) {\n            theEntry = entry;\n            return -1;\n        }\n    });\n    if (!theEntry) {\n        theEntry = { k: source, v: source };\n        visitMap.push(theEntry);\n        cb(theEntry);\n    }\n    return theEntry.v;\n}\nfunction _deepCopy(visitMap, value, ctx, key) {\n    var userHandler = ctx.handler;\n    var newPath = ctx.path ? (key ? ctx.path.concat(key) : ctx.path) : [];\n    var newCtx = {\n        handler: ctx.handler,\n        src: ctx.src,\n        path: newPath\n    };\n    var theType = typeof value;\n    var isPlain = false;\n    var isPrim = value === NULL_VALUE;\n    if (!isPrim) {\n        if (value && theType === OBJECT) {\n            isPlain = isPlainObject(value);\n        }\n        else {\n            isPrim = isPrimitiveType(theType);\n        }\n    }\n    var details = {\n        type: theType,\n        isPrim: isPrim,\n        isPlain: isPlain,\n        value: value,\n        result: value,\n        path: newPath,\n        origin: ctx.src,\n        copy: function (source, newKey) {\n            return _deepCopy(visitMap, source, newKey ? newCtx : ctx, newKey);\n        },\n        copyTo: function (target, source) {\n            return _copyProps(visitMap, target, source, newCtx);\n        }\n    };\n    if (!details.isPrim) {\n        return _getSetVisited(visitMap, value, newPath, function (newEntry) {\n            objDefine(details, \"result\", {\n                g: function () {\n                    return newEntry.v;\n                },\n                s: function (newValue) {\n                    newEntry.v = newValue;\n                }\n            });\n            var idx = 0;\n            var handler = userHandler;\n            while (!(handler || (idx < defaultDeepCopyHandlers.length ? defaultDeepCopyHandlers[idx++] : _defaultDeepCopyHandler))[CALL](ctx, details)) {\n                handler = NULL_VALUE;\n            }\n        });\n    }\n    if (userHandler && userHandler[CALL](ctx, details)) {\n        return details.result;\n    }\n    return value;\n}\nfunction _copyProps(visitMap, target, source, ctx) {\n    if (!isNullOrUndefined(source)) {\n        for (var key in source) {\n            target[key] = _deepCopy(visitMap, source[key], ctx, key);\n        }\n    }\n    return target;\n}\nfunction objCopyProps(target, source, handler) {\n    var ctx = {\n        handler: handler,\n        src: source,\n        path: []\n    };\n    return _copyProps([], target, source, ctx);\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction objDeepCopy(source, handler) {\n    var ctx = {\n        handler: handler,\n        src: source\n    };\n    return _deepCopy([], source, ctx);\n}\nfunction arrayDeepCopyHandler(details) {\n    var value = details.value;\n    if (isArray(value)) {\n        var target = details.result = [];\n        target.length = value.length;\n        details.copyTo(target, value);\n        return true;\n    }\n    return false;\n}\nfunction dateDeepCopyHandler(details) {\n    var value = details.value;\n    if (isDate(value)) {\n        details.result = new Date(value.getTime());\n        return true;\n    }\n    return false;\n}\nfunction functionDeepCopyHandler(details) {\n    if (details.type === FUNCTION) {\n        return true;\n    }\n    return false;\n}\nfunction plainObjDeepCopyHandler(details) {\n    var value = details.value;\n    if (value && details.isPlain) {\n        var target = details.result = {};\n        details.copyTo(target, value);\n        return true;\n    }\n    return false;\n}\n\nfunction _doExtend(target, theArgs) {\n    arrForEach(theArgs, function (theArg) {\n        objCopyProps(target, theArg);\n    });\n    return target;\n}\nfunction deepExtend(target, obj1, obj2, obj3, obj4, obj5, obj6) {\n    return _doExtend(objDeepCopy(target) || {}, ArrSlice[CALL](arguments));\n}\nfunction objExtend(target, obj1, obj2, obj3, obj4, obj5, obj6) {\n    return _doExtend(target || {}, ArrSlice[CALL](arguments));\n}\n\nvar getLength = ( /*#__PURE__*/_unwrapProp(LENGTH));\n\n/*#__NO_SIDE_EFFECTS__*/\nfunction getIntValue(value, defValue) {\n    if (!isNullOrUndefined(value)) {\n        if (isNumber(value)) {\n            return value;\n        }\n        var theValue = parseInt(value, 10);\n        return isNaN(theValue) ? defValue : theValue;\n    }\n    return defValue;\n}\n\nvar _perf;\n/*#__NO_SIDE_EFFECTS__*/\nfunction hasPerformance() {\n    return !!getPerformance();\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction getPerformance() {\n    !_globalLazyTestHooks && _initTestHooks();\n    if (!_perf || _globalLazyTestHooks.lzy) {\n        _perf = createCachedValue(safe((getInst), [\"performance\"]).v);\n    }\n    return _perf.v;\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction perfNow() {\n    var perf = getPerformance();\n    if (perf && perf.now) {\n        return perf.now();\n    }\n    return utcNow();\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction elapsedTime(startTime) {\n    return perfNow() - startTime;\n}\n\nvar MATCH_ANY = \"(.*)\";\nvar MATCH_SINGLE = \"(.)\";\nfunction _createRegExp(value, escapeRgx, replaceFn, ignoreCase, fullMatch) {\n    // eslint-disable-next-line security/detect-non-literal-regexp\n    return new RegExp((fullMatch ? \"^\" : EMPTY) + replaceFn(value.replace(escapeRgx, \"\\\\$1\")) + (fullMatch ? \"$\" : EMPTY), ignoreCase ? \"i\" : \"\");\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction createWildcardRegex(value, ignoreCase, fullMatch) {\n    return _createRegExp(asString(value), /([-+|^$#.\\?{}()\\[\\]\\\\/\\\"\\'])/g, function (value) {\n        return value.replace(/\\*/g, MATCH_ANY);\n    }, !!ignoreCase, fullMatch);\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction createFilenameRegex(value, ignoreCase, fullMatch) {\n    return _createRegExp(asString(value), /([-+|^$#.{}()\\\\\\/\\[\\]\\\"\\'])/g, function (value) {\n        return value.replace(/(\\\\\\\\|\\\\\\/|\\*|\\?)/g, function (_all, g1) {\n            if (g1 == \"\\\\/\" || g1 == \"\\\\\\\\\") {\n                return \"[\\\\\\\\\\\\/]{1}\";\n            }\n            return g1 == \"*\" ? MATCH_ANY : MATCH_SINGLE;\n        });\n    }, !!ignoreCase, fullMatch);\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction makeGlobRegex(value, ignoreCase, fullMatch) {\n    return _createRegExp(asString(value), /([-+|^$#.{}()\\\\\\/\\[\\]\\\"\\'])/g, function (value) {\n        return value.replace(/(\\*\\*\\\\[\\\\\\/]|\\\\\\\\|\\\\\\/|\\*\\*|\\*|\\?)/g, function (_all, g1) {\n            if (g1 == \"**\\\\/\" || g1 == \"**\\\\\\\\\") {\n                return \"(.*[\\\\\\\\\\\\/])*\";\n            }\n            if (g1 === \"\\\\/\" || g1 == \"\\\\\\\\\") {\n                return \"[\\\\\\\\\\\\/]{1}\";\n            }\n            if (g1 === \"**\") {\n                return MATCH_ANY;\n            }\n            return g1 === \"*\" ? \"([^\\\\\\\\\\\\/]*)\" : \"([^\\\\\\\\\\\\/]{1})\";\n        });\n    }, !!ignoreCase, fullMatch);\n}\n\n/*#__NO_SIDE_EFFECTS__*/\nfunction safeGetLazy(cb, defValue) {\n    return getLazy(function () {\n        var result = safe(cb);\n        return result.e ? defValue : result.v;\n    });\n}\n\n/*#__NO_SIDE_EFFECTS__*/\nfunction _checkLength(value, props) {\n    var result;\n    arrForEach(props, function (prop) {\n        if (prop in value) {\n            var propValue = value[prop];\n            result = (isFunction(propValue) ? propValue() : propValue) > 0;\n            return -1;\n        }\n    });\n    return result;\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction _hasValue(value, depth) {\n    var result = value === false || value === 0;\n    if (!result && !isNullOrUndefined(value)) {\n        if (isArray(value)) {\n            result = value[LENGTH] > 0;\n        }\n        else if (isDate(value)) {\n            result = !isNaN(value.getTime());\n        }\n        else if (isBoolean(value)) {\n            return true;\n        }\n        else if (isObject(value)) {\n            try {\n                var chkValue = _checkLength(value, [LENGTH, \"byteLength\", \"size\", \"count\"]);\n                if (isBoolean(chkValue)) {\n                    return chkValue;\n                }\n                if (isFunction(value.valueOf) && depth < 5) {\n                    return _hasValue(value.valueOf(), ++depth);\n                }\n            }\n            catch (e) {\n            }\n            return !!objKeys(value)[LENGTH];\n        }\n        else {\n            result = isTruthy(value);\n        }\n    }\n    return result;\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction hasValue(value) {\n    return _hasValue(value, 0);\n}\n\n/*#__NO_SIDE_EFFECTS__*/\nfunction createIterable(ctx) {\n    return makeIterable({}, ctx);\n}\nfunction makeIterable(target, ctx) {\n    var itSymbol = getKnownSymbol(3 );\n    function _createIterator() {\n        return createIterator(ctx);\n    }\n    target[itSymbol] = _createIterator;\n    return target;\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction createIterator(ctx) {\n    var isDone = false;\n    function _value() {\n        return ctx.v;\n    }\n    function _next() {\n        if (!isDone) {\n            isDone = (ctx.n ? ctx.n(arguments) : true);\n        }\n        var result = {\n            done: isDone\n        };\n        if (!isDone) {\n            objDefine(result, \"value\", { g: _value });\n        }\n        return result;\n    }\n    function _return(value) {\n        isDone = true;\n        return {\n            done: true,\n            value: ctx.r && ctx.r(value)\n        };\n    }\n    function _throw(e) {\n        isDone = true;\n        return {\n            done: true,\n            value: ctx.t && ctx.t(e)\n        };\n    }\n    var theIterator = {\n        next: _next\n    };\n    if (ctx.r) {\n        theIterator.return = _return;\n    }\n    if (ctx.t) {\n        theIterator.throw = _throw;\n    }\n    return theIterator;\n}\n\n/*#__NO_SIDE_EFFECTS__*/\nfunction createArrayIterator(values) {\n    var idx = -1;\n    var theValues = values ? values.slice() : [];\n    var len = theValues[LENGTH];\n    function _value() {\n        if (idx >= 0 && idx < len) {\n            return theValues[idx];\n        }\n    }\n    function _getNext() {\n        idx++;\n        return idx >= len;\n    }\n    var ctx = {\n        n: _getNext\n    };\n    objDefine(ctx, \"v\", { g: _value });\n    return createIterator(ctx);\n}\n\n/*#__NO_SIDE_EFFECTS__*/\nfunction createRangeIterator(start, end, step) {\n    var nextValue = start;\n    var theValue = UNDEF_VALUE;\n    if (isNullOrUndefined(end)) {\n        end = start;\n    }\n    var theStep = step;\n    if (!theStep) {\n        theStep = (start <= end) ? 1 : -1;\n    }\n    function _value() {\n        return theValue;\n    }\n    function _getNext() {\n        var isDone = (theStep > 0) ? (nextValue > end) : (nextValue < end);\n        if (!isDone) {\n            theValue = nextValue;\n            nextValue += theStep;\n        }\n        return isDone;\n    }\n    return createIterator(objDefine({\n        n: _getNext\n    }, \"v\", { g: _value }));\n}\n\n/*#__NO_SIDE_EFFECTS__*/\nfunction polyStrSymSplit(value, splitter, limit) {\n    var splitFn = splitter ? splitter[getKnownSymbol(9 )] : UNDEF_VALUE;\n    return splitFn ? splitFn(value, limit) : [value];\n}\n\nvar strSplit = ( /*#__PURE__*/_unwrapFunction(\"split\", StrProto));\nvar strSymSplit = ( /*#__PURE__*/_unwrapFunctionWithPoly(\"split\", StrProto, !hasSymbol() ? polyStrSymSplit : NULL_VALUE));\n\n/*#__NO_SIDE_EFFECTS__*/\nfunction getValueByKey(target, path, defValue) {\n    if (!path || !target) {\n        return defValue;\n    }\n    var parts = strSplit(path, \".\");\n    var cnt = parts.length;\n    for (var lp = 0; lp < cnt && !isNullOrUndefined(target); lp++) {\n        target = target[parts[lp]];\n    }\n    return (!isNullOrUndefined(target) ? target : defValue);\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction getValueByIter(target, iter, defValue) {\n    if (!iter || !target) {\n        return defValue;\n    }\n    iterForOf(iter, function (value) {\n        if (isNullOrUndefined(target)) {\n            return -1;\n        }\n        target = target[value];\n    });\n    return (!isNullOrUndefined(target) ? target : defValue);\n}\nfunction setValueByKey(target, path, value) {\n    if (target && path) {\n        var parts = strSplit(path, \".\");\n        var lastKey = parts.pop();\n        arrForEach(parts, function (key) {\n            if (isNullOrUndefined(target[key])) {\n                target[key] = {};\n            }\n            target = target[key];\n        });\n        target[lastKey] = value;\n    }\n}\nfunction setValueByIter(target, iter, value) {\n    if (target && iter) {\n        var lastKey_1;\n        iterForOf(iter, function (key) {\n            if (lastKey_1) {\n                if (isNullOrUndefined(target[lastKey_1])) {\n                    target[lastKey_1] = {};\n                }\n                target = target[lastKey_1];\n            }\n            lastKey_1 = key;\n        });\n        target[lastKey_1] = value;\n    }\n}\n\nvar strEndsWith = ( /*#__PURE__*/_unwrapFunctionWithPoly(\"endsWith\", StrProto, polyStrEndsWith));\n/*#__NO_SIDE_EFFECTS__*/\nfunction polyStrEndsWith(value, searchString, length) {\n    if (!isString(value)) {\n        throwTypeError(\"'\" + dumpObj(value) + \"' is not a string\");\n    }\n    var searchValue = isString(searchString) ? searchString : asString(searchString);\n    var end = (!isUndefined(length) && length < value[LENGTH]) ? length : value[LENGTH];\n    return strSubstring(value, end - searchValue[LENGTH], end) === searchValue;\n}\n\nvar strIndexOf = ( /*#__PURE__*/_unwrapFunction(\"indexOf\", StrProto));\nvar strLastIndexOf = ( /*#__PURE__*/_unwrapFunction(\"lastIndexOf\", StrProto));\n\nvar strIncludes = ( /*#__PURE__*/_unwrapFunctionWithPoly(\"includes\", StrProto, polyStrIncludes));\nvar strContains = ( /*#__PURE__*/_pureAssign(strIncludes));\n/*#__NO_SIDE_EFFECTS__*/\nfunction polyStrIncludes(value, searchString, position) {\n    if (isRegExp(searchString)) {\n        throwTypeError(\"'searchString' must not be a regular expression\" + dumpObj(searchString));\n    }\n    return strIndexOf(value, asString(searchString), position) !== -1;\n}\n\n/*#__NO_SIDE_EFFECTS__*/\nfunction strIsNullOrWhiteSpace(value) {\n    if (isString(value)) {\n        return value.replace(/[\\s\\t\\r\\n\\f]+/g, EMPTY) === EMPTY;\n    }\n    return isNullOrUndefined(value);\n}\n/*#__NO_SIDE_EFFECTS__*/\nfunction strIsNullOrEmpty(value) {\n    if (isString(value)) {\n        return value === EMPTY;\n    }\n    return isNullOrUndefined(value);\n}\n\nvar strStartsWith = ( /*#__PURE__*/_unwrapFunctionWithPoly(\"startsWith\", StrProto, polyStrStartsWith));\n/*#__NO_SIDE_EFFECTS__*/\nfunction polyStrStartsWith(value, searchString, position) {\n    if (!isString(value)) {\n        throwTypeError(\"'\" + dumpObj(value) + \"' is not a string\");\n    }\n    var searchValue = isString(searchString) ? searchString : asString(searchString);\n    var pos = position > 0 ? position : 0;\n    return strSubstring(value, pos, pos + searchValue[LENGTH]) === searchValue;\n}\n\nvar REF = \"ref\";\nvar UNREF = \"unref\";\nvar HAS_REF = \"hasRef\";\nvar ENABLED = \"enabled\";\n/*#__NO_SIDE_EFFECTS__*/\nfunction _createTimerHandler(startTimer, refreshFn, cancelFn) {\n    var ref = true;\n    var timerId = startTimer ? refreshFn(NULL_VALUE) : NULL_VALUE;\n    var theTimerHandler;\n    function _unref() {\n        ref = false;\n        timerId && timerId[UNREF] && timerId[UNREF]();\n        return theTimerHandler;\n    }\n    function _cancel() {\n        timerId && cancelFn(timerId);\n        timerId = NULL_VALUE;\n    }\n    function _refresh() {\n        timerId = refreshFn(timerId);\n        if (!ref) {\n            _unref();\n        }\n        return theTimerHandler;\n    }\n    function _setEnabled(value) {\n        !value && timerId && _cancel();\n        value && !timerId && _refresh();\n    }\n    theTimerHandler = {\n        cancel: _cancel,\n        refresh: _refresh\n    };\n    theTimerHandler[HAS_REF] = function () {\n        if (timerId && timerId[HAS_REF]) {\n            return timerId[HAS_REF]();\n        }\n        return ref;\n    };\n    theTimerHandler[REF] = function () {\n        ref = true;\n        timerId && timerId[REF] && timerId[REF]();\n        return theTimerHandler;\n    };\n    theTimerHandler[UNREF] = _unref;\n    theTimerHandler = objDefineProp(theTimerHandler, ENABLED, {\n        get: function () { return !!timerId; },\n        set: _setEnabled\n    });\n    return {\n        h: theTimerHandler,\n        dn: function () {\n            timerId = NULL_VALUE;\n        }\n    };\n}\n\nfunction _createTimeoutWith(startTimer, overrideFn, theArgs) {\n    var isArr = isArray(overrideFn);\n    var len = isArr ? overrideFn.length : 0;\n    var setFn = (len > 0 ? overrideFn[0] : (!isArr ? overrideFn : UNDEF_VALUE)) || setTimeout;\n    var clearFn = (len > 1 ? overrideFn[1] : UNDEF_VALUE) || clearTimeout;\n    var timerFn = theArgs[0];\n    theArgs[0] = function () {\n        handler.dn();\n        fnApply(timerFn, UNDEF_VALUE, ArrSlice[CALL](arguments));\n    };\n    var handler = _createTimerHandler(startTimer, function (timerId) {\n        if (timerId) {\n            if (timerId.refresh) {\n                timerId.refresh();\n                return timerId;\n            }\n            fnApply(clearFn, UNDEF_VALUE, [timerId]);\n        }\n        return fnApply(setFn, UNDEF_VALUE, theArgs);\n    }, function (timerId) {\n        fnApply(clearFn, UNDEF_VALUE, [timerId]);\n    });\n    return handler.h;\n}\nfunction scheduleTimeout(callback, timeout) {\n    return _createTimeoutWith(true, UNDEF_VALUE, ArrSlice[CALL](arguments));\n}\nfunction scheduleTimeoutWith(overrideFn, callback, timeout) {\n    return _createTimeoutWith(true, overrideFn, ArrSlice[CALL](arguments, 1));\n}\nfunction createTimeout(callback, timeout) {\n    return _createTimeoutWith(false, UNDEF_VALUE, ArrSlice[CALL](arguments));\n}\nfunction createTimeoutWith(overrideFn, callback, timeout) {\n    return _createTimeoutWith(false, overrideFn, ArrSlice[CALL](arguments, 1));\n}\n\nvar _defaultIdleTimeout = 100;\nvar _maxExecutionTime = 50;\n/*#__NO_SIDE_EFFECTS__*/\nfunction hasIdleCallback() {\n    return !!( /*#__PURE__*/getIdleCallback());\n}\nvar getIdleCallback = ( /*#__PURE__*/_getGlobalInstFn(getInst, [\"requestIdleCallback\"]));\nvar getCancelIdleCallback = ( /*#__PURE__*/_getGlobalInstFn(getInst, [\"cancelIdleCallback\"]));\nfunction setDefaultIdleTimeout(timeout) {\n    _defaultIdleTimeout = timeout;\n}\nfunction setDefaultMaxExecutionTime(maxTime) {\n    _maxExecutionTime = maxTime;\n}\nfunction scheduleIdleCallback(callback, options) {\n    function _createDeadline(timedOut) {\n        var startTime = perfNow();\n        return {\n            didTimeout: timedOut,\n            timeRemaining: function () {\n                return _maxExecutionTime - elapsedTime(startTime);\n            }\n        };\n    }\n    if (hasIdleCallback()) {\n        var handler_1 = _createTimerHandler(true, function (idleId) {\n            idleId && getCancelIdleCallback()(idleId);\n            return getIdleCallback()(function (deadline) {\n                handler_1.dn();\n                callback(deadline || _createDeadline(false));\n            }, options);\n        }, function (idleId) {\n            getCancelIdleCallback()(idleId);\n        });\n        return handler_1.h;\n    }\n    var timeout = (options || {}).timeout;\n    if (isUndefined(timeout)) {\n        timeout = _defaultIdleTimeout;\n    }\n    return scheduleTimeout(function () {\n        callback(_createDeadline(true));\n    }, timeout);\n}\n\nfunction scheduleInterval(callback, timeout) {\n    var theArguments = ArrSlice[CALL](arguments);\n    var handler = _createTimerHandler(true, function (intervalId) {\n        intervalId && clearInterval(intervalId);\n        return fnApply(setInterval, UNDEF_VALUE, theArguments);\n    }, function (intervalId) {\n        fnApply(clearInterval, UNDEF_VALUE, [intervalId]);\n    });\n    return handler.h;\n}\n\nexport { arrAppend, arrContains, arrEvery, arrFilter, arrFind, arrFindIndex, arrFindLast, arrFindLastIndex, arrForEach, arrFrom, arrIncludes, arrIndexOf, arrLastIndexOf, arrMap, arrReduce, arrSlice, arrSome, arrayDeepCopyHandler, asString, createArrayIterator, createCachedValue, createCustomError, createDeferredCachedValue, createEnum, createEnumKeyMap, createEnumValueMap, createFilenameRegex, createFnDeferredProxy, createIterable, createIterator, createProxyFuncs, createRangeIterator, createSimpleMap, createTimeout, createTimeoutWith, createTypeMap, createWildcardRegex, dateDeepCopyHandler, deepExtend, dumpObj, elapsedTime, encodeAsHtml, encodeAsJson, fnApply, fnBind, fnCall, functionDeepCopyHandler, getCancelIdleCallback, getDocument, getGlobal, getHistory, getIdleCallback, getInst, getIntValue, getKnownSymbol, getLazy, getLength, getNavigator, getPerformance, getSymbol, getValueByIter, getValueByKey, getWindow, hasDocument, hasHistory, hasIdleCallback, hasNavigator, hasPerformance, hasSymbol, hasValue, hasWindow, isArray, isArrayBuffer, isBlob, isBoolean, isDate, isDefined, isError, isFile, isFormData, isFunction, isIterable, isIterator, isNode, isNotTruthy, isNullOrUndefined, isNumber, isObject, isPlainObject, isPrimitive, isPrimitiveType, isPromise, isPromiseLike, isRegExp, isStrictNullOrUndefined, isStrictUndefined, isString, isSymbol, isThenable, isTruthy, isTypeof, isUndefined, isWebWorker, iterForOf, lazySafeGetInst, makeGlobRegex, makeIterable, mathCeil, mathFloor, mathMax, mathMin, mathToInt, mathTrunc, newSymbol, normalizeJsName, objAssign, objCopyProps, objCreate, objDeepCopy, objDeepFreeze, objDefine, objDefineAccessors, objDefineGet, objDefineProp, objDefineProperties, objDefineProps, objEntries, objExtend, objForEachKey, objFreeze, objGetOwnPropertyDescriptor, objGetPrototypeOf, objHasOwn, objHasOwnProperty, objKeys, objSeal, objSetPrototypeOf, objToString, perfNow, plainObjDeepCopyHandler, polyArrFind, polyArrFindIndex, polyArrFindLast, polyArrFindLastIndex, polyArrFrom, polyArrIncludes, polyGetKnownSymbol, polyIsArray, polyNewSymbol, polyObjEntries, polyObjHasOwn, polyObjKeys, polyStrIncludes, polyStrSubstr, polyStrSymSplit, polyStrTrim, polyStrTrimEnd, polyStrTrimStart, polySymbolFor, polySymbolKeyFor, polyUtcNow, readArgs, safe, safeGet, safeGetLazy, scheduleIdleCallback, scheduleInterval, scheduleTimeout, scheduleTimeoutWith, setBypassLazyCache, setDefaultIdleTimeout, setDefaultMaxExecutionTime, setValueByIter, setValueByKey, strCamelCase, strContains, strEndsWith, strIncludes, strIndexOf, strIsNullOrEmpty, strIsNullOrWhiteSpace, strKebabCase, strLastIndexOf, strLeft, strLetterCase, strLower, strPadEnd, strPadStart, strRepeat, strRight, strSlice, strSnakeCase, strSplit, strStartsWith, strSubstr, strSubstring, strSymSplit, strTrim, strTrimEnd, strTrimLeft, strTrimRight, strTrimStart, strUpper, symbolFor, symbolKeyFor, throwError, throwRangeError, throwTypeError, throwUnsupported, utcNow };\n//# sourceMappingURL=ts-utils.js.map\n","/*---------------------------------------------------------\n * Copyright (C) Microsoft Corporation. All rights reserved.\n *--------------------------------------------------------*/\nvar InstantiationStatus;\n(function (InstantiationStatus) {\n    InstantiationStatus[InstantiationStatus[\"NOT_INSTANTIATED\"] = 0] = \"NOT_INSTANTIATED\";\n    InstantiationStatus[InstantiationStatus[\"INSTANTIATING\"] = 1] = \"INSTANTIATING\";\n    InstantiationStatus[InstantiationStatus[\"INSTANTIATED\"] = 2] = \"INSTANTIATED\";\n})(InstantiationStatus || (InstantiationStatus = {}));\nexport class BaseTelemetrySender {\n    constructor(key, clientFactory) {\n        // Whether or not the client has been instantiated\n        this._instantiationStatus = InstantiationStatus.NOT_INSTANTIATED;\n        // Queues used to store events until the sender is ready\n        this._eventQueue = [];\n        this._exceptionQueue = [];\n        this._clientFactory = clientFactory;\n        this._key = key;\n    }\n    /**\n     * Sends the event to the passed in telemetry client\n     * The sender does no telemetry level checks as those are done by the reporter.\n     * @param eventName The name of the event to log\n     * @param data The data contanied in the event\n     */\n    sendEventData(eventName, data) {\n        if (!this._telemetryClient) {\n            if (this._instantiationStatus !== InstantiationStatus.INSTANTIATED) {\n                this._eventQueue.push({ eventName, data });\n            }\n            return;\n        }\n        this._telemetryClient.logEvent(eventName, data);\n    }\n    /**\n     * Sends an exception to the passed in telemetry client\n     * The sender does no telemetry level checks as those are done by the reporter.\n     * @param exception The exception to collect\n     * @param data Data associated with the exception\n     */\n    sendErrorData(exception, data) {\n        if (!this._telemetryClient) {\n            if (this._instantiationStatus !== InstantiationStatus.INSTANTIATED) {\n                this._exceptionQueue.push({ exception, data });\n            }\n            return;\n        }\n        const errorData = { stack: exception.stack, message: exception.message, name: exception.name };\n        if (data) {\n            const errorProperties = data.properties || data;\n            data.properties = { ...errorProperties, ...errorData };\n        }\n        else {\n            data = { properties: errorData };\n        }\n        this._telemetryClient.logEvent(\"unhandlederror\", data);\n    }\n    /**\n     * Flushes the buffered telemetry data\n     */\n    async flush() {\n        return this._telemetryClient?.flush();\n    }\n    async dispose() {\n        if (this._telemetryClient) {\n            await this._telemetryClient.dispose();\n            this._telemetryClient = undefined;\n        }\n        return;\n    }\n    /**\n     * Flushes the queued events that existed before the client was instantiated\n     */\n    _flushQueues() {\n        this._eventQueue.forEach(({ eventName, data }) => this.sendEventData(eventName, data));\n        this._eventQueue = [];\n        this._exceptionQueue.forEach(({ exception, data }) => this.sendErrorData(exception, data));\n        this._exceptionQueue = [];\n    }\n    /**\n     * Instantiates the telemetry client to make the sender \"active\"\n     */\n    instantiateSender() {\n        if (this._instantiationStatus !== InstantiationStatus.NOT_INSTANTIATED) {\n            return;\n        }\n        this._instantiationStatus = InstantiationStatus.INSTANTIATING;\n        // Call the client factory to get the client and then let it know it's instatntiated\n        this._clientFactory(this._key).then(client => {\n            this._telemetryClient = client;\n            this._instantiationStatus = InstantiationStatus.INSTANTIATED;\n            this._flushQueues();\n        }).catch(err => {\n            console.error(err);\n            // If it failed to instntiate, then we don't want to try again.\n            // So we mark it as instantiated. See #94\n            this._instantiationStatus = InstantiationStatus.INSTANTIATED;\n        });\n    }\n}\n//# sourceMappingURL=baseTelemetrySender.js.map","/*---------------------------------------------------------\n * Copyright (C) Microsoft Corporation. All rights reserved.\n *--------------------------------------------------------*/\nexport class TelemetryUtil {\n    static applyReplacements(data, replacementOptions) {\n        for (const key of Object.keys(data)) {\n            for (const option of replacementOptions) {\n                if (option.lookup.test(key)) {\n                    if (option.replacementString !== undefined) {\n                        data[key] = option.replacementString;\n                    }\n                    else {\n                        delete data[key];\n                    }\n                }\n            }\n        }\n    }\n    /**\n     * Given a key / connection string checks if it is a valid 1DS key\n     * @param key The key to check if it's a valid 1DS key\n     */\n    static shouldUseOneDataSystemSDK(key) {\n        // Simple to check to ensure the key is the right length and the dashes are in the right spot\n        return (key.length === 74 &&\n            key[32] === \"-\" &&\n            key[41] === \"-\" &&\n            key[46] === \"-\" &&\n            key[51] === \"-\" &&\n            key[56] === \"-\" &&\n            key[69] === \"-\");\n    }\n    // This also includes the common properties which core mixes in\n    // __GDPR__COMMON__ \"common.os\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n    // __GDPR__COMMON__ \"common.nodeArch\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n    // __GDPR__COMMON__ \"common.platformversion\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n    // __GDPR__COMMON__ \"common.extname\" : { \"classification\": \"PublicNonPersonalData\", \"purpose\": \"FeatureInsight\" }\n    // __GDPR__COMMON__ \"common.extversion\" : { \"classification\": \"PublicNonPersonalData\", \"purpose\": \"FeatureInsight\" }\n    // __GDPR__COMMON__ \"common.vscodemachineid\" : { \"endPoint\": \"MacAddressHash\", \"classification\": \"EndUserPseudonymizedInformation\", \"purpose\": \"FeatureInsight\" }\n    // __GDPR__COMMON__ \"common.vscodesessionid\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n    // __GDPR__COMMON__ \"common.vscodeversion\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n    // __GDPR__COMMON__ \"common.uikind\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n    // __GDPR__COMMON__ \"common.remotename\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n    // __GDPR__COMMON__ \"common.isnewappinstall\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n    // __GDPR__COMMON__ \"common.product\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n    // __GDPR__COMMON__ \"common.telemetryclientversion\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n    static getAdditionalCommonProperties(osShim) {\n        return {\n            \"common.os\": osShim.platform,\n            \"common.nodeArch\": osShim.architecture,\n            \"common.platformversion\": (osShim.release || \"\").replace(/^(\\d+)(\\.\\d+)?(\\.\\d+)?(.*)/, \"$1$2$3\"),\n            // Do not change this string as it gets found and replaced upon packaging\n            \"common.telemetryclientversion\": \"0.9.8\"\n        };\n    }\n    // Get singleton instance of TelemetryUtil\n    static getInstance() {\n        if (!TelemetryUtil._instance) {\n            TelemetryUtil._instance = new TelemetryUtil();\n        }\n        return TelemetryUtil._instance;\n    }\n}\n//# sourceMappingURL=util.js.map","/*---------------------------------------------------------\n * Copyright (C) Microsoft Corporation. All rights reserved.\n *--------------------------------------------------------*/\nexport class BaseTelemetryReporter {\n    constructor(telemetrySender, vscodeAPI, initializationOptions) {\n        this.telemetrySender = telemetrySender;\n        this.vscodeAPI = vscodeAPI;\n        this.userOptIn = false;\n        this.errorOptIn = false;\n        this.disposables = [];\n        this._onDidChangeTelemetryLevel = new this.vscodeAPI.EventEmitter();\n        this.onDidChangeTelemetryLevel = this._onDidChangeTelemetryLevel.event;\n        this.telemetryLogger = this.vscodeAPI.env.createTelemetryLogger(this.telemetrySender, initializationOptions);\n        // Keep track of the user's opt-in status\n        this.updateUserOptIn();\n        this.telemetryLogger.onDidChangeEnableStates(() => {\n            this.updateUserOptIn();\n        });\n    }\n    /**\n     * Updates the user's telemetry opt-in status\n     */\n    updateUserOptIn() {\n        this.errorOptIn = this.telemetryLogger.isErrorsEnabled;\n        this.userOptIn = this.telemetryLogger.isUsageEnabled;\n        // The sender is lazy loaded so if telemetry is off it's not loaded in\n        if (this.telemetryLogger.isErrorsEnabled || this.telemetryLogger.isUsageEnabled) {\n            this.telemetrySender.instantiateSender();\n        }\n        this._onDidChangeTelemetryLevel.fire(this.telemetryLevel);\n    }\n    get telemetryLevel() {\n        if (this.errorOptIn && this.userOptIn) {\n            return \"all\";\n        }\n        else if (this.errorOptIn) {\n            return \"error\";\n        }\n        else {\n            return \"off\";\n        }\n    }\n    /**\n     * Internal function which logs telemetry events and takes extra options.\n     * @param eventName The name of the event\n     * @param properties The properties of the event\n     * @param measurements The measurements (numeric values) to send with the event\n     * @param sanitize Whether or not to sanitize to the properties and measures\n     * @param dangerous Whether or not to ignore telemetry level\n     */\n    internalSendTelemetryEvent(eventName, properties, measurements, dangerous) {\n        // If it's dangerous we skip going through the logger as the logger checks opt-in status, etc.\n        if (dangerous) {\n            this.telemetrySender.sendEventData(eventName, { properties, measurements });\n        }\n        else {\n            this.telemetryLogger.logUsage(eventName, { properties, measurements });\n        }\n    }\n    /**\n     * Given an event name, some properties, and measurements sends a telemetry event.\n     * Properties are sanitized on best-effort basis to remove sensitive data prior to sending.\n     * @param eventName The name of the event\n     * @param properties The properties to send with the event\n     * @param measurements The measurements (numeric values) to send with the event\n     */\n    sendTelemetryEvent(eventName, properties, measurements) {\n        this.internalSendTelemetryEvent(eventName, properties, measurements, false);\n    }\n    /**\n     * Sends a raw (unsanitized) telemetry event with the given properties and measurements.\n     * NOTE: This will not be logged to the output channel due to API limitations.\n     * @param eventName The name of the event\n     * @param properties The set of properties to add to the event in the form of a string key value pair\n     * @param measurements The set of measurements to add to the event in the form of a string key  number value pair\n     */\n    sendRawTelemetryEvent(eventName, properties, measurements) {\n        const modifiedProperties = { ...properties };\n        for (const propertyKey of Object.keys(modifiedProperties ?? {})) {\n            const propertyValue = modifiedProperties[propertyKey];\n            if (typeof propertyKey === \"string\" && propertyValue !== undefined) {\n                // Trusted values are not sanitized, which is what we want for raw telemetry\n                modifiedProperties[propertyKey] = new this.vscodeAPI.TelemetryTrustedValue(typeof propertyValue === \"string\" ? propertyValue : propertyValue.value);\n            }\n        }\n        this.sendTelemetryEvent(eventName, modifiedProperties, measurements);\n    }\n    /**\n     * **DANGEROUS** Given an event name, some properties, and measurements sends a telemetry event without checking telemetry setting\n     * Do not use unless in a controlled environment i.e. sending telmetry from a CI pipeline or testing during development\n     * @param eventName The name of the event\n     * @param properties The properties to send with the event\n     * @param measurements The measurements (numeric values) to send with the event\n     * @param sanitize Whether or not to sanitize to the properties and measures, defaults to true\n     */\n    sendDangerousTelemetryEvent(eventName, properties, measurements) {\n        // Since telemetry is probably off when sending dangerously, we must start the sender\n        this.telemetrySender.instantiateSender();\n        this.internalSendTelemetryEvent(eventName, properties, measurements, true);\n    }\n    /**\n     * Internal function which logs telemetry error events and takes extra options.\n     * @param eventName The name of the event\n     * @param properties The properties of the event\n     * @param measurements The measurements (numeric values) to send with the event\n     * @param sanitize Whether or not to sanitize to the properties and measures\n     * @param dangerous Whether or not to ignore telemetry level\n     */\n    internalSendTelemetryErrorEvent(eventName, properties, measurements, dangerous) {\n        if (dangerous) {\n            this.telemetrySender.sendEventData(eventName, { properties, measurements });\n        }\n        else {\n            this.telemetryLogger.logError(eventName, { properties, measurements });\n        }\n    }\n    /**\n     * Given an event name, some properties, and measurements sends an error event\n     * @param eventName The name of the event\n     * @param properties The properties to send with the event\n     * @param measurements The measurements (numeric values) to send with the event\n     */\n    sendTelemetryErrorEvent(eventName, properties, measurements) {\n        this.internalSendTelemetryErrorEvent(eventName, properties, measurements, false);\n    }\n    /**\n     * **DANGEROUS** Given an event name, some properties, and measurements sends a telemetry error event without checking telemetry setting\n     * Do not use unless in a controlled environment i.e. sending telmetry from a CI pipeline or testing during development\n     * @param eventName The name of the event\n     * @param properties The properties to send with the event\n     * @param measurements The measurements (numeric values) to send with the event\n     * @param sanitize Whether or not to run the properties and measures through sanitiziation, defaults to true\n     */\n    sendDangerousTelemetryErrorEvent(eventName, properties, measurements) {\n        // Since telemetry is probably off when sending dangerously, we must start the sender\n        this.telemetrySender.instantiateSender();\n        this.internalSendTelemetryErrorEvent(eventName, properties, measurements, true);\n    }\n    /**\n     * Disposes of the telemetry reporter\n     */\n    async dispose() {\n        await this.telemetrySender.dispose();\n        this.telemetryLogger.dispose();\n        return Promise.all(this.disposables.map(d => d.dispose()));\n    }\n}\n//# sourceMappingURL=baseTelemetryReporter.js.map","/*---------------------------------------------------------\n * Copyright (C) Microsoft Corporation. All rights reserved.\n *--------------------------------------------------------*/\nimport * as vscode from \"vscode\";\nimport { oneDataSystemClientFactory } from \"../common/1dsClientFactory\";\nimport { appInsightsClientFactory } from \"../common/appInsightsClientFactory\";\nimport { BaseTelemetryReporter } from \"../common/baseTelemetryReporter\";\nimport { BaseTelemetrySender } from \"../common/baseTelemetrySender\";\nimport { TelemetryUtil } from \"../common/util\";\nfunction getBrowserRelease(navigator) {\n    if (navigator.userAgentData) {\n        const browser = navigator.userAgentData.brands[navigator.userAgentData.brands.length - 1];\n        return `${navigator.userAgentData.platform} - ${browser?.brand} v${browser?.version}}`;\n    }\n    else {\n        // clean the user agent using the logic from here:\n        // https://github.com/microsoft/vscode/blob/main/src/vs/workbench/services/telemetry/browser/workbenchCommonProperties.ts#L14C1-L21C2\n        return navigator.userAgent.replace(/(\\d+\\.\\d+)(\\.\\d+)+/g, \"$1\");\n    }\n}\nexport default class TelemetryReporter extends BaseTelemetryReporter {\n    constructor(connectionString, replacementOptions) {\n        let clientFactory = (connectionString) => appInsightsClientFactory(connectionString, vscode.env.machineId, vscode.env.sessionId, undefined, replacementOptions);\n        // If key is usable by 1DS use the 1DS SDk\n        if (TelemetryUtil.shouldUseOneDataSystemSDK(connectionString)) {\n            clientFactory = (key) => oneDataSystemClientFactory(key, vscode);\n        }\n        const osShim = {\n            release: getBrowserRelease(navigator),\n            platform: \"web\",\n            architecture: \"web\",\n        };\n        const sender = new BaseTelemetrySender(connectionString, clientFactory);\n        // AIF is no longer supported\n        if (connectionString && (connectionString.indexOf(\"AIF\") === 0)) {\n            throw new Error(\"AIF keys are no longer supported. Please switch to 1DS keys for 1st party extensions\");\n        }\n        super(sender, vscode, { additionalCommonProperties: TelemetryUtil.getAdditionalCommonProperties(osShim) });\n    }\n}\n//# sourceMappingURL=telemetryReporter.js.map","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { BreezeChannelIdentifier } from \"@microsoft/applicationinsights-common\";\nimport { TelemetryUtil } from \"./util\";\nexport const appInsightsClientFactory = async (connectionString, machineId, sessionId, xhrOverride, replacementOptions) => {\n    let appInsightsClient;\n    try {\n        const basicAISDK = await import /* webpackMode: \"eager\" */(\"@microsoft/applicationinsights-web-basic\");\n        const extensionConfig = {};\n        if (xhrOverride) {\n            // Configure the channel to use a XHR Request override since it's not available in node\n            const channelConfig = {\n                alwaysUseXhrOverride: true,\n                httpXHROverride: xhrOverride\n            };\n            extensionConfig[BreezeChannelIdentifier] = channelConfig;\n        }\n        let instrumentationKey;\n        if (!connectionString.startsWith(\"InstrumentationKey=\")) {\n            instrumentationKey = connectionString;\n        }\n        const authConfig = instrumentationKey ? { instrumentationKey } : { connectionString };\n        appInsightsClient = new basicAISDK.ApplicationInsights({\n            ...authConfig,\n            disableAjaxTracking: true,\n            disableExceptionTracking: true,\n            disableFetchTracking: true,\n            disableCorrelationHeaders: true,\n            disableCookiesUsage: true,\n            autoTrackPageVisitTime: false,\n            emitLineDelimitedJson: false,\n            disableInstrumentationKeyValidation: true,\n            extensionConfig,\n        });\n    }\n    catch (e) {\n        return Promise.reject(e);\n    }\n    // Sets the appinsights client into a standardized form\n    const telemetryClient = {\n        logEvent: (eventName, data) => {\n            const properties = { ...data?.properties, ...data?.measurements };\n            if (replacementOptions?.length) {\n                TelemetryUtil.applyReplacements(properties, replacementOptions);\n            }\n            appInsightsClient?.track({\n                name: eventName,\n                data: properties,\n                baseType: \"EventData\",\n                ext: { user: { id: machineId, authId: machineId }, app: { sesId: sessionId } },\n                baseData: { name: eventName, properties: data?.properties, measurements: data?.measurements }\n            });\n        },\n        flush: async () => {\n            appInsightsClient?.flush(false);\n        },\n        dispose: async () => {\n            const unloadPromise = new Promise((resolve) => {\n                appInsightsClient?.unload(true, () => {\n                    resolve();\n                    appInsightsClient = undefined;\n                }, 1000);\n            });\n            return unloadPromise;\n        }\n    };\n    return telemetryClient;\n};\n//# sourceMappingURL=appInsightsClientFactory.js.map","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n/**\n * Configures 1DS properly and returns the core client object\n * @param key The ingestion key\n * @param xhrOverride An optional override to use for requests instead of the XHTMLRequest object. Useful for node environments\n * @returns The AI core object\n */\nconst getAICore = async (key, vscodeAPI, xhrOverride) => {\n    const oneDs = await import(/* webpackMode: \"eager\" */ \"@microsoft/1ds-core-js\");\n    const postPlugin = await import(/* webpackMode: \"eager\" */ \"@microsoft/1ds-post-js\");\n    const appInsightsCore = new oneDs.AppInsightsCore();\n    const collectorChannelPlugin = new postPlugin.PostChannel();\n    // Configure the app insights core to send to collector++ and disable logging of debug info\n    const coreConfig = {\n        instrumentationKey: key,\n        endpointUrl: \"https://mobile.events.data.microsoft.com/OneCollector/1.0\",\n        loggingLevelTelemetry: 0,\n        loggingLevelConsole: 0,\n        disableCookiesUsage: true,\n        disableDbgExt: true,\n        disableInstrumentationKeyValidation: true,\n        channels: [[\n                collectorChannelPlugin\n            ]]\n    };\n    if (xhrOverride) {\n        coreConfig.extensionConfig = {};\n        // Configure the channel to use a XHR Request override since it's not available in node\n        const channelConfig = {\n            alwaysUseXhrOverride: true,\n            httpXHROverride: xhrOverride\n        };\n        coreConfig.extensionConfig[collectorChannelPlugin.identifier] = channelConfig;\n    }\n    const config = vscodeAPI.workspace.getConfiguration(\"telemetry\");\n    const internalTesting = config.get(\"internalTesting\");\n    appInsightsCore.initialize(coreConfig, []);\n    appInsightsCore.addTelemetryInitializer((envelope) => {\n        envelope[\"ext\"] = envelope[\"ext\"] ?? {};\n        envelope[\"ext\"][\"web\"] = envelope[\"ext\"][\"web\"] ?? {};\n        envelope[\"ext\"][\"web\"][\"consentDetails\"] = \"{\\\"GPC_DataSharingOptIn\\\":false}\";\n        // Only add the remaining flags when `telemetry.internalTesting` is enabled\n        if (!internalTesting) {\n            return;\n        }\n        envelope[\"ext\"][\"utc\"] = envelope[\"ext\"][\"utc\"] ?? {};\n        // Sets it to be internal only based on Windows UTC flagging\n        envelope[\"ext\"][\"utc\"][\"flags\"] = 0x0000811ECD;\n    });\n    return appInsightsCore;\n};\n/**\n * Configures and creates a telemetry client using the 1DS sdk\n * @param key The ingestion key\n * @param xhrOverride An optional override to use for requests instead of the XHTMLRequest object. Useful for node environments\n */\nexport const oneDataSystemClientFactory = async (key, vscodeAPI, xhrOverride) => {\n    let appInsightsCore = await getAICore(key, vscodeAPI, xhrOverride);\n    const flushOneDS = async () => {\n        try {\n            const flushPromise = new Promise((resolve, reject) => {\n                if (!appInsightsCore) {\n                    resolve();\n                    return;\n                }\n                appInsightsCore.flush(true, (completedFlush) => {\n                    if (!completedFlush) {\n                        reject(\"Failed to flush app 1DS!\");\n                        return;\n                    }\n                });\n            });\n            return flushPromise;\n        }\n        catch (e) {\n            throw new Error(\"Failed to flush 1DS!\\n\" + e.message);\n        }\n    };\n    // Shape the app insights core from 1DS into a standard format\n    const telemetryClient = {\n        logEvent: (eventName, data) => {\n            try {\n                appInsightsCore?.track({\n                    name: eventName,\n                    baseData: { name: eventName, properties: data?.properties, measurements: data?.measurements }\n                });\n            }\n            catch (e) {\n                throw new Error(\"Failed to log event to app insights!\\n\" + e.message);\n            }\n        },\n        flush: flushOneDS,\n        dispose: async () => {\n            const disposePromise = new Promise((resolve) => {\n                if (!appInsightsCore) {\n                    resolve();\n                    return;\n                }\n                appInsightsCore.unload(false, () => {\n                    resolve();\n                    appInsightsCore = undefined;\n                    return;\n                }, 1000);\n            });\n            return disposePromise;\n        }\n    };\n    return telemetryClient;\n};\n//# sourceMappingURL=1dsClientFactory.js.map","/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ----------------------------------------------------------------------------------------- */\n'use strict';\n\nconst ral = require(\"./lib/common/ral\");\n\nmodule.exports = require('./lib/browser/main');\nmodule.exports.default = ral.default;","\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ServiceConnection = exports.ClientConnection = void 0;\nconst ral_1 = __importDefault(require(\"../common/ral\"));\nconst connection_1 = require(\"../common/connection\");\nclass ClientConnection extends connection_1.BaseClientConnection {\n    constructor(port) {\n        super();\n        this.port = port;\n        this.port.onmessage = ((event) => {\n            this.handleMessage(event.data);\n        });\n    }\n    postMessage(sharedArrayBuffer) {\n        this.port.postMessage(sharedArrayBuffer);\n    }\n}\nexports.ClientConnection = ClientConnection;\nclass ServiceConnection extends connection_1.BaseServiceConnection {\n    constructor(port) {\n        super();\n        this.port = port;\n        this.port.onmessage = (async (event) => {\n            try {\n                await this.handleMessage(event.data);\n            }\n            catch (error) {\n                (0, ral_1.default)().console.error(error);\n            }\n        });\n    }\n    postMessage(message) {\n        this.port.postMessage(message);\n    }\n}\nexports.ServiceConnection = ServiceConnection;\n//# sourceMappingURL=connection.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.MessageConnection = exports.ClientConnection = exports.ServiceConnection = void 0;\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nconst ril_1 = __importDefault(require(\"./ril\"));\nril_1.default.install();\n__exportStar(require(\"../common/api\"), exports);\nvar connection_1 = require(\"./connection\");\nObject.defineProperty(exports, \"ServiceConnection\", { enumerable: true, get: function () { return connection_1.ServiceConnection; } });\nObject.defineProperty(exports, \"ClientConnection\", { enumerable: true, get: function () { return connection_1.ClientConnection; } });\nvar messageConnection_1 = require(\"./messageConnection\");\nObject.defineProperty(exports, \"MessageConnection\", { enumerable: true, get: function () { return messageConnection_1.MessageConnection; } });\n//# sourceMappingURL=main.js.map","\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.MessageConnection = void 0;\nconst ral_1 = __importDefault(require(\"../common/ral\"));\nconst messageConnection_1 = require(\"../common/messageConnection\");\nclass MessageConnection extends messageConnection_1.BaseMessageConnection {\n    constructor(port) {\n        super();\n        this.port = port;\n    }\n    postMessage(message, transfer) {\n        transfer !== undefined ? this.port.postMessage(message, transfer) : this.port.postMessage(message);\n    }\n    listen() {\n        this.port.onmessage = (event) => {\n            this.handleMessage(event.data).catch((0, ral_1.default)().console.error);\n        };\n    }\n}\nexports.MessageConnection = MessageConnection;\n//# sourceMappingURL=messageConnection.js.map","\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst ral_1 = __importDefault(require(\"../common/ral\"));\nconst connection_1 = require(\"./connection\");\n// In Browser environments we can only encode / decode utf-8\nconst encoder = new TextEncoder();\nconst decoder = new TextDecoder();\nclass TestServiceConnection extends connection_1.ServiceConnection {\n    constructor(script, testCase) {\n        const url = testCase !== undefined ? `${script}?toRun=${testCase}` : script;\n        const worker = new Worker(url);\n        super(worker);\n        this.worker = worker;\n    }\n    terminate() {\n        this.worker.terminate();\n        return Promise.resolve(0);\n    }\n}\nconst _ril = Object.freeze({\n    type: ral_1.default.Type.Browser,\n    TextEncoder: Object.freeze({\n        create(encoding = 'utf-8') {\n            return encoder;\n        }\n    }),\n    TextDecoder: Object.freeze({\n        create(encoding = 'utf-8') {\n            return decoder;\n        }\n    }),\n    console: console,\n    timer: Object.freeze({\n        setTimeout(callback, ms, ...args) {\n            const handle = setTimeout(callback, ms, ...args);\n            return { dispose: () => clearTimeout(handle) };\n        },\n        setImmediate(callback, ...args) {\n            const handle = setTimeout(callback, 0, ...args);\n            return { dispose: () => clearTimeout(handle) };\n        },\n        setInterval(callback, ms, ...args) {\n            const handle = setInterval(callback, ms, ...args);\n            return { dispose: () => clearInterval(handle) };\n        },\n    }),\n    $testing: Object.freeze({\n        ClientConnection: Object.freeze({\n            create() {\n                return new connection_1.ClientConnection(self);\n            }\n        }),\n        ServiceConnection: Object.freeze({\n            create(script, testCase) {\n                return new TestServiceConnection(script, testCase);\n            }\n        }),\n        get testCase() {\n            const location = self.location;\n            const search = location.search;\n            return search.substring('?toRun='.length);\n        }\n    })\n});\nfunction RIL() {\n    return _ril;\n}\n(function (RIL) {\n    function install() {\n        ral_1.default.install(_ril);\n    }\n    RIL.install = install;\n})(RIL || (RIL = {}));\nexports.default = RIL;\n//# sourceMappingURL=ril.js.map","\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BaseMessageConnection = exports.Cancellation = exports.RAL = void 0;\n__exportStar(require(\"./connection\"), exports);\n__exportStar(require(\"./protocol\"), exports);\nconst ral_1 = __importDefault(require(\"./ral\"));\nexports.RAL = ral_1.default;\nvar messageCancellation_1 = require(\"./messageCancellation\");\nObject.defineProperty(exports, \"Cancellation\", { enumerable: true, get: function () { return messageCancellation_1.Cancellation; } });\nvar messageConnection_1 = require(\"./messageConnection\");\nObject.defineProperty(exports, \"BaseMessageConnection\", { enumerable: true, get: function () { return messageConnection_1.BaseMessageConnection; } });\n//# sourceMappingURL=api.js.map","\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nvar _Uint8Result_length, _Int8Result_length, _Uint16Result_length, _Int16Result_length, _Uint32Result_length, _Int32Result_length, _Uint64Result_length, _Int64Result_length, _VariableResult_mode;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BaseServiceConnection = exports.RequestResult = exports.BaseClientConnection = exports.RPCError = exports.RPCErrno = exports.VariableResult = exports.Int64Result = exports.Uint64Result = exports.Int32Result = exports.Uint32Result = exports.Int16Result = exports.Uint16Result = exports.Int8Result = exports.Uint8Result = exports.Notification = exports.Request = void 0;\nconst ral_1 = __importDefault(require(\"./ral\"));\nvar TypedArray;\n(function (TypedArray) {\n    function is(value) {\n        return value instanceof Uint8Array || value instanceof Int8Array || value instanceof Uint16Array || value instanceof Int16Array ||\n            value instanceof Uint32Array || value instanceof Int32Array || value instanceof BigUint64Array || value instanceof BigInt64Array;\n    }\n    TypedArray.is = is;\n    function set(sharedArrayBuffer, offset, data) {\n        if (data instanceof Uint8Array) {\n            new Uint8Array(sharedArrayBuffer, offset, data.length).set(data);\n        }\n        else if (data instanceof Int8Array) {\n            new Int8Array(sharedArrayBuffer, offset, data.length).set(data);\n        }\n        else if (data instanceof Uint16Array) {\n            new Uint16Array(sharedArrayBuffer, offset, data.length).set(data);\n        }\n        else if (data instanceof Int16Array) {\n            new Int16Array(sharedArrayBuffer, offset, data.length).set(data);\n        }\n        else if (data instanceof Uint32Array) {\n            new Uint32Array(sharedArrayBuffer, offset, data.length).set(data);\n        }\n        else if (data instanceof Int32Array) {\n            new Int32Array(sharedArrayBuffer, offset, data.length).set(data);\n        }\n        else if (data instanceof BigUint64Array) {\n            new BigUint64Array(sharedArrayBuffer, offset, data.length).set(data);\n        }\n        else if (data instanceof BigInt64Array) {\n            new BigInt64Array(sharedArrayBuffer, offset, data.length).set(data);\n        }\n        else {\n            throw new Error(`Unknown type array type`);\n        }\n    }\n    TypedArray.set = set;\n})(TypedArray || (TypedArray = {}));\nvar Request;\n(function (Request) {\n    function is(value) {\n        const candidate = value;\n        return candidate !== undefined && candidate !== null && typeof candidate.method === 'string';\n    }\n    Request.is = is;\n})(Request = exports.Request || (exports.Request = {}));\nvar Notification;\n(function (Notification) {\n    function is(value) {\n        const candidate = value;\n        return candidate !== undefined && candidate !== null && typeof candidate.method === 'string' && typeof candidate.id === 'undefined';\n    }\n    Notification.is = is;\n})(Notification = exports.Notification || (exports.Notification = {}));\nclass NoResult {\n    constructor() {\n    }\n    get kind() {\n        return NoResult.kind;\n    }\n    get byteLength() {\n        return 0;\n    }\n    get length() {\n        return 0;\n    }\n    getPadding(offset) {\n        return 0;\n    }\n    createResultArray(sharedArrayBuffer, offset) {\n        return new Uint8Array(sharedArrayBuffer, offset, 0);\n    }\n}\nNoResult.kind = 0;\nclass Uint8Result {\n    constructor(value) {\n        _Uint8Result_length.set(this, void 0);\n        __classPrivateFieldSet(this, _Uint8Result_length, value, \"f\");\n    }\n    static fromLength(length) {\n        return new Uint8Result(length);\n    }\n    static fromByteLength(byteLength) {\n        return new Uint8Result(byteLength);\n    }\n    get kind() {\n        return Uint8Result.kind;\n    }\n    get byteLength() {\n        return __classPrivateFieldGet(this, _Uint8Result_length, \"f\") * Uint8Array.BYTES_PER_ELEMENT;\n    }\n    get length() {\n        return __classPrivateFieldGet(this, _Uint8Result_length, \"f\");\n    }\n    getPadding(offset) {\n        return TypedArrayResult.getPadding(offset);\n    }\n    createResultArray(sharedArrayBuffer, offset) {\n        return new Uint8Array(sharedArrayBuffer, offset, this.length);\n    }\n    is(value) {\n        return value instanceof Uint8Array;\n    }\n}\nexports.Uint8Result = Uint8Result;\n_Uint8Result_length = new WeakMap();\nUint8Result.kind = 1;\nclass Int8Result {\n    constructor(value) {\n        _Int8Result_length.set(this, void 0);\n        __classPrivateFieldSet(this, _Int8Result_length, value, \"f\");\n    }\n    static fromLength(length) {\n        return new Int8Result(length);\n    }\n    static fromByteLength(byteLength) {\n        return new Int8Result(byteLength);\n    }\n    get kind() {\n        return Int8Result.kind;\n    }\n    get byteLength() {\n        return __classPrivateFieldGet(this, _Int8Result_length, \"f\") * Int8Array.BYTES_PER_ELEMENT;\n    }\n    get length() {\n        return __classPrivateFieldGet(this, _Int8Result_length, \"f\");\n    }\n    getPadding(offset) {\n        return TypedArrayResult.getPadding(offset);\n    }\n    createResultArray(sharedArrayBuffer, offset) {\n        return new Int8Array(sharedArrayBuffer, offset, this.length);\n    }\n    is(value) {\n        return value instanceof Int8Array;\n    }\n}\nexports.Int8Result = Int8Result;\n_Int8Result_length = new WeakMap();\nInt8Result.kind = 2;\nclass Uint16Result {\n    constructor(value) {\n        _Uint16Result_length.set(this, void 0);\n        __classPrivateFieldSet(this, _Uint16Result_length, value, \"f\");\n    }\n    static fromLength(length) {\n        return new Uint16Result(length);\n    }\n    static fromByteLength(byteLength) {\n        if (byteLength % Uint16Array.BYTES_PER_ELEMENT !== 0) {\n            throw new Error(`Byte length must be a multiple of ${Uint16Array.BYTES_PER_ELEMENT} but was ${byteLength}`);\n        }\n        return new Uint16Result(byteLength / Uint16Array.BYTES_PER_ELEMENT);\n    }\n    get kind() {\n        return Uint16Result.kind;\n    }\n    get byteLength() {\n        return __classPrivateFieldGet(this, _Uint16Result_length, \"f\") * Uint16Array.BYTES_PER_ELEMENT;\n    }\n    get length() {\n        return __classPrivateFieldGet(this, _Uint16Result_length, \"f\");\n    }\n    getPadding(offset) {\n        return TypedArrayResult.getPadding(offset);\n    }\n    createResultArray(sharedArrayBuffer, offset) {\n        return new Uint16Array(sharedArrayBuffer, offset, this.length);\n    }\n    is(value) {\n        return value instanceof Uint16Array;\n    }\n}\nexports.Uint16Result = Uint16Result;\n_Uint16Result_length = new WeakMap();\nUint16Result.kind = 3;\nclass Int16Result {\n    constructor(value) {\n        _Int16Result_length.set(this, void 0);\n        __classPrivateFieldSet(this, _Int16Result_length, value, \"f\");\n    }\n    static fromLength(length) {\n        return new Int16Result(length);\n    }\n    static fromByteLength(byteLength) {\n        if (byteLength % Int16Array.BYTES_PER_ELEMENT !== 0) {\n            throw new Error(`Byte length must be a multiple of ${Int16Array.BYTES_PER_ELEMENT} but was ${byteLength}`);\n        }\n        return new Int16Result(byteLength / Int16Array.BYTES_PER_ELEMENT);\n    }\n    get kind() {\n        return Int16Result.kind;\n    }\n    get byteLength() {\n        return __classPrivateFieldGet(this, _Int16Result_length, \"f\") * Int16Array.BYTES_PER_ELEMENT;\n    }\n    get length() {\n        return __classPrivateFieldGet(this, _Int16Result_length, \"f\");\n    }\n    getPadding(offset) {\n        return TypedArrayResult.getPadding(offset);\n    }\n    createResultArray(sharedArrayBuffer, offset) {\n        return new Int16Array(sharedArrayBuffer, offset, this.length);\n    }\n    is(value) {\n        return value instanceof Int16Array;\n    }\n}\nexports.Int16Result = Int16Result;\n_Int16Result_length = new WeakMap();\nInt16Result.kind = 4;\nclass Uint32Result {\n    constructor(value) {\n        _Uint32Result_length.set(this, void 0);\n        __classPrivateFieldSet(this, _Uint32Result_length, value, \"f\");\n    }\n    static fromLength(length) {\n        return new Uint32Result(length);\n    }\n    static fromByteLength(byteLength) {\n        if (byteLength % Uint32Array.BYTES_PER_ELEMENT !== 0) {\n            throw new Error(`Byte length must be a multiple of ${Uint32Array.BYTES_PER_ELEMENT} but was ${byteLength}`);\n        }\n        return new Uint32Result(byteLength / Uint32Array.BYTES_PER_ELEMENT);\n    }\n    get kind() {\n        return Uint32Result.kind;\n    }\n    get byteLength() {\n        return __classPrivateFieldGet(this, _Uint32Result_length, \"f\") * Uint32Array.BYTES_PER_ELEMENT;\n    }\n    get length() {\n        return __classPrivateFieldGet(this, _Uint32Result_length, \"f\");\n    }\n    getPadding(offset) {\n        return TypedArrayResult.getPadding(offset);\n    }\n    createResultArray(sharedArrayBuffer, offset) {\n        return new Uint32Array(sharedArrayBuffer, offset, this.length);\n    }\n    is(value) {\n        return value instanceof Uint32Array;\n    }\n}\nexports.Uint32Result = Uint32Result;\n_Uint32Result_length = new WeakMap();\nUint32Result.kind = 5;\nclass Int32Result {\n    constructor(value) {\n        _Int32Result_length.set(this, void 0);\n        __classPrivateFieldSet(this, _Int32Result_length, value, \"f\");\n    }\n    static fromLength(length) {\n        return new Int32Result(length);\n    }\n    static fromByteLength(byteLength) {\n        if (byteLength % Int32Array.BYTES_PER_ELEMENT !== 0) {\n            throw new Error(`Byte length must be a multiple of ${Int32Array.BYTES_PER_ELEMENT} but was ${byteLength}`);\n        }\n        return new Int32Result(byteLength / Int32Array.BYTES_PER_ELEMENT);\n    }\n    get kind() {\n        return Int32Result.kind;\n    }\n    get byteLength() {\n        return __classPrivateFieldGet(this, _Int32Result_length, \"f\") * Int32Array.BYTES_PER_ELEMENT;\n    }\n    get length() {\n        return __classPrivateFieldGet(this, _Int32Result_length, \"f\");\n    }\n    getPadding(offset) {\n        return TypedArrayResult.getPadding(offset);\n    }\n    createResultArray(sharedArrayBuffer, offset) {\n        return new Int32Array(sharedArrayBuffer, offset, this.length);\n    }\n    is(value) {\n        return value instanceof Int32Array;\n    }\n}\nexports.Int32Result = Int32Result;\n_Int32Result_length = new WeakMap();\nInt32Result.kind = 6;\nclass Uint64Result {\n    constructor(value) {\n        _Uint64Result_length.set(this, void 0);\n        __classPrivateFieldSet(this, _Uint64Result_length, value, \"f\");\n    }\n    static fromLength(length) {\n        return new Uint64Result(length);\n    }\n    static fromByteLength(byteLength) {\n        if (byteLength % BigUint64Array.BYTES_PER_ELEMENT !== 0) {\n            throw new Error(`Byte length must be a multiple of ${BigUint64Array.BYTES_PER_ELEMENT} but was ${byteLength}`);\n        }\n        return new Uint64Result(byteLength / BigUint64Array.BYTES_PER_ELEMENT);\n    }\n    get kind() {\n        return Uint64Result.kind;\n    }\n    get byteLength() {\n        return __classPrivateFieldGet(this, _Uint64Result_length, \"f\") * BigUint64Array.BYTES_PER_ELEMENT;\n    }\n    get length() {\n        return __classPrivateFieldGet(this, _Uint64Result_length, \"f\");\n    }\n    getPadding(offset) {\n        return BigUint64Array.BYTES_PER_ELEMENT - (offset % BigUint64Array.BYTES_PER_ELEMENT);\n    }\n    createResultArray(sharedArrayBuffer, offset) {\n        return new BigUint64Array(sharedArrayBuffer, offset, this.length);\n    }\n    is(value) {\n        return value instanceof BigUint64Array;\n    }\n}\nexports.Uint64Result = Uint64Result;\n_Uint64Result_length = new WeakMap();\nUint64Result.kind = 7;\nclass Int64Result {\n    constructor(value) {\n        _Int64Result_length.set(this, void 0);\n        __classPrivateFieldSet(this, _Int64Result_length, value, \"f\");\n    }\n    static fromLength(length) {\n        return new Int64Result(length);\n    }\n    static fromByteLength(byteLength) {\n        if (byteLength % BigInt64Array.BYTES_PER_ELEMENT !== 0) {\n            throw new Error(`Byte length must be a multiple of ${BigInt64Array.BYTES_PER_ELEMENT} but was ${byteLength}`);\n        }\n        return new Int64Result(byteLength / BigInt64Array.BYTES_PER_ELEMENT);\n    }\n    get kind() {\n        return Int64Result.kind;\n    }\n    get byteLength() {\n        return __classPrivateFieldGet(this, _Int64Result_length, \"f\") * BigInt64Array.BYTES_PER_ELEMENT;\n    }\n    get length() {\n        return __classPrivateFieldGet(this, _Int64Result_length, \"f\");\n    }\n    getPadding(offset) {\n        return BigInt64Array.BYTES_PER_ELEMENT - (offset % BigInt64Array.BYTES_PER_ELEMENT);\n    }\n    createResultArray(sharedArrayBuffer, offset) {\n        return new BigInt64Array(sharedArrayBuffer, offset, this.length);\n    }\n    is(value) {\n        return value instanceof BigInt64Array;\n    }\n}\nexports.Int64Result = Int64Result;\n_Int64Result_length = new WeakMap();\nInt64Result.kind = 8;\nclass VariableResult {\n    constructor(mode) {\n        _VariableResult_mode.set(this, void 0);\n        __classPrivateFieldSet(this, _VariableResult_mode, mode, \"f\");\n    }\n    get kind() {\n        return VariableResult.kind;\n    }\n    get mode() {\n        return __classPrivateFieldGet(this, _VariableResult_mode, \"f\");\n    }\n    get byteLength() {\n        return 0;\n    }\n    get length() {\n        return 0;\n    }\n    getPadding(_offset) {\n        return 0;\n    }\n}\nexports.VariableResult = VariableResult;\n_VariableResult_mode = new WeakMap();\nVariableResult.kind = 9;\nvar TypedArrayResult;\n(function (TypedArrayResult) {\n    function fromByteLength(kind, byteLength) {\n        switch (kind) {\n            case Uint8Result.kind:\n                return Uint8Result.fromByteLength(byteLength);\n            case Int8Result.kind:\n                return Int8Result.fromByteLength(byteLength);\n            case Uint16Result.kind:\n                return Uint16Result.fromByteLength(byteLength);\n            case Int16Result.kind:\n                return Int16Result.fromByteLength(byteLength);\n            case Uint32Result.kind:\n                return Uint32Result.fromByteLength(byteLength);\n            case Int32Result.kind:\n                return Int32Result.fromByteLength(byteLength);\n            case Uint64Result.kind:\n                return Uint64Result.fromByteLength(byteLength);\n            case Int64Result.kind:\n                return Int64Result.fromByteLength(byteLength);\n            case VariableResult.kind:\n                // send another request to get the result.\n                throw new Error(`No result array for variable results result type.`);\n            default:\n                throw new Error(`Unknown result kind ${kind}`);\n        }\n    }\n    TypedArrayResult.fromByteLength = fromByteLength;\n    /**\n     * For now we align everything on a 4 byte boundary\n     */\n    function getPadding(offset) {\n        return 4 - (offset % 4);\n    }\n    TypedArrayResult.getPadding = getPadding;\n})(TypedArrayResult || (TypedArrayResult = {}));\nvar ResultType;\n(function (ResultType) {\n    function is(value) {\n        return value instanceof Uint8Result || value instanceof Int8Result || value instanceof Uint16Result || value instanceof Int16Result ||\n            value instanceof Uint32Result || value instanceof Int32Result || value instanceof Uint64Result || value instanceof Int64Result ||\n            value instanceof VariableResult || value instanceof NoResult;\n    }\n    ResultType.is = is;\n})(ResultType || (ResultType = {}));\n/**\n * Errno numbers specific to the sync RPC calls. We start at 16384 to not collide\n * with POSIX error numbers.\n */\nvar RPCErrno;\n(function (RPCErrno) {\n    /**\n     * No error occurred. RPC  call completed successfully.\n     */\n    RPCErrno.Success = 0;\n    /**\n     * The sync RPC called timed out.\n     */\n    RPCErrno.TimedOut = 1;\n    /**\n     * A unknown error has occurred.\n     */\n    RPCErrno.UnknownError = 16384;\n    /**\n     * Fetching the lazy result from the service failed.\n     */\n    RPCErrno.LazyResultFailed = RPCErrno.UnknownError + 1;\n    /**\n     * No handler on the service side found.\n     */\n    RPCErrno.NoHandlerFound = RPCErrno.LazyResultFailed + 1;\n    /**\n     * Invalid message format.\n     */\n    RPCErrno.InvalidMessageFormat = RPCErrno.NoHandlerFound + 1;\n    /**\n     * Start of the custom error number range.\n     */\n    RPCErrno.$Custom = 32768;\n})(RPCErrno = exports.RPCErrno || (exports.RPCErrno = {}));\nclass RPCError extends Error {\n    constructor(errno, message) {\n        super(message);\n        this.errno = errno;\n    }\n}\nexports.RPCError = RPCError;\nclass BaseClientConnection {\n    constructor() {\n        this.sendRequest = this._sendRequest;\n        this.id = 1;\n        this.textEncoder = (0, ral_1.default)().TextEncoder.create();\n        this.textDecoder = (0, ral_1.default)().TextDecoder.create();\n        this.readyPromise = new Promise((resolve, reject) => {\n            this.readyCallbacks = { resolve, reject };\n        });\n    }\n    serviceReady() {\n        return this.readyPromise;\n    }\n    _sendRequest(method, arg1, arg2, arg3) {\n        const id = this.id++;\n        const request = { id: id, method };\n        let params = undefined;\n        let resultType = new NoResult();\n        let timeout = undefined;\n        if (ResultType.is(arg1)) {\n            resultType = arg1;\n        }\n        else if (typeof arg1 === 'number') {\n            timeout = arg1;\n        }\n        else if (arg1 !== undefined || arg1 !== null) {\n            params = arg1;\n        }\n        if (typeof arg2 === 'number') {\n            timeout = arg2;\n        }\n        else if (arg2 !== undefined) {\n            resultType = arg2;\n        }\n        if (typeof arg3 === 'number') {\n            timeout = arg3;\n        }\n        if (params !== undefined) {\n            request.params = {};\n            for (const property of Object.keys(params)) {\n                if (property !== 'binary') {\n                    request.params[property] = params[property];\n                }\n                else {\n                    request.params['binary'] = null;\n                }\n            }\n        }\n        const requestData = this.textEncoder.encode(JSON.stringify(request, undefined, 0));\n        const binaryData = params?.binary;\n        const binaryDataLength = binaryData !== undefined ? binaryData.byteLength : 0;\n        const requestOffset = 4 /* SyncSize.total */ + 32 /* HeaderSize.total */;\n        const binaryOffset = requestOffset + requestData.byteLength;\n        const resultByteLength = resultType.byteLength;\n        const resultPadding = resultType.getPadding(binaryOffset + binaryDataLength);\n        const resultOffset = (binaryOffset + binaryDataLength) + resultPadding;\n        const sharedArrayBufferLength = 4 /* SyncSize.total */ + 32 /* HeaderSize.total */ + requestData.byteLength + binaryDataLength + resultPadding + resultByteLength;\n        const sharedArrayBuffer = new SharedArrayBuffer(sharedArrayBufferLength);\n        const header = new Uint32Array(sharedArrayBuffer, 4 /* SyncSize.total */, 32 /* HeaderSize.total */ / 4);\n        header[0 /* HeaderIndex.messageOffset */] = requestOffset;\n        header[1 /* HeaderIndex.messageByteLength */] = requestData.byteLength;\n        header[2 /* HeaderIndex.binaryParamOffset */] = binaryOffset;\n        header[3 /* HeaderIndex.binaryParamByteLength */] = binaryDataLength;\n        header[4 /* HeaderIndex.errno */] = RPCErrno.Success;\n        header[5 /* HeaderIndex.resultKind */] = resultType.kind;\n        header[6 /* HeaderIndex.resultOffset */] = resultOffset;\n        header[7 /* HeaderIndex.resultByteLength */] = resultByteLength;\n        const raw = new Uint8Array(sharedArrayBuffer);\n        raw.set(requestData, requestOffset);\n        if (binaryData !== undefined) {\n            raw.set(binaryData, binaryOffset);\n        }\n        // Send the shard array buffer to the other worker\n        const sync = new Int32Array(sharedArrayBuffer, 0, 1);\n        Atomics.store(sync, 0, 0);\n        // Send the shared array buffer to the extension host worker\n        this.postMessage(sharedArrayBuffer);\n        // Wait for the answer\n        const result = Atomics.wait(sync, 0, 0, timeout);\n        switch (result) {\n            case 'timed-out':\n                return { errno: RPCErrno.TimedOut };\n            case 'not-equal':\n                const value = Atomics.load(sync, 0);\n                // If the value === 1 the service has already\n                // provided the result. Otherwise we actually\n                // don't know what happened :-(.\n                if (value !== 1) {\n                    return { errno: RPCErrno.UnknownError };\n                }\n        }\n        const errno = header[4 /* HeaderIndex.errno */];\n        if (errno !== 0) {\n            return { errno };\n        }\n        else {\n            switch (resultType.kind) {\n                case NoResult.kind:\n                    return { errno: 0 };\n                case VariableResult.kind:\n                    const lazyResultLength = header[7 /* HeaderIndex.resultByteLength */];\n                    if (lazyResultLength === 0) {\n                        return { errno: 0, data: resultType.mode === 'binary' ? new Uint8Array(0) : '' };\n                    }\n                    const lazyResult = this._sendRequest('$/fetchResult', { resultId: id }, Uint8Result.fromLength(lazyResultLength), timeout);\n                    if (lazyResult.errno !== 0) {\n                        return { errno: lazyResult.errno };\n                    }\n                    if (RequestResult.hasData(lazyResult)) {\n                        try {\n                            // We need to slice the Uint8Array we received since it is a view onto a\n                            // shared array buffer and in the browser the text decoder throws when\n                            // reading from a Uint8Array. Since this seems to be the correct behavior\n                            // anyways (the array could otherwise change underneath) we do the same\n                            // for NodeJS\n                            const data = resultType.mode === 'binary'\n                                ? lazyResult.data\n                                : JSON.parse(this.textDecoder.decode(lazyResult.data.slice()));\n                            return { errno: 0, data };\n                        }\n                        catch (error) {\n                            (0, ral_1.default)().console.error(error);\n                            return { errno: RPCErrno.LazyResultFailed };\n                        }\n                    }\n                    else {\n                        return { errno: RPCErrno.LazyResultFailed };\n                    }\n                default:\n                    return { errno: 0, data: resultType.createResultArray(sharedArrayBuffer, resultOffset) };\n            }\n        }\n    }\n    handleMessage(message) {\n        if (message.method === '$/ready') {\n            this.readyCallbacks.resolve(message.params);\n        }\n    }\n}\nexports.BaseClientConnection = BaseClientConnection;\nvar RequestResult;\n(function (RequestResult) {\n    function hasData(value) {\n        const candidate = value;\n        return candidate.errno === 0 && candidate.data !== undefined;\n    }\n    RequestResult.hasData = hasData;\n})(RequestResult = exports.RequestResult || (exports.RequestResult = {}));\nclass BaseServiceConnection {\n    constructor() {\n        this.onRequest = this._onRequest;\n        this.textDecoder = (0, ral_1.default)().TextDecoder.create();\n        this.textEncoder = (0, ral_1.default)().TextEncoder.create();\n        this.requestHandlers = new Map();\n        this.requestResults = new Map();\n    }\n    _onRequest(method, handler) {\n        this.requestHandlers.set(method, handler);\n        return {\n            dispose: () => this.requestHandlers.delete(method)\n        };\n    }\n    async handleMessage(sharedArrayBuffer) {\n        const header = new Uint32Array(sharedArrayBuffer, 4 /* SyncSize.total */, 32 /* HeaderSize.total */ / 4);\n        const requestOffset = header[0 /* HeaderIndex.messageOffset */];\n        const requestLength = header[1 /* HeaderIndex.messageByteLength */];\n        try {\n            // See above why we need to slice the Uint8Array.\n            const message = JSON.parse(this.textDecoder.decode(new Uint8Array(sharedArrayBuffer, requestOffset, requestLength).slice()));\n            if (Request.is(message)) {\n                if (message.method === '$/fetchResult') {\n                    const resultId = message.params.resultId;\n                    const result = this.requestResults.get(resultId);\n                    this.requestResults.delete(resultId);\n                    const resultOffset = header[6 /* HeaderIndex.resultOffset */];\n                    const resultByteLength = header[7 /* HeaderIndex.resultByteLength */];\n                    if (result !== undefined && result.byteLength === resultByteLength) {\n                        TypedArray.set(sharedArrayBuffer, resultOffset, result);\n                        header[4 /* HeaderIndex.errno */] = RPCErrno.Success;\n                    }\n                    else {\n                        header[4 /* HeaderIndex.errno */] = RPCErrno.LazyResultFailed;\n                    }\n                }\n                else {\n                    if (message.params?.binary === null) {\n                        const binaryParamsLength = header[3 /* HeaderIndex.binaryParamByteLength */];\n                        const binaryParamsOffset = header[2 /* HeaderIndex.binaryParamOffset */];\n                        const binary = new Uint8Array(sharedArrayBuffer, binaryParamsOffset, binaryParamsLength);\n                        message.params = message.params ?? {};\n                        message.params.binary = binary;\n                    }\n                    const handler = this.requestHandlers.get(message.method);\n                    if (handler !== undefined) {\n                        const resultKind = header[5 /* HeaderIndex.resultKind */];\n                        const resultOffset = header[6 /* HeaderIndex.resultOffset */];\n                        const resultByteLength = header[7 /* HeaderIndex.resultByteLength */];\n                        let handlerResult;\n                        let requestResult;\n                        switch (resultKind) {\n                            case NoResult.kind:\n                                handlerResult = message.params !== undefined ? handler(message.params) : handler();\n                                requestResult = handlerResult instanceof Promise ? await handlerResult : handlerResult;\n                                header[4 /* HeaderIndex.errno */] = requestResult.errno;\n                                break;\n                            case VariableResult.kind:\n                                handlerResult = message.params !== undefined ? handler(message.params) : handler();\n                                requestResult = handlerResult instanceof Promise ? await handlerResult : handlerResult;\n                                header[4 /* HeaderIndex.errno */] = requestResult.errno;\n                                if (requestResult.errno === 0) {\n                                    if (RequestResult.hasData(requestResult)) {\n                                        const data = requestResult.data;\n                                        const buffer = TypedArray.is(data)\n                                            ? data\n                                            : this.textEncoder.encode(JSON.stringify(data, undefined, 0));\n                                        header[7 /* HeaderIndex.resultByteLength */] = buffer.byteLength;\n                                        // We only need to keep a result which is greater than zero.\n                                        // If it is zero we can create an empty array on the other side.\n                                        if (buffer.byteLength > 0) {\n                                            this.requestResults.set(message.id, buffer);\n                                        }\n                                    }\n                                }\n                                break;\n                            default:\n                                const typedResult = TypedArrayResult.fromByteLength(resultKind, resultByteLength);\n                                const resultBuffer = typedResult.createResultArray(sharedArrayBuffer, resultOffset);\n                                handlerResult = message.params !== undefined ? handler(message.params, resultBuffer) : handler(resultBuffer);\n                                requestResult = handlerResult instanceof Promise ? await handlerResult : handlerResult;\n                                header[4 /* HeaderIndex.errno */] = requestResult.errno;\n                        }\n                    }\n                    else {\n                        header[4 /* HeaderIndex.errno */] = RPCErrno.NoHandlerFound;\n                    }\n                }\n            }\n            else {\n                header[4 /* HeaderIndex.errno */] = RPCErrno.InvalidMessageFormat;\n            }\n        }\n        catch (error) {\n            (0, ral_1.default)().console.error(error);\n            header[4 /* HeaderIndex.errno */] = RPCErrno.UnknownError;\n        }\n        const sync = new Int32Array(sharedArrayBuffer, 0, 1);\n        Atomics.store(sync, 0, 1);\n        Atomics.notify(sync, 0);\n    }\n    signalReady() {\n        const notification = { method: '$/ready' };\n        this.postMessage(notification);\n    }\n}\nexports.BaseServiceConnection = BaseServiceConnection;\n//# sourceMappingURL=connection.js.map","\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Cancellation = void 0;\nvar Cancellation;\n(function (Cancellation) {\n    /**\n     * Adds cancellation data to a message. Such a message is usually send via\n     * `MessagePort.postMessage` to another web worker using a *asynchronous*\n     * message channel. The function is therefore called on the sending side\n     * of a message.\n     *\n     * The cancellation data is stored using the property `$cancellationData`\n     * on the provided message object.\n     *\n     * @param message The message to add cancellation data to.\n     * @returns A function when called cancels the message.\n     */\n    function addData(message) {\n        if (message.$cancellationData !== undefined) {\n            throw new Error(`Message already has a property $cancellationData`);\n        }\n        const data = new SharedArrayBuffer(4);\n        const typedArray = new Int32Array(data, 0, 1);\n        typedArray[0] = 0;\n        message.$cancellationData = data;\n        return () => {\n            Atomics.store(typedArray, 0, 1);\n        };\n    }\n    Cancellation.addData = addData;\n    /**\n     * Return for the given message a function that if call indicates whether\n     * the message got canceled or not. The necessary cancellation data is\n     * expected to be stored under the property `$cancellationData` and must\n     * be of type `SharedArrayBuffer`. The function is usually called on the\n     * receiving side of a message.\n\n     * @param message The given message.\n     * @returns a function to check if the message got canceled.\n     */\n    function retrieveCheck(message) {\n        const candidate = message;\n        if (!(candidate instanceof SharedArrayBuffer)) {\n            return () => false;\n        }\n        const typedArray = new Int32Array(candidate.$cancellationData, 0, 1);\n        return () => {\n            return Atomics.load(typedArray, 0) === 1;\n        };\n    }\n    Cancellation.retrieveCheck = retrieveCheck;\n})(Cancellation = exports.Cancellation || (exports.Cancellation = {}));\n//# sourceMappingURL=messageCancellation.js.map","\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BaseMessageConnection = void 0;\nvar _Request;\n(function (_Request) {\n    function is(value) {\n        const candidate = value;\n        return candidate !== undefined && candidate !== null && typeof candidate.id === 'number' && typeof candidate.method === 'string';\n    }\n    _Request.is = is;\n})(_Request || (_Request = {}));\nvar _Notification;\n(function (_Notification) {\n    function is(value) {\n        const candidate = value;\n        return candidate !== undefined && candidate !== null && typeof candidate.method === 'string' && candidate.id === undefined;\n    }\n    _Notification.is = is;\n})(_Notification || (_Notification = {}));\nvar _Response;\n(function (_Response) {\n    function is(value) {\n        const candidate = value;\n        return candidate !== undefined && candidate !== null && typeof candidate.id === 'number' && (candidate.error !== undefined || candidate.result !== undefined);\n    }\n    _Response.is = is;\n})(_Response || (_Response = {}));\nclass BaseMessageConnection {\n    constructor() {\n        this.sendRequest = this._sendRequest;\n        this.onRequest = this._onRequest;\n        this.sendNotification = this._sendNotification;\n        this.onNotification = this._onNotification;\n        this.id = 1;\n        this.responsePromises = new Map();\n        this.requestHandlers = new Map();\n        this.notificationHandlers = new Map();\n    }\n    _sendRequest(method, params, transferList) {\n        if (method === undefined) {\n            return Promise.resolve();\n        }\n        return new Promise((resolve, reject) => {\n            const id = this.id++;\n            const request = { id, method };\n            if (params !== undefined) {\n                request.params = params;\n            }\n            this.responsePromises.set(id, { resolve, reject, method: request.method });\n            this.postMessage(request, transferList);\n        });\n    }\n    _onRequest(method, handler) {\n        if (method === undefined || handler === undefined) {\n            return;\n        }\n        this.requestHandlers.set(method, handler);\n    }\n    _sendNotification(method, params, transferList) {\n        if (method === undefined) {\n            return;\n        }\n        const notification = { method };\n        if (params !== undefined) {\n            notification.params = params;\n        }\n        this.postMessage(notification, transferList);\n    }\n    _onNotification(method, handler) {\n        if (method === undefined || handler === undefined) {\n            return;\n        }\n        this.notificationHandlers.set(method, handler);\n    }\n    async handleMessage(message) {\n        if (_Request.is(message)) {\n            const id = message.id;\n            const handler = this.requestHandlers.get(message.method);\n            if (handler !== undefined) {\n                try {\n                    const result = await handler(message.params);\n                    this.sendResultResponse(id, result);\n                }\n                catch (error) {\n                    this.sendErrorResponse(id, error);\n                }\n            }\n        }\n        else if (_Notification.is(message)) {\n            const handler = this.notificationHandlers.get(message.method);\n            if (handler !== undefined) {\n                handler(message.params);\n            }\n        }\n        else if (_Response.is(message)) {\n            const id = message.id;\n            const promise = this.responsePromises.get(id);\n            if (promise !== undefined) {\n                this.responsePromises.delete(id);\n                if (message.result !== undefined) {\n                    promise.resolve(message.result);\n                }\n                else if (message.error !== undefined) {\n                    promise.reject(typeof message.error === 'string' ? new Error(message.error) : message.error);\n                }\n                else {\n                    promise.reject(new Error('Response has neither a result nor an error value'));\n                }\n            }\n        }\n    }\n    sendResultResponse(id, result) {\n        const response = { id, result: result === undefined ? null : result };\n        this.postMessage(response);\n    }\n    sendErrorResponse(id, error) {\n        const response = { id, error: error === undefined ? 'Unknown error' : error instanceof Error ? error.message : error };\n        this.postMessage(response);\n    }\n}\nexports.BaseMessageConnection = BaseMessageConnection;\n(function (BaseMessageConnection) {\n    BaseMessageConnection.Request = _Request;\n    BaseMessageConnection.Notification = _Notification;\n    BaseMessageConnection.Response = _Response;\n})(BaseMessageConnection = exports.BaseMessageConnection || (exports.BaseMessageConnection = {}));\n//# sourceMappingURL=messageConnection.js.map","\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DTOs = void 0;\nconst connection_1 = require(\"./connection\");\nvar DTOs;\n(function (DTOs) {\n    let FileSystemError;\n    (function (FileSystemError) {\n        /**\n         * Create an error to signal that a file or folder wasn't found.\n         */\n        FileSystemError.FileNotFound = connection_1.RPCErrno.$Custom;\n        /**\n         * Create an error to signal that a file or folder already exists, e.g. when\n         * creating but not overwriting a file.\n         */\n        FileSystemError.FileExists = FileSystemError.FileNotFound + 1;\n        /**\n         * Create an error to signal that a file is not a folder.\n         */\n        FileSystemError.FileNotADirectory = FileSystemError.FileExists + 1;\n        /**\n         * Create an error to signal that a file is a folder.\n         */\n        FileSystemError.FileIsADirectory = FileSystemError.FileNotADirectory + 1;\n        /**\n         * Create an error to signal that an operation lacks required permissions.\n         */\n        FileSystemError.NoPermissions = FileSystemError.FileIsADirectory + 1;\n        /**\n         * Create an error to signal that the file system is unavailable or too busy to\n         * complete a request.\n         */\n        FileSystemError.Unavailable = FileSystemError.NoPermissions + 1;\n    })(FileSystemError = DTOs.FileSystemError || (DTOs.FileSystemError = {}));\n    let FileType;\n    (function (FileType) {\n        /**\n        * The file type is unknown.\n        */\n        FileType[FileType[\"Unknown\"] = 0] = \"Unknown\";\n        /**\n        * A regular file.\n        */\n        FileType[FileType[\"File\"] = 1] = \"File\";\n        /**\n        * A directory.\n        */\n        FileType[FileType[\"Directory\"] = 2] = \"Directory\";\n        /**\n        * A symbolic link to a file.\n        */\n        FileType[FileType[\"SymbolicLink\"] = 64] = \"SymbolicLink\";\n    })(FileType = DTOs.FileType || (DTOs.FileType = {}));\n    let FilePermission;\n    (function (FilePermission) {\n        /**\n         * The file is readonly.\n         */\n        FilePermission[FilePermission[\"Readonly\"] = 1] = \"Readonly\";\n    })(FilePermission = DTOs.FilePermission || (DTOs.FilePermission = {}));\n    let Stat;\n    (function (Stat) {\n        Stat.typedResult = connection_1.Uint32Result.fromLength(5);\n        function create(memory) {\n            return {\n                get type() {\n                    return memory[0];\n                },\n                set type(value) {\n                    memory[0] = value;\n                },\n                get ctime() {\n                    return memory[1];\n                },\n                set ctime(value) {\n                    memory[1] = value;\n                },\n                get mtime() {\n                    return memory[2];\n                },\n                set mtime(value) {\n                    memory[2] = value;\n                },\n                get size() {\n                    return memory[3];\n                },\n                set size(value) {\n                    memory[3] = value;\n                },\n                get permission() {\n                    return memory[4];\n                },\n                set permission(value) {\n                    memory[4] = value;\n                }\n            };\n        }\n        Stat.create = create;\n    })(Stat = DTOs.Stat || (DTOs.Stat = {}));\n})(DTOs = exports.DTOs || (exports.DTOs = {}));\n//# sourceMappingURL=protocol.js.map","\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports._RALType = void 0;\nvar _RALType;\n(function (_RALType) {\n    _RALType[_RALType[\"Browser\"] = 1] = \"Browser\";\n    _RALType[_RALType[\"Node\"] = 2] = \"Node\";\n})(_RALType = exports._RALType || (exports._RALType = {}));\nlet _ral;\nfunction RAL() {\n    if (_ral === undefined) {\n        throw new Error(`No runtime abstraction layer installed`);\n    }\n    return _ral;\n}\n(function (RAL) {\n    RAL.Type = _RALType;\n    function install(ral) {\n        if (ral === undefined) {\n            throw new Error(`No runtime abstraction layer provided`);\n        }\n        _ral = ral;\n    }\n    RAL.install = install;\n})(RAL || (RAL = {}));\nexports.default = RAL;\n//# sourceMappingURL=ral.js.map","\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ApiService = exports.ServicePseudoTerminal = exports.TerminalMode = void 0;\nconst vscode = __importStar(require(\"vscode\"));\nconst sync_api_common_1 = require(\"@vscode/sync-api-common\");\nconst terminalRegExp = /(\\r\\n)|(\\n)/gm;\nclass LineBuffer {\n    constructor() {\n        this.cursor = 0;\n        this.content = [];\n    }\n    clear() {\n        this.cursor = 0;\n        this.content = [];\n    }\n    getLine() {\n        return this.content.join('');\n    }\n    getCursor() {\n        return this.cursor;\n    }\n    isCursorAtEnd() {\n        return this.cursor === this.content.length;\n    }\n    isCursorAtBeginning() {\n        return this.cursor === 0;\n    }\n    insert(value) {\n        for (const char of value) {\n            this.content.splice(this.cursor, 0, char);\n            this.cursor++;\n        }\n    }\n    del() {\n        if (this.cursor === this.content.length) {\n            return false;\n        }\n        this.content.splice(this.cursor, 1);\n        return true;\n    }\n    backspace() {\n        if (this.cursor === 0) {\n            return false;\n        }\n        this.cursor -= 1;\n        this.content.splice(this.cursor, 1);\n        return true;\n    }\n    moveCursorRelative(characters) {\n        const newValue = this.cursor + characters;\n        if (newValue < 0 || newValue > this.content.length) {\n            return false;\n        }\n        this.cursor = newValue;\n        return true;\n    }\n    moveCursorStartOfLine() {\n        if (this.cursor === 0) {\n            return false;\n        }\n        this.cursor = 0;\n        return true;\n    }\n    moveCursorEndOfLine() {\n        if (this.cursor === this.content.length) {\n            return false;\n        }\n        this.cursor = this.content.length;\n        return true;\n    }\n    moveCursorWordLeft() {\n        if (this.cursor === 0) {\n            return false;\n        }\n        let index;\n        // check if we are at the beginning of a word\n        if (this.content[this.cursor - 1] === ' ') {\n            index = this.cursor - 2;\n            while (index > 0) {\n                if (this.content[index] === ' ') {\n                    index--;\n                }\n                else {\n                    break;\n                }\n            }\n        }\n        else {\n            index = this.cursor;\n        }\n        if (index === 0) {\n            this.cursor = index;\n            return true;\n        }\n        // On the first character that is not space\n        while (index > 0) {\n            if (this.content[index] === ' ') {\n                index++;\n                break;\n            }\n            else {\n                index--;\n            }\n        }\n        this.cursor = index;\n        return true;\n    }\n    moveCursorWordRight() {\n        if (this.cursor === this.content.length) {\n            return false;\n        }\n        let index;\n        if (this.content[this.cursor] === ' ') {\n            index = this.cursor + 1;\n            while (index < this.content.length) {\n                if (this.content[index] === ' ') {\n                    index++;\n                }\n                else {\n                    break;\n                }\n            }\n        }\n        else {\n            index = this.cursor;\n        }\n        if (index === this.content.length) {\n            this.cursor = index;\n            return true;\n        }\n        while (index < this.content.length) {\n            if (this.content[index] === ' ') {\n                break;\n            }\n            else {\n                index++;\n            }\n        }\n        this.cursor = index;\n        return true;\n    }\n}\nvar TerminalMode;\n(function (TerminalMode) {\n    TerminalMode[TerminalMode[\"idle\"] = 1] = \"idle\";\n    TerminalMode[TerminalMode[\"inUse\"] = 2] = \"inUse\";\n})(TerminalMode = exports.TerminalMode || (exports.TerminalMode = {}));\nvar ServicePseudoTerminal;\n(function (ServicePseudoTerminal) {\n    function create(mode) {\n        return new ServiceTerminalImpl(mode);\n    }\n    ServicePseudoTerminal.create = create;\n})(ServicePseudoTerminal = exports.ServicePseudoTerminal || (exports.ServicePseudoTerminal = {}));\nclass ServiceTerminalImpl {\n    constructor(mode) {\n        this.mode = mode;\n        this._onDidClose = new vscode.EventEmitter();\n        this.onDidClose = this._onDidClose.event;\n        this._onDidWrite = new vscode.EventEmitter();\n        this.onDidWrite = this._onDidWrite.event;\n        this._onDidChangeName = new vscode.EventEmitter;\n        this.onDidChangeName = this._onDidChangeName.event;\n        this._onDidCtrlC = new vscode.EventEmitter;\n        this.onDidCtrlC = this._onDidCtrlC.event;\n        this._onAnyKey = new vscode.EventEmitter;\n        this.onAnyKey = this._onAnyKey.event;\n        this.lines = [];\n        this.lineBuffer = new LineBuffer();\n        this.isOpen = false;\n    }\n    setMode(mode) {\n        this.mode = mode;\n    }\n    setName(name) {\n        if (this.isOpen) {\n            this._onDidChangeName.fire(name);\n        }\n        else {\n            this.nameBuffer = name;\n        }\n    }\n    open() {\n        this.isOpen = true;\n        if (this.nameBuffer !== undefined) {\n            this._onDidChangeName.fire(this.nameBuffer);\n            this.nameBuffer = undefined;\n        }\n        if (this.writeBuffer !== undefined) {\n            for (const item of this.writeBuffer) {\n                this._onDidWrite.fire(item);\n            }\n            this.writeBuffer = undefined;\n        }\n    }\n    close() {\n        this._onDidClose.fire();\n    }\n    readline() {\n        if (this.readlineCallback !== undefined) {\n            throw new Error(`Already in readline mode`);\n        }\n        if (this.lines.length > 0) {\n            return Promise.resolve(this.lines.shift());\n        }\n        return new Promise((resolve) => {\n            this.readlineCallback = resolve;\n        });\n    }\n    write(str) {\n        if (this.isOpen) {\n            this._onDidWrite.fire(str);\n        }\n        else {\n            if (this.writeBuffer === undefined) {\n                this.writeBuffer = [];\n            }\n            this.writeBuffer.push(str);\n        }\n    }\n    handleInput(data) {\n        if (this.mode === TerminalMode.idle) {\n            this._onAnyKey.fire();\n            return;\n        }\n        const previousCursor = this.lineBuffer.getCursor();\n        switch (data) {\n            case '\\x03': // ctrl+C\n                this._onDidCtrlC.fire();\n                break;\n            case '\\x06': // ctrl+f\n            case '\\x1b[C': // right\n                this.adjustCursor(this.lineBuffer.moveCursorRelative(1), previousCursor, this.lineBuffer.getCursor());\n                break;\n            case '\\x1bf': // alt+f\n            case '\\x1b[1;5C': // ctrl+right\n                this.adjustCursor(this.lineBuffer.moveCursorWordRight(), previousCursor, this.lineBuffer.getCursor());\n                break;\n            case '\\x02': // ctrl+b\n            case '\\x1b[D': // left\n                this.adjustCursor(this.lineBuffer.moveCursorRelative(-1), previousCursor, this.lineBuffer.getCursor());\n                break;\n            case '\\x1bb': // alt+b\n            case '\\x1b[1;5D': // ctrl+left\n                this.adjustCursor(this.lineBuffer.moveCursorWordLeft(), previousCursor, this.lineBuffer.getCursor());\n                break;\n            case '\\x01': // ctrl+a\n            case '\\x1b[H': // home\n                this.adjustCursor(this.lineBuffer.moveCursorStartOfLine(), previousCursor, this.lineBuffer.getCursor());\n                break;\n            case '\\x05': // ctrl+e\n            case '\\x1b[F': // end\n                this.adjustCursor(this.lineBuffer.moveCursorEndOfLine(), previousCursor, this.lineBuffer.getCursor());\n                break;\n            case '\\x1b[A': // up\n                this.bell();\n                break;\n            case '\\x1b[B': // down\n                this.bell();\n                break;\n            case '\\x08': // shift+backspace\n            case '\\x7F': // backspace\n                this.lineBuffer.backspace() ? this._onDidWrite.fire('\\x1b[D\\x1b[P') : this.bell();\n                break;\n            case '\\x1b[3~': // delete key\n                this.lineBuffer.del() ? this._onDidWrite.fire('\\x1b[P') : this.bell();\n                break;\n            case '\\r': // enter\n                this.handleEnter();\n                break;\n            default:\n                this.lineBuffer.insert(data);\n                if (!this.lineBuffer.isCursorAtEnd()) {\n                    this._onDidWrite.fire('\\x1b[@');\n                }\n                this._onDidWrite.fire(data);\n        }\n    }\n    handleEnter() {\n        this._onDidWrite.fire('\\r\\n');\n        const line = this.lineBuffer.getLine();\n        this.lineBuffer.clear();\n        this.lines.push(line);\n        if (this.readlineCallback !== undefined) {\n            this.readlineCallback(`${this.lines.shift()}\\n`);\n            this.readlineCallback = undefined;\n        }\n    }\n    adjustCursor(success, oldCursor, newCursor) {\n        if (!success) {\n            this.bell();\n            return;\n        }\n        const change = oldCursor - newCursor;\n        const code = change > 0 ? 'D' : 'C';\n        const sequence = `\\x1b[${code}`.repeat(Math.abs(change));\n        this._onDidWrite.fire(sequence);\n    }\n    bell() {\n        this._onDidWrite.fire('\\x07');\n    }\n}\nclass ApiService {\n    constructor(_name, receiver, options) {\n        this.connection = receiver;\n        this.options = options;\n        this.textEncoder = (0, sync_api_common_1.RAL)().TextEncoder.create();\n        this.textDecoder = (0, sync_api_common_1.RAL)().TextDecoder.create();\n        this.pty = options?.pty ?? new ServiceTerminalImpl(TerminalMode.inUse);\n        const handleError = (error) => {\n            if (error instanceof vscode.FileSystemError) {\n                return { errno: this.asFileSystemError(error) };\n            }\n            return { errno: sync_api_common_1.RPCErrno.UnknownError };\n        };\n        this.connection.onRequest('timer/sleep', async (params) => {\n            await new Promise((resolve) => {\n                (0, sync_api_common_1.RAL)().timer.setTimeout(resolve, params.ms);\n            });\n            return { errno: 0 };\n        });\n        this.connection.onRequest('terminal/write', (params) => {\n            if (params !== undefined && params.binary !== undefined) {\n                const str = this.textDecoder.decode(params.binary.slice()).replace(terminalRegExp, (match, m1, m2) => {\n                    if (m1) {\n                        return m1;\n                    }\n                    else if (m2) {\n                        return '\\r\\n';\n                    }\n                    else {\n                        return match;\n                    }\n                });\n                this.pty.write(str);\n            }\n            return { errno: 0 };\n        });\n        this.connection.onRequest('terminal/read', async () => {\n            const line = await this.pty.readline();\n            return { errno: 0, data: this.textEncoder.encode(line) };\n        });\n        this.connection.onRequest('fileSystem/stat', async (params, resultBuffer) => {\n            try {\n                const uri = vscode.Uri.from(params.uri);\n                const vStat = await vscode.workspace.fs.stat(uri);\n                const stat = sync_api_common_1.DTOs.Stat.create(resultBuffer);\n                stat.type = vStat.type;\n                stat.ctime = vStat.mtime;\n                stat.mtime = vStat.mtime;\n                stat.size = vStat.size;\n                if (vStat.permissions !== undefined) {\n                    stat.permission = vStat.permissions;\n                }\n                return { errno: 0 };\n            }\n            catch (error) {\n                return handleError(error);\n            }\n        });\n        this.connection.onRequest('fileSystem/readFile', async (params) => {\n            try {\n                const uri = vscode.Uri.from(params.uri);\n                const contents = await vscode.workspace.fs.readFile(uri);\n                return { errno: 0, data: contents };\n            }\n            catch (error) {\n                return handleError(error);\n            }\n        });\n        this.connection.onRequest('fileSystem/writeFile', async (params) => {\n            try {\n                const uri = vscode.Uri.from(params.uri);\n                await vscode.workspace.fs.writeFile(uri, params.binary);\n                return { errno: 0 };\n            }\n            catch (error) {\n                return handleError(error);\n            }\n        });\n        this.connection.onRequest('fileSystem/readDirectory', async (params) => {\n            try {\n                const uri = vscode.Uri.from(params.uri);\n                const entries = await vscode.workspace.fs.readDirectory(uri);\n                return { errno: 0, data: entries };\n            }\n            catch (error) {\n                return handleError(error);\n            }\n        });\n        this.connection.onRequest('fileSystem/createDirectory', async (params) => {\n            try {\n                const uri = vscode.Uri.from(params.uri);\n                await vscode.workspace.fs.createDirectory(uri);\n                return { errno: 0 };\n            }\n            catch (error) {\n                return handleError(error);\n            }\n        });\n        this.connection.onRequest('fileSystem/delete', async (params) => {\n            try {\n                const uri = vscode.Uri.from(params.uri);\n                await vscode.workspace.fs.delete(uri, params.options);\n                return { errno: 0 };\n            }\n            catch (error) {\n                return handleError(error);\n            }\n        });\n        this.connection.onRequest('fileSystem/rename', async (params) => {\n            try {\n                const source = vscode.Uri.from(params.source);\n                const target = vscode.Uri.from(params.target);\n                await vscode.workspace.fs.rename(source, target, params.options);\n                return { errno: 0 };\n            }\n            catch (error) {\n                return handleError(error);\n            }\n        });\n        this.connection.onRequest('window/activeTextDocument', () => {\n            const activeEditor = vscode.window.activeTextEditor;\n            if (activeEditor === undefined) {\n                return { errno: 0, data: null };\n            }\n            return { errno: 0, data: { uri: activeEditor.document.uri.toJSON() } };\n        });\n        this.connection.onRequest('workspace/workspaceFolders', () => {\n            const folders = vscode.workspace.workspaceFolders ?? [];\n            return { errno: 0, data: folders.map(folder => { return { uri: folder.uri.toJSON(), name: folder.name, index: folder.index }; }) };\n        });\n        this.connection.onRequest('process/proc_exit', (params) => {\n            if (this.options?.exitHandler !== undefined) {\n                this.options.exitHandler(params.rval);\n            }\n            return { errno: 0 };\n        });\n    }\n    getPty() {\n        return this.pty;\n    }\n    asFileSystemError(error) {\n        switch (error.code) {\n            case 'FileNotFound':\n                return sync_api_common_1.DTOs.FileSystemError.FileNotFound;\n            case 'FileExists':\n                return sync_api_common_1.DTOs.FileSystemError.FileExists;\n            case 'FileNotADirectory':\n                return sync_api_common_1.DTOs.FileSystemError.FileNotADirectory;\n            case 'FileIsADirectory':\n                return sync_api_common_1.DTOs.FileSystemError.FileIsADirectory;\n            case 'NoPermissions':\n                return sync_api_common_1.DTOs.FileSystemError.NoPermissions;\n            case 'Unavailable':\n                return sync_api_common_1.DTOs.FileSystemError.Unavailable;\n            default:\n                return sync_api_common_1.RPCErrno.UnknownError;\n        }\n    }\n}\nexports.ApiService = ApiService;\n//# sourceMappingURL=apiService.js.map","\"use strict\";\n/* --------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n * ------------------------------------------------------------------------------------------ */\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"@vscode/sync-api-common\"), exports);\n__exportStar(require(\"./apiService\"), exports);\n//# sourceMappingURL=main.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.packagePath = exports.ResolvedProject = exports.PackageManager = exports.PackageType = void 0;\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nconst path_1 = require(\"path\");\nconst node_maintainer_1 = require(\"../node-maintainer/node_maintainer\");\nconst node_maintainer_bg_wasm_1 = __importDefault(require(\"../node-maintainer/node_maintainer_bg.wasm\"));\n(0, node_maintainer_1.initSync)(dataURItoUint8Array(node_maintainer_bg_wasm_1.default));\nconst decoder = new TextDecoder();\nvar PackageType;\n(function (PackageType) {\n    PackageType[\"Dependency\"] = \"dependencies\";\n    PackageType[\"DevDependency\"] = \"devDependencies\";\n    PackageType[\"OptionalDependency\"] = \"optionalDependencies\";\n    PackageType[\"PeerDependency\"] = \"peerDependencies\";\n})(PackageType || (exports.PackageType = PackageType = {}));\nclass PackageManager {\n    constructor(fs) {\n        this.fs = fs;\n        this.nassun = new node_maintainer_1.Nassun({});\n    }\n    async resolveProject(root, opts = {}) {\n        if (opts.addPackages || opts.removePackages) {\n            await this.updateJson((0, path_1.join)(root, 'package.json'), opts);\n        }\n        console.time(`dependency resolution: ${root}`);\n        const maintainer = await this.resolveMaintainer(root, opts);\n        console.timeEnd(`dependency resolution: ${root}`);\n        return new ResolvedProject(this.fs, maintainer, root);\n    }\n    async updateJson(packageJsonPath, opts = {}) {\n        const packageType = opts.packageType ?? PackageType.Dependency;\n        const corgis = await Promise.all((opts.addPackages ?? []).map(async (pkg) => this.nassun.corgiMetadata(pkg)));\n        let pkgJson;\n        try {\n            pkgJson = this.readJson(packageJsonPath);\n        }\n        catch (e) {\n            console.error('failed to read package.json', e);\n            pkgJson = {};\n        }\n        for (const packageName of opts.removePackages ?? []) {\n            delete pkgJson.dependencies?.[packageName];\n            delete pkgJson.devDependencies?.[packageName];\n            delete pkgJson.optionalDependencies?.[packageName];\n            delete pkgJson.peerDependencies?.[packageName];\n        }\n        for (const corgi of corgis) {\n            if (!pkgJson[packageType]) {\n                pkgJson[packageType] = {};\n            }\n            pkgJson[packageType][corgi.name] = `^${corgi.version}`;\n        }\n        const stringified = JSON.stringify(pkgJson, undefined, 2);\n        this.fs.writeFile(packageJsonPath, stringified);\n    }\n    async resolveMaintainer(root, opts) {\n        const pkgJson = opts.pkgJson || this.fs.readFile((0, path_1.join)(root, 'package.json')) || '{}';\n        const kdlPkgLock = opts.kdlLock || this.fs.readFile((0, path_1.join)(root, 'package-lock.kdl'));\n        const npmPkgLock = opts.npmLock || this.fs.readFile((0, path_1.join)(root, 'package-lock.json'));\n        return (0, node_maintainer_1.resolveManifest)(JSON.parse(pkgJson.trim()), { kdlLock: kdlPkgLock, npmLock: npmPkgLock });\n    }\n    /**\n     * What it says on the tin. Reads a JSON file from the given path. Throws\n     * if the file doesn't exist (as opposed to returning `undefined`, like\n     * fs.readFile does).\n     */\n    readJson(path) {\n        const data = this.fs.readFile(path);\n        if (!data) {\n            throw new Error('Failed to read file: ' + path);\n        }\n        return JSON.parse(data.trim());\n    }\n}\nexports.PackageManager = PackageManager;\nclass ResolvedProject {\n    constructor(fs, maintainer, root) {\n        this.fs = fs;\n        this.maintainer = maintainer;\n        this.root = root;\n        this.prefix = (0, path_1.join)(root, 'node_modules');\n        this.metaPath = (0, path_1.join)(this.prefix, '.meta.json');\n    }\n    /**\n     * Synchronizes the project's node_modules directory with the current resolved dependencies, pruning any extraneous ones.\n     */\n    async restore() {\n        console.time(`project restore: ${this.root}`);\n        this.pruneExtraneous();\n        await this.extractMissing();\n        this.writeLockfile();\n        console.timeEnd(`project restore: ${this.root}`);\n    }\n    /**\n     * Extracts a package at the given path. If a package has already been\n     * extracted to that location, it will be replaced.\n     *\n     * @param path to a package\n     * @returns The number of files extracted, or undefined if the path\n     */\n    async restorePackageAt(path) {\n        console.time(`restore package at: ${path}`);\n        this.checkPath(path);\n        const meta = JSON.parse(this.fs.readFile(this.metaPath) || '{}');\n        if (!meta.packages) {\n            meta.packages = {};\n        }\n        const projRoot = this.getProjectRoot(path);\n        if (!projRoot) {\n            console.error('root not found for ', path);\n            console.timeEnd(`restore package at: ${path}`);\n            return;\n        }\n        const pkgPath = packagePath(path);\n        const pkg = this.packageAtPath(path.slice(projRoot.length));\n        if (!pkg) {\n            console.error('no package at path', path, pkgPath);\n            console.timeEnd(`restore package at: ${path}`);\n            return;\n        }\n        if (pkg && pkgPath && meta.packages?.[pkgPath.slice(this.prefix.length)]?.resolved === pkg.resolved) {\n            // Already installed and synced. No need to do anything else!\n            console.timeEnd(`restore package at: ${path}`);\n            return;\n        }\n        else {\n            rimraf(this.fs, pkgPath);\n        }\n        let count;\n        try {\n            // NB(zkat): load-bearing `await`. We need to await here because\n            // otherwise we'll have a use-after-free error when extracting the\n            // package entries.\n            count = await this.extractPackageTo(pkg, pkgPath);\n            meta.packages[pkgPath.slice(this.prefix.length)] = {\n                name: pkg.name,\n                resolved: pkg.resolved\n            };\n        }\n        catch (e) {\n            console.error('error extracting: ', e);\n            console.timeEnd(`restore package at: ${path}`);\n            throw e;\n        }\n        finally {\n            pkg.free();\n        }\n        rimraf(this.fs, this.metaPath);\n        this.fs.writeFile(this.metaPath, JSON.stringify(meta, null, 2));\n        this.writeLockfile();\n        console.timeEnd(`restore package at: ${path}`);\n        return count;\n    }\n    /**\n     * Deletes/prunes files and directories that aren't expected to be there\n     * by the currently-calculated tree. Extraneous calculation happens based on the contents of `.meta.json`\n     * @returns\n     */\n    pruneExtraneous() {\n        const meta = JSON.parse(this.fs.readFile(this.metaPath) || '{}');\n        let count = 0;\n        if (!this.fs.directoryExists(this.prefix)) {\n            return count;\n        }\n        for (const entryPath of walkDir(this.fs, this.prefix)) {\n            if (entryPath === this.metaPath) {\n                // Leave the meta path alone.\n                continue;\n            }\n            const pkgPath = packagePath(entryPath);\n            // Only look at toplevel package paths.\n            if (pkgPath === entryPath) {\n                const subPath = pkgPath.slice(this.prefix.length);\n                const pkg = this.packageAtPath(subPath);\n                try {\n                    if (pkg && meta.packages?.[pkgPath.slice(this.prefix.length)]?.resolved === pkg.resolved) {\n                        // There's a valid package here. Move along.\n                    }\n                    else {\n                        // Extraneous!\n                        count++;\n                        rimraf(this.fs, entryPath);\n                    }\n                }\n                finally {\n                    pkg?.free();\n                }\n            }\n        }\n        return count;\n    }\n    packageAtPath(path) {\n        return this.maintainer.packageAtPath(path);\n    }\n    getProjectRoot(path) {\n        const pkgPath = path.match(/(^.*\\/)node_modules/);\n        return pkgPath?.[1];\n    }\n    checkPath(path) {\n        if (!path.startsWith(this.root)) {\n            throw new Error(`Path ${path} is not in project root ${this.root}`);\n        }\n        if (!(0, path_1.isAbsolute)(path)) {\n            throw new Error(`Path ${path} is not absolute`);\n        }\n    }\n    async extractPackageTo(pkg, pkgPath) {\n        const mkdirCache = new Set();\n        mkdirp(mkdirCache, this.fs, pkgPath);\n        // Clean up the directory, in case it already exists, but leave\n        // node_modules alone to avoid clobbering other packages.\n        for (const file of this.fs.readDirectory(pkgPath)) {\n            if ((0, path_1.basename)(file) === 'node_modules') {\n                continue;\n            }\n            rimraf(this.fs, file);\n        }\n        const entries = await pkg.entries();\n        const reader = entries.getReader();\n        let fileCount = 0;\n        while (true) {\n            const { done, value: entry } = await reader.read();\n            if (done) {\n                break;\n            }\n            // Strip the first level of a package, just like NPM does.\n            const entryPath = (0, path_1.join)(pkgPath, entry.path.replace(/^([^/]*\\/)?/, ''));\n            // We simulate directories based on files we find.\n            mkdirp(mkdirCache, this.fs, (0, path_1.dirname)(entryPath));\n            // Types are registered here:\n            // https://www.gnu.org/software/tar/manual/html_node/Standard.html.\n            // You can get these numbers by just doing `'5'.codePointAt(0)`,\n            // but we may as well hard-code the three values we actually care\n            // about here.\n            if (entry.type === 53) {\n                // '5' == 53 == directory\n                mkdirp(mkdirCache, this.fs, entryPath);\n                await drainStream(entry.contents);\n            }\n            else if (entry.type === 0 || entry.type === 48) {\n                // '0' == 48 or '\\x00' == 0 == regular file\n                const data = await streamToArrayBuffer(entry.contents, entry.size);\n                this.fs.writeFile(entryPath, decoder.decode(data));\n                fileCount++;\n            }\n            else {\n                // Anything else, we throw away, but we have to make sure to\n                // drain any contents before we can continue reading the\n                // tarball.\n                await drainStream(entry.contents);\n            }\n        }\n        return fileCount;\n    }\n    async extractMissing() {\n        const meta = { packages: {} };\n        await this.maintainer.forEachPackage(async (pkg, path) => {\n            const fullPath = (0, path_1.join)(this.prefix, path);\n            meta.packages[path] = {\n                name: pkg.name,\n                resolved: pkg.resolved\n            };\n            try {\n                if (!this.fs.directoryExists(fullPath)) {\n                    await this.extractPackageTo(pkg, fullPath);\n                }\n            }\n            finally {\n                pkg.free();\n            }\n        });\n        rimraf(this.fs, this.metaPath);\n        this.fs.writeFile(this.metaPath, JSON.stringify(meta, null, 2));\n    }\n    writeLockfile() {\n        this.fs.writeFile((0, path_1.join)(this.root, 'package-lock.kdl'), this.maintainer.toKdl());\n    }\n}\nexports.ResolvedProject = ResolvedProject;\n//---- Utils\n/**\n * Given a full path to a particular file, presumably inside a package,\n * this returns the path of the package containing that file.\n * @param path the full file path to the file.\n * @returns the subpath of the package itself\n */\nfunction packagePath(path) {\n    return path.replace(/(^.*\\/node_modules\\/(?:@[^/]+\\/)?[^/]+)\\/?(?!node_modules\\/).*/, '$1');\n}\nexports.packagePath = packagePath;\n// via https://stackoverflow.com/questions/12168909/blob-from-dataurl\nfunction dataURItoUint8Array(dataURI) {\n    const byteString = atob(dataURI.split(',')[1]);\n    const ab = new ArrayBuffer(byteString.length);\n    const ia = new Uint8Array(ab);\n    for (let i = 0; i < byteString.length; i++) {\n        ia[i] = byteString.charCodeAt(i);\n    }\n    return ia;\n}\nasync function drainStream(stream) {\n    const reader = stream.getReader();\n    while (true) { // eslint-disable-line no-constant-condition\n        const { done } = await reader.read();\n        if (done) {\n            break;\n        }\n    }\n    return reader.closed;\n}\nasync function streamToArrayBuffer(stream, length) {\n    const result = new Uint8Array(length);\n    const reader = stream.getReader();\n    let idx = 0;\n    while (true) { // eslint-disable-line no-constant-condition\n        const { done, value } = await reader.read();\n        if (done) {\n            break;\n        }\n        result.set(value, idx);\n        idx += value.length;\n    }\n    return result;\n}\nfunction* walkDir(fs, path) {\n    let contents = fs.readDirectory(path);\n    while (contents.length) {\n        const entry = contents.shift();\n        const entryPath = (0, path_1.join)(path, entry);\n        if (fs.directoryExists(entryPath)) {\n            contents = fs.readDirectory(entryPath).map(e => (0, path_1.join)(entry, e)).concat(contents);\n        }\n        yield entryPath;\n    }\n}\nfunction mkdirp(cache, fs, path) {\n    path.split('/').reduce((dir, next) => {\n        const joined = (0, path_1.join)(dir, next);\n        if (!cache.has(joined) && !fs.directoryExists(joined)) {\n            fs.createDirectory(joined);\n            cache.add(joined);\n        }\n        return joined;\n    }, '');\n}\nfunction rimraf(fs, path) {\n    if (fs.directoryExists(path)) {\n        for (const subPath of fs.readDirectory(path).map(e => (0, path_1.join)(path, e))) {\n            rimraf(fs, subPath);\n        }\n    }\n    try {\n        fs.deleteFile?.(path);\n    }\n    catch (e) {\n        // shou ga nai\n    }\n}\n","import { bytes_literal } from './snippets/wasm-streams-42e57edbcd526312/inline0.js';\n\nlet wasm;\n\nconst heap = new Array(128).fill(undefined);\n\nheap.push(undefined, null, true, false);\n\nfunction getObject(idx) { return heap[idx]; }\n\nlet heap_next = heap.length;\n\nfunction dropObject(idx) {\n    if (idx < 132) return;\n    heap[idx] = heap_next;\n    heap_next = idx;\n}\n\nfunction takeObject(idx) {\n    const ret = getObject(idx);\n    dropObject(idx);\n    return ret;\n}\n\nconst cachedTextDecoder = new TextDecoder('utf-8', { ignoreBOM: true, fatal: true });\n\ncachedTextDecoder.decode();\n\nlet cachedUint8Memory0 = null;\n\nfunction getUint8Memory0() {\n    if (cachedUint8Memory0 === null || cachedUint8Memory0.byteLength === 0) {\n        cachedUint8Memory0 = new Uint8Array(wasm.memory.buffer);\n    }\n    return cachedUint8Memory0;\n}\n\nfunction getStringFromWasm0(ptr, len) {\n    return cachedTextDecoder.decode(getUint8Memory0().subarray(ptr, ptr + len));\n}\n\nfunction addHeapObject(obj) {\n    if (heap_next === heap.length) heap.push(heap.length + 1);\n    const idx = heap_next;\n    heap_next = heap[idx];\n\n    heap[idx] = obj;\n    return idx;\n}\n\nlet WASM_VECTOR_LEN = 0;\n\nconst cachedTextEncoder = new TextEncoder('utf-8');\n\nconst encodeString = (typeof cachedTextEncoder.encodeInto === 'function'\n    ? function (arg, view) {\n    return cachedTextEncoder.encodeInto(arg, view);\n}\n    : function (arg, view) {\n    const buf = cachedTextEncoder.encode(arg);\n    view.set(buf);\n    return {\n        read: arg.length,\n        written: buf.length\n    };\n});\n\nfunction passStringToWasm0(arg, malloc, realloc) {\n\n    if (realloc === undefined) {\n        const buf = cachedTextEncoder.encode(arg);\n        const ptr = malloc(buf.length);\n        getUint8Memory0().subarray(ptr, ptr + buf.length).set(buf);\n        WASM_VECTOR_LEN = buf.length;\n        return ptr;\n    }\n\n    let len = arg.length;\n    let ptr = malloc(len);\n\n    const mem = getUint8Memory0();\n\n    let offset = 0;\n\n    for (; offset < len; offset++) {\n        const code = arg.charCodeAt(offset);\n        if (code > 0x7F) break;\n        mem[ptr + offset] = code;\n    }\n\n    if (offset !== len) {\n        if (offset !== 0) {\n            arg = arg.slice(offset);\n        }\n        ptr = realloc(ptr, len, len = offset + arg.length * 3);\n        const view = getUint8Memory0().subarray(ptr + offset, ptr + len);\n        const ret = encodeString(arg, view);\n\n        offset += ret.written;\n    }\n\n    WASM_VECTOR_LEN = offset;\n    return ptr;\n}\n\nfunction isLikeNone(x) {\n    return x === undefined || x === null;\n}\n\nlet cachedInt32Memory0 = null;\n\nfunction getInt32Memory0() {\n    if (cachedInt32Memory0 === null || cachedInt32Memory0.byteLength === 0) {\n        cachedInt32Memory0 = new Int32Array(wasm.memory.buffer);\n    }\n    return cachedInt32Memory0;\n}\n\nlet cachedFloat64Memory0 = null;\n\nfunction getFloat64Memory0() {\n    if (cachedFloat64Memory0 === null || cachedFloat64Memory0.byteLength === 0) {\n        cachedFloat64Memory0 = new Float64Array(wasm.memory.buffer);\n    }\n    return cachedFloat64Memory0;\n}\n\nlet cachedBigInt64Memory0 = null;\n\nfunction getBigInt64Memory0() {\n    if (cachedBigInt64Memory0 === null || cachedBigInt64Memory0.byteLength === 0) {\n        cachedBigInt64Memory0 = new BigInt64Array(wasm.memory.buffer);\n    }\n    return cachedBigInt64Memory0;\n}\n\nfunction debugString(val) {\n    // primitive types\n    const type = typeof val;\n    if (type == 'number' || type == 'boolean' || val == null) {\n        return  `${val}`;\n    }\n    if (type == 'string') {\n        return `\"${val}\"`;\n    }\n    if (type == 'symbol') {\n        const description = val.description;\n        if (description == null) {\n            return 'Symbol';\n        } else {\n            return `Symbol(${description})`;\n        }\n    }\n    if (type == 'function') {\n        const name = val.name;\n        if (typeof name == 'string' && name.length > 0) {\n            return `Function(${name})`;\n        } else {\n            return 'Function';\n        }\n    }\n    // objects\n    if (Array.isArray(val)) {\n        const length = val.length;\n        let debug = '[';\n        if (length > 0) {\n            debug += debugString(val[0]);\n        }\n        for(let i = 1; i < length; i++) {\n            debug += ', ' + debugString(val[i]);\n        }\n        debug += ']';\n        return debug;\n    }\n    // Test for built-in\n    const builtInMatches = /\\[object ([^\\]]+)\\]/.exec(toString.call(val));\n    let className;\n    if (builtInMatches.length > 1) {\n        className = builtInMatches[1];\n    } else {\n        // Failed to match the standard '[object ClassName]'\n        return toString.call(val);\n    }\n    if (className == 'Object') {\n        // we're a user defined class or Object\n        // JSON.stringify avoids problems with cycles, and is generally much\n        // easier than looping through ownProperties of `val`.\n        try {\n            return 'Object(' + JSON.stringify(val) + ')';\n        } catch (_) {\n            return 'Object';\n        }\n    }\n    // errors\n    if (val instanceof Error) {\n        return `${val.name}: ${val.message}\\n${val.stack}`;\n    }\n    // TODO we could test for more things here, like `Set`s and `Map`s.\n    return className;\n}\n\nfunction makeMutClosure(arg0, arg1, dtor, f) {\n    const state = { a: arg0, b: arg1, cnt: 1, dtor };\n    const real = (...args) => {\n        // First up with a closure we increment the internal reference\n        // count. This ensures that the Rust closure environment won't\n        // be deallocated while we're invoking it.\n        state.cnt++;\n        const a = state.a;\n        state.a = 0;\n        try {\n            return f(a, state.b, ...args);\n        } finally {\n            if (--state.cnt === 0) {\n                wasm.__wbindgen_export_2.get(state.dtor)(a, state.b);\n\n            } else {\n                state.a = a;\n            }\n        }\n    };\n    real.original = state;\n\n    return real;\n}\nfunction __wbg_adapter_50(arg0, arg1, arg2) {\n    wasm.__wbindgen_export_3(arg0, arg1, addHeapObject(arg2));\n}\n\nfunction __wbg_adapter_53(arg0, arg1, arg2) {\n    wasm.__wbindgen_export_4(arg0, arg1, addHeapObject(arg2));\n}\n\n/**\n* Resolves a dependency tree using `spec` as the root package.\n* @param {string} spec\n* @param {any} opts\n* @returns {Promise<NodeMaintainer>}\n*/\nexport function resolveSpec(spec, opts) {\n    const ptr0 = passStringToWasm0(spec, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n    const len0 = WASM_VECTOR_LEN;\n    const ret = wasm.resolveSpec(ptr0, len0, addHeapObject(opts));\n    return takeObject(ret);\n}\n\n/**\n* Returns a dependency tree using a `package.json` manifest as the root\n* package.\n* @param {PackageJson} manifest\n* @param {any} opts\n* @returns {Promise<NodeMaintainer>}\n*/\nexport function resolveManifest(manifest, opts) {\n    const ret = wasm.resolveManifest(addHeapObject(manifest), addHeapObject(opts));\n    return takeObject(ret);\n}\n\n/**\n* Resolves a `Packument` for the given package `spec`.\n*\n* This uses default `Nassun` options and does not cache the result.\n* To configure `Nassun`, and/or enable more efficient caching/reuse,\n* look at `Package#packument` instead.\n* @param {string} spec\n* @param {any} opts\n* @returns {Promise<any>}\n*/\nexport function packument(spec, opts) {\n    const ptr0 = passStringToWasm0(spec, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n    const len0 = WASM_VECTOR_LEN;\n    const ret = wasm.packument(ptr0, len0, addHeapObject(opts));\n    return takeObject(ret);\n}\n\n/**\n* Resolves a partial (\"corgi\") version of the `Packument` for the given\n* package `spec`.\n*\n* This uses default `Nassun` options and does not cache the result.\n* To configure `Nassun`, and/or enable more efficient caching/reuse,\n* look at `Package#packument` instead.\n* @param {string} spec\n* @param {any} opts\n* @returns {Promise<any>}\n*/\nexport function corgiPackument(spec, opts) {\n    const ptr0 = passStringToWasm0(spec, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n    const len0 = WASM_VECTOR_LEN;\n    const ret = wasm.corgiPackument(ptr0, len0, addHeapObject(opts));\n    return takeObject(ret);\n}\n\n/**\n* Resolves version metadata from the given package `spec`, using the default\n* resolution algorithm.\n*\n* This uses default `Nassun` options and does not cache the result. To\n* configure `Nassun`, and/or enable more efficient caching/reuse, look at\n* `Package#metadata` instead.\n* @param {string} spec\n* @param {any} opts\n* @returns {Promise<any>}\n*/\nexport function metadata(spec, opts) {\n    const ptr0 = passStringToWasm0(spec, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n    const len0 = WASM_VECTOR_LEN;\n    const ret = wasm.metadata(ptr0, len0, addHeapObject(opts));\n    return takeObject(ret);\n}\n\n/**\n* Resolves a partial (\"corgi\") version of the version metadata from the\n* given package `spec`, using the default resolution algorithm.\n*\n* This uses default `Nassun` settings and does not cache the result. To\n* configure `Nassun`, and/or enable more efficient caching/reuse, look at\n* `Package#metadata` instead.\n* @param {string} spec\n* @param {any} opts\n* @returns {Promise<any>}\n*/\nexport function corgiMetadata(spec, opts) {\n    const ptr0 = passStringToWasm0(spec, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n    const len0 = WASM_VECTOR_LEN;\n    const ret = wasm.corgiMetadata(ptr0, len0, addHeapObject(opts));\n    return takeObject(ret);\n}\n\n/**\n* Resolves a tarball from the given package `spec`, using the\n* default resolution algorithm. This tarball will have its data checked\n* if the package metadata fetched includes integrity information.\n*\n* This uses default `Nassun` settings and does not cache the result.\n* To configure `Nassun`, and/or enable more efficient caching/reuse,\n* look at `Package#tarball` instead.\n* @param {string} spec\n* @param {any} opts\n* @returns {Promise<ReadableStream>}\n*/\nexport function tarball(spec, opts) {\n    const ptr0 = passStringToWasm0(spec, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n    const len0 = WASM_VECTOR_LEN;\n    const ret = wasm.tarball(ptr0, len0, addHeapObject(opts));\n    return takeObject(ret);\n}\n\n/**\n* Resolves to a `ReadableStream<Entry>` of entries from the given package\n* `spec`, using the default resolution algorithm. The source tarball will\n* have its data checked if the package metadata fetched includes integrity\n* information.\n*\n* This uses default `Nassun` settings and does not cache the result. To\n* configure `Nassun`, and/or enable more efficient caching/reuse, look at\n* `Package#entries` instead.\n* @param {string} spec\n* @param {any} opts\n* @returns {Promise<ReadableStream>}\n*/\nexport function entries(spec, opts) {\n    const ptr0 = passStringToWasm0(spec, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n    const len0 = WASM_VECTOR_LEN;\n    const ret = wasm.entries(ptr0, len0, addHeapObject(opts));\n    return takeObject(ret);\n}\n\nfunction handleError(f, args) {\n    try {\n        return f.apply(this, args);\n    } catch (e) {\n        wasm.__wbindgen_export_6(addHeapObject(e));\n    }\n}\nfunction __wbg_adapter_224(arg0, arg1, arg2, arg3) {\n    wasm.__wbindgen_export_7(arg0, arg1, addHeapObject(arg2), addHeapObject(arg3));\n}\n\n/**\n*/\nexport class IntoUnderlyingByteSource {\n\n    static __wrap(ptr) {\n        const obj = Object.create(IntoUnderlyingByteSource.prototype);\n        obj.ptr = ptr;\n\n        return obj;\n    }\n\n    __destroy_into_raw() {\n        const ptr = this.ptr;\n        this.ptr = 0;\n\n        return ptr;\n    }\n\n    free() {\n        const ptr = this.__destroy_into_raw();\n        wasm.__wbg_intounderlyingbytesource_free(ptr);\n    }\n    /**\n    * @returns {any}\n    */\n    get type() {\n        const ret = wasm.intounderlyingbytesource_type(this.ptr);\n        return takeObject(ret);\n    }\n    /**\n    * @returns {number}\n    */\n    get autoAllocateChunkSize() {\n        const ret = wasm.intounderlyingbytesource_autoAllocateChunkSize(this.ptr);\n        return ret >>> 0;\n    }\n    /**\n    * @param {any} controller\n    */\n    start(controller) {\n        wasm.intounderlyingbytesource_start(this.ptr, addHeapObject(controller));\n    }\n    /**\n    * @param {any} controller\n    * @returns {Promise<any>}\n    */\n    pull(controller) {\n        const ret = wasm.intounderlyingbytesource_pull(this.ptr, addHeapObject(controller));\n        return takeObject(ret);\n    }\n    /**\n    */\n    cancel() {\n        const ptr = this.__destroy_into_raw();\n        wasm.intounderlyingbytesource_cancel(ptr);\n    }\n}\n/**\n*/\nexport class IntoUnderlyingSink {\n\n    __destroy_into_raw() {\n        const ptr = this.ptr;\n        this.ptr = 0;\n\n        return ptr;\n    }\n\n    free() {\n        const ptr = this.__destroy_into_raw();\n        wasm.__wbg_intounderlyingsink_free(ptr);\n    }\n    /**\n    * @param {any} chunk\n    * @returns {Promise<any>}\n    */\n    write(chunk) {\n        const ret = wasm.intounderlyingsink_write(this.ptr, addHeapObject(chunk));\n        return takeObject(ret);\n    }\n    /**\n    * @returns {Promise<any>}\n    */\n    close() {\n        const ptr = this.__destroy_into_raw();\n        const ret = wasm.intounderlyingsink_close(ptr);\n        return takeObject(ret);\n    }\n    /**\n    * @param {any} reason\n    * @returns {Promise<any>}\n    */\n    abort(reason) {\n        const ptr = this.__destroy_into_raw();\n        const ret = wasm.intounderlyingsink_abort(ptr, addHeapObject(reason));\n        return takeObject(ret);\n    }\n}\n/**\n*/\nexport class IntoUnderlyingSource {\n\n    static __wrap(ptr) {\n        const obj = Object.create(IntoUnderlyingSource.prototype);\n        obj.ptr = ptr;\n\n        return obj;\n    }\n\n    __destroy_into_raw() {\n        const ptr = this.ptr;\n        this.ptr = 0;\n\n        return ptr;\n    }\n\n    free() {\n        const ptr = this.__destroy_into_raw();\n        wasm.__wbg_intounderlyingsource_free(ptr);\n    }\n    /**\n    * @param {any} controller\n    * @returns {Promise<any>}\n    */\n    pull(controller) {\n        const ret = wasm.intounderlyingsource_pull(this.ptr, addHeapObject(controller));\n        return takeObject(ret);\n    }\n    /**\n    */\n    cancel() {\n        const ptr = this.__destroy_into_raw();\n        wasm.intounderlyingsource_cancel(ptr);\n    }\n}\n/**\n* NPM package client used to resolve and fetch package data and metadata.\n*/\nexport class Nassun {\n\n    static __wrap(ptr) {\n        const obj = Object.create(Nassun.prototype);\n        obj.ptr = ptr;\n\n        return obj;\n    }\n\n    __destroy_into_raw() {\n        const ptr = this.ptr;\n        this.ptr = 0;\n\n        return ptr;\n    }\n\n    free() {\n        const ptr = this.__destroy_into_raw();\n        wasm.__wbg_nassun_free(ptr);\n    }\n    /**\n    * Create a new Nassun instance with the given options.\n    * @param {any} opts\n    */\n    constructor(opts) {\n        try {\n            const retptr = wasm.__wbindgen_add_to_stack_pointer(-16);\n            wasm.nassun_new(retptr, addHeapObject(opts));\n            var r0 = getInt32Memory0()[retptr / 4 + 0];\n            var r1 = getInt32Memory0()[retptr / 4 + 1];\n            var r2 = getInt32Memory0()[retptr / 4 + 2];\n            if (r2) {\n                throw takeObject(r1);\n            }\n            return Nassun.__wrap(r0);\n        } finally {\n            wasm.__wbindgen_add_to_stack_pointer(16);\n        }\n    }\n    /**\n    * Resolve a spec (e.g. `foo@^1.2.3`, `github:foo/bar`, etc), to a\n    * `Package` that can be used for further operations.\n    * @param {string} spec\n    * @returns {Promise<Package>}\n    */\n    resolve(spec) {\n        const ptr0 = passStringToWasm0(spec, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n        const len0 = WASM_VECTOR_LEN;\n        const ret = wasm.nassun_resolve(this.ptr, ptr0, len0);\n        return takeObject(ret);\n    }\n    /**\n    * Resolves a packument object for the given package `spec`.\n    * @param {string} spec\n    * @returns {Promise<any>}\n    */\n    packument(spec) {\n        const ptr0 = passStringToWasm0(spec, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n        const len0 = WASM_VECTOR_LEN;\n        const ret = wasm.nassun_packument(this.ptr, ptr0, len0);\n        return takeObject(ret);\n    }\n    /**\n    * Resolves version metadata from the given package `spec`.\n    * @param {string} spec\n    * @returns {Promise<any>}\n    */\n    metadata(spec) {\n        const ptr0 = passStringToWasm0(spec, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n        const len0 = WASM_VECTOR_LEN;\n        const ret = wasm.nassun_metadata(this.ptr, ptr0, len0);\n        return takeObject(ret);\n    }\n    /**\n    * Resolves a partial (corgi) version of the packument object for the\n    * given package `spec`.\n    * @param {string} spec\n    * @returns {Promise<any>}\n    */\n    corgiPackument(spec) {\n        const ptr0 = passStringToWasm0(spec, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n        const len0 = WASM_VECTOR_LEN;\n        const ret = wasm.nassun_corgiPackument(this.ptr, ptr0, len0);\n        return takeObject(ret);\n    }\n    /**\n    * Resolves a partial (corgi) version of the version metadata from the\n    * given package `spec`.\n    * @param {string} spec\n    * @returns {Promise<any>}\n    */\n    corgiMetadata(spec) {\n        const ptr0 = passStringToWasm0(spec, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n        const len0 = WASM_VECTOR_LEN;\n        const ret = wasm.nassun_corgiMetadata(this.ptr, ptr0, len0);\n        return takeObject(ret);\n    }\n    /**\n    * Resolves a `ReadableStream<Uint8Array>` tarball from the given package\n    * `spec`. This tarball will have its data checked if the package\n    * metadata fetched includes integrity information.\n    * @param {string} spec\n    * @returns {Promise<ReadableStream>}\n    */\n    tarball(spec) {\n        const ptr0 = passStringToWasm0(spec, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n        const len0 = WASM_VECTOR_LEN;\n        const ret = wasm.nassun_tarball(this.ptr, ptr0, len0);\n        return takeObject(ret);\n    }\n    /**\n    * Resolves to a `ReadableStream<Entry>` of entries from the given package\n    * `spec`, using the default resolution algorithm. The source tarball will\n    * have its data checked if the package metadata fetched includes integrity\n    * information.\n    * @param {string} spec\n    * @returns {Promise<ReadableStream>}\n    */\n    entries(spec) {\n        const ptr0 = passStringToWasm0(spec, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n        const len0 = WASM_VECTOR_LEN;\n        const ret = wasm.nassun_entries(this.ptr, ptr0, len0);\n        return takeObject(ret);\n    }\n}\n/**\n* An NPM-compatible dependency resolver. NodeMaintainer builds trees of\n* package nodes that can be used to generate lockfiles or fetch package\n* tarballs, or even extract them to where they would live in `node_modules`.\n*/\nexport class NodeMaintainer {\n\n    static __wrap(ptr) {\n        const obj = Object.create(NodeMaintainer.prototype);\n        obj.ptr = ptr;\n\n        return obj;\n    }\n\n    __destroy_into_raw() {\n        const ptr = this.ptr;\n        this.ptr = 0;\n\n        return ptr;\n    }\n\n    free() {\n        const ptr = this.__destroy_into_raw();\n        wasm.__wbg_nodemaintainer_free(ptr);\n    }\n    /**\n    * Resolves a dependency tree using `spec` as the root package.\n    * @param {string} spec\n    * @param {any} opts\n    * @returns {Promise<NodeMaintainer>}\n    */\n    static resolveSpec(spec, opts) {\n        const ptr0 = passStringToWasm0(spec, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n        const len0 = WASM_VECTOR_LEN;\n        const ret = wasm.nodemaintainer_resolveSpec(ptr0, len0, addHeapObject(opts));\n        return takeObject(ret);\n    }\n    /**\n    * Returns a dependency tree using a `package.json` manifest as the root\n    * package.\n    * @param {PackageJson} manifest\n    * @param {any} opts\n    * @returns {Promise<NodeMaintainer>}\n    */\n    static resolveManifest(manifest, opts) {\n        const ret = wasm.nodemaintainer_resolveManifest(addHeapObject(manifest), addHeapObject(opts));\n        return takeObject(ret);\n    }\n    /**\n    * Returns the contents of a package-lock.kdl lockfile for this resolved tree.\n    * @returns {string}\n    */\n    toKdl() {\n        try {\n            const retptr = wasm.__wbindgen_add_to_stack_pointer(-16);\n            wasm.nodemaintainer_toKdl(retptr, this.ptr);\n            var r0 = getInt32Memory0()[retptr / 4 + 0];\n            var r1 = getInt32Memory0()[retptr / 4 + 1];\n            var r2 = getInt32Memory0()[retptr / 4 + 2];\n            var r3 = getInt32Memory0()[retptr / 4 + 3];\n            var ptr0 = r0;\n            var len0 = r1;\n            if (r3) {\n                ptr0 = 0; len0 = 0;\n                throw takeObject(r2);\n            }\n            return getStringFromWasm0(ptr0, len0);\n        } finally {\n            wasm.__wbindgen_add_to_stack_pointer(16);\n            wasm.__wbindgen_export_5(ptr0, len0);\n        }\n    }\n    /**\n    * Given a path within node_modules, returns the package that the\n    * referenced file/directory belongs to.\n    * @param {string} path\n    * @returns {Package | undefined}\n    */\n    packageAtPath(path) {\n        const ptr0 = passStringToWasm0(path, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n        const len0 = WASM_VECTOR_LEN;\n        const ret = wasm.nodemaintainer_packageAtPath(this.ptr, ptr0, len0);\n        return ret === 0 ? undefined : Package.__wrap(ret);\n    }\n    /**\n    * Concurrently over all packages in the tree, calling `f` on each.\n    * @param {Function} f\n    * @returns {Promise<void>}\n    */\n    forEachPackage(f) {\n        const ret = wasm.nodemaintainer_forEachPackage(this.ptr, addHeapObject(f));\n        return takeObject(ret);\n    }\n}\n/**\n* Options for configuration for various `NodeMaintainer` operations.\n*/\nexport class NodeMaintainerOptions {\n\n    __destroy_into_raw() {\n        const ptr = this.ptr;\n        this.ptr = 0;\n\n        return ptr;\n    }\n\n    free() {\n        const ptr = this.__destroy_into_raw();\n        wasm.__wbg_nodemaintaineroptions_free(ptr);\n    }\n}\n/**\n* A resolved package. A concrete version has been determined from its\n* PackageSpec by the version resolver.\n*/\nexport class Package {\n\n    static __wrap(ptr) {\n        const obj = Object.create(Package.prototype);\n        obj.ptr = ptr;\n\n        return obj;\n    }\n\n    __destroy_into_raw() {\n        const ptr = this.ptr;\n        this.ptr = 0;\n\n        return ptr;\n    }\n\n    free() {\n        const ptr = this.__destroy_into_raw();\n        wasm.__wbg_package_free(ptr);\n    }\n    /**\n    * Original package spec that this `Package` was resolved from.\n    * @returns {any}\n    */\n    get from() {\n        const ret = wasm.package_from(this.ptr);\n        return takeObject(ret);\n    }\n    /**\n    * Name of the package, as it should be used in the dependency graph.\n    * @returns {any}\n    */\n    get name() {\n        const ret = wasm.package_name(this.ptr);\n        return takeObject(ret);\n    }\n    /**\n    * The package resolution information that this `Package` was created from.\n    * @returns {any}\n    */\n    get resolved() {\n        const ret = wasm.package_resolved(this.ptr);\n        return takeObject(ret);\n    }\n    /**\n    * The partial (corgi) version of the packument that this `Package` was\n    * resolved from.\n    * @returns {Promise<any>}\n    */\n    corgiPackument() {\n        const ret = wasm.package_corgiPackument(this.ptr);\n        return takeObject(ret);\n    }\n    /**\n    * The partial (corgi) version of the version metadata, aka roughly the\n    * metadata defined in `package.json`.\n    * @returns {Promise<any>}\n    */\n    corgiMetadata() {\n        const ret = wasm.package_corgiMetadata(this.ptr);\n        return takeObject(ret);\n    }\n    /**\n    * The full packument that this `Package` was resolved from.\n    * @returns {Promise<any>}\n    */\n    packument() {\n        const ret = wasm.package_packument(this.ptr);\n        return takeObject(ret);\n    }\n    /**\n    * The version metadata, aka roughly the metadata defined in\n    * `package.json`.\n    * @returns {Promise<any>}\n    */\n    metadata() {\n        const ret = wasm.package_metadata(this.ptr);\n        return takeObject(ret);\n    }\n    /**\n    * A `ReadableStream<Uint8Array>` tarball for this package. This tarball\n    * will have its data checked if the package metadata fetched includes\n    * integrity information.\n    * @returns {Promise<ReadableStream>}\n    */\n    tarball() {\n        const ret = wasm.package_tarball(this.ptr);\n        return takeObject(ret);\n    }\n    /**\n    * A `ReadableStream<Entry>` of entries for this package. The source\n    * tarball will have its data checked if the package metadata fetched\n    * includes integrity information.\n    * @returns {Promise<ReadableStream>}\n    */\n    entries() {\n        const ret = wasm.package_entries(this.ptr);\n        return takeObject(ret);\n    }\n}\n/**\n* Raw options for [`pipeTo()`](https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream/pipeTo).\n*/\nexport class PipeOptions {\n\n    __destroy_into_raw() {\n        const ptr = this.ptr;\n        this.ptr = 0;\n\n        return ptr;\n    }\n\n    free() {\n        const ptr = this.__destroy_into_raw();\n        wasm.__wbg_pipeoptions_free(ptr);\n    }\n    /**\n    * @returns {boolean}\n    */\n    get preventClose() {\n        const ret = wasm.pipeoptions_preventClose(this.ptr);\n        return ret !== 0;\n    }\n    /**\n    * @returns {boolean}\n    */\n    get preventCancel() {\n        const ret = wasm.pipeoptions_preventCancel(this.ptr);\n        return ret !== 0;\n    }\n    /**\n    * @returns {boolean}\n    */\n    get preventAbort() {\n        const ret = wasm.pipeoptions_preventAbort(this.ptr);\n        return ret !== 0;\n    }\n    /**\n    * @returns {AbortSignal | undefined}\n    */\n    get signal() {\n        const ret = wasm.pipeoptions_signal(this.ptr);\n        return takeObject(ret);\n    }\n}\n/**\n*/\nexport class QueuingStrategy {\n\n    static __wrap(ptr) {\n        const obj = Object.create(QueuingStrategy.prototype);\n        obj.ptr = ptr;\n\n        return obj;\n    }\n\n    __destroy_into_raw() {\n        const ptr = this.ptr;\n        this.ptr = 0;\n\n        return ptr;\n    }\n\n    free() {\n        const ptr = this.__destroy_into_raw();\n        wasm.__wbg_queuingstrategy_free(ptr);\n    }\n    /**\n    * @returns {number}\n    */\n    get highWaterMark() {\n        const ret = wasm.queuingstrategy_highWaterMark(this.ptr);\n        return ret;\n    }\n}\n/**\n* Raw options for [`getReader()`](https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream/getReader).\n*/\nexport class ReadableStreamGetReaderOptions {\n\n    __destroy_into_raw() {\n        const ptr = this.ptr;\n        this.ptr = 0;\n\n        return ptr;\n    }\n\n    free() {\n        const ptr = this.__destroy_into_raw();\n        wasm.__wbg_readablestreamgetreaderoptions_free(ptr);\n    }\n    /**\n    * @returns {any}\n    */\n    get mode() {\n        const ret = wasm.readablestreamgetreaderoptions_mode(this.ptr);\n        return takeObject(ret);\n    }\n}\n\nasync function load(module, imports) {\n    if (typeof Response === 'function' && module instanceof Response) {\n        if (typeof WebAssembly.instantiateStreaming === 'function') {\n            try {\n                return await WebAssembly.instantiateStreaming(module, imports);\n\n            } catch (e) {\n                if (module.headers.get('Content-Type') != 'application/wasm') {\n                    console.warn(\"`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\\n\", e);\n\n                } else {\n                    throw e;\n                }\n            }\n        }\n\n        const bytes = await module.arrayBuffer();\n        return await WebAssembly.instantiate(bytes, imports);\n\n    } else {\n        const instance = await WebAssembly.instantiate(module, imports);\n\n        if (instance instanceof WebAssembly.Instance) {\n            return { instance, module };\n\n        } else {\n            return instance;\n        }\n    }\n}\n\nfunction getImports() {\n    const imports = {};\n    imports.wbg = {};\n    imports.wbg.__wbindgen_object_drop_ref = function(arg0) {\n        takeObject(arg0);\n    };\n    imports.wbg.__wbindgen_string_new = function(arg0, arg1) {\n        const ret = getStringFromWasm0(arg0, arg1);\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbindgen_string_get = function(arg0, arg1) {\n        const obj = getObject(arg1);\n        const ret = typeof(obj) === 'string' ? obj : undefined;\n        var ptr0 = isLikeNone(ret) ? 0 : passStringToWasm0(ret, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n        var len0 = WASM_VECTOR_LEN;\n        getInt32Memory0()[arg0 / 4 + 1] = len0;\n        getInt32Memory0()[arg0 / 4 + 0] = ptr0;\n    };\n    imports.wbg.__wbg_nodemaintainer_new = function(arg0) {\n        const ret = NodeMaintainer.__wrap(arg0);\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbindgen_is_bigint = function(arg0) {\n        const ret = typeof(getObject(arg0)) === 'bigint';\n        return ret;\n    };\n    imports.wbg.__wbindgen_bigint_from_u64 = function(arg0) {\n        const ret = BigInt.asUintN(64, arg0);\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbindgen_jsval_eq = function(arg0, arg1) {\n        const ret = getObject(arg0) === getObject(arg1);\n        return ret;\n    };\n    imports.wbg.__wbindgen_is_object = function(arg0) {\n        const val = getObject(arg0);\n        const ret = typeof(val) === 'object' && val !== null;\n        return ret;\n    };\n    imports.wbg.__wbindgen_is_undefined = function(arg0) {\n        const ret = getObject(arg0) === undefined;\n        return ret;\n    };\n    imports.wbg.__wbindgen_in = function(arg0, arg1) {\n        const ret = getObject(arg0) in getObject(arg1);\n        return ret;\n    };\n    imports.wbg.__wbindgen_cb_drop = function(arg0) {\n        const obj = takeObject(arg0).original;\n        if (obj.cnt-- == 1) {\n            obj.a = 0;\n            return true;\n        }\n        const ret = false;\n        return ret;\n    };\n    imports.wbg.__wbindgen_error_new = function(arg0, arg1) {\n        const ret = new Error(getStringFromWasm0(arg0, arg1));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbindgen_number_new = function(arg0) {\n        const ret = arg0;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbindgen_is_string = function(arg0) {\n        const ret = typeof(getObject(arg0)) === 'string';\n        return ret;\n    };\n    imports.wbg.__wbg_package_new = function(arg0) {\n        const ret = Package.__wrap(arg0);\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbindgen_object_clone_ref = function(arg0) {\n        const ret = getObject(arg0);\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_new_abda76e883ba8a5f = function() {\n        const ret = new Error();\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_stack_658279fe44541cf6 = function(arg0, arg1) {\n        const ret = getObject(arg1).stack;\n        const ptr0 = passStringToWasm0(ret, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n        const len0 = WASM_VECTOR_LEN;\n        getInt32Memory0()[arg0 / 4 + 1] = len0;\n        getInt32Memory0()[arg0 / 4 + 0] = ptr0;\n    };\n    imports.wbg.__wbg_error_f851667af71bcfc6 = function(arg0, arg1) {\n        try {\n            console.error(getStringFromWasm0(arg0, arg1));\n        } finally {\n            wasm.__wbindgen_export_5(arg0, arg1);\n        }\n    };\n    imports.wbg.__wbindgen_bigint_from_i64 = function(arg0) {\n        const ret = arg0;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbindgen_jsval_loose_eq = function(arg0, arg1) {\n        const ret = getObject(arg0) == getObject(arg1);\n        return ret;\n    };\n    imports.wbg.__wbindgen_boolean_get = function(arg0) {\n        const v = getObject(arg0);\n        const ret = typeof(v) === 'boolean' ? (v ? 1 : 0) : 2;\n        return ret;\n    };\n    imports.wbg.__wbindgen_number_get = function(arg0, arg1) {\n        const obj = getObject(arg1);\n        const ret = typeof(obj) === 'number' ? obj : undefined;\n        getFloat64Memory0()[arg0 / 8 + 1] = isLikeNone(ret) ? 0 : ret;\n        getInt32Memory0()[arg0 / 4 + 0] = !isLikeNone(ret);\n    };\n    imports.wbg.__wbg_String_91fba7ded13ba54c = function(arg0, arg1) {\n        const ret = String(getObject(arg1));\n        const ptr0 = passStringToWasm0(ret, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n        const len0 = WASM_VECTOR_LEN;\n        getInt32Memory0()[arg0 / 4 + 1] = len0;\n        getInt32Memory0()[arg0 / 4 + 0] = ptr0;\n    };\n    imports.wbg.__wbg_getwithrefkey_15c62c2b8546208d = function(arg0, arg1) {\n        const ret = getObject(arg0)[getObject(arg1)];\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_set_20cbc34131e76824 = function(arg0, arg1, arg2) {\n        getObject(arg0)[takeObject(arg1)] = takeObject(arg2);\n    };\n    imports.wbg.__wbg_fetch_cf75ae0b20981e3e = function(arg0) {\n        const ret = fetch(getObject(arg0));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_newwithsource_d169ed5262a23b74 = function(arg0, arg1) {\n        const ret = new ReadableStream(IntoUnderlyingSource.__wrap(arg0), QueuingStrategy.__wrap(arg1));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_newwithbytesource_33937abb6afe07ad = function() { return handleError(function (arg0) {\n        const ret = new ReadableStream(IntoUnderlyingByteSource.__wrap(arg0));\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_getReader_2dcca5fb18e09eed = function() { return handleError(function (arg0) {\n        const ret = getObject(arg0).getReader();\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_close_a41954830b65c455 = function(arg0) {\n        getObject(arg0).close();\n    };\n    imports.wbg.__wbg_enqueue_3a8a8e67e44d2567 = function(arg0, arg1) {\n        getObject(arg0).enqueue(getObject(arg1));\n    };\n    imports.wbg.__wbg_byobRequest_a3c74c3694777d1b = function(arg0) {\n        const ret = getObject(arg0).byobRequest;\n        return isLikeNone(ret) ? 0 : addHeapObject(ret);\n    };\n    imports.wbg.__wbg_close_045ed342139beb7d = function(arg0) {\n        getObject(arg0).close();\n    };\n    imports.wbg.__wbg_view_d1a31268af734e5d = function(arg0) {\n        const ret = getObject(arg0).view;\n        return isLikeNone(ret) ? 0 : addHeapObject(ret);\n    };\n    imports.wbg.__wbg_respond_f4778bef04e912a6 = function(arg0, arg1) {\n        getObject(arg0).respond(arg1 >>> 0);\n    };\n    imports.wbg.__wbg_buffer_610b70c8fd30da2d = function(arg0) {\n        const ret = getObject(arg0).buffer;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_byteOffset_ede786cfcf88d3dd = function(arg0) {\n        const ret = getObject(arg0).byteOffset;\n        return ret;\n    };\n    imports.wbg.__wbg_byteLength_1fef7842ca4200fa = function(arg0) {\n        const ret = getObject(arg0).byteLength;\n        return ret;\n    };\n    imports.wbg.__wbg_cancel_ec971cf80c0cb93c = function(arg0) {\n        const ret = getObject(arg0).cancel();\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_releaseLock_63a4cb6bda4eb742 = function() { return handleError(function (arg0) {\n        getObject(arg0).releaseLock();\n    }, arguments) };\n    imports.wbg.__wbg_read_2ca7e46df6e5a6f6 = function(arg0) {\n        const ret = getObject(arg0).read();\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_done_a0a250be29d69e10 = function(arg0) {\n        const ret = getObject(arg0).done;\n        return ret;\n    };\n    imports.wbg.__wbg_value_b71fc239df8382f0 = function(arg0) {\n        const ret = getObject(arg0).value;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_bytesliteral_efe7d360639bf32b = function() {\n        const ret = bytes_literal();\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_newwithstrandinit_c45f0dc6da26fd03 = function() { return handleError(function (arg0, arg1, arg2) {\n        const ret = new Request(getStringFromWasm0(arg0, arg1), getObject(arg2));\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_signal_686bf5a4acff74a1 = function(arg0) {\n        const ret = getObject(arg0).signal;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_new_a16bcd3b8d000a4f = function() { return handleError(function () {\n        const ret = new AbortController();\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_abort_5f06bf3b2954cf33 = function(arg0) {\n        getObject(arg0).abort();\n    };\n    imports.wbg.__wbg_fetch_661ffba2a4f2519c = function(arg0, arg1) {\n        const ret = getObject(arg0).fetch(getObject(arg1));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_instanceof_Response_fb3a4df648c1859b = function(arg0) {\n        let result;\n        try {\n            result = getObject(arg0) instanceof Response;\n        } catch {\n            result = false;\n        }\n        const ret = result;\n        return ret;\n    };\n    imports.wbg.__wbg_url_8ec2534cdfacb103 = function(arg0, arg1) {\n        const ret = getObject(arg1).url;\n        const ptr0 = passStringToWasm0(ret, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n        const len0 = WASM_VECTOR_LEN;\n        getInt32Memory0()[arg0 / 4 + 1] = len0;\n        getInt32Memory0()[arg0 / 4 + 0] = ptr0;\n    };\n    imports.wbg.__wbg_status_d483a4ac847f380a = function(arg0) {\n        const ret = getObject(arg0).status;\n        return ret;\n    };\n    imports.wbg.__wbg_headers_6093927dc359903e = function(arg0) {\n        const ret = getObject(arg0).headers;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_body_aeb10a3b63770556 = function(arg0) {\n        const ret = getObject(arg0).body;\n        return isLikeNone(ret) ? 0 : addHeapObject(ret);\n    };\n    imports.wbg.__wbg_text_f61464d781b099f0 = function() { return handleError(function (arg0) {\n        const ret = getObject(arg0).text();\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_new_f1c3a9c2533a55b8 = function() { return handleError(function () {\n        const ret = new Headers();\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_append_1be1d651f9ecf2eb = function() { return handleError(function (arg0, arg1, arg2, arg3, arg4) {\n        getObject(arg0).append(getStringFromWasm0(arg1, arg2), getStringFromWasm0(arg3, arg4));\n    }, arguments) };\n    imports.wbg.__wbg_get_27fe3dac1c4d0224 = function(arg0, arg1) {\n        const ret = getObject(arg0)[arg1 >>> 0];\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_length_e498fbc24f9c1d4f = function(arg0) {\n        const ret = getObject(arg0).length;\n        return ret;\n    };\n    imports.wbg.__wbg_new_b525de17f44a8943 = function() {\n        const ret = new Array();\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbindgen_is_function = function(arg0) {\n        const ret = typeof(getObject(arg0)) === 'function';\n        return ret;\n    };\n    imports.wbg.__wbg_newnoargs_2b8b6bd7753c76ba = function(arg0, arg1) {\n        const ret = new Function(getStringFromWasm0(arg0, arg1));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_new_f841cc6f2098f4b5 = function() {\n        const ret = new Map();\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_next_b7d530c04fd8b217 = function(arg0) {\n        const ret = getObject(arg0).next;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_next_88560ec06a094dea = function() { return handleError(function (arg0) {\n        const ret = getObject(arg0).next();\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_done_1ebec03bbd919843 = function(arg0) {\n        const ret = getObject(arg0).done;\n        return ret;\n    };\n    imports.wbg.__wbg_value_6ac8da5cc5b3efda = function(arg0) {\n        const ret = getObject(arg0).value;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_iterator_55f114446221aa5a = function() {\n        const ret = Symbol.iterator;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_get_baf4855f9a986186 = function() { return handleError(function (arg0, arg1) {\n        const ret = Reflect.get(getObject(arg0), getObject(arg1));\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_call_95d1ea488d03e4e8 = function() { return handleError(function (arg0, arg1) {\n        const ret = getObject(arg0).call(getObject(arg1));\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_new_f9876326328f45ed = function() {\n        const ret = new Object();\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_self_e7c1f827057f6584 = function() { return handleError(function () {\n        const ret = self.self;\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_window_a09ec664e14b1b81 = function() { return handleError(function () {\n        const ret = window.window;\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_globalThis_87cbb8506fecf3a9 = function() { return handleError(function () {\n        const ret = globalThis.globalThis;\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_global_c85a9259e621f3db = function() { return handleError(function () {\n        const ret = global.global;\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_set_17224bc548dd1d7b = function(arg0, arg1, arg2) {\n        getObject(arg0)[arg1 >>> 0] = takeObject(arg2);\n    };\n    imports.wbg.__wbg_isArray_39d28997bf6b96b4 = function(arg0) {\n        const ret = Array.isArray(getObject(arg0));\n        return ret;\n    };\n    imports.wbg.__wbg_instanceof_ArrayBuffer_a69f02ee4c4f5065 = function(arg0) {\n        let result;\n        try {\n            result = getObject(arg0) instanceof ArrayBuffer;\n        } catch {\n            result = false;\n        }\n        const ret = result;\n        return ret;\n    };\n    imports.wbg.__wbg_new_15d3966e9981a196 = function(arg0, arg1) {\n        const ret = new Error(getStringFromWasm0(arg0, arg1));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_call_9495de66fdbe016b = function() { return handleError(function (arg0, arg1, arg2) {\n        const ret = getObject(arg0).call(getObject(arg1), getObject(arg2));\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_call_96878afb7a8201ca = function() { return handleError(function (arg0, arg1, arg2, arg3) {\n        const ret = getObject(arg0).call(getObject(arg1), getObject(arg2), getObject(arg3));\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbg_set_388c4c6422704173 = function(arg0, arg1, arg2) {\n        const ret = getObject(arg0).set(getObject(arg1), getObject(arg2));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_isSafeInteger_8c4789029e885159 = function(arg0) {\n        const ret = Number.isSafeInteger(getObject(arg0));\n        return ret;\n    };\n    imports.wbg.__wbg_entries_4e1315b774245952 = function(arg0) {\n        const ret = Object.entries(getObject(arg0));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_instanceof_Promise_4333c4e5587e8936 = function(arg0) {\n        let result;\n        try {\n            result = getObject(arg0) instanceof Promise;\n        } catch {\n            result = false;\n        }\n        const ret = result;\n        return ret;\n    };\n    imports.wbg.__wbg_new_9d3a9ce4282a18a8 = function(arg0, arg1) {\n        try {\n            var state0 = {a: arg0, b: arg1};\n            var cb0 = (arg0, arg1) => {\n                const a = state0.a;\n                state0.a = 0;\n                try {\n                    return __wbg_adapter_224(a, state0.b, arg0, arg1);\n                } finally {\n                    state0.a = a;\n                }\n            };\n            const ret = new Promise(cb0);\n            return addHeapObject(ret);\n        } finally {\n            state0.a = state0.b = 0;\n        }\n    };\n    imports.wbg.__wbg_resolve_fd40f858d9db1a04 = function(arg0) {\n        const ret = Promise.resolve(getObject(arg0));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_catch_44bf25c15946bac0 = function(arg0, arg1) {\n        const ret = getObject(arg0).catch(getObject(arg1));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_then_ec5db6d509eb475f = function(arg0, arg1) {\n        const ret = getObject(arg0).then(getObject(arg1));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_then_f753623316e2873a = function(arg0, arg1, arg2) {\n        const ret = getObject(arg0).then(getObject(arg1), getObject(arg2));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_buffer_cf65c07de34b9a08 = function(arg0) {\n        const ret = getObject(arg0).buffer;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_newwithbyteoffsetandlength_9fb2f11355ecadf5 = function(arg0, arg1, arg2) {\n        const ret = new Uint8Array(getObject(arg0), arg1 >>> 0, arg2 >>> 0);\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_new_537b7341ce90bb31 = function(arg0) {\n        const ret = new Uint8Array(getObject(arg0));\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbg_set_17499e8aa4003ebd = function(arg0, arg1, arg2) {\n        getObject(arg0).set(getObject(arg1), arg2 >>> 0);\n    };\n    imports.wbg.__wbg_length_27a2afe8ab42b09f = function(arg0) {\n        const ret = getObject(arg0).length;\n        return ret;\n    };\n    imports.wbg.__wbg_instanceof_Uint8Array_01cebe79ca606cca = function(arg0) {\n        let result;\n        try {\n            result = getObject(arg0) instanceof Uint8Array;\n        } catch {\n            result = false;\n        }\n        const ret = result;\n        return ret;\n    };\n    imports.wbg.__wbg_has_3feea89d34bd7ad5 = function() { return handleError(function (arg0, arg1) {\n        const ret = Reflect.has(getObject(arg0), getObject(arg1));\n        return ret;\n    }, arguments) };\n    imports.wbg.__wbg_set_6aa458a4ebdb65cb = function() { return handleError(function (arg0, arg1, arg2) {\n        const ret = Reflect.set(getObject(arg0), getObject(arg1), getObject(arg2));\n        return ret;\n    }, arguments) };\n    imports.wbg.__wbg_stringify_029a979dfb73aa17 = function() { return handleError(function (arg0) {\n        const ret = JSON.stringify(getObject(arg0));\n        return addHeapObject(ret);\n    }, arguments) };\n    imports.wbg.__wbindgen_bigint_get_as_i64 = function(arg0, arg1) {\n        const v = getObject(arg1);\n        const ret = typeof(v) === 'bigint' ? v : undefined;\n        getBigInt64Memory0()[arg0 / 8 + 1] = isLikeNone(ret) ? BigInt(0) : ret;\n        getInt32Memory0()[arg0 / 4 + 0] = !isLikeNone(ret);\n    };\n    imports.wbg.__wbindgen_debug_string = function(arg0, arg1) {\n        const ret = debugString(getObject(arg1));\n        const ptr0 = passStringToWasm0(ret, wasm.__wbindgen_export_0, wasm.__wbindgen_export_1);\n        const len0 = WASM_VECTOR_LEN;\n        getInt32Memory0()[arg0 / 4 + 1] = len0;\n        getInt32Memory0()[arg0 / 4 + 0] = ptr0;\n    };\n    imports.wbg.__wbindgen_throw = function(arg0, arg1) {\n        throw new Error(getStringFromWasm0(arg0, arg1));\n    };\n    imports.wbg.__wbindgen_rethrow = function(arg0) {\n        throw takeObject(arg0);\n    };\n    imports.wbg.__wbindgen_memory = function() {\n        const ret = wasm.memory;\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbindgen_closure_wrapper2178 = function(arg0, arg1, arg2) {\n        const ret = makeMutClosure(arg0, arg1, 747, __wbg_adapter_50);\n        return addHeapObject(ret);\n    };\n    imports.wbg.__wbindgen_closure_wrapper2759 = function(arg0, arg1, arg2) {\n        const ret = makeMutClosure(arg0, arg1, 967, __wbg_adapter_53);\n        return addHeapObject(ret);\n    };\n\n    return imports;\n}\n\nfunction initMemory(imports, maybe_memory) {\n\n}\n\nfunction finalizeInit(instance, module) {\n    wasm = instance.exports;\n    init.__wbindgen_wasm_module = module;\n    cachedBigInt64Memory0 = null;\n    cachedFloat64Memory0 = null;\n    cachedInt32Memory0 = null;\n    cachedUint8Memory0 = null;\n\n\n    return wasm;\n}\n\nfunction initSync(module) {\n    const imports = getImports();\n\n    initMemory(imports);\n\n    if (!(module instanceof WebAssembly.Module)) {\n        module = new WebAssembly.Module(module);\n    }\n\n    const instance = new WebAssembly.Instance(module, imports);\n\n    return finalizeInit(instance, module);\n}\n\nasync function init(input) {\n    if (typeof input === 'undefined') {\n        input = new URL('node_maintainer_bg.wasm', import.meta.url);\n    }\n    const imports = getImports();\n\n    if (typeof input === 'string' || (typeof Request === 'function' && input instanceof Request) || (typeof URL === 'function' && input instanceof URL)) {\n        input = fetch(input);\n    }\n\n    initMemory(imports);\n\n    const { instance, module } = await load(await input, imports);\n\n    return finalizeInit(instance, module);\n}\n\nexport { initSync }\nexport default init;\n","export function bytes_literal() { return \"bytes\"; }","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\n/**\n * Creates a JSON scanner on the given text.\n * If ignoreTrivia is set, whitespaces or comments are ignored.\n */\nexport function createScanner(text, ignoreTrivia = false) {\n    const len = text.length;\n    let pos = 0, value = '', tokenOffset = 0, token = 16 /* SyntaxKind.Unknown */, lineNumber = 0, lineStartOffset = 0, tokenLineStartOffset = 0, prevTokenLineStartOffset = 0, scanError = 0 /* ScanError.None */;\n    function scanHexDigits(count, exact) {\n        let digits = 0;\n        let value = 0;\n        while (digits < count || !exact) {\n            let ch = text.charCodeAt(pos);\n            if (ch >= 48 /* CharacterCodes._0 */ && ch <= 57 /* CharacterCodes._9 */) {\n                value = value * 16 + ch - 48 /* CharacterCodes._0 */;\n            }\n            else if (ch >= 65 /* CharacterCodes.A */ && ch <= 70 /* CharacterCodes.F */) {\n                value = value * 16 + ch - 65 /* CharacterCodes.A */ + 10;\n            }\n            else if (ch >= 97 /* CharacterCodes.a */ && ch <= 102 /* CharacterCodes.f */) {\n                value = value * 16 + ch - 97 /* CharacterCodes.a */ + 10;\n            }\n            else {\n                break;\n            }\n            pos++;\n            digits++;\n        }\n        if (digits < count) {\n            value = -1;\n        }\n        return value;\n    }\n    function setPosition(newPosition) {\n        pos = newPosition;\n        value = '';\n        tokenOffset = 0;\n        token = 16 /* SyntaxKind.Unknown */;\n        scanError = 0 /* ScanError.None */;\n    }\n    function scanNumber() {\n        let start = pos;\n        if (text.charCodeAt(pos) === 48 /* CharacterCodes._0 */) {\n            pos++;\n        }\n        else {\n            pos++;\n            while (pos < text.length && isDigit(text.charCodeAt(pos))) {\n                pos++;\n            }\n        }\n        if (pos < text.length && text.charCodeAt(pos) === 46 /* CharacterCodes.dot */) {\n            pos++;\n            if (pos < text.length && isDigit(text.charCodeAt(pos))) {\n                pos++;\n                while (pos < text.length && isDigit(text.charCodeAt(pos))) {\n                    pos++;\n                }\n            }\n            else {\n                scanError = 3 /* ScanError.UnexpectedEndOfNumber */;\n                return text.substring(start, pos);\n            }\n        }\n        let end = pos;\n        if (pos < text.length && (text.charCodeAt(pos) === 69 /* CharacterCodes.E */ || text.charCodeAt(pos) === 101 /* CharacterCodes.e */)) {\n            pos++;\n            if (pos < text.length && text.charCodeAt(pos) === 43 /* CharacterCodes.plus */ || text.charCodeAt(pos) === 45 /* CharacterCodes.minus */) {\n                pos++;\n            }\n            if (pos < text.length && isDigit(text.charCodeAt(pos))) {\n                pos++;\n                while (pos < text.length && isDigit(text.charCodeAt(pos))) {\n                    pos++;\n                }\n                end = pos;\n            }\n            else {\n                scanError = 3 /* ScanError.UnexpectedEndOfNumber */;\n            }\n        }\n        return text.substring(start, end);\n    }\n    function scanString() {\n        let result = '', start = pos;\n        while (true) {\n            if (pos >= len) {\n                result += text.substring(start, pos);\n                scanError = 2 /* ScanError.UnexpectedEndOfString */;\n                break;\n            }\n            const ch = text.charCodeAt(pos);\n            if (ch === 34 /* CharacterCodes.doubleQuote */) {\n                result += text.substring(start, pos);\n                pos++;\n                break;\n            }\n            if (ch === 92 /* CharacterCodes.backslash */) {\n                result += text.substring(start, pos);\n                pos++;\n                if (pos >= len) {\n                    scanError = 2 /* ScanError.UnexpectedEndOfString */;\n                    break;\n                }\n                const ch2 = text.charCodeAt(pos++);\n                switch (ch2) {\n                    case 34 /* CharacterCodes.doubleQuote */:\n                        result += '\\\"';\n                        break;\n                    case 92 /* CharacterCodes.backslash */:\n                        result += '\\\\';\n                        break;\n                    case 47 /* CharacterCodes.slash */:\n                        result += '/';\n                        break;\n                    case 98 /* CharacterCodes.b */:\n                        result += '\\b';\n                        break;\n                    case 102 /* CharacterCodes.f */:\n                        result += '\\f';\n                        break;\n                    case 110 /* CharacterCodes.n */:\n                        result += '\\n';\n                        break;\n                    case 114 /* CharacterCodes.r */:\n                        result += '\\r';\n                        break;\n                    case 116 /* CharacterCodes.t */:\n                        result += '\\t';\n                        break;\n                    case 117 /* CharacterCodes.u */:\n                        const ch3 = scanHexDigits(4, true);\n                        if (ch3 >= 0) {\n                            result += String.fromCharCode(ch3);\n                        }\n                        else {\n                            scanError = 4 /* ScanError.InvalidUnicode */;\n                        }\n                        break;\n                    default:\n                        scanError = 5 /* ScanError.InvalidEscapeCharacter */;\n                }\n                start = pos;\n                continue;\n            }\n            if (ch >= 0 && ch <= 0x1f) {\n                if (isLineBreak(ch)) {\n                    result += text.substring(start, pos);\n                    scanError = 2 /* ScanError.UnexpectedEndOfString */;\n                    break;\n                }\n                else {\n                    scanError = 6 /* ScanError.InvalidCharacter */;\n                    // mark as error but continue with string\n                }\n            }\n            pos++;\n        }\n        return result;\n    }\n    function scanNext() {\n        value = '';\n        scanError = 0 /* ScanError.None */;\n        tokenOffset = pos;\n        lineStartOffset = lineNumber;\n        prevTokenLineStartOffset = tokenLineStartOffset;\n        if (pos >= len) {\n            // at the end\n            tokenOffset = len;\n            return token = 17 /* SyntaxKind.EOF */;\n        }\n        let code = text.charCodeAt(pos);\n        // trivia: whitespace\n        if (isWhiteSpace(code)) {\n            do {\n                pos++;\n                value += String.fromCharCode(code);\n                code = text.charCodeAt(pos);\n            } while (isWhiteSpace(code));\n            return token = 15 /* SyntaxKind.Trivia */;\n        }\n        // trivia: newlines\n        if (isLineBreak(code)) {\n            pos++;\n            value += String.fromCharCode(code);\n            if (code === 13 /* CharacterCodes.carriageReturn */ && text.charCodeAt(pos) === 10 /* CharacterCodes.lineFeed */) {\n                pos++;\n                value += '\\n';\n            }\n            lineNumber++;\n            tokenLineStartOffset = pos;\n            return token = 14 /* SyntaxKind.LineBreakTrivia */;\n        }\n        switch (code) {\n            // tokens: []{}:,\n            case 123 /* CharacterCodes.openBrace */:\n                pos++;\n                return token = 1 /* SyntaxKind.OpenBraceToken */;\n            case 125 /* CharacterCodes.closeBrace */:\n                pos++;\n                return token = 2 /* SyntaxKind.CloseBraceToken */;\n            case 91 /* CharacterCodes.openBracket */:\n                pos++;\n                return token = 3 /* SyntaxKind.OpenBracketToken */;\n            case 93 /* CharacterCodes.closeBracket */:\n                pos++;\n                return token = 4 /* SyntaxKind.CloseBracketToken */;\n            case 58 /* CharacterCodes.colon */:\n                pos++;\n                return token = 6 /* SyntaxKind.ColonToken */;\n            case 44 /* CharacterCodes.comma */:\n                pos++;\n                return token = 5 /* SyntaxKind.CommaToken */;\n            // strings\n            case 34 /* CharacterCodes.doubleQuote */:\n                pos++;\n                value = scanString();\n                return token = 10 /* SyntaxKind.StringLiteral */;\n            // comments\n            case 47 /* CharacterCodes.slash */:\n                const start = pos - 1;\n                // Single-line comment\n                if (text.charCodeAt(pos + 1) === 47 /* CharacterCodes.slash */) {\n                    pos += 2;\n                    while (pos < len) {\n                        if (isLineBreak(text.charCodeAt(pos))) {\n                            break;\n                        }\n                        pos++;\n                    }\n                    value = text.substring(start, pos);\n                    return token = 12 /* SyntaxKind.LineCommentTrivia */;\n                }\n                // Multi-line comment\n                if (text.charCodeAt(pos + 1) === 42 /* CharacterCodes.asterisk */) {\n                    pos += 2;\n                    const safeLength = len - 1; // For lookahead.\n                    let commentClosed = false;\n                    while (pos < safeLength) {\n                        const ch = text.charCodeAt(pos);\n                        if (ch === 42 /* CharacterCodes.asterisk */ && text.charCodeAt(pos + 1) === 47 /* CharacterCodes.slash */) {\n                            pos += 2;\n                            commentClosed = true;\n                            break;\n                        }\n                        pos++;\n                        if (isLineBreak(ch)) {\n                            if (ch === 13 /* CharacterCodes.carriageReturn */ && text.charCodeAt(pos) === 10 /* CharacterCodes.lineFeed */) {\n                                pos++;\n                            }\n                            lineNumber++;\n                            tokenLineStartOffset = pos;\n                        }\n                    }\n                    if (!commentClosed) {\n                        pos++;\n                        scanError = 1 /* ScanError.UnexpectedEndOfComment */;\n                    }\n                    value = text.substring(start, pos);\n                    return token = 13 /* SyntaxKind.BlockCommentTrivia */;\n                }\n                // just a single slash\n                value += String.fromCharCode(code);\n                pos++;\n                return token = 16 /* SyntaxKind.Unknown */;\n            // numbers\n            case 45 /* CharacterCodes.minus */:\n                value += String.fromCharCode(code);\n                pos++;\n                if (pos === len || !isDigit(text.charCodeAt(pos))) {\n                    return token = 16 /* SyntaxKind.Unknown */;\n                }\n            // found a minus, followed by a number so\n            // we fall through to proceed with scanning\n            // numbers\n            case 48 /* CharacterCodes._0 */:\n            case 49 /* CharacterCodes._1 */:\n            case 50 /* CharacterCodes._2 */:\n            case 51 /* CharacterCodes._3 */:\n            case 52 /* CharacterCodes._4 */:\n            case 53 /* CharacterCodes._5 */:\n            case 54 /* CharacterCodes._6 */:\n            case 55 /* CharacterCodes._7 */:\n            case 56 /* CharacterCodes._8 */:\n            case 57 /* CharacterCodes._9 */:\n                value += scanNumber();\n                return token = 11 /* SyntaxKind.NumericLiteral */;\n            // literals and unknown symbols\n            default:\n                // is a literal? Read the full word.\n                while (pos < len && isUnknownContentCharacter(code)) {\n                    pos++;\n                    code = text.charCodeAt(pos);\n                }\n                if (tokenOffset !== pos) {\n                    value = text.substring(tokenOffset, pos);\n                    // keywords: true, false, null\n                    switch (value) {\n                        case 'true': return token = 8 /* SyntaxKind.TrueKeyword */;\n                        case 'false': return token = 9 /* SyntaxKind.FalseKeyword */;\n                        case 'null': return token = 7 /* SyntaxKind.NullKeyword */;\n                    }\n                    return token = 16 /* SyntaxKind.Unknown */;\n                }\n                // some\n                value += String.fromCharCode(code);\n                pos++;\n                return token = 16 /* SyntaxKind.Unknown */;\n        }\n    }\n    function isUnknownContentCharacter(code) {\n        if (isWhiteSpace(code) || isLineBreak(code)) {\n            return false;\n        }\n        switch (code) {\n            case 125 /* CharacterCodes.closeBrace */:\n            case 93 /* CharacterCodes.closeBracket */:\n            case 123 /* CharacterCodes.openBrace */:\n            case 91 /* CharacterCodes.openBracket */:\n            case 34 /* CharacterCodes.doubleQuote */:\n            case 58 /* CharacterCodes.colon */:\n            case 44 /* CharacterCodes.comma */:\n            case 47 /* CharacterCodes.slash */:\n                return false;\n        }\n        return true;\n    }\n    function scanNextNonTrivia() {\n        let result;\n        do {\n            result = scanNext();\n        } while (result >= 12 /* SyntaxKind.LineCommentTrivia */ && result <= 15 /* SyntaxKind.Trivia */);\n        return result;\n    }\n    return {\n        setPosition: setPosition,\n        getPosition: () => pos,\n        scan: ignoreTrivia ? scanNextNonTrivia : scanNext,\n        getToken: () => token,\n        getTokenValue: () => value,\n        getTokenOffset: () => tokenOffset,\n        getTokenLength: () => pos - tokenOffset,\n        getTokenStartLine: () => lineStartOffset,\n        getTokenStartCharacter: () => tokenOffset - prevTokenLineStartOffset,\n        getTokenError: () => scanError,\n    };\n}\nfunction isWhiteSpace(ch) {\n    return ch === 32 /* CharacterCodes.space */ || ch === 9 /* CharacterCodes.tab */;\n}\nfunction isLineBreak(ch) {\n    return ch === 10 /* CharacterCodes.lineFeed */ || ch === 13 /* CharacterCodes.carriageReturn */;\n}\nfunction isDigit(ch) {\n    return ch >= 48 /* CharacterCodes._0 */ && ch <= 57 /* CharacterCodes._9 */;\n}\nvar CharacterCodes;\n(function (CharacterCodes) {\n    CharacterCodes[CharacterCodes[\"lineFeed\"] = 10] = \"lineFeed\";\n    CharacterCodes[CharacterCodes[\"carriageReturn\"] = 13] = \"carriageReturn\";\n    CharacterCodes[CharacterCodes[\"space\"] = 32] = \"space\";\n    CharacterCodes[CharacterCodes[\"_0\"] = 48] = \"_0\";\n    CharacterCodes[CharacterCodes[\"_1\"] = 49] = \"_1\";\n    CharacterCodes[CharacterCodes[\"_2\"] = 50] = \"_2\";\n    CharacterCodes[CharacterCodes[\"_3\"] = 51] = \"_3\";\n    CharacterCodes[CharacterCodes[\"_4\"] = 52] = \"_4\";\n    CharacterCodes[CharacterCodes[\"_5\"] = 53] = \"_5\";\n    CharacterCodes[CharacterCodes[\"_6\"] = 54] = \"_6\";\n    CharacterCodes[CharacterCodes[\"_7\"] = 55] = \"_7\";\n    CharacterCodes[CharacterCodes[\"_8\"] = 56] = \"_8\";\n    CharacterCodes[CharacterCodes[\"_9\"] = 57] = \"_9\";\n    CharacterCodes[CharacterCodes[\"a\"] = 97] = \"a\";\n    CharacterCodes[CharacterCodes[\"b\"] = 98] = \"b\";\n    CharacterCodes[CharacterCodes[\"c\"] = 99] = \"c\";\n    CharacterCodes[CharacterCodes[\"d\"] = 100] = \"d\";\n    CharacterCodes[CharacterCodes[\"e\"] = 101] = \"e\";\n    CharacterCodes[CharacterCodes[\"f\"] = 102] = \"f\";\n    CharacterCodes[CharacterCodes[\"g\"] = 103] = \"g\";\n    CharacterCodes[CharacterCodes[\"h\"] = 104] = \"h\";\n    CharacterCodes[CharacterCodes[\"i\"] = 105] = \"i\";\n    CharacterCodes[CharacterCodes[\"j\"] = 106] = \"j\";\n    CharacterCodes[CharacterCodes[\"k\"] = 107] = \"k\";\n    CharacterCodes[CharacterCodes[\"l\"] = 108] = \"l\";\n    CharacterCodes[CharacterCodes[\"m\"] = 109] = \"m\";\n    CharacterCodes[CharacterCodes[\"n\"] = 110] = \"n\";\n    CharacterCodes[CharacterCodes[\"o\"] = 111] = \"o\";\n    CharacterCodes[CharacterCodes[\"p\"] = 112] = \"p\";\n    CharacterCodes[CharacterCodes[\"q\"] = 113] = \"q\";\n    CharacterCodes[CharacterCodes[\"r\"] = 114] = \"r\";\n    CharacterCodes[CharacterCodes[\"s\"] = 115] = \"s\";\n    CharacterCodes[CharacterCodes[\"t\"] = 116] = \"t\";\n    CharacterCodes[CharacterCodes[\"u\"] = 117] = \"u\";\n    CharacterCodes[CharacterCodes[\"v\"] = 118] = \"v\";\n    CharacterCodes[CharacterCodes[\"w\"] = 119] = \"w\";\n    CharacterCodes[CharacterCodes[\"x\"] = 120] = \"x\";\n    CharacterCodes[CharacterCodes[\"y\"] = 121] = \"y\";\n    CharacterCodes[CharacterCodes[\"z\"] = 122] = \"z\";\n    CharacterCodes[CharacterCodes[\"A\"] = 65] = \"A\";\n    CharacterCodes[CharacterCodes[\"B\"] = 66] = \"B\";\n    CharacterCodes[CharacterCodes[\"C\"] = 67] = \"C\";\n    CharacterCodes[CharacterCodes[\"D\"] = 68] = \"D\";\n    CharacterCodes[CharacterCodes[\"E\"] = 69] = \"E\";\n    CharacterCodes[CharacterCodes[\"F\"] = 70] = \"F\";\n    CharacterCodes[CharacterCodes[\"G\"] = 71] = \"G\";\n    CharacterCodes[CharacterCodes[\"H\"] = 72] = \"H\";\n    CharacterCodes[CharacterCodes[\"I\"] = 73] = \"I\";\n    CharacterCodes[CharacterCodes[\"J\"] = 74] = \"J\";\n    CharacterCodes[CharacterCodes[\"K\"] = 75] = \"K\";\n    CharacterCodes[CharacterCodes[\"L\"] = 76] = \"L\";\n    CharacterCodes[CharacterCodes[\"M\"] = 77] = \"M\";\n    CharacterCodes[CharacterCodes[\"N\"] = 78] = \"N\";\n    CharacterCodes[CharacterCodes[\"O\"] = 79] = \"O\";\n    CharacterCodes[CharacterCodes[\"P\"] = 80] = \"P\";\n    CharacterCodes[CharacterCodes[\"Q\"] = 81] = \"Q\";\n    CharacterCodes[CharacterCodes[\"R\"] = 82] = \"R\";\n    CharacterCodes[CharacterCodes[\"S\"] = 83] = \"S\";\n    CharacterCodes[CharacterCodes[\"T\"] = 84] = \"T\";\n    CharacterCodes[CharacterCodes[\"U\"] = 85] = \"U\";\n    CharacterCodes[CharacterCodes[\"V\"] = 86] = \"V\";\n    CharacterCodes[CharacterCodes[\"W\"] = 87] = \"W\";\n    CharacterCodes[CharacterCodes[\"X\"] = 88] = \"X\";\n    CharacterCodes[CharacterCodes[\"Y\"] = 89] = \"Y\";\n    CharacterCodes[CharacterCodes[\"Z\"] = 90] = \"Z\";\n    CharacterCodes[CharacterCodes[\"asterisk\"] = 42] = \"asterisk\";\n    CharacterCodes[CharacterCodes[\"backslash\"] = 92] = \"backslash\";\n    CharacterCodes[CharacterCodes[\"closeBrace\"] = 125] = \"closeBrace\";\n    CharacterCodes[CharacterCodes[\"closeBracket\"] = 93] = \"closeBracket\";\n    CharacterCodes[CharacterCodes[\"colon\"] = 58] = \"colon\";\n    CharacterCodes[CharacterCodes[\"comma\"] = 44] = \"comma\";\n    CharacterCodes[CharacterCodes[\"dot\"] = 46] = \"dot\";\n    CharacterCodes[CharacterCodes[\"doubleQuote\"] = 34] = \"doubleQuote\";\n    CharacterCodes[CharacterCodes[\"minus\"] = 45] = \"minus\";\n    CharacterCodes[CharacterCodes[\"openBrace\"] = 123] = \"openBrace\";\n    CharacterCodes[CharacterCodes[\"openBracket\"] = 91] = \"openBracket\";\n    CharacterCodes[CharacterCodes[\"plus\"] = 43] = \"plus\";\n    CharacterCodes[CharacterCodes[\"slash\"] = 47] = \"slash\";\n    CharacterCodes[CharacterCodes[\"formFeed\"] = 12] = \"formFeed\";\n    CharacterCodes[CharacterCodes[\"tab\"] = 9] = \"tab\";\n})(CharacterCodes || (CharacterCodes = {}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\nimport { createScanner } from './scanner';\nvar ParseOptions;\n(function (ParseOptions) {\n    ParseOptions.DEFAULT = {\n        allowTrailingComma: false\n    };\n})(ParseOptions || (ParseOptions = {}));\n/**\n * For a given offset, evaluate the location in the JSON document. Each segment in the location path is either a property name or an array index.\n */\nexport function getLocation(text, position) {\n    const segments = []; // strings or numbers\n    const earlyReturnException = new Object();\n    let previousNode = undefined;\n    const previousNodeInst = {\n        value: {},\n        offset: 0,\n        length: 0,\n        type: 'object',\n        parent: undefined\n    };\n    let isAtPropertyKey = false;\n    function setPreviousNode(value, offset, length, type) {\n        previousNodeInst.value = value;\n        previousNodeInst.offset = offset;\n        previousNodeInst.length = length;\n        previousNodeInst.type = type;\n        previousNodeInst.colonOffset = undefined;\n        previousNode = previousNodeInst;\n    }\n    try {\n        visit(text, {\n            onObjectBegin: (offset, length) => {\n                if (position <= offset) {\n                    throw earlyReturnException;\n                }\n                previousNode = undefined;\n                isAtPropertyKey = position > offset;\n                segments.push(''); // push a placeholder (will be replaced)\n            },\n            onObjectProperty: (name, offset, length) => {\n                if (position < offset) {\n                    throw earlyReturnException;\n                }\n                setPreviousNode(name, offset, length, 'property');\n                segments[segments.length - 1] = name;\n                if (position <= offset + length) {\n                    throw earlyReturnException;\n                }\n            },\n            onObjectEnd: (offset, length) => {\n                if (position <= offset) {\n                    throw earlyReturnException;\n                }\n                previousNode = undefined;\n                segments.pop();\n            },\n            onArrayBegin: (offset, length) => {\n                if (position <= offset) {\n                    throw earlyReturnException;\n                }\n                previousNode = undefined;\n                segments.push(0);\n            },\n            onArrayEnd: (offset, length) => {\n                if (position <= offset) {\n                    throw earlyReturnException;\n                }\n                previousNode = undefined;\n                segments.pop();\n            },\n            onLiteralValue: (value, offset, length) => {\n                if (position < offset) {\n                    throw earlyReturnException;\n                }\n                setPreviousNode(value, offset, length, getNodeType(value));\n                if (position <= offset + length) {\n                    throw earlyReturnException;\n                }\n            },\n            onSeparator: (sep, offset, length) => {\n                if (position <= offset) {\n                    throw earlyReturnException;\n                }\n                if (sep === ':' && previousNode && previousNode.type === 'property') {\n                    previousNode.colonOffset = offset;\n                    isAtPropertyKey = false;\n                    previousNode = undefined;\n                }\n                else if (sep === ',') {\n                    const last = segments[segments.length - 1];\n                    if (typeof last === 'number') {\n                        segments[segments.length - 1] = last + 1;\n                    }\n                    else {\n                        isAtPropertyKey = true;\n                        segments[segments.length - 1] = '';\n                    }\n                    previousNode = undefined;\n                }\n            }\n        });\n    }\n    catch (e) {\n        if (e !== earlyReturnException) {\n            throw e;\n        }\n    }\n    return {\n        path: segments,\n        previousNode,\n        isAtPropertyKey,\n        matches: (pattern) => {\n            let k = 0;\n            for (let i = 0; k < pattern.length && i < segments.length; i++) {\n                if (pattern[k] === segments[i] || pattern[k] === '*') {\n                    k++;\n                }\n                else if (pattern[k] !== '**') {\n                    return false;\n                }\n            }\n            return k === pattern.length;\n        }\n    };\n}\n/**\n * Parses the given text and returns the object the JSON content represents. On invalid input, the parser tries to be as fault tolerant as possible, but still return a result.\n * Therefore always check the errors list to find out if the input was valid.\n */\nexport function parse(text, errors = [], options = ParseOptions.DEFAULT) {\n    let currentProperty = null;\n    let currentParent = [];\n    const previousParents = [];\n    function onValue(value) {\n        if (Array.isArray(currentParent)) {\n            currentParent.push(value);\n        }\n        else if (currentProperty !== null) {\n            currentParent[currentProperty] = value;\n        }\n    }\n    const visitor = {\n        onObjectBegin: () => {\n            const object = {};\n            onValue(object);\n            previousParents.push(currentParent);\n            currentParent = object;\n            currentProperty = null;\n        },\n        onObjectProperty: (name) => {\n            currentProperty = name;\n        },\n        onObjectEnd: () => {\n            currentParent = previousParents.pop();\n        },\n        onArrayBegin: () => {\n            const array = [];\n            onValue(array);\n            previousParents.push(currentParent);\n            currentParent = array;\n            currentProperty = null;\n        },\n        onArrayEnd: () => {\n            currentParent = previousParents.pop();\n        },\n        onLiteralValue: onValue,\n        onError: (error, offset, length) => {\n            errors.push({ error, offset, length });\n        }\n    };\n    visit(text, visitor, options);\n    return currentParent[0];\n}\n/**\n * Parses the given text and returns a tree representation the JSON content. On invalid input, the parser tries to be as fault tolerant as possible, but still return a result.\n */\nexport function parseTree(text, errors = [], options = ParseOptions.DEFAULT) {\n    let currentParent = { type: 'array', offset: -1, length: -1, children: [], parent: undefined }; // artificial root\n    function ensurePropertyComplete(endOffset) {\n        if (currentParent.type === 'property') {\n            currentParent.length = endOffset - currentParent.offset;\n            currentParent = currentParent.parent;\n        }\n    }\n    function onValue(valueNode) {\n        currentParent.children.push(valueNode);\n        return valueNode;\n    }\n    const visitor = {\n        onObjectBegin: (offset) => {\n            currentParent = onValue({ type: 'object', offset, length: -1, parent: currentParent, children: [] });\n        },\n        onObjectProperty: (name, offset, length) => {\n            currentParent = onValue({ type: 'property', offset, length: -1, parent: currentParent, children: [] });\n            currentParent.children.push({ type: 'string', value: name, offset, length, parent: currentParent });\n        },\n        onObjectEnd: (offset, length) => {\n            ensurePropertyComplete(offset + length); // in case of a missing value for a property: make sure property is complete\n            currentParent.length = offset + length - currentParent.offset;\n            currentParent = currentParent.parent;\n            ensurePropertyComplete(offset + length);\n        },\n        onArrayBegin: (offset, length) => {\n            currentParent = onValue({ type: 'array', offset, length: -1, parent: currentParent, children: [] });\n        },\n        onArrayEnd: (offset, length) => {\n            currentParent.length = offset + length - currentParent.offset;\n            currentParent = currentParent.parent;\n            ensurePropertyComplete(offset + length);\n        },\n        onLiteralValue: (value, offset, length) => {\n            onValue({ type: getNodeType(value), offset, length, parent: currentParent, value });\n            ensurePropertyComplete(offset + length);\n        },\n        onSeparator: (sep, offset, length) => {\n            if (currentParent.type === 'property') {\n                if (sep === ':') {\n                    currentParent.colonOffset = offset;\n                }\n                else if (sep === ',') {\n                    ensurePropertyComplete(offset);\n                }\n            }\n        },\n        onError: (error, offset, length) => {\n            errors.push({ error, offset, length });\n        }\n    };\n    visit(text, visitor, options);\n    const result = currentParent.children[0];\n    if (result) {\n        delete result.parent;\n    }\n    return result;\n}\n/**\n * Finds the node at the given path in a JSON DOM.\n */\nexport function findNodeAtLocation(root, path) {\n    if (!root) {\n        return undefined;\n    }\n    let node = root;\n    for (let segment of path) {\n        if (typeof segment === 'string') {\n            if (node.type !== 'object' || !Array.isArray(node.children)) {\n                return undefined;\n            }\n            let found = false;\n            for (const propertyNode of node.children) {\n                if (Array.isArray(propertyNode.children) && propertyNode.children[0].value === segment && propertyNode.children.length === 2) {\n                    node = propertyNode.children[1];\n                    found = true;\n                    break;\n                }\n            }\n            if (!found) {\n                return undefined;\n            }\n        }\n        else {\n            const index = segment;\n            if (node.type !== 'array' || index < 0 || !Array.isArray(node.children) || index >= node.children.length) {\n                return undefined;\n            }\n            node = node.children[index];\n        }\n    }\n    return node;\n}\n/**\n * Gets the JSON path of the given JSON DOM node\n */\nexport function getNodePath(node) {\n    if (!node.parent || !node.parent.children) {\n        return [];\n    }\n    const path = getNodePath(node.parent);\n    if (node.parent.type === 'property') {\n        const key = node.parent.children[0].value;\n        path.push(key);\n    }\n    else if (node.parent.type === 'array') {\n        const index = node.parent.children.indexOf(node);\n        if (index !== -1) {\n            path.push(index);\n        }\n    }\n    return path;\n}\n/**\n * Evaluates the JavaScript object of the given JSON DOM node\n */\nexport function getNodeValue(node) {\n    switch (node.type) {\n        case 'array':\n            return node.children.map(getNodeValue);\n        case 'object':\n            const obj = Object.create(null);\n            for (let prop of node.children) {\n                const valueNode = prop.children[1];\n                if (valueNode) {\n                    obj[prop.children[0].value] = getNodeValue(valueNode);\n                }\n            }\n            return obj;\n        case 'null':\n        case 'string':\n        case 'number':\n        case 'boolean':\n            return node.value;\n        default:\n            return undefined;\n    }\n}\nexport function contains(node, offset, includeRightBound = false) {\n    return (offset >= node.offset && offset < (node.offset + node.length)) || includeRightBound && (offset === (node.offset + node.length));\n}\n/**\n * Finds the most inner node at the given offset. If includeRightBound is set, also finds nodes that end at the given offset.\n */\nexport function findNodeAtOffset(node, offset, includeRightBound = false) {\n    if (contains(node, offset, includeRightBound)) {\n        const children = node.children;\n        if (Array.isArray(children)) {\n            for (let i = 0; i < children.length && children[i].offset <= offset; i++) {\n                const item = findNodeAtOffset(children[i], offset, includeRightBound);\n                if (item) {\n                    return item;\n                }\n            }\n        }\n        return node;\n    }\n    return undefined;\n}\n/**\n * Parses the given text and invokes the visitor functions for each object, array and literal reached.\n */\nexport function visit(text, visitor, options = ParseOptions.DEFAULT) {\n    const _scanner = createScanner(text, false);\n    // Important: Only pass copies of this to visitor functions to prevent accidental modification, and\n    // to not affect visitor functions which stored a reference to a previous JSONPath\n    const _jsonPath = [];\n    function toNoArgVisit(visitFunction) {\n        return visitFunction ? () => visitFunction(_scanner.getTokenOffset(), _scanner.getTokenLength(), _scanner.getTokenStartLine(), _scanner.getTokenStartCharacter()) : () => true;\n    }\n    function toNoArgVisitWithPath(visitFunction) {\n        return visitFunction ? () => visitFunction(_scanner.getTokenOffset(), _scanner.getTokenLength(), _scanner.getTokenStartLine(), _scanner.getTokenStartCharacter(), () => _jsonPath.slice()) : () => true;\n    }\n    function toOneArgVisit(visitFunction) {\n        return visitFunction ? (arg) => visitFunction(arg, _scanner.getTokenOffset(), _scanner.getTokenLength(), _scanner.getTokenStartLine(), _scanner.getTokenStartCharacter()) : () => true;\n    }\n    function toOneArgVisitWithPath(visitFunction) {\n        return visitFunction ? (arg) => visitFunction(arg, _scanner.getTokenOffset(), _scanner.getTokenLength(), _scanner.getTokenStartLine(), _scanner.getTokenStartCharacter(), () => _jsonPath.slice()) : () => true;\n    }\n    const onObjectBegin = toNoArgVisitWithPath(visitor.onObjectBegin), onObjectProperty = toOneArgVisitWithPath(visitor.onObjectProperty), onObjectEnd = toNoArgVisit(visitor.onObjectEnd), onArrayBegin = toNoArgVisitWithPath(visitor.onArrayBegin), onArrayEnd = toNoArgVisit(visitor.onArrayEnd), onLiteralValue = toOneArgVisitWithPath(visitor.onLiteralValue), onSeparator = toOneArgVisit(visitor.onSeparator), onComment = toNoArgVisit(visitor.onComment), onError = toOneArgVisit(visitor.onError);\n    const disallowComments = options && options.disallowComments;\n    const allowTrailingComma = options && options.allowTrailingComma;\n    function scanNext() {\n        while (true) {\n            const token = _scanner.scan();\n            switch (_scanner.getTokenError()) {\n                case 4 /* ScanError.InvalidUnicode */:\n                    handleError(14 /* ParseErrorCode.InvalidUnicode */);\n                    break;\n                case 5 /* ScanError.InvalidEscapeCharacter */:\n                    handleError(15 /* ParseErrorCode.InvalidEscapeCharacter */);\n                    break;\n                case 3 /* ScanError.UnexpectedEndOfNumber */:\n                    handleError(13 /* ParseErrorCode.UnexpectedEndOfNumber */);\n                    break;\n                case 1 /* ScanError.UnexpectedEndOfComment */:\n                    if (!disallowComments) {\n                        handleError(11 /* ParseErrorCode.UnexpectedEndOfComment */);\n                    }\n                    break;\n                case 2 /* ScanError.UnexpectedEndOfString */:\n                    handleError(12 /* ParseErrorCode.UnexpectedEndOfString */);\n                    break;\n                case 6 /* ScanError.InvalidCharacter */:\n                    handleError(16 /* ParseErrorCode.InvalidCharacter */);\n                    break;\n            }\n            switch (token) {\n                case 12 /* SyntaxKind.LineCommentTrivia */:\n                case 13 /* SyntaxKind.BlockCommentTrivia */:\n                    if (disallowComments) {\n                        handleError(10 /* ParseErrorCode.InvalidCommentToken */);\n                    }\n                    else {\n                        onComment();\n                    }\n                    break;\n                case 16 /* SyntaxKind.Unknown */:\n                    handleError(1 /* ParseErrorCode.InvalidSymbol */);\n                    break;\n                case 15 /* SyntaxKind.Trivia */:\n                case 14 /* SyntaxKind.LineBreakTrivia */:\n                    break;\n                default:\n                    return token;\n            }\n        }\n    }\n    function handleError(error, skipUntilAfter = [], skipUntil = []) {\n        onError(error);\n        if (skipUntilAfter.length + skipUntil.length > 0) {\n            let token = _scanner.getToken();\n            while (token !== 17 /* SyntaxKind.EOF */) {\n                if (skipUntilAfter.indexOf(token) !== -1) {\n                    scanNext();\n                    break;\n                }\n                else if (skipUntil.indexOf(token) !== -1) {\n                    break;\n                }\n                token = scanNext();\n            }\n        }\n    }\n    function parseString(isValue) {\n        const value = _scanner.getTokenValue();\n        if (isValue) {\n            onLiteralValue(value);\n        }\n        else {\n            onObjectProperty(value);\n            // add property name afterwards\n            _jsonPath.push(value);\n        }\n        scanNext();\n        return true;\n    }\n    function parseLiteral() {\n        switch (_scanner.getToken()) {\n            case 11 /* SyntaxKind.NumericLiteral */:\n                const tokenValue = _scanner.getTokenValue();\n                let value = Number(tokenValue);\n                if (isNaN(value)) {\n                    handleError(2 /* ParseErrorCode.InvalidNumberFormat */);\n                    value = 0;\n                }\n                onLiteralValue(value);\n                break;\n            case 7 /* SyntaxKind.NullKeyword */:\n                onLiteralValue(null);\n                break;\n            case 8 /* SyntaxKind.TrueKeyword */:\n                onLiteralValue(true);\n                break;\n            case 9 /* SyntaxKind.FalseKeyword */:\n                onLiteralValue(false);\n                break;\n            default:\n                return false;\n        }\n        scanNext();\n        return true;\n    }\n    function parseProperty() {\n        if (_scanner.getToken() !== 10 /* SyntaxKind.StringLiteral */) {\n            handleError(3 /* ParseErrorCode.PropertyNameExpected */, [], [2 /* SyntaxKind.CloseBraceToken */, 5 /* SyntaxKind.CommaToken */]);\n            return false;\n        }\n        parseString(false);\n        if (_scanner.getToken() === 6 /* SyntaxKind.ColonToken */) {\n            onSeparator(':');\n            scanNext(); // consume colon\n            if (!parseValue()) {\n                handleError(4 /* ParseErrorCode.ValueExpected */, [], [2 /* SyntaxKind.CloseBraceToken */, 5 /* SyntaxKind.CommaToken */]);\n            }\n        }\n        else {\n            handleError(5 /* ParseErrorCode.ColonExpected */, [], [2 /* SyntaxKind.CloseBraceToken */, 5 /* SyntaxKind.CommaToken */]);\n        }\n        _jsonPath.pop(); // remove processed property name\n        return true;\n    }\n    function parseObject() {\n        onObjectBegin();\n        scanNext(); // consume open brace\n        let needsComma = false;\n        while (_scanner.getToken() !== 2 /* SyntaxKind.CloseBraceToken */ && _scanner.getToken() !== 17 /* SyntaxKind.EOF */) {\n            if (_scanner.getToken() === 5 /* SyntaxKind.CommaToken */) {\n                if (!needsComma) {\n                    handleError(4 /* ParseErrorCode.ValueExpected */, [], []);\n                }\n                onSeparator(',');\n                scanNext(); // consume comma\n                if (_scanner.getToken() === 2 /* SyntaxKind.CloseBraceToken */ && allowTrailingComma) {\n                    break;\n                }\n            }\n            else if (needsComma) {\n                handleError(6 /* ParseErrorCode.CommaExpected */, [], []);\n            }\n            if (!parseProperty()) {\n                handleError(4 /* ParseErrorCode.ValueExpected */, [], [2 /* SyntaxKind.CloseBraceToken */, 5 /* SyntaxKind.CommaToken */]);\n            }\n            needsComma = true;\n        }\n        onObjectEnd();\n        if (_scanner.getToken() !== 2 /* SyntaxKind.CloseBraceToken */) {\n            handleError(7 /* ParseErrorCode.CloseBraceExpected */, [2 /* SyntaxKind.CloseBraceToken */], []);\n        }\n        else {\n            scanNext(); // consume close brace\n        }\n        return true;\n    }\n    function parseArray() {\n        onArrayBegin();\n        scanNext(); // consume open bracket\n        let isFirstElement = true;\n        let needsComma = false;\n        while (_scanner.getToken() !== 4 /* SyntaxKind.CloseBracketToken */ && _scanner.getToken() !== 17 /* SyntaxKind.EOF */) {\n            if (_scanner.getToken() === 5 /* SyntaxKind.CommaToken */) {\n                if (!needsComma) {\n                    handleError(4 /* ParseErrorCode.ValueExpected */, [], []);\n                }\n                onSeparator(',');\n                scanNext(); // consume comma\n                if (_scanner.getToken() === 4 /* SyntaxKind.CloseBracketToken */ && allowTrailingComma) {\n                    break;\n                }\n            }\n            else if (needsComma) {\n                handleError(6 /* ParseErrorCode.CommaExpected */, [], []);\n            }\n            if (isFirstElement) {\n                _jsonPath.push(0);\n                isFirstElement = false;\n            }\n            else {\n                _jsonPath[_jsonPath.length - 1]++;\n            }\n            if (!parseValue()) {\n                handleError(4 /* ParseErrorCode.ValueExpected */, [], [4 /* SyntaxKind.CloseBracketToken */, 5 /* SyntaxKind.CommaToken */]);\n            }\n            needsComma = true;\n        }\n        onArrayEnd();\n        if (!isFirstElement) {\n            _jsonPath.pop(); // remove array index\n        }\n        if (_scanner.getToken() !== 4 /* SyntaxKind.CloseBracketToken */) {\n            handleError(8 /* ParseErrorCode.CloseBracketExpected */, [4 /* SyntaxKind.CloseBracketToken */], []);\n        }\n        else {\n            scanNext(); // consume close bracket\n        }\n        return true;\n    }\n    function parseValue() {\n        switch (_scanner.getToken()) {\n            case 3 /* SyntaxKind.OpenBracketToken */:\n                return parseArray();\n            case 1 /* SyntaxKind.OpenBraceToken */:\n                return parseObject();\n            case 10 /* SyntaxKind.StringLiteral */:\n                return parseString(true);\n            default:\n                return parseLiteral();\n        }\n    }\n    scanNext();\n    if (_scanner.getToken() === 17 /* SyntaxKind.EOF */) {\n        if (options.allowEmptyContent) {\n            return true;\n        }\n        handleError(4 /* ParseErrorCode.ValueExpected */, [], []);\n        return false;\n    }\n    if (!parseValue()) {\n        handleError(4 /* ParseErrorCode.ValueExpected */, [], []);\n        return false;\n    }\n    if (_scanner.getToken() !== 17 /* SyntaxKind.EOF */) {\n        handleError(9 /* ParseErrorCode.EndOfFileExpected */, [], []);\n    }\n    return true;\n}\n/**\n * Takes JSON with JavaScript-style comments and remove\n * them. Optionally replaces every none-newline character\n * of comments with a replaceCharacter\n */\nexport function stripComments(text, replaceCh) {\n    let _scanner = createScanner(text), parts = [], kind, offset = 0, pos;\n    do {\n        pos = _scanner.getPosition();\n        kind = _scanner.scan();\n        switch (kind) {\n            case 12 /* SyntaxKind.LineCommentTrivia */:\n            case 13 /* SyntaxKind.BlockCommentTrivia */:\n            case 17 /* SyntaxKind.EOF */:\n                if (offset !== pos) {\n                    parts.push(text.substring(offset, pos));\n                }\n                if (replaceCh !== undefined) {\n                    parts.push(_scanner.getTokenValue().replace(/[^\\r\\n]/g, replaceCh));\n                }\n                offset = _scanner.getPosition();\n                break;\n        }\n    } while (kind !== 17 /* SyntaxKind.EOF */);\n    return parts.join('');\n}\nexport function getNodeType(value) {\n    switch (typeof value) {\n        case 'boolean': return 'boolean';\n        case 'number': return 'number';\n        case 'string': return 'string';\n        case 'object': {\n            if (!value) {\n                return 'null';\n            }\n            else if (Array.isArray(value)) {\n                return 'array';\n            }\n            return 'object';\n        }\n        default: return 'null';\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\nimport { createScanner } from './scanner';\nexport function format(documentText, range, options) {\n    let initialIndentLevel;\n    let formatText;\n    let formatTextStart;\n    let rangeStart;\n    let rangeEnd;\n    if (range) {\n        rangeStart = range.offset;\n        rangeEnd = rangeStart + range.length;\n        formatTextStart = rangeStart;\n        while (formatTextStart > 0 && !isEOL(documentText, formatTextStart - 1)) {\n            formatTextStart--;\n        }\n        let endOffset = rangeEnd;\n        while (endOffset < documentText.length && !isEOL(documentText, endOffset)) {\n            endOffset++;\n        }\n        formatText = documentText.substring(formatTextStart, endOffset);\n        initialIndentLevel = computeIndentLevel(formatText, options);\n    }\n    else {\n        formatText = documentText;\n        initialIndentLevel = 0;\n        formatTextStart = 0;\n        rangeStart = 0;\n        rangeEnd = documentText.length;\n    }\n    const eol = getEOL(options, documentText);\n    let numberLineBreaks = 0;\n    let indentLevel = 0;\n    let indentValue;\n    if (options.insertSpaces) {\n        indentValue = repeat(' ', options.tabSize || 4);\n    }\n    else {\n        indentValue = '\\t';\n    }\n    let scanner = createScanner(formatText, false);\n    let hasError = false;\n    function newLinesAndIndent() {\n        if (numberLineBreaks > 1) {\n            return repeat(eol, numberLineBreaks) + repeat(indentValue, initialIndentLevel + indentLevel);\n        }\n        else {\n            return eol + repeat(indentValue, initialIndentLevel + indentLevel);\n        }\n    }\n    function scanNext() {\n        let token = scanner.scan();\n        numberLineBreaks = 0;\n        while (token === 15 /* SyntaxKind.Trivia */ || token === 14 /* SyntaxKind.LineBreakTrivia */) {\n            if (token === 14 /* SyntaxKind.LineBreakTrivia */ && options.keepLines) {\n                numberLineBreaks += 1;\n            }\n            else if (token === 14 /* SyntaxKind.LineBreakTrivia */) {\n                numberLineBreaks = 1;\n            }\n            token = scanner.scan();\n        }\n        hasError = token === 16 /* SyntaxKind.Unknown */ || scanner.getTokenError() !== 0 /* ScanError.None */;\n        return token;\n    }\n    const editOperations = [];\n    function addEdit(text, startOffset, endOffset) {\n        if (!hasError && (!range || (startOffset < rangeEnd && endOffset > rangeStart)) && documentText.substring(startOffset, endOffset) !== text) {\n            editOperations.push({ offset: startOffset, length: endOffset - startOffset, content: text });\n        }\n    }\n    let firstToken = scanNext();\n    if (options.keepLines && numberLineBreaks > 0) {\n        addEdit(repeat(eol, numberLineBreaks), 0, 0);\n    }\n    if (firstToken !== 17 /* SyntaxKind.EOF */) {\n        let firstTokenStart = scanner.getTokenOffset() + formatTextStart;\n        let initialIndent = repeat(indentValue, initialIndentLevel);\n        addEdit(initialIndent, formatTextStart, firstTokenStart);\n    }\n    while (firstToken !== 17 /* SyntaxKind.EOF */) {\n        let firstTokenEnd = scanner.getTokenOffset() + scanner.getTokenLength() + formatTextStart;\n        let secondToken = scanNext();\n        let replaceContent = '';\n        let needsLineBreak = false;\n        while (numberLineBreaks === 0 && (secondToken === 12 /* SyntaxKind.LineCommentTrivia */ || secondToken === 13 /* SyntaxKind.BlockCommentTrivia */)) {\n            let commentTokenStart = scanner.getTokenOffset() + formatTextStart;\n            addEdit(' ', firstTokenEnd, commentTokenStart);\n            firstTokenEnd = scanner.getTokenOffset() + scanner.getTokenLength() + formatTextStart;\n            needsLineBreak = secondToken === 12 /* SyntaxKind.LineCommentTrivia */;\n            replaceContent = needsLineBreak ? newLinesAndIndent() : '';\n            secondToken = scanNext();\n        }\n        if (secondToken === 2 /* SyntaxKind.CloseBraceToken */) {\n            if (firstToken !== 1 /* SyntaxKind.OpenBraceToken */) {\n                indentLevel--;\n            }\n            ;\n            if (options.keepLines && numberLineBreaks > 0 || !options.keepLines && firstToken !== 1 /* SyntaxKind.OpenBraceToken */) {\n                replaceContent = newLinesAndIndent();\n            }\n            else if (options.keepLines) {\n                replaceContent = ' ';\n            }\n        }\n        else if (secondToken === 4 /* SyntaxKind.CloseBracketToken */) {\n            if (firstToken !== 3 /* SyntaxKind.OpenBracketToken */) {\n                indentLevel--;\n            }\n            ;\n            if (options.keepLines && numberLineBreaks > 0 || !options.keepLines && firstToken !== 3 /* SyntaxKind.OpenBracketToken */) {\n                replaceContent = newLinesAndIndent();\n            }\n            else if (options.keepLines) {\n                replaceContent = ' ';\n            }\n        }\n        else {\n            switch (firstToken) {\n                case 3 /* SyntaxKind.OpenBracketToken */:\n                case 1 /* SyntaxKind.OpenBraceToken */:\n                    indentLevel++;\n                    if (options.keepLines && numberLineBreaks > 0 || !options.keepLines) {\n                        replaceContent = newLinesAndIndent();\n                    }\n                    else {\n                        replaceContent = ' ';\n                    }\n                    break;\n                case 5 /* SyntaxKind.CommaToken */:\n                    if (options.keepLines && numberLineBreaks > 0 || !options.keepLines) {\n                        replaceContent = newLinesAndIndent();\n                    }\n                    else {\n                        replaceContent = ' ';\n                    }\n                    break;\n                case 12 /* SyntaxKind.LineCommentTrivia */:\n                    replaceContent = newLinesAndIndent();\n                    break;\n                case 13 /* SyntaxKind.BlockCommentTrivia */:\n                    if (numberLineBreaks > 0) {\n                        replaceContent = newLinesAndIndent();\n                    }\n                    else if (!needsLineBreak) {\n                        replaceContent = ' ';\n                    }\n                    break;\n                case 6 /* SyntaxKind.ColonToken */:\n                    if (options.keepLines && numberLineBreaks > 0) {\n                        replaceContent = newLinesAndIndent();\n                    }\n                    else if (!needsLineBreak) {\n                        replaceContent = ' ';\n                    }\n                    break;\n                case 10 /* SyntaxKind.StringLiteral */:\n                    if (options.keepLines && numberLineBreaks > 0) {\n                        replaceContent = newLinesAndIndent();\n                    }\n                    else if (secondToken === 6 /* SyntaxKind.ColonToken */ && !needsLineBreak) {\n                        replaceContent = '';\n                    }\n                    break;\n                case 7 /* SyntaxKind.NullKeyword */:\n                case 8 /* SyntaxKind.TrueKeyword */:\n                case 9 /* SyntaxKind.FalseKeyword */:\n                case 11 /* SyntaxKind.NumericLiteral */:\n                case 2 /* SyntaxKind.CloseBraceToken */:\n                case 4 /* SyntaxKind.CloseBracketToken */:\n                    if (options.keepLines && numberLineBreaks > 0) {\n                        replaceContent = newLinesAndIndent();\n                    }\n                    else {\n                        if ((secondToken === 12 /* SyntaxKind.LineCommentTrivia */ || secondToken === 13 /* SyntaxKind.BlockCommentTrivia */) && !needsLineBreak) {\n                            replaceContent = ' ';\n                        }\n                        else if (secondToken !== 5 /* SyntaxKind.CommaToken */ && secondToken !== 17 /* SyntaxKind.EOF */) {\n                            hasError = true;\n                        }\n                    }\n                    break;\n                case 16 /* SyntaxKind.Unknown */:\n                    hasError = true;\n                    break;\n            }\n            if (numberLineBreaks > 0 && (secondToken === 12 /* SyntaxKind.LineCommentTrivia */ || secondToken === 13 /* SyntaxKind.BlockCommentTrivia */)) {\n                replaceContent = newLinesAndIndent();\n            }\n        }\n        if (secondToken === 17 /* SyntaxKind.EOF */) {\n            if (options.keepLines && numberLineBreaks > 0) {\n                replaceContent = newLinesAndIndent();\n            }\n            else {\n                replaceContent = options.insertFinalNewline ? eol : '';\n            }\n        }\n        const secondTokenStart = scanner.getTokenOffset() + formatTextStart;\n        addEdit(replaceContent, firstTokenEnd, secondTokenStart);\n        firstToken = secondToken;\n    }\n    return editOperations;\n}\nfunction repeat(s, count) {\n    let result = '';\n    for (let i = 0; i < count; i++) {\n        result += s;\n    }\n    return result;\n}\nfunction computeIndentLevel(content, options) {\n    let i = 0;\n    let nChars = 0;\n    const tabSize = options.tabSize || 4;\n    while (i < content.length) {\n        let ch = content.charAt(i);\n        if (ch === ' ') {\n            nChars++;\n        }\n        else if (ch === '\\t') {\n            nChars += tabSize;\n        }\n        else {\n            break;\n        }\n        i++;\n    }\n    return Math.floor(nChars / tabSize);\n}\nfunction getEOL(options, text) {\n    for (let i = 0; i < text.length; i++) {\n        const ch = text.charAt(i);\n        if (ch === '\\r') {\n            if (i + 1 < text.length && text.charAt(i + 1) === '\\n') {\n                return '\\r\\n';\n            }\n            return '\\r';\n        }\n        else if (ch === '\\n') {\n            return '\\n';\n        }\n    }\n    return (options && options.eol) || '\\n';\n}\nexport function isEOL(text, offset) {\n    return '\\r\\n'.indexOf(text.charAt(offset)) !== -1;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\nimport { format, isEOL } from './format';\nimport { parseTree, findNodeAtLocation } from './parser';\nexport function removeProperty(text, path, options) {\n    return setProperty(text, path, void 0, options);\n}\nexport function setProperty(text, originalPath, value, options) {\n    const path = originalPath.slice();\n    const errors = [];\n    const root = parseTree(text, errors);\n    let parent = void 0;\n    let lastSegment = void 0;\n    while (path.length > 0) {\n        lastSegment = path.pop();\n        parent = findNodeAtLocation(root, path);\n        if (parent === void 0 && value !== void 0) {\n            if (typeof lastSegment === 'string') {\n                value = { [lastSegment]: value };\n            }\n            else {\n                value = [value];\n            }\n        }\n        else {\n            break;\n        }\n    }\n    if (!parent) {\n        // empty document\n        if (value === void 0) { // delete\n            throw new Error('Can not delete in empty document');\n        }\n        return withFormatting(text, { offset: root ? root.offset : 0, length: root ? root.length : 0, content: JSON.stringify(value) }, options);\n    }\n    else if (parent.type === 'object' && typeof lastSegment === 'string' && Array.isArray(parent.children)) {\n        const existing = findNodeAtLocation(parent, [lastSegment]);\n        if (existing !== void 0) {\n            if (value === void 0) { // delete\n                if (!existing.parent) {\n                    throw new Error('Malformed AST');\n                }\n                const propertyIndex = parent.children.indexOf(existing.parent);\n                let removeBegin;\n                let removeEnd = existing.parent.offset + existing.parent.length;\n                if (propertyIndex > 0) {\n                    // remove the comma of the previous node\n                    let previous = parent.children[propertyIndex - 1];\n                    removeBegin = previous.offset + previous.length;\n                }\n                else {\n                    removeBegin = parent.offset + 1;\n                    if (parent.children.length > 1) {\n                        // remove the comma of the next node\n                        let next = parent.children[1];\n                        removeEnd = next.offset;\n                    }\n                }\n                return withFormatting(text, { offset: removeBegin, length: removeEnd - removeBegin, content: '' }, options);\n            }\n            else {\n                // set value of existing property\n                return withFormatting(text, { offset: existing.offset, length: existing.length, content: JSON.stringify(value) }, options);\n            }\n        }\n        else {\n            if (value === void 0) { // delete\n                return []; // property does not exist, nothing to do\n            }\n            const newProperty = `${JSON.stringify(lastSegment)}: ${JSON.stringify(value)}`;\n            const index = options.getInsertionIndex ? options.getInsertionIndex(parent.children.map(p => p.children[0].value)) : parent.children.length;\n            let edit;\n            if (index > 0) {\n                let previous = parent.children[index - 1];\n                edit = { offset: previous.offset + previous.length, length: 0, content: ',' + newProperty };\n            }\n            else if (parent.children.length === 0) {\n                edit = { offset: parent.offset + 1, length: 0, content: newProperty };\n            }\n            else {\n                edit = { offset: parent.offset + 1, length: 0, content: newProperty + ',' };\n            }\n            return withFormatting(text, edit, options);\n        }\n    }\n    else if (parent.type === 'array' && typeof lastSegment === 'number' && Array.isArray(parent.children)) {\n        const insertIndex = lastSegment;\n        if (insertIndex === -1) {\n            // Insert\n            const newProperty = `${JSON.stringify(value)}`;\n            let edit;\n            if (parent.children.length === 0) {\n                edit = { offset: parent.offset + 1, length: 0, content: newProperty };\n            }\n            else {\n                const previous = parent.children[parent.children.length - 1];\n                edit = { offset: previous.offset + previous.length, length: 0, content: ',' + newProperty };\n            }\n            return withFormatting(text, edit, options);\n        }\n        else if (value === void 0 && parent.children.length >= 0) {\n            // Removal\n            const removalIndex = lastSegment;\n            const toRemove = parent.children[removalIndex];\n            let edit;\n            if (parent.children.length === 1) {\n                // only item\n                edit = { offset: parent.offset + 1, length: parent.length - 2, content: '' };\n            }\n            else if (parent.children.length - 1 === removalIndex) {\n                // last item\n                let previous = parent.children[removalIndex - 1];\n                let offset = previous.offset + previous.length;\n                let parentEndOffset = parent.offset + parent.length;\n                edit = { offset, length: parentEndOffset - 2 - offset, content: '' };\n            }\n            else {\n                edit = { offset: toRemove.offset, length: parent.children[removalIndex + 1].offset - toRemove.offset, content: '' };\n            }\n            return withFormatting(text, edit, options);\n        }\n        else if (value !== void 0) {\n            let edit;\n            const newProperty = `${JSON.stringify(value)}`;\n            if (!options.isArrayInsertion && parent.children.length > lastSegment) {\n                const toModify = parent.children[lastSegment];\n                edit = { offset: toModify.offset, length: toModify.length, content: newProperty };\n            }\n            else if (parent.children.length === 0 || lastSegment === 0) {\n                edit = { offset: parent.offset + 1, length: 0, content: parent.children.length === 0 ? newProperty : newProperty + ',' };\n            }\n            else {\n                const index = lastSegment > parent.children.length ? parent.children.length : lastSegment;\n                const previous = parent.children[index - 1];\n                edit = { offset: previous.offset + previous.length, length: 0, content: ',' + newProperty };\n            }\n            return withFormatting(text, edit, options);\n        }\n        else {\n            throw new Error(`Can not ${value === void 0 ? 'remove' : (options.isArrayInsertion ? 'insert' : 'modify')} Array index ${insertIndex} as length is not sufficient`);\n        }\n    }\n    else {\n        throw new Error(`Can not add ${typeof lastSegment !== 'number' ? 'index' : 'property'} to parent of type ${parent.type}`);\n    }\n}\nfunction withFormatting(text, edit, options) {\n    if (!options.formattingOptions) {\n        return [edit];\n    }\n    // apply the edit\n    let newText = applyEdit(text, edit);\n    // format the new text\n    let begin = edit.offset;\n    let end = edit.offset + edit.content.length;\n    if (edit.length === 0 || edit.content.length === 0) { // insert or remove\n        while (begin > 0 && !isEOL(newText, begin - 1)) {\n            begin--;\n        }\n        while (end < newText.length && !isEOL(newText, end)) {\n            end++;\n        }\n    }\n    const edits = format(newText, { offset: begin, length: end - begin }, { ...options.formattingOptions, keepLines: false });\n    // apply the formatting edits and track the begin and end offsets of the changes\n    for (let i = edits.length - 1; i >= 0; i--) {\n        const edit = edits[i];\n        newText = applyEdit(newText, edit);\n        begin = Math.min(begin, edit.offset);\n        end = Math.max(end, edit.offset + edit.length);\n        end += edit.content.length - edit.length;\n    }\n    // create a single edit with all changes\n    const editLength = text.length - (newText.length - end) - begin;\n    return [{ offset: begin, length: editLength, content: newText.substring(begin, end) }];\n}\nexport function applyEdit(text, edit) {\n    return text.substring(0, edit.offset) + edit.content + text.substring(edit.offset + edit.length);\n}\nexport function isWS(text, offset) {\n    return '\\r\\n \\t'.indexOf(text.charAt(offset)) !== -1;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\nimport * as formatter from './impl/format';\nimport * as edit from './impl/edit';\nimport * as scanner from './impl/scanner';\nimport * as parser from './impl/parser';\n/**\n * Creates a JSON scanner on the given text.\n * If ignoreTrivia is set, whitespaces or comments are ignored.\n */\nexport const createScanner = scanner.createScanner;\nexport var ScanError;\n(function (ScanError) {\n    ScanError[ScanError[\"None\"] = 0] = \"None\";\n    ScanError[ScanError[\"UnexpectedEndOfComment\"] = 1] = \"UnexpectedEndOfComment\";\n    ScanError[ScanError[\"UnexpectedEndOfString\"] = 2] = \"UnexpectedEndOfString\";\n    ScanError[ScanError[\"UnexpectedEndOfNumber\"] = 3] = \"UnexpectedEndOfNumber\";\n    ScanError[ScanError[\"InvalidUnicode\"] = 4] = \"InvalidUnicode\";\n    ScanError[ScanError[\"InvalidEscapeCharacter\"] = 5] = \"InvalidEscapeCharacter\";\n    ScanError[ScanError[\"InvalidCharacter\"] = 6] = \"InvalidCharacter\";\n})(ScanError || (ScanError = {}));\nexport var SyntaxKind;\n(function (SyntaxKind) {\n    SyntaxKind[SyntaxKind[\"OpenBraceToken\"] = 1] = \"OpenBraceToken\";\n    SyntaxKind[SyntaxKind[\"CloseBraceToken\"] = 2] = \"CloseBraceToken\";\n    SyntaxKind[SyntaxKind[\"OpenBracketToken\"] = 3] = \"OpenBracketToken\";\n    SyntaxKind[SyntaxKind[\"CloseBracketToken\"] = 4] = \"CloseBracketToken\";\n    SyntaxKind[SyntaxKind[\"CommaToken\"] = 5] = \"CommaToken\";\n    SyntaxKind[SyntaxKind[\"ColonToken\"] = 6] = \"ColonToken\";\n    SyntaxKind[SyntaxKind[\"NullKeyword\"] = 7] = \"NullKeyword\";\n    SyntaxKind[SyntaxKind[\"TrueKeyword\"] = 8] = \"TrueKeyword\";\n    SyntaxKind[SyntaxKind[\"FalseKeyword\"] = 9] = \"FalseKeyword\";\n    SyntaxKind[SyntaxKind[\"StringLiteral\"] = 10] = \"StringLiteral\";\n    SyntaxKind[SyntaxKind[\"NumericLiteral\"] = 11] = \"NumericLiteral\";\n    SyntaxKind[SyntaxKind[\"LineCommentTrivia\"] = 12] = \"LineCommentTrivia\";\n    SyntaxKind[SyntaxKind[\"BlockCommentTrivia\"] = 13] = \"BlockCommentTrivia\";\n    SyntaxKind[SyntaxKind[\"LineBreakTrivia\"] = 14] = \"LineBreakTrivia\";\n    SyntaxKind[SyntaxKind[\"Trivia\"] = 15] = \"Trivia\";\n    SyntaxKind[SyntaxKind[\"Unknown\"] = 16] = \"Unknown\";\n    SyntaxKind[SyntaxKind[\"EOF\"] = 17] = \"EOF\";\n})(SyntaxKind || (SyntaxKind = {}));\n/**\n * For a given offset, evaluate the location in the JSON document. Each segment in the location path is either a property name or an array index.\n */\nexport const getLocation = parser.getLocation;\n/**\n * Parses the given text and returns the object the JSON content represents. On invalid input, the parser tries to be as fault tolerant as possible, but still return a result.\n * Therefore, always check the errors list to find out if the input was valid.\n */\nexport const parse = parser.parse;\n/**\n * Parses the given text and returns a tree representation the JSON content. On invalid input, the parser tries to be as fault tolerant as possible, but still return a result.\n */\nexport const parseTree = parser.parseTree;\n/**\n * Finds the node at the given path in a JSON DOM.\n */\nexport const findNodeAtLocation = parser.findNodeAtLocation;\n/**\n * Finds the innermost node at the given offset. If includeRightBound is set, also finds nodes that end at the given offset.\n */\nexport const findNodeAtOffset = parser.findNodeAtOffset;\n/**\n * Gets the JSON path of the given JSON DOM node\n */\nexport const getNodePath = parser.getNodePath;\n/**\n * Evaluates the JavaScript object of the given JSON DOM node\n */\nexport const getNodeValue = parser.getNodeValue;\n/**\n * Parses the given text and invokes the visitor functions for each object, array and literal reached.\n */\nexport const visit = parser.visit;\n/**\n * Takes JSON with JavaScript-style comments and remove\n * them. Optionally replaces every none-newline character\n * of comments with a replaceCharacter\n */\nexport const stripComments = parser.stripComments;\nexport var ParseErrorCode;\n(function (ParseErrorCode) {\n    ParseErrorCode[ParseErrorCode[\"InvalidSymbol\"] = 1] = \"InvalidSymbol\";\n    ParseErrorCode[ParseErrorCode[\"InvalidNumberFormat\"] = 2] = \"InvalidNumberFormat\";\n    ParseErrorCode[ParseErrorCode[\"PropertyNameExpected\"] = 3] = \"PropertyNameExpected\";\n    ParseErrorCode[ParseErrorCode[\"ValueExpected\"] = 4] = \"ValueExpected\";\n    ParseErrorCode[ParseErrorCode[\"ColonExpected\"] = 5] = \"ColonExpected\";\n    ParseErrorCode[ParseErrorCode[\"CommaExpected\"] = 6] = \"CommaExpected\";\n    ParseErrorCode[ParseErrorCode[\"CloseBraceExpected\"] = 7] = \"CloseBraceExpected\";\n    ParseErrorCode[ParseErrorCode[\"CloseBracketExpected\"] = 8] = \"CloseBracketExpected\";\n    ParseErrorCode[ParseErrorCode[\"EndOfFileExpected\"] = 9] = \"EndOfFileExpected\";\n    ParseErrorCode[ParseErrorCode[\"InvalidCommentToken\"] = 10] = \"InvalidCommentToken\";\n    ParseErrorCode[ParseErrorCode[\"UnexpectedEndOfComment\"] = 11] = \"UnexpectedEndOfComment\";\n    ParseErrorCode[ParseErrorCode[\"UnexpectedEndOfString\"] = 12] = \"UnexpectedEndOfString\";\n    ParseErrorCode[ParseErrorCode[\"UnexpectedEndOfNumber\"] = 13] = \"UnexpectedEndOfNumber\";\n    ParseErrorCode[ParseErrorCode[\"InvalidUnicode\"] = 14] = \"InvalidUnicode\";\n    ParseErrorCode[ParseErrorCode[\"InvalidEscapeCharacter\"] = 15] = \"InvalidEscapeCharacter\";\n    ParseErrorCode[ParseErrorCode[\"InvalidCharacter\"] = 16] = \"InvalidCharacter\";\n})(ParseErrorCode || (ParseErrorCode = {}));\nexport function printParseErrorCode(code) {\n    switch (code) {\n        case 1 /* ParseErrorCode.InvalidSymbol */: return 'InvalidSymbol';\n        case 2 /* ParseErrorCode.InvalidNumberFormat */: return 'InvalidNumberFormat';\n        case 3 /* ParseErrorCode.PropertyNameExpected */: return 'PropertyNameExpected';\n        case 4 /* ParseErrorCode.ValueExpected */: return 'ValueExpected';\n        case 5 /* ParseErrorCode.ColonExpected */: return 'ColonExpected';\n        case 6 /* ParseErrorCode.CommaExpected */: return 'CommaExpected';\n        case 7 /* ParseErrorCode.CloseBraceExpected */: return 'CloseBraceExpected';\n        case 8 /* ParseErrorCode.CloseBracketExpected */: return 'CloseBracketExpected';\n        case 9 /* ParseErrorCode.EndOfFileExpected */: return 'EndOfFileExpected';\n        case 10 /* ParseErrorCode.InvalidCommentToken */: return 'InvalidCommentToken';\n        case 11 /* ParseErrorCode.UnexpectedEndOfComment */: return 'UnexpectedEndOfComment';\n        case 12 /* ParseErrorCode.UnexpectedEndOfString */: return 'UnexpectedEndOfString';\n        case 13 /* ParseErrorCode.UnexpectedEndOfNumber */: return 'UnexpectedEndOfNumber';\n        case 14 /* ParseErrorCode.InvalidUnicode */: return 'InvalidUnicode';\n        case 15 /* ParseErrorCode.InvalidEscapeCharacter */: return 'InvalidEscapeCharacter';\n        case 16 /* ParseErrorCode.InvalidCharacter */: return 'InvalidCharacter';\n    }\n    return '<unknown ParseErrorCode>';\n}\n/**\n * Computes the edit operations needed to format a JSON document.\n *\n * @param documentText The input text\n * @param range The range to format or `undefined` to format the full content\n * @param options The formatting options\n * @returns The edit operations describing the formatting changes to the original document following the format described in {@linkcode EditResult}.\n * To apply the edit operations to the input, use {@linkcode applyEdits}.\n */\nexport function format(documentText, range, options) {\n    return formatter.format(documentText, range, options);\n}\n/**\n * Computes the edit operations needed to modify a value in the JSON document.\n *\n * @param documentText The input text\n * @param path The path of the value to change. The path represents either to the document root, a property or an array item.\n * If the path points to an non-existing property or item, it will be created.\n * @param value The new value for the specified property or item. If the value is undefined,\n * the property or item will be removed.\n * @param options Options\n * @returns The edit operations describing the changes to the original document, following the format described in {@linkcode EditResult}.\n * To apply the edit operations to the input, use {@linkcode applyEdits}.\n */\nexport function modify(text, path, value, options) {\n    return edit.setProperty(text, path, value, options);\n}\n/**\n * Applies edits to an input string.\n * @param text The input text\n * @param edits Edit operations following the format described in {@linkcode EditResult}.\n * @returns The text with the applied edits.\n * @throws An error if the edit operations are not well-formed as described in {@linkcode EditResult}.\n */\nexport function applyEdits(text, edits) {\n    let sortedEdits = edits.slice(0).sort((a, b) => {\n        const diff = a.offset - b.offset;\n        if (diff === 0) {\n            return a.length - b.length;\n        }\n        return diff;\n    });\n    let lastModifiedOffset = text.length;\n    for (let i = sortedEdits.length - 1; i >= 0; i--) {\n        let e = sortedEdits[i];\n        if (e.offset + e.length <= lastModifiedOffset) {\n            text = edit.applyEdit(text, e);\n        }\n        else {\n            throw new Error('Overlapping edit');\n        }\n        lastModifiedOffset = e.offset;\n    }\n    return text;\n}\n","'use strict'\n\n// A linked list to keep track of recently-used-ness\nconst Yallist = require('yallist')\n\nconst MAX = Symbol('max')\nconst LENGTH = Symbol('length')\nconst LENGTH_CALCULATOR = Symbol('lengthCalculator')\nconst ALLOW_STALE = Symbol('allowStale')\nconst MAX_AGE = Symbol('maxAge')\nconst DISPOSE = Symbol('dispose')\nconst NO_DISPOSE_ON_SET = Symbol('noDisposeOnSet')\nconst LRU_LIST = Symbol('lruList')\nconst CACHE = Symbol('cache')\nconst UPDATE_AGE_ON_GET = Symbol('updateAgeOnGet')\n\nconst naiveLength = () => 1\n\n// lruList is a yallist where the head is the youngest\n// item, and the tail is the oldest.  the list contains the Hit\n// objects as the entries.\n// Each Hit object has a reference to its Yallist.Node.  This\n// never changes.\n//\n// cache is a Map (or PseudoMap) that matches the keys to\n// the Yallist.Node object.\nclass LRUCache {\n  constructor (options) {\n    if (typeof options === 'number')\n      options = { max: options }\n\n    if (!options)\n      options = {}\n\n    if (options.max && (typeof options.max !== 'number' || options.max < 0))\n      throw new TypeError('max must be a non-negative number')\n    // Kind of weird to have a default max of Infinity, but oh well.\n    const max = this[MAX] = options.max || Infinity\n\n    const lc = options.length || naiveLength\n    this[LENGTH_CALCULATOR] = (typeof lc !== 'function') ? naiveLength : lc\n    this[ALLOW_STALE] = options.stale || false\n    if (options.maxAge && typeof options.maxAge !== 'number')\n      throw new TypeError('maxAge must be a number')\n    this[MAX_AGE] = options.maxAge || 0\n    this[DISPOSE] = options.dispose\n    this[NO_DISPOSE_ON_SET] = options.noDisposeOnSet || false\n    this[UPDATE_AGE_ON_GET] = options.updateAgeOnGet || false\n    this.reset()\n  }\n\n  // resize the cache when the max changes.\n  set max (mL) {\n    if (typeof mL !== 'number' || mL < 0)\n      throw new TypeError('max must be a non-negative number')\n\n    this[MAX] = mL || Infinity\n    trim(this)\n  }\n  get max () {\n    return this[MAX]\n  }\n\n  set allowStale (allowStale) {\n    this[ALLOW_STALE] = !!allowStale\n  }\n  get allowStale () {\n    return this[ALLOW_STALE]\n  }\n\n  set maxAge (mA) {\n    if (typeof mA !== 'number')\n      throw new TypeError('maxAge must be a non-negative number')\n\n    this[MAX_AGE] = mA\n    trim(this)\n  }\n  get maxAge () {\n    return this[MAX_AGE]\n  }\n\n  // resize the cache when the lengthCalculator changes.\n  set lengthCalculator (lC) {\n    if (typeof lC !== 'function')\n      lC = naiveLength\n\n    if (lC !== this[LENGTH_CALCULATOR]) {\n      this[LENGTH_CALCULATOR] = lC\n      this[LENGTH] = 0\n      this[LRU_LIST].forEach(hit => {\n        hit.length = this[LENGTH_CALCULATOR](hit.value, hit.key)\n        this[LENGTH] += hit.length\n      })\n    }\n    trim(this)\n  }\n  get lengthCalculator () { return this[LENGTH_CALCULATOR] }\n\n  get length () { return this[LENGTH] }\n  get itemCount () { return this[LRU_LIST].length }\n\n  rforEach (fn, thisp) {\n    thisp = thisp || this\n    for (let walker = this[LRU_LIST].tail; walker !== null;) {\n      const prev = walker.prev\n      forEachStep(this, fn, walker, thisp)\n      walker = prev\n    }\n  }\n\n  forEach (fn, thisp) {\n    thisp = thisp || this\n    for (let walker = this[LRU_LIST].head; walker !== null;) {\n      const next = walker.next\n      forEachStep(this, fn, walker, thisp)\n      walker = next\n    }\n  }\n\n  keys () {\n    return this[LRU_LIST].toArray().map(k => k.key)\n  }\n\n  values () {\n    return this[LRU_LIST].toArray().map(k => k.value)\n  }\n\n  reset () {\n    if (this[DISPOSE] &&\n        this[LRU_LIST] &&\n        this[LRU_LIST].length) {\n      this[LRU_LIST].forEach(hit => this[DISPOSE](hit.key, hit.value))\n    }\n\n    this[CACHE] = new Map() // hash of items by key\n    this[LRU_LIST] = new Yallist() // list of items in order of use recency\n    this[LENGTH] = 0 // length of items in the list\n  }\n\n  dump () {\n    return this[LRU_LIST].map(hit =>\n      isStale(this, hit) ? false : {\n        k: hit.key,\n        v: hit.value,\n        e: hit.now + (hit.maxAge || 0)\n      }).toArray().filter(h => h)\n  }\n\n  dumpLru () {\n    return this[LRU_LIST]\n  }\n\n  set (key, value, maxAge) {\n    maxAge = maxAge || this[MAX_AGE]\n\n    if (maxAge && typeof maxAge !== 'number')\n      throw new TypeError('maxAge must be a number')\n\n    const now = maxAge ? Date.now() : 0\n    const len = this[LENGTH_CALCULATOR](value, key)\n\n    if (this[CACHE].has(key)) {\n      if (len > this[MAX]) {\n        del(this, this[CACHE].get(key))\n        return false\n      }\n\n      const node = this[CACHE].get(key)\n      const item = node.value\n\n      // dispose of the old one before overwriting\n      // split out into 2 ifs for better coverage tracking\n      if (this[DISPOSE]) {\n        if (!this[NO_DISPOSE_ON_SET])\n          this[DISPOSE](key, item.value)\n      }\n\n      item.now = now\n      item.maxAge = maxAge\n      item.value = value\n      this[LENGTH] += len - item.length\n      item.length = len\n      this.get(key)\n      trim(this)\n      return true\n    }\n\n    const hit = new Entry(key, value, len, now, maxAge)\n\n    // oversized objects fall out of cache automatically.\n    if (hit.length > this[MAX]) {\n      if (this[DISPOSE])\n        this[DISPOSE](key, value)\n\n      return false\n    }\n\n    this[LENGTH] += hit.length\n    this[LRU_LIST].unshift(hit)\n    this[CACHE].set(key, this[LRU_LIST].head)\n    trim(this)\n    return true\n  }\n\n  has (key) {\n    if (!this[CACHE].has(key)) return false\n    const hit = this[CACHE].get(key).value\n    return !isStale(this, hit)\n  }\n\n  get (key) {\n    return get(this, key, true)\n  }\n\n  peek (key) {\n    return get(this, key, false)\n  }\n\n  pop () {\n    const node = this[LRU_LIST].tail\n    if (!node)\n      return null\n\n    del(this, node)\n    return node.value\n  }\n\n  del (key) {\n    del(this, this[CACHE].get(key))\n  }\n\n  load (arr) {\n    // reset the cache\n    this.reset()\n\n    const now = Date.now()\n    // A previous serialized cache has the most recent items first\n    for (let l = arr.length - 1; l >= 0; l--) {\n      const hit = arr[l]\n      const expiresAt = hit.e || 0\n      if (expiresAt === 0)\n        // the item was created without expiration in a non aged cache\n        this.set(hit.k, hit.v)\n      else {\n        const maxAge = expiresAt - now\n        // dont add already expired items\n        if (maxAge > 0) {\n          this.set(hit.k, hit.v, maxAge)\n        }\n      }\n    }\n  }\n\n  prune () {\n    this[CACHE].forEach((value, key) => get(this, key, false))\n  }\n}\n\nconst get = (self, key, doUse) => {\n  const node = self[CACHE].get(key)\n  if (node) {\n    const hit = node.value\n    if (isStale(self, hit)) {\n      del(self, node)\n      if (!self[ALLOW_STALE])\n        return undefined\n    } else {\n      if (doUse) {\n        if (self[UPDATE_AGE_ON_GET])\n          node.value.now = Date.now()\n        self[LRU_LIST].unshiftNode(node)\n      }\n    }\n    return hit.value\n  }\n}\n\nconst isStale = (self, hit) => {\n  if (!hit || (!hit.maxAge && !self[MAX_AGE]))\n    return false\n\n  const diff = Date.now() - hit.now\n  return hit.maxAge ? diff > hit.maxAge\n    : self[MAX_AGE] && (diff > self[MAX_AGE])\n}\n\nconst trim = self => {\n  if (self[LENGTH] > self[MAX]) {\n    for (let walker = self[LRU_LIST].tail;\n      self[LENGTH] > self[MAX] && walker !== null;) {\n      // We know that we're about to delete this one, and also\n      // what the next least recently used key will be, so just\n      // go ahead and set it now.\n      const prev = walker.prev\n      del(self, walker)\n      walker = prev\n    }\n  }\n}\n\nconst del = (self, node) => {\n  if (node) {\n    const hit = node.value\n    if (self[DISPOSE])\n      self[DISPOSE](hit.key, hit.value)\n\n    self[LENGTH] -= hit.length\n    self[CACHE].delete(hit.key)\n    self[LRU_LIST].removeNode(node)\n  }\n}\n\nclass Entry {\n  constructor (key, value, length, now, maxAge) {\n    this.key = key\n    this.value = value\n    this.length = length\n    this.now = now\n    this.maxAge = maxAge || 0\n  }\n}\n\nconst forEachStep = (self, fn, node, thisp) => {\n  let hit = node.value\n  if (isStale(self, hit)) {\n    del(self, node)\n    if (!self[ALLOW_STALE])\n      hit = undefined\n  }\n  if (hit)\n    fn.call(thisp, hit.value, hit.key, self)\n}\n\nmodule.exports = LRUCache\n","const ANY = Symbol('SemVer ANY')\n// hoisted class for cyclic dependency\nclass Comparator {\n  static get ANY () {\n    return ANY\n  }\n\n  constructor (comp, options) {\n    options = parseOptions(options)\n\n    if (comp instanceof Comparator) {\n      if (comp.loose === !!options.loose) {\n        return comp\n      } else {\n        comp = comp.value\n      }\n    }\n\n    comp = comp.trim().split(/\\s+/).join(' ')\n    debug('comparator', comp, options)\n    this.options = options\n    this.loose = !!options.loose\n    this.parse(comp)\n\n    if (this.semver === ANY) {\n      this.value = ''\n    } else {\n      this.value = this.operator + this.semver.version\n    }\n\n    debug('comp', this)\n  }\n\n  parse (comp) {\n    const r = this.options.loose ? re[t.COMPARATORLOOSE] : re[t.COMPARATOR]\n    const m = comp.match(r)\n\n    if (!m) {\n      throw new TypeError(`Invalid comparator: ${comp}`)\n    }\n\n    this.operator = m[1] !== undefined ? m[1] : ''\n    if (this.operator === '=') {\n      this.operator = ''\n    }\n\n    // if it literally is just '>' or '' then allow anything.\n    if (!m[2]) {\n      this.semver = ANY\n    } else {\n      this.semver = new SemVer(m[2], this.options.loose)\n    }\n  }\n\n  toString () {\n    return this.value\n  }\n\n  test (version) {\n    debug('Comparator.test', version, this.options.loose)\n\n    if (this.semver === ANY || version === ANY) {\n      return true\n    }\n\n    if (typeof version === 'string') {\n      try {\n        version = new SemVer(version, this.options)\n      } catch (er) {\n        return false\n      }\n    }\n\n    return cmp(version, this.operator, this.semver, this.options)\n  }\n\n  intersects (comp, options) {\n    if (!(comp instanceof Comparator)) {\n      throw new TypeError('a Comparator is required')\n    }\n\n    if (this.operator === '') {\n      if (this.value === '') {\n        return true\n      }\n      return new Range(comp.value, options).test(this.value)\n    } else if (comp.operator === '') {\n      if (comp.value === '') {\n        return true\n      }\n      return new Range(this.value, options).test(comp.semver)\n    }\n\n    options = parseOptions(options)\n\n    // Special cases where nothing can possibly be lower\n    if (options.includePrerelease &&\n      (this.value === '<0.0.0-0' || comp.value === '<0.0.0-0')) {\n      return false\n    }\n    if (!options.includePrerelease &&\n      (this.value.startsWith('<0.0.0') || comp.value.startsWith('<0.0.0'))) {\n      return false\n    }\n\n    // Same direction increasing (> or >=)\n    if (this.operator.startsWith('>') && comp.operator.startsWith('>')) {\n      return true\n    }\n    // Same direction decreasing (< or <=)\n    if (this.operator.startsWith('<') && comp.operator.startsWith('<')) {\n      return true\n    }\n    // same SemVer and both sides are inclusive (<= or >=)\n    if (\n      (this.semver.version === comp.semver.version) &&\n      this.operator.includes('=') && comp.operator.includes('=')) {\n      return true\n    }\n    // opposite directions less than\n    if (cmp(this.semver, '<', comp.semver, options) &&\n      this.operator.startsWith('>') && comp.operator.startsWith('<')) {\n      return true\n    }\n    // opposite directions greater than\n    if (cmp(this.semver, '>', comp.semver, options) &&\n      this.operator.startsWith('<') && comp.operator.startsWith('>')) {\n      return true\n    }\n    return false\n  }\n}\n\nmodule.exports = Comparator\n\nconst parseOptions = require('../internal/parse-options')\nconst { safeRe: re, t } = require('../internal/re')\nconst cmp = require('../functions/cmp')\nconst debug = require('../internal/debug')\nconst SemVer = require('./semver')\nconst Range = require('./range')\n","// hoisted class for cyclic dependency\nclass Range {\n  constructor (range, options) {\n    options = parseOptions(options)\n\n    if (range instanceof Range) {\n      if (\n        range.loose === !!options.loose &&\n        range.includePrerelease === !!options.includePrerelease\n      ) {\n        return range\n      } else {\n        return new Range(range.raw, options)\n      }\n    }\n\n    if (range instanceof Comparator) {\n      // just put it in the set and return\n      this.raw = range.value\n      this.set = [[range]]\n      this.format()\n      return this\n    }\n\n    this.options = options\n    this.loose = !!options.loose\n    this.includePrerelease = !!options.includePrerelease\n\n    // First reduce all whitespace as much as possible so we do not have to rely\n    // on potentially slow regexes like \\s*. This is then stored and used for\n    // future error messages as well.\n    this.raw = range\n      .trim()\n      .split(/\\s+/)\n      .join(' ')\n\n    // First, split on ||\n    this.set = this.raw\n      .split('||')\n      // map the range to a 2d array of comparators\n      .map(r => this.parseRange(r))\n      // throw out any comparator lists that are empty\n      // this generally means that it was not a valid range, which is allowed\n      // in loose mode, but will still throw if the WHOLE range is invalid.\n      .filter(c => c.length)\n\n    if (!this.set.length) {\n      throw new TypeError(`Invalid SemVer Range: ${this.raw}`)\n    }\n\n    // if we have any that are not the null set, throw out null sets.\n    if (this.set.length > 1) {\n      // keep the first one, in case they're all null sets\n      const first = this.set[0]\n      this.set = this.set.filter(c => !isNullSet(c[0]))\n      if (this.set.length === 0) {\n        this.set = [first]\n      } else if (this.set.length > 1) {\n        // if we have any that are *, then the range is just *\n        for (const c of this.set) {\n          if (c.length === 1 && isAny(c[0])) {\n            this.set = [c]\n            break\n          }\n        }\n      }\n    }\n\n    this.format()\n  }\n\n  format () {\n    this.range = this.set\n      .map((comps) => comps.join(' ').trim())\n      .join('||')\n      .trim()\n    return this.range\n  }\n\n  toString () {\n    return this.range\n  }\n\n  parseRange (range) {\n    // memoize range parsing for performance.\n    // this is a very hot path, and fully deterministic.\n    const memoOpts =\n      (this.options.includePrerelease && FLAG_INCLUDE_PRERELEASE) |\n      (this.options.loose && FLAG_LOOSE)\n    const memoKey = memoOpts + ':' + range\n    const cached = cache.get(memoKey)\n    if (cached) {\n      return cached\n    }\n\n    const loose = this.options.loose\n    // `1.2.3 - 1.2.4` => `>=1.2.3 <=1.2.4`\n    const hr = loose ? re[t.HYPHENRANGELOOSE] : re[t.HYPHENRANGE]\n    range = range.replace(hr, hyphenReplace(this.options.includePrerelease))\n    debug('hyphen replace', range)\n    // `> 1.2.3 < 1.2.5` => `>1.2.3 <1.2.5`\n    range = range.replace(re[t.COMPARATORTRIM], comparatorTrimReplace)\n    debug('comparator trim', range)\n\n    // `~ 1.2.3` => `~1.2.3`\n    range = range.replace(re[t.TILDETRIM], tildeTrimReplace)\n\n    // `^ 1.2.3` => `^1.2.3`\n    range = range.replace(re[t.CARETTRIM], caretTrimReplace)\n\n    // At this point, the range is completely trimmed and\n    // ready to be split into comparators.\n\n    let rangeList = range\n      .split(' ')\n      .map(comp => parseComparator(comp, this.options))\n      .join(' ')\n      .split(/\\s+/)\n      // >=0.0.0 is equivalent to *\n      .map(comp => replaceGTE0(comp, this.options))\n\n    if (loose) {\n      // in loose mode, throw out any that are not valid comparators\n      rangeList = rangeList.filter(comp => {\n        debug('loose invalid filter', comp, this.options)\n        return !!comp.match(re[t.COMPARATORLOOSE])\n      })\n    }\n    debug('range list', rangeList)\n\n    // if any comparators are the null set, then replace with JUST null set\n    // if more than one comparator, remove any * comparators\n    // also, don't include the same comparator more than once\n    const rangeMap = new Map()\n    const comparators = rangeList.map(comp => new Comparator(comp, this.options))\n    for (const comp of comparators) {\n      if (isNullSet(comp)) {\n        return [comp]\n      }\n      rangeMap.set(comp.value, comp)\n    }\n    if (rangeMap.size > 1 && rangeMap.has('')) {\n      rangeMap.delete('')\n    }\n\n    const result = [...rangeMap.values()]\n    cache.set(memoKey, result)\n    return result\n  }\n\n  intersects (range, options) {\n    if (!(range instanceof Range)) {\n      throw new TypeError('a Range is required')\n    }\n\n    return this.set.some((thisComparators) => {\n      return (\n        isSatisfiable(thisComparators, options) &&\n        range.set.some((rangeComparators) => {\n          return (\n            isSatisfiable(rangeComparators, options) &&\n            thisComparators.every((thisComparator) => {\n              return rangeComparators.every((rangeComparator) => {\n                return thisComparator.intersects(rangeComparator, options)\n              })\n            })\n          )\n        })\n      )\n    })\n  }\n\n  // if ANY of the sets match ALL of its comparators, then pass\n  test (version) {\n    if (!version) {\n      return false\n    }\n\n    if (typeof version === 'string') {\n      try {\n        version = new SemVer(version, this.options)\n      } catch (er) {\n        return false\n      }\n    }\n\n    for (let i = 0; i < this.set.length; i++) {\n      if (testSet(this.set[i], version, this.options)) {\n        return true\n      }\n    }\n    return false\n  }\n}\n\nmodule.exports = Range\n\nconst LRU = require('lru-cache')\nconst cache = new LRU({ max: 1000 })\n\nconst parseOptions = require('../internal/parse-options')\nconst Comparator = require('./comparator')\nconst debug = require('../internal/debug')\nconst SemVer = require('./semver')\nconst {\n  safeRe: re,\n  t,\n  comparatorTrimReplace,\n  tildeTrimReplace,\n  caretTrimReplace,\n} = require('../internal/re')\nconst { FLAG_INCLUDE_PRERELEASE, FLAG_LOOSE } = require('../internal/constants')\n\nconst isNullSet = c => c.value === '<0.0.0-0'\nconst isAny = c => c.value === ''\n\n// take a set of comparators and determine whether there\n// exists a version which can satisfy it\nconst isSatisfiable = (comparators, options) => {\n  let result = true\n  const remainingComparators = comparators.slice()\n  let testComparator = remainingComparators.pop()\n\n  while (result && remainingComparators.length) {\n    result = remainingComparators.every((otherComparator) => {\n      return testComparator.intersects(otherComparator, options)\n    })\n\n    testComparator = remainingComparators.pop()\n  }\n\n  return result\n}\n\n// comprised of xranges, tildes, stars, and gtlt's at this point.\n// already replaced the hyphen ranges\n// turn into a set of JUST comparators.\nconst parseComparator = (comp, options) => {\n  debug('comp', comp, options)\n  comp = replaceCarets(comp, options)\n  debug('caret', comp)\n  comp = replaceTildes(comp, options)\n  debug('tildes', comp)\n  comp = replaceXRanges(comp, options)\n  debug('xrange', comp)\n  comp = replaceStars(comp, options)\n  debug('stars', comp)\n  return comp\n}\n\nconst isX = id => !id || id.toLowerCase() === 'x' || id === '*'\n\n// ~, ~> --> * (any, kinda silly)\n// ~2, ~2.x, ~2.x.x, ~>2, ~>2.x ~>2.x.x --> >=2.0.0 <3.0.0-0\n// ~2.0, ~2.0.x, ~>2.0, ~>2.0.x --> >=2.0.0 <2.1.0-0\n// ~1.2, ~1.2.x, ~>1.2, ~>1.2.x --> >=1.2.0 <1.3.0-0\n// ~1.2.3, ~>1.2.3 --> >=1.2.3 <1.3.0-0\n// ~1.2.0, ~>1.2.0 --> >=1.2.0 <1.3.0-0\n// ~0.0.1 --> >=0.0.1 <0.1.0-0\nconst replaceTildes = (comp, options) => {\n  return comp\n    .trim()\n    .split(/\\s+/)\n    .map((c) => replaceTilde(c, options))\n    .join(' ')\n}\n\nconst replaceTilde = (comp, options) => {\n  const r = options.loose ? re[t.TILDELOOSE] : re[t.TILDE]\n  return comp.replace(r, (_, M, m, p, pr) => {\n    debug('tilde', comp, _, M, m, p, pr)\n    let ret\n\n    if (isX(M)) {\n      ret = ''\n    } else if (isX(m)) {\n      ret = `>=${M}.0.0 <${+M + 1}.0.0-0`\n    } else if (isX(p)) {\n      // ~1.2 == >=1.2.0 <1.3.0-0\n      ret = `>=${M}.${m}.0 <${M}.${+m + 1}.0-0`\n    } else if (pr) {\n      debug('replaceTilde pr', pr)\n      ret = `>=${M}.${m}.${p}-${pr\n      } <${M}.${+m + 1}.0-0`\n    } else {\n      // ~1.2.3 == >=1.2.3 <1.3.0-0\n      ret = `>=${M}.${m}.${p\n      } <${M}.${+m + 1}.0-0`\n    }\n\n    debug('tilde return', ret)\n    return ret\n  })\n}\n\n// ^ --> * (any, kinda silly)\n// ^2, ^2.x, ^2.x.x --> >=2.0.0 <3.0.0-0\n// ^2.0, ^2.0.x --> >=2.0.0 <3.0.0-0\n// ^1.2, ^1.2.x --> >=1.2.0 <2.0.0-0\n// ^1.2.3 --> >=1.2.3 <2.0.0-0\n// ^1.2.0 --> >=1.2.0 <2.0.0-0\n// ^0.0.1 --> >=0.0.1 <0.0.2-0\n// ^0.1.0 --> >=0.1.0 <0.2.0-0\nconst replaceCarets = (comp, options) => {\n  return comp\n    .trim()\n    .split(/\\s+/)\n    .map((c) => replaceCaret(c, options))\n    .join(' ')\n}\n\nconst replaceCaret = (comp, options) => {\n  debug('caret', comp, options)\n  const r = options.loose ? re[t.CARETLOOSE] : re[t.CARET]\n  const z = options.includePrerelease ? '-0' : ''\n  return comp.replace(r, (_, M, m, p, pr) => {\n    debug('caret', comp, _, M, m, p, pr)\n    let ret\n\n    if (isX(M)) {\n      ret = ''\n    } else if (isX(m)) {\n      ret = `>=${M}.0.0${z} <${+M + 1}.0.0-0`\n    } else if (isX(p)) {\n      if (M === '0') {\n        ret = `>=${M}.${m}.0${z} <${M}.${+m + 1}.0-0`\n      } else {\n        ret = `>=${M}.${m}.0${z} <${+M + 1}.0.0-0`\n      }\n    } else if (pr) {\n      debug('replaceCaret pr', pr)\n      if (M === '0') {\n        if (m === '0') {\n          ret = `>=${M}.${m}.${p}-${pr\n          } <${M}.${m}.${+p + 1}-0`\n        } else {\n          ret = `>=${M}.${m}.${p}-${pr\n          } <${M}.${+m + 1}.0-0`\n        }\n      } else {\n        ret = `>=${M}.${m}.${p}-${pr\n        } <${+M + 1}.0.0-0`\n      }\n    } else {\n      debug('no pr')\n      if (M === '0') {\n        if (m === '0') {\n          ret = `>=${M}.${m}.${p\n          }${z} <${M}.${m}.${+p + 1}-0`\n        } else {\n          ret = `>=${M}.${m}.${p\n          }${z} <${M}.${+m + 1}.0-0`\n        }\n      } else {\n        ret = `>=${M}.${m}.${p\n        } <${+M + 1}.0.0-0`\n      }\n    }\n\n    debug('caret return', ret)\n    return ret\n  })\n}\n\nconst replaceXRanges = (comp, options) => {\n  debug('replaceXRanges', comp, options)\n  return comp\n    .split(/\\s+/)\n    .map((c) => replaceXRange(c, options))\n    .join(' ')\n}\n\nconst replaceXRange = (comp, options) => {\n  comp = comp.trim()\n  const r = options.loose ? re[t.XRANGELOOSE] : re[t.XRANGE]\n  return comp.replace(r, (ret, gtlt, M, m, p, pr) => {\n    debug('xRange', comp, ret, gtlt, M, m, p, pr)\n    const xM = isX(M)\n    const xm = xM || isX(m)\n    const xp = xm || isX(p)\n    const anyX = xp\n\n    if (gtlt === '=' && anyX) {\n      gtlt = ''\n    }\n\n    // if we're including prereleases in the match, then we need\n    // to fix this to -0, the lowest possible prerelease value\n    pr = options.includePrerelease ? '-0' : ''\n\n    if (xM) {\n      if (gtlt === '>' || gtlt === '<') {\n        // nothing is allowed\n        ret = '<0.0.0-0'\n      } else {\n        // nothing is forbidden\n        ret = '*'\n      }\n    } else if (gtlt && anyX) {\n      // we know patch is an x, because we have any x at all.\n      // replace X with 0\n      if (xm) {\n        m = 0\n      }\n      p = 0\n\n      if (gtlt === '>') {\n        // >1 => >=2.0.0\n        // >1.2 => >=1.3.0\n        gtlt = '>='\n        if (xm) {\n          M = +M + 1\n          m = 0\n          p = 0\n        } else {\n          m = +m + 1\n          p = 0\n        }\n      } else if (gtlt === '<=') {\n        // <=0.7.x is actually <0.8.0, since any 0.7.x should\n        // pass.  Similarly, <=7.x is actually <8.0.0, etc.\n        gtlt = '<'\n        if (xm) {\n          M = +M + 1\n        } else {\n          m = +m + 1\n        }\n      }\n\n      if (gtlt === '<') {\n        pr = '-0'\n      }\n\n      ret = `${gtlt + M}.${m}.${p}${pr}`\n    } else if (xm) {\n      ret = `>=${M}.0.0${pr} <${+M + 1}.0.0-0`\n    } else if (xp) {\n      ret = `>=${M}.${m}.0${pr\n      } <${M}.${+m + 1}.0-0`\n    }\n\n    debug('xRange return', ret)\n\n    return ret\n  })\n}\n\n// Because * is AND-ed with everything else in the comparator,\n// and '' means \"any version\", just remove the *s entirely.\nconst replaceStars = (comp, options) => {\n  debug('replaceStars', comp, options)\n  // Looseness is ignored here.  star is always as loose as it gets!\n  return comp\n    .trim()\n    .replace(re[t.STAR], '')\n}\n\nconst replaceGTE0 = (comp, options) => {\n  debug('replaceGTE0', comp, options)\n  return comp\n    .trim()\n    .replace(re[options.includePrerelease ? t.GTE0PRE : t.GTE0], '')\n}\n\n// This function is passed to string.replace(re[t.HYPHENRANGE])\n// M, m, patch, prerelease, build\n// 1.2 - 3.4.5 => >=1.2.0 <=3.4.5\n// 1.2.3 - 3.4 => >=1.2.0 <3.5.0-0 Any 3.4.x will do\n// 1.2 - 3.4 => >=1.2.0 <3.5.0-0\nconst hyphenReplace = incPr => ($0,\n  from, fM, fm, fp, fpr, fb,\n  to, tM, tm, tp, tpr, tb) => {\n  if (isX(fM)) {\n    from = ''\n  } else if (isX(fm)) {\n    from = `>=${fM}.0.0${incPr ? '-0' : ''}`\n  } else if (isX(fp)) {\n    from = `>=${fM}.${fm}.0${incPr ? '-0' : ''}`\n  } else if (fpr) {\n    from = `>=${from}`\n  } else {\n    from = `>=${from}${incPr ? '-0' : ''}`\n  }\n\n  if (isX(tM)) {\n    to = ''\n  } else if (isX(tm)) {\n    to = `<${+tM + 1}.0.0-0`\n  } else if (isX(tp)) {\n    to = `<${tM}.${+tm + 1}.0-0`\n  } else if (tpr) {\n    to = `<=${tM}.${tm}.${tp}-${tpr}`\n  } else if (incPr) {\n    to = `<${tM}.${tm}.${+tp + 1}-0`\n  } else {\n    to = `<=${to}`\n  }\n\n  return `${from} ${to}`.trim()\n}\n\nconst testSet = (set, version, options) => {\n  for (let i = 0; i < set.length; i++) {\n    if (!set[i].test(version)) {\n      return false\n    }\n  }\n\n  if (version.prerelease.length && !options.includePrerelease) {\n    // Find the set of versions that are allowed to have prereleases\n    // For example, ^1.2.3-pr.1 desugars to >=1.2.3-pr.1 <2.0.0\n    // That should allow `1.2.3-pr.2` to pass.\n    // However, `1.2.4-alpha.notready` should NOT be allowed,\n    // even though it's within the range set by the comparators.\n    for (let i = 0; i < set.length; i++) {\n      debug(set[i].semver)\n      if (set[i].semver === Comparator.ANY) {\n        continue\n      }\n\n      if (set[i].semver.prerelease.length > 0) {\n        const allowed = set[i].semver\n        if (allowed.major === version.major &&\n            allowed.minor === version.minor &&\n            allowed.patch === version.patch) {\n          return true\n        }\n      }\n    }\n\n    // Version has a -pre, but it's not one of the ones we like.\n    return false\n  }\n\n  return true\n}\n","const debug = require('../internal/debug')\nconst { MAX_LENGTH, MAX_SAFE_INTEGER } = require('../internal/constants')\nconst { safeRe: re, t } = require('../internal/re')\n\nconst parseOptions = require('../internal/parse-options')\nconst { compareIdentifiers } = require('../internal/identifiers')\nclass SemVer {\n  constructor (version, options) {\n    options = parseOptions(options)\n\n    if (version instanceof SemVer) {\n      if (version.loose === !!options.loose &&\n          version.includePrerelease === !!options.includePrerelease) {\n        return version\n      } else {\n        version = version.version\n      }\n    } else if (typeof version !== 'string') {\n      throw new TypeError(`Invalid version. Must be a string. Got type \"${typeof version}\".`)\n    }\n\n    if (version.length > MAX_LENGTH) {\n      throw new TypeError(\n        `version is longer than ${MAX_LENGTH} characters`\n      )\n    }\n\n    debug('SemVer', version, options)\n    this.options = options\n    this.loose = !!options.loose\n    // this isn't actually relevant for versions, but keep it so that we\n    // don't run into trouble passing this.options around.\n    this.includePrerelease = !!options.includePrerelease\n\n    const m = version.trim().match(options.loose ? re[t.LOOSE] : re[t.FULL])\n\n    if (!m) {\n      throw new TypeError(`Invalid Version: ${version}`)\n    }\n\n    this.raw = version\n\n    // these are actually numbers\n    this.major = +m[1]\n    this.minor = +m[2]\n    this.patch = +m[3]\n\n    if (this.major > MAX_SAFE_INTEGER || this.major < 0) {\n      throw new TypeError('Invalid major version')\n    }\n\n    if (this.minor > MAX_SAFE_INTEGER || this.minor < 0) {\n      throw new TypeError('Invalid minor version')\n    }\n\n    if (this.patch > MAX_SAFE_INTEGER || this.patch < 0) {\n      throw new TypeError('Invalid patch version')\n    }\n\n    // numberify any prerelease numeric ids\n    if (!m[4]) {\n      this.prerelease = []\n    } else {\n      this.prerelease = m[4].split('.').map((id) => {\n        if (/^[0-9]+$/.test(id)) {\n          const num = +id\n          if (num >= 0 && num < MAX_SAFE_INTEGER) {\n            return num\n          }\n        }\n        return id\n      })\n    }\n\n    this.build = m[5] ? m[5].split('.') : []\n    this.format()\n  }\n\n  format () {\n    this.version = `${this.major}.${this.minor}.${this.patch}`\n    if (this.prerelease.length) {\n      this.version += `-${this.prerelease.join('.')}`\n    }\n    return this.version\n  }\n\n  toString () {\n    return this.version\n  }\n\n  compare (other) {\n    debug('SemVer.compare', this.version, this.options, other)\n    if (!(other instanceof SemVer)) {\n      if (typeof other === 'string' && other === this.version) {\n        return 0\n      }\n      other = new SemVer(other, this.options)\n    }\n\n    if (other.version === this.version) {\n      return 0\n    }\n\n    return this.compareMain(other) || this.comparePre(other)\n  }\n\n  compareMain (other) {\n    if (!(other instanceof SemVer)) {\n      other = new SemVer(other, this.options)\n    }\n\n    return (\n      compareIdentifiers(this.major, other.major) ||\n      compareIdentifiers(this.minor, other.minor) ||\n      compareIdentifiers(this.patch, other.patch)\n    )\n  }\n\n  comparePre (other) {\n    if (!(other instanceof SemVer)) {\n      other = new SemVer(other, this.options)\n    }\n\n    // NOT having a prerelease is > having one\n    if (this.prerelease.length && !other.prerelease.length) {\n      return -1\n    } else if (!this.prerelease.length && other.prerelease.length) {\n      return 1\n    } else if (!this.prerelease.length && !other.prerelease.length) {\n      return 0\n    }\n\n    let i = 0\n    do {\n      const a = this.prerelease[i]\n      const b = other.prerelease[i]\n      debug('prerelease compare', i, a, b)\n      if (a === undefined && b === undefined) {\n        return 0\n      } else if (b === undefined) {\n        return 1\n      } else if (a === undefined) {\n        return -1\n      } else if (a === b) {\n        continue\n      } else {\n        return compareIdentifiers(a, b)\n      }\n    } while (++i)\n  }\n\n  compareBuild (other) {\n    if (!(other instanceof SemVer)) {\n      other = new SemVer(other, this.options)\n    }\n\n    let i = 0\n    do {\n      const a = this.build[i]\n      const b = other.build[i]\n      debug('prerelease compare', i, a, b)\n      if (a === undefined && b === undefined) {\n        return 0\n      } else if (b === undefined) {\n        return 1\n      } else if (a === undefined) {\n        return -1\n      } else if (a === b) {\n        continue\n      } else {\n        return compareIdentifiers(a, b)\n      }\n    } while (++i)\n  }\n\n  // preminor will bump the version up to the next minor release, and immediately\n  // down to pre-release. premajor and prepatch work the same way.\n  inc (release, identifier, identifierBase) {\n    switch (release) {\n      case 'premajor':\n        this.prerelease.length = 0\n        this.patch = 0\n        this.minor = 0\n        this.major++\n        this.inc('pre', identifier, identifierBase)\n        break\n      case 'preminor':\n        this.prerelease.length = 0\n        this.patch = 0\n        this.minor++\n        this.inc('pre', identifier, identifierBase)\n        break\n      case 'prepatch':\n        // If this is already a prerelease, it will bump to the next version\n        // drop any prereleases that might already exist, since they are not\n        // relevant at this point.\n        this.prerelease.length = 0\n        this.inc('patch', identifier, identifierBase)\n        this.inc('pre', identifier, identifierBase)\n        break\n      // If the input is a non-prerelease version, this acts the same as\n      // prepatch.\n      case 'prerelease':\n        if (this.prerelease.length === 0) {\n          this.inc('patch', identifier, identifierBase)\n        }\n        this.inc('pre', identifier, identifierBase)\n        break\n\n      case 'major':\n        // If this is a pre-major version, bump up to the same major version.\n        // Otherwise increment major.\n        // 1.0.0-5 bumps to 1.0.0\n        // 1.1.0 bumps to 2.0.0\n        if (\n          this.minor !== 0 ||\n          this.patch !== 0 ||\n          this.prerelease.length === 0\n        ) {\n          this.major++\n        }\n        this.minor = 0\n        this.patch = 0\n        this.prerelease = []\n        break\n      case 'minor':\n        // If this is a pre-minor version, bump up to the same minor version.\n        // Otherwise increment minor.\n        // 1.2.0-5 bumps to 1.2.0\n        // 1.2.1 bumps to 1.3.0\n        if (this.patch !== 0 || this.prerelease.length === 0) {\n          this.minor++\n        }\n        this.patch = 0\n        this.prerelease = []\n        break\n      case 'patch':\n        // If this is not a pre-release version, it will increment the patch.\n        // If it is a pre-release it will bump up to the same patch version.\n        // 1.2.0-5 patches to 1.2.0\n        // 1.2.0 patches to 1.2.1\n        if (this.prerelease.length === 0) {\n          this.patch++\n        }\n        this.prerelease = []\n        break\n      // This probably shouldn't be used publicly.\n      // 1.0.0 'pre' would become 1.0.0-0 which is the wrong direction.\n      case 'pre': {\n        const base = Number(identifierBase) ? 1 : 0\n\n        if (!identifier && identifierBase === false) {\n          throw new Error('invalid increment argument: identifier is empty')\n        }\n\n        if (this.prerelease.length === 0) {\n          this.prerelease = [base]\n        } else {\n          let i = this.prerelease.length\n          while (--i >= 0) {\n            if (typeof this.prerelease[i] === 'number') {\n              this.prerelease[i]++\n              i = -2\n            }\n          }\n          if (i === -1) {\n            // didn't increment anything\n            if (identifier === this.prerelease.join('.') && identifierBase === false) {\n              throw new Error('invalid increment argument: identifier already exists')\n            }\n            this.prerelease.push(base)\n          }\n        }\n        if (identifier) {\n          // 1.2.0-beta.1 bumps to 1.2.0-beta.2,\n          // 1.2.0-beta.fooblz or 1.2.0-beta bumps to 1.2.0-beta.0\n          let prerelease = [identifier, base]\n          if (identifierBase === false) {\n            prerelease = [identifier]\n          }\n          if (compareIdentifiers(this.prerelease[0], identifier) === 0) {\n            if (isNaN(this.prerelease[1])) {\n              this.prerelease = prerelease\n            }\n          } else {\n            this.prerelease = prerelease\n          }\n        }\n        break\n      }\n      default:\n        throw new Error(`invalid increment argument: ${release}`)\n    }\n    this.raw = this.format()\n    if (this.build.length) {\n      this.raw += `+${this.build.join('.')}`\n    }\n    return this\n  }\n}\n\nmodule.exports = SemVer\n","const parse = require('./parse')\nconst clean = (version, options) => {\n  const s = parse(version.trim().replace(/^[=v]+/, ''), options)\n  return s ? s.version : null\n}\nmodule.exports = clean\n","const eq = require('./eq')\nconst neq = require('./neq')\nconst gt = require('./gt')\nconst gte = require('./gte')\nconst lt = require('./lt')\nconst lte = require('./lte')\n\nconst cmp = (a, op, b, loose) => {\n  switch (op) {\n    case '===':\n      if (typeof a === 'object') {\n        a = a.version\n      }\n      if (typeof b === 'object') {\n        b = b.version\n      }\n      return a === b\n\n    case '!==':\n      if (typeof a === 'object') {\n        a = a.version\n      }\n      if (typeof b === 'object') {\n        b = b.version\n      }\n      return a !== b\n\n    case '':\n    case '=':\n    case '==':\n      return eq(a, b, loose)\n\n    case '!=':\n      return neq(a, b, loose)\n\n    case '>':\n      return gt(a, b, loose)\n\n    case '>=':\n      return gte(a, b, loose)\n\n    case '<':\n      return lt(a, b, loose)\n\n    case '<=':\n      return lte(a, b, loose)\n\n    default:\n      throw new TypeError(`Invalid operator: ${op}`)\n  }\n}\nmodule.exports = cmp\n","const SemVer = require('../classes/semver')\nconst parse = require('./parse')\nconst { safeRe: re, t } = require('../internal/re')\n\nconst coerce = (version, options) => {\n  if (version instanceof SemVer) {\n    return version\n  }\n\n  if (typeof version === 'number') {\n    version = String(version)\n  }\n\n  if (typeof version !== 'string') {\n    return null\n  }\n\n  options = options || {}\n\n  let match = null\n  if (!options.rtl) {\n    match = version.match(re[t.COERCE])\n  } else {\n    // Find the right-most coercible string that does not share\n    // a terminus with a more left-ward coercible string.\n    // Eg, '1.2.3.4' wants to coerce '2.3.4', not '3.4' or '4'\n    //\n    // Walk through the string checking with a /g regexp\n    // Manually set the index so as to pick up overlapping matches.\n    // Stop when we get a match that ends at the string end, since no\n    // coercible string can be more right-ward without the same terminus.\n    let next\n    while ((next = re[t.COERCERTL].exec(version)) &&\n        (!match || match.index + match[0].length !== version.length)\n    ) {\n      if (!match ||\n            next.index + next[0].length !== match.index + match[0].length) {\n        match = next\n      }\n      re[t.COERCERTL].lastIndex = next.index + next[1].length + next[2].length\n    }\n    // leave it in a clean state\n    re[t.COERCERTL].lastIndex = -1\n  }\n\n  if (match === null) {\n    return null\n  }\n\n  return parse(`${match[2]}.${match[3] || '0'}.${match[4] || '0'}`, options)\n}\nmodule.exports = coerce\n","const SemVer = require('../classes/semver')\nconst compareBuild = (a, b, loose) => {\n  const versionA = new SemVer(a, loose)\n  const versionB = new SemVer(b, loose)\n  return versionA.compare(versionB) || versionA.compareBuild(versionB)\n}\nmodule.exports = compareBuild\n","const compare = require('./compare')\nconst compareLoose = (a, b) => compare(a, b, true)\nmodule.exports = compareLoose\n","const SemVer = require('../classes/semver')\nconst compare = (a, b, loose) =>\n  new SemVer(a, loose).compare(new SemVer(b, loose))\n\nmodule.exports = compare\n","const parse = require('./parse.js')\n\nconst diff = (version1, version2) => {\n  const v1 = parse(version1, null, true)\n  const v2 = parse(version2, null, true)\n  const comparison = v1.compare(v2)\n\n  if (comparison === 0) {\n    return null\n  }\n\n  const v1Higher = comparison > 0\n  const highVersion = v1Higher ? v1 : v2\n  const lowVersion = v1Higher ? v2 : v1\n  const highHasPre = !!highVersion.prerelease.length\n  const lowHasPre = !!lowVersion.prerelease.length\n\n  if (lowHasPre && !highHasPre) {\n    // Going from prerelease -> no prerelease requires some special casing\n\n    // If the low version has only a major, then it will always be a major\n    // Some examples:\n    // 1.0.0-1 -> 1.0.0\n    // 1.0.0-1 -> 1.1.1\n    // 1.0.0-1 -> 2.0.0\n    if (!lowVersion.patch && !lowVersion.minor) {\n      return 'major'\n    }\n\n    // Otherwise it can be determined by checking the high version\n\n    if (highVersion.patch) {\n      // anything higher than a patch bump would result in the wrong version\n      return 'patch'\n    }\n\n    if (highVersion.minor) {\n      // anything higher than a minor bump would result in the wrong version\n      return 'minor'\n    }\n\n    // bumping major/minor/patch all have same result\n    return 'major'\n  }\n\n  // add the `pre` prefix if we are going to a prerelease version\n  const prefix = highHasPre ? 'pre' : ''\n\n  if (v1.major !== v2.major) {\n    return prefix + 'major'\n  }\n\n  if (v1.minor !== v2.minor) {\n    return prefix + 'minor'\n  }\n\n  if (v1.patch !== v2.patch) {\n    return prefix + 'patch'\n  }\n\n  // high and low are preleases\n  return 'prerelease'\n}\n\nmodule.exports = diff\n","const compare = require('./compare')\nconst eq = (a, b, loose) => compare(a, b, loose) === 0\nmodule.exports = eq\n","const compare = require('./compare')\nconst gt = (a, b, loose) => compare(a, b, loose) > 0\nmodule.exports = gt\n","const compare = require('./compare')\nconst gte = (a, b, loose) => compare(a, b, loose) >= 0\nmodule.exports = gte\n","const SemVer = require('../classes/semver')\n\nconst inc = (version, release, options, identifier, identifierBase) => {\n  if (typeof (options) === 'string') {\n    identifierBase = identifier\n    identifier = options\n    options = undefined\n  }\n\n  try {\n    return new SemVer(\n      version instanceof SemVer ? version.version : version,\n      options\n    ).inc(release, identifier, identifierBase).version\n  } catch (er) {\n    return null\n  }\n}\nmodule.exports = inc\n","const compare = require('./compare')\nconst lt = (a, b, loose) => compare(a, b, loose) < 0\nmodule.exports = lt\n","const compare = require('./compare')\nconst lte = (a, b, loose) => compare(a, b, loose) <= 0\nmodule.exports = lte\n","const SemVer = require('../classes/semver')\nconst major = (a, loose) => new SemVer(a, loose).major\nmodule.exports = major\n","const SemVer = require('../classes/semver')\nconst minor = (a, loose) => new SemVer(a, loose).minor\nmodule.exports = minor\n","const compare = require('./compare')\nconst neq = (a, b, loose) => compare(a, b, loose) !== 0\nmodule.exports = neq\n","const SemVer = require('../classes/semver')\nconst parse = (version, options, throwErrors = false) => {\n  if (version instanceof SemVer) {\n    return version\n  }\n  try {\n    return new SemVer(version, options)\n  } catch (er) {\n    if (!throwErrors) {\n      return null\n    }\n    throw er\n  }\n}\n\nmodule.exports = parse\n","const SemVer = require('../classes/semver')\nconst patch = (a, loose) => new SemVer(a, loose).patch\nmodule.exports = patch\n","const parse = require('./parse')\nconst prerelease = (version, options) => {\n  const parsed = parse(version, options)\n  return (parsed && parsed.prerelease.length) ? parsed.prerelease : null\n}\nmodule.exports = prerelease\n","const compare = require('./compare')\nconst rcompare = (a, b, loose) => compare(b, a, loose)\nmodule.exports = rcompare\n","const compareBuild = require('./compare-build')\nconst rsort = (list, loose) => list.sort((a, b) => compareBuild(b, a, loose))\nmodule.exports = rsort\n","const Range = require('../classes/range')\nconst satisfies = (version, range, options) => {\n  try {\n    range = new Range(range, options)\n  } catch (er) {\n    return false\n  }\n  return range.test(version)\n}\nmodule.exports = satisfies\n","const compareBuild = require('./compare-build')\nconst sort = (list, loose) => list.sort((a, b) => compareBuild(a, b, loose))\nmodule.exports = sort\n","const parse = require('./parse')\nconst valid = (version, options) => {\n  const v = parse(version, options)\n  return v ? v.version : null\n}\nmodule.exports = valid\n","// just pre-load all the stuff that index.js lazily exports\nconst internalRe = require('./internal/re')\nconst constants = require('./internal/constants')\nconst SemVer = require('./classes/semver')\nconst identifiers = require('./internal/identifiers')\nconst parse = require('./functions/parse')\nconst valid = require('./functions/valid')\nconst clean = require('./functions/clean')\nconst inc = require('./functions/inc')\nconst diff = require('./functions/diff')\nconst major = require('./functions/major')\nconst minor = require('./functions/minor')\nconst patch = require('./functions/patch')\nconst prerelease = require('./functions/prerelease')\nconst compare = require('./functions/compare')\nconst rcompare = require('./functions/rcompare')\nconst compareLoose = require('./functions/compare-loose')\nconst compareBuild = require('./functions/compare-build')\nconst sort = require('./functions/sort')\nconst rsort = require('./functions/rsort')\nconst gt = require('./functions/gt')\nconst lt = require('./functions/lt')\nconst eq = require('./functions/eq')\nconst neq = require('./functions/neq')\nconst gte = require('./functions/gte')\nconst lte = require('./functions/lte')\nconst cmp = require('./functions/cmp')\nconst coerce = require('./functions/coerce')\nconst Comparator = require('./classes/comparator')\nconst Range = require('./classes/range')\nconst satisfies = require('./functions/satisfies')\nconst toComparators = require('./ranges/to-comparators')\nconst maxSatisfying = require('./ranges/max-satisfying')\nconst minSatisfying = require('./ranges/min-satisfying')\nconst minVersion = require('./ranges/min-version')\nconst validRange = require('./ranges/valid')\nconst outside = require('./ranges/outside')\nconst gtr = require('./ranges/gtr')\nconst ltr = require('./ranges/ltr')\nconst intersects = require('./ranges/intersects')\nconst simplifyRange = require('./ranges/simplify')\nconst subset = require('./ranges/subset')\nmodule.exports = {\n  parse,\n  valid,\n  clean,\n  inc,\n  diff,\n  major,\n  minor,\n  patch,\n  prerelease,\n  compare,\n  rcompare,\n  compareLoose,\n  compareBuild,\n  sort,\n  rsort,\n  gt,\n  lt,\n  eq,\n  neq,\n  gte,\n  lte,\n  cmp,\n  coerce,\n  Comparator,\n  Range,\n  satisfies,\n  toComparators,\n  maxSatisfying,\n  minSatisfying,\n  minVersion,\n  validRange,\n  outside,\n  gtr,\n  ltr,\n  intersects,\n  simplifyRange,\n  subset,\n  SemVer,\n  re: internalRe.re,\n  src: internalRe.src,\n  tokens: internalRe.t,\n  SEMVER_SPEC_VERSION: constants.SEMVER_SPEC_VERSION,\n  RELEASE_TYPES: constants.RELEASE_TYPES,\n  compareIdentifiers: identifiers.compareIdentifiers,\n  rcompareIdentifiers: identifiers.rcompareIdentifiers,\n}\n","// Note: this is the semver.org version of the spec that it implements\n// Not necessarily the package version of this code.\nconst SEMVER_SPEC_VERSION = '2.0.0'\n\nconst MAX_LENGTH = 256\nconst MAX_SAFE_INTEGER = Number.MAX_SAFE_INTEGER ||\n/* istanbul ignore next */ 9007199254740991\n\n// Max safe segment length for coercion.\nconst MAX_SAFE_COMPONENT_LENGTH = 16\n\nconst RELEASE_TYPES = [\n  'major',\n  'premajor',\n  'minor',\n  'preminor',\n  'patch',\n  'prepatch',\n  'prerelease',\n]\n\nmodule.exports = {\n  MAX_LENGTH,\n  MAX_SAFE_COMPONENT_LENGTH,\n  MAX_SAFE_INTEGER,\n  RELEASE_TYPES,\n  SEMVER_SPEC_VERSION,\n  FLAG_INCLUDE_PRERELEASE: 0b001,\n  FLAG_LOOSE: 0b010,\n}\n","const debug = (\n  typeof process === 'object' &&\n  process.env &&\n  process.env.NODE_DEBUG &&\n  /\\bsemver\\b/i.test(process.env.NODE_DEBUG)\n) ? (...args) => console.error('SEMVER', ...args)\n  : () => {}\n\nmodule.exports = debug\n","const numeric = /^[0-9]+$/\nconst compareIdentifiers = (a, b) => {\n  const anum = numeric.test(a)\n  const bnum = numeric.test(b)\n\n  if (anum && bnum) {\n    a = +a\n    b = +b\n  }\n\n  return a === b ? 0\n    : (anum && !bnum) ? -1\n    : (bnum && !anum) ? 1\n    : a < b ? -1\n    : 1\n}\n\nconst rcompareIdentifiers = (a, b) => compareIdentifiers(b, a)\n\nmodule.exports = {\n  compareIdentifiers,\n  rcompareIdentifiers,\n}\n","// parse out just the options we care about\nconst looseOption = Object.freeze({ loose: true })\nconst emptyOpts = Object.freeze({ })\nconst parseOptions = options => {\n  if (!options) {\n    return emptyOpts\n  }\n\n  if (typeof options !== 'object') {\n    return looseOption\n  }\n\n  return options\n}\nmodule.exports = parseOptions\n","const { MAX_SAFE_COMPONENT_LENGTH } = require('./constants')\nconst debug = require('./debug')\nexports = module.exports = {}\n\n// The actual regexps go on exports.re\nconst re = exports.re = []\nconst safeRe = exports.safeRe = []\nconst src = exports.src = []\nconst t = exports.t = {}\nlet R = 0\n\nconst createToken = (name, value, isGlobal) => {\n  // Replace all greedy whitespace to prevent regex dos issues. These regex are\n  // used internally via the safeRe object since all inputs in this library get\n  // normalized first to trim and collapse all extra whitespace. The original\n  // regexes are exported for userland consumption and lower level usage. A\n  // future breaking change could export the safer regex only with a note that\n  // all input should have extra whitespace removed.\n  const safe = value\n    .split('\\\\s*').join('\\\\s{0,1}')\n    .split('\\\\s+').join('\\\\s')\n  const index = R++\n  debug(name, index, value)\n  t[name] = index\n  src[index] = value\n  re[index] = new RegExp(value, isGlobal ? 'g' : undefined)\n  safeRe[index] = new RegExp(safe, isGlobal ? 'g' : undefined)\n}\n\n// The following Regular Expressions can be used for tokenizing,\n// validating, and parsing SemVer version strings.\n\n// ## Numeric Identifier\n// A single `0`, or a non-zero digit followed by zero or more digits.\n\ncreateToken('NUMERICIDENTIFIER', '0|[1-9]\\\\d*')\ncreateToken('NUMERICIDENTIFIERLOOSE', '[0-9]+')\n\n// ## Non-numeric Identifier\n// Zero or more digits, followed by a letter or hyphen, and then zero or\n// more letters, digits, or hyphens.\n\ncreateToken('NONNUMERICIDENTIFIER', '\\\\d*[a-zA-Z-][a-zA-Z0-9-]*')\n\n// ## Main Version\n// Three dot-separated numeric identifiers.\n\ncreateToken('MAINVERSION', `(${src[t.NUMERICIDENTIFIER]})\\\\.` +\n                   `(${src[t.NUMERICIDENTIFIER]})\\\\.` +\n                   `(${src[t.NUMERICIDENTIFIER]})`)\n\ncreateToken('MAINVERSIONLOOSE', `(${src[t.NUMERICIDENTIFIERLOOSE]})\\\\.` +\n                        `(${src[t.NUMERICIDENTIFIERLOOSE]})\\\\.` +\n                        `(${src[t.NUMERICIDENTIFIERLOOSE]})`)\n\n// ## Pre-release Version Identifier\n// A numeric identifier, or a non-numeric identifier.\n\ncreateToken('PRERELEASEIDENTIFIER', `(?:${src[t.NUMERICIDENTIFIER]\n}|${src[t.NONNUMERICIDENTIFIER]})`)\n\ncreateToken('PRERELEASEIDENTIFIERLOOSE', `(?:${src[t.NUMERICIDENTIFIERLOOSE]\n}|${src[t.NONNUMERICIDENTIFIER]})`)\n\n// ## Pre-release Version\n// Hyphen, followed by one or more dot-separated pre-release version\n// identifiers.\n\ncreateToken('PRERELEASE', `(?:-(${src[t.PRERELEASEIDENTIFIER]\n}(?:\\\\.${src[t.PRERELEASEIDENTIFIER]})*))`)\n\ncreateToken('PRERELEASELOOSE', `(?:-?(${src[t.PRERELEASEIDENTIFIERLOOSE]\n}(?:\\\\.${src[t.PRERELEASEIDENTIFIERLOOSE]})*))`)\n\n// ## Build Metadata Identifier\n// Any combination of digits, letters, or hyphens.\n\ncreateToken('BUILDIDENTIFIER', '[0-9A-Za-z-]+')\n\n// ## Build Metadata\n// Plus sign, followed by one or more period-separated build metadata\n// identifiers.\n\ncreateToken('BUILD', `(?:\\\\+(${src[t.BUILDIDENTIFIER]\n}(?:\\\\.${src[t.BUILDIDENTIFIER]})*))`)\n\n// ## Full Version String\n// A main version, followed optionally by a pre-release version and\n// build metadata.\n\n// Note that the only major, minor, patch, and pre-release sections of\n// the version string are capturing groups.  The build metadata is not a\n// capturing group, because it should not ever be used in version\n// comparison.\n\ncreateToken('FULLPLAIN', `v?${src[t.MAINVERSION]\n}${src[t.PRERELEASE]}?${\n  src[t.BUILD]}?`)\n\ncreateToken('FULL', `^${src[t.FULLPLAIN]}$`)\n\n// like full, but allows v1.2.3 and =1.2.3, which people do sometimes.\n// also, 1.0.0alpha1 (prerelease without the hyphen) which is pretty\n// common in the npm registry.\ncreateToken('LOOSEPLAIN', `[v=\\\\s]*${src[t.MAINVERSIONLOOSE]\n}${src[t.PRERELEASELOOSE]}?${\n  src[t.BUILD]}?`)\n\ncreateToken('LOOSE', `^${src[t.LOOSEPLAIN]}$`)\n\ncreateToken('GTLT', '((?:<|>)?=?)')\n\n// Something like \"2.*\" or \"1.2.x\".\n// Note that \"x.x\" is a valid xRange identifer, meaning \"any version\"\n// Only the first item is strictly required.\ncreateToken('XRANGEIDENTIFIERLOOSE', `${src[t.NUMERICIDENTIFIERLOOSE]}|x|X|\\\\*`)\ncreateToken('XRANGEIDENTIFIER', `${src[t.NUMERICIDENTIFIER]}|x|X|\\\\*`)\n\ncreateToken('XRANGEPLAIN', `[v=\\\\s]*(${src[t.XRANGEIDENTIFIER]})` +\n                   `(?:\\\\.(${src[t.XRANGEIDENTIFIER]})` +\n                   `(?:\\\\.(${src[t.XRANGEIDENTIFIER]})` +\n                   `(?:${src[t.PRERELEASE]})?${\n                     src[t.BUILD]}?` +\n                   `)?)?`)\n\ncreateToken('XRANGEPLAINLOOSE', `[v=\\\\s]*(${src[t.XRANGEIDENTIFIERLOOSE]})` +\n                        `(?:\\\\.(${src[t.XRANGEIDENTIFIERLOOSE]})` +\n                        `(?:\\\\.(${src[t.XRANGEIDENTIFIERLOOSE]})` +\n                        `(?:${src[t.PRERELEASELOOSE]})?${\n                          src[t.BUILD]}?` +\n                        `)?)?`)\n\ncreateToken('XRANGE', `^${src[t.GTLT]}\\\\s*${src[t.XRANGEPLAIN]}$`)\ncreateToken('XRANGELOOSE', `^${src[t.GTLT]}\\\\s*${src[t.XRANGEPLAINLOOSE]}$`)\n\n// Coercion.\n// Extract anything that could conceivably be a part of a valid semver\ncreateToken('COERCE', `${'(^|[^\\\\d])' +\n              '(\\\\d{1,'}${MAX_SAFE_COMPONENT_LENGTH}})` +\n              `(?:\\\\.(\\\\d{1,${MAX_SAFE_COMPONENT_LENGTH}}))?` +\n              `(?:\\\\.(\\\\d{1,${MAX_SAFE_COMPONENT_LENGTH}}))?` +\n              `(?:$|[^\\\\d])`)\ncreateToken('COERCERTL', src[t.COERCE], true)\n\n// Tilde ranges.\n// Meaning is \"reasonably at or greater than\"\ncreateToken('LONETILDE', '(?:~>?)')\n\ncreateToken('TILDETRIM', `(\\\\s*)${src[t.LONETILDE]}\\\\s+`, true)\nexports.tildeTrimReplace = '$1~'\n\ncreateToken('TILDE', `^${src[t.LONETILDE]}${src[t.XRANGEPLAIN]}$`)\ncreateToken('TILDELOOSE', `^${src[t.LONETILDE]}${src[t.XRANGEPLAINLOOSE]}$`)\n\n// Caret ranges.\n// Meaning is \"at least and backwards compatible with\"\ncreateToken('LONECARET', '(?:\\\\^)')\n\ncreateToken('CARETTRIM', `(\\\\s*)${src[t.LONECARET]}\\\\s+`, true)\nexports.caretTrimReplace = '$1^'\n\ncreateToken('CARET', `^${src[t.LONECARET]}${src[t.XRANGEPLAIN]}$`)\ncreateToken('CARETLOOSE', `^${src[t.LONECARET]}${src[t.XRANGEPLAINLOOSE]}$`)\n\n// A simple gt/lt/eq thing, or just \"\" to indicate \"any version\"\ncreateToken('COMPARATORLOOSE', `^${src[t.GTLT]}\\\\s*(${src[t.LOOSEPLAIN]})$|^$`)\ncreateToken('COMPARATOR', `^${src[t.GTLT]}\\\\s*(${src[t.FULLPLAIN]})$|^$`)\n\n// An expression to strip any whitespace between the gtlt and the thing\n// it modifies, so that `> 1.2.3` ==> `>1.2.3`\ncreateToken('COMPARATORTRIM', `(\\\\s*)${src[t.GTLT]\n}\\\\s*(${src[t.LOOSEPLAIN]}|${src[t.XRANGEPLAIN]})`, true)\nexports.comparatorTrimReplace = '$1$2$3'\n\n// Something like `1.2.3 - 1.2.4`\n// Note that these all use the loose form, because they'll be\n// checked against either the strict or loose comparator form\n// later.\ncreateToken('HYPHENRANGE', `^\\\\s*(${src[t.XRANGEPLAIN]})` +\n                   `\\\\s+-\\\\s+` +\n                   `(${src[t.XRANGEPLAIN]})` +\n                   `\\\\s*$`)\n\ncreateToken('HYPHENRANGELOOSE', `^\\\\s*(${src[t.XRANGEPLAINLOOSE]})` +\n                        `\\\\s+-\\\\s+` +\n                        `(${src[t.XRANGEPLAINLOOSE]})` +\n                        `\\\\s*$`)\n\n// Star ranges basically just allow anything at all.\ncreateToken('STAR', '(<|>)?=?\\\\s*\\\\*')\n// >=0.0.0 is like a star\ncreateToken('GTE0', '^\\\\s*>=\\\\s*0\\\\.0\\\\.0\\\\s*$')\ncreateToken('GTE0PRE', '^\\\\s*>=\\\\s*0\\\\.0\\\\.0-0\\\\s*$')\n","// Determine if version is greater than all the versions possible in the range.\nconst outside = require('./outside')\nconst gtr = (version, range, options) => outside(version, range, '>', options)\nmodule.exports = gtr\n","const Range = require('../classes/range')\nconst intersects = (r1, r2, options) => {\n  r1 = new Range(r1, options)\n  r2 = new Range(r2, options)\n  return r1.intersects(r2, options)\n}\nmodule.exports = intersects\n","const outside = require('./outside')\n// Determine if version is less than all the versions possible in the range\nconst ltr = (version, range, options) => outside(version, range, '<', options)\nmodule.exports = ltr\n","const SemVer = require('../classes/semver')\nconst Range = require('../classes/range')\n\nconst maxSatisfying = (versions, range, options) => {\n  let max = null\n  let maxSV = null\n  let rangeObj = null\n  try {\n    rangeObj = new Range(range, options)\n  } catch (er) {\n    return null\n  }\n  versions.forEach((v) => {\n    if (rangeObj.test(v)) {\n      // satisfies(v, range, options)\n      if (!max || maxSV.compare(v) === -1) {\n        // compare(max, v, true)\n        max = v\n        maxSV = new SemVer(max, options)\n      }\n    }\n  })\n  return max\n}\nmodule.exports = maxSatisfying\n","const SemVer = require('../classes/semver')\nconst Range = require('../classes/range')\nconst minSatisfying = (versions, range, options) => {\n  let min = null\n  let minSV = null\n  let rangeObj = null\n  try {\n    rangeObj = new Range(range, options)\n  } catch (er) {\n    return null\n  }\n  versions.forEach((v) => {\n    if (rangeObj.test(v)) {\n      // satisfies(v, range, options)\n      if (!min || minSV.compare(v) === 1) {\n        // compare(min, v, true)\n        min = v\n        minSV = new SemVer(min, options)\n      }\n    }\n  })\n  return min\n}\nmodule.exports = minSatisfying\n","const SemVer = require('../classes/semver')\nconst Range = require('../classes/range')\nconst gt = require('../functions/gt')\n\nconst minVersion = (range, loose) => {\n  range = new Range(range, loose)\n\n  let minver = new SemVer('0.0.0')\n  if (range.test(minver)) {\n    return minver\n  }\n\n  minver = new SemVer('0.0.0-0')\n  if (range.test(minver)) {\n    return minver\n  }\n\n  minver = null\n  for (let i = 0; i < range.set.length; ++i) {\n    const comparators = range.set[i]\n\n    let setMin = null\n    comparators.forEach((comparator) => {\n      // Clone to avoid manipulating the comparator's semver object.\n      const compver = new SemVer(comparator.semver.version)\n      switch (comparator.operator) {\n        case '>':\n          if (compver.prerelease.length === 0) {\n            compver.patch++\n          } else {\n            compver.prerelease.push(0)\n          }\n          compver.raw = compver.format()\n          /* fallthrough */\n        case '':\n        case '>=':\n          if (!setMin || gt(compver, setMin)) {\n            setMin = compver\n          }\n          break\n        case '<':\n        case '<=':\n          /* Ignore maximum versions */\n          break\n        /* istanbul ignore next */\n        default:\n          throw new Error(`Unexpected operation: ${comparator.operator}`)\n      }\n    })\n    if (setMin && (!minver || gt(minver, setMin))) {\n      minver = setMin\n    }\n  }\n\n  if (minver && range.test(minver)) {\n    return minver\n  }\n\n  return null\n}\nmodule.exports = minVersion\n","const SemVer = require('../classes/semver')\nconst Comparator = require('../classes/comparator')\nconst { ANY } = Comparator\nconst Range = require('../classes/range')\nconst satisfies = require('../functions/satisfies')\nconst gt = require('../functions/gt')\nconst lt = require('../functions/lt')\nconst lte = require('../functions/lte')\nconst gte = require('../functions/gte')\n\nconst outside = (version, range, hilo, options) => {\n  version = new SemVer(version, options)\n  range = new Range(range, options)\n\n  let gtfn, ltefn, ltfn, comp, ecomp\n  switch (hilo) {\n    case '>':\n      gtfn = gt\n      ltefn = lte\n      ltfn = lt\n      comp = '>'\n      ecomp = '>='\n      break\n    case '<':\n      gtfn = lt\n      ltefn = gte\n      ltfn = gt\n      comp = '<'\n      ecomp = '<='\n      break\n    default:\n      throw new TypeError('Must provide a hilo val of \"<\" or \">\"')\n  }\n\n  // If it satisfies the range it is not outside\n  if (satisfies(version, range, options)) {\n    return false\n  }\n\n  // From now on, variable terms are as if we're in \"gtr\" mode.\n  // but note that everything is flipped for the \"ltr\" function.\n\n  for (let i = 0; i < range.set.length; ++i) {\n    const comparators = range.set[i]\n\n    let high = null\n    let low = null\n\n    comparators.forEach((comparator) => {\n      if (comparator.semver === ANY) {\n        comparator = new Comparator('>=0.0.0')\n      }\n      high = high || comparator\n      low = low || comparator\n      if (gtfn(comparator.semver, high.semver, options)) {\n        high = comparator\n      } else if (ltfn(comparator.semver, low.semver, options)) {\n        low = comparator\n      }\n    })\n\n    // If the edge version comparator has a operator then our version\n    // isn't outside it\n    if (high.operator === comp || high.operator === ecomp) {\n      return false\n    }\n\n    // If the lowest version comparator has an operator and our version\n    // is less than it then it isn't higher than the range\n    if ((!low.operator || low.operator === comp) &&\n        ltefn(version, low.semver)) {\n      return false\n    } else if (low.operator === ecomp && ltfn(version, low.semver)) {\n      return false\n    }\n  }\n  return true\n}\n\nmodule.exports = outside\n","// given a set of versions and a range, create a \"simplified\" range\n// that includes the same versions that the original range does\n// If the original range is shorter than the simplified one, return that.\nconst satisfies = require('../functions/satisfies.js')\nconst compare = require('../functions/compare.js')\nmodule.exports = (versions, range, options) => {\n  const set = []\n  let first = null\n  let prev = null\n  const v = versions.sort((a, b) => compare(a, b, options))\n  for (const version of v) {\n    const included = satisfies(version, range, options)\n    if (included) {\n      prev = version\n      if (!first) {\n        first = version\n      }\n    } else {\n      if (prev) {\n        set.push([first, prev])\n      }\n      prev = null\n      first = null\n    }\n  }\n  if (first) {\n    set.push([first, null])\n  }\n\n  const ranges = []\n  for (const [min, max] of set) {\n    if (min === max) {\n      ranges.push(min)\n    } else if (!max && min === v[0]) {\n      ranges.push('*')\n    } else if (!max) {\n      ranges.push(`>=${min}`)\n    } else if (min === v[0]) {\n      ranges.push(`<=${max}`)\n    } else {\n      ranges.push(`${min} - ${max}`)\n    }\n  }\n  const simplified = ranges.join(' || ')\n  const original = typeof range.raw === 'string' ? range.raw : String(range)\n  return simplified.length < original.length ? simplified : range\n}\n","const Range = require('../classes/range.js')\nconst Comparator = require('../classes/comparator.js')\nconst { ANY } = Comparator\nconst satisfies = require('../functions/satisfies.js')\nconst compare = require('../functions/compare.js')\n\n// Complex range `r1 || r2 || ...` is a subset of `R1 || R2 || ...` iff:\n// - Every simple range `r1, r2, ...` is a null set, OR\n// - Every simple range `r1, r2, ...` which is not a null set is a subset of\n//   some `R1, R2, ...`\n//\n// Simple range `c1 c2 ...` is a subset of simple range `C1 C2 ...` iff:\n// - If c is only the ANY comparator\n//   - If C is only the ANY comparator, return true\n//   - Else if in prerelease mode, return false\n//   - else replace c with `[>=0.0.0]`\n// - If C is only the ANY comparator\n//   - if in prerelease mode, return true\n//   - else replace C with `[>=0.0.0]`\n// - Let EQ be the set of = comparators in c\n// - If EQ is more than one, return true (null set)\n// - Let GT be the highest > or >= comparator in c\n// - Let LT be the lowest < or <= comparator in c\n// - If GT and LT, and GT.semver > LT.semver, return true (null set)\n// - If any C is a = range, and GT or LT are set, return false\n// - If EQ\n//   - If GT, and EQ does not satisfy GT, return true (null set)\n//   - If LT, and EQ does not satisfy LT, return true (null set)\n//   - If EQ satisfies every C, return true\n//   - Else return false\n// - If GT\n//   - If GT.semver is lower than any > or >= comp in C, return false\n//   - If GT is >=, and GT.semver does not satisfy every C, return false\n//   - If GT.semver has a prerelease, and not in prerelease mode\n//     - If no C has a prerelease and the GT.semver tuple, return false\n// - If LT\n//   - If LT.semver is greater than any < or <= comp in C, return false\n//   - If LT is <=, and LT.semver does not satisfy every C, return false\n//   - If GT.semver has a prerelease, and not in prerelease mode\n//     - If no C has a prerelease and the LT.semver tuple, return false\n// - Else return true\n\nconst subset = (sub, dom, options = {}) => {\n  if (sub === dom) {\n    return true\n  }\n\n  sub = new Range(sub, options)\n  dom = new Range(dom, options)\n  let sawNonNull = false\n\n  OUTER: for (const simpleSub of sub.set) {\n    for (const simpleDom of dom.set) {\n      const isSub = simpleSubset(simpleSub, simpleDom, options)\n      sawNonNull = sawNonNull || isSub !== null\n      if (isSub) {\n        continue OUTER\n      }\n    }\n    // the null set is a subset of everything, but null simple ranges in\n    // a complex range should be ignored.  so if we saw a non-null range,\n    // then we know this isn't a subset, but if EVERY simple range was null,\n    // then it is a subset.\n    if (sawNonNull) {\n      return false\n    }\n  }\n  return true\n}\n\nconst minimumVersionWithPreRelease = [new Comparator('>=0.0.0-0')]\nconst minimumVersion = [new Comparator('>=0.0.0')]\n\nconst simpleSubset = (sub, dom, options) => {\n  if (sub === dom) {\n    return true\n  }\n\n  if (sub.length === 1 && sub[0].semver === ANY) {\n    if (dom.length === 1 && dom[0].semver === ANY) {\n      return true\n    } else if (options.includePrerelease) {\n      sub = minimumVersionWithPreRelease\n    } else {\n      sub = minimumVersion\n    }\n  }\n\n  if (dom.length === 1 && dom[0].semver === ANY) {\n    if (options.includePrerelease) {\n      return true\n    } else {\n      dom = minimumVersion\n    }\n  }\n\n  const eqSet = new Set()\n  let gt, lt\n  for (const c of sub) {\n    if (c.operator === '>' || c.operator === '>=') {\n      gt = higherGT(gt, c, options)\n    } else if (c.operator === '<' || c.operator === '<=') {\n      lt = lowerLT(lt, c, options)\n    } else {\n      eqSet.add(c.semver)\n    }\n  }\n\n  if (eqSet.size > 1) {\n    return null\n  }\n\n  let gtltComp\n  if (gt && lt) {\n    gtltComp = compare(gt.semver, lt.semver, options)\n    if (gtltComp > 0) {\n      return null\n    } else if (gtltComp === 0 && (gt.operator !== '>=' || lt.operator !== '<=')) {\n      return null\n    }\n  }\n\n  // will iterate one or zero times\n  for (const eq of eqSet) {\n    if (gt && !satisfies(eq, String(gt), options)) {\n      return null\n    }\n\n    if (lt && !satisfies(eq, String(lt), options)) {\n      return null\n    }\n\n    for (const c of dom) {\n      if (!satisfies(eq, String(c), options)) {\n        return false\n      }\n    }\n\n    return true\n  }\n\n  let higher, lower\n  let hasDomLT, hasDomGT\n  // if the subset has a prerelease, we need a comparator in the superset\n  // with the same tuple and a prerelease, or it's not a subset\n  let needDomLTPre = lt &&\n    !options.includePrerelease &&\n    lt.semver.prerelease.length ? lt.semver : false\n  let needDomGTPre = gt &&\n    !options.includePrerelease &&\n    gt.semver.prerelease.length ? gt.semver : false\n  // exception: <1.2.3-0 is the same as <1.2.3\n  if (needDomLTPre && needDomLTPre.prerelease.length === 1 &&\n      lt.operator === '<' && needDomLTPre.prerelease[0] === 0) {\n    needDomLTPre = false\n  }\n\n  for (const c of dom) {\n    hasDomGT = hasDomGT || c.operator === '>' || c.operator === '>='\n    hasDomLT = hasDomLT || c.operator === '<' || c.operator === '<='\n    if (gt) {\n      if (needDomGTPre) {\n        if (c.semver.prerelease && c.semver.prerelease.length &&\n            c.semver.major === needDomGTPre.major &&\n            c.semver.minor === needDomGTPre.minor &&\n            c.semver.patch === needDomGTPre.patch) {\n          needDomGTPre = false\n        }\n      }\n      if (c.operator === '>' || c.operator === '>=') {\n        higher = higherGT(gt, c, options)\n        if (higher === c && higher !== gt) {\n          return false\n        }\n      } else if (gt.operator === '>=' && !satisfies(gt.semver, String(c), options)) {\n        return false\n      }\n    }\n    if (lt) {\n      if (needDomLTPre) {\n        if (c.semver.prerelease && c.semver.prerelease.length &&\n            c.semver.major === needDomLTPre.major &&\n            c.semver.minor === needDomLTPre.minor &&\n            c.semver.patch === needDomLTPre.patch) {\n          needDomLTPre = false\n        }\n      }\n      if (c.operator === '<' || c.operator === '<=') {\n        lower = lowerLT(lt, c, options)\n        if (lower === c && lower !== lt) {\n          return false\n        }\n      } else if (lt.operator === '<=' && !satisfies(lt.semver, String(c), options)) {\n        return false\n      }\n    }\n    if (!c.operator && (lt || gt) && gtltComp !== 0) {\n      return false\n    }\n  }\n\n  // if there was a < or >, and nothing in the dom, then must be false\n  // UNLESS it was limited by another range in the other direction.\n  // Eg, >1.0.0 <1.0.1 is still a subset of <2.0.0\n  if (gt && hasDomLT && !lt && gtltComp !== 0) {\n    return false\n  }\n\n  if (lt && hasDomGT && !gt && gtltComp !== 0) {\n    return false\n  }\n\n  // we needed a prerelease range in a specific tuple, but didn't get one\n  // then this isn't a subset.  eg >=1.2.3-pre is not a subset of >=1.0.0,\n  // because it includes prereleases in the 1.2.3 tuple\n  if (needDomGTPre || needDomLTPre) {\n    return false\n  }\n\n  return true\n}\n\n// >=1.2.3 is lower than >1.2.3\nconst higherGT = (a, b, options) => {\n  if (!a) {\n    return b\n  }\n  const comp = compare(a.semver, b.semver, options)\n  return comp > 0 ? a\n    : comp < 0 ? b\n    : b.operator === '>' && a.operator === '>=' ? b\n    : a\n}\n\n// <=1.2.3 is higher than <1.2.3\nconst lowerLT = (a, b, options) => {\n  if (!a) {\n    return b\n  }\n  const comp = compare(a.semver, b.semver, options)\n  return comp < 0 ? a\n    : comp > 0 ? b\n    : b.operator === '<' && a.operator === '<=' ? b\n    : a\n}\n\nmodule.exports = subset\n","const Range = require('../classes/range')\n\n// Mostly just for testing and legacy API reasons\nconst toComparators = (range, options) =>\n  new Range(range, options).set\n    .map(comp => comp.map(c => c.value).join(' ').trim().split(' '))\n\nmodule.exports = toComparators\n","const Range = require('../classes/range')\nconst validRange = (range, options) => {\n  try {\n    // Return '*' instead of '' so that truthiness works.\n    // This will throw if it's invalid anyway\n    return new Range(range, options).range || '*'\n  } catch (er) {\n    return null\n  }\n}\nmodule.exports = validRange\n","var LIB;LIB=(()=>{\"use strict\";var t={470:t=>{function e(t){if(\"string\"!=typeof t)throw new TypeError(\"Path must be a string. Received \"+JSON.stringify(t))}function r(t,e){for(var r,n=\"\",o=0,i=-1,a=0,h=0;h<=t.length;++h){if(h<t.length)r=t.charCodeAt(h);else{if(47===r)break;r=47}if(47===r){if(i===h-1||1===a);else if(i!==h-1&&2===a){if(n.length<2||2!==o||46!==n.charCodeAt(n.length-1)||46!==n.charCodeAt(n.length-2))if(n.length>2){var s=n.lastIndexOf(\"/\");if(s!==n.length-1){-1===s?(n=\"\",o=0):o=(n=n.slice(0,s)).length-1-n.lastIndexOf(\"/\"),i=h,a=0;continue}}else if(2===n.length||1===n.length){n=\"\",o=0,i=h,a=0;continue}e&&(n.length>0?n+=\"/..\":n=\"..\",o=2)}else n.length>0?n+=\"/\"+t.slice(i+1,h):n=t.slice(i+1,h),o=h-i-1;i=h,a=0}else 46===r&&-1!==a?++a:a=-1}return n}var n={resolve:function(){for(var t,n=\"\",o=!1,i=arguments.length-1;i>=-1&&!o;i--){var a;i>=0?a=arguments[i]:(void 0===t&&(t=process.cwd()),a=t),e(a),0!==a.length&&(n=a+\"/\"+n,o=47===a.charCodeAt(0))}return n=r(n,!o),o?n.length>0?\"/\"+n:\"/\":n.length>0?n:\".\"},normalize:function(t){if(e(t),0===t.length)return\".\";var n=47===t.charCodeAt(0),o=47===t.charCodeAt(t.length-1);return 0!==(t=r(t,!n)).length||n||(t=\".\"),t.length>0&&o&&(t+=\"/\"),n?\"/\"+t:t},isAbsolute:function(t){return e(t),t.length>0&&47===t.charCodeAt(0)},join:function(){if(0===arguments.length)return\".\";for(var t,r=0;r<arguments.length;++r){var o=arguments[r];e(o),o.length>0&&(void 0===t?t=o:t+=\"/\"+o)}return void 0===t?\".\":n.normalize(t)},relative:function(t,r){if(e(t),e(r),t===r)return\"\";if((t=n.resolve(t))===(r=n.resolve(r)))return\"\";for(var o=1;o<t.length&&47===t.charCodeAt(o);++o);for(var i=t.length,a=i-o,h=1;h<r.length&&47===r.charCodeAt(h);++h);for(var s=r.length-h,c=a<s?a:s,f=-1,u=0;u<=c;++u){if(u===c){if(s>c){if(47===r.charCodeAt(h+u))return r.slice(h+u+1);if(0===u)return r.slice(h+u)}else a>c&&(47===t.charCodeAt(o+u)?f=u:0===u&&(f=0));break}var l=t.charCodeAt(o+u);if(l!==r.charCodeAt(h+u))break;47===l&&(f=u)}var p=\"\";for(u=o+f+1;u<=i;++u)u!==i&&47!==t.charCodeAt(u)||(0===p.length?p+=\"..\":p+=\"/..\");return p.length>0?p+r.slice(h+f):(h+=f,47===r.charCodeAt(h)&&++h,r.slice(h))},_makeLong:function(t){return t},dirname:function(t){if(e(t),0===t.length)return\".\";for(var r=t.charCodeAt(0),n=47===r,o=-1,i=!0,a=t.length-1;a>=1;--a)if(47===(r=t.charCodeAt(a))){if(!i){o=a;break}}else i=!1;return-1===o?n?\"/\":\".\":n&&1===o?\"//\":t.slice(0,o)},basename:function(t,r){if(void 0!==r&&\"string\"!=typeof r)throw new TypeError('\"ext\" argument must be a string');e(t);var n,o=0,i=-1,a=!0;if(void 0!==r&&r.length>0&&r.length<=t.length){if(r.length===t.length&&r===t)return\"\";var h=r.length-1,s=-1;for(n=t.length-1;n>=0;--n){var c=t.charCodeAt(n);if(47===c){if(!a){o=n+1;break}}else-1===s&&(a=!1,s=n+1),h>=0&&(c===r.charCodeAt(h)?-1==--h&&(i=n):(h=-1,i=s))}return o===i?i=s:-1===i&&(i=t.length),t.slice(o,i)}for(n=t.length-1;n>=0;--n)if(47===t.charCodeAt(n)){if(!a){o=n+1;break}}else-1===i&&(a=!1,i=n+1);return-1===i?\"\":t.slice(o,i)},extname:function(t){e(t);for(var r=-1,n=0,o=-1,i=!0,a=0,h=t.length-1;h>=0;--h){var s=t.charCodeAt(h);if(47!==s)-1===o&&(i=!1,o=h+1),46===s?-1===r?r=h:1!==a&&(a=1):-1!==r&&(a=-1);else if(!i){n=h+1;break}}return-1===r||-1===o||0===a||1===a&&r===o-1&&r===n+1?\"\":t.slice(r,o)},format:function(t){if(null===t||\"object\"!=typeof t)throw new TypeError('The \"pathObject\" argument must be of type Object. Received type '+typeof t);return function(t,e){var r=e.dir||e.root,n=e.base||(e.name||\"\")+(e.ext||\"\");return r?r===e.root?r+n:r+\"/\"+n:n}(0,t)},parse:function(t){e(t);var r={root:\"\",dir:\"\",base:\"\",ext:\"\",name:\"\"};if(0===t.length)return r;var n,o=t.charCodeAt(0),i=47===o;i?(r.root=\"/\",n=1):n=0;for(var a=-1,h=0,s=-1,c=!0,f=t.length-1,u=0;f>=n;--f)if(47!==(o=t.charCodeAt(f)))-1===s&&(c=!1,s=f+1),46===o?-1===a?a=f:1!==u&&(u=1):-1!==a&&(u=-1);else if(!c){h=f+1;break}return-1===a||-1===s||0===u||1===u&&a===s-1&&a===h+1?-1!==s&&(r.base=r.name=0===h&&i?t.slice(1,s):t.slice(h,s)):(0===h&&i?(r.name=t.slice(1,a),r.base=t.slice(1,s)):(r.name=t.slice(h,a),r.base=t.slice(h,s)),r.ext=t.slice(a,s)),h>0?r.dir=t.slice(0,h-1):i&&(r.dir=\"/\"),r},sep:\"/\",delimiter:\":\",win32:null,posix:null};n.posix=n,t.exports=n},447:(t,e,r)=>{var n;if(r.r(e),r.d(e,{URI:()=>d,Utils:()=>P}),\"object\"==typeof process)n=\"win32\"===process.platform;else if(\"object\"==typeof navigator){var o=navigator.userAgent;n=o.indexOf(\"Windows\")>=0}var i,a,h=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Class extends value \"+String(e)+\" is not a constructor or null\");function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=/^\\w[\\w\\d+.-]*$/,c=/^\\//,f=/^\\/\\//;function u(t,e){if(!t.scheme&&e)throw new Error('[UriError]: Scheme is missing: {scheme: \"\", authority: \"'.concat(t.authority,'\", path: \"').concat(t.path,'\", query: \"').concat(t.query,'\", fragment: \"').concat(t.fragment,'\"}'));if(t.scheme&&!s.test(t.scheme))throw new Error(\"[UriError]: Scheme contains illegal characters.\");if(t.path)if(t.authority){if(!c.test(t.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash (\"/\") character')}else if(f.test(t.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters (\"//\")')}var l=\"\",p=\"/\",g=/^(([^:/?#]+?):)?(\\/\\/([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?/,d=function(){function t(t,e,r,n,o,i){void 0===i&&(i=!1),\"object\"==typeof t?(this.scheme=t.scheme||l,this.authority=t.authority||l,this.path=t.path||l,this.query=t.query||l,this.fragment=t.fragment||l):(this.scheme=function(t,e){return t||e?t:\"file\"}(t,i),this.authority=e||l,this.path=function(t,e){switch(t){case\"https\":case\"http\":case\"file\":e?e[0]!==p&&(e=p+e):e=p}return e}(this.scheme,r||l),this.query=n||l,this.fragment=o||l,u(this,i))}return t.isUri=function(e){return e instanceof t||!!e&&\"string\"==typeof e.authority&&\"string\"==typeof e.fragment&&\"string\"==typeof e.path&&\"string\"==typeof e.query&&\"string\"==typeof e.scheme&&\"string\"==typeof e.fsPath&&\"function\"==typeof e.with&&\"function\"==typeof e.toString},Object.defineProperty(t.prototype,\"fsPath\",{get:function(){return A(this,!1)},enumerable:!1,configurable:!0}),t.prototype.with=function(t){if(!t)return this;var e=t.scheme,r=t.authority,n=t.path,o=t.query,i=t.fragment;return void 0===e?e=this.scheme:null===e&&(e=l),void 0===r?r=this.authority:null===r&&(r=l),void 0===n?n=this.path:null===n&&(n=l),void 0===o?o=this.query:null===o&&(o=l),void 0===i?i=this.fragment:null===i&&(i=l),e===this.scheme&&r===this.authority&&n===this.path&&o===this.query&&i===this.fragment?this:new y(e,r,n,o,i)},t.parse=function(t,e){void 0===e&&(e=!1);var r=g.exec(t);return r?new y(r[2]||l,O(r[4]||l),O(r[5]||l),O(r[7]||l),O(r[9]||l),e):new y(l,l,l,l,l)},t.file=function(t){var e=l;if(n&&(t=t.replace(/\\\\/g,p)),t[0]===p&&t[1]===p){var r=t.indexOf(p,2);-1===r?(e=t.substring(2),t=p):(e=t.substring(2,r),t=t.substring(r)||p)}return new y(\"file\",e,t,l,l)},t.from=function(t){var e=new y(t.scheme,t.authority,t.path,t.query,t.fragment);return u(e,!0),e},t.prototype.toString=function(t){return void 0===t&&(t=!1),w(this,t)},t.prototype.toJSON=function(){return this},t.revive=function(e){if(e){if(e instanceof t)return e;var r=new y(e);return r._formatted=e.external,r._fsPath=e._sep===v?e.fsPath:null,r}return e},t}(),v=n?1:void 0,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._formatted=null,e._fsPath=null,e}return h(e,t),Object.defineProperty(e.prototype,\"fsPath\",{get:function(){return this._fsPath||(this._fsPath=A(this,!1)),this._fsPath},enumerable:!1,configurable:!0}),e.prototype.toString=function(t){return void 0===t&&(t=!1),t?w(this,!0):(this._formatted||(this._formatted=w(this,!1)),this._formatted)},e.prototype.toJSON=function(){var t={$mid:1};return this._fsPath&&(t.fsPath=this._fsPath,t._sep=v),this._formatted&&(t.external=this._formatted),this.path&&(t.path=this.path),this.scheme&&(t.scheme=this.scheme),this.authority&&(t.authority=this.authority),this.query&&(t.query=this.query),this.fragment&&(t.fragment=this.fragment),t},e}(d),m=((a={})[58]=\"%3A\",a[47]=\"%2F\",a[63]=\"%3F\",a[35]=\"%23\",a[91]=\"%5B\",a[93]=\"%5D\",a[64]=\"%40\",a[33]=\"%21\",a[36]=\"%24\",a[38]=\"%26\",a[39]=\"%27\",a[40]=\"%28\",a[41]=\"%29\",a[42]=\"%2A\",a[43]=\"%2B\",a[44]=\"%2C\",a[59]=\"%3B\",a[61]=\"%3D\",a[32]=\"%20\",a);function b(t,e){for(var r=void 0,n=-1,o=0;o<t.length;o++){var i=t.charCodeAt(o);if(i>=97&&i<=122||i>=65&&i<=90||i>=48&&i<=57||45===i||46===i||95===i||126===i||e&&47===i)-1!==n&&(r+=encodeURIComponent(t.substring(n,o)),n=-1),void 0!==r&&(r+=t.charAt(o));else{void 0===r&&(r=t.substr(0,o));var a=m[i];void 0!==a?(-1!==n&&(r+=encodeURIComponent(t.substring(n,o)),n=-1),r+=a):-1===n&&(n=o)}}return-1!==n&&(r+=encodeURIComponent(t.substring(n))),void 0!==r?r:t}function C(t){for(var e=void 0,r=0;r<t.length;r++){var n=t.charCodeAt(r);35===n||63===n?(void 0===e&&(e=t.substr(0,r)),e+=m[n]):void 0!==e&&(e+=t[r])}return void 0!==e?e:t}function A(t,e){var r;return r=t.authority&&t.path.length>1&&\"file\"===t.scheme?\"//\".concat(t.authority).concat(t.path):47===t.path.charCodeAt(0)&&(t.path.charCodeAt(1)>=65&&t.path.charCodeAt(1)<=90||t.path.charCodeAt(1)>=97&&t.path.charCodeAt(1)<=122)&&58===t.path.charCodeAt(2)?e?t.path.substr(1):t.path[1].toLowerCase()+t.path.substr(2):t.path,n&&(r=r.replace(/\\//g,\"\\\\\")),r}function w(t,e){var r=e?C:b,n=\"\",o=t.scheme,i=t.authority,a=t.path,h=t.query,s=t.fragment;if(o&&(n+=o,n+=\":\"),(i||\"file\"===o)&&(n+=p,n+=p),i){var c=i.indexOf(\"@\");if(-1!==c){var f=i.substr(0,c);i=i.substr(c+1),-1===(c=f.indexOf(\":\"))?n+=r(f,!1):(n+=r(f.substr(0,c),!1),n+=\":\",n+=r(f.substr(c+1),!1)),n+=\"@\"}-1===(c=(i=i.toLowerCase()).indexOf(\":\"))?n+=r(i,!1):(n+=r(i.substr(0,c),!1),n+=i.substr(c))}if(a){if(a.length>=3&&47===a.charCodeAt(0)&&58===a.charCodeAt(2))(u=a.charCodeAt(1))>=65&&u<=90&&(a=\"/\".concat(String.fromCharCode(u+32),\":\").concat(a.substr(3)));else if(a.length>=2&&58===a.charCodeAt(1)){var u;(u=a.charCodeAt(0))>=65&&u<=90&&(a=\"\".concat(String.fromCharCode(u+32),\":\").concat(a.substr(2)))}n+=r(a,!0)}return h&&(n+=\"?\",n+=r(h,!1)),s&&(n+=\"#\",n+=e?s:b(s,!1)),n}function x(t){try{return decodeURIComponent(t)}catch(e){return t.length>3?t.substr(0,3)+x(t.substr(3)):t}}var _=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function O(t){return t.match(_)?t.replace(_,(function(t){return x(t)})):t}var P,j=r(470),U=function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))},I=j.posix||j;!function(t){t.joinPath=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return t.with({path:I.join.apply(I,U([t.path],e,!1))})},t.resolvePath=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=t.path||\"/\";return t.with({path:I.resolve.apply(I,U([n],e,!1))})},t.dirname=function(t){var e=I.dirname(t.path);return 1===e.length&&46===e.charCodeAt(0)?t:t.with({path:e})},t.basename=function(t){return I.basename(t.path)},t.extname=function(t){return I.extname(t.path)}}(P||(P={}))}},e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={exports:{}};return t[n](o,o.exports,r),o.exports}return r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},r(447)})();export const{URI,Utils}=LIB;\n//# sourceMappingURL=index.js.map","'use strict'\nmodule.exports = function (Yallist) {\n  Yallist.prototype[Symbol.iterator] = function* () {\n    for (let walker = this.head; walker; walker = walker.next) {\n      yield walker.value\n    }\n  }\n}\n","'use strict'\nmodule.exports = Yallist\n\nYallist.Node = Node\nYallist.create = Yallist\n\nfunction Yallist (list) {\n  var self = this\n  if (!(self instanceof Yallist)) {\n    self = new Yallist()\n  }\n\n  self.tail = null\n  self.head = null\n  self.length = 0\n\n  if (list && typeof list.forEach === 'function') {\n    list.forEach(function (item) {\n      self.push(item)\n    })\n  } else if (arguments.length > 0) {\n    for (var i = 0, l = arguments.length; i < l; i++) {\n      self.push(arguments[i])\n    }\n  }\n\n  return self\n}\n\nYallist.prototype.removeNode = function (node) {\n  if (node.list !== this) {\n    throw new Error('removing node which does not belong to this list')\n  }\n\n  var next = node.next\n  var prev = node.prev\n\n  if (next) {\n    next.prev = prev\n  }\n\n  if (prev) {\n    prev.next = next\n  }\n\n  if (node === this.head) {\n    this.head = next\n  }\n  if (node === this.tail) {\n    this.tail = prev\n  }\n\n  node.list.length--\n  node.next = null\n  node.prev = null\n  node.list = null\n\n  return next\n}\n\nYallist.prototype.unshiftNode = function (node) {\n  if (node === this.head) {\n    return\n  }\n\n  if (node.list) {\n    node.list.removeNode(node)\n  }\n\n  var head = this.head\n  node.list = this\n  node.next = head\n  if (head) {\n    head.prev = node\n  }\n\n  this.head = node\n  if (!this.tail) {\n    this.tail = node\n  }\n  this.length++\n}\n\nYallist.prototype.pushNode = function (node) {\n  if (node === this.tail) {\n    return\n  }\n\n  if (node.list) {\n    node.list.removeNode(node)\n  }\n\n  var tail = this.tail\n  node.list = this\n  node.prev = tail\n  if (tail) {\n    tail.next = node\n  }\n\n  this.tail = node\n  if (!this.head) {\n    this.head = node\n  }\n  this.length++\n}\n\nYallist.prototype.push = function () {\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    push(this, arguments[i])\n  }\n  return this.length\n}\n\nYallist.prototype.unshift = function () {\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    unshift(this, arguments[i])\n  }\n  return this.length\n}\n\nYallist.prototype.pop = function () {\n  if (!this.tail) {\n    return undefined\n  }\n\n  var res = this.tail.value\n  this.tail = this.tail.prev\n  if (this.tail) {\n    this.tail.next = null\n  } else {\n    this.head = null\n  }\n  this.length--\n  return res\n}\n\nYallist.prototype.shift = function () {\n  if (!this.head) {\n    return undefined\n  }\n\n  var res = this.head.value\n  this.head = this.head.next\n  if (this.head) {\n    this.head.prev = null\n  } else {\n    this.tail = null\n  }\n  this.length--\n  return res\n}\n\nYallist.prototype.forEach = function (fn, thisp) {\n  thisp = thisp || this\n  for (var walker = this.head, i = 0; walker !== null; i++) {\n    fn.call(thisp, walker.value, i, this)\n    walker = walker.next\n  }\n}\n\nYallist.prototype.forEachReverse = function (fn, thisp) {\n  thisp = thisp || this\n  for (var walker = this.tail, i = this.length - 1; walker !== null; i--) {\n    fn.call(thisp, walker.value, i, this)\n    walker = walker.prev\n  }\n}\n\nYallist.prototype.get = function (n) {\n  for (var i = 0, walker = this.head; walker !== null && i < n; i++) {\n    // abort out of the list early if we hit a cycle\n    walker = walker.next\n  }\n  if (i === n && walker !== null) {\n    return walker.value\n  }\n}\n\nYallist.prototype.getReverse = function (n) {\n  for (var i = 0, walker = this.tail; walker !== null && i < n; i++) {\n    // abort out of the list early if we hit a cycle\n    walker = walker.prev\n  }\n  if (i === n && walker !== null) {\n    return walker.value\n  }\n}\n\nYallist.prototype.map = function (fn, thisp) {\n  thisp = thisp || this\n  var res = new Yallist()\n  for (var walker = this.head; walker !== null;) {\n    res.push(fn.call(thisp, walker.value, this))\n    walker = walker.next\n  }\n  return res\n}\n\nYallist.prototype.mapReverse = function (fn, thisp) {\n  thisp = thisp || this\n  var res = new Yallist()\n  for (var walker = this.tail; walker !== null;) {\n    res.push(fn.call(thisp, walker.value, this))\n    walker = walker.prev\n  }\n  return res\n}\n\nYallist.prototype.reduce = function (fn, initial) {\n  var acc\n  var walker = this.head\n  if (arguments.length > 1) {\n    acc = initial\n  } else if (this.head) {\n    walker = this.head.next\n    acc = this.head.value\n  } else {\n    throw new TypeError('Reduce of empty list with no initial value')\n  }\n\n  for (var i = 0; walker !== null; i++) {\n    acc = fn(acc, walker.value, i)\n    walker = walker.next\n  }\n\n  return acc\n}\n\nYallist.prototype.reduceReverse = function (fn, initial) {\n  var acc\n  var walker = this.tail\n  if (arguments.length > 1) {\n    acc = initial\n  } else if (this.tail) {\n    walker = this.tail.prev\n    acc = this.tail.value\n  } else {\n    throw new TypeError('Reduce of empty list with no initial value')\n  }\n\n  for (var i = this.length - 1; walker !== null; i--) {\n    acc = fn(acc, walker.value, i)\n    walker = walker.prev\n  }\n\n  return acc\n}\n\nYallist.prototype.toArray = function () {\n  var arr = new Array(this.length)\n  for (var i = 0, walker = this.head; walker !== null; i++) {\n    arr[i] = walker.value\n    walker = walker.next\n  }\n  return arr\n}\n\nYallist.prototype.toArrayReverse = function () {\n  var arr = new Array(this.length)\n  for (var i = 0, walker = this.tail; walker !== null; i++) {\n    arr[i] = walker.value\n    walker = walker.prev\n  }\n  return arr\n}\n\nYallist.prototype.slice = function (from, to) {\n  to = to || this.length\n  if (to < 0) {\n    to += this.length\n  }\n  from = from || 0\n  if (from < 0) {\n    from += this.length\n  }\n  var ret = new Yallist()\n  if (to < from || to < 0) {\n    return ret\n  }\n  if (from < 0) {\n    from = 0\n  }\n  if (to > this.length) {\n    to = this.length\n  }\n  for (var i = 0, walker = this.head; walker !== null && i < from; i++) {\n    walker = walker.next\n  }\n  for (; walker !== null && i < to; i++, walker = walker.next) {\n    ret.push(walker.value)\n  }\n  return ret\n}\n\nYallist.prototype.sliceReverse = function (from, to) {\n  to = to || this.length\n  if (to < 0) {\n    to += this.length\n  }\n  from = from || 0\n  if (from < 0) {\n    from += this.length\n  }\n  var ret = new Yallist()\n  if (to < from || to < 0) {\n    return ret\n  }\n  if (from < 0) {\n    from = 0\n  }\n  if (to > this.length) {\n    to = this.length\n  }\n  for (var i = this.length, walker = this.tail; walker !== null && i > to; i--) {\n    walker = walker.prev\n  }\n  for (; walker !== null && i > from; i--, walker = walker.prev) {\n    ret.push(walker.value)\n  }\n  return ret\n}\n\nYallist.prototype.splice = function (start, deleteCount, ...nodes) {\n  if (start > this.length) {\n    start = this.length - 1\n  }\n  if (start < 0) {\n    start = this.length + start;\n  }\n\n  for (var i = 0, walker = this.head; walker !== null && i < start; i++) {\n    walker = walker.next\n  }\n\n  var ret = []\n  for (var i = 0; walker && i < deleteCount; i++) {\n    ret.push(walker.value)\n    walker = this.removeNode(walker)\n  }\n  if (walker === null) {\n    walker = this.tail\n  }\n\n  if (walker !== this.head && walker !== this.tail) {\n    walker = walker.prev\n  }\n\n  for (var i = 0; i < nodes.length; i++) {\n    walker = insert(this, walker, nodes[i])\n  }\n  return ret;\n}\n\nYallist.prototype.reverse = function () {\n  var head = this.head\n  var tail = this.tail\n  for (var walker = head; walker !== null; walker = walker.prev) {\n    var p = walker.prev\n    walker.prev = walker.next\n    walker.next = p\n  }\n  this.head = tail\n  this.tail = head\n  return this\n}\n\nfunction insert (self, node, value) {\n  var inserted = node === self.head ?\n    new Node(value, null, node, self) :\n    new Node(value, node, node.next, self)\n\n  if (inserted.next === null) {\n    self.tail = inserted\n  }\n  if (inserted.prev === null) {\n    self.head = inserted\n  }\n\n  self.length++\n\n  return inserted\n}\n\nfunction push (self, item) {\n  self.tail = new Node(item, self.tail, null, self)\n  if (!self.head) {\n    self.head = self.tail\n  }\n  self.length++\n}\n\nfunction unshift (self, item) {\n  self.head = new Node(item, null, self.head, self)\n  if (!self.tail) {\n    self.tail = self.head\n  }\n  self.length++\n}\n\nfunction Node (value, prev, next, list) {\n  if (!(this instanceof Node)) {\n    return new Node(value, prev, next, list)\n  }\n\n  this.list = list\n  this.value = value\n\n  if (prev) {\n    prev.next = this\n    this.prev = prev\n  } else {\n    this.prev = null\n  }\n\n  if (next) {\n    next.prev = this\n    this.next = next\n  } else {\n    this.next = null\n  }\n}\n\ntry {\n  // add if support for Symbol.iterator is present\n  require('./iterator.js')(Yallist)\n} catch (er) {}\n","module.exports = require('os');\n","// 'path' module extracted from Node.js v8.11.1 (only the posix part)\n// transplited with Babel\n\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nfunction assertPath(path) {\n  if (typeof path !== 'string') {\n    throw new TypeError('Path must be a string. Received ' + JSON.stringify(path));\n  }\n}\n\n// Resolves . and .. elements in a path with directory names\nfunction normalizeStringPosix(path, allowAboveRoot) {\n  var res = '';\n  var lastSegmentLength = 0;\n  var lastSlash = -1;\n  var dots = 0;\n  var code;\n  for (var i = 0; i <= path.length; ++i) {\n    if (i < path.length)\n      code = path.charCodeAt(i);\n    else if (code === 47 /*/*/)\n      break;\n    else\n      code = 47 /*/*/;\n    if (code === 47 /*/*/) {\n      if (lastSlash === i - 1 || dots === 1) {\n        // NOOP\n      } else if (lastSlash !== i - 1 && dots === 2) {\n        if (res.length < 2 || lastSegmentLength !== 2 || res.charCodeAt(res.length - 1) !== 46 /*.*/ || res.charCodeAt(res.length - 2) !== 46 /*.*/) {\n          if (res.length > 2) {\n            var lastSlashIndex = res.lastIndexOf('/');\n            if (lastSlashIndex !== res.length - 1) {\n              if (lastSlashIndex === -1) {\n                res = '';\n                lastSegmentLength = 0;\n              } else {\n                res = res.slice(0, lastSlashIndex);\n                lastSegmentLength = res.length - 1 - res.lastIndexOf('/');\n              }\n              lastSlash = i;\n              dots = 0;\n              continue;\n            }\n          } else if (res.length === 2 || res.length === 1) {\n            res = '';\n            lastSegmentLength = 0;\n            lastSlash = i;\n            dots = 0;\n            continue;\n          }\n        }\n        if (allowAboveRoot) {\n          if (res.length > 0)\n            res += '/..';\n          else\n            res = '..';\n          lastSegmentLength = 2;\n        }\n      } else {\n        if (res.length > 0)\n          res += '/' + path.slice(lastSlash + 1, i);\n        else\n          res = path.slice(lastSlash + 1, i);\n        lastSegmentLength = i - lastSlash - 1;\n      }\n      lastSlash = i;\n      dots = 0;\n    } else if (code === 46 /*.*/ && dots !== -1) {\n      ++dots;\n    } else {\n      dots = -1;\n    }\n  }\n  return res;\n}\n\nfunction _format(sep, pathObject) {\n  var dir = pathObject.dir || pathObject.root;\n  var base = pathObject.base || (pathObject.name || '') + (pathObject.ext || '');\n  if (!dir) {\n    return base;\n  }\n  if (dir === pathObject.root) {\n    return dir + base;\n  }\n  return dir + sep + base;\n}\n\nvar posix = {\n  // path.resolve([from ...], to)\n  resolve: function resolve() {\n    var resolvedPath = '';\n    var resolvedAbsolute = false;\n    var cwd;\n\n    for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n      var path;\n      if (i >= 0)\n        path = arguments[i];\n      else {\n        if (cwd === undefined)\n          cwd = process.cwd();\n        path = cwd;\n      }\n\n      assertPath(path);\n\n      // Skip empty entries\n      if (path.length === 0) {\n        continue;\n      }\n\n      resolvedPath = path + '/' + resolvedPath;\n      resolvedAbsolute = path.charCodeAt(0) === 47 /*/*/;\n    }\n\n    // At this point the path should be resolved to a full absolute path, but\n    // handle relative paths to be safe (might happen when process.cwd() fails)\n\n    // Normalize the path\n    resolvedPath = normalizeStringPosix(resolvedPath, !resolvedAbsolute);\n\n    if (resolvedAbsolute) {\n      if (resolvedPath.length > 0)\n        return '/' + resolvedPath;\n      else\n        return '/';\n    } else if (resolvedPath.length > 0) {\n      return resolvedPath;\n    } else {\n      return '.';\n    }\n  },\n\n  normalize: function normalize(path) {\n    assertPath(path);\n\n    if (path.length === 0) return '.';\n\n    var isAbsolute = path.charCodeAt(0) === 47 /*/*/;\n    var trailingSeparator = path.charCodeAt(path.length - 1) === 47 /*/*/;\n\n    // Normalize the path\n    path = normalizeStringPosix(path, !isAbsolute);\n\n    if (path.length === 0 && !isAbsolute) path = '.';\n    if (path.length > 0 && trailingSeparator) path += '/';\n\n    if (isAbsolute) return '/' + path;\n    return path;\n  },\n\n  isAbsolute: function isAbsolute(path) {\n    assertPath(path);\n    return path.length > 0 && path.charCodeAt(0) === 47 /*/*/;\n  },\n\n  join: function join() {\n    if (arguments.length === 0)\n      return '.';\n    var joined;\n    for (var i = 0; i < arguments.length; ++i) {\n      var arg = arguments[i];\n      assertPath(arg);\n      if (arg.length > 0) {\n        if (joined === undefined)\n          joined = arg;\n        else\n          joined += '/' + arg;\n      }\n    }\n    if (joined === undefined)\n      return '.';\n    return posix.normalize(joined);\n  },\n\n  relative: function relative(from, to) {\n    assertPath(from);\n    assertPath(to);\n\n    if (from === to) return '';\n\n    from = posix.resolve(from);\n    to = posix.resolve(to);\n\n    if (from === to) return '';\n\n    // Trim any leading backslashes\n    var fromStart = 1;\n    for (; fromStart < from.length; ++fromStart) {\n      if (from.charCodeAt(fromStart) !== 47 /*/*/)\n        break;\n    }\n    var fromEnd = from.length;\n    var fromLen = fromEnd - fromStart;\n\n    // Trim any leading backslashes\n    var toStart = 1;\n    for (; toStart < to.length; ++toStart) {\n      if (to.charCodeAt(toStart) !== 47 /*/*/)\n        break;\n    }\n    var toEnd = to.length;\n    var toLen = toEnd - toStart;\n\n    // Compare paths to find the longest common path from root\n    var length = fromLen < toLen ? fromLen : toLen;\n    var lastCommonSep = -1;\n    var i = 0;\n    for (; i <= length; ++i) {\n      if (i === length) {\n        if (toLen > length) {\n          if (to.charCodeAt(toStart + i) === 47 /*/*/) {\n            // We get here if `from` is the exact base path for `to`.\n            // For example: from='/foo/bar'; to='/foo/bar/baz'\n            return to.slice(toStart + i + 1);\n          } else if (i === 0) {\n            // We get here if `from` is the root\n            // For example: from='/'; to='/foo'\n            return to.slice(toStart + i);\n          }\n        } else if (fromLen > length) {\n          if (from.charCodeAt(fromStart + i) === 47 /*/*/) {\n            // We get here if `to` is the exact base path for `from`.\n            // For example: from='/foo/bar/baz'; to='/foo/bar'\n            lastCommonSep = i;\n          } else if (i === 0) {\n            // We get here if `to` is the root.\n            // For example: from='/foo'; to='/'\n            lastCommonSep = 0;\n          }\n        }\n        break;\n      }\n      var fromCode = from.charCodeAt(fromStart + i);\n      var toCode = to.charCodeAt(toStart + i);\n      if (fromCode !== toCode)\n        break;\n      else if (fromCode === 47 /*/*/)\n        lastCommonSep = i;\n    }\n\n    var out = '';\n    // Generate the relative path based on the path difference between `to`\n    // and `from`\n    for (i = fromStart + lastCommonSep + 1; i <= fromEnd; ++i) {\n      if (i === fromEnd || from.charCodeAt(i) === 47 /*/*/) {\n        if (out.length === 0)\n          out += '..';\n        else\n          out += '/..';\n      }\n    }\n\n    // Lastly, append the rest of the destination (`to`) path that comes after\n    // the common path parts\n    if (out.length > 0)\n      return out + to.slice(toStart + lastCommonSep);\n    else {\n      toStart += lastCommonSep;\n      if (to.charCodeAt(toStart) === 47 /*/*/)\n        ++toStart;\n      return to.slice(toStart);\n    }\n  },\n\n  _makeLong: function _makeLong(path) {\n    return path;\n  },\n\n  dirname: function dirname(path) {\n    assertPath(path);\n    if (path.length === 0) return '.';\n    var code = path.charCodeAt(0);\n    var hasRoot = code === 47 /*/*/;\n    var end = -1;\n    var matchedSlash = true;\n    for (var i = path.length - 1; i >= 1; --i) {\n      code = path.charCodeAt(i);\n      if (code === 47 /*/*/) {\n          if (!matchedSlash) {\n            end = i;\n            break;\n          }\n        } else {\n        // We saw the first non-path separator\n        matchedSlash = false;\n      }\n    }\n\n    if (end === -1) return hasRoot ? '/' : '.';\n    if (hasRoot && end === 1) return '//';\n    return path.slice(0, end);\n  },\n\n  basename: function basename(path, ext) {\n    if (ext !== undefined && typeof ext !== 'string') throw new TypeError('\"ext\" argument must be a string');\n    assertPath(path);\n\n    var start = 0;\n    var end = -1;\n    var matchedSlash = true;\n    var i;\n\n    if (ext !== undefined && ext.length > 0 && ext.length <= path.length) {\n      if (ext.length === path.length && ext === path) return '';\n      var extIdx = ext.length - 1;\n      var firstNonSlashEnd = -1;\n      for (i = path.length - 1; i >= 0; --i) {\n        var code = path.charCodeAt(i);\n        if (code === 47 /*/*/) {\n            // If we reached a path separator that was not part of a set of path\n            // separators at the end of the string, stop now\n            if (!matchedSlash) {\n              start = i + 1;\n              break;\n            }\n          } else {\n          if (firstNonSlashEnd === -1) {\n            // We saw the first non-path separator, remember this index in case\n            // we need it if the extension ends up not matching\n            matchedSlash = false;\n            firstNonSlashEnd = i + 1;\n          }\n          if (extIdx >= 0) {\n            // Try to match the explicit extension\n            if (code === ext.charCodeAt(extIdx)) {\n              if (--extIdx === -1) {\n                // We matched the extension, so mark this as the end of our path\n                // component\n                end = i;\n              }\n            } else {\n              // Extension does not match, so our result is the entire path\n              // component\n              extIdx = -1;\n              end = firstNonSlashEnd;\n            }\n          }\n        }\n      }\n\n      if (start === end) end = firstNonSlashEnd;else if (end === -1) end = path.length;\n      return path.slice(start, end);\n    } else {\n      for (i = path.length - 1; i >= 0; --i) {\n        if (path.charCodeAt(i) === 47 /*/*/) {\n            // If we reached a path separator that was not part of a set of path\n            // separators at the end of the string, stop now\n            if (!matchedSlash) {\n              start = i + 1;\n              break;\n            }\n          } else if (end === -1) {\n          // We saw the first non-path separator, mark this as the end of our\n          // path component\n          matchedSlash = false;\n          end = i + 1;\n        }\n      }\n\n      if (end === -1) return '';\n      return path.slice(start, end);\n    }\n  },\n\n  extname: function extname(path) {\n    assertPath(path);\n    var startDot = -1;\n    var startPart = 0;\n    var end = -1;\n    var matchedSlash = true;\n    // Track the state of characters (if any) we see before our first dot and\n    // after any path separator we find\n    var preDotState = 0;\n    for (var i = path.length - 1; i >= 0; --i) {\n      var code = path.charCodeAt(i);\n      if (code === 47 /*/*/) {\n          // If we reached a path separator that was not part of a set of path\n          // separators at the end of the string, stop now\n          if (!matchedSlash) {\n            startPart = i + 1;\n            break;\n          }\n          continue;\n        }\n      if (end === -1) {\n        // We saw the first non-path separator, mark this as the end of our\n        // extension\n        matchedSlash = false;\n        end = i + 1;\n      }\n      if (code === 46 /*.*/) {\n          // If this is our first dot, mark it as the start of our extension\n          if (startDot === -1)\n            startDot = i;\n          else if (preDotState !== 1)\n            preDotState = 1;\n      } else if (startDot !== -1) {\n        // We saw a non-dot and non-path separator before our dot, so we should\n        // have a good chance at having a non-empty extension\n        preDotState = -1;\n      }\n    }\n\n    if (startDot === -1 || end === -1 ||\n        // We saw a non-dot character immediately before the dot\n        preDotState === 0 ||\n        // The (right-most) trimmed path component is exactly '..'\n        preDotState === 1 && startDot === end - 1 && startDot === startPart + 1) {\n      return '';\n    }\n    return path.slice(startDot, end);\n  },\n\n  format: function format(pathObject) {\n    if (pathObject === null || typeof pathObject !== 'object') {\n      throw new TypeError('The \"pathObject\" argument must be of type Object. Received type ' + typeof pathObject);\n    }\n    return _format('/', pathObject);\n  },\n\n  parse: function parse(path) {\n    assertPath(path);\n\n    var ret = { root: '', dir: '', base: '', ext: '', name: '' };\n    if (path.length === 0) return ret;\n    var code = path.charCodeAt(0);\n    var isAbsolute = code === 47 /*/*/;\n    var start;\n    if (isAbsolute) {\n      ret.root = '/';\n      start = 1;\n    } else {\n      start = 0;\n    }\n    var startDot = -1;\n    var startPart = 0;\n    var end = -1;\n    var matchedSlash = true;\n    var i = path.length - 1;\n\n    // Track the state of characters (if any) we see before our first dot and\n    // after any path separator we find\n    var preDotState = 0;\n\n    // Get non-dir info\n    for (; i >= start; --i) {\n      code = path.charCodeAt(i);\n      if (code === 47 /*/*/) {\n          // If we reached a path separator that was not part of a set of path\n          // separators at the end of the string, stop now\n          if (!matchedSlash) {\n            startPart = i + 1;\n            break;\n          }\n          continue;\n        }\n      if (end === -1) {\n        // We saw the first non-path separator, mark this as the end of our\n        // extension\n        matchedSlash = false;\n        end = i + 1;\n      }\n      if (code === 46 /*.*/) {\n          // If this is our first dot, mark it as the start of our extension\n          if (startDot === -1) startDot = i;else if (preDotState !== 1) preDotState = 1;\n        } else if (startDot !== -1) {\n        // We saw a non-dot and non-path separator before our dot, so we should\n        // have a good chance at having a non-empty extension\n        preDotState = -1;\n      }\n    }\n\n    if (startDot === -1 || end === -1 ||\n    // We saw a non-dot character immediately before the dot\n    preDotState === 0 ||\n    // The (right-most) trimmed path component is exactly '..'\n    preDotState === 1 && startDot === end - 1 && startDot === startPart + 1) {\n      if (end !== -1) {\n        if (startPart === 0 && isAbsolute) ret.base = ret.name = path.slice(1, end);else ret.base = ret.name = path.slice(startPart, end);\n      }\n    } else {\n      if (startPart === 0 && isAbsolute) {\n        ret.name = path.slice(1, startDot);\n        ret.base = path.slice(1, end);\n      } else {\n        ret.name = path.slice(startPart, startDot);\n        ret.base = path.slice(startPart, end);\n      }\n      ret.ext = path.slice(startDot, end);\n    }\n\n    if (startPart > 0) ret.dir = path.slice(0, startPart - 1);else if (isAbsolute) ret.dir = '/';\n\n    return ret;\n  },\n\n  sep: '/',\n  delimiter: ':',\n  win32: null,\n  posix: null\n};\n\nposix.posix = posix;\n\nmodule.exports = posix;\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { PluginManager } from './tsServer/plugins';\n\nclass ApiV0 {\n\tpublic constructor(\n\t\tpublic readonly onCompletionAccepted: vscode.Event<vscode.CompletionItem & { metadata?: any }>,\n\t\tprivate readonly _pluginManager: PluginManager,\n\t) { }\n\n\tconfigurePlugin(pluginId: string, configuration: {}): void {\n\t\tthis._pluginManager.setConfiguration(pluginId, configuration);\n\t}\n}\n\nexport interface Api {\n\tgetAPI(version: 0): ApiV0 | undefined;\n}\n\nexport function getExtensionApi(\n\tonCompletionAccepted: vscode.Event<vscode.CompletionItem>,\n\tpluginManager: PluginManager,\n): Api {\n\treturn {\n\t\tgetAPI(version) {\n\t\t\tif (version === 0) {\n\t\t\t\treturn new ApiV0(onCompletionAccepted, pluginManager);\n\t\t\t}\n\t\t\treturn undefined;\n\t\t}\n\t};\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\n\nexport interface Command {\n\treadonly id: string;\n\n\texecute(...args: any[]): void | any;\n}\n\nexport class CommandManager {\n\tprivate readonly commands = new Map<string, { refCount: number; readonly registration: vscode.Disposable }>();\n\n\tpublic dispose() {\n\t\tfor (const registration of this.commands.values()) {\n\t\t\tregistration.registration.dispose();\n\t\t}\n\t\tthis.commands.clear();\n\t}\n\n\tpublic register<T extends Command>(command: T): vscode.Disposable {\n\t\tlet entry = this.commands.get(command.id);\n\t\tif (!entry) {\n\t\t\tentry = { refCount: 1, registration: vscode.commands.registerCommand(command.id, command.execute, command) };\n\t\t\tthis.commands.set(command.id, entry);\n\t\t} else {\n\t\t\tentry.refCount += 1;\n\t\t}\n\n\t\treturn new vscode.Disposable(() => {\n\t\t\tentry.refCount -= 1;\n\t\t\tif (entry.refCount <= 0) {\n\t\t\t\tentry.registration.dispose();\n\t\t\t\tthis.commands.delete(command.id);\n\t\t\t}\n\t\t});\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { PluginManager } from '../tsServer/plugins';\nimport { Command } from './commandManager';\n\nexport class ConfigurePluginCommand implements Command {\n\tpublic readonly id = '_typescript.configurePlugin';\n\n\tpublic constructor(\n\t\tprivate readonly pluginManager: PluginManager,\n\t) { }\n\n\tpublic execute(pluginId: string, configuration: any) {\n\t\tthis.pluginManager.setConfiguration(pluginId, configuration);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport TypeScriptServiceClientHost from '../typeScriptServiceClientHost';\nimport { ActiveJsTsEditorTracker } from '../ui/activeJsTsEditorTracker';\nimport { Lazy } from '../utils/lazy';\nimport { openProjectConfigForFile, ProjectType } from '../tsconfig';\nimport { Command } from './commandManager';\n\nexport class TypeScriptGoToProjectConfigCommand implements Command {\n\tpublic readonly id = 'typescript.goToProjectConfig';\n\n\tpublic constructor(\n\t\tprivate readonly activeJsTsEditorTracker: ActiveJsTsEditorTracker,\n\t\tprivate readonly lazyClientHost: Lazy<TypeScriptServiceClientHost>,\n\t) { }\n\n\tpublic execute() {\n\t\tconst editor = this.activeJsTsEditorTracker.activeJsTsEditor;\n\t\tif (editor) {\n\t\t\topenProjectConfigForFile(ProjectType.TypeScript, this.lazyClientHost.value.serviceClient, editor.document.uri);\n\t\t}\n\t}\n}\n\nexport class JavaScriptGoToProjectConfigCommand implements Command {\n\tpublic readonly id = 'javascript.goToProjectConfig';\n\n\tpublic constructor(\n\t\tprivate readonly activeJsTsEditorTracker: ActiveJsTsEditorTracker,\n\t\tprivate readonly lazyClientHost: Lazy<TypeScriptServiceClientHost>,\n\t) { }\n\n\tpublic execute() {\n\t\tconst editor = this.activeJsTsEditorTracker.activeJsTsEditor;\n\t\tif (editor) {\n\t\t\topenProjectConfigForFile(ProjectType.JavaScript, this.lazyClientHost.value.serviceClient, editor.document.uri);\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { PluginManager } from '../tsServer/plugins';\nimport TypeScriptServiceClientHost from '../typeScriptServiceClientHost';\nimport { ActiveJsTsEditorTracker } from '../ui/activeJsTsEditorTracker';\nimport { Lazy } from '../utils/lazy';\nimport { CommandManager } from './commandManager';\nimport { ConfigurePluginCommand } from './configurePlugin';\nimport { JavaScriptGoToProjectConfigCommand, TypeScriptGoToProjectConfigCommand } from './goToProjectConfiguration';\nimport { LearnMoreAboutRefactoringsCommand } from './learnMoreAboutRefactorings';\nimport { OpenJsDocLinkCommand } from './openJsDocLink';\nimport { OpenTsServerLogCommand } from './openTsServerLog';\nimport { ReloadJavaScriptProjectsCommand, ReloadTypeScriptProjectsCommand } from './reloadProject';\nimport { RestartTsServerCommand } from './restartTsServer';\nimport { SelectTypeScriptVersionCommand } from './selectTypeScriptVersion';\nimport { TSServerRequestCommand } from './tsserverRequests';\n\nexport function registerBaseCommands(\n\tcommandManager: CommandManager,\n\tlazyClientHost: Lazy<TypeScriptServiceClientHost>,\n\tpluginManager: PluginManager,\n\tactiveJsTsEditorTracker: ActiveJsTsEditorTracker,\n): void {\n\tcommandManager.register(new ReloadTypeScriptProjectsCommand(lazyClientHost));\n\tcommandManager.register(new ReloadJavaScriptProjectsCommand(lazyClientHost));\n\tcommandManager.register(new SelectTypeScriptVersionCommand(lazyClientHost));\n\tcommandManager.register(new OpenTsServerLogCommand(lazyClientHost));\n\tcommandManager.register(new RestartTsServerCommand(lazyClientHost));\n\tcommandManager.register(new TypeScriptGoToProjectConfigCommand(activeJsTsEditorTracker, lazyClientHost));\n\tcommandManager.register(new JavaScriptGoToProjectConfigCommand(activeJsTsEditorTracker, lazyClientHost));\n\tcommandManager.register(new ConfigurePluginCommand(pluginManager));\n\tcommandManager.register(new LearnMoreAboutRefactoringsCommand());\n\tcommandManager.register(new TSServerRequestCommand(lazyClientHost));\n\tcommandManager.register(new OpenJsDocLinkCommand());\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { isTypeScriptDocument } from '../configuration/languageIds';\nimport { Command } from './commandManager';\n\nexport class LearnMoreAboutRefactoringsCommand implements Command {\n\tpublic static readonly id = '_typescript.learnMoreAboutRefactorings';\n\tpublic readonly id = LearnMoreAboutRefactoringsCommand.id;\n\n\tpublic execute() {\n\t\tconst docUrl = vscode.window.activeTextEditor && isTypeScriptDocument(vscode.window.activeTextEditor.document)\n\t\t\t? 'https://go.microsoft.com/fwlink/?linkid=2114477'\n\t\t\t: 'https://go.microsoft.com/fwlink/?linkid=2116761';\n\n\t\tvscode.env.openExternal(vscode.Uri.parse(docUrl));\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { Command } from './commandManager';\n\nexport interface OpenJsDocLinkCommand_Args {\n\treadonly file: {\n\t\treadonly scheme: string;\n\t\treadonly authority?: string;\n\t\treadonly path?: string;\n\t\treadonly query?: string;\n\t\treadonly fragment?: string;\n\t};\n\treadonly position: {\n\t\treadonly line: number;\n\t\treadonly character: number;\n\t};\n}\n\n/**\n * Proxy command for opening links in jsdoc comments.\n *\n * This is needed to avoid incorrectly rewriting uris.\n */\nexport class OpenJsDocLinkCommand implements Command {\n\tpublic static readonly id = '_typescript.openJsDocLink';\n\tpublic readonly id = OpenJsDocLinkCommand.id;\n\n\tpublic async execute(args: OpenJsDocLinkCommand_Args): Promise<void> {\n\t\tconst { line, character } = args.position;\n\t\tconst position = new vscode.Position(line, character);\n\t\tawait vscode.commands.executeCommand('vscode.open', vscode.Uri.from(args.file), {\n\t\t\tselection: new vscode.Range(position, position),\n\t\t} satisfies vscode.TextDocumentShowOptions);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport TypeScriptServiceClientHost from '../typeScriptServiceClientHost';\nimport { Lazy } from '../utils/lazy';\nimport { Command } from './commandManager';\n\nexport class OpenTsServerLogCommand implements Command {\n\tpublic readonly id = 'typescript.openTsServerLog';\n\n\tpublic constructor(\n\t\tprivate readonly lazyClientHost: Lazy<TypeScriptServiceClientHost>\n\t) { }\n\n\tpublic execute() {\n\t\tthis.lazyClientHost.value.serviceClient.openTsServerLogFile();\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport TypeScriptServiceClientHost from '../typeScriptServiceClientHost';\nimport { Lazy } from '../utils/lazy';\nimport { Command } from './commandManager';\n\nexport class ReloadTypeScriptProjectsCommand implements Command {\n\tpublic readonly id = 'typescript.reloadProjects';\n\n\tpublic constructor(\n\t\tprivate readonly lazyClientHost: Lazy<TypeScriptServiceClientHost>\n\t) { }\n\n\tpublic execute() {\n\t\tthis.lazyClientHost.value.reloadProjects();\n\t}\n}\n\nexport class ReloadJavaScriptProjectsCommand implements Command {\n\tpublic readonly id = 'javascript.reloadProjects';\n\n\tpublic constructor(\n\t\tprivate readonly lazyClientHost: Lazy<TypeScriptServiceClientHost>\n\t) { }\n\n\tpublic execute() {\n\t\tthis.lazyClientHost.value.reloadProjects();\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport TypeScriptServiceClientHost from '../typeScriptServiceClientHost';\nimport { Lazy } from '../utils/lazy';\nimport { Command } from './commandManager';\n\nexport class RestartTsServerCommand implements Command {\n\tpublic readonly id = 'typescript.restartTsServer';\n\n\tpublic constructor(\n\t\tprivate readonly lazyClientHost: Lazy<TypeScriptServiceClientHost>\n\t) { }\n\n\tpublic execute() {\n\t\tthis.lazyClientHost.value.serviceClient.restartTsServer(true);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport TypeScriptServiceClientHost from '../typeScriptServiceClientHost';\nimport { Lazy } from '../utils/lazy';\nimport { Command } from './commandManager';\n\nexport class SelectTypeScriptVersionCommand implements Command {\n\tpublic static readonly id = 'typescript.selectTypeScriptVersion';\n\tpublic readonly id = SelectTypeScriptVersionCommand.id;\n\n\tpublic constructor(\n\t\tprivate readonly lazyClientHost: Lazy<TypeScriptServiceClientHost>\n\t) { }\n\n\tpublic execute() {\n\t\tthis.lazyClientHost.value.serviceClient.showVersionPicker();\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as vscode from 'vscode';\n\nimport { TypeScriptRequests } from '../typescriptService';\nimport TypeScriptServiceClientHost from '../typeScriptServiceClientHost';\nimport { nulToken } from '../utils/cancellation';\nimport { Lazy } from '../utils/lazy';\nimport { Command } from './commandManager';\n\nfunction isCancellationToken(value: any): value is vscode.CancellationToken {\n\treturn value && typeof value.isCancellationRequested === 'boolean' && typeof value.onCancellationRequested === 'function';\n}\n\ninterface RequestArgs {\n\treadonly file?: unknown;\n}\n\nexport class TSServerRequestCommand implements Command {\n\tpublic readonly id = 'typescript.tsserverRequest';\n\n\tpublic constructor(\n\t\tprivate readonly lazyClientHost: Lazy<TypeScriptServiceClientHost>\n\t) { }\n\n\tpublic async execute(command: keyof TypeScriptRequests, args?: any, config?: any, token?: vscode.CancellationToken): Promise<unknown> {\n\t\tif (!isCancellationToken(token)) {\n\t\t\ttoken = nulToken;\n\t\t}\n\t\tif (args && typeof args === 'object' && !Array.isArray(args)) {\n\t\t\tconst requestArgs = args as RequestArgs;\n\t\t\tlet newArgs: any = undefined;\n\t\t\tif (requestArgs.file instanceof vscode.Uri) {\n\t\t\t\tnewArgs = { ...args };\n\t\t\t\tconst client = this.lazyClientHost.value.serviceClient;\n\t\t\t\tnewArgs.file = client.toOpenTsFilePath(requestArgs.file);\n\t\t\t\targs = newArgs;\n\t\t\t}\n\t\t}\n\n\t\t// The list can be found in the TypeScript compiler as `const enum CommandTypes`,\n\t\t// to avoid extensions making calls which could affect the internal tsserver state\n\t\t// these are only read-y sorts of commands\n\t\tconst allowList = [\n\t\t\t// Seeing the JS/DTS output for a file\n\t\t\t'emit-output',\n\t\t\t// Grabbing a file's diagnostics\n\t\t\t'semanticDiagnosticsSync',\n\t\t\t'syntacticDiagnosticsSync',\n\t\t\t'suggestionDiagnosticsSync',\n\t\t\t// Introspecting code at a position\n\t\t\t'quickinfo',\n\t\t\t'quickinfo-full',\n\t\t\t'completionInfo'\n\t\t];\n\n\t\tif (allowList.includes(command) || command.startsWith('_')) {\n\t\t\treturn this.lazyClientHost.value.serviceClient.execute(command, args, token, config);\n\t\t}\n\t\treturn undefined;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { BaseServiceConfigurationProvider } from './configuration';\n\nexport class BrowserServiceConfigurationProvider extends BaseServiceConfigurationProvider {\n\n\t// On browsers, we only support using the built-in TS version\n\tprotected readGlobalTsdk(_configuration: vscode.WorkspaceConfiguration): string | null {\n\t\treturn null;\n\t}\n\n\tprotected readLocalTsdk(_configuration: vscode.WorkspaceConfiguration): string | null {\n\t\treturn null;\n\t}\n\n\t// On browsers, we don't run TSServer on Node\n\tprotected readLocalNodePath(_configuration: vscode.WorkspaceConfiguration): string | null {\n\t\treturn null;\n\t}\n\n\tprotected override readGlobalNodePath(_configuration: vscode.WorkspaceConfiguration): string | null {\n\t\treturn null;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as Proto from '../tsServer/protocol/protocol';\nimport * as objects from '../utils/objects';\n\nexport enum TsServerLogLevel {\n\tOff,\n\tNormal,\n\tTerse,\n\tVerbose,\n}\n\nexport namespace TsServerLogLevel {\n\texport function fromString(value: string): TsServerLogLevel {\n\t\tswitch (value?.toLowerCase()) {\n\t\t\tcase 'normal':\n\t\t\t\treturn TsServerLogLevel.Normal;\n\t\t\tcase 'terse':\n\t\t\t\treturn TsServerLogLevel.Terse;\n\t\t\tcase 'verbose':\n\t\t\t\treturn TsServerLogLevel.Verbose;\n\t\t\tcase 'off':\n\t\t\tdefault:\n\t\t\t\treturn TsServerLogLevel.Off;\n\t\t}\n\t}\n\n\texport function toString(value: TsServerLogLevel): string {\n\t\tswitch (value) {\n\t\t\tcase TsServerLogLevel.Normal:\n\t\t\t\treturn 'normal';\n\t\t\tcase TsServerLogLevel.Terse:\n\t\t\t\treturn 'terse';\n\t\t\tcase TsServerLogLevel.Verbose:\n\t\t\t\treturn 'verbose';\n\t\t\tcase TsServerLogLevel.Off:\n\t\t\tdefault:\n\t\t\t\treturn 'off';\n\t\t}\n\t}\n}\n\nexport const enum SyntaxServerConfiguration {\n\tNever,\n\tAlways,\n\t/** Use a single syntax server for every request, even on desktop */\n\tAuto,\n}\n\nexport class ImplicitProjectConfiguration {\n\n\tpublic readonly target: string | undefined;\n\tpublic readonly module: string | undefined;\n\tpublic readonly checkJs: boolean;\n\tpublic readonly experimentalDecorators: boolean;\n\tpublic readonly strictNullChecks: boolean;\n\tpublic readonly strictFunctionTypes: boolean;\n\n\tconstructor(configuration: vscode.WorkspaceConfiguration) {\n\t\tthis.target = ImplicitProjectConfiguration.readTarget(configuration);\n\t\tthis.module = ImplicitProjectConfiguration.readModule(configuration);\n\t\tthis.checkJs = ImplicitProjectConfiguration.readCheckJs(configuration);\n\t\tthis.experimentalDecorators = ImplicitProjectConfiguration.readExperimentalDecorators(configuration);\n\t\tthis.strictNullChecks = ImplicitProjectConfiguration.readImplicitStrictNullChecks(configuration);\n\t\tthis.strictFunctionTypes = ImplicitProjectConfiguration.readImplicitStrictFunctionTypes(configuration);\n\t}\n\n\tpublic isEqualTo(other: ImplicitProjectConfiguration): boolean {\n\t\treturn objects.equals(this, other);\n\t}\n\n\tprivate static readTarget(configuration: vscode.WorkspaceConfiguration): string | undefined {\n\t\treturn configuration.get<string>('js/ts.implicitProjectConfig.target');\n\t}\n\n\tprivate static readModule(configuration: vscode.WorkspaceConfiguration): string | undefined {\n\t\treturn configuration.get<string>('js/ts.implicitProjectConfig.module');\n\t}\n\n\tprivate static readCheckJs(configuration: vscode.WorkspaceConfiguration): boolean {\n\t\treturn configuration.get<boolean>('js/ts.implicitProjectConfig.checkJs')\n\t\t\t?? configuration.get<boolean>('javascript.implicitProjectConfig.checkJs', false);\n\t}\n\n\tprivate static readExperimentalDecorators(configuration: vscode.WorkspaceConfiguration): boolean {\n\t\treturn configuration.get<boolean>('js/ts.implicitProjectConfig.experimentalDecorators')\n\t\t\t?? configuration.get<boolean>('javascript.implicitProjectConfig.experimentalDecorators', false);\n\t}\n\n\tprivate static readImplicitStrictNullChecks(configuration: vscode.WorkspaceConfiguration): boolean {\n\t\treturn configuration.get<boolean>('js/ts.implicitProjectConfig.strictNullChecks', true);\n\t}\n\n\tprivate static readImplicitStrictFunctionTypes(configuration: vscode.WorkspaceConfiguration): boolean {\n\t\treturn configuration.get<boolean>('js/ts.implicitProjectConfig.strictFunctionTypes', true);\n\t}\n}\n\nexport interface TypeScriptServiceConfiguration {\n\treadonly locale: string | null;\n\treadonly globalTsdk: string | null;\n\treadonly localTsdk: string | null;\n\treadonly npmLocation: string | null;\n\treadonly tsServerLogLevel: TsServerLogLevel;\n\treadonly tsServerPluginPaths: readonly string[];\n\treadonly implicitProjectConfiguration: ImplicitProjectConfiguration;\n\treadonly disableAutomaticTypeAcquisition: boolean;\n\treadonly useSyntaxServer: SyntaxServerConfiguration;\n\treadonly webProjectWideIntellisenseEnabled: boolean;\n\treadonly webProjectWideIntellisenseSuppressSemanticErrors: boolean;\n\treadonly webTypeAcquisitionEnabled: boolean;\n\treadonly enableDiagnosticsTelemetry: boolean;\n\treadonly enableProjectDiagnostics: boolean;\n\treadonly maxTsServerMemory: number;\n\treadonly enablePromptUseWorkspaceTsdk: boolean;\n\treadonly useVsCodeWatcher: boolean;\n\treadonly watchOptions: Proto.WatchOptions | undefined;\n\treadonly includePackageJsonAutoImports: 'auto' | 'on' | 'off' | undefined;\n\treadonly enableTsServerTracing: boolean;\n\treadonly localNodePath: string | null;\n\treadonly globalNodePath: string | null;\n\treadonly workspaceSymbolsExcludeLibrarySymbols: boolean;\n\treadonly enableRegionDiagnostics: boolean;\n}\n\nexport function areServiceConfigurationsEqual(a: TypeScriptServiceConfiguration, b: TypeScriptServiceConfiguration): boolean {\n\treturn objects.equals(a, b);\n}\n\nexport interface ServiceConfigurationProvider {\n\tloadFromWorkspace(): TypeScriptServiceConfiguration;\n}\n\nconst vscodeWatcherName = 'vscode';\ntype vscodeWatcherName = typeof vscodeWatcherName;\n\n\nexport abstract class BaseServiceConfigurationProvider implements ServiceConfigurationProvider {\n\n\tpublic loadFromWorkspace(): TypeScriptServiceConfiguration {\n\t\tconst configuration = vscode.workspace.getConfiguration();\n\t\treturn {\n\t\t\tlocale: this.readLocale(configuration),\n\t\t\tglobalTsdk: this.readGlobalTsdk(configuration),\n\t\t\tlocalTsdk: this.readLocalTsdk(configuration),\n\t\t\tnpmLocation: this.readNpmLocation(configuration),\n\t\t\ttsServerLogLevel: this.readTsServerLogLevel(configuration),\n\t\t\ttsServerPluginPaths: this.readTsServerPluginPaths(configuration),\n\t\t\timplicitProjectConfiguration: new ImplicitProjectConfiguration(configuration),\n\t\t\tdisableAutomaticTypeAcquisition: this.readDisableAutomaticTypeAcquisition(configuration),\n\t\t\tuseSyntaxServer: this.readUseSyntaxServer(configuration),\n\t\t\twebProjectWideIntellisenseEnabled: this.readWebProjectWideIntellisenseEnable(configuration),\n\t\t\twebProjectWideIntellisenseSuppressSemanticErrors: this.readWebProjectWideIntellisenseSuppressSemanticErrors(configuration),\n\t\t\twebTypeAcquisitionEnabled: this.readWebTypeAcquisition(configuration),\n\t\t\tenableDiagnosticsTelemetry: this.readEnableDiagnosticsTelemetry(configuration),\n\t\t\tenableProjectDiagnostics: this.readEnableProjectDiagnostics(configuration),\n\t\t\tmaxTsServerMemory: this.readMaxTsServerMemory(configuration),\n\t\t\tenablePromptUseWorkspaceTsdk: this.readEnablePromptUseWorkspaceTsdk(configuration),\n\t\t\tuseVsCodeWatcher: this.readUseVsCodeWatcher(configuration),\n\t\t\twatchOptions: this.readWatchOptions(configuration),\n\t\t\tincludePackageJsonAutoImports: this.readIncludePackageJsonAutoImports(configuration),\n\t\t\tenableTsServerTracing: this.readEnableTsServerTracing(configuration),\n\t\t\tlocalNodePath: this.readLocalNodePath(configuration),\n\t\t\tglobalNodePath: this.readGlobalNodePath(configuration),\n\t\t\tworkspaceSymbolsExcludeLibrarySymbols: this.readWorkspaceSymbolsExcludeLibrarySymbols(configuration),\n\t\t\tenableRegionDiagnostics: this.readEnableRegionDiagnostics(configuration),\n\t\t};\n\t}\n\n\tprotected abstract readGlobalTsdk(configuration: vscode.WorkspaceConfiguration): string | null;\n\tprotected abstract readLocalTsdk(configuration: vscode.WorkspaceConfiguration): string | null;\n\tprotected abstract readLocalNodePath(configuration: vscode.WorkspaceConfiguration): string | null;\n\tprotected abstract readGlobalNodePath(configuration: vscode.WorkspaceConfiguration): string | null;\n\n\tprotected readTsServerLogLevel(configuration: vscode.WorkspaceConfiguration): TsServerLogLevel {\n\t\tconst setting = configuration.get<string>('typescript.tsserver.log', 'off');\n\t\treturn TsServerLogLevel.fromString(setting);\n\t}\n\n\tprotected readTsServerPluginPaths(configuration: vscode.WorkspaceConfiguration): string[] {\n\t\treturn configuration.get<string[]>('typescript.tsserver.pluginPaths', []);\n\t}\n\n\tprotected readNpmLocation(configuration: vscode.WorkspaceConfiguration): string | null {\n\t\treturn configuration.get<string | null>('typescript.npm', null);\n\t}\n\n\tprotected readDisableAutomaticTypeAcquisition(configuration: vscode.WorkspaceConfiguration): boolean {\n\t\treturn configuration.get<boolean>('typescript.disableAutomaticTypeAcquisition', false);\n\t}\n\n\tprotected readLocale(configuration: vscode.WorkspaceConfiguration): string | null {\n\t\tconst value = configuration.get<string>('typescript.locale', 'auto');\n\t\treturn !value || value === 'auto' ? null : value;\n\t}\n\n\tprotected readUseSyntaxServer(configuration: vscode.WorkspaceConfiguration): SyntaxServerConfiguration {\n\t\tconst value = configuration.get<string>('typescript.tsserver.useSyntaxServer');\n\t\tswitch (value) {\n\t\t\tcase 'never': return SyntaxServerConfiguration.Never;\n\t\t\tcase 'always': return SyntaxServerConfiguration.Always;\n\t\t\tcase 'auto': return SyntaxServerConfiguration.Auto;\n\t\t}\n\n\t\t// Fallback to deprecated setting\n\t\tconst deprecatedValue = configuration.get<boolean | string>('typescript.tsserver.useSeparateSyntaxServer', true);\n\t\tif (deprecatedValue === 'forAllRequests') { // Undocumented setting\n\t\t\treturn SyntaxServerConfiguration.Always;\n\t\t}\n\t\tif (deprecatedValue === true) {\n\t\t\treturn SyntaxServerConfiguration.Auto;\n\t\t}\n\t\treturn SyntaxServerConfiguration.Never;\n\t}\n\n\tprotected readEnableDiagnosticsTelemetry(configuration: vscode.WorkspaceConfiguration): boolean {\n\t\t// This setting does not appear in the settings view, as it is not to be enabled by users outside the team\n\t\treturn configuration.get<boolean>('typescript.enableDiagnosticsTelemetry', false);\n\t}\n\n\tprotected readEnableProjectDiagnostics(configuration: vscode.WorkspaceConfiguration): boolean {\n\t\treturn configuration.get<boolean>('typescript.tsserver.experimental.enableProjectDiagnostics', false);\n\t}\n\n\tprivate readUseVsCodeWatcher(configuration: vscode.WorkspaceConfiguration): boolean {\n\t\tconst watcherExcludes = configuration.get<Record<string, boolean>>('files.watcherExclude') ?? {};\n\t\tif (\n\t\t\twatcherExcludes['**/node_modules/*/**'] === true || // VS Code default prior to 1.94.x\n\t\t\twatcherExcludes['**/node_modules/**'] === true ||\n\t\t\twatcherExcludes['**/node_modules'] === true ||\n\t\t\twatcherExcludes['**'] === true\t \t\t\t\t\t// VS Code Watching is entirely disabled\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst experimentalConfig = configuration.inspect('typescript.tsserver.experimental.useVsCodeWatcher');\n\t\tif (typeof experimentalConfig?.globalValue === 'boolean') {\n\t\t\treturn experimentalConfig.globalValue;\n\t\t}\n\t\tif (typeof experimentalConfig?.workspaceValue === 'boolean') {\n\t\t\treturn experimentalConfig.workspaceValue;\n\t\t}\n\t\tif (typeof experimentalConfig?.workspaceFolderValue === 'boolean') {\n\t\t\treturn experimentalConfig.workspaceFolderValue;\n\t\t}\n\n\t\treturn configuration.get<Proto.WatchOptions | vscodeWatcherName>('typescript.tsserver.watchOptions', vscodeWatcherName) === vscodeWatcherName;\n\t}\n\n\tprivate readWatchOptions(configuration: vscode.WorkspaceConfiguration): Proto.WatchOptions | undefined {\n\t\tconst watchOptions = configuration.get<Proto.WatchOptions | vscodeWatcherName>('typescript.tsserver.watchOptions');\n\t\tif (watchOptions === vscodeWatcherName) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// Returned value may be a proxy. Clone it into a normal object\n\t\treturn { ...(watchOptions ?? {}) };\n\t}\n\n\tprotected readIncludePackageJsonAutoImports(configuration: vscode.WorkspaceConfiguration): 'auto' | 'on' | 'off' | undefined {\n\t\treturn configuration.get<'auto' | 'on' | 'off'>('typescript.preferences.includePackageJsonAutoImports');\n\t}\n\n\tprotected readMaxTsServerMemory(configuration: vscode.WorkspaceConfiguration): number {\n\t\tconst defaultMaxMemory = 3072;\n\t\tconst minimumMaxMemory = 128;\n\t\tconst memoryInMB = configuration.get<number>('typescript.tsserver.maxTsServerMemory', defaultMaxMemory);\n\t\tif (!Number.isSafeInteger(memoryInMB)) {\n\t\t\treturn defaultMaxMemory;\n\t\t}\n\t\treturn Math.max(memoryInMB, minimumMaxMemory);\n\t}\n\n\tprotected readEnablePromptUseWorkspaceTsdk(configuration: vscode.WorkspaceConfiguration): boolean {\n\t\treturn configuration.get<boolean>('typescript.enablePromptUseWorkspaceTsdk', false);\n\t}\n\n\tprotected readEnableTsServerTracing(configuration: vscode.WorkspaceConfiguration): boolean {\n\t\treturn configuration.get<boolean>('typescript.tsserver.enableTracing', false);\n\t}\n\n\tprivate readWorkspaceSymbolsExcludeLibrarySymbols(configuration: vscode.WorkspaceConfiguration): boolean {\n\t\treturn configuration.get<boolean>('typescript.workspaceSymbols.excludeLibrarySymbols', true);\n\t}\n\n\tprivate readWebProjectWideIntellisenseEnable(configuration: vscode.WorkspaceConfiguration): boolean {\n\t\treturn configuration.get<boolean>('typescript.tsserver.web.projectWideIntellisense.enabled', true);\n\t}\n\n\tprivate readWebProjectWideIntellisenseSuppressSemanticErrors(configuration: vscode.WorkspaceConfiguration): boolean {\n\t\treturn this.readWebTypeAcquisition(configuration) && configuration.get<boolean>('typescript.tsserver.web.projectWideIntellisense.suppressSemanticErrors', false);\n\t}\n\n\tprivate readWebTypeAcquisition(configuration: vscode.WorkspaceConfiguration): boolean {\n\t\treturn configuration.get<boolean>('typescript.tsserver.web.typeAcquisition.enabled', true);\n\t}\n\n\tprivate readEnableRegionDiagnostics(configuration: vscode.WorkspaceConfiguration): boolean {\n\t\treturn configuration.get<boolean>('typescript.tsserver.enableRegionDiagnostics', true);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { isWeb } from '../utils/platform';\n\nexport const file = 'file';\nexport const untitled = 'untitled';\nexport const git = 'git';\nexport const github = 'github';\nexport const azurerepos = 'azurerepos';\n\n/** Live share scheme */\nexport const vsls = 'vsls';\nexport const walkThroughSnippet = 'walkThroughSnippet';\nexport const vscodeNotebookCell = 'vscode-notebook-cell';\nexport const officeScript = 'office-script';\n\n/** Used for code blocks in chat by vs code core */\nexport const chatCodeBlock = 'vscode-chat-code-block';\n\nexport function getSemanticSupportedSchemes() {\n\tconst alwaysSupportedSchemes = [\n\t\tuntitled,\n\t\twalkThroughSnippet,\n\t\tvscodeNotebookCell,\n\t\tchatCodeBlock,\n\t];\n\n\tif (isWeb()) {\n\t\treturn [\n\t\t\t...(vscode.workspace.workspaceFolders ?? []).map(folder => folder.uri.scheme),\n\t\t\t...alwaysSupportedSchemes,\n\t\t];\n\t}\n\n\treturn [\n\t\tfile,\n\t\t...alwaysSupportedSchemes,\n\t];\n}\n\n/**\n * File scheme for which JS/TS language feature should be disabled\n */\nexport const disabledSchemes = new Set([\n\tgit,\n\tvsls,\n\tgithub,\n\tazurerepos,\n]);\n\nexport function isOfScheme(uri: vscode.Uri, ...schemes: string[]): boolean {\n\tconst normalizedUriScheme = uri.scheme.toLowerCase();\n\treturn schemes.some(scheme => normalizedUriScheme === scheme);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { basename } from 'path';\nimport * as vscode from 'vscode';\nimport * as languageIds from './languageIds';\n\nexport const enum DiagnosticLanguage {\n\tJavaScript,\n\tTypeScript\n}\n\nexport const allDiagnosticLanguages = [DiagnosticLanguage.JavaScript, DiagnosticLanguage.TypeScript];\n\nexport interface LanguageDescription {\n\treadonly id: string;\n\treadonly diagnosticOwner: string;\n\treadonly diagnosticSource: string;\n\treadonly diagnosticLanguage: DiagnosticLanguage;\n\treadonly languageIds: readonly string[];\n\treadonly configFilePattern?: RegExp;\n\treadonly isExternal?: boolean;\n\treadonly standardFileExtensions: readonly string[];\n}\n\nexport const standardLanguageDescriptions: LanguageDescription[] = [\n\t{\n\t\tid: 'typescript',\n\t\tdiagnosticOwner: 'typescript',\n\t\tdiagnosticSource: 'ts',\n\t\tdiagnosticLanguage: DiagnosticLanguage.TypeScript,\n\t\tlanguageIds: [languageIds.typescript, languageIds.typescriptreact],\n\t\tconfigFilePattern: /^tsconfig(\\..*)?\\.json$/i,\n\t\tstandardFileExtensions: [\n\t\t\t'ts',\n\t\t\t'tsx',\n\t\t\t'cts',\n\t\t\t'mts'\n\t\t],\n\t}, {\n\t\tid: 'javascript',\n\t\tdiagnosticOwner: 'typescript',\n\t\tdiagnosticSource: 'ts',\n\t\tdiagnosticLanguage: DiagnosticLanguage.JavaScript,\n\t\tlanguageIds: [languageIds.javascript, languageIds.javascriptreact],\n\t\tconfigFilePattern: /^jsconfig(\\..*)?\\.json$/i,\n\t\tstandardFileExtensions: [\n\t\t\t'js',\n\t\t\t'jsx',\n\t\t\t'cjs',\n\t\t\t'mjs',\n\t\t\t'es6',\n\t\t\t'pac',\n\t\t],\n\t}\n];\n\nexport function isTsConfigFileName(fileName: string): boolean {\n\treturn /^tsconfig\\.(.+\\.)?json$/i.test(basename(fileName));\n}\n\nexport function isJsConfigOrTsConfigFileName(fileName: string): boolean {\n\treturn /^[jt]sconfig\\.(.+\\.)?json$/i.test(basename(fileName));\n}\n\nexport function doesResourceLookLikeATypeScriptFile(resource: vscode.Uri): boolean {\n\treturn /\\.(tsx?|mts|cts)$/i.test(resource.fsPath);\n}\n\nexport function doesResourceLookLikeAJavaScriptFile(resource: vscode.Uri): boolean {\n\treturn /\\.(jsx?|mjs|cjs)$/i.test(resource.fsPath);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\n\nexport const typescript = 'typescript';\nexport const typescriptreact = 'typescriptreact';\nexport const javascript = 'javascript';\nexport const javascriptreact = 'javascriptreact';\nexport const jsxTags = 'jsx-tags';\n\nexport const jsTsLanguageModes = [\n\tjavascript,\n\tjavascriptreact,\n\ttypescript,\n\ttypescriptreact,\n];\n\nexport function isSupportedLanguageMode(doc: vscode.TextDocument) {\n\treturn vscode.languages.match([typescript, typescriptreact, javascript, javascriptreact], doc) > 0;\n}\n\nexport function isTypeScriptDocument(doc: vscode.TextDocument) {\n\treturn vscode.languages.match([typescript, typescriptreact], doc) > 0;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport const Schemes = Object.freeze({\n\tfile: 'file',\n\tuntitled: 'untitled',\n\tmailto: 'mailto',\n\tvscode: 'vscode',\n\t'vscode-insiders': 'vscode-insiders',\n\tnotebookCell: 'vscode-notebook-cell',\n});\n\nexport function isOfScheme(scheme: string, link: string): boolean {\n\treturn link.toLowerCase().startsWith(scheme + ':');\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport VsCodeTelemetryReporter from '@vscode/extension-telemetry';\nimport * as vscode from 'vscode';\nimport * as tas from 'vscode-tas-client';\n\nexport interface IExperimentationTelemetryReporter extends tas.IExperimentationTelemetry, vscode.Disposable {\n\tpostEventObj(eventName: string, props: { [prop: string]: string }): void;\n}\n\n/**\n * This reporter *supports* experimentation telemetry,\n * but will only do so when passed to an {@link ExperimentationService}.\n */\n\nexport class ExperimentationTelemetryReporter implements IExperimentationTelemetryReporter {\n\n\tprivate _sharedProperties: Record<string, string> = {};\n\tprivate readonly _reporter: VsCodeTelemetryReporter;\n\n\tconstructor(reporter: VsCodeTelemetryReporter) {\n\t\tthis._reporter = reporter;\n\t}\n\n\tsetSharedProperty(name: string, value: string): void {\n\t\tthis._sharedProperties[name] = value;\n\t}\n\n\tpostEvent(eventName: string, props: Map<string, string>): void {\n\t\tconst propsObject = {\n\t\t\t...this._sharedProperties,\n\t\t\t...Object.fromEntries(props),\n\t\t};\n\t\tthis._reporter.sendTelemetryEvent(eventName, propsObject);\n\t}\n\n\tpostEventObj(eventName: string, props: { [prop: string]: string }) {\n\t\tthis._reporter.sendTelemetryEvent(eventName, {\n\t\t\t...this._sharedProperties,\n\t\t\t...props,\n\t\t});\n\t}\n\n\tdispose() {\n\t\tthis._reporter.dispose();\n\t}\n}\n\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport VsCodeTelemetryReporter from '@vscode/extension-telemetry';\nimport * as vscode from 'vscode';\nimport { Api, getExtensionApi } from './api';\nimport { CommandManager } from './commands/commandManager';\nimport { registerBaseCommands } from './commands/index';\nimport { TypeScriptServiceConfiguration } from './configuration/configuration';\nimport { BrowserServiceConfigurationProvider } from './configuration/configuration.browser';\nimport { ExperimentationTelemetryReporter, IExperimentationTelemetryReporter } from './experimentTelemetryReporter';\nimport { registerAtaSupport } from './filesystems/ata';\nimport { createLazyClientHost, lazilyActivateClient } from './lazyClientHost';\nimport { Logger } from './logging/logger';\nimport RemoteRepositories from './remoteRepositories.browser';\nimport { API } from './tsServer/api';\nimport { noopRequestCancellerFactory } from './tsServer/cancellation';\nimport { noopLogDirectoryProvider } from './tsServer/logDirectoryProvider';\nimport { PluginManager } from './tsServer/plugins';\nimport { WorkerServerProcessFactory } from './tsServer/serverProcess.browser';\nimport { ITypeScriptVersionProvider, TypeScriptVersion, TypeScriptVersionSource } from './tsServer/versionProvider';\nimport { ActiveJsTsEditorTracker } from './ui/activeJsTsEditorTracker';\nimport { Disposable } from './utils/dispose';\nimport { getPackageInfo } from './utils/packageInfo';\nimport { isWebAndHasSharedArrayBuffers } from './utils/platform';\n\nclass StaticVersionProvider implements ITypeScriptVersionProvider {\n\n\tconstructor(\n\t\tprivate readonly _version: TypeScriptVersion\n\t) { }\n\n\tupdateConfiguration(_configuration: TypeScriptServiceConfiguration): void {\n\t\t// noop\n\t}\n\n\tget defaultVersion() { return this._version; }\n\tget bundledVersion() { return this._version; }\n\n\treadonly globalVersion = undefined;\n\treadonly localVersion = undefined;\n\treadonly localVersions = [];\n}\n\nexport async function activate(context: vscode.ExtensionContext): Promise<Api> {\n\tconst pluginManager = new PluginManager();\n\tcontext.subscriptions.push(pluginManager);\n\n\tconst commandManager = new CommandManager();\n\tcontext.subscriptions.push(commandManager);\n\n\tconst onCompletionAccepted = new vscode.EventEmitter<vscode.CompletionItem>();\n\tcontext.subscriptions.push(onCompletionAccepted);\n\n\tconst activeJsTsEditorTracker = new ActiveJsTsEditorTracker();\n\tcontext.subscriptions.push(activeJsTsEditorTracker);\n\n\tconst versionProvider = new StaticVersionProvider(\n\t\tnew TypeScriptVersion(\n\t\t\tTypeScriptVersionSource.Bundled,\n\t\t\tvscode.Uri.joinPath(context.extensionUri, 'dist/browser/typescript/tsserver.web.js').toString(),\n\t\t\tAPI.fromSimpleString('5.6.2')));\n\n\tlet experimentTelemetryReporter: IExperimentationTelemetryReporter | undefined;\n\tconst packageInfo = getPackageInfo(context);\n\tif (packageInfo) {\n\t\tconst { aiKey } = packageInfo;\n\t\tconst vscTelemetryReporter = new VsCodeTelemetryReporter(aiKey);\n\t\texperimentTelemetryReporter = new ExperimentationTelemetryReporter(vscTelemetryReporter);\n\t\tcontext.subscriptions.push(experimentTelemetryReporter);\n\t}\n\n\tconst logger = new Logger();\n\n\tconst lazyClientHost = createLazyClientHost(context, false, {\n\t\tpluginManager,\n\t\tcommandManager,\n\t\tlogDirectoryProvider: noopLogDirectoryProvider,\n\t\tcancellerFactory: noopRequestCancellerFactory,\n\t\tversionProvider,\n\t\tprocessFactory: new WorkerServerProcessFactory(context.extensionUri, logger),\n\t\tactiveJsTsEditorTracker,\n\t\tserviceConfigurationProvider: new BrowserServiceConfigurationProvider(),\n\t\texperimentTelemetryReporter,\n\t\tlogger,\n\t}, item => {\n\t\tonCompletionAccepted.fire(item);\n\t});\n\n\tregisterBaseCommands(commandManager, lazyClientHost, pluginManager, activeJsTsEditorTracker);\n\n\t// context.subscriptions.push(task.register(lazyClientHost.map(x => x.serviceClient)));\n\n\timport('./languageFeatures/tsconfig').then(module => {\n\t\tcontext.subscriptions.push(module.register());\n\t});\n\n\tcontext.subscriptions.push(lazilyActivateClient(lazyClientHost, pluginManager, activeJsTsEditorTracker, async () => {\n\t\tawait startPreloadWorkspaceContentsIfNeeded(context, logger);\n\t}));\n\n\tcontext.subscriptions.push(registerAtaSupport(logger));\n\n\treturn getExtensionApi(onCompletionAccepted.event, pluginManager);\n}\n\nasync function startPreloadWorkspaceContentsIfNeeded(context: vscode.ExtensionContext, logger: Logger): Promise<void> {\n\tif (!isWebAndHasSharedArrayBuffers()) {\n\t\treturn;\n\t}\n\n\tif (!vscode.workspace.workspaceFolders) {\n\t\treturn;\n\t}\n\n\tawait Promise.all(vscode.workspace.workspaceFolders.map(async folder => {\n\t\tconst workspaceUri = folder.uri;\n\t\tif (workspaceUri.scheme !== 'vscode-vfs' || !workspaceUri.authority.startsWith('github')) {\n\t\t\tlogger.info(`Skipped pre loading workspace contents for repository ${workspaceUri?.toString()}`);\n\t\t\treturn;\n\t\t}\n\n\t\tconst loader = new RemoteWorkspaceContentsPreloader(workspaceUri, logger);\n\t\tcontext.subscriptions.push(loader);\n\t\ttry {\n\t\t\tawait loader.triggerPreload();\n\t\t} catch (error) {\n\t\t\tconsole.error(error);\n\t\t}\n\t}));\n}\n\nclass RemoteWorkspaceContentsPreloader extends Disposable {\n\n\tprivate _preload: Promise<void> | undefined;\n\n\tconstructor(\n\t\tprivate readonly workspaceUri: vscode.Uri,\n\t\tprivate readonly logger: Logger,\n\t) {\n\t\tsuper();\n\n\t\tconst fsWatcher = this._register(vscode.workspace.createFileSystemWatcher(new vscode.RelativePattern(workspaceUri, '*')));\n\t\tthis._register(fsWatcher.onDidChange(uri => {\n\t\t\tif (uri.toString() === workspaceUri.toString()) {\n\t\t\t\tthis._preload = undefined;\n\t\t\t\tthis.triggerPreload();\n\t\t\t}\n\t\t}));\n\t}\n\n\tasync triggerPreload() {\n\t\tthis._preload ??= this.doPreload();\n\t\treturn this._preload;\n\t}\n\n\tprivate async doPreload(): Promise<void> {\n\t\ttry {\n\t\t\tconst remoteHubApi = await RemoteRepositories.getApi();\n\t\t\tif (await remoteHubApi.loadWorkspaceContents?.(this.workspaceUri)) {\n\t\t\t\tthis.logger.info(`Successfully loaded workspace content for repository ${this.workspaceUri.toString()}`);\n\t\t\t} else {\n\t\t\t\tthis.logger.info(`Failed to load workspace content for repository ${this.workspaceUri.toString()}`);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tthis.logger.info(`Loading workspace content for repository ${this.workspaceUri.toString()} failed: ${error instanceof Error ? error.toString() : 'Unknown reason'}`);\n\t\t\tconsole.error(error);\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { conditionalRegistration, requireGlobalConfiguration } from '../languageFeatures/util/dependentRegistration';\nimport { supportsReadableByteStreams } from '../utils/platform';\nimport { AutoInstallerFs } from './autoInstallerFs';\nimport { MemFs } from './memFs';\nimport { Logger } from '../logging/logger';\n\nexport function registerAtaSupport(logger: Logger): vscode.Disposable {\n\tif (!supportsReadableByteStreams()) {\n\t\treturn vscode.Disposable.from();\n\t}\n\n\treturn conditionalRegistration([\n\t\trequireGlobalConfiguration('typescript', 'tsserver.web.typeAcquisition.enabled'),\n\t], () => {\n\t\treturn vscode.Disposable.from(\n\t\t\t// Ata\n\t\t\tvscode.workspace.registerFileSystemProvider('vscode-global-typings', new MemFs('global-typings', logger), {\n\t\t\t\tisCaseSensitive: true,\n\t\t\t\tisReadonly: false,\n\t\t\t}),\n\n\t\t\t// Read accesses to node_modules\n\t\t\tvscode.workspace.registerFileSystemProvider('vscode-node-modules', new AutoInstallerFs(logger), {\n\t\t\t\tisCaseSensitive: true,\n\t\t\t\tisReadonly: false\n\t\t\t}));\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { PackageManager, ResolvedProject } from '@vscode/ts-package-manager';\nimport { basename, join } from 'path';\nimport * as vscode from 'vscode';\nimport { URI } from 'vscode-uri';\nimport { Disposable } from '../utils/dispose';\nimport { MemFs } from './memFs';\nimport { Logger } from '../logging/logger';\n\nconst TEXT_DECODER = new TextDecoder('utf-8');\nconst TEXT_ENCODER = new TextEncoder();\n\nexport class AutoInstallerFs extends Disposable implements vscode.FileSystemProvider {\n\n\tprivate readonly memfs: MemFs;\n\tprivate readonly packageManager: PackageManager;\n\tprivate readonly _projectCache = new Map</* root */ string, Promise<void> | undefined>();\n\n\tprivate readonly _emitter = this._register(new vscode.EventEmitter<vscode.FileChangeEvent[]>());\n\treadonly onDidChangeFile = this._emitter.event;\n\n\tconstructor(\n\t\tprivate readonly logger: Logger\n\t) {\n\t\tsuper();\n\n\t\tconst memfs = new MemFs('auto-installer', logger);\n\t\tthis.memfs = memfs;\n\t\tmemfs.onDidChangeFile((e) => {\n\t\t\tthis._emitter.fire(e.map(ev => ({\n\t\t\t\ttype: ev.type,\n\t\t\t\t// TODO: we're gonna need a MappedUri dance...\n\t\t\t\turi: ev.uri.with({ scheme: 'memfs' })\n\t\t\t})));\n\t\t});\n\n\t\tthis.packageManager = new PackageManager({\n\t\t\treadDirectory(path: string, _extensions?: readonly string[], _exclude?: readonly string[], _include?: readonly string[], _depth?: number): string[] {\n\t\t\t\treturn memfs.readDirectory(URI.file(path)).map(([name, _]) => name);\n\t\t\t},\n\n\t\t\tdeleteFile(path: string): void {\n\t\t\t\tmemfs.delete(URI.file(path));\n\t\t\t},\n\n\t\t\tcreateDirectory(path: string): void {\n\t\t\t\tmemfs.createDirectory(URI.file(path));\n\t\t\t},\n\n\t\t\twriteFile(path: string, data: string, _writeByteOrderMark?: boolean): void {\n\t\t\t\tmemfs.writeFile(URI.file(path), TEXT_ENCODER.encode(data), { overwrite: true, create: true });\n\t\t\t},\n\n\t\t\tdirectoryExists(path: string): boolean {\n\t\t\t\ttry {\n\t\t\t\t\tconst stat = memfs.stat(URI.file(path));\n\t\t\t\t\treturn stat.type === vscode.FileType.Directory;\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\treadFile(path: string, _encoding?: string): string | undefined {\n\t\t\t\ttry {\n\t\t\t\t\treturn TEXT_DECODER.decode(memfs.readFile(URI.file(path)));\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\twatch(resource: vscode.Uri): vscode.Disposable {\n\t\tthis.logger.trace(`AutoInstallerFs.watch. Resource: ${resource.toString()}}`);\n\t\treturn this.memfs.watch(resource);\n\t}\n\n\tasync stat(uri: vscode.Uri): Promise<vscode.FileStat> {\n\t\tthis.logger.trace(`AutoInstallerFs.stat: ${uri}`);\n\n\t\tconst mapped = new MappedUri(uri);\n\n\t\t// TODO: case sensitivity configuration\n\n\t\t// We pretend every single node_modules or @types directory ever actually\n\t\t// exists.\n\t\tif (basename(mapped.path) === 'node_modules' || basename(mapped.path) === '@types') {\n\t\t\treturn {\n\t\t\t\tmtime: 0,\n\t\t\t\tctime: 0,\n\t\t\t\ttype: vscode.FileType.Directory,\n\t\t\t\tsize: 0\n\t\t\t};\n\t\t}\n\n\t\tawait this.ensurePackageContents(mapped);\n\n\t\treturn this.memfs.stat(URI.file(mapped.path));\n\t}\n\n\tasync readDirectory(uri: vscode.Uri): Promise<[string, vscode.FileType][]> {\n\t\tthis.logger.trace(`AutoInstallerFs.readDirectory: ${uri}`);\n\n\t\tconst mapped = new MappedUri(uri);\n\t\tawait this.ensurePackageContents(mapped);\n\n\t\treturn this.memfs.readDirectory(URI.file(mapped.path));\n\t}\n\n\tasync readFile(uri: vscode.Uri): Promise<Uint8Array> {\n\t\tthis.logger.trace(`AutoInstallerFs.readFile: ${uri}`);\n\n\t\tconst mapped = new MappedUri(uri);\n\t\tawait this.ensurePackageContents(mapped);\n\n\t\treturn this.memfs.readFile(URI.file(mapped.path));\n\t}\n\n\twriteFile(_uri: vscode.Uri, _content: Uint8Array, _options: { create: boolean; overwrite: boolean }): void {\n\t\tthrow new Error('not implemented');\n\t}\n\n\trename(_oldUri: vscode.Uri, _newUri: vscode.Uri, _options: { overwrite: boolean }): void {\n\t\tthrow new Error('not implemented');\n\t}\n\n\tdelete(_uri: vscode.Uri): void {\n\t\tthrow new Error('not implemented');\n\t}\n\n\tcreateDirectory(_uri: vscode.Uri): void {\n\t\tthrow new Error('not implemented');\n\t}\n\n\tprivate async ensurePackageContents(incomingUri: MappedUri): Promise<void> {\n\t\t// If we're not looking for something inside node_modules, bail early.\n\t\tif (!incomingUri.path.includes('node_modules')) {\n\t\t\tthrow vscode.FileSystemError.FileNotFound();\n\t\t}\n\n\t\t// standard lib files aren't handled through here\n\t\tif (incomingUri.path.includes('node_modules/@typescript') || incomingUri.path.includes('node_modules/@types/typescript__')) {\n\t\t\tthrow vscode.FileSystemError.FileNotFound();\n\t\t}\n\n\t\tconst root = await this.getProjectRoot(incomingUri.original);\n\t\tif (!root) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.logger.trace(`AutoInstallerFs.ensurePackageContents. Path: ${incomingUri.path}, Root: ${root}`);\n\n\t\tconst existingInstall = this._projectCache.get(root);\n\t\tif (existingInstall) {\n\t\t\tthis.logger.trace(`AutoInstallerFs.ensurePackageContents. Found ongoing install for: ${root}/node_modules`);\n\t\t\treturn existingInstall;\n\t\t}\n\n\t\tconst installing = (async () => {\n\t\t\tlet proj: ResolvedProject;\n\t\t\ttry {\n\t\t\t\tproj = await this.packageManager.resolveProject(root, await this.getInstallOpts(incomingUri.original, root));\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(`failed to resolve project at ${incomingUri.path}: `, e);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tawait proj.restore();\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(`failed to restore package at ${incomingUri.path}: `, e);\n\t\t\t}\n\t\t})();\n\t\tthis._projectCache.set(root, installing);\n\t\tawait installing;\n\t}\n\n\tprivate async getInstallOpts(originalUri: URI, root: string) {\n\t\tconst vsfs = vscode.workspace.fs;\n\n\t\t// We definitely need a package.json to be there.\n\t\tconst pkgJson = TEXT_DECODER.decode(await vsfs.readFile(originalUri.with({ path: join(root, 'package.json') })));\n\n\t\tlet kdlLock;\n\t\ttry {\n\t\t\tkdlLock = TEXT_DECODER.decode(await vsfs.readFile(originalUri.with({ path: join(root, 'package-lock.kdl') })));\n\t\t} catch (e) { }\n\n\t\tlet npmLock;\n\t\ttry {\n\t\t\tnpmLock = TEXT_DECODER.decode(await vsfs.readFile(originalUri.with({ path: join(root, 'package-lock.json') })));\n\t\t} catch (e) { }\n\n\t\treturn {\n\t\t\tpkgJson,\n\t\t\tkdlLock,\n\t\t\tnpmLock\n\t\t};\n\t}\n\n\tprivate async getProjectRoot(incomingUri: URI): Promise<string | undefined> {\n\t\tconst vsfs = vscode.workspace.fs;\n\t\tconst pkgPath = incomingUri.path.match(/^(.*?)\\/node_modules/);\n\t\tconst ret = pkgPath?.[1];\n\t\tif (!ret) {\n\t\t\treturn;\n\t\t}\n\t\ttry {\n\t\t\tawait vsfs.stat(incomingUri.with({ path: join(ret, 'package.json') }));\n\t\t\treturn ret;\n\t\t} catch (e) {\n\t\t\treturn;\n\t\t}\n\t}\n}\n\nclass MappedUri {\n\treadonly raw: vscode.Uri;\n\treadonly original: vscode.Uri;\n\treadonly mapped: vscode.Uri;\n\tconstructor(uri: vscode.Uri) {\n\t\tthis.raw = uri;\n\n\t\tconst parts = uri.path.match(/^\\/([^\\/]+)\\/([^\\/]*)(?:\\/(.+))?$/);\n\t\tif (!parts) {\n\t\t\tthrow new Error(`Invalid uri: ${uri.toString()}, ${uri.path}`);\n\t\t}\n\n\t\tconst scheme = parts[1];\n\t\tconst authority = parts[2] === 'ts-nul-authority' ? '' : parts[2];\n\t\tconst path = parts[3];\n\t\tthis.original = URI.from({ scheme, authority, path: (path ? '/' + path : path) });\n\t\tthis.mapped = this.original.with({ scheme: this.raw.scheme, authority: this.raw.authority });\n\t}\n\n\tget path() {\n\t\treturn this.mapped.path;\n\t}\n\tget scheme() {\n\t\treturn this.mapped.scheme;\n\t}\n\tget authority() {\n\t\treturn this.mapped.authority;\n\t}\n\tget flatPath() {\n\t\treturn join('/', this.scheme, this.authority, this.path);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { basename, dirname } from 'path';\nimport * as vscode from 'vscode';\nimport { Logger } from '../logging/logger';\n\nexport class MemFs implements vscode.FileSystemProvider {\n\n\tprivate readonly root = new FsDirectoryEntry(\n\t\tnew Map(),\n\t\t0,\n\t\t0,\n\t);\n\n\tconstructor(\n\t\tprivate readonly id: string,\n\t\tprivate readonly logger: Logger,\n\t) { }\n\n\tstat(uri: vscode.Uri): vscode.FileStat {\n\t\tthis.logger.trace(`MemFs.stat ${this.id}. uri: ${uri}`);\n\t\tconst entry = this.getEntry(uri);\n\t\tif (!entry) {\n\t\t\tthrow vscode.FileSystemError.FileNotFound();\n\t\t}\n\n\t\treturn entry;\n\t}\n\n\treadDirectory(uri: vscode.Uri): [string, vscode.FileType][] {\n\t\tthis.logger.trace(`MemFs.readDirectory ${this.id}. uri: ${uri}`);\n\n\t\tconst entry = this.getEntry(uri);\n\t\tif (!entry) {\n\t\t\tthrow vscode.FileSystemError.FileNotFound();\n\t\t}\n\t\tif (!(entry instanceof FsDirectoryEntry)) {\n\t\t\tthrow vscode.FileSystemError.FileNotADirectory();\n\t\t}\n\n\t\treturn Array.from(entry.contents.entries(), ([name, entry]) => [name, entry.type]);\n\t}\n\n\treadFile(uri: vscode.Uri): Uint8Array {\n\t\tthis.logger.trace(`MemFs.readFile ${this.id}. uri: ${uri}`);\n\n\t\tconst entry = this.getEntry(uri);\n\t\tif (!entry) {\n\t\t\tthrow vscode.FileSystemError.FileNotFound();\n\t\t}\n\n\t\tif (!(entry instanceof FsFileEntry)) {\n\t\t\tthrow vscode.FileSystemError.FileIsADirectory(uri);\n\t\t}\n\n\t\treturn entry.data;\n\t}\n\n\twriteFile(uri: vscode.Uri, content: Uint8Array, { create, overwrite }: { create: boolean; overwrite: boolean }): void {\n\t\tthis.logger.trace(`MemFs.writeFile ${this.id}. uri: ${uri}`);\n\n\t\tconst dir = this.getParent(uri);\n\n\t\tconst fileName = basename(uri.path);\n\t\tconst dirContents = dir.contents;\n\n\t\tconst time = Date.now() / 1000;\n\t\tconst entry = dirContents.get(basename(uri.path));\n\t\tif (!entry) {\n\t\t\tif (create) {\n\t\t\t\tdirContents.set(fileName, new FsFileEntry(content, time, time));\n\t\t\t\tthis._emitter.fire([{ type: vscode.FileChangeType.Created, uri }]);\n\t\t\t} else {\n\t\t\t\tthrow vscode.FileSystemError.FileNotFound();\n\t\t\t}\n\t\t} else {\n\t\t\tif (entry instanceof FsDirectoryEntry) {\n\t\t\t\tthrow vscode.FileSystemError.FileIsADirectory(uri);\n\t\t\t}\n\n\t\t\tif (overwrite) {\n\t\t\t\tentry.mtime = time;\n\t\t\t\tentry.data = content;\n\t\t\t\tthis._emitter.fire([{ type: vscode.FileChangeType.Changed, uri }]);\n\t\t\t} else {\n\t\t\t\tthrow vscode.FileSystemError.NoPermissions('overwrite option was not passed in');\n\t\t\t}\n\t\t}\n\t}\n\n\trename(_oldUri: vscode.Uri, _newUri: vscode.Uri, _options: { overwrite: boolean }): void {\n\t\tthrow new Error('not implemented');\n\t}\n\n\tdelete(uri: vscode.Uri): void {\n\t\ttry {\n\t\t\tconst dir = this.getParent(uri);\n\t\t\tdir.contents.delete(basename(uri.path));\n\t\t\tthis._emitter.fire([{ type: vscode.FileChangeType.Deleted, uri }]);\n\t\t} catch (e) { }\n\t}\n\n\tcreateDirectory(uri: vscode.Uri): void {\n\t\tthis.logger.trace(`MemFs.createDirectory ${this.id}. uri: ${uri}`);\n\n\t\tconst dir = this.getParent(uri);\n\t\tconst now = Date.now() / 1000;\n\t\tdir.contents.set(basename(uri.path), new FsDirectoryEntry(new Map(), now, now));\n\t}\n\n\tprivate getEntry(uri: vscode.Uri): FsEntry | undefined {\n\t\t// TODO: have this throw FileNotFound itself?\n\t\t// TODO: support configuring case sensitivity\n\t\tlet node: FsEntry = this.root;\n\t\tfor (const component of uri.path.split('/')) {\n\t\t\tif (!component) {\n\t\t\t\t// Skip empty components (root, stuff between double slashes,\n\t\t\t\t// trailing slashes)\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (!(node instanceof FsDirectoryEntry)) {\n\t\t\t\t// We're looking at a File or such, so bail.\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst next = node.contents.get(component);\n\t\t\tif (!next) {\n\t\t\t\t// not found!\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tnode = next;\n\t\t}\n\t\treturn node;\n\t}\n\n\tprivate getParent(uri: vscode.Uri): FsDirectoryEntry {\n\t\tconst dir = this.getEntry(uri.with({ path: dirname(uri.path) }));\n\t\tif (!dir) {\n\t\t\tthrow vscode.FileSystemError.FileNotFound();\n\t\t}\n\t\tif (!(dir instanceof FsDirectoryEntry)) {\n\t\t\tthrow vscode.FileSystemError.FileNotADirectory();\n\t\t}\n\t\treturn dir;\n\t}\n\n\t// --- manage file events\n\n\tprivate readonly _emitter = new vscode.EventEmitter<vscode.FileChangeEvent[]>();\n\n\treadonly onDidChangeFile: vscode.Event<vscode.FileChangeEvent[]> = this._emitter.event;\n\tprivate readonly watchers = new Map<string, Set<Symbol>>;\n\n\twatch(resource: vscode.Uri): vscode.Disposable {\n\t\tif (!this.watchers.has(resource.path)) {\n\t\t\tthis.watchers.set(resource.path, new Set());\n\t\t}\n\t\tconst sy = Symbol(resource.path);\n\t\treturn new vscode.Disposable(() => {\n\t\t\tconst watcher = this.watchers.get(resource.path);\n\t\t\tif (watcher) {\n\t\t\t\twatcher.delete(sy);\n\t\t\t\tif (!watcher.size) {\n\t\t\t\t\tthis.watchers.delete(resource.path);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nclass FsFileEntry {\n\treadonly type = vscode.FileType.File;\n\n\tget size(): number {\n\t\treturn this.data.length;\n\t}\n\n\tconstructor(\n\t\tpublic data: Uint8Array,\n\t\tpublic readonly ctime: number,\n\t\tpublic mtime: number,\n\t) { }\n}\n\nclass FsDirectoryEntry {\n\treadonly type = vscode.FileType.Directory;\n\n\tget size(): number {\n\t\treturn [...this.contents.values()].reduce((acc: number, entry: FsEntry) => acc + entry.size, 0);\n\t}\n\n\tconstructor(\n\t\tpublic readonly contents: Map<string, FsEntry>,\n\t\tpublic readonly ctime: number,\n\t\tpublic readonly mtime: number,\n\t) { }\n}\n\ntype FsEntry = FsFileEntry | FsDirectoryEntry;\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as path from 'path';\nimport * as vscode from 'vscode';\nimport { DocumentSelector } from '../configuration/documentSelector';\nimport { API } from '../tsServer/api';\nimport { parseKindModifier } from '../tsServer/protocol/modifiers';\nimport type * as Proto from '../tsServer/protocol/protocol';\nimport * as PConst from '../tsServer/protocol/protocol.const';\nimport * as typeConverters from '../typeConverters';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport { conditionalRegistration, requireMinVersion, requireSomeCapability } from './util/dependentRegistration';\n\nclass TypeScriptCallHierarchySupport implements vscode.CallHierarchyProvider {\n\tpublic static readonly minVersion = API.v380;\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient\n\t) { }\n\n\tpublic async prepareCallHierarchy(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.CallHierarchyItem | vscode.CallHierarchyItem[] | undefined> {\n\t\tconst filepath = this.client.toOpenTsFilePath(document);\n\t\tif (!filepath) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst args = typeConverters.Position.toFileLocationRequestArgs(filepath, position);\n\t\tconst response = await this.client.execute('prepareCallHierarchy', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn Array.isArray(response.body)\n\t\t\t? response.body.map(fromProtocolCallHierarchyItem)\n\t\t\t: fromProtocolCallHierarchyItem(response.body);\n\t}\n\n\tpublic async provideCallHierarchyIncomingCalls(item: vscode.CallHierarchyItem, token: vscode.CancellationToken): Promise<vscode.CallHierarchyIncomingCall[] | undefined> {\n\t\tconst filepath = this.client.toTsFilePath(item.uri);\n\t\tif (!filepath) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst args = typeConverters.Position.toFileLocationRequestArgs(filepath, item.selectionRange.start);\n\t\tconst response = await this.client.execute('provideCallHierarchyIncomingCalls', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn response.body.map(fromProtocolCallHierarchyIncomingCall);\n\t}\n\n\tpublic async provideCallHierarchyOutgoingCalls(item: vscode.CallHierarchyItem, token: vscode.CancellationToken): Promise<vscode.CallHierarchyOutgoingCall[] | undefined> {\n\t\tconst filepath = this.client.toTsFilePath(item.uri);\n\t\tif (!filepath) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst args = typeConverters.Position.toFileLocationRequestArgs(filepath, item.selectionRange.start);\n\t\tconst response = await this.client.execute('provideCallHierarchyOutgoingCalls', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn response.body.map(fromProtocolCallHierarchyOutgoingCall);\n\t}\n}\n\nfunction isSourceFileItem(item: Proto.CallHierarchyItem) {\n\treturn item.kind === PConst.Kind.script || item.kind === PConst.Kind.module && item.selectionSpan.start.line === 1 && item.selectionSpan.start.offset === 1;\n}\n\nfunction fromProtocolCallHierarchyItem(item: Proto.CallHierarchyItem): vscode.CallHierarchyItem {\n\tconst useFileName = isSourceFileItem(item);\n\tconst name = useFileName ? path.basename(item.file) : item.name;\n\tconst detail = useFileName ? vscode.workspace.asRelativePath(path.dirname(item.file)) : item.containerName ?? '';\n\tconst result = new vscode.CallHierarchyItem(\n\t\ttypeConverters.SymbolKind.fromProtocolScriptElementKind(item.kind),\n\t\tname,\n\t\tdetail,\n\t\tvscode.Uri.file(item.file),\n\t\ttypeConverters.Range.fromTextSpan(item.span),\n\t\ttypeConverters.Range.fromTextSpan(item.selectionSpan)\n\t);\n\n\tconst kindModifiers = item.kindModifiers ? parseKindModifier(item.kindModifiers) : undefined;\n\tif (kindModifiers?.has(PConst.KindModifiers.deprecated)) {\n\t\tresult.tags = [vscode.SymbolTag.Deprecated];\n\t}\n\treturn result;\n}\n\nfunction fromProtocolCallHierarchyIncomingCall(item: Proto.CallHierarchyIncomingCall): vscode.CallHierarchyIncomingCall {\n\treturn new vscode.CallHierarchyIncomingCall(\n\t\tfromProtocolCallHierarchyItem(item.from),\n\t\titem.fromSpans.map(typeConverters.Range.fromTextSpan)\n\t);\n}\n\nfunction fromProtocolCallHierarchyOutgoingCall(item: Proto.CallHierarchyOutgoingCall): vscode.CallHierarchyOutgoingCall {\n\treturn new vscode.CallHierarchyOutgoingCall(\n\t\tfromProtocolCallHierarchyItem(item.to),\n\t\titem.fromSpans.map(typeConverters.Range.fromTextSpan)\n\t);\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient\n) {\n\treturn conditionalRegistration([\n\t\trequireMinVersion(client, TypeScriptCallHierarchySupport.minVersion),\n\t\trequireSomeCapability(client, ClientCapability.Semantic),\n\t], () => {\n\t\treturn vscode.languages.registerCallHierarchyProvider(selector.semantic,\n\t\t\tnew TypeScriptCallHierarchySupport(client));\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { CachedResponse } from '../../tsServer/cachedResponse';\nimport type * as Proto from '../../tsServer/protocol/protocol';\nimport * as typeConverters from '../../typeConverters';\nimport { ITypeScriptServiceClient } from '../../typescriptService';\nimport { escapeRegExp } from '../../utils/regexp';\nimport { Disposable } from '../../utils/dispose';\n\n\nexport class ReferencesCodeLens extends vscode.CodeLens {\n\tconstructor(\n\t\tpublic document: vscode.Uri,\n\t\tpublic file: string,\n\t\trange: vscode.Range\n\t) {\n\t\tsuper(range);\n\t}\n}\n\nexport abstract class TypeScriptBaseCodeLensProvider extends Disposable implements vscode.CodeLensProvider<ReferencesCodeLens> {\n\tprotected changeEmitter = this._register(new vscode.EventEmitter<void>());\n\tpublic onDidChangeCodeLenses = this.changeEmitter.event;\n\n\tpublic static readonly cancelledCommand: vscode.Command = {\n\t\t// Cancellation is not an error. Just show nothing until we can properly re-compute the code lens\n\t\ttitle: '',\n\t\tcommand: ''\n\t};\n\n\tpublic static readonly errorCommand: vscode.Command = {\n\t\ttitle: vscode.l10n.t(\"Could not determine references\"),\n\t\tcommand: ''\n\t};\n\n\tpublic constructor(\n\t\tprotected client: ITypeScriptServiceClient,\n\t\tprivate readonly cachedResponse: CachedResponse<Proto.NavTreeResponse>\n\t) {\n\t\tsuper();\n\t}\n\n\tasync provideCodeLenses(document: vscode.TextDocument, token: vscode.CancellationToken): Promise<ReferencesCodeLens[]> {\n\t\tconst filepath = this.client.toOpenTsFilePath(document);\n\t\tif (!filepath) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst response = await this.cachedResponse.execute(document, () => this.client.execute('navtree', { file: filepath }, token));\n\t\tif (response.type !== 'response') {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst referenceableSpans: vscode.Range[] = [];\n\t\tresponse.body?.childItems?.forEach(item => this.walkNavTree(document, item, undefined, referenceableSpans));\n\t\treturn referenceableSpans.map(span => new ReferencesCodeLens(document.uri, filepath, span));\n\t}\n\n\tprotected abstract extractSymbol(\n\t\tdocument: vscode.TextDocument,\n\t\titem: Proto.NavigationTree,\n\t\tparent: Proto.NavigationTree | undefined\n\t): vscode.Range | undefined;\n\n\tprivate walkNavTree(\n\t\tdocument: vscode.TextDocument,\n\t\titem: Proto.NavigationTree,\n\t\tparent: Proto.NavigationTree | undefined,\n\t\tresults: vscode.Range[]\n\t): void {\n\t\tconst range = this.extractSymbol(document, item, parent);\n\t\tif (range) {\n\t\t\tresults.push(range);\n\t\t}\n\n\t\titem.childItems?.forEach(child => this.walkNavTree(document, child, item, results));\n\t}\n}\n\nexport function getSymbolRange(\n\tdocument: vscode.TextDocument,\n\titem: Proto.NavigationTree\n): vscode.Range | undefined {\n\tif (item.nameSpan) {\n\t\treturn typeConverters.Range.fromTextSpan(item.nameSpan);\n\t}\n\n\t// In older versions, we have to calculate this manually. See #23924\n\tconst span = item.spans?.[0];\n\tif (!span) {\n\t\treturn undefined;\n\t}\n\n\tconst range = typeConverters.Range.fromTextSpan(span);\n\tconst text = document.getText(range);\n\n\tconst identifierMatch = new RegExp(`^(.*?(\\\\b|\\\\W))${escapeRegExp(item.text || '')}(\\\\b|\\\\W)`, 'gm');\n\tconst match = identifierMatch.exec(text);\n\tconst prefixLength = match ? match.index + match[1].length : 0;\n\tconst startOffset = document.offsetAt(new vscode.Position(range.start.line, range.start.character)) + prefixLength;\n\treturn new vscode.Range(\n\t\tdocument.positionAt(startOffset),\n\t\tdocument.positionAt(startOffset + item.text.length));\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { DocumentSelector } from '../../configuration/documentSelector';\nimport { LanguageDescription } from '../../configuration/languageDescription';\nimport { CachedResponse } from '../../tsServer/cachedResponse';\nimport type * as Proto from '../../tsServer/protocol/protocol';\nimport * as PConst from '../../tsServer/protocol/protocol.const';\nimport * as typeConverters from '../../typeConverters';\nimport { ClientCapability, ITypeScriptServiceClient } from '../../typescriptService';\nimport { conditionalRegistration, requireGlobalConfiguration, requireSomeCapability } from '../util/dependentRegistration';\nimport { ReferencesCodeLens, TypeScriptBaseCodeLensProvider, getSymbolRange } from './baseCodeLensProvider';\nimport { ExecutionTarget } from '../../tsServer/server';\n\n\nexport default class TypeScriptImplementationsCodeLensProvider extends TypeScriptBaseCodeLensProvider {\n\tpublic constructor(\n\t\tclient: ITypeScriptServiceClient,\n\t\tprotected _cachedResponse: CachedResponse<Proto.NavTreeResponse>,\n\t\tprivate readonly language: LanguageDescription\n\t) {\n\t\tsuper(client, _cachedResponse);\n\t\tthis._register(\n\t\t\tvscode.workspace.onDidChangeConfiguration(evt => {\n\t\t\t\tif (evt.affectsConfiguration(`${language.id}.implementationsCodeLens.showOnInterfaceMethods`)) {\n\t\t\t\t\tthis.changeEmitter.fire();\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t}\n\n\tpublic async resolveCodeLens(\n\t\tcodeLens: ReferencesCodeLens,\n\t\ttoken: vscode.CancellationToken,\n\t): Promise<vscode.CodeLens> {\n\t\tconst args = typeConverters.Position.toFileLocationRequestArgs(codeLens.file, codeLens.range.start);\n\t\tconst response = await this.client.execute('implementation', args, token, {\n\t\t\tlowPriority: true,\n\t\t\texecutionTarget: ExecutionTarget.Semantic,\n\t\t\tcancelOnResourceChange: codeLens.document,\n\t\t});\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\tcodeLens.command = response.type === 'cancelled'\n\t\t\t\t? TypeScriptBaseCodeLensProvider.cancelledCommand\n\t\t\t\t: TypeScriptBaseCodeLensProvider.errorCommand;\n\t\t\treturn codeLens;\n\t\t}\n\n\t\tconst locations = response.body\n\t\t\t.map(reference =>\n\t\t\t\t// Only take first line on implementation: https://github.com/microsoft/vscode/issues/23924\n\t\t\t\tnew vscode.Location(this.client.toResource(reference.file),\n\t\t\t\t\treference.start.line === reference.end.line\n\t\t\t\t\t\t? typeConverters.Range.fromTextSpan(reference)\n\t\t\t\t\t\t: new vscode.Range(\n\t\t\t\t\t\t\ttypeConverters.Position.fromLocation(reference.start),\n\t\t\t\t\t\t\tnew vscode.Position(reference.start.line, 0))))\n\t\t\t// Exclude original from implementations\n\t\t\t.filter(location =>\n\t\t\t\t!(location.uri.toString() === codeLens.document.toString() &&\n\t\t\t\t\tlocation.range.start.line === codeLens.range.start.line &&\n\t\t\t\t\tlocation.range.start.character === codeLens.range.start.character));\n\n\t\tcodeLens.command = this.getCommand(locations, codeLens);\n\t\treturn codeLens;\n\t}\n\n\tprivate getCommand(locations: vscode.Location[], codeLens: ReferencesCodeLens): vscode.Command | undefined {\n\t\treturn {\n\t\t\ttitle: this.getTitle(locations),\n\t\t\tcommand: locations.length ? 'editor.action.showReferences' : '',\n\t\t\targuments: [codeLens.document, codeLens.range.start, locations]\n\t\t};\n\t}\n\n\tprivate getTitle(locations: vscode.Location[]): string {\n\t\treturn locations.length === 1\n\t\t\t? vscode.l10n.t(\"1 implementation\")\n\t\t\t: vscode.l10n.t(\"{0} implementations\", locations.length);\n\t}\n\n\tprotected extractSymbol(\n\t\tdocument: vscode.TextDocument,\n\t\titem: Proto.NavigationTree,\n\t\tparent: Proto.NavigationTree | undefined\n\t): vscode.Range | undefined {\n\t\tif (item.kind === PConst.Kind.method && parent && parent.kind === PConst.Kind.interface && vscode.workspace.getConfiguration(this.language.id).get<boolean>('implementationsCodeLens.showOnInterfaceMethods')) {\n\t\t\treturn getSymbolRange(document, item);\n\t\t}\n\t\tswitch (item.kind) {\n\t\t\tcase PConst.Kind.interface:\n\t\t\t\treturn getSymbolRange(document, item);\n\n\t\t\tcase PConst.Kind.class:\n\t\t\tcase PConst.Kind.method:\n\t\t\tcase PConst.Kind.memberVariable:\n\t\t\tcase PConst.Kind.memberGetAccessor:\n\t\t\tcase PConst.Kind.memberSetAccessor:\n\t\t\t\tif (item.kindModifiers.match(/\\babstract\\b/g)) {\n\t\t\t\t\treturn getSymbolRange(document, item);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tlanguage: LanguageDescription,\n\tclient: ITypeScriptServiceClient,\n\tcachedResponse: CachedResponse<Proto.NavTreeResponse>,\n) {\n\treturn conditionalRegistration([\n\t\trequireGlobalConfiguration(language.id, 'implementationsCodeLens.enabled'),\n\t\trequireSomeCapability(client, ClientCapability.Semantic),\n\t], () => {\n\t\treturn vscode.languages.registerCodeLensProvider(selector.semantic,\n\t\t\tnew TypeScriptImplementationsCodeLensProvider(client, cachedResponse, language));\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { DocumentSelector } from '../../configuration/documentSelector';\nimport { LanguageDescription } from '../../configuration/languageDescription';\nimport { CachedResponse } from '../../tsServer/cachedResponse';\nimport type * as Proto from '../../tsServer/protocol/protocol';\nimport * as PConst from '../../tsServer/protocol/protocol.const';\nimport { ExecutionTarget } from '../../tsServer/server';\nimport * as typeConverters from '../../typeConverters';\nimport { ClientCapability, ITypeScriptServiceClient } from '../../typescriptService';\nimport { conditionalRegistration, requireGlobalConfiguration, requireSomeCapability } from '../util/dependentRegistration';\nimport { ReferencesCodeLens, TypeScriptBaseCodeLensProvider, getSymbolRange } from './baseCodeLensProvider';\n\n\nexport class TypeScriptReferencesCodeLensProvider extends TypeScriptBaseCodeLensProvider {\n\tpublic constructor(\n\t\tclient: ITypeScriptServiceClient,\n\t\tprotected _cachedResponse: CachedResponse<Proto.NavTreeResponse>,\n\t\tprivate readonly language: LanguageDescription\n\t) {\n\t\tsuper(client, _cachedResponse);\n\t\tthis._register(\n\t\t\tvscode.workspace.onDidChangeConfiguration(evt => {\n\t\t\t\tif (evt.affectsConfiguration(`${language.id}.referencesCodeLens.showOnAllFunctions`)) {\n\t\t\t\t\tthis.changeEmitter.fire();\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t}\n\n\tpublic async resolveCodeLens(codeLens: ReferencesCodeLens, token: vscode.CancellationToken): Promise<vscode.CodeLens> {\n\t\tconst args = typeConverters.Position.toFileLocationRequestArgs(codeLens.file, codeLens.range.start);\n\t\tconst response = await this.client.execute('references', args, token, {\n\t\t\tlowPriority: true,\n\t\t\texecutionTarget: ExecutionTarget.Semantic,\n\t\t\tcancelOnResourceChange: codeLens.document,\n\t\t});\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\tcodeLens.command = response.type === 'cancelled'\n\t\t\t\t? TypeScriptBaseCodeLensProvider.cancelledCommand\n\t\t\t\t: TypeScriptBaseCodeLensProvider.errorCommand;\n\t\t\treturn codeLens;\n\t\t}\n\n\t\tconst locations = response.body.refs\n\t\t\t.filter(reference => !reference.isDefinition)\n\t\t\t.map(reference =>\n\t\t\t\ttypeConverters.Location.fromTextSpan(this.client.toResource(reference.file), reference));\n\n\t\tcodeLens.command = {\n\t\t\ttitle: this.getCodeLensLabel(locations),\n\t\t\tcommand: locations.length ? 'editor.action.showReferences' : '',\n\t\t\targuments: [codeLens.document, codeLens.range.start, locations]\n\t\t};\n\t\treturn codeLens;\n\t}\n\n\tprivate getCodeLensLabel(locations: ReadonlyArray<vscode.Location>): string {\n\t\treturn locations.length === 1\n\t\t\t? vscode.l10n.t(\"1 reference\")\n\t\t\t: vscode.l10n.t(\"{0} references\", locations.length);\n\t}\n\n\tprotected extractSymbol(\n\t\tdocument: vscode.TextDocument,\n\t\titem: Proto.NavigationTree,\n\t\tparent: Proto.NavigationTree | undefined\n\t): vscode.Range | undefined {\n\t\tif (parent && parent.kind === PConst.Kind.enum) {\n\t\t\treturn getSymbolRange(document, item);\n\t\t}\n\n\t\tswitch (item.kind) {\n\t\t\tcase PConst.Kind.function: {\n\t\t\t\tconst showOnAllFunctions = vscode.workspace.getConfiguration(this.language.id).get<boolean>('referencesCodeLens.showOnAllFunctions');\n\t\t\t\tif (showOnAllFunctions && item.nameSpan) {\n\t\t\t\t\treturn getSymbolRange(document, item);\n\t\t\t\t}\n\t\t\t}\n\t\t\t// fallthrough\n\n\t\t\tcase PConst.Kind.const:\n\t\t\tcase PConst.Kind.let:\n\t\t\tcase PConst.Kind.variable:\n\t\t\t\t// Only show references for exported variables\n\t\t\t\tif (/\\bexport\\b/.test(item.kindModifiers)) {\n\t\t\t\t\treturn getSymbolRange(document, item);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase PConst.Kind.class:\n\t\t\t\tif (item.text === '<class>') {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\treturn getSymbolRange(document, item);\n\n\t\t\tcase PConst.Kind.interface:\n\t\t\tcase PConst.Kind.type:\n\t\t\tcase PConst.Kind.enum:\n\t\t\t\treturn getSymbolRange(document, item);\n\n\t\t\tcase PConst.Kind.method:\n\t\t\tcase PConst.Kind.memberGetAccessor:\n\t\t\tcase PConst.Kind.memberSetAccessor:\n\t\t\tcase PConst.Kind.constructorImplementation:\n\t\t\tcase PConst.Kind.memberVariable:\n\t\t\t\t// Don't show if child and parent have same start\n\t\t\t\t// For https://github.com/microsoft/vscode/issues/90396\n\t\t\t\tif (parent &&\n\t\t\t\t\ttypeConverters.Position.fromLocation(parent.spans[0].start).isEqual(typeConverters.Position.fromLocation(item.spans[0].start))\n\t\t\t\t) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\n\t\t\t\t// Only show if parent is a class type object (not a literal)\n\t\t\t\tswitch (parent?.kind) {\n\t\t\t\t\tcase PConst.Kind.class:\n\t\t\t\t\tcase PConst.Kind.interface:\n\t\t\t\t\tcase PConst.Kind.type:\n\t\t\t\t\t\treturn getSymbolRange(document, item);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn undefined;\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tlanguage: LanguageDescription,\n\tclient: ITypeScriptServiceClient,\n\tcachedResponse: CachedResponse<Proto.NavTreeResponse>,\n) {\n\treturn conditionalRegistration([\n\t\trequireGlobalConfiguration(language.id, 'referencesCodeLens.enabled'),\n\t\trequireSomeCapability(client, ClientCapability.Semantic),\n\t], () => {\n\t\treturn vscode.languages.registerCodeLensProvider(selector.semantic,\n\t\t\tnew TypeScriptReferencesCodeLensProvider(client, cachedResponse, language));\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { Command, CommandManager } from '../commands/commandManager';\nimport { DocumentSelector } from '../configuration/documentSelector';\nimport { LanguageDescription } from '../configuration/languageDescription';\nimport { TelemetryReporter } from '../logging/telemetry';\nimport { API } from '../tsServer/api';\nimport { parseKindModifier } from '../tsServer/protocol/modifiers';\nimport type * as Proto from '../tsServer/protocol/protocol';\nimport * as PConst from '../tsServer/protocol/protocol.const';\nimport * as typeConverters from '../typeConverters';\nimport { ClientCapability, ITypeScriptServiceClient, ServerResponse } from '../typescriptService';\nimport TypingsStatus from '../ui/typingsStatus';\nimport { nulToken } from '../utils/cancellation';\nimport FileConfigurationManager from './fileConfigurationManager';\nimport { applyCodeAction } from './util/codeAction';\nimport { conditionalRegistration, requireSomeCapability } from './util/dependentRegistration';\nimport { snippetForFunctionCall } from './util/snippetForFunctionCall';\nimport * as Previewer from './util/textRendering';\n\n\ninterface DotAccessorContext {\n\treadonly range: vscode.Range;\n\treadonly text: string;\n}\n\ninterface CompletionContext {\n\treadonly isNewIdentifierLocation: boolean;\n\treadonly isMemberCompletion: boolean;\n\n\treadonly dotAccessorContext?: DotAccessorContext;\n\n\treadonly enableCallCompletions: boolean;\n\treadonly completeFunctionCalls: boolean;\n\n\treadonly wordRange: vscode.Range | undefined;\n\treadonly line: string;\n\treadonly optionalReplacementRange: vscode.Range | undefined;\n}\n\ntype ResolvedCompletionItem = {\n\treadonly edits?: readonly vscode.TextEdit[];\n\treadonly commands: readonly vscode.Command[];\n};\n\nclass MyCompletionItem extends vscode.CompletionItem {\n\n\tpublic readonly useCodeSnippet: boolean;\n\n\tconstructor(\n\t\tpublic readonly position: vscode.Position,\n\t\tpublic readonly document: vscode.TextDocument,\n\t\tpublic readonly tsEntry: Proto.CompletionEntry,\n\t\tprivate readonly completionContext: CompletionContext,\n\t\tpublic readonly metadata: any | undefined,\n\t\tclient: ITypeScriptServiceClient,\n\t\tdefaultCommitCharacters: readonly string[] | undefined,\n\t) {\n\t\tconst label = tsEntry.name || (tsEntry.insertText ?? '');\n\t\tsuper(label, MyCompletionItem.convertKind(tsEntry.kind));\n\n\t\tif (tsEntry.source && tsEntry.hasAction && client.apiVersion.lt(API.v490)) {\n\t\t\t// De-prioritze auto-imports\n\t\t\t// https://github.com/microsoft/vscode/issues/40311\n\t\t\tthis.sortText = '\\uffff' + tsEntry.sortText;\n\t\t} else {\n\t\t\tthis.sortText = tsEntry.sortText;\n\t\t}\n\n\t\tif (tsEntry.source && tsEntry.hasAction) {\n\t\t\t// Render \"fancy\" when source is a workspace path\n\t\t\tconst qualifierCandidate = vscode.workspace.asRelativePath(tsEntry.source);\n\t\t\tif (qualifierCandidate !== tsEntry.source) {\n\t\t\t\tthis.label = { label, description: qualifierCandidate };\n\t\t\t}\n\n\t\t}\n\n\t\tconst { sourceDisplay, isSnippet } = tsEntry;\n\t\tif (sourceDisplay) {\n\t\t\tthis.label = { label, description: Previewer.asPlainTextWithLinks(sourceDisplay, client) };\n\t\t}\n\n\t\tif (tsEntry.labelDetails) {\n\t\t\tthis.label = { label, ...tsEntry.labelDetails };\n\t\t}\n\n\t\tthis.preselect = tsEntry.isRecommended;\n\t\tthis.position = position;\n\t\tthis.useCodeSnippet = completionContext.completeFunctionCalls && (this.kind === vscode.CompletionItemKind.Function || this.kind === vscode.CompletionItemKind.Method);\n\n\t\tthis.range = this.getRangeFromReplacementSpan(tsEntry, completionContext);\n\t\tthis.commitCharacters = MyCompletionItem.getCommitCharacters(completionContext, tsEntry, defaultCommitCharacters);\n\t\tthis.insertText = isSnippet && tsEntry.insertText ? new vscode.SnippetString(tsEntry.insertText) : tsEntry.insertText;\n\t\tthis.filterText = tsEntry.filterText || this.getFilterText(completionContext.line, tsEntry.insertText);\n\n\t\tif (completionContext.isMemberCompletion && completionContext.dotAccessorContext && !(this.insertText instanceof vscode.SnippetString)) {\n\t\t\tthis.filterText = completionContext.dotAccessorContext.text + (this.insertText || this.textLabel);\n\t\t\tif (!this.range) {\n\t\t\t\tconst replacementRange = this.completionContext.wordRange;\n\t\t\t\tif (replacementRange) {\n\t\t\t\t\tthis.range = {\n\t\t\t\t\t\tinserting: completionContext.dotAccessorContext.range,\n\t\t\t\t\t\treplacing: completionContext.dotAccessorContext.range.union(replacementRange),\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\tthis.range = completionContext.dotAccessorContext.range;\n\t\t\t\t}\n\t\t\t\tthis.insertText = this.filterText;\n\t\t\t}\n\t\t}\n\n\t\tif (tsEntry.kindModifiers) {\n\t\t\tconst kindModifiers = parseKindModifier(tsEntry.kindModifiers);\n\t\t\tif (kindModifiers.has(PConst.KindModifiers.optional)) {\n\t\t\t\tthis.insertText ??= this.textLabel;\n\t\t\t\tthis.filterText ??= this.textLabel;\n\n\t\t\t\tif (typeof this.label === 'string') {\n\t\t\t\t\tthis.label += '?';\n\t\t\t\t} else {\n\t\t\t\t\tthis.label.label += '?';\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (kindModifiers.has(PConst.KindModifiers.deprecated)) {\n\t\t\t\tthis.tags = [vscode.CompletionItemTag.Deprecated];\n\t\t\t}\n\n\t\t\tif (kindModifiers.has(PConst.KindModifiers.color)) {\n\t\t\t\tthis.kind = vscode.CompletionItemKind.Color;\n\t\t\t}\n\n\t\t\tthis.detail = getScriptKindDetails(tsEntry);\n\t\t}\n\n\t\tthis.resolveRange();\n\t}\n\n\tprivate get textLabel() {\n\t\treturn typeof this.label === 'string' ? this.label : this.label.label;\n\t}\n\n\tprivate _resolvedPromise?: {\n\t\treadonly requestToken: vscode.CancellationTokenSource;\n\t\treadonly promise: Promise<ResolvedCompletionItem | undefined>;\n\t\twaiting: number;\n\t};\n\n\tpublic async resolveCompletionItem(\n\t\tclient: ITypeScriptServiceClient,\n\t\ttoken: vscode.CancellationToken,\n\t): Promise<ResolvedCompletionItem | undefined> {\n\t\ttoken.onCancellationRequested(() => {\n\t\t\tif (this._resolvedPromise && --this._resolvedPromise.waiting <= 0) {\n\t\t\t\t// Give a little extra time for another caller to come in\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tif (this._resolvedPromise && this._resolvedPromise.waiting <= 0) {\n\t\t\t\t\t\tthis._resolvedPromise.requestToken.cancel();\n\t\t\t\t\t}\n\t\t\t\t}, 300);\n\t\t\t}\n\t\t});\n\n\t\tif (this._resolvedPromise) {\n\t\t\t++this._resolvedPromise.waiting;\n\t\t\treturn this._resolvedPromise.promise;\n\t\t}\n\n\t\tconst requestToken = new vscode.CancellationTokenSource();\n\n\t\tconst promise = (async (): Promise<ResolvedCompletionItem | undefined> => {\n\t\t\tconst filepath = client.toOpenTsFilePath(this.document);\n\t\t\tif (!filepath) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tconst args: Proto.CompletionDetailsRequestArgs = {\n\t\t\t\t...typeConverters.Position.toFileLocationRequestArgs(filepath, this.position),\n\t\t\t\tentryNames: [\n\t\t\t\t\tthis.tsEntry.source || this.tsEntry.data ? {\n\t\t\t\t\t\tname: this.tsEntry.name,\n\t\t\t\t\t\tsource: this.tsEntry.source,\n\t\t\t\t\t\tdata: this.tsEntry.data,\n\t\t\t\t\t} : this.tsEntry.name\n\t\t\t\t]\n\t\t\t};\n\t\t\tconst response = await client.interruptGetErr(() => client.execute('completionEntryDetails', args, requestToken.token));\n\t\t\tif (response.type !== 'response' || !response.body?.length) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tconst detail = response.body[0];\n\n\t\t\tconst newItemDetails = this.getDetails(client, detail);\n\t\t\tif (newItemDetails) {\n\t\t\t\tthis.detail = newItemDetails;\n\t\t\t}\n\n\t\t\tthis.documentation = this.getDocumentation(client, detail, this.document.uri);\n\n\t\t\tconst codeAction = this.getCodeActions(detail, filepath);\n\t\t\tconst commands: vscode.Command[] = [{\n\t\t\t\tcommand: CompletionAcceptedCommand.ID,\n\t\t\t\ttitle: '',\n\t\t\t\targuments: [this]\n\t\t\t}];\n\t\t\tif (codeAction.command) {\n\t\t\t\tcommands.push(codeAction.command);\n\t\t\t}\n\t\t\tconst additionalTextEdits = codeAction.additionalTextEdits;\n\n\t\t\tif (this.useCodeSnippet) {\n\t\t\t\tconst shouldCompleteFunction = await this.isValidFunctionCompletionContext(client, filepath, this.position, this.document, token);\n\t\t\t\tif (shouldCompleteFunction) {\n\t\t\t\t\tconst { snippet, parameterCount } = snippetForFunctionCall({ ...this, label: this.textLabel }, detail.displayParts);\n\t\t\t\t\tthis.insertText = snippet;\n\t\t\t\t\tif (parameterCount > 0) {\n\t\t\t\t\t\t//Fix for https://github.com/microsoft/vscode/issues/104059\n\t\t\t\t\t\t//Don't show parameter hints if \"editor.parameterHints.enabled\": false\n\t\t\t\t\t\tif (vscode.workspace.getConfiguration('editor.parameterHints').get('enabled')) {\n\t\t\t\t\t\t\tcommands.push({ title: 'triggerParameterHints', command: 'editor.action.triggerParameterHints' });\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn { commands, edits: additionalTextEdits };\n\t\t})();\n\n\t\tthis._resolvedPromise = {\n\t\t\tpromise,\n\t\t\trequestToken,\n\t\t\twaiting: 1,\n\t\t};\n\n\t\treturn this._resolvedPromise.promise;\n\t}\n\n\tprivate getDetails(\n\t\tclient: ITypeScriptServiceClient,\n\t\tdetail: Proto.CompletionEntryDetails,\n\t): string | undefined {\n\t\tconst parts: string[] = [];\n\n\t\tif (detail.kind === PConst.Kind.script) {\n\t\t\t// details were already added\n\t\t\treturn undefined;\n\t\t}\n\n\t\tfor (const action of detail.codeActions ?? []) {\n\t\t\tparts.push(action.description);\n\t\t}\n\n\t\tparts.push(Previewer.asPlainTextWithLinks(detail.displayParts, client));\n\t\treturn parts.join('\\n\\n');\n\t}\n\n\tprivate getDocumentation(\n\t\tclient: ITypeScriptServiceClient,\n\t\tdetail: Proto.CompletionEntryDetails,\n\t\tbaseUri: vscode.Uri,\n\t): vscode.MarkdownString | undefined {\n\t\tconst documentation = new vscode.MarkdownString();\n\t\tPreviewer.appendDocumentationAsMarkdown(documentation, detail.documentation, detail.tags, client);\n\t\tdocumentation.baseUri = baseUri;\n\t\treturn documentation.value.length ? documentation : undefined;\n\t}\n\n\tprivate async isValidFunctionCompletionContext(\n\t\tclient: ITypeScriptServiceClient,\n\t\tfilepath: string,\n\t\tposition: vscode.Position,\n\t\tdocument: vscode.TextDocument,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<boolean> {\n\t\t// Workaround for https://github.com/microsoft/TypeScript/issues/12677\n\t\t// Don't complete function calls inside of destructive assignments or imports\n\t\ttry {\n\t\t\tconst args: Proto.FileLocationRequestArgs = typeConverters.Position.toFileLocationRequestArgs(filepath, position);\n\t\t\tconst response = await client.execute('quickinfo', args, token);\n\t\t\tif (response.type === 'response' && response.body) {\n\t\t\t\tswitch (response.body.kind) {\n\t\t\t\t\tcase 'var':\n\t\t\t\t\tcase 'let':\n\t\t\t\t\tcase 'const':\n\t\t\t\t\tcase 'alias':\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t} catch {\n\t\t\t// Noop\n\t\t}\n\n\t\tconst line = document.lineAt(position.line);\n\t\t// Don't complete function call if there is already something that looks like a function call\n\t\t// https://github.com/microsoft/vscode/issues/18131\n\n\t\tconst after = line.text.slice(position.character);\n\t\tif (after.match(/^[a-z_$0-9]*\\s*\\(/gi)) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Don't complete function call if it looks like a jsx tag.\n\t\tconst before = line.text.slice(0, position.character);\n\t\tif (before.match(/<\\s*[\\w]*$/gi)) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tprivate getCodeActions(\n\t\tdetail: Proto.CompletionEntryDetails,\n\t\tfilepath: string\n\t): { command?: vscode.Command; additionalTextEdits?: vscode.TextEdit[] } {\n\t\tif (!detail.codeActions?.length) {\n\t\t\treturn {};\n\t\t}\n\n\t\t// Try to extract out the additionalTextEdits for the current file.\n\t\t// Also check if we still have to apply other workspace edits and commands\n\t\t// using a vscode command\n\t\tconst additionalTextEdits: vscode.TextEdit[] = [];\n\t\tlet hasRemainingCommandsOrEdits = false;\n\t\tfor (const tsAction of detail.codeActions) {\n\t\t\tif (tsAction.commands) {\n\t\t\t\thasRemainingCommandsOrEdits = true;\n\t\t\t}\n\n\t\t\t// Apply all edits in the current file using `additionalTextEdits`\n\t\t\tif (tsAction.changes) {\n\t\t\t\tfor (const change of tsAction.changes) {\n\t\t\t\t\tif (change.fileName === filepath) {\n\t\t\t\t\t\tadditionalTextEdits.push(...change.textChanges.map(typeConverters.TextEdit.fromCodeEdit));\n\t\t\t\t\t} else {\n\t\t\t\t\t\thasRemainingCommandsOrEdits = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet command: vscode.Command | undefined = undefined;\n\t\tif (hasRemainingCommandsOrEdits) {\n\t\t\t// Create command that applies all edits not in the current file.\n\t\t\tcommand = {\n\t\t\t\ttitle: '',\n\t\t\t\tcommand: ApplyCompletionCodeActionCommand.ID,\n\t\t\t\targuments: [filepath, detail.codeActions.map((x): Proto.CodeAction => ({\n\t\t\t\t\tcommands: x.commands,\n\t\t\t\t\tdescription: x.description,\n\t\t\t\t\tchanges: x.changes.filter(x => x.fileName !== filepath)\n\t\t\t\t}))]\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\tcommand,\n\t\t\tadditionalTextEdits: additionalTextEdits.length ? additionalTextEdits : undefined\n\t\t};\n\t}\n\n\tprivate getRangeFromReplacementSpan(tsEntry: Proto.CompletionEntry, completionContext: CompletionContext) {\n\t\tif (!tsEntry.replacementSpan) {\n\t\t\tif (completionContext.optionalReplacementRange) {\n\t\t\t\treturn {\n\t\t\t\t\tinserting: new vscode.Range(completionContext.optionalReplacementRange.start, this.position),\n\t\t\t\t\treplacing: completionContext.optionalReplacementRange,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// If TS returns an explicit replacement range on this item, we should use it for both types of completion\n\n\t\t// Make sure we only replace a single line at most\n\t\tlet replaceRange = typeConverters.Range.fromTextSpan(tsEntry.replacementSpan);\n\t\tif (!replaceRange.isSingleLine) {\n\t\t\treplaceRange = new vscode.Range(replaceRange.start.line, replaceRange.start.character, replaceRange.start.line, completionContext.line.length);\n\t\t}\n\t\treturn {\n\t\t\tinserting: replaceRange,\n\t\t\treplacing: replaceRange,\n\t\t};\n\t}\n\n\tprivate getFilterText(line: string, insertText: string | undefined): string | undefined {\n\t\t// Handle private field completions\n\t\tif (this.tsEntry.name.startsWith('#')) {\n\t\t\tconst wordRange = this.completionContext.wordRange;\n\t\t\tconst wordStart = wordRange ? line.charAt(wordRange.start.character) : undefined;\n\t\t\tif (insertText) {\n\t\t\t\tif (insertText.startsWith('this.#')) {\n\t\t\t\t\treturn wordStart === '#' ? insertText : insertText.replace(/^this\\.#/, '');\n\t\t\t\t} else {\n\t\t\t\t\treturn insertText;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn wordStart === '#' ? undefined : this.tsEntry.name.replace(/^#/, '');\n\t\t\t}\n\t\t}\n\n\t\t// For `this.` completions, generally don't set the filter text since we don't want them to be overly prioritized. #74164\n\t\tif (insertText?.startsWith('this.')) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// Handle the case:\n\t\t// ```\n\t\t// const xyz = { 'ab c': 1 };\n\t\t// xyz.ab|\n\t\t// ```\n\t\t// In which case we want to insert a bracket accessor but should use `.abc` as the filter text instead of\n\t\t// the bracketed insert text.\n\t\telse if (insertText?.startsWith('[')) {\n\t\t\treturn insertText.replace(/^\\[['\"](.+)[['\"]\\]$/, '.$1');\n\t\t}\n\n\t\t// In all other cases, fallback to using the insertText\n\t\treturn insertText;\n\t}\n\n\tprivate resolveRange(): void {\n\t\tif (this.range) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst replaceRange = this.completionContext.wordRange;\n\t\tif (replaceRange) {\n\t\t\tthis.range = {\n\t\t\t\tinserting: new vscode.Range(replaceRange.start, this.position),\n\t\t\t\treplacing: replaceRange\n\t\t\t};\n\t\t}\n\t}\n\n\tprivate static convertKind(kind: string): vscode.CompletionItemKind {\n\t\tswitch (kind) {\n\t\t\tcase PConst.Kind.primitiveType:\n\t\t\tcase PConst.Kind.keyword:\n\t\t\t\treturn vscode.CompletionItemKind.Keyword;\n\n\t\t\tcase PConst.Kind.const:\n\t\t\tcase PConst.Kind.let:\n\t\t\tcase PConst.Kind.variable:\n\t\t\tcase PConst.Kind.localVariable:\n\t\t\tcase PConst.Kind.alias:\n\t\t\tcase PConst.Kind.parameter:\n\t\t\t\treturn vscode.CompletionItemKind.Variable;\n\n\t\t\tcase PConst.Kind.memberVariable:\n\t\t\tcase PConst.Kind.memberGetAccessor:\n\t\t\tcase PConst.Kind.memberSetAccessor:\n\t\t\t\treturn vscode.CompletionItemKind.Field;\n\n\t\t\tcase PConst.Kind.function:\n\t\t\tcase PConst.Kind.localFunction:\n\t\t\t\treturn vscode.CompletionItemKind.Function;\n\n\t\t\tcase PConst.Kind.method:\n\t\t\tcase PConst.Kind.constructSignature:\n\t\t\tcase PConst.Kind.callSignature:\n\t\t\tcase PConst.Kind.indexSignature:\n\t\t\t\treturn vscode.CompletionItemKind.Method;\n\n\t\t\tcase PConst.Kind.enum:\n\t\t\t\treturn vscode.CompletionItemKind.Enum;\n\n\t\t\tcase PConst.Kind.enumMember:\n\t\t\t\treturn vscode.CompletionItemKind.EnumMember;\n\n\t\t\tcase PConst.Kind.module:\n\t\t\tcase PConst.Kind.externalModuleName:\n\t\t\t\treturn vscode.CompletionItemKind.Module;\n\n\t\t\tcase PConst.Kind.class:\n\t\t\tcase PConst.Kind.type:\n\t\t\t\treturn vscode.CompletionItemKind.Class;\n\n\t\t\tcase PConst.Kind.interface:\n\t\t\t\treturn vscode.CompletionItemKind.Interface;\n\n\t\t\tcase PConst.Kind.warning:\n\t\t\t\treturn vscode.CompletionItemKind.Text;\n\n\t\t\tcase PConst.Kind.script:\n\t\t\t\treturn vscode.CompletionItemKind.File;\n\n\t\t\tcase PConst.Kind.directory:\n\t\t\t\treturn vscode.CompletionItemKind.Folder;\n\n\t\t\tcase PConst.Kind.string:\n\t\t\t\treturn vscode.CompletionItemKind.Constant;\n\n\t\t\tdefault:\n\t\t\t\treturn vscode.CompletionItemKind.Property;\n\t\t}\n\t}\n\n\tprivate static getCommitCharacters(\n\t\tcontext: CompletionContext,\n\t\tentry: Proto.CompletionEntry,\n\t\tdefaultCommitCharacters: readonly string[] | undefined,\n\t): string[] | undefined {\n\t\tlet commitCharacters = entry.commitCharacters ?? (defaultCommitCharacters ? Array.from(defaultCommitCharacters) : undefined);\n\t\tif (commitCharacters) {\n\t\t\tif (context.enableCallCompletions\n\t\t\t\t&& !context.isNewIdentifierLocation\n\t\t\t\t&& entry.kind !== PConst.Kind.warning\n\t\t\t\t&& entry.kind !== PConst.Kind.string) {\n\t\t\t\tcommitCharacters.push('(');\n\t\t\t}\n\t\t\treturn commitCharacters;\n\t\t}\n\n\t\tif (entry.kind === PConst.Kind.warning || entry.kind === PConst.Kind.string) { // Ambient JS word based suggestion, strings\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (context.isNewIdentifierLocation) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tcommitCharacters = ['.', ',', ';'];\n\t\tif (context.enableCallCompletions) {\n\t\t\tcommitCharacters.push('(');\n\t\t}\n\n\t\treturn commitCharacters;\n\t}\n}\n\nfunction getScriptKindDetails(tsEntry: Proto.CompletionEntry,): string | undefined {\n\tif (!tsEntry.kindModifiers || tsEntry.kind !== PConst.Kind.script) {\n\t\treturn;\n\t}\n\n\tconst kindModifiers = parseKindModifier(tsEntry.kindModifiers);\n\tfor (const extModifier of PConst.KindModifiers.fileExtensionKindModifiers) {\n\t\tif (kindModifiers.has(extModifier)) {\n\t\t\tif (tsEntry.name.toLowerCase().endsWith(extModifier)) {\n\t\t\t\treturn tsEntry.name;\n\t\t\t} else {\n\t\t\t\treturn tsEntry.name + extModifier;\n\t\t\t}\n\t\t}\n\t}\n\treturn undefined;\n}\n\n\nclass CompletionAcceptedCommand implements Command {\n\tpublic static readonly ID = '_typescript.onCompletionAccepted';\n\tpublic readonly id = CompletionAcceptedCommand.ID;\n\n\tpublic constructor(\n\t\tprivate readonly onCompletionAccepted: (item: vscode.CompletionItem) => void,\n\t\tprivate readonly telemetryReporter: TelemetryReporter,\n\t) { }\n\n\tpublic execute(item: vscode.CompletionItem) {\n\t\tthis.onCompletionAccepted(item);\n\t\tif (item instanceof MyCompletionItem) {\n\t\t\t/* __GDPR__\n\t\t\t\t\"completions.accept\" : {\n\t\t\t\t\t\"owner\": \"mjbvz\",\n\t\t\t\t\t\"isPackageJsonImport\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\t\"isImportStatementCompletion\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\t\"${include}\": [\n\t\t\t\t\t\t\"${TypeScriptCommonProperties}\"\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t*/\n\t\t\tthis.telemetryReporter.logTelemetry('completions.accept', {\n\t\t\t\tisPackageJsonImport: item.tsEntry.isPackageJsonImport ? 'true' : undefined,\n\t\t\t\tisImportStatementCompletion: item.tsEntry.isImportStatementCompletion ? 'true' : undefined,\n\t\t\t});\n\t\t}\n\t}\n}\n\n/**\n * Command fired when an completion item needs to be applied\n */\nclass ApplyCompletionCommand implements Command {\n\tpublic static readonly ID = '_typescript.applyCompletionCommand';\n\tpublic readonly id = ApplyCompletionCommand.ID;\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t) { }\n\n\tpublic async execute(item: MyCompletionItem) {\n\t\tconst resolved = await item.resolveCompletionItem(this.client, nulToken);\n\t\tif (!resolved) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { edits, commands } = resolved;\n\n\t\tif (edits) {\n\t\t\tconst workspaceEdit = new vscode.WorkspaceEdit();\n\t\t\tfor (const edit of edits) {\n\t\t\t\tworkspaceEdit.replace(item.document.uri, edit.range, edit.newText);\n\t\t\t}\n\t\t\tawait vscode.workspace.applyEdit(workspaceEdit);\n\t\t}\n\n\t\tfor (const command of commands) {\n\t\t\tawait vscode.commands.executeCommand(command.command, ...(command.arguments ?? []));\n\t\t}\n\t}\n}\n\nclass ApplyCompletionCodeActionCommand implements Command {\n\tpublic static readonly ID = '_typescript.applyCompletionCodeAction';\n\tpublic readonly id = ApplyCompletionCodeActionCommand.ID;\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient\n\t) { }\n\n\tpublic async execute(_file: string, codeActions: Proto.CodeAction[]): Promise<boolean> {\n\t\tif (codeActions.length === 0) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (codeActions.length === 1) {\n\t\t\treturn applyCodeAction(this.client, codeActions[0], nulToken);\n\t\t}\n\n\t\tconst selection = await vscode.window.showQuickPick(\n\t\t\tcodeActions.map(action => ({\n\t\t\t\tlabel: action.description,\n\t\t\t\tdescription: '',\n\t\t\t\taction,\n\t\t\t})), {\n\t\t\tplaceHolder: vscode.l10n.t(\"Select code action to apply\")\n\t\t});\n\n\t\tif (selection) {\n\t\t\treturn applyCodeAction(this.client, selection.action, nulToken);\n\t\t}\n\t\treturn false;\n\t}\n}\n\ninterface CompletionConfiguration {\n\treadonly completeFunctionCalls: boolean;\n\treadonly nameSuggestions: boolean;\n\treadonly pathSuggestions: boolean;\n\treadonly autoImportSuggestions: boolean;\n\treadonly importStatementSuggestions: boolean;\n}\n\nnamespace CompletionConfiguration {\n\texport const completeFunctionCalls = 'suggest.completeFunctionCalls';\n\texport const nameSuggestions = 'suggest.names';\n\texport const pathSuggestions = 'suggest.paths';\n\texport const autoImportSuggestions = 'suggest.autoImports';\n\texport const importStatementSuggestions = 'suggest.importStatements';\n\n\texport function getConfigurationForResource(\n\t\tmodeId: string,\n\t\tresource: vscode.Uri\n\t): CompletionConfiguration {\n\t\tconst config = vscode.workspace.getConfiguration(modeId, resource);\n\t\treturn {\n\t\t\tcompleteFunctionCalls: config.get<boolean>(CompletionConfiguration.completeFunctionCalls, false),\n\t\t\tpathSuggestions: config.get<boolean>(CompletionConfiguration.pathSuggestions, true),\n\t\t\tautoImportSuggestions: config.get<boolean>(CompletionConfiguration.autoImportSuggestions, true),\n\t\t\tnameSuggestions: config.get<boolean>(CompletionConfiguration.nameSuggestions, true),\n\t\t\timportStatementSuggestions: config.get<boolean>(CompletionConfiguration.importStatementSuggestions, true),\n\t\t};\n\t}\n}\n\nclass TypeScriptCompletionItemProvider implements vscode.CompletionItemProvider<MyCompletionItem> {\n\n\tpublic static readonly triggerCharacters = ['.', '\"', '\\'', '`', '/', '@', '<', '#', ' '];\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly language: LanguageDescription,\n\t\tprivate readonly typingsStatus: TypingsStatus,\n\t\tprivate readonly fileConfigurationManager: FileConfigurationManager,\n\t\tcommandManager: CommandManager,\n\t\tprivate readonly telemetryReporter: TelemetryReporter,\n\t\tonCompletionAccepted: (item: vscode.CompletionItem) => void\n\t) {\n\t\tcommandManager.register(new ApplyCompletionCodeActionCommand(this.client));\n\t\tcommandManager.register(new CompletionAcceptedCommand(onCompletionAccepted, this.telemetryReporter));\n\t\tcommandManager.register(new ApplyCompletionCommand(this.client));\n\t}\n\n\tpublic async provideCompletionItems(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\ttoken: vscode.CancellationToken,\n\t\tcontext: vscode.CompletionContext\n\t): Promise<vscode.CompletionList<MyCompletionItem> | undefined> {\n\t\tif (!vscode.workspace.getConfiguration(this.language.id, document).get('suggest.enabled')) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (this.typingsStatus.isAcquiringTypings) {\n\t\t\treturn Promise.reject<vscode.CompletionList<MyCompletionItem>>({\n\t\t\t\tlabel: vscode.l10n.t({\n\t\t\t\t\tmessage: \"Acquiring typings...\",\n\t\t\t\t\tcomment: ['Typings refers to the *.d.ts typings files that power our IntelliSense. It should not be localized'],\n\t\t\t\t}),\n\t\t\t\tdetail: vscode.l10n.t({\n\t\t\t\t\tmessage: \"Acquiring typings definitions for IntelliSense.\",\n\t\t\t\t\tcomment: ['Typings refers to the *.d.ts typings files that power our IntelliSense. It should not be localized'],\n\t\t\t\t})\n\t\t\t});\n\t\t}\n\n\t\tconst file = this.client.toOpenTsFilePath(document);\n\t\tif (!file) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst line = document.lineAt(position.line);\n\t\tconst completionConfiguration = CompletionConfiguration.getConfigurationForResource(this.language.id, document.uri);\n\n\t\tif (!this.shouldTrigger(context, line, position, completionConfiguration)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tlet wordRange = document.getWordRangeAtPosition(position);\n\t\tif (wordRange && !wordRange.isEmpty) {\n\t\t\tconst secondCharPosition = wordRange.start.translate(0, 1);\n\t\t\tconst firstChar = document.getText(new vscode.Range(wordRange.start, secondCharPosition));\n\t\t\tif (firstChar === '@') {\n\t\t\t\twordRange = wordRange.with(secondCharPosition);\n\t\t\t}\n\t\t}\n\n\t\tawait this.client.interruptGetErr(() => this.fileConfigurationManager.ensureConfigurationForDocument(document, token));\n\n\t\tconst args: Proto.CompletionsRequestArgs = {\n\t\t\t...typeConverters.Position.toFileLocationRequestArgs(file, position),\n\t\t\tincludeExternalModuleExports: completionConfiguration.autoImportSuggestions,\n\t\t\tincludeInsertTextCompletions: true,\n\t\t\ttriggerCharacter: this.getTsTriggerCharacter(context),\n\t\t\ttriggerKind: typeConverters.CompletionTriggerKind.toProtocolCompletionTriggerKind(context.triggerKind),\n\t\t};\n\n\t\tlet dotAccessorContext: DotAccessorContext | undefined;\n\t\tlet response: ServerResponse.Response<Proto.CompletionInfoResponse> | undefined;\n\t\tlet duration: number | undefined;\n\t\tlet optionalReplacementRange: vscode.Range | undefined;\n\n\t\tconst startTime = Date.now();\n\t\ttry {\n\t\t\tresponse = await this.client.interruptGetErr(() => this.client.execute('completionInfo', args, token));\n\t\t} finally {\n\t\t\tduration = Date.now() - startTime;\n\t\t}\n\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\tthis.logCompletionsTelemetry(duration, response);\n\t\t\treturn undefined;\n\t\t}\n\t\tconst isNewIdentifierLocation = response.body.isNewIdentifierLocation;\n\t\tconst isMemberCompletion = response.body.isMemberCompletion;\n\t\tif (isMemberCompletion) {\n\t\t\tconst dotMatch = line.text.slice(0, position.character).match(/\\??\\.\\s*$/) || undefined;\n\t\t\tif (dotMatch) {\n\t\t\t\tconst range = new vscode.Range(position.translate({ characterDelta: -dotMatch[0].length }), position);\n\t\t\t\tconst text = document.getText(range);\n\t\t\t\tdotAccessorContext = { range, text };\n\t\t\t}\n\t\t}\n\t\tconst isIncomplete = !!response.body.isIncomplete || (response.metadata as any)?.isIncomplete;\n\t\tconst entries = response.body.entries;\n\t\tconst metadata = response.metadata;\n\t\tconst defaultCommitCharacters = Object.freeze(response.body.defaultCommitCharacters);\n\n\t\tif (response.body.optionalReplacementSpan) {\n\t\t\toptionalReplacementRange = typeConverters.Range.fromTextSpan(response.body.optionalReplacementSpan);\n\t\t}\n\n\t\tconst completionContext: CompletionContext = {\n\t\t\tisNewIdentifierLocation,\n\t\t\tisMemberCompletion,\n\t\t\tdotAccessorContext,\n\t\t\tenableCallCompletions: !completionConfiguration.completeFunctionCalls,\n\t\t\twordRange,\n\t\t\tline: line.text,\n\t\t\tcompleteFunctionCalls: completionConfiguration.completeFunctionCalls,\n\t\t\toptionalReplacementRange,\n\t\t};\n\n\t\tlet includesPackageJsonImport = false;\n\t\tlet includesImportStatementCompletion = false;\n\t\tconst items: MyCompletionItem[] = [];\n\t\tfor (const entry of entries) {\n\t\t\tif (!shouldExcludeCompletionEntry(entry, completionConfiguration)) {\n\t\t\t\tconst item = new MyCompletionItem(\n\t\t\t\t\tposition,\n\t\t\t\t\tdocument,\n\t\t\t\t\tentry,\n\t\t\t\t\tcompletionContext,\n\t\t\t\t\tmetadata,\n\t\t\t\t\tthis.client,\n\t\t\t\t\tdefaultCommitCharacters);\n\t\t\t\titem.command = {\n\t\t\t\t\tcommand: ApplyCompletionCommand.ID,\n\t\t\t\t\ttitle: '',\n\t\t\t\t\targuments: [item]\n\t\t\t\t};\n\t\t\t\titems.push(item);\n\t\t\t\tincludesPackageJsonImport = includesPackageJsonImport || !!entry.isPackageJsonImport;\n\t\t\t\tincludesImportStatementCompletion = includesImportStatementCompletion || !!entry.isImportStatementCompletion;\n\t\t\t}\n\t\t}\n\t\tif (duration !== undefined) {\n\t\t\tthis.logCompletionsTelemetry(duration, response, includesPackageJsonImport, includesImportStatementCompletion);\n\t\t}\n\t\treturn new vscode.CompletionList(items, isIncomplete);\n\t}\n\n\tprivate logCompletionsTelemetry(\n\t\tduration: number,\n\t\tresponse: ServerResponse.Response<Proto.CompletionInfoResponse> | undefined,\n\t\tincludesPackageJsonImport?: boolean,\n\t\tincludesImportStatementCompletion?: boolean,\n\t) {\n\t\t/* __GDPR__\n\t\t\t\"completions.execute\" : {\n\t\t\t\t\"owner\": \"mjbvz\",\n\t\t\t\t\"duration\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"type\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"count\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"flags\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"updateGraphDurationMs\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"createAutoImportProviderProgramDurationMs\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"includesPackageJsonImport\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"includesImportStatementCompletion\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"${include}\": [\n\t\t\t\t\t\"${TypeScriptCommonProperties}\"\n\t\t\t\t]\n\t\t\t}\n\t\t*/\n\t\tthis.telemetryReporter.logTelemetry('completions.execute', {\n\t\t\tduration: String(duration),\n\t\t\ttype: response?.type ?? 'unknown',\n\t\t\tflags: response?.type === 'response' && typeof response.body?.flags === 'number' ? String(response.body.flags) : undefined,\n\t\t\tcount: String(response?.type === 'response' && response.body ? response.body.entries.length : 0),\n\t\t\tupdateGraphDurationMs: response?.type === 'response' && typeof response.performanceData?.updateGraphDurationMs === 'number'\n\t\t\t\t? String(response.performanceData.updateGraphDurationMs)\n\t\t\t\t: undefined,\n\t\t\tcreateAutoImportProviderProgramDurationMs: response?.type === 'response' && typeof response.performanceData?.createAutoImportProviderProgramDurationMs === 'number'\n\t\t\t\t? String(response.performanceData.createAutoImportProviderProgramDurationMs)\n\t\t\t\t: undefined,\n\t\t\tincludesPackageJsonImport: includesPackageJsonImport ? 'true' : undefined,\n\t\t\tincludesImportStatementCompletion: includesImportStatementCompletion ? 'true' : undefined,\n\t\t});\n\t}\n\n\tprivate getTsTriggerCharacter(context: vscode.CompletionContext): Proto.CompletionsTriggerCharacter | undefined {\n\t\tswitch (context.triggerCharacter) {\n\t\t\tcase '@': {\n\t\t\t\treturn '@';\n\t\t\t}\n\t\t\tcase '#': {\n\t\t\t\treturn '#';\n\t\t\t}\n\t\t\tcase ' ': {\n\t\t\t\treturn this.client.apiVersion.gte(API.v430) ? ' ' : undefined;\n\t\t\t}\n\t\t\tcase '.':\n\t\t\tcase '\"':\n\t\t\tcase '\\'':\n\t\t\tcase '`':\n\t\t\tcase '/':\n\t\t\tcase '<': {\n\t\t\t\treturn context.triggerCharacter;\n\t\t\t}\n\t\t\tdefault: {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic async resolveCompletionItem(\n\t\titem: MyCompletionItem,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<MyCompletionItem | undefined> {\n\t\tawait item.resolveCompletionItem(this.client, token);\n\t\treturn item;\n\t}\n\n\tprivate shouldTrigger(\n\t\tcontext: vscode.CompletionContext,\n\t\tline: vscode.TextLine,\n\t\tposition: vscode.Position,\n\t\tconfiguration: CompletionConfiguration,\n\t): boolean {\n\t\tif (context.triggerCharacter === ' ') {\n\t\t\tif (!configuration.importStatementSuggestions || this.client.apiVersion.lt(API.v430)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconst pre = line.text.slice(0, position.character);\n\t\t\treturn pre === 'import';\n\t\t}\n\t\treturn true;\n\t}\n}\n\nfunction shouldExcludeCompletionEntry(\n\telement: Proto.CompletionEntry,\n\tcompletionConfiguration: CompletionConfiguration\n) {\n\treturn (\n\t\t(!completionConfiguration.nameSuggestions && element.kind === PConst.Kind.warning)\n\t\t|| (!completionConfiguration.pathSuggestions &&\n\t\t\t(element.kind === PConst.Kind.directory || element.kind === PConst.Kind.script || element.kind === PConst.Kind.externalModuleName))\n\t\t|| (!completionConfiguration.autoImportSuggestions && element.hasAction)\n\t);\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tlanguage: LanguageDescription,\n\tclient: ITypeScriptServiceClient,\n\ttypingsStatus: TypingsStatus,\n\tfileConfigurationManager: FileConfigurationManager,\n\tcommandManager: CommandManager,\n\ttelemetryReporter: TelemetryReporter,\n\tonCompletionAccepted: (item: vscode.CompletionItem) => void\n) {\n\treturn conditionalRegistration([\n\t\trequireSomeCapability(client, ClientCapability.EnhancedSyntax, ClientCapability.Semantic),\n\t], () => {\n\t\treturn vscode.languages.registerCompletionItemProvider(selector.syntax,\n\t\t\tnew TypeScriptCompletionItemProvider(client, language, typingsStatus, fileConfigurationManager, commandManager, telemetryReporter, onCompletionAccepted),\n\t\t\t...TypeScriptCompletionItemProvider.triggerCharacters);\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { DocumentSelector } from '../configuration/documentSelector';\nimport { LanguageDescription } from '../configuration/languageDescription';\nimport { API } from '../tsServer/api';\nimport protocol from '../tsServer/protocol/protocol';\nimport * as typeConverters from '../typeConverters';\nimport { ClientCapability, ITypeScriptServiceClient, ServerResponse } from '../typescriptService';\nimport { raceTimeout } from '../utils/async';\nimport FileConfigurationManager from './fileConfigurationManager';\nimport { conditionalRegistration, requireGlobalConfiguration, requireMinVersion, requireSomeCapability } from './util/dependentRegistration';\n\nclass CopyMetadata {\n\n\tstatic parse(data: string): CopyMetadata | undefined {\n\t\ttry {\n\n\t\t\tconst parsedData = JSON.parse(data);\n\t\t\tconst resource = vscode.Uri.parse(parsedData.resource);\n\t\t\tconst ranges = parsedData.ranges.map((range: any) => new vscode.Range(range.start, range.end));\n\t\t\tconst copyOperation = parsedData.copyOperation ? Promise.resolve(parsedData.copyOperation) : undefined;\n\t\t\treturn new CopyMetadata(resource, ranges, copyOperation);\n\t\t} catch (error) {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tconstructor(\n\t\tpublic readonly resource: vscode.Uri,\n\t\tpublic readonly ranges: readonly vscode.Range[],\n\t\tpublic readonly copyOperation: Promise<ServerResponse.Response<protocol.PreparePasteEditsResponse>> | undefined\n\t) { }\n}\n\nclass TsPasteEdit extends vscode.DocumentPasteEdit {\n\n\tstatic tryCreateFromResponse(\n\t\tclient: ITypeScriptServiceClient,\n\t\tresponse: ServerResponse.Response<protocol.GetPasteEditsResponse>\n\t): TsPasteEdit | undefined {\n\t\tif (response.type !== 'response' || !response.body?.edits.length) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst pasteEdit = new TsPasteEdit();\n\n\t\tconst additionalEdit = new vscode.WorkspaceEdit();\n\t\tfor (const edit of response.body.edits) {\n\t\t\tadditionalEdit.set(client.toResource(edit.fileName), edit.textChanges.map(typeConverters.TextEdit.fromCodeEdit));\n\t\t}\n\t\tpasteEdit.additionalEdit = additionalEdit;\n\n\t\treturn pasteEdit;\n\t}\n\n\tconstructor() {\n\t\tsuper('', vscode.l10n.t(\"Paste with imports\"), DocumentPasteProvider.kind);\n\t\tthis.yieldTo = [\n\t\t\tvscode.DocumentDropOrPasteEditKind.Text.append('plain')\n\t\t];\n\t}\n}\n\nclass TsPendingPasteEdit extends TsPasteEdit {\n\tconstructor(\n\t\ttext: string,\n\t\tpublic readonly operation: Promise<ServerResponse.Response<protocol.GetPasteEditsResponse>>\n\t) {\n\t\tsuper();\n\t\tthis.insertText = text;\n\t}\n}\n\nconst enabledSettingId = 'updateImportsOnPaste.enabled';\n\nclass DocumentPasteProvider implements vscode.DocumentPasteEditProvider<TsPasteEdit> {\n\n\tstatic readonly kind = vscode.DocumentDropOrPasteEditKind.TextUpdateImports.append('jsts');\n\tstatic readonly metadataMimeType = 'application/vnd.code.jsts.metadata';\n\n\tconstructor(\n\t\tprivate readonly _modeId: string,\n\t\tprivate readonly _client: ITypeScriptServiceClient,\n\t\tprivate readonly fileConfigurationManager: FileConfigurationManager,\n\t) { }\n\n\tasync prepareDocumentPaste(document: vscode.TextDocument, ranges: readonly vscode.Range[], dataTransfer: vscode.DataTransfer, token: vscode.CancellationToken) {\n\t\tif (!this.isEnabled(document)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst file = this._client.toOpenTsFilePath(document);\n\t\tif (!file) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst copyRequest = this._client.interruptGetErr(() => this._client.execute('preparePasteEdits', {\n\t\t\tfile,\n\t\t\tcopiedTextSpan: ranges.map(typeConverters.Range.toTextSpan),\n\t\t}, token));\n\n\t\tconst copyTimeout = 200;\n\t\tconst response = await raceTimeout(copyRequest, copyTimeout);\n\t\tif (token.isCancellationRequested) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (response) {\n\t\t\tif (response.type !== 'response' || !response.body) {\n\t\t\t\t// We got a response which told us no to bother with the paste\n\t\t\t\t// Don't store anything so that we don't trigger on paste\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdataTransfer.set(DocumentPasteProvider.metadataMimeType,\n\t\t\t\tnew vscode.DataTransferItem(new CopyMetadata(document.uri, ranges, undefined)));\n\t\t} else {\n\t\t\t// We are still waiting on the response. Store the pending request so that we can try checking it on paste\n\t\t\t// when it has hopefully resolved\n\t\t\tdataTransfer.set(DocumentPasteProvider.metadataMimeType,\n\t\t\t\tnew vscode.DataTransferItem(new CopyMetadata(document.uri, ranges, copyRequest)));\n\t\t}\n\t}\n\n\tasync provideDocumentPasteEdits(\n\t\tdocument: vscode.TextDocument,\n\t\tranges: readonly vscode.Range[],\n\t\tdataTransfer: vscode.DataTransfer,\n\t\t_context: vscode.DocumentPasteEditContext,\n\t\ttoken: vscode.CancellationToken,\n\t): Promise<TsPasteEdit[] | undefined> {\n\t\tif (!this.isEnabled(document)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst file = this._client.toOpenTsFilePath(document);\n\t\tif (!file) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst text = await dataTransfer.get('text/plain')?.asString();\n\t\tif (!text || token.isCancellationRequested) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Get optional metadata\n\t\tconst metadata = await this.extractMetadata(dataTransfer, token);\n\t\tif (token.isCancellationRequested) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet copiedFrom: {\n\t\t\tfile: string;\n\t\t\tspans: protocol.TextSpan[];\n\t\t} | undefined;\n\t\tif (metadata) {\n\t\t\tconst spans = metadata.ranges.map(typeConverters.Range.toTextSpan);\n\t\t\tconst copyFile = this._client.toTsFilePath(metadata.resource);\n\t\t\tif (copyFile) {\n\t\t\t\tcopiedFrom = { file: copyFile, spans };\n\t\t\t}\n\t\t}\n\n\t\tif (copiedFrom?.file === file) {\n\t\t\t// We are pasting in the same file we copied from. No need to do anything\n\t\t\treturn;\n\t\t}\n\n\t\tconst pasteCts = new vscode.CancellationTokenSource();\n\t\ttoken.onCancellationRequested(() => pasteCts.cancel());\n\n\t\t// If we have a copy operation, use that to potentially eagerly cancel the paste if it resolves to false\n\t\tmetadata?.copyOperation?.then(copyResponse => {\n\t\t\tif (copyResponse.type !== 'response' || !copyResponse.body) {\n\t\t\t\tpasteCts.cancel();\n\t\t\t}\n\t\t}, (_err) => {\n\t\t\t// Expected. May have been cancelled.\n\t\t});\n\n\t\ttry {\n\t\t\tconst pasteOperation = this._client.interruptGetErr(() => {\n\t\t\t\tthis.fileConfigurationManager.ensureConfigurationForDocument(document, token);\n\n\t\t\t\treturn this._client.execute('getPasteEdits', {\n\t\t\t\t\tfile,\n\t\t\t\t\t// TODO: only supports a single paste for now\n\t\t\t\t\tpastedText: [text],\n\t\t\t\t\tpasteLocations: ranges.map(typeConverters.Range.toTextSpan),\n\t\t\t\t\tcopiedFrom\n\t\t\t\t}, pasteCts.token);\n\t\t\t});\n\n\t\t\tconst pasteTimeout = 200;\n\t\t\tconst response = await raceTimeout(pasteOperation, pasteTimeout);\n\t\t\tif (response) {\n\t\t\t\t// Success, can return real paste edit.\n\t\t\t\tconst edit = TsPasteEdit.tryCreateFromResponse(this._client, response);\n\t\t\t\treturn edit ? [edit] : undefined;\n\t\t\t} else {\n\t\t\t\t// Still waiting on the response. Eagerly return a paste edit that we will resolve when we\n\t\t\t\t// really need to apply it\n\t\t\t\treturn [new TsPendingPasteEdit(text, pasteOperation)];\n\t\t\t}\n\t\t} finally {\n\t\t\tpasteCts.dispose();\n\t\t}\n\t}\n\n\tasync resolveDocumentPasteEdit(inEdit: TsPasteEdit, _token: vscode.CancellationToken): Promise<TsPasteEdit | undefined> {\n\t\tif (!(inEdit instanceof TsPendingPasteEdit)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst response = await inEdit.operation;\n\t\tconst pasteEdit = TsPendingPasteEdit.tryCreateFromResponse(this._client, response);\n\t\treturn pasteEdit ?? inEdit;\n\t}\n\n\tprivate async extractMetadata(dataTransfer: vscode.DataTransfer, token: vscode.CancellationToken): Promise<CopyMetadata | undefined> {\n\t\tconst metadata = await dataTransfer.get(DocumentPasteProvider.metadataMimeType)?.value;\n\t\tif (token.isCancellationRequested) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (metadata instanceof CopyMetadata) {\n\t\t\treturn metadata;\n\t\t}\n\n\t\tif (typeof metadata === 'string') {\n\t\t\treturn CopyMetadata.parse(metadata);\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate isEnabled(document: vscode.TextDocument) {\n\t\tconst config = vscode.workspace.getConfiguration(this._modeId, document.uri);\n\t\treturn config.get(enabledSettingId, true);\n\t}\n}\n\nexport function register(selector: DocumentSelector, language: LanguageDescription, client: ITypeScriptServiceClient, fileConfigurationManager: FileConfigurationManager) {\n\treturn conditionalRegistration([\n\t\trequireSomeCapability(client, ClientCapability.Semantic),\n\t\trequireMinVersion(client, API.v570),\n\t\trequireGlobalConfiguration(language.id, enabledSettingId),\n\t], () => {\n\t\treturn vscode.languages.registerDocumentPasteEditProvider(selector.semantic, new DocumentPasteProvider(language.id, client, fileConfigurationManager), {\n\t\t\tprovidedPasteEditKinds: [DocumentPasteProvider.kind],\n\t\t\tcopyMimeTypes: [DocumentPasteProvider.metadataMimeType],\n\t\t\tpasteMimeTypes: [DocumentPasteProvider.metadataMimeType],\n\t\t});\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as typeConverters from '../typeConverters';\nimport { ITypeScriptServiceClient } from '../typescriptService';\n\n\nexport default class TypeScriptDefinitionProviderBase {\n\tconstructor(\n\t\tprotected readonly client: ITypeScriptServiceClient\n\t) { }\n\n\tprotected async getSymbolLocations(\n\t\tdefinitionType: 'definition' | 'implementation' | 'typeDefinition',\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.Location[] | undefined> {\n\t\tconst file = this.client.toOpenTsFilePath(document);\n\t\tif (!file) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst args = typeConverters.Position.toFileLocationRequestArgs(file, position);\n\t\tconst response = await this.client.execute(definitionType, args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn response.body.map(location =>\n\t\t\ttypeConverters.Location.fromTextSpan(this.client.toResource(location.file), location));\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { DocumentSelector } from '../configuration/documentSelector';\nimport { API } from '../tsServer/api';\nimport * as typeConverters from '../typeConverters';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport DefinitionProviderBase from './definitionProviderBase';\nimport { conditionalRegistration, requireSomeCapability } from './util/dependentRegistration';\n\nexport default class TypeScriptDefinitionProvider extends DefinitionProviderBase implements vscode.DefinitionProvider {\n\n\tpublic async provideDefinition(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.DefinitionLink[] | vscode.Definition | undefined> {\n\t\tconst filepath = this.client.toOpenTsFilePath(document);\n\t\tif (!filepath) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst args = typeConverters.Position.toFileLocationRequestArgs(filepath, position);\n\t\tconst response = await this.client.execute('definitionAndBoundSpan', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst span = response.body.textSpan ? typeConverters.Range.fromTextSpan(response.body.textSpan) : undefined;\n\t\tlet definitions = response.body.definitions;\n\n\t\tif (vscode.workspace.getConfiguration(document.languageId).get('preferGoToSourceDefinition', false) && this.client.apiVersion.gte(API.v470)) {\n\t\t\tconst sourceDefinitionsResponse = await this.client.execute('findSourceDefinition', args, token);\n\t\t\tif (sourceDefinitionsResponse.type === 'response' && sourceDefinitionsResponse.body?.length) {\n\t\t\t\tdefinitions = sourceDefinitionsResponse.body;\n\t\t\t}\n\t\t}\n\n\t\treturn definitions\n\t\t\t.map((location): vscode.DefinitionLink => {\n\t\t\t\tconst target = typeConverters.Location.fromTextSpan(this.client.toResource(location.file), location);\n\t\t\t\tif (location.contextStart && location.contextEnd) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\toriginSelectionRange: span,\n\t\t\t\t\t\ttargetRange: typeConverters.Range.fromLocations(location.contextStart, location.contextEnd),\n\t\t\t\t\t\ttargetUri: target.uri,\n\t\t\t\t\t\ttargetSelectionRange: target.range,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\toriginSelectionRange: span,\n\t\t\t\t\ttargetRange: target.range,\n\t\t\t\t\ttargetUri: target.uri\n\t\t\t\t};\n\t\t\t});\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n) {\n\treturn conditionalRegistration([\n\t\trequireSomeCapability(client, ClientCapability.EnhancedSyntax, ClientCapability.Semantic),\n\t], () => {\n\t\treturn vscode.languages.registerDefinitionProvider(selector.syntax,\n\t\t\tnew TypeScriptDefinitionProvider(client));\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { TypeScriptServiceConfiguration } from '../configuration/configuration';\nimport { DiagnosticLanguage } from '../configuration/languageDescription';\nimport { TelemetryReporter } from '../logging/telemetry';\nimport { DiagnosticPerformanceData as TsDiagnosticPerformanceData } from '../tsServer/protocol/protocol';\nimport * as arrays from '../utils/arrays';\nimport { Disposable } from '../utils/dispose';\nimport { equals } from '../utils/objects';\nimport { ResourceMap } from '../utils/resourceMap';\n\nfunction diagnosticsEquals(a: vscode.Diagnostic, b: vscode.Diagnostic): boolean {\n\tif (a === b) {\n\t\treturn true;\n\t}\n\n\treturn a.code === b.code\n\t\t&& a.message === b.message\n\t\t&& a.severity === b.severity\n\t\t&& a.source === b.source\n\t\t&& a.range.isEqual(b.range)\n\t\t&& arrays.equals(a.relatedInformation || arrays.empty, b.relatedInformation || arrays.empty, (a, b) => {\n\t\t\treturn a.message === b.message\n\t\t\t\t&& a.location.range.isEqual(b.location.range)\n\t\t\t\t&& a.location.uri.fsPath === b.location.uri.fsPath;\n\t\t})\n\t\t&& arrays.equals(a.tags || arrays.empty, b.tags || arrays.empty);\n}\n\nexport const enum DiagnosticKind {\n\tSyntax,\n\tSemantic,\n\tSuggestion,\n\tRegionSemantic,\n}\n\nclass FileDiagnostics {\n\n\tprivate readonly _diagnostics = new Map<DiagnosticKind, ReadonlyArray<vscode.Diagnostic>>();\n\n\tconstructor(\n\t\tpublic readonly file: vscode.Uri,\n\t\tpublic language: DiagnosticLanguage\n\t) { }\n\n\tpublic updateDiagnostics(\n\t\tlanguage: DiagnosticLanguage,\n\t\tkind: DiagnosticKind,\n\t\tdiagnostics: ReadonlyArray<vscode.Diagnostic>,\n\t\tranges: ReadonlyArray<vscode.Range> | undefined\n\t): boolean {\n\t\tif (language !== this.language) {\n\t\t\tthis._diagnostics.clear();\n\t\t\tthis.language = language;\n\t\t}\n\n\t\tconst existing = this._diagnostics.get(kind);\n\t\tif (existing?.length === 0 && diagnostics.length === 0) {\n\t\t\t// No need to update\n\t\t\treturn false;\n\t\t}\n\n\t\tif (kind === DiagnosticKind.RegionSemantic) {\n\t\t\treturn this.updateRegionDiagnostics(diagnostics, ranges!);\n\t\t}\n\t\tthis._diagnostics.set(kind, diagnostics);\n\t\treturn true;\n\t}\n\n\tpublic getAllDiagnostics(settings: DiagnosticSettings): vscode.Diagnostic[] {\n\t\tif (!settings.getValidate(this.language)) {\n\t\t\treturn [];\n\t\t}\n\n\t\treturn [\n\t\t\t...this.get(DiagnosticKind.Syntax),\n\t\t\t...this.get(DiagnosticKind.Semantic),\n\t\t\t...this.getSuggestionDiagnostics(settings),\n\t\t];\n\t}\n\n\tpublic delete(toDelete: vscode.Diagnostic): void {\n\t\tfor (const [type, diags] of this._diagnostics) {\n\t\t\tthis._diagnostics.set(type, diags.filter(diag => !diagnosticsEquals(diag, toDelete)));\n\t\t}\n\t}\n\n\t/**\n\t * @param ranges The ranges whose diagnostics were updated.\n\t */\n\tprivate updateRegionDiagnostics(\n\t\tdiagnostics: ReadonlyArray<vscode.Diagnostic>,\n\t\tranges: ReadonlyArray<vscode.Range>): boolean {\n\t\tif (!this._diagnostics.get(DiagnosticKind.Semantic)) {\n\t\t\tthis._diagnostics.set(DiagnosticKind.Semantic, diagnostics);\n\t\t\treturn true;\n\t\t}\n\t\tconst oldDiagnostics = this._diagnostics.get(DiagnosticKind.Semantic)!;\n\t\tconst newDiagnostics = oldDiagnostics.filter(diag => !ranges.some(range => diag.range.intersection(range)));\n\t\tnewDiagnostics.push(...diagnostics);\n\t\tthis._diagnostics.set(DiagnosticKind.Semantic, newDiagnostics);\n\t\treturn true;\n\t}\n\n\tprivate getSuggestionDiagnostics(settings: DiagnosticSettings) {\n\t\tconst enableSuggestions = settings.getEnableSuggestions(this.language);\n\t\treturn this.get(DiagnosticKind.Suggestion).filter(x => {\n\t\t\tif (!enableSuggestions) {\n\t\t\t\t// Still show unused\n\t\t\t\treturn x.tags && (x.tags.includes(vscode.DiagnosticTag.Unnecessary) || x.tags.includes(vscode.DiagnosticTag.Deprecated));\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\t}\n\n\tprivate get(kind: DiagnosticKind): ReadonlyArray<vscode.Diagnostic> {\n\t\treturn this._diagnostics.get(kind) || [];\n\t}\n}\n\ninterface LanguageDiagnosticSettings {\n\treadonly validate: boolean;\n\treadonly enableSuggestions: boolean;\n}\n\nfunction areLanguageDiagnosticSettingsEqual(currentSettings: LanguageDiagnosticSettings, newSettings: LanguageDiagnosticSettings): boolean {\n\treturn currentSettings.validate === newSettings.validate\n\t\t&& currentSettings.enableSuggestions === newSettings.enableSuggestions;\n}\n\nclass DiagnosticSettings {\n\tprivate static readonly defaultSettings: LanguageDiagnosticSettings = {\n\t\tvalidate: true,\n\t\tenableSuggestions: true\n\t};\n\n\tprivate readonly _languageSettings = new Map<DiagnosticLanguage, LanguageDiagnosticSettings>();\n\n\tpublic getValidate(language: DiagnosticLanguage): boolean {\n\t\treturn this.get(language).validate;\n\t}\n\n\tpublic setValidate(language: DiagnosticLanguage, value: boolean): boolean {\n\t\treturn this.update(language, settings => ({\n\t\t\tvalidate: value,\n\t\t\tenableSuggestions: settings.enableSuggestions,\n\t\t}));\n\t}\n\n\tpublic getEnableSuggestions(language: DiagnosticLanguage): boolean {\n\t\treturn this.get(language).enableSuggestions;\n\t}\n\n\tpublic setEnableSuggestions(language: DiagnosticLanguage, value: boolean): boolean {\n\t\treturn this.update(language, settings => ({\n\t\t\tvalidate: settings.validate,\n\t\t\tenableSuggestions: value\n\t\t}));\n\t}\n\n\tprivate get(language: DiagnosticLanguage): LanguageDiagnosticSettings {\n\t\treturn this._languageSettings.get(language) || DiagnosticSettings.defaultSettings;\n\t}\n\n\tprivate update(language: DiagnosticLanguage, f: (x: LanguageDiagnosticSettings) => LanguageDiagnosticSettings): boolean {\n\t\tconst currentSettings = this.get(language);\n\t\tconst newSettings = f(currentSettings);\n\t\tthis._languageSettings.set(language, newSettings);\n\t\treturn !areLanguageDiagnosticSettingsEqual(currentSettings, newSettings);\n\t}\n}\n\ninterface DiagnosticPerformanceData extends TsDiagnosticPerformanceData {\n\tfileLineCount?: number;\n}\n\nclass DiagnosticsTelemetryManager extends Disposable {\n\n\tprivate readonly _diagnosticCodesMap = new Map<number, number>();\n\tprivate readonly _diagnosticSnapshotsMap = new ResourceMap<readonly vscode.Diagnostic[]>(uri => uri.toString(), { onCaseInsensitiveFileSystem: false });\n\tprivate _timeout: NodeJS.Timeout | undefined;\n\tprivate _telemetryEmitter: NodeJS.Timeout | undefined;\n\n\tconstructor(\n\t\tprivate readonly _telemetryReporter: TelemetryReporter,\n\t\tprivate readonly _diagnosticsCollection: vscode.DiagnosticCollection,\n\t) {\n\t\tsuper();\n\t\tthis._register(vscode.workspace.onDidChangeTextDocument(e => {\n\t\t\tif (e.document.languageId === 'typescript' || e.document.languageId === 'typescriptreact') {\n\t\t\t\tthis._updateAllDiagnosticCodesAfterTimeout();\n\t\t\t}\n\t\t}));\n\t\tthis._updateAllDiagnosticCodesAfterTimeout();\n\t\tthis._registerTelemetryEventEmitter();\n\t}\n\n\tpublic logDiagnosticsPerformanceTelemetry(performanceData: DiagnosticPerformanceData[]): void {\n\t\tfor (const data of performanceData) {\n\t\t\t/* __GDPR__\n\t\t\t\t\"diagnostics.performance\" : {\n\t\t\t\t\t\"owner\": \"mjbvz\",\n\t\t\t\t\t\"syntaxDiagDuration\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\t\t\"semanticDiagDuration\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\t\t\"suggestionDiagDuration\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\t\t\"regionSemanticDiagDuration\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\t\t\"fileLineCount\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\t\t\t\"${include}\": [\n\t\t\t\t\t\t\"${TypeScriptCommonProperties}\"\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t*/\n\t\t\tthis._telemetryReporter.logTelemetry('diagnostics.performance',\n\t\t\t\t{\n\t\t\t\t\tsyntaxDiagDuration: data.syntaxDiag,\n\t\t\t\t\tsemanticDiagDuration: data.semanticDiag,\n\t\t\t\t\tsuggestionDiagDuration: data.suggestionDiag,\n\t\t\t\t\tregionSemanticDiagDuration: data.regionSemanticDiag,\n\t\t\t\t\tfileLineCount: data.fileLineCount,\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\t}\n\n\tprivate _updateAllDiagnosticCodesAfterTimeout() {\n\t\tclearTimeout(this._timeout);\n\t\tthis._timeout = setTimeout(() => this._updateDiagnosticCodes(), 5000);\n\t}\n\n\tprivate _increaseDiagnosticCodeCount(code: string | number | undefined) {\n\t\tif (code === undefined) {\n\t\t\treturn;\n\t\t}\n\t\tthis._diagnosticCodesMap.set(Number(code), (this._diagnosticCodesMap.get(Number(code)) || 0) + 1);\n\t}\n\n\tprivate _updateDiagnosticCodes() {\n\t\tthis._diagnosticsCollection.forEach((uri, diagnostics) => {\n\t\t\tconst previousDiagnostics = this._diagnosticSnapshotsMap.get(uri);\n\t\t\tthis._diagnosticSnapshotsMap.set(uri, diagnostics);\n\t\t\tconst diagnosticsDiff = diagnostics.filter((diagnostic) => !previousDiagnostics?.some((previousDiagnostic) => equals(diagnostic, previousDiagnostic)));\n\t\t\tdiagnosticsDiff.forEach((diagnostic) => {\n\t\t\t\tconst code = diagnostic.code;\n\t\t\t\tthis._increaseDiagnosticCodeCount(typeof code === 'string' || typeof code === 'number' ? code : code?.value);\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate _registerTelemetryEventEmitter() {\n\t\tthis._telemetryEmitter = setInterval(() => {\n\t\t\tif (this._diagnosticCodesMap.size > 0) {\n\t\t\t\tlet diagnosticCodes = '';\n\t\t\t\tthis._diagnosticCodesMap.forEach((value, key) => {\n\t\t\t\t\tdiagnosticCodes += `${key}:${value},`;\n\t\t\t\t});\n\t\t\t\tthis._diagnosticCodesMap.clear();\n\t\t\t\t/* __GDPR__\n\t\t\t\t\t\"typescript.diagnostics\" : {\n\t\t\t\t\t\t\"owner\": \"aiday-mar\",\n\t\t\t\t\t\t\"diagnosticCodes\" : { \"classification\": \"PublicNonPersonalData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\t\t\"${include}\": [\n\t\t\t\t\t\t\t\"${TypeScriptCommonProperties}\"\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t*/\n\t\t\t\tthis._telemetryReporter.logTelemetry('typescript.diagnostics', {\n\t\t\t\t\tdiagnosticCodes: diagnosticCodes\n\t\t\t\t});\n\t\t\t}\n\t\t}, 5 * 60 * 1000); // 5 minutes\n\t}\n\n\toverride dispose() {\n\t\tsuper.dispose();\n\t\tclearTimeout(this._timeout);\n\t\tclearInterval(this._telemetryEmitter);\n\t}\n}\n\nexport class DiagnosticsManager extends Disposable {\n\tprivate readonly _diagnostics: ResourceMap<FileDiagnostics>;\n\tprivate readonly _settings = new DiagnosticSettings();\n\tprivate readonly _currentDiagnostics: vscode.DiagnosticCollection;\n\tprivate readonly _pendingUpdates: ResourceMap<any>;\n\n\tprivate readonly _updateDelay = 50;\n\n\tprivate readonly _diagnosticsTelemetryManager: DiagnosticsTelemetryManager | undefined;\n\n\tconstructor(\n\t\towner: string,\n\t\tconfiguration: TypeScriptServiceConfiguration,\n\t\ttelemetryReporter: TelemetryReporter,\n\t\tonCaseInsensitiveFileSystem: boolean\n\t) {\n\t\tsuper();\n\t\tthis._diagnostics = new ResourceMap<FileDiagnostics>(undefined, { onCaseInsensitiveFileSystem });\n\t\tthis._pendingUpdates = new ResourceMap<any>(undefined, { onCaseInsensitiveFileSystem });\n\n\t\tthis._currentDiagnostics = this._register(vscode.languages.createDiagnosticCollection(owner));\n\t\t// Here we are selecting only 1 user out of 1000 to send telemetry diagnostics\n\t\tif (Math.random() * 1000 <= 1 || configuration.enableDiagnosticsTelemetry) {\n\t\t\tthis._diagnosticsTelemetryManager = this._register(new DiagnosticsTelemetryManager(telemetryReporter, this._currentDiagnostics));\n\t\t}\n\t}\n\n\tpublic override dispose() {\n\t\tsuper.dispose();\n\n\t\tfor (const value of this._pendingUpdates.values()) {\n\t\t\tclearTimeout(value);\n\t\t}\n\t\tthis._pendingUpdates.clear();\n\t}\n\n\tpublic reInitialize(): void {\n\t\tthis._currentDiagnostics.clear();\n\t\tthis._diagnostics.clear();\n\t}\n\n\tpublic setValidate(language: DiagnosticLanguage, value: boolean) {\n\t\tconst didUpdate = this._settings.setValidate(language, value);\n\t\tif (didUpdate) {\n\t\t\tthis.rebuildAll();\n\t\t}\n\t}\n\n\tpublic setEnableSuggestions(language: DiagnosticLanguage, value: boolean) {\n\t\tconst didUpdate = this._settings.setEnableSuggestions(language, value);\n\t\tif (didUpdate) {\n\t\t\tthis.rebuildAll();\n\t\t}\n\t}\n\n\tpublic updateDiagnostics(\n\t\tfile: vscode.Uri,\n\t\tlanguage: DiagnosticLanguage,\n\t\tkind: DiagnosticKind,\n\t\tdiagnostics: ReadonlyArray<vscode.Diagnostic>,\n\t\tranges: ReadonlyArray<vscode.Range> | undefined,\n\t): void {\n\t\tlet didUpdate = false;\n\t\tconst entry = this._diagnostics.get(file);\n\t\tif (entry) {\n\t\t\tdidUpdate = entry.updateDiagnostics(language, kind, diagnostics, ranges);\n\t\t} else if (diagnostics.length) {\n\t\t\tconst fileDiagnostics = new FileDiagnostics(file, language);\n\t\t\tfileDiagnostics.updateDiagnostics(language, kind, diagnostics, ranges);\n\t\t\tthis._diagnostics.set(file, fileDiagnostics);\n\t\t\tdidUpdate = true;\n\t\t}\n\n\t\tif (didUpdate) {\n\t\t\tthis.scheduleDiagnosticsUpdate(file);\n\t\t}\n\t}\n\n\tpublic configFileDiagnosticsReceived(\n\t\tfile: vscode.Uri,\n\t\tdiagnostics: ReadonlyArray<vscode.Diagnostic>\n\t): void {\n\t\tthis._currentDiagnostics.set(file, diagnostics);\n\t}\n\n\tpublic deleteAllDiagnosticsInFile(resource: vscode.Uri): void {\n\t\tthis._currentDiagnostics.delete(resource);\n\t\tthis._diagnostics.delete(resource);\n\t}\n\n\tpublic deleteDiagnostic(resource: vscode.Uri, diagnostic: vscode.Diagnostic): void {\n\t\tconst fileDiagnostics = this._diagnostics.get(resource);\n\t\tif (fileDiagnostics) {\n\t\t\tfileDiagnostics.delete(diagnostic);\n\t\t\tthis.rebuildFile(fileDiagnostics);\n\t\t}\n\t}\n\n\tpublic getDiagnostics(file: vscode.Uri): ReadonlyArray<vscode.Diagnostic> {\n\t\treturn this._currentDiagnostics.get(file) || [];\n\t}\n\n\tpublic logDiagnosticsPerformanceTelemetry(performanceData: DiagnosticPerformanceData[]): void {\n\t\tthis._diagnosticsTelemetryManager?.logDiagnosticsPerformanceTelemetry(performanceData);\n\t}\n\n\tprivate scheduleDiagnosticsUpdate(file: vscode.Uri) {\n\t\tif (!this._pendingUpdates.has(file)) {\n\t\t\tthis._pendingUpdates.set(file, setTimeout(() => this.updateCurrentDiagnostics(file), this._updateDelay));\n\t\t}\n\t}\n\n\tprivate updateCurrentDiagnostics(file: vscode.Uri): void {\n\t\tif (this._pendingUpdates.has(file)) {\n\t\t\tclearTimeout(this._pendingUpdates.get(file));\n\t\t\tthis._pendingUpdates.delete(file);\n\t\t}\n\n\t\tconst fileDiagnostics = this._diagnostics.get(file);\n\t\tthis._currentDiagnostics.set(file, fileDiagnostics ? fileDiagnostics.getAllDiagnostics(this._settings) : []);\n\t}\n\n\tprivate rebuildAll(): void {\n\t\tthis._currentDiagnostics.clear();\n\t\tfor (const fileDiagnostic of this._diagnostics.values()) {\n\t\t\tthis.rebuildFile(fileDiagnostic);\n\t\t}\n\t}\n\n\tprivate rebuildFile(fileDiagnostic: FileDiagnostics) {\n\t\tthis._currentDiagnostics.set(fileDiagnostic.file, fileDiagnostic.getAllDiagnostics(this._settings));\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { DocumentSelector } from '../configuration/documentSelector';\nimport { API } from '../tsServer/api';\nimport { ITypeScriptServiceClient } from '../typescriptService';\n\n\ninterface Directive {\n\treadonly value: string;\n\treadonly description: string;\n}\n\nconst tsDirectives: Directive[] = [\n\t{\n\t\tvalue: '@ts-check',\n\t\tdescription: vscode.l10n.t(\"Enables semantic checking in a JavaScript file. Must be at the top of a file.\")\n\t}, {\n\t\tvalue: '@ts-nocheck',\n\t\tdescription: vscode.l10n.t(\"Disables semantic checking in a JavaScript file. Must be at the top of a file.\")\n\t}, {\n\t\tvalue: '@ts-ignore',\n\t\tdescription: vscode.l10n.t(\"Suppresses @ts-check errors on the next line of a file.\")\n\t}\n];\n\nconst tsDirectives390: Directive[] = [\n\t...tsDirectives,\n\t{\n\t\tvalue: '@ts-expect-error',\n\t\tdescription: vscode.l10n.t(\"Suppresses @ts-check errors on the next line of a file, expecting at least one to exist.\")\n\t}\n];\n\nclass DirectiveCommentCompletionProvider implements vscode.CompletionItemProvider {\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t) { }\n\n\tpublic provideCompletionItems(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\t_token: vscode.CancellationToken\n\t): vscode.CompletionItem[] {\n\t\tconst file = this.client.toOpenTsFilePath(document);\n\t\tif (!file) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst line = document.lineAt(position.line).text;\n\t\tconst prefix = line.slice(0, position.character);\n\t\tconst match = prefix.match(/^\\s*\\/\\/+\\s?(@[a-zA-Z\\-]*)?$/);\n\t\tif (match) {\n\t\t\tconst directives = this.client.apiVersion.gte(API.v390)\n\t\t\t\t? tsDirectives390\n\t\t\t\t: tsDirectives;\n\n\t\t\treturn directives.map(directive => {\n\t\t\t\tconst item = new vscode.CompletionItem(directive.value, vscode.CompletionItemKind.Snippet);\n\t\t\t\titem.detail = directive.description;\n\t\t\t\titem.range = new vscode.Range(position.line, Math.max(0, position.character - (match[1] ? match[1].length : 0)), position.line, position.character);\n\t\t\t\treturn item;\n\t\t\t});\n\t\t}\n\t\treturn [];\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n) {\n\treturn vscode.languages.registerCompletionItemProvider(selector.syntax,\n\t\tnew DirectiveCommentCompletionProvider(client),\n\t\t'@');\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { DocumentSelector } from '../configuration/documentSelector';\nimport type * as Proto from '../tsServer/protocol/protocol';\nimport * as typeConverters from '../typeConverters';\nimport { ITypeScriptServiceClient } from '../typescriptService';\n\nclass TypeScriptDocumentHighlightProvider implements vscode.DocumentHighlightProvider, vscode.MultiDocumentHighlightProvider {\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient\n\t) { }\n\n\tpublic async provideMultiDocumentHighlights(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\totherDocuments: vscode.TextDocument[],\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.MultiDocumentHighlight[]> {\n\t\tconst allFiles = [document, ...otherDocuments].map(doc => this.client.toOpenTsFilePath(doc)).filter(file => !!file) as string[];\n\t\tconst file = this.client.toOpenTsFilePath(document);\n\n\t\tif (!file || allFiles.length === 0) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst args = {\n\t\t\t...typeConverters.Position.toFileLocationRequestArgs(file, position),\n\t\t\tfilesToSearch: allFiles\n\t\t};\n\t\tconst response = await this.client.execute('documentHighlights', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst result = response.body.map(highlightItem =>\n\t\t\tnew vscode.MultiDocumentHighlight(\n\t\t\t\tvscode.Uri.file(highlightItem.file),\n\t\t\t\t[...convertDocumentHighlight(highlightItem)]\n\t\t\t)\n\t\t);\n\n\t\treturn result;\n\t}\n\n\tpublic async provideDocumentHighlights(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.DocumentHighlight[]> {\n\t\tconst file = this.client.toOpenTsFilePath(document);\n\t\tif (!file) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst args = {\n\t\t\t...typeConverters.Position.toFileLocationRequestArgs(file, position),\n\t\t\tfilesToSearch: [file]\n\t\t};\n\t\tconst response = await this.client.execute('documentHighlights', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn [];\n\t\t}\n\n\t\treturn response.body.flatMap(convertDocumentHighlight);\n\t}\n}\n\nfunction convertDocumentHighlight(highlight: Proto.DocumentHighlightsItem): ReadonlyArray<vscode.DocumentHighlight> {\n\treturn highlight.highlightSpans.map(span =>\n\t\tnew vscode.DocumentHighlight(\n\t\t\ttypeConverters.Range.fromTextSpan(span),\n\t\t\tspan.kind === 'writtenReference' ? vscode.DocumentHighlightKind.Write : vscode.DocumentHighlightKind.Read));\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n) {\n\tconst provider = new TypeScriptDocumentHighlightProvider(client);\n\n\treturn vscode.Disposable.from(\n\t\tvscode.languages.registerDocumentHighlightProvider(selector.syntax, provider),\n\t\tvscode.languages.registerMultiDocumentHighlightProvider(selector.syntax, provider)\n\t);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { DocumentSelector } from '../configuration/documentSelector';\nimport { CachedResponse } from '../tsServer/cachedResponse';\nimport { parseKindModifier } from '../tsServer/protocol/modifiers';\nimport type * as Proto from '../tsServer/protocol/protocol';\nimport * as PConst from '../tsServer/protocol/protocol.const';\nimport * as typeConverters from '../typeConverters';\nimport { ITypeScriptServiceClient } from '../typescriptService';\n\nconst getSymbolKind = (kind: string): vscode.SymbolKind => {\n\tswitch (kind) {\n\t\tcase PConst.Kind.module: return vscode.SymbolKind.Module;\n\t\tcase PConst.Kind.class: return vscode.SymbolKind.Class;\n\t\tcase PConst.Kind.enum: return vscode.SymbolKind.Enum;\n\t\tcase PConst.Kind.interface: return vscode.SymbolKind.Interface;\n\t\tcase PConst.Kind.method: return vscode.SymbolKind.Method;\n\t\tcase PConst.Kind.memberVariable: return vscode.SymbolKind.Property;\n\t\tcase PConst.Kind.memberGetAccessor: return vscode.SymbolKind.Property;\n\t\tcase PConst.Kind.memberSetAccessor: return vscode.SymbolKind.Property;\n\t\tcase PConst.Kind.variable: return vscode.SymbolKind.Variable;\n\t\tcase PConst.Kind.const: return vscode.SymbolKind.Variable;\n\t\tcase PConst.Kind.localVariable: return vscode.SymbolKind.Variable;\n\t\tcase PConst.Kind.function: return vscode.SymbolKind.Function;\n\t\tcase PConst.Kind.localFunction: return vscode.SymbolKind.Function;\n\t\tcase PConst.Kind.constructSignature: return vscode.SymbolKind.Constructor;\n\t\tcase PConst.Kind.constructorImplementation: return vscode.SymbolKind.Constructor;\n\t}\n\treturn vscode.SymbolKind.Variable;\n};\n\nclass TypeScriptDocumentSymbolProvider implements vscode.DocumentSymbolProvider {\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly cachedResponse: CachedResponse<Proto.NavTreeResponse>,\n\t) { }\n\n\tpublic async provideDocumentSymbols(document: vscode.TextDocument, token: vscode.CancellationToken): Promise<vscode.DocumentSymbol[] | undefined> {\n\t\tconst file = this.client.toOpenTsFilePath(document);\n\t\tif (!file) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst args: Proto.FileRequestArgs = { file };\n\t\tconst response = await this.cachedResponse.execute(document, () => this.client.execute('navtree', args, token));\n\t\tif (response.type !== 'response' || !response.body?.childItems) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// The root represents the file. Ignore this when showing in the UI\n\t\tconst result: vscode.DocumentSymbol[] = [];\n\t\tfor (const item of response.body.childItems) {\n\t\t\tTypeScriptDocumentSymbolProvider.convertNavTree(document.uri, result, item);\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate static convertNavTree(\n\t\tresource: vscode.Uri,\n\t\toutput: vscode.DocumentSymbol[],\n\t\titem: Proto.NavigationTree,\n\t): boolean {\n\t\tlet shouldInclude = TypeScriptDocumentSymbolProvider.shouldInclueEntry(item);\n\t\tif (!shouldInclude && !item.childItems?.length) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst children = new Set(item.childItems || []);\n\t\tfor (const span of item.spans) {\n\t\t\tconst range = typeConverters.Range.fromTextSpan(span);\n\t\t\tconst symbolInfo = TypeScriptDocumentSymbolProvider.convertSymbol(item, range);\n\n\t\t\tfor (const child of children) {\n\t\t\t\tif (child.spans.some(span => !!range.intersection(typeConverters.Range.fromTextSpan(span)))) {\n\t\t\t\t\tconst includedChild = TypeScriptDocumentSymbolProvider.convertNavTree(resource, symbolInfo.children, child);\n\t\t\t\t\tshouldInclude = shouldInclude || includedChild;\n\t\t\t\t\tchildren.delete(child);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (shouldInclude) {\n\t\t\t\toutput.push(symbolInfo);\n\t\t\t}\n\t\t}\n\n\t\treturn shouldInclude;\n\t}\n\n\tprivate static convertSymbol(item: Proto.NavigationTree, range: vscode.Range): vscode.DocumentSymbol {\n\t\tconst selectionRange = item.nameSpan ? typeConverters.Range.fromTextSpan(item.nameSpan) : range;\n\t\tlet label = item.text;\n\n\t\tswitch (item.kind) {\n\t\t\tcase PConst.Kind.memberGetAccessor: label = `(get) ${label}`; break;\n\t\t\tcase PConst.Kind.memberSetAccessor: label = `(set) ${label}`; break;\n\t\t}\n\n\t\tconst symbolInfo = new vscode.DocumentSymbol(\n\t\t\tlabel,\n\t\t\t'',\n\t\t\tgetSymbolKind(item.kind),\n\t\t\trange,\n\t\t\trange.contains(selectionRange) ? selectionRange : range);\n\n\n\t\tconst kindModifiers = parseKindModifier(item.kindModifiers);\n\t\tif (kindModifiers.has(PConst.KindModifiers.deprecated)) {\n\t\t\tsymbolInfo.tags = [vscode.SymbolTag.Deprecated];\n\t\t}\n\n\t\treturn symbolInfo;\n\t}\n\n\tprivate static shouldInclueEntry(item: Proto.NavigationTree | Proto.NavigationBarItem): boolean {\n\t\tif (item.kind === PConst.Kind.alias) {\n\t\t\treturn false;\n\t\t}\n\t\treturn !!(item.text && item.text !== '<function>' && item.text !== '<class>');\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n\tcachedResponse: CachedResponse<Proto.NavTreeResponse>,\n) {\n\treturn vscode.languages.registerDocumentSymbolProvider(selector.syntax,\n\t\tnew TypeScriptDocumentSymbolProvider(client, cachedResponse), { label: 'TypeScript' });\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as path from 'path';\nimport * as vscode from 'vscode';\nimport * as fileSchemes from '../configuration/fileSchemes';\nimport { isTypeScriptDocument } from '../configuration/languageIds';\nimport { API } from '../tsServer/api';\nimport type * as Proto from '../tsServer/protocol/protocol';\nimport { ITypeScriptServiceClient } from '../typescriptService';\nimport { Disposable } from '../utils/dispose';\nimport { equals } from '../utils/objects';\nimport { ResourceMap } from '../utils/resourceMap';\n\ninterface FileConfiguration {\n\treadonly formatOptions: Proto.FormatCodeSettings;\n\treadonly preferences: Proto.UserPreferences;\n}\n\ninterface FormattingOptions {\n\n\treadonly tabSize: number | undefined;\n\n\treadonly insertSpaces: boolean | undefined;\n}\n\nfunction areFileConfigurationsEqual(a: FileConfiguration, b: FileConfiguration): boolean {\n\treturn equals(a, b);\n}\n\nexport default class FileConfigurationManager extends Disposable {\n\tprivate readonly formatOptions: ResourceMap<Promise<FileConfiguration | undefined>>;\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tonCaseInsensitiveFileSystem: boolean\n\t) {\n\t\tsuper();\n\t\tthis.formatOptions = new ResourceMap(undefined, { onCaseInsensitiveFileSystem });\n\t\tvscode.workspace.onDidCloseTextDocument(textDocument => {\n\t\t\t// When a document gets closed delete the cached formatting options.\n\t\t\t// This is necessary since the tsserver now closed a project when its\n\t\t\t// last file in it closes which drops the stored formatting options\n\t\t\t// as well.\n\t\t\tthis.formatOptions.delete(textDocument.uri);\n\t\t}, undefined, this._disposables);\n\t}\n\n\tpublic async ensureConfigurationForDocument(\n\t\tdocument: vscode.TextDocument,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<void> {\n\t\tconst formattingOptions = this.getFormattingOptions(document);\n\t\tif (formattingOptions) {\n\t\t\treturn this.ensureConfigurationOptions(document, formattingOptions, token);\n\t\t}\n\t}\n\n\tprivate getFormattingOptions(document: vscode.TextDocument): FormattingOptions | undefined {\n\t\tconst editor = vscode.window.visibleTextEditors.find(editor => editor.document.uri.toString() === document.uri.toString());\n\t\tif (!editor) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn {\n\t\t\ttabSize: typeof editor.options.tabSize === 'number' ? editor.options.tabSize : undefined,\n\t\t\tinsertSpaces: typeof editor.options.insertSpaces === 'boolean' ? editor.options.insertSpaces : undefined,\n\t\t};\n\t}\n\n\tpublic async ensureConfigurationOptions(\n\t\tdocument: vscode.TextDocument,\n\t\toptions: FormattingOptions,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<void> {\n\t\tconst file = this.client.toOpenTsFilePath(document);\n\t\tif (!file) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentOptions = this.getFileOptions(document, options);\n\t\tconst cachedOptions = this.formatOptions.get(document.uri);\n\t\tif (cachedOptions) {\n\t\t\tconst cachedOptionsValue = await cachedOptions;\n\t\t\tif (token.isCancellationRequested) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (cachedOptionsValue && areFileConfigurationsEqual(cachedOptionsValue, currentOptions)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst task = (async () => {\n\t\t\ttry {\n\t\t\t\tconst response = await this.client.execute('configure', { file, ...currentOptions }, token);\n\t\t\t\treturn response.type === 'response' ? currentOptions : undefined;\n\t\t\t} catch {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t})();\n\n\t\tthis.formatOptions.set(document.uri, task);\n\n\t\tawait task;\n\t}\n\n\tpublic async setGlobalConfigurationFromDocument(\n\t\tdocument: vscode.TextDocument,\n\t\ttoken: vscode.CancellationToken,\n\t): Promise<void> {\n\t\tconst formattingOptions = this.getFormattingOptions(document);\n\t\tif (!formattingOptions) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst args: Proto.ConfigureRequestArguments = {\n\t\t\tfile: undefined /*global*/,\n\t\t\t...this.getFileOptions(document, formattingOptions),\n\t\t};\n\t\tawait this.client.execute('configure', args, token);\n\t}\n\n\tpublic reset() {\n\t\tthis.formatOptions.clear();\n\t}\n\n\tprivate getFileOptions(\n\t\tdocument: vscode.TextDocument,\n\t\toptions: FormattingOptions\n\t): FileConfiguration {\n\t\treturn {\n\t\t\tformatOptions: this.getFormatOptions(document, options),\n\t\t\tpreferences: this.getPreferences(document)\n\t\t};\n\t}\n\n\tprivate getFormatOptions(\n\t\tdocument: vscode.TextDocument,\n\t\toptions: FormattingOptions\n\t): Proto.FormatCodeSettings {\n\t\tconst config = vscode.workspace.getConfiguration(\n\t\t\tisTypeScriptDocument(document) ? 'typescript.format' : 'javascript.format',\n\t\t\tdocument.uri);\n\n\t\treturn {\n\t\t\ttabSize: options.tabSize,\n\t\t\tindentSize: options.tabSize,\n\t\t\tconvertTabsToSpaces: options.insertSpaces,\n\t\t\t// We can use \\n here since the editor normalizes later on to its line endings.\n\t\t\tnewLineCharacter: '\\n',\n\t\t\tinsertSpaceAfterCommaDelimiter: config.get<boolean>('insertSpaceAfterCommaDelimiter'),\n\t\t\tinsertSpaceAfterConstructor: config.get<boolean>('insertSpaceAfterConstructor'),\n\t\t\tinsertSpaceAfterSemicolonInForStatements: config.get<boolean>('insertSpaceAfterSemicolonInForStatements'),\n\t\t\tinsertSpaceBeforeAndAfterBinaryOperators: config.get<boolean>('insertSpaceBeforeAndAfterBinaryOperators'),\n\t\t\tinsertSpaceAfterKeywordsInControlFlowStatements: config.get<boolean>('insertSpaceAfterKeywordsInControlFlowStatements'),\n\t\t\tinsertSpaceAfterFunctionKeywordForAnonymousFunctions: config.get<boolean>('insertSpaceAfterFunctionKeywordForAnonymousFunctions'),\n\t\t\tinsertSpaceBeforeFunctionParenthesis: config.get<boolean>('insertSpaceBeforeFunctionParenthesis'),\n\t\t\tinsertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis: config.get<boolean>('insertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis'),\n\t\t\tinsertSpaceAfterOpeningAndBeforeClosingNonemptyBrackets: config.get<boolean>('insertSpaceAfterOpeningAndBeforeClosingNonemptyBrackets'),\n\t\t\tinsertSpaceAfterOpeningAndBeforeClosingNonemptyBraces: config.get<boolean>('insertSpaceAfterOpeningAndBeforeClosingNonemptyBraces'),\n\t\t\tinsertSpaceAfterOpeningAndBeforeClosingEmptyBraces: config.get<boolean>('insertSpaceAfterOpeningAndBeforeClosingEmptyBraces'),\n\t\t\tinsertSpaceAfterOpeningAndBeforeClosingTemplateStringBraces: config.get<boolean>('insertSpaceAfterOpeningAndBeforeClosingTemplateStringBraces'),\n\t\t\tinsertSpaceAfterOpeningAndBeforeClosingJsxExpressionBraces: config.get<boolean>('insertSpaceAfterOpeningAndBeforeClosingJsxExpressionBraces'),\n\t\t\tinsertSpaceAfterTypeAssertion: config.get<boolean>('insertSpaceAfterTypeAssertion'),\n\t\t\tplaceOpenBraceOnNewLineForFunctions: config.get<boolean>('placeOpenBraceOnNewLineForFunctions'),\n\t\t\tplaceOpenBraceOnNewLineForControlBlocks: config.get<boolean>('placeOpenBraceOnNewLineForControlBlocks'),\n\t\t\tsemicolons: config.get<Proto.SemicolonPreference>('semicolons'),\n\t\t\tindentSwitchCase: config.get<boolean>('indentSwitchCase'),\n\t\t};\n\t}\n\n\tprivate getPreferences(document: vscode.TextDocument): Proto.UserPreferences {\n\t\tconst config = vscode.workspace.getConfiguration(\n\t\t\tisTypeScriptDocument(document) ? 'typescript' : 'javascript',\n\t\t\tdocument);\n\n\t\tconst preferencesConfig = vscode.workspace.getConfiguration(\n\t\t\tisTypeScriptDocument(document) ? 'typescript.preferences' : 'javascript.preferences',\n\t\t\tdocument);\n\n\t\tconst preferences: Proto.UserPreferences = {\n\t\t\t...config.get('unstable'),\n\t\t\tquotePreference: this.getQuoteStylePreference(preferencesConfig),\n\t\t\timportModuleSpecifierPreference: getImportModuleSpecifierPreference(preferencesConfig),\n\t\t\timportModuleSpecifierEnding: getImportModuleSpecifierEndingPreference(preferencesConfig),\n\t\t\tjsxAttributeCompletionStyle: getJsxAttributeCompletionStyle(preferencesConfig),\n\t\t\tallowTextChangesInNewFiles: document.uri.scheme === fileSchemes.file,\n\t\t\tprovidePrefixAndSuffixTextForRename: preferencesConfig.get<boolean>('renameShorthandProperties', true) === false ? false : preferencesConfig.get<boolean>('useAliasesForRenames', true),\n\t\t\tallowRenameOfImportPath: true,\n\t\t\tincludeAutomaticOptionalChainCompletions: config.get<boolean>('suggest.includeAutomaticOptionalChainCompletions', true),\n\t\t\tprovideRefactorNotApplicableReason: true,\n\t\t\tgenerateReturnInDocTemplate: config.get<boolean>('suggest.jsdoc.generateReturns', true),\n\t\t\tincludeCompletionsForImportStatements: config.get<boolean>('suggest.includeCompletionsForImportStatements', true),\n\t\t\tincludeCompletionsWithSnippetText: true,\n\t\t\tincludeCompletionsWithClassMemberSnippets: config.get<boolean>('suggest.classMemberSnippets.enabled', true),\n\t\t\tincludeCompletionsWithObjectLiteralMethodSnippets: config.get<boolean>('suggest.objectLiteralMethodSnippets.enabled', true),\n\t\t\tautoImportFileExcludePatterns: this.getAutoImportFileExcludePatternsPreference(preferencesConfig, vscode.workspace.getWorkspaceFolder(document.uri)?.uri),\n\t\t\tautoImportSpecifierExcludeRegexes: preferencesConfig.get<string[]>('autoImportSpecifierExcludeRegexes'),\n\t\t\tpreferTypeOnlyAutoImports: preferencesConfig.get<boolean>('preferTypeOnlyAutoImports', false),\n\t\t\tuseLabelDetailsInCompletionEntries: true,\n\t\t\tallowIncompleteCompletions: true,\n\t\t\tdisplayPartsForJSDoc: true,\n\t\t\tdisableLineTextInReferences: true,\n\t\t\tinteractiveInlayHints: true,\n\t\t\tincludeCompletionsForModuleExports: config.get<boolean>('suggest.autoImports'),\n\t\t\t...getInlayHintsPreferences(config),\n\t\t\t...this.getOrganizeImportsPreferences(preferencesConfig),\n\t\t};\n\n\t\treturn preferences;\n\t}\n\n\tprivate getQuoteStylePreference(config: vscode.WorkspaceConfiguration) {\n\t\tswitch (config.get<string>('quoteStyle')) {\n\t\t\tcase 'single': return 'single';\n\t\t\tcase 'double': return 'double';\n\t\t\tdefault: return 'auto';\n\t\t}\n\t}\n\n\tprivate getAutoImportFileExcludePatternsPreference(config: vscode.WorkspaceConfiguration, workspaceFolder: vscode.Uri | undefined): string[] | undefined {\n\t\treturn workspaceFolder && config.get<string[]>('autoImportFileExcludePatterns')?.map(p => {\n\t\t\t// Normalization rules: https://github.com/microsoft/TypeScript/pull/49578\n\t\t\tconst isRelative = /^\\.\\.?($|[\\/\\\\])/.test(p);\n\t\t\t// In TypeScript < 5.3, the first path component cannot be a wildcard, so we need to prefix\n\t\t\t// it with a path root (e.g. `/` or `c:\\`)\n\t\t\tconst wildcardPrefix = this.client.apiVersion.gte(API.v540)\n\t\t\t\t? ''\n\t\t\t\t: path.parse(this.client.toTsFilePath(workspaceFolder)!).root;\n\t\t\treturn path.isAbsolute(p) ? p :\n\t\t\t\tp.startsWith('*') ? wildcardPrefix + p :\n\t\t\t\t\tisRelative ? this.client.toTsFilePath(vscode.Uri.joinPath(workspaceFolder, p))! :\n\t\t\t\t\t\twildcardPrefix + '**' + path.sep + p;\n\t\t});\n\t}\n\n\tprivate getOrganizeImportsPreferences(config: vscode.WorkspaceConfiguration): Proto.UserPreferences {\n\t\tconst organizeImportsCollation = config.get<'ordinal' | 'unicode'>('organizeImports.unicodeCollation');\n\t\tconst organizeImportsCaseSensitivity = config.get<'auto' | 'caseInsensitive' | 'caseSensitive'>('organizeImports.caseSensitivity');\n\t\treturn {\n\t\t\t// More specific settings\n\t\t\torganizeImportsTypeOrder: withDefaultAsUndefined(config.get<'auto' | 'last' | 'inline' | 'first'>('organizeImports.typeOrder', 'auto'), 'auto'),\n\t\t\torganizeImportsIgnoreCase: organizeImportsCaseSensitivity === 'caseInsensitive' ? true\n\t\t\t\t: organizeImportsCaseSensitivity === 'caseSensitive' ? false\n\t\t\t\t\t: 'auto',\n\t\t\torganizeImportsCollation,\n\n\t\t\t// The rest of the settings are only applicable when using unicode collation\n\t\t\t...(organizeImportsCollation === 'unicode' ? {\n\t\t\t\torganizeImportsCaseFirst: organizeImportsCaseSensitivity === 'caseInsensitive' ? undefined : withDefaultAsUndefined(config.get<'default' | 'upper' | 'lower' | false>('organizeImports.caseFirst', false), 'default'),\n\t\t\t\torganizeImportsAccentCollation: config.get<boolean>('organizeImports.accentCollation'),\n\t\t\t\torganizeImportsLocale: config.get<string>('organizeImports.locale'),\n\t\t\t\torganizeImportsNumericCollation: config.get<boolean>('organizeImports.numericCollation'),\n\t\t\t} : {}),\n\t\t};\n\t}\n}\n\nfunction withDefaultAsUndefined<T, O extends T>(value: T, def: O): Exclude<T, O> | undefined {\n\treturn value === def ? undefined : value as Exclude<T, O>;\n}\n\nexport class InlayHintSettingNames {\n\tstatic readonly parameterNamesSuppressWhenArgumentMatchesName = 'inlayHints.parameterNames.suppressWhenArgumentMatchesName';\n\tstatic readonly parameterNamesEnabled = 'inlayHints.parameterTypes.enabled';\n\tstatic readonly variableTypesEnabled = 'inlayHints.variableTypes.enabled';\n\tstatic readonly variableTypesSuppressWhenTypeMatchesName = 'inlayHints.variableTypes.suppressWhenTypeMatchesName';\n\tstatic readonly propertyDeclarationTypesEnabled = 'inlayHints.propertyDeclarationTypes.enabled';\n\tstatic readonly functionLikeReturnTypesEnabled = 'inlayHints.functionLikeReturnTypes.enabled';\n\tstatic readonly enumMemberValuesEnabled = 'inlayHints.enumMemberValues.enabled';\n}\n\nexport function getInlayHintsPreferences(config: vscode.WorkspaceConfiguration) {\n\treturn {\n\t\tincludeInlayParameterNameHints: getInlayParameterNameHintsPreference(config),\n\t\tincludeInlayParameterNameHintsWhenArgumentMatchesName: !config.get<boolean>(InlayHintSettingNames.parameterNamesSuppressWhenArgumentMatchesName, true),\n\t\tincludeInlayFunctionParameterTypeHints: config.get<boolean>(InlayHintSettingNames.parameterNamesEnabled, false),\n\t\tincludeInlayVariableTypeHints: config.get<boolean>(InlayHintSettingNames.variableTypesEnabled, false),\n\t\tincludeInlayVariableTypeHintsWhenTypeMatchesName: !config.get<boolean>(InlayHintSettingNames.variableTypesSuppressWhenTypeMatchesName, true),\n\t\tincludeInlayPropertyDeclarationTypeHints: config.get<boolean>(InlayHintSettingNames.propertyDeclarationTypesEnabled, false),\n\t\tincludeInlayFunctionLikeReturnTypeHints: config.get<boolean>(InlayHintSettingNames.functionLikeReturnTypesEnabled, false),\n\t\tincludeInlayEnumMemberValueHints: config.get<boolean>(InlayHintSettingNames.enumMemberValuesEnabled, false),\n\t} as const;\n}\n\nfunction getInlayParameterNameHintsPreference(config: vscode.WorkspaceConfiguration) {\n\tswitch (config.get<string>('inlayHints.parameterNames.enabled')) {\n\t\tcase 'none': return 'none';\n\t\tcase 'literals': return 'literals';\n\t\tcase 'all': return 'all';\n\t\tdefault: return undefined;\n\t}\n}\n\nfunction getImportModuleSpecifierPreference(config: vscode.WorkspaceConfiguration) {\n\tswitch (config.get<string>('importModuleSpecifier')) {\n\t\tcase 'project-relative': return 'project-relative';\n\t\tcase 'relative': return 'relative';\n\t\tcase 'non-relative': return 'non-relative';\n\t\tdefault: return undefined;\n\t}\n}\n\nfunction getImportModuleSpecifierEndingPreference(config: vscode.WorkspaceConfiguration) {\n\tswitch (config.get<string>('importModuleSpecifierEnding')) {\n\t\tcase 'minimal': return 'minimal';\n\t\tcase 'index': return 'index';\n\t\tcase 'js': return 'js';\n\t\tdefault: return 'auto';\n\t}\n}\n\nfunction getJsxAttributeCompletionStyle(config: vscode.WorkspaceConfiguration) {\n\tswitch (config.get<string>('jsxAttributeCompletionStyle')) {\n\t\tcase 'braces': return 'braces';\n\t\tcase 'none': return 'none';\n\t\tdefault: return 'auto';\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { Command, CommandManager } from '../commands/commandManager';\nimport { isSupportedLanguageMode } from '../configuration/languageIds';\nimport { API } from '../tsServer/api';\nimport * as typeConverters from '../typeConverters';\nimport { ITypeScriptServiceClient } from '../typescriptService';\n\n\nclass FileReferencesCommand implements Command {\n\n\tpublic static readonly context = 'tsSupportsFileReferences';\n\tpublic static readonly minVersion = API.v420;\n\n\tpublic readonly id = 'typescript.findAllFileReferences';\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient\n\t) { }\n\n\tpublic async execute(resource?: vscode.Uri) {\n\t\tif (this.client.apiVersion.lt(FileReferencesCommand.minVersion)) {\n\t\t\tvscode.window.showErrorMessage(vscode.l10n.t(\"Find file references failed. Requires TypeScript 4.2+.\"));\n\t\t\treturn;\n\t\t}\n\n\t\tresource ??= vscode.window.activeTextEditor?.document.uri;\n\t\tif (!resource) {\n\t\t\tvscode.window.showErrorMessage(vscode.l10n.t(\"Find file references failed. No resource provided.\"));\n\t\t\treturn;\n\t\t}\n\n\t\tconst document = await vscode.workspace.openTextDocument(resource);\n\t\tif (!isSupportedLanguageMode(document)) {\n\t\t\tvscode.window.showErrorMessage(vscode.l10n.t(\"Find file references failed. Unsupported file type.\"));\n\t\t\treturn;\n\t\t}\n\n\t\tconst openedFiledPath = this.client.toOpenTsFilePath(document);\n\t\tif (!openedFiledPath) {\n\t\t\tvscode.window.showErrorMessage(vscode.l10n.t(\"Find file references failed. Unknown file type.\"));\n\t\t\treturn;\n\t\t}\n\n\t\tawait vscode.window.withProgress({\n\t\t\tlocation: vscode.ProgressLocation.Window,\n\t\t\ttitle: vscode.l10n.t(\"Finding file references\")\n\t\t}, async (_progress, token) => {\n\n\t\t\tconst response = await this.client.execute('fileReferences', {\n\t\t\t\tfile: openedFiledPath\n\t\t\t}, token);\n\t\t\tif (response.type !== 'response' || !response.body) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst locations: vscode.Location[] = response.body.refs.map(reference =>\n\t\t\t\ttypeConverters.Location.fromTextSpan(this.client.toResource(reference.file), reference));\n\n\t\t\tconst config = vscode.workspace.getConfiguration('references');\n\t\t\tconst existingSetting = config.inspect<string>('preferredLocation');\n\n\t\t\tawait config.update('preferredLocation', 'view');\n\t\t\ttry {\n\t\t\t\tawait vscode.commands.executeCommand('editor.action.showReferences', resource, new vscode.Position(0, 0), locations);\n\t\t\t} finally {\n\t\t\t\tawait config.update('preferredLocation', existingSetting?.workspaceFolderValue ?? existingSetting?.workspaceValue);\n\t\t\t}\n\t\t});\n\t}\n}\n\n\nexport function register(\n\tclient: ITypeScriptServiceClient,\n\tcommandManager: CommandManager\n) {\n\tfunction updateContext() {\n\t\tvscode.commands.executeCommand('setContext', FileReferencesCommand.context, client.apiVersion.gte(FileReferencesCommand.minVersion));\n\t}\n\tupdateContext();\n\n\tcommandManager.register(new FileReferencesCommand(client));\n\treturn client.onTsServerStarted(() => updateContext());\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { DocumentSelector } from '../configuration/documentSelector';\nimport * as errorCodes from '../tsServer/protocol/errorCodes';\nimport * as fixNames from '../tsServer/protocol/fixNames';\nimport type * as Proto from '../tsServer/protocol/protocol';\nimport * as typeConverters from '../typeConverters';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport { DiagnosticsManager } from './diagnostics';\nimport FileConfigurationManager from './fileConfigurationManager';\nimport { conditionalRegistration, requireSomeCapability } from './util/dependentRegistration';\n\n\ninterface AutoFix {\n\treadonly codes: Set<number>;\n\treadonly fixName: string;\n}\n\nasync function buildIndividualFixes(\n\tfixes: readonly AutoFix[],\n\tedit: vscode.WorkspaceEdit,\n\tclient: ITypeScriptServiceClient,\n\tfile: string,\n\tdiagnostics: readonly vscode.Diagnostic[],\n\ttoken: vscode.CancellationToken,\n): Promise<void> {\n\tfor (const diagnostic of diagnostics) {\n\t\tfor (const { codes, fixName } of fixes) {\n\t\t\tif (token.isCancellationRequested) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!codes.has(diagnostic.code as number)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst args: Proto.CodeFixRequestArgs = {\n\t\t\t\t...typeConverters.Range.toFileRangeRequestArgs(file, diagnostic.range),\n\t\t\t\terrorCodes: [+(diagnostic.code!)]\n\t\t\t};\n\n\t\t\tconst response = await client.execute('getCodeFixes', args, token);\n\t\t\tif (response.type !== 'response') {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst fix = response.body?.find(fix => fix.fixName === fixName);\n\t\t\tif (fix) {\n\t\t\t\ttypeConverters.WorkspaceEdit.withFileCodeEdits(edit, client, fix.changes);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\n\nasync function buildCombinedFix(\n\tfixes: readonly AutoFix[],\n\tedit: vscode.WorkspaceEdit,\n\tclient: ITypeScriptServiceClient,\n\tfile: string,\n\tdiagnostics: readonly vscode.Diagnostic[],\n\ttoken: vscode.CancellationToken,\n): Promise<void> {\n\tfor (const diagnostic of diagnostics) {\n\t\tfor (const { codes, fixName } of fixes) {\n\t\t\tif (token.isCancellationRequested) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!codes.has(diagnostic.code as number)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst args: Proto.CodeFixRequestArgs = {\n\t\t\t\t...typeConverters.Range.toFileRangeRequestArgs(file, diagnostic.range),\n\t\t\t\terrorCodes: [+(diagnostic.code!)]\n\t\t\t};\n\n\t\t\tconst response = await client.execute('getCodeFixes', args, token);\n\t\t\tif (response.type !== 'response' || !response.body?.length) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst fix = response.body?.find(fix => fix.fixName === fixName);\n\t\t\tif (!fix) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (!fix.fixId) {\n\t\t\t\ttypeConverters.WorkspaceEdit.withFileCodeEdits(edit, client, fix.changes);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst combinedArgs: Proto.GetCombinedCodeFixRequestArgs = {\n\t\t\t\tscope: {\n\t\t\t\t\ttype: 'file',\n\t\t\t\t\targs: { file }\n\t\t\t\t},\n\t\t\t\tfixId: fix.fixId,\n\t\t\t};\n\n\t\t\tconst combinedResponse = await client.execute('getCombinedCodeFix', combinedArgs, token);\n\t\t\tif (combinedResponse.type !== 'response' || !combinedResponse.body) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttypeConverters.WorkspaceEdit.withFileCodeEdits(edit, client, combinedResponse.body.changes);\n\t\t\treturn;\n\t\t}\n\t}\n}\n\n// #region Source Actions\n\nabstract class SourceAction extends vscode.CodeAction {\n\tabstract build(\n\t\tclient: ITypeScriptServiceClient,\n\t\tfile: string,\n\t\tdiagnostics: readonly vscode.Diagnostic[],\n\t\ttoken: vscode.CancellationToken,\n\t): Promise<void>;\n}\n\nclass SourceFixAll extends SourceAction {\n\n\tstatic readonly kind = vscode.CodeActionKind.SourceFixAll.append('ts');\n\n\tconstructor() {\n\t\tsuper(vscode.l10n.t(\"Fix all fixable JS/TS issues\"), SourceFixAll.kind);\n\t}\n\n\tasync build(client: ITypeScriptServiceClient, file: string, diagnostics: readonly vscode.Diagnostic[], token: vscode.CancellationToken): Promise<void> {\n\t\tthis.edit = new vscode.WorkspaceEdit();\n\n\t\tawait buildIndividualFixes([\n\t\t\t{ codes: errorCodes.incorrectlyImplementsInterface, fixName: fixNames.classIncorrectlyImplementsInterface },\n\t\t\t{ codes: errorCodes.asyncOnlyAllowedInAsyncFunctions, fixName: fixNames.awaitInSyncFunction },\n\t\t], this.edit, client, file, diagnostics, token);\n\n\t\tawait buildCombinedFix([\n\t\t\t{ codes: errorCodes.unreachableCode, fixName: fixNames.unreachableCode }\n\t\t], this.edit, client, file, diagnostics, token);\n\t}\n}\n\nclass SourceRemoveUnused extends SourceAction {\n\n\tstatic readonly kind = vscode.CodeActionKind.Source.append('removeUnused').append('ts');\n\n\tconstructor() {\n\t\tsuper(vscode.l10n.t(\"Remove all unused code\"), SourceRemoveUnused.kind);\n\t}\n\n\tasync build(client: ITypeScriptServiceClient, file: string, diagnostics: readonly vscode.Diagnostic[], token: vscode.CancellationToken): Promise<void> {\n\t\tthis.edit = new vscode.WorkspaceEdit();\n\t\tawait buildCombinedFix([\n\t\t\t{ codes: errorCodes.variableDeclaredButNeverUsed, fixName: fixNames.unusedIdentifier },\n\t\t], this.edit, client, file, diagnostics, token);\n\t}\n}\n\nclass SourceAddMissingImports extends SourceAction {\n\n\tstatic readonly kind = vscode.CodeActionKind.Source.append('addMissingImports').append('ts');\n\n\tconstructor() {\n\t\tsuper(vscode.l10n.t(\"Add all missing imports\"), SourceAddMissingImports.kind);\n\t}\n\n\tasync build(client: ITypeScriptServiceClient, file: string, diagnostics: readonly vscode.Diagnostic[], token: vscode.CancellationToken): Promise<void> {\n\t\tthis.edit = new vscode.WorkspaceEdit();\n\t\tawait buildCombinedFix([\n\t\t\t{ codes: errorCodes.cannotFindName, fixName: fixNames.fixImport }\n\t\t],\n\t\t\tthis.edit, client, file, diagnostics, token);\n\t}\n}\n\n//#endregion\n\nclass TypeScriptAutoFixProvider implements vscode.CodeActionProvider {\n\n\tprivate static readonly kindProviders = [\n\t\tSourceFixAll,\n\t\tSourceRemoveUnused,\n\t\tSourceAddMissingImports,\n\t];\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly fileConfigurationManager: FileConfigurationManager,\n\t\tprivate readonly diagnosticsManager: DiagnosticsManager,\n\t) { }\n\n\tpublic get metadata(): vscode.CodeActionProviderMetadata {\n\t\treturn {\n\t\t\tprovidedCodeActionKinds: TypeScriptAutoFixProvider.kindProviders.map(x => x.kind),\n\t\t};\n\t}\n\n\tpublic async provideCodeActions(\n\t\tdocument: vscode.TextDocument,\n\t\t_range: vscode.Range,\n\t\tcontext: vscode.CodeActionContext,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.CodeAction[] | undefined> {\n\t\tif (!context.only || !vscode.CodeActionKind.Source.intersects(context.only)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst file = this.client.toOpenTsFilePath(document);\n\t\tif (!file) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst actions = this.getFixAllActions(context.only);\n\t\tconst diagnostics = this.diagnosticsManager.getDiagnostics(document.uri);\n\t\tif (!diagnostics.length) {\n\t\t\t// Actions are a no-op in this case but we still want to return them\n\t\t\treturn actions;\n\t\t}\n\n\t\tawait this.fileConfigurationManager.ensureConfigurationForDocument(document, token);\n\n\t\tif (token.isCancellationRequested) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tawait Promise.all(actions.map(action => action.build(this.client, file, diagnostics, token)));\n\n\t\treturn actions;\n\t}\n\n\tprivate getFixAllActions(only: vscode.CodeActionKind): SourceAction[] {\n\t\treturn TypeScriptAutoFixProvider.kindProviders\n\t\t\t.filter(provider => only.intersects(provider.kind))\n\t\t\t.map(provider => new provider());\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n\tfileConfigurationManager: FileConfigurationManager,\n\tdiagnosticsManager: DiagnosticsManager,\n) {\n\treturn conditionalRegistration([\n\t\trequireSomeCapability(client, ClientCapability.Semantic),\n\t], () => {\n\t\tconst provider = new TypeScriptAutoFixProvider(client, fileConfigurationManager, diagnosticsManager);\n\t\treturn vscode.languages.registerCodeActionsProvider(selector.semantic, provider, provider.metadata);\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { DocumentSelector } from '../configuration/documentSelector';\nimport type * as Proto from '../tsServer/protocol/protocol';\nimport * as typeConverters from '../typeConverters';\nimport { ITypeScriptServiceClient } from '../typescriptService';\nimport { coalesce } from '../utils/arrays';\n\nclass TypeScriptFoldingProvider implements vscode.FoldingRangeProvider {\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient\n\t) { }\n\n\tasync provideFoldingRanges(\n\t\tdocument: vscode.TextDocument,\n\t\t_context: vscode.FoldingContext,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.FoldingRange[] | undefined> {\n\t\tconst file = this.client.toOpenTsFilePath(document);\n\t\tif (!file) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst args: Proto.FileRequestArgs = { file };\n\t\tconst response = await this.client.execute('getOutliningSpans', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn coalesce(response.body.map(span => this.convertOutliningSpan(span, document)));\n\t}\n\n\tprivate convertOutliningSpan(\n\t\tspan: Proto.OutliningSpan,\n\t\tdocument: vscode.TextDocument\n\t): vscode.FoldingRange | undefined {\n\t\tconst range = typeConverters.Range.fromTextSpan(span.textSpan);\n\t\tconst kind = TypeScriptFoldingProvider.getFoldingRangeKind(span);\n\n\t\t// Workaround for #49904\n\t\tif (span.kind === 'comment') {\n\t\t\tconst line = document.lineAt(range.start.line).text;\n\t\t\tif (/\\/\\/\\s*#endregion/gi.test(line)) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}\n\n\t\tconst start = range.start.line;\n\t\tconst end = this.adjustFoldingEnd(range, document);\n\t\treturn new vscode.FoldingRange(start, end, kind);\n\t}\n\n\tprivate static readonly foldEndPairCharacters = ['}', ']', ')', '`', '>'];\n\n\tprivate adjustFoldingEnd(range: vscode.Range, document: vscode.TextDocument) {\n\t\t// workaround for #47240\n\t\tif (range.end.character > 0) {\n\t\t\tconst foldEndCharacter = document.getText(new vscode.Range(range.end.translate(0, -1), range.end));\n\t\t\tif (TypeScriptFoldingProvider.foldEndPairCharacters.includes(foldEndCharacter)) {\n\t\t\t\treturn Math.max(range.end.line - 1, range.start.line);\n\t\t\t}\n\t\t}\n\n\t\treturn range.end.line;\n\t}\n\n\tprivate static getFoldingRangeKind(span: Proto.OutliningSpan): vscode.FoldingRangeKind | undefined {\n\t\tswitch (span.kind) {\n\t\t\tcase 'comment': return vscode.FoldingRangeKind.Comment;\n\t\t\tcase 'region': return vscode.FoldingRangeKind.Region;\n\t\t\tcase 'imports': return vscode.FoldingRangeKind.Imports;\n\t\t\tcase 'code':\n\t\t\tdefault: return undefined;\n\t\t}\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n): vscode.Disposable {\n\treturn vscode.languages.registerFoldingRangeProvider(selector.syntax,\n\t\tnew TypeScriptFoldingProvider(client));\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { DocumentSelector } from '../configuration/documentSelector';\nimport { LanguageDescription } from '../configuration/languageDescription';\nimport type * as Proto from '../tsServer/protocol/protocol';\nimport * as typeConverters from '../typeConverters';\nimport { ITypeScriptServiceClient } from '../typescriptService';\nimport FileConfigurationManager from './fileConfigurationManager';\nimport { conditionalRegistration, requireGlobalConfiguration } from './util/dependentRegistration';\n\nclass TypeScriptFormattingProvider implements vscode.DocumentRangeFormattingEditProvider, vscode.OnTypeFormattingEditProvider {\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly fileConfigurationManager: FileConfigurationManager\n\t) { }\n\n\tpublic async provideDocumentRangeFormattingEdits(\n\t\tdocument: vscode.TextDocument,\n\t\trange: vscode.Range,\n\t\toptions: vscode.FormattingOptions,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.TextEdit[] | undefined> {\n\t\tconst file = this.client.toOpenTsFilePath(document);\n\t\tif (!file) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tawait this.fileConfigurationManager.ensureConfigurationOptions(document, options, token);\n\n\t\tconst args = typeConverters.Range.toFormattingRequestArgs(file, range);\n\t\tconst response = await this.client.execute('format', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn response.body.map(typeConverters.TextEdit.fromCodeEdit);\n\t}\n\n\tpublic async provideOnTypeFormattingEdits(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\tch: string,\n\t\toptions: vscode.FormattingOptions,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.TextEdit[]> {\n\t\tconst file = this.client.toOpenTsFilePath(document);\n\t\tif (!file) {\n\t\t\treturn [];\n\t\t}\n\n\t\tawait this.fileConfigurationManager.ensureConfigurationOptions(document, options, token);\n\n\t\tconst args: Proto.FormatOnKeyRequestArgs = {\n\t\t\t...typeConverters.Position.toFileLocationRequestArgs(file, position),\n\t\t\tkey: ch\n\t\t};\n\t\tconst response = await this.client.execute('formatonkey', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst result: vscode.TextEdit[] = [];\n\t\tfor (const edit of response.body) {\n\t\t\tconst textEdit = typeConverters.TextEdit.fromCodeEdit(edit);\n\t\t\tconst range = textEdit.range;\n\t\t\t// Work around for https://github.com/microsoft/TypeScript/issues/6700.\n\t\t\t// Check if we have an edit at the beginning of the line which only removes white spaces and leaves\n\t\t\t// an empty line. Drop those edits\n\t\t\tif (range.start.character === 0 && range.start.line === range.end.line && textEdit.newText === '') {\n\t\t\t\tconst lText = document.lineAt(range.start.line).text;\n\t\t\t\t// If the edit leaves something on the line keep the edit (note that the end character is exclusive).\n\t\t\t\t// Keep it also if it removes something else than whitespace\n\t\t\t\tif (lText.trim().length > 0 || lText.length > range.end.character) {\n\t\t\t\t\tresult.push(textEdit);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresult.push(textEdit);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tlanguage: LanguageDescription,\n\tclient: ITypeScriptServiceClient,\n\tfileConfigurationManager: FileConfigurationManager\n) {\n\treturn conditionalRegistration([\n\t\trequireGlobalConfiguration(language.id, 'format.enable'),\n\t], () => {\n\t\tconst formattingProvider = new TypeScriptFormattingProvider(client, fileConfigurationManager);\n\t\treturn vscode.Disposable.from(\n\t\t\tvscode.languages.registerOnTypeFormattingEditProvider(selector.syntax, formattingProvider, ';', '}', '\\n'),\n\t\t\tvscode.languages.registerDocumentRangeFormattingEditProvider(selector.syntax, formattingProvider),\n\t\t);\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport type * as Proto from '../tsServer/protocol/protocol';\nimport { ClientCapability, ITypeScriptServiceClient, ServerType } from '../typescriptService';\nimport { conditionalRegistration, requireSomeCapability } from './util/dependentRegistration';\nimport { DocumentSelector } from '../configuration/documentSelector';\nimport { documentationToMarkdown } from './util/textRendering';\nimport * as typeConverters from '../typeConverters';\nimport FileConfigurationManager from './fileConfigurationManager';\n\n\n\nclass TypeScriptHoverProvider implements vscode.HoverProvider {\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly fileConfigurationManager: FileConfigurationManager,\n\t) { }\n\n\tpublic async provideHover(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.Hover | undefined> {\n\t\tconst filepath = this.client.toOpenTsFilePath(document);\n\t\tif (!filepath) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst response = await this.client.interruptGetErr(async () => {\n\t\t\tawait this.fileConfigurationManager.ensureConfigurationForDocument(document, token);\n\n\t\t\tconst args = typeConverters.Position.toFileLocationRequestArgs(filepath, position);\n\t\t\treturn this.client.execute('quickinfo', args, token);\n\t\t});\n\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn new vscode.Hover(\n\t\t\tthis.getContents(document.uri, response.body, response._serverType),\n\t\t\ttypeConverters.Range.fromTextSpan(response.body));\n\t}\n\n\tprivate getContents(\n\t\tresource: vscode.Uri,\n\t\tdata: Proto.QuickInfoResponseBody,\n\t\tsource: ServerType | undefined,\n\t) {\n\t\tconst parts: vscode.MarkdownString[] = [];\n\n\t\tif (data.displayString) {\n\t\t\tconst displayParts: string[] = [];\n\n\t\t\tif (source === ServerType.Syntax && this.client.hasCapabilityForResource(resource, ClientCapability.Semantic)) {\n\t\t\t\tdisplayParts.push(\n\t\t\t\t\tvscode.l10n.t({\n\t\t\t\t\t\tmessage: \"(loading...)\",\n\t\t\t\t\t\tcomment: ['Prefix displayed for hover entries while the server is still loading']\n\t\t\t\t\t}));\n\t\t\t}\n\n\t\t\tdisplayParts.push(data.displayString);\n\t\t\tparts.push(new vscode.MarkdownString().appendCodeblock(displayParts.join(' '), 'typescript'));\n\t\t}\n\t\tconst md = documentationToMarkdown(data.documentation, data.tags, this.client, resource);\n\t\tparts.push(md);\n\t\treturn parts;\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n\tfileConfigurationManager: FileConfigurationManager,\n): vscode.Disposable {\n\treturn conditionalRegistration([\n\t\trequireSomeCapability(client, ClientCapability.EnhancedSyntax, ClientCapability.Semantic),\n\t], () => {\n\t\treturn vscode.languages.registerHoverProvider(selector.syntax,\n\t\t\tnew TypeScriptHoverProvider(client, fileConfigurationManager));\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { DocumentSelector } from '../configuration/documentSelector';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport DefinitionProviderBase from './definitionProviderBase';\nimport { conditionalRegistration, requireSomeCapability } from './util/dependentRegistration';\n\nclass TypeScriptImplementationProvider extends DefinitionProviderBase implements vscode.ImplementationProvider {\n\tpublic provideImplementation(document: vscode.TextDocument, position: vscode.Position, token: vscode.CancellationToken): Promise<vscode.Definition | undefined> {\n\t\treturn this.getSymbolLocations('implementation', document, position, token);\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n) {\n\treturn conditionalRegistration([\n\t\trequireSomeCapability(client, ClientCapability.Semantic),\n\t], () => {\n\t\treturn vscode.languages.registerImplementationProvider(selector.semantic,\n\t\t\tnew TypeScriptImplementationProvider(client));\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { DocumentSelector } from '../configuration/documentSelector';\nimport { LanguageDescription } from '../configuration/languageDescription';\nimport { TelemetryReporter } from '../logging/telemetry';\nimport { API } from '../tsServer/api';\nimport type * as Proto from '../tsServer/protocol/protocol';\nimport { Location, Position } from '../typeConverters';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport { Disposable } from '../utils/dispose';\nimport FileConfigurationManager, { InlayHintSettingNames, getInlayHintsPreferences } from './fileConfigurationManager';\nimport { conditionalRegistration, requireMinVersion, requireSomeCapability } from './util/dependentRegistration';\n\n\nconst inlayHintSettingNames = Object.freeze([\n\tInlayHintSettingNames.parameterNamesSuppressWhenArgumentMatchesName,\n\tInlayHintSettingNames.parameterNamesEnabled,\n\tInlayHintSettingNames.variableTypesEnabled,\n\tInlayHintSettingNames.variableTypesSuppressWhenTypeMatchesName,\n\tInlayHintSettingNames.propertyDeclarationTypesEnabled,\n\tInlayHintSettingNames.functionLikeReturnTypesEnabled,\n\tInlayHintSettingNames.enumMemberValuesEnabled,\n]);\n\nclass TypeScriptInlayHintsProvider extends Disposable implements vscode.InlayHintsProvider {\n\n\tpublic static readonly minVersion = API.v440;\n\n\tprivate readonly _onDidChangeInlayHints = this._register(new vscode.EventEmitter<void>());\n\tpublic readonly onDidChangeInlayHints = this._onDidChangeInlayHints.event;\n\n\tprivate hasReportedTelemetry = false;\n\n\tconstructor(\n\t\tprivate readonly language: LanguageDescription,\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly fileConfigurationManager: FileConfigurationManager,\n\t\tprivate readonly telemetryReporter: TelemetryReporter,\n\t) {\n\t\tsuper();\n\n\t\tthis._register(vscode.workspace.onDidChangeConfiguration(e => {\n\t\t\tif (inlayHintSettingNames.some(settingName => e.affectsConfiguration(language.id + '.' + settingName))) {\n\t\t\t\tthis._onDidChangeInlayHints.fire();\n\t\t\t}\n\t\t}));\n\n\t\t// When a JS/TS file changes, change inlay hints for all visible editors\n\t\t// since changes in one file can effect the hints the others.\n\t\tthis._register(vscode.workspace.onDidChangeTextDocument(e => {\n\t\t\tif (language.languageIds.includes(e.document.languageId)) {\n\t\t\t\tthis._onDidChangeInlayHints.fire();\n\t\t\t}\n\t\t}));\n\t}\n\n\tasync provideInlayHints(model: vscode.TextDocument, range: vscode.Range, token: vscode.CancellationToken): Promise<vscode.InlayHint[] | undefined> {\n\t\tconst filepath = this.client.toOpenTsFilePath(model);\n\t\tif (!filepath) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!areInlayHintsEnabledForFile(this.language, model)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst start = model.offsetAt(range.start);\n\t\tconst length = model.offsetAt(range.end) - start;\n\n\t\tawait this.fileConfigurationManager.ensureConfigurationForDocument(model, token);\n\t\tif (token.isCancellationRequested) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.hasReportedTelemetry) {\n\t\t\tthis.hasReportedTelemetry = true;\n\t\t\t/* __GDPR__\n\t\t\t\t\"inlayHints.provide\" : {\n\t\t\t\t\t\"owner\": \"mjbvz\",\n\t\t\t\t\t\"${include}\": [\n\t\t\t\t\t\t\"${TypeScriptCommonProperties}\"\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t*/\n\t\t\tthis.telemetryReporter.logTelemetry('inlayHints.provide', {});\n\t\t}\n\n\t\tconst response = await this.client.execute('provideInlayHints', { file: filepath, start, length }, token);\n\t\tif (response.type !== 'response' || !response.success || !response.body) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn response.body.map(hint => {\n\t\t\tconst result = new vscode.InlayHint(\n\t\t\t\tPosition.fromLocation(hint.position),\n\t\t\t\tthis.convertInlayHintText(hint),\n\t\t\t\tfromProtocolInlayHintKind(hint.kind)\n\t\t\t);\n\t\t\tresult.paddingLeft = hint.whitespaceBefore;\n\t\t\tresult.paddingRight = hint.whitespaceAfter;\n\t\t\treturn result;\n\t\t});\n\t}\n\n\tprivate convertInlayHintText(tsHint: Proto.InlayHintItem): string | vscode.InlayHintLabelPart[] {\n\t\tif (tsHint.displayParts) {\n\t\t\treturn tsHint.displayParts.map((part): vscode.InlayHintLabelPart => {\n\t\t\t\tconst out = new vscode.InlayHintLabelPart(part.text);\n\t\t\t\tif (part.span) {\n\t\t\t\t\tout.location = Location.fromTextSpan(this.client.toResource(part.span.file), part.span);\n\t\t\t\t}\n\t\t\t\treturn out;\n\t\t\t});\n\t\t}\n\n\t\treturn tsHint.text;\n\t}\n}\n\nfunction fromProtocolInlayHintKind(kind: Proto.InlayHintKind): vscode.InlayHintKind | undefined {\n\tswitch (kind) {\n\t\tcase 'Parameter': return vscode.InlayHintKind.Parameter;\n\t\tcase 'Type': return vscode.InlayHintKind.Type;\n\t\tcase 'Enum': return undefined;\n\t\tdefault: return undefined;\n\t}\n}\n\nfunction areInlayHintsEnabledForFile(language: LanguageDescription, document: vscode.TextDocument) {\n\tconst config = vscode.workspace.getConfiguration(language.id, document);\n\tconst preferences = getInlayHintsPreferences(config);\n\n\treturn preferences.includeInlayParameterNameHints === 'literals' ||\n\t\tpreferences.includeInlayParameterNameHints === 'all' ||\n\t\tpreferences.includeInlayEnumMemberValueHints ||\n\t\tpreferences.includeInlayFunctionLikeReturnTypeHints ||\n\t\tpreferences.includeInlayFunctionParameterTypeHints ||\n\t\tpreferences.includeInlayPropertyDeclarationTypeHints ||\n\t\tpreferences.includeInlayVariableTypeHints;\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tlanguage: LanguageDescription,\n\tclient: ITypeScriptServiceClient,\n\tfileConfigurationManager: FileConfigurationManager,\n\ttelemetryReporter: TelemetryReporter,\n) {\n\treturn conditionalRegistration([\n\t\trequireMinVersion(client, TypeScriptInlayHintsProvider.minVersion),\n\t\trequireSomeCapability(client, ClientCapability.Semantic),\n\t], () => {\n\t\tconst provider = new TypeScriptInlayHintsProvider(language, client, fileConfigurationManager, telemetryReporter);\n\t\treturn vscode.languages.registerInlayHintsProvider(selector.semantic, provider);\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { DocumentSelector } from '../configuration/documentSelector';\nimport { LanguageDescription } from '../configuration/languageDescription';\nimport * as typeConverters from '../typeConverters';\nimport { ITypeScriptServiceClient } from '../typescriptService';\nimport FileConfigurationManager from './fileConfigurationManager';\n\n\n\nconst defaultJsDoc = new vscode.SnippetString(`/**\\n * $0\\n */`);\n\nclass JsDocCompletionItem extends vscode.CompletionItem {\n\tconstructor(\n\t\tpublic readonly document: vscode.TextDocument,\n\t\tpublic readonly position: vscode.Position\n\t) {\n\t\tsuper('/** */', vscode.CompletionItemKind.Text);\n\t\tthis.detail = vscode.l10n.t(\"JSDoc comment\");\n\t\tthis.sortText = '\\0';\n\n\t\tconst line = document.lineAt(position.line).text;\n\t\tconst prefix = line.slice(0, position.character).match(/\\/\\**\\s*$/);\n\t\tconst suffix = line.slice(position.character).match(/^\\s*\\**\\//);\n\t\tconst start = position.translate(0, prefix ? -prefix[0].length : 0);\n\t\tconst range = new vscode.Range(start, position.translate(0, suffix ? suffix[0].length : 0));\n\t\tthis.range = { inserting: range, replacing: range };\n\t}\n}\n\nclass JsDocCompletionProvider implements vscode.CompletionItemProvider {\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly language: LanguageDescription,\n\t\tprivate readonly fileConfigurationManager: FileConfigurationManager,\n\t) { }\n\n\tpublic async provideCompletionItems(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.CompletionItem[] | undefined> {\n\t\tif (!vscode.workspace.getConfiguration(this.language.id, document).get('suggest.completeJSDocs')) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst file = this.client.toOpenTsFilePath(document);\n\t\tif (!file) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (!this.isPotentiallyValidDocCompletionPosition(document, position)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst response = await this.client.interruptGetErr(async () => {\n\t\t\tawait this.fileConfigurationManager.ensureConfigurationForDocument(document, token);\n\n\t\t\tconst args = typeConverters.Position.toFileLocationRequestArgs(file, position);\n\t\t\treturn this.client.execute('docCommentTemplate', args, token);\n\t\t});\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst item = new JsDocCompletionItem(document, position);\n\n\t\t// Workaround for #43619\n\t\t// docCommentTemplate previously returned undefined for empty jsdoc templates.\n\t\t// TS 2.7 now returns a single line doc comment, which breaks indentation.\n\t\tif (response.body.newText === '/** */') {\n\t\t\titem.insertText = defaultJsDoc;\n\t\t} else {\n\t\t\titem.insertText = templateToSnippet(response.body.newText);\n\t\t}\n\n\t\treturn [item];\n\t}\n\n\tprivate isPotentiallyValidDocCompletionPosition(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position\n\t): boolean {\n\t\t// Only show the JSdoc completion when the everything before the cursor is whitespace\n\t\t// or could be the opening of a comment\n\t\tconst line = document.lineAt(position.line).text;\n\t\tconst prefix = line.slice(0, position.character);\n\t\tif (!/^\\s*$|\\/\\*\\*\\s*$|^\\s*\\/\\*\\*+\\s*$/.test(prefix)) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// And everything after is possibly a closing comment or more whitespace\n\t\tconst suffix = line.slice(position.character);\n\t\treturn /^\\s*(\\*+\\/)?\\s*$/.test(suffix);\n\t}\n}\n\nexport function templateToSnippet(template: string): vscode.SnippetString {\n\t// TODO: use append placeholder\n\tlet snippetIndex = 1;\n\ttemplate = template.replace(/\\$/g, '\\\\$'); // CodeQL [SM02383] This is only used for text which is put into the editor. It is not for rendered html\n\ttemplate = template.replace(/^[ \\t]*(?=(\\/|[ ]\\*))/gm, '');\n\ttemplate = template.replace(/^(\\/\\*\\*\\s*\\*[ ]*)$/m, (x) => x + `\\$0`);\n\ttemplate = template.replace(/\\* @param([ ]\\{\\S+\\})?\\s+(\\S+)[ \\t]*$/gm, (_param, type, post) => {\n\t\tlet out = '* @param ';\n\t\tif (type === ' {any}' || type === ' {*}') {\n\t\t\tout += `{\\$\\{${snippetIndex++}:*\\}} `;\n\t\t} else if (type) {\n\t\t\tout += type + ' ';\n\t\t}\n\t\tout += post + ` \\${${snippetIndex++}}`;\n\t\treturn out;\n\t});\n\n\ttemplate = template.replace(/\\* @returns[ \\t]*$/gm, `* @returns \\${${snippetIndex++}}`);\n\n\treturn new vscode.SnippetString(template);\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tlanguage: LanguageDescription,\n\tclient: ITypeScriptServiceClient,\n\tfileConfigurationManager: FileConfigurationManager,\n\n): vscode.Disposable {\n\treturn vscode.languages.registerCompletionItemProvider(selector.syntax,\n\t\tnew JsDocCompletionProvider(client, language, fileConfigurationManager),\n\t\t'*');\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { DocumentSelector } from '../configuration/documentSelector';\nimport { API } from '../tsServer/api';\nimport * as typeConverters from '../typeConverters';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport { conditionalRegistration, requireMinVersion, requireSomeCapability } from './util/dependentRegistration';\n\nclass LinkedEditingSupport implements vscode.LinkedEditingRangeProvider {\n\n\tpublic static readonly minVersion = API.v510;\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient\n\t) { }\n\n\tasync provideLinkedEditingRanges(document: vscode.TextDocument, position: vscode.Position, token: vscode.CancellationToken): Promise<vscode.LinkedEditingRanges | undefined> {\n\t\tconst filepath = this.client.toOpenTsFilePath(document);\n\t\tif (!filepath) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst args = typeConverters.Position.toFileLocationRequestArgs(filepath, position);\n\t\tconst response = await this.client.execute('linkedEditingRange', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst wordPattern = response.body.wordPattern ? new RegExp(response.body.wordPattern) : undefined;\n\t\treturn new vscode.LinkedEditingRanges(response.body.ranges.map(range => typeConverters.Range.fromTextSpan(range)), wordPattern);\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient\n) {\n\treturn conditionalRegistration([\n\t\trequireMinVersion(client, LinkedEditingSupport.minVersion),\n\t\trequireSomeCapability(client, ClientCapability.Syntax),\n\t], () => {\n\t\treturn vscode.languages.registerLinkedEditingRangeProvider(selector.syntax,\n\t\t\tnew LinkedEditingSupport(client));\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { Command, CommandManager } from '../commands/commandManager';\nimport { DocumentSelector } from '../configuration/documentSelector';\nimport { TelemetryReporter } from '../logging/telemetry';\nimport { API } from '../tsServer/api';\nimport type * as Proto from '../tsServer/protocol/protocol';\nimport { OrganizeImportsMode } from '../tsServer/protocol/protocol.const';\nimport * as typeConverters from '../typeConverters';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport { nulToken } from '../utils/cancellation';\nimport FileConfigurationManager from './fileConfigurationManager';\nimport { conditionalRegistration, requireMinVersion, requireSomeCapability } from './util/dependentRegistration';\n\n\ninterface OrganizeImportsCommandMetadata {\n\treadonly commandIds: readonly string[];\n\treadonly title: string;\n\treadonly minVersion?: API;\n\treadonly kind: vscode.CodeActionKind;\n\treadonly mode: OrganizeImportsMode;\n}\n\nconst organizeImportsCommand: OrganizeImportsCommandMetadata = {\n\tcommandIds: [], // We use the generic 'Organize imports' command\n\ttitle: vscode.l10n.t(\"Organize Imports\"),\n\tkind: vscode.CodeActionKind.SourceOrganizeImports,\n\tmode: OrganizeImportsMode.All,\n};\n\nconst sortImportsCommand: OrganizeImportsCommandMetadata = {\n\tcommandIds: ['typescript.sortImports', 'javascript.sortImports'],\n\tminVersion: API.v430,\n\ttitle: vscode.l10n.t(\"Sort Imports\"),\n\tkind: vscode.CodeActionKind.Source.append('sortImports'),\n\tmode: OrganizeImportsMode.SortAndCombine,\n};\n\nconst removeUnusedImportsCommand: OrganizeImportsCommandMetadata = {\n\tcommandIds: ['typescript.removeUnusedImports', 'javascript.removeUnusedImports'],\n\tminVersion: API.v490,\n\ttitle: vscode.l10n.t(\"Remove Unused Imports\"),\n\tkind: vscode.CodeActionKind.Source.append('removeUnusedImports'),\n\tmode: OrganizeImportsMode.RemoveUnused,\n};\n\nclass DidOrganizeImportsCommand implements Command {\n\n\tpublic static readonly ID = '_typescript.didOrganizeImports';\n\tpublic readonly id = DidOrganizeImportsCommand.ID;\n\n\tconstructor(\n\t\tprivate readonly telemetryReporter: TelemetryReporter,\n\t) { }\n\n\tpublic async execute(): Promise<any> {\n\t\t/* __GDPR__\n\t\t\t\"organizeImports.execute\" : {\n\t\t\t\t\"owner\": \"mjbvz\",\n\t\t\t\t\"${include}\": [\n\t\t\t\t\t\"${TypeScriptCommonProperties}\"\n\t\t\t\t]\n\t\t\t}\n\t\t*/\n\t\tthis.telemetryReporter.logTelemetry('organizeImports.execute', {});\n\t}\n}\n\nclass ImportCodeAction extends vscode.CodeAction {\n\tconstructor(\n\t\ttitle: string,\n\t\tkind: vscode.CodeActionKind,\n\t\tpublic readonly document: vscode.TextDocument,\n\t) {\n\t\tsuper(title, kind);\n\t}\n}\n\nclass ImportsCodeActionProvider implements vscode.CodeActionProvider<ImportCodeAction> {\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly commandMetadata: OrganizeImportsCommandMetadata,\n\t\tcommandManager: CommandManager,\n\t\tprivate readonly fileConfigManager: FileConfigurationManager,\n\t\ttelemetryReporter: TelemetryReporter,\n\t) {\n\t\tcommandManager.register(new DidOrganizeImportsCommand(telemetryReporter));\n\t}\n\n\tpublic provideCodeActions(\n\t\tdocument: vscode.TextDocument,\n\t\t_range: vscode.Range,\n\t\tcontext: vscode.CodeActionContext,\n\t\t_token: vscode.CancellationToken\n\t): ImportCodeAction[] {\n\t\tif (!context.only?.contains(this.commandMetadata.kind)) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst file = this.client.toOpenTsFilePath(document);\n\t\tif (!file) {\n\t\t\treturn [];\n\t\t}\n\n\t\treturn [new ImportCodeAction(this.commandMetadata.title, this.commandMetadata.kind, document)];\n\t}\n\n\tasync resolveCodeAction(codeAction: ImportCodeAction, token: vscode.CancellationToken): Promise<ImportCodeAction | undefined> {\n\t\tconst response = await this.client.interruptGetErr(async () => {\n\t\t\tawait this.fileConfigManager.ensureConfigurationForDocument(codeAction.document, token);\n\t\t\tif (token.isCancellationRequested) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst file = this.client.toOpenTsFilePath(codeAction.document);\n\t\t\tif (!file) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst args: Proto.OrganizeImportsRequestArgs = {\n\t\t\t\tscope: {\n\t\t\t\t\ttype: 'file',\n\t\t\t\t\targs: { file }\n\t\t\t\t},\n\t\t\t\t// Deprecated in 4.9; `mode` takes priority\n\t\t\t\tskipDestructiveCodeActions: this.commandMetadata.mode === OrganizeImportsMode.SortAndCombine,\n\t\t\t\tmode: typeConverters.OrganizeImportsMode.toProtocolOrganizeImportsMode(this.commandMetadata.mode),\n\t\t\t};\n\n\t\t\treturn this.client.execute('organizeImports', args, nulToken);\n\t\t});\n\t\tif (response?.type !== 'response' || !response.body || token.isCancellationRequested) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (response.body.length) {\n\t\t\tcodeAction.edit = typeConverters.WorkspaceEdit.fromFileCodeEdits(this.client, response.body);\n\t\t}\n\n\t\tcodeAction.command = { command: DidOrganizeImportsCommand.ID, title: '', arguments: [] };\n\n\t\treturn codeAction;\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n\tcommandManager: CommandManager,\n\tfileConfigurationManager: FileConfigurationManager,\n\ttelemetryReporter: TelemetryReporter,\n): vscode.Disposable {\n\tconst disposables: vscode.Disposable[] = [];\n\n\tfor (const command of [organizeImportsCommand, sortImportsCommand, removeUnusedImportsCommand]) {\n\t\tdisposables.push(\n\t\t\tconditionalRegistration([\n\t\t\t\trequireMinVersion(client, command.minVersion ?? API.defaultVersion),\n\t\t\t\trequireSomeCapability(client, ClientCapability.Semantic),\n\t\t\t], () => {\n\t\t\t\tconst provider = new ImportsCodeActionProvider(client, command, commandManager, fileConfigurationManager, telemetryReporter);\n\t\t\t\treturn vscode.Disposable.from(\n\t\t\t\t\tvscode.languages.registerCodeActionsProvider(selector.semantic, provider, {\n\t\t\t\t\t\tprovidedCodeActionKinds: [command.kind]\n\t\t\t\t\t}));\n\t\t\t}),\n\t\t\t// Always register these commands. We will show a warning if the user tries to run them on an unsupported version\n\t\t\t...command.commandIds.map(id =>\n\t\t\t\tcommandManager.register({\n\t\t\t\t\tid,\n\t\t\t\t\texecute() {\n\t\t\t\t\t\treturn vscode.commands.executeCommand('editor.action.sourceAction', {\n\t\t\t\t\t\t\tkind: command.kind.value,\n\t\t\t\t\t\t\tapply: 'first',\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}))\n\t\t);\n\t}\n\n\treturn vscode.Disposable.from(...disposables);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { Command, CommandManager } from '../commands/commandManager';\nimport { DocumentSelector } from '../configuration/documentSelector';\nimport { TelemetryReporter } from '../logging/telemetry';\nimport * as fixNames from '../tsServer/protocol/fixNames';\nimport type * as Proto from '../tsServer/protocol/protocol';\nimport * as typeConverters from '../typeConverters';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport { nulToken } from '../utils/cancellation';\nimport { memoize } from '../utils/memoize';\nimport { equals } from '../utils/objects';\nimport { DiagnosticsManager } from './diagnostics';\nimport FileConfigurationManager from './fileConfigurationManager';\nimport { applyCodeActionCommands, getEditForCodeAction } from './util/codeAction';\nimport { conditionalRegistration, requireSomeCapability } from './util/dependentRegistration';\nimport { Expand, EditorChatFollowUp_Args, CompositeCommand, EditorChatFollowUp } from './util/copilot';\n\ntype ApplyCodeActionCommand_args = {\n\treadonly document: vscode.TextDocument;\n\treadonly diagnostic: vscode.Diagnostic;\n\treadonly action: Proto.CodeFixAction;\n\treadonly followupAction?: Command;\n};\n\nclass ApplyCodeActionCommand implements Command {\n\tpublic static readonly ID = '_typescript.applyCodeActionCommand';\n\tpublic readonly id = ApplyCodeActionCommand.ID;\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly diagnosticManager: DiagnosticsManager,\n\t\tprivate readonly telemetryReporter: TelemetryReporter,\n\t) { }\n\n\tpublic async execute({ document, action, diagnostic, followupAction }: ApplyCodeActionCommand_args): Promise<boolean> {\n\t\t/* __GDPR__\n\t\t\t\"quickFix.execute\" : {\n\t\t\t\t\"owner\": \"mjbvz\",\n\t\t\t\t\"fixName\" : { \"classification\": \"PublicNonPersonalData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"${include}\": [\n\t\t\t\t\t\"${TypeScriptCommonProperties}\"\n\t\t\t\t]\n\t\t\t}\n\t\t*/\n\t\tthis.telemetryReporter.logTelemetry('quickFix.execute', {\n\t\t\tfixName: action.fixName\n\t\t});\n\n\t\tthis.diagnosticManager.deleteDiagnostic(document.uri, diagnostic);\n\t\tconst codeActionResult = await applyCodeActionCommands(this.client, action.commands, nulToken);\n\t\tawait followupAction?.execute();\n\t\treturn codeActionResult;\n\t}\n}\n\ntype ApplyFixAllCodeAction_args = {\n\treadonly action: VsCodeFixAllCodeAction;\n};\n\nclass ApplyFixAllCodeAction implements Command {\n\tpublic static readonly ID = '_typescript.applyFixAllCodeAction';\n\tpublic readonly id = ApplyFixAllCodeAction.ID;\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly telemetryReporter: TelemetryReporter,\n\t) { }\n\n\tpublic async execute(args: ApplyFixAllCodeAction_args): Promise<void> {\n\t\t/* __GDPR__\n\t\t\t\"quickFixAll.execute\" : {\n\t\t\t\t\"owner\": \"mjbvz\",\n\t\t\t\t\"fixName\" : { \"classification\": \"PublicNonPersonalData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"${include}\": [\n\t\t\t\t\t\"${TypeScriptCommonProperties}\"\n\t\t\t\t]\n\t\t\t}\n\t\t*/\n\t\tthis.telemetryReporter.logTelemetry('quickFixAll.execute', {\n\t\t\tfixName: args.action.tsAction.fixName\n\t\t});\n\n\t\tif (args.action.combinedResponse) {\n\t\t\tawait applyCodeActionCommands(this.client, args.action.combinedResponse.body.commands, nulToken);\n\t\t}\n\t}\n}\n\n/**\n * Unique set of diagnostics keyed on diagnostic range and error code.\n */\nclass DiagnosticsSet {\n\tpublic static from(diagnostics: vscode.Diagnostic[]) {\n\t\tconst values = new Map<string, vscode.Diagnostic>();\n\t\tfor (const diagnostic of diagnostics) {\n\t\t\tvalues.set(DiagnosticsSet.key(diagnostic), diagnostic);\n\t\t}\n\t\treturn new DiagnosticsSet(values);\n\t}\n\n\tprivate static key(diagnostic: vscode.Diagnostic) {\n\t\tconst { start, end } = diagnostic.range;\n\t\treturn `${diagnostic.code}-${start.line},${start.character}-${end.line},${end.character}`;\n\t}\n\n\tprivate constructor(\n\t\tprivate readonly _values: Map<string, vscode.Diagnostic>\n\t) { }\n\n\tpublic get values(): Iterable<vscode.Diagnostic> {\n\t\treturn this._values.values();\n\t}\n\n\tpublic get size() {\n\t\treturn this._values.size;\n\t}\n}\n\nclass VsCodeCodeAction extends vscode.CodeAction {\n\tconstructor(\n\t\tpublic readonly tsAction: Proto.CodeFixAction,\n\t\ttitle: string,\n\t\tkind: vscode.CodeActionKind\n\t) {\n\t\tsuper(title, kind);\n\t}\n}\n\nclass VsCodeFixAllCodeAction extends VsCodeCodeAction {\n\tconstructor(\n\t\ttsAction: Proto.CodeFixAction,\n\t\tpublic readonly file: string,\n\t\ttitle: string,\n\t\tkind: vscode.CodeActionKind\n\t) {\n\t\tsuper(tsAction, title, kind);\n\t}\n\n\tpublic combinedResponse?: Proto.GetCombinedCodeFixResponse;\n}\n\nclass CodeActionSet {\n\tprivate readonly _actions = new Set<VsCodeCodeAction>();\n\tprivate readonly _fixAllActions = new Map<{}, VsCodeCodeAction>();\n\tprivate readonly _aiActions = new Set<VsCodeCodeAction>();\n\n\tpublic *values(): Iterable<VsCodeCodeAction> {\n\t\tyield* this._actions;\n\t\tyield* this._aiActions;\n\t}\n\n\tpublic addAction(action: VsCodeCodeAction) {\n\t\tif (action.isAI) {\n\t\t\t// there are no separate fixAllActions for AI, and no duplicates, so return immediately\n\t\t\tthis._aiActions.add(action);\n\t\t\treturn;\n\t\t}\n\t\tfor (const existing of this._actions) {\n\t\t\tif (action.tsAction.fixName === existing.tsAction.fixName && equals(action.edit, existing.edit)) {\n\t\t\t\tthis._actions.delete(existing);\n\t\t\t}\n\t\t}\n\n\t\tthis._actions.add(action);\n\n\t\tif (action.tsAction.fixId) {\n\t\t\t// If we have an existing fix all action, then make sure it follows this action\n\t\t\tconst existingFixAll = this._fixAllActions.get(action.tsAction.fixId);\n\t\t\tif (existingFixAll) {\n\t\t\t\tthis._actions.delete(existingFixAll);\n\t\t\t\tthis._actions.add(existingFixAll);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic addFixAllAction(fixId: {}, action: VsCodeCodeAction) {\n\t\tconst existing = this._fixAllActions.get(fixId);\n\t\tif (existing) {\n\t\t\t// reinsert action at back of actions list\n\t\t\tthis._actions.delete(existing);\n\t\t}\n\t\tthis.addAction(action);\n\t\tthis._fixAllActions.set(fixId, action);\n\t}\n\n\tpublic hasFixAllAction(fixId: {}) {\n\t\treturn this._fixAllActions.has(fixId);\n\t}\n}\n\nclass SupportedCodeActionProvider {\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient\n\t) { }\n\n\tpublic async getFixableDiagnosticsForContext(diagnostics: readonly vscode.Diagnostic[]): Promise<DiagnosticsSet> {\n\t\tconst fixableCodes = await this.fixableDiagnosticCodes;\n\t\treturn DiagnosticsSet.from(\n\t\t\tdiagnostics.filter(diagnostic => typeof diagnostic.code !== 'undefined' && fixableCodes.has(diagnostic.code + '')));\n\t}\n\n\t@memoize\n\tprivate get fixableDiagnosticCodes(): Thenable<Set<string>> {\n\t\treturn this.client.execute('getSupportedCodeFixes', null, nulToken)\n\t\t\t.then(response => response.type === 'response' ? response.body || [] : [])\n\t\t\t.then(codes => new Set(codes));\n\t}\n}\n\nclass TypeScriptQuickFixProvider implements vscode.CodeActionProvider<VsCodeCodeAction> {\n\n\tprivate static readonly _maxCodeActionsPerFile: number = 1000;\n\n\tpublic static readonly metadata: vscode.CodeActionProviderMetadata = {\n\t\tprovidedCodeActionKinds: [vscode.CodeActionKind.QuickFix]\n\t};\n\n\tprivate readonly supportedCodeActionProvider: SupportedCodeActionProvider;\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly formattingConfigurationManager: FileConfigurationManager,\n\t\tcommandManager: CommandManager,\n\t\tprivate readonly diagnosticsManager: DiagnosticsManager,\n\t\ttelemetryReporter: TelemetryReporter\n\t) {\n\t\tcommandManager.register(new CompositeCommand());\n\t\tcommandManager.register(new ApplyCodeActionCommand(client, diagnosticsManager, telemetryReporter));\n\t\tcommandManager.register(new ApplyFixAllCodeAction(client, telemetryReporter));\n\t\tcommandManager.register(new EditorChatFollowUp(client, telemetryReporter));\n\n\t\tthis.supportedCodeActionProvider = new SupportedCodeActionProvider(client);\n\t}\n\n\tpublic async provideCodeActions(\n\t\tdocument: vscode.TextDocument,\n\t\trange: vscode.Range,\n\t\tcontext: vscode.CodeActionContext,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<VsCodeCodeAction[] | undefined> {\n\t\tconst file = this.client.toOpenTsFilePath(document);\n\t\tif (!file) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet diagnostics = context.diagnostics;\n\t\tif (this.client.bufferSyncSupport.hasPendingDiagnostics(document.uri)) {\n\t\t\t// Delay for 500ms when there are pending diagnostics before recomputing up-to-date diagnostics.\n\t\t\tawait new Promise((resolve) => {\n\t\t\t\tsetTimeout(resolve, 500);\n\t\t\t});\n\n\t\t\tif (token.isCancellationRequested) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst allDiagnostics: vscode.Diagnostic[] = [];\n\n\t\t\t// Match ranges again after getting new diagnostics\n\t\t\tfor (const diagnostic of this.diagnosticsManager.getDiagnostics(document.uri)) {\n\t\t\t\tif (range.intersection(diagnostic.range)) {\n\t\t\t\t\tconst newLen = allDiagnostics.push(diagnostic);\n\t\t\t\t\tif (newLen > TypeScriptQuickFixProvider._maxCodeActionsPerFile) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tdiagnostics = allDiagnostics;\n\t\t}\n\n\t\tconst fixableDiagnostics = await this.supportedCodeActionProvider.getFixableDiagnosticsForContext(diagnostics);\n\t\tif (!fixableDiagnostics.size || token.isCancellationRequested) {\n\t\t\treturn;\n\t\t}\n\n\t\tawait this.formattingConfigurationManager.ensureConfigurationForDocument(document, token);\n\t\tif (token.isCancellationRequested) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst results = new CodeActionSet();\n\t\tfor (const diagnostic of fixableDiagnostics.values) {\n\t\t\tawait this.getFixesForDiagnostic(document, file, diagnostic, results, token);\n\t\t\tif (token.isCancellationRequested) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst allActions = Array.from(results.values());\n\t\tfor (const action of allActions) {\n\t\t\taction.isPreferred = isPreferredFix(action, allActions);\n\t\t}\n\t\treturn allActions;\n\t}\n\n\tpublic async resolveCodeAction(codeAction: VsCodeCodeAction, token: vscode.CancellationToken): Promise<VsCodeCodeAction> {\n\t\tif (!(codeAction instanceof VsCodeFixAllCodeAction) || !codeAction.tsAction.fixId) {\n\t\t\treturn codeAction;\n\t\t}\n\n\t\tconst arg: Proto.GetCombinedCodeFixRequestArgs = {\n\t\t\tscope: {\n\t\t\t\ttype: 'file',\n\t\t\t\targs: { file: codeAction.file }\n\t\t\t},\n\t\t\tfixId: codeAction.tsAction.fixId,\n\t\t};\n\n\t\tconst response = await this.client.execute('getCombinedCodeFix', arg, token);\n\t\tif (response.type === 'response') {\n\t\t\tcodeAction.combinedResponse = response;\n\t\t\tcodeAction.edit = typeConverters.WorkspaceEdit.fromFileCodeEdits(this.client, response.body.changes);\n\t\t}\n\n\t\treturn codeAction;\n\t}\n\n\tprivate async getFixesForDiagnostic(\n\t\tdocument: vscode.TextDocument,\n\t\tfile: string,\n\t\tdiagnostic: vscode.Diagnostic,\n\t\tresults: CodeActionSet,\n\t\ttoken: vscode.CancellationToken,\n\t): Promise<CodeActionSet> {\n\t\tconst args: Proto.CodeFixRequestArgs = {\n\t\t\t...typeConverters.Range.toFileRangeRequestArgs(file, diagnostic.range),\n\t\t\terrorCodes: [+(diagnostic.code!)]\n\t\t};\n\t\tconst response = await this.client.execute('getCodeFixes', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn results;\n\t\t}\n\n\t\tfor (const tsCodeFix of response.body) {\n\t\t\tfor (const action of this.getFixesForTsCodeAction(document, diagnostic, tsCodeFix)) {\n\t\t\t\tresults.addAction(action);\n\t\t\t}\n\t\t\tthis.addFixAllForTsCodeAction(results, document.uri, file, diagnostic, tsCodeFix as Proto.CodeFixAction);\n\t\t}\n\t\treturn results;\n\t}\n\n\tprivate getFixesForTsCodeAction(\n\t\tdocument: vscode.TextDocument,\n\t\tdiagnostic: vscode.Diagnostic,\n\t\taction: Proto.CodeFixAction\n\t): VsCodeCodeAction[] {\n\t\tconst actions: VsCodeCodeAction[] = [];\n\t\tconst codeAction = new VsCodeCodeAction(action, action.description, vscode.CodeActionKind.QuickFix);\n\t\tcodeAction.edit = getEditForCodeAction(this.client, action);\n\t\tcodeAction.diagnostics = [diagnostic];\n\t\tcodeAction.ranges = [diagnostic.range];\n\t\tcodeAction.command = {\n\t\t\tcommand: ApplyCodeActionCommand.ID,\n\t\t\targuments: [{ action, diagnostic, document } satisfies ApplyCodeActionCommand_args],\n\t\t\ttitle: ''\n\t\t};\n\t\tactions.push(codeAction);\n\n\t\tconst copilot = vscode.extensions.getExtension('github.copilot-chat');\n\t\tif (copilot?.isActive) {\n\t\t\tlet message: string | undefined;\n\t\t\tlet expand: Expand | undefined;\n\t\t\tlet title = action.description;\n\t\t\tif (action.fixName === fixNames.classIncorrectlyImplementsInterface) {\n\t\t\t\ttitle += ' with Copilot';\n\t\t\t\tmessage = `Implement the stubbed-out class members for ${document.getText(diagnostic.range)} with a useful implementation.`;\n\t\t\t\texpand = { kind: 'code-action', action };\n\t\t\t}\n\t\t\telse if (action.fixName === fixNames.fixClassDoesntImplementInheritedAbstractMember) {\n\t\t\t\ttitle += ' with Copilot';\n\t\t\t\tmessage = `Implement the stubbed-out class members for ${document.getText(diagnostic.range)} with a useful implementation.`;\n\t\t\t\texpand = { kind: 'code-action', action };\n\t\t\t}\n\t\t\telse if (action.fixName === fixNames.fixMissingFunctionDeclaration) {\n\t\t\t\ttitle = `Implement missing function declaration '${document.getText(diagnostic.range)}' using Copilot`;\n\t\t\t\tmessage = `Provide a reasonable implementation of the function ${document.getText(diagnostic.range)} given its type and the context it's called in.`;\n\t\t\t\texpand = { kind: 'code-action', action };\n\t\t\t}\n\t\t\telse if (action.fixName === fixNames.inferFromUsage) {\n\t\t\t\tconst inferFromBody = new VsCodeCodeAction(action, 'Infer types using Copilot', vscode.CodeActionKind.QuickFix);\n\t\t\t\tinferFromBody.edit = new vscode.WorkspaceEdit();\n\t\t\t\tinferFromBody.diagnostics = [diagnostic];\n\t\t\t\tinferFromBody.ranges = [diagnostic.range];\n\t\t\t\tinferFromBody.isAI = true;\n\t\t\t\tinferFromBody.command = {\n\t\t\t\t\tcommand: EditorChatFollowUp.ID,\n\t\t\t\t\targuments: [{\n\t\t\t\t\t\tmessage: 'Add types to this code. Add separate interfaces when possible. Do not change the code except for adding types.',\n\t\t\t\t\t\texpand: { kind: 'navtree-function', pos: diagnostic.range.start },\n\t\t\t\t\t\tdocument,\n\t\t\t\t\t\taction: { type: 'quickfix', quickfix: action }\n\t\t\t\t\t} satisfies EditorChatFollowUp_Args],\n\t\t\t\t\ttitle: ''\n\t\t\t\t};\n\t\t\t\tactions.push(inferFromBody);\n\t\t\t}\n\t\t\telse if (action.fixName === fixNames.addNameToNamelessParameter) {\n\t\t\t\tconst newText = action.changes.map(change => change.textChanges.map(textChange => textChange.newText).join('')).join('');\n\t\t\t\ttitle = 'Add meaningful parameter name with Copilot';\n\t\t\t\tmessage = `Rename the parameter ${newText} with a more meaningful name.`;\n\t\t\t\texpand = {\n\t\t\t\t\tkind: 'navtree-function',\n\t\t\t\t\tpos: diagnostic.range.start\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (expand && message !== undefined) {\n\t\t\t\tconst aiCodeAction = new VsCodeCodeAction(action, title, vscode.CodeActionKind.QuickFix);\n\t\t\t\taiCodeAction.edit = getEditForCodeAction(this.client, action);\n\t\t\t\taiCodeAction.edit?.insert(document.uri, diagnostic.range.start, '');\n\t\t\t\taiCodeAction.diagnostics = [diagnostic];\n\t\t\t\taiCodeAction.ranges = [diagnostic.range];\n\t\t\t\taiCodeAction.isAI = true;\n\t\t\t\taiCodeAction.command = {\n\t\t\t\t\tcommand: CompositeCommand.ID,\n\t\t\t\t\ttitle: '',\n\t\t\t\t\targuments: [{\n\t\t\t\t\t\tcommand: ApplyCodeActionCommand.ID,\n\t\t\t\t\t\targuments: [{ action, diagnostic, document } satisfies ApplyCodeActionCommand_args],\n\t\t\t\t\t\ttitle: ''\n\t\t\t\t\t}, {\n\t\t\t\t\t\tcommand: EditorChatFollowUp.ID,\n\t\t\t\t\t\ttitle: '',\n\t\t\t\t\t\targuments: [{\n\t\t\t\t\t\t\tmessage,\n\t\t\t\t\t\t\texpand,\n\t\t\t\t\t\t\tdocument,\n\t\t\t\t\t\t\taction: { type: 'quickfix', quickfix: action }\n\t\t\t\t\t\t} satisfies EditorChatFollowUp_Args],\n\t\t\t\t\t}],\n\t\t\t\t};\n\t\t\t\tactions.push(aiCodeAction);\n\t\t\t}\n\t\t}\n\t\treturn actions;\n\t}\n\n\tprivate addFixAllForTsCodeAction(\n\t\tresults: CodeActionSet,\n\t\tresource: vscode.Uri,\n\t\tfile: string,\n\t\tdiagnostic: vscode.Diagnostic,\n\t\ttsAction: Proto.CodeFixAction,\n\t): CodeActionSet {\n\t\tif (!tsAction.fixId || results.hasFixAllAction(tsAction.fixId)) {\n\t\t\treturn results;\n\t\t}\n\n\t\t// Make sure there are multiple diagnostics of the same type in the file\n\t\tif (!this.diagnosticsManager.getDiagnostics(resource).some(x => {\n\t\t\tif (x === diagnostic) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn x.code === diagnostic.code\n\t\t\t\t|| (fixAllErrorCodes.has(x.code as number) && fixAllErrorCodes.get(x.code as number) === fixAllErrorCodes.get(diagnostic.code as number));\n\t\t})) {\n\t\t\treturn results;\n\t\t}\n\n\t\tconst action = new VsCodeFixAllCodeAction(\n\t\t\ttsAction,\n\t\t\tfile,\n\t\t\ttsAction.fixAllDescription || vscode.l10n.t(\"{0} (Fix all in file)\", tsAction.description),\n\t\t\tvscode.CodeActionKind.QuickFix);\n\n\t\taction.diagnostics = [diagnostic];\n\t\taction.ranges = [diagnostic.range];\n\t\taction.command = {\n\t\t\tcommand: ApplyFixAllCodeAction.ID,\n\t\t\targuments: [{ action } satisfies ApplyFixAllCodeAction_args],\n\t\t\ttitle: ''\n\t\t};\n\t\tresults.addFixAllAction(tsAction.fixId, action);\n\t\treturn results;\n\t}\n}\n\n// Some fix all actions can actually fix multiple differnt diagnostics. Make sure we still show the fix all action\n// in such cases\nconst fixAllErrorCodes = new Map<number, number>([\n\t// Missing async\n\t[2339, 2339],\n\t[2345, 2339],\n]);\n\nconst preferredFixes = new Map<string, { readonly priority: number; readonly thereCanOnlyBeOne?: boolean }>([\n\t[fixNames.annotateWithTypeFromJSDoc, { priority: 2 }],\n\t[fixNames.constructorForDerivedNeedSuperCall, { priority: 2 }],\n\t[fixNames.extendsInterfaceBecomesImplements, { priority: 2 }],\n\t[fixNames.awaitInSyncFunction, { priority: 2 }],\n\t[fixNames.removeUnnecessaryAwait, { priority: 2 }],\n\t[fixNames.classIncorrectlyImplementsInterface, { priority: 3 }],\n\t[fixNames.classDoesntImplementInheritedAbstractMember, { priority: 3 }],\n\t[fixNames.unreachableCode, { priority: 2 }],\n\t[fixNames.unusedIdentifier, { priority: 2 }],\n\t[fixNames.forgottenThisPropertyAccess, { priority: 2 }],\n\t[fixNames.spelling, { priority: 0 }],\n\t[fixNames.addMissingAwait, { priority: 2 }],\n\t[fixNames.addMissingOverride, { priority: 2 }],\n\t[fixNames.addMissingNewOperator, { priority: 2 }],\n\t[fixNames.fixImport, { priority: 1, thereCanOnlyBeOne: true }],\n]);\n\nfunction isPreferredFix(\n\taction: VsCodeCodeAction,\n\tallActions: readonly VsCodeCodeAction[]\n): boolean {\n\tif (action instanceof VsCodeFixAllCodeAction) {\n\t\treturn false;\n\t}\n\n\tconst fixPriority = preferredFixes.get(action.tsAction.fixName);\n\tif (!fixPriority) {\n\t\treturn false;\n\t}\n\n\treturn allActions.every(otherAction => {\n\t\tif (otherAction === action) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (otherAction instanceof VsCodeFixAllCodeAction) {\n\t\t\treturn true;\n\t\t}\n\n\t\tconst otherFixPriority = preferredFixes.get(otherAction.tsAction.fixName);\n\t\tif (!otherFixPriority || otherFixPriority.priority < fixPriority.priority) {\n\t\t\treturn true;\n\t\t} else if (otherFixPriority.priority > fixPriority.priority) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (fixPriority.thereCanOnlyBeOne && action.tsAction.fixName === otherAction.tsAction.fixName) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t});\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n\tfileConfigurationManager: FileConfigurationManager,\n\tcommandManager: CommandManager,\n\tdiagnosticsManager: DiagnosticsManager,\n\ttelemetryReporter: TelemetryReporter\n) {\n\treturn conditionalRegistration([\n\t\trequireSomeCapability(client, ClientCapability.Semantic),\n\t], () => {\n\t\treturn vscode.languages.registerCodeActionsProvider(selector.semantic,\n\t\t\tnew TypeScriptQuickFixProvider(client, fileConfigurationManager, commandManager, diagnosticsManager, telemetryReporter),\n\t\t\tTypeScriptQuickFixProvider.metadata);\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as path from 'path';\nimport * as vscode from 'vscode';\nimport { Utils } from 'vscode-uri';\nimport { Command, CommandManager } from '../commands/commandManager';\nimport { LearnMoreAboutRefactoringsCommand } from '../commands/learnMoreAboutRefactorings';\nimport { DocumentSelector } from '../configuration/documentSelector';\nimport * as fileSchemes from '../configuration/fileSchemes';\nimport { Schemes } from '../configuration/schemes';\nimport { TelemetryReporter } from '../logging/telemetry';\nimport { API } from '../tsServer/api';\nimport { CachedResponse } from '../tsServer/cachedResponse';\nimport type * as Proto from '../tsServer/protocol/protocol';\nimport * as PConst from '../tsServer/protocol/protocol.const';\nimport * as typeConverters from '../typeConverters';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport { coalesce } from '../utils/arrays';\nimport { nulToken } from '../utils/cancellation';\nimport FormattingOptionsManager from './fileConfigurationManager';\nimport { CompositeCommand, EditorChatFollowUp } from './util/copilot';\nimport { conditionalRegistration, requireSomeCapability } from './util/dependentRegistration';\n\nfunction toWorkspaceEdit(client: ITypeScriptServiceClient, edits: readonly Proto.FileCodeEdits[]): vscode.WorkspaceEdit {\n\tconst workspaceEdit = new vscode.WorkspaceEdit();\n\tfor (const edit of edits) {\n\t\tconst resource = client.toResource(edit.fileName);\n\t\tif (resource.scheme === fileSchemes.file) {\n\t\t\tworkspaceEdit.createFile(resource, { ignoreIfExists: true });\n\t\t}\n\t}\n\ttypeConverters.WorkspaceEdit.withFileCodeEdits(workspaceEdit, client, edits);\n\treturn workspaceEdit;\n}\n\n\nnamespace DidApplyRefactoringCommand {\n\texport interface Args {\n\t\treadonly action: string;\n\t\treadonly trigger: vscode.CodeActionTriggerKind;\n\t}\n}\n\nclass DidApplyRefactoringCommand implements Command {\n\tpublic static readonly ID = '_typescript.didApplyRefactoring';\n\tpublic readonly id = DidApplyRefactoringCommand.ID;\n\n\tconstructor(\n\t\tprivate readonly telemetryReporter: TelemetryReporter\n\t) { }\n\n\tpublic async execute(args: DidApplyRefactoringCommand.Args): Promise<void> {\n\t\t/* __GDPR__\n\t\t\t\"refactor.execute\" : {\n\t\t\t\t\"owner\": \"mjbvz\",\n\t\t\t\t\"action\" : { \"classification\": \"PublicNonPersonalData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"trigger\" : { \"classification\": \"PublicNonPersonalData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"${include}\": [\n\t\t\t\t\t\"${TypeScriptCommonProperties}\"\n\t\t\t\t]\n\t\t\t}\n\t\t*/\n\t\tthis.telemetryReporter.logTelemetry('refactor.execute', {\n\t\t\taction: args.action,\n\t\t\ttrigger: args.trigger,\n\t\t});\n\t}\n}\nnamespace SelectRefactorCommand {\n\texport interface Args {\n\t\treadonly document: vscode.TextDocument;\n\t\treadonly refactor: Proto.ApplicableRefactorInfo;\n\t\treadonly rangeOrSelection: vscode.Range | vscode.Selection;\n\t\treadonly trigger: vscode.CodeActionTriggerKind;\n\t}\n}\n\nclass SelectRefactorCommand implements Command {\n\tpublic static readonly ID = '_typescript.selectRefactoring';\n\tpublic readonly id = SelectRefactorCommand.ID;\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t) { }\n\n\tpublic async execute(args: SelectRefactorCommand.Args): Promise<void> {\n\t\tconst file = this.client.toOpenTsFilePath(args.document);\n\t\tif (!file) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst selected = await vscode.window.showQuickPick(args.refactor.actions.map((action): vscode.QuickPickItem & { action: Proto.RefactorActionInfo } => ({\n\t\t\taction,\n\t\t\tlabel: action.name,\n\t\t\tdescription: action.description,\n\t\t})));\n\t\tif (!selected) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst tsAction = new InlinedCodeAction(this.client, args.document, args.refactor, selected.action, args.rangeOrSelection, args.trigger);\n\t\tawait tsAction.resolve(nulToken);\n\n\t\tif (tsAction.edit) {\n\t\t\tif (!(await vscode.workspace.applyEdit(tsAction.edit, { isRefactoring: true }))) {\n\t\t\t\tvscode.window.showErrorMessage(vscode.l10n.t(\"Could not apply refactoring\"));\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (tsAction.command) {\n\t\t\tawait vscode.commands.executeCommand(tsAction.command.command, ...(tsAction.command.arguments ?? []));\n\t\t}\n\t}\n}\n\nnamespace MoveToFileRefactorCommand {\n\texport interface Args {\n\t\treadonly document: vscode.TextDocument;\n\t\treadonly action: Proto.RefactorActionInfo;\n\t\treadonly range: vscode.Range;\n\t\treadonly trigger: vscode.CodeActionTriggerKind;\n\t}\n}\n\nclass MoveToFileRefactorCommand implements Command {\n\tpublic static readonly ID = '_typescript.moveToFileRefactoring';\n\tpublic readonly id = MoveToFileRefactorCommand.ID;\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly didApplyCommand: DidApplyRefactoringCommand\n\t) { }\n\n\tpublic async execute(args: MoveToFileRefactorCommand.Args): Promise<void> {\n\t\tconst file = this.client.toOpenTsFilePath(args.document);\n\t\tif (!file) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst targetFile = await this.getTargetFile(args.document, file, args.range);\n\t\tif (!targetFile || targetFile.toString() === file.toString()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst fileSuggestionArgs: Proto.GetEditsForRefactorRequestArgs = {\n\t\t\t...typeConverters.Range.toFileRangeRequestArgs(file, args.range),\n\t\t\taction: 'Move to file',\n\t\t\trefactor: 'Move to file',\n\t\t\tinteractiveRefactorArguments: { targetFile },\n\t\t};\n\n\t\tconst response = await this.client.execute('getEditsForRefactor', fileSuggestionArgs, nulToken);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn;\n\t\t}\n\t\tconst edit = toWorkspaceEdit(this.client, response.body.edits);\n\t\tif (!(await vscode.workspace.applyEdit(edit, { isRefactoring: true }))) {\n\t\t\tvscode.window.showErrorMessage(vscode.l10n.t(\"Could not apply refactoring\"));\n\t\t\treturn;\n\t\t}\n\n\t\tawait this.didApplyCommand.execute({ action: args.action.name, trigger: args.trigger });\n\t}\n\n\tprivate async getTargetFile(document: vscode.TextDocument, file: string, range: vscode.Range): Promise<string | undefined> {\n\t\tconst args = typeConverters.Range.toFileRangeRequestArgs(file, range);\n\t\tconst response = await this.client.execute('getMoveToRefactoringFileSuggestions', args, nulToken);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn;\n\t\t}\n\t\tconst body = response.body;\n\n\t\ttype DestinationItem = vscode.QuickPickItem & { readonly file?: string };\n\t\tconst selectExistingFileItem: vscode.QuickPickItem = { label: vscode.l10n.t(\"Select existing file...\") };\n\t\tconst selectNewFileItem: vscode.QuickPickItem = { label: vscode.l10n.t(\"Enter new file path...\") };\n\n\t\tconst workspaceFolder = vscode.workspace.getWorkspaceFolder(document.uri);\n\t\tconst quickPick = vscode.window.createQuickPick<DestinationItem>();\n\t\tquickPick.ignoreFocusOut = true;\n\n\t\t// true so we don't skip computing in the first call\n\t\tlet quickPickInRelativeMode = true;\n\t\tconst updateItems = () => {\n\t\t\tconst relativeQuery = ['./', '../'].find(str => quickPick.value.startsWith(str));\n\t\t\tif (quickPickInRelativeMode === false && !!relativeQuery === false) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tquickPickInRelativeMode = !!relativeQuery;\n\t\t\tconst destinationItems = body.files.map((file): DestinationItem | undefined => {\n\t\t\t\tconst uri = this.client.toResource(file);\n\t\t\t\tconst parentDir = Utils.dirname(uri);\n\t\t\t\tconst filename = Utils.basename(uri);\n\n\t\t\t\tlet description: string | undefined;\n\t\t\t\tif (workspaceFolder) {\n\t\t\t\t\tif (uri.scheme === Schemes.file) {\n\t\t\t\t\t\tdescription = path.relative(workspaceFolder.uri.fsPath, parentDir.fsPath);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdescription = path.posix.relative(workspaceFolder.uri.path, parentDir.path);\n\t\t\t\t\t}\n\t\t\t\t\tif (relativeQuery) {\n\t\t\t\t\t\tconst convertRelativePath = (str: string) => {\n\t\t\t\t\t\t\treturn !str.startsWith('../') ? `./${str}` : str;\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tconst relativePath = convertRelativePath(path.relative(path.dirname(document.uri.fsPath), uri.fsPath));\n\t\t\t\t\t\tif (!relativePath.startsWith(relativeQuery)) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdescription = relativePath;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tdescription = parentDir.fsPath;\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\tfile,\n\t\t\t\t\tlabel: Utils.basename(uri),\n\t\t\t\t\tdescription: relativeQuery ? description : path.join(description, filename),\n\t\t\t\t};\n\t\t\t});\n\t\t\tquickPick.items = [\n\t\t\t\tselectExistingFileItem,\n\t\t\t\tselectNewFileItem,\n\t\t\t\t{ label: vscode.l10n.t(\"destination files\"), kind: vscode.QuickPickItemKind.Separator },\n\t\t\t\t...coalesce(destinationItems)\n\t\t\t];\n\t\t};\n\t\tquickPick.title = vscode.l10n.t(\"Move to File\");\n\t\tquickPick.placeholder = vscode.l10n.t(\"Enter file path\");\n\t\tquickPick.matchOnDescription = true;\n\t\tquickPick.onDidChangeValue(updateItems);\n\t\tupdateItems();\n\n\t\tconst picked = await new Promise<DestinationItem | undefined>(resolve => {\n\t\t\tquickPick.onDidAccept(() => {\n\t\t\t\tresolve(quickPick.selectedItems[0]);\n\t\t\t\tquickPick.dispose();\n\t\t\t});\n\t\t\tquickPick.onDidHide(() => {\n\t\t\t\tresolve(undefined);\n\t\t\t\tquickPick.dispose();\n\t\t\t});\n\t\t\tquickPick.show();\n\t\t});\n\t\tif (!picked) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (picked === selectExistingFileItem) {\n\t\t\tconst picked = await vscode.window.showOpenDialog({\n\t\t\t\ttitle: vscode.l10n.t(\"Select move destination\"),\n\t\t\t\topenLabel: vscode.l10n.t(\"Move to File\"),\n\t\t\t\tdefaultUri: Utils.dirname(document.uri),\n\t\t\t});\n\t\t\treturn picked?.length ? this.client.toTsFilePath(picked[0]) : undefined;\n\t\t} else if (picked === selectNewFileItem) {\n\t\t\tconst picked = await vscode.window.showSaveDialog({\n\t\t\t\ttitle: vscode.l10n.t(\"Select move destination\"),\n\t\t\t\tsaveLabel: vscode.l10n.t(\"Move to File\"),\n\t\t\t\tdefaultUri: this.client.toResource(response.body.newFileName),\n\t\t\t});\n\t\t\treturn picked ? this.client.toTsFilePath(picked) : undefined;\n\t\t} else {\n\t\t\treturn picked.file;\n\t\t}\n\t}\n}\n\ninterface CodeActionKind {\n\treadonly kind: vscode.CodeActionKind;\n\tmatches(refactor: Proto.RefactorActionInfo): boolean;\n}\n\nconst Extract_Function = Object.freeze<CodeActionKind>({\n\tkind: vscode.CodeActionKind.RefactorExtract.append('function'),\n\tmatches: refactor => refactor.name.startsWith('function_')\n});\n\nconst Extract_Constant = Object.freeze<CodeActionKind>({\n\tkind: vscode.CodeActionKind.RefactorExtract.append('constant'),\n\tmatches: refactor => refactor.name.startsWith('constant_')\n});\n\nconst Extract_Type = Object.freeze<CodeActionKind>({\n\tkind: vscode.CodeActionKind.RefactorExtract.append('type'),\n\tmatches: refactor => refactor.name.startsWith('Extract to type alias')\n});\n\nconst Extract_Interface = Object.freeze<CodeActionKind>({\n\tkind: vscode.CodeActionKind.RefactorExtract.append('interface'),\n\tmatches: refactor => refactor.name.startsWith('Extract to interface')\n});\n\nconst Move_File = Object.freeze<CodeActionKind>({\n\tkind: vscode.CodeActionKind.RefactorMove.append('file'),\n\tmatches: refactor => refactor.name.startsWith('Move to file')\n});\n\nconst Move_NewFile = Object.freeze<CodeActionKind>({\n\tkind: vscode.CodeActionKind.RefactorMove.append('newFile'),\n\tmatches: refactor => refactor.name.startsWith('Move to a new file')\n});\n\nconst Rewrite_Import = Object.freeze<CodeActionKind>({\n\tkind: vscode.CodeActionKind.RefactorRewrite.append('import'),\n\tmatches: refactor => refactor.name.startsWith('Convert namespace import') || refactor.name.startsWith('Convert named imports')\n});\n\nconst Rewrite_Export = Object.freeze<CodeActionKind>({\n\tkind: vscode.CodeActionKind.RefactorRewrite.append('export'),\n\tmatches: refactor => refactor.name.startsWith('Convert default export') || refactor.name.startsWith('Convert named export')\n});\n\nconst Rewrite_Arrow_Braces = Object.freeze<CodeActionKind>({\n\tkind: vscode.CodeActionKind.RefactorRewrite.append('arrow').append('braces'),\n\tmatches: refactor => refactor.name.startsWith('Convert default export') || refactor.name.startsWith('Convert named export')\n});\n\nconst Rewrite_Parameters_ToDestructured = Object.freeze<CodeActionKind>({\n\tkind: vscode.CodeActionKind.RefactorRewrite.append('parameters').append('toDestructured'),\n\tmatches: refactor => refactor.name.startsWith('Convert parameters to destructured object')\n});\n\nconst Rewrite_Property_GenerateAccessors = Object.freeze<CodeActionKind>({\n\tkind: vscode.CodeActionKind.RefactorRewrite.append('property').append('generateAccessors'),\n\tmatches: refactor => refactor.name.startsWith('Generate \\'get\\' and \\'set\\' accessors')\n});\n\nconst allKnownCodeActionKinds = [\n\tExtract_Function,\n\tExtract_Constant,\n\tExtract_Type,\n\tExtract_Interface,\n\tMove_File,\n\tMove_NewFile,\n\tRewrite_Import,\n\tRewrite_Export,\n\tRewrite_Arrow_Braces,\n\tRewrite_Parameters_ToDestructured,\n\tRewrite_Property_GenerateAccessors\n];\n\nclass InlinedCodeAction extends vscode.CodeAction {\n\tconstructor(\n\t\tpublic readonly client: ITypeScriptServiceClient,\n\t\tpublic readonly document: vscode.TextDocument,\n\t\tpublic readonly refactor: Proto.ApplicableRefactorInfo,\n\t\tpublic readonly action: Proto.RefactorActionInfo,\n\t\tpublic readonly range: vscode.Range,\n\t\ttrigger: vscode.CodeActionTriggerKind,\n\t) {\n\t\tconst title = action.description;\n\t\tsuper(title, InlinedCodeAction.getKind(action));\n\n\t\tif (action.notApplicableReason) {\n\t\t\tthis.disabled = { reason: action.notApplicableReason };\n\t\t}\n\n\t\tthis.command = {\n\t\t\ttitle,\n\t\t\tcommand: DidApplyRefactoringCommand.ID,\n\t\t\targuments: [{ action: action.name, trigger } satisfies DidApplyRefactoringCommand.Args],\n\t\t};\n\t}\n\n\tpublic async resolve(token: vscode.CancellationToken): Promise<undefined> {\n\t\tconst file = this.client.toOpenTsFilePath(this.document);\n\t\tif (!file) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst args: Proto.GetEditsForRefactorRequestArgs = {\n\t\t\t...typeConverters.Range.toFileRangeRequestArgs(file, this.range),\n\t\t\trefactor: this.refactor.name,\n\t\t\taction: this.action.name,\n\t\t};\n\n\t\tconst response = await this.client.execute('getEditsForRefactor', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.edit = toWorkspaceEdit(this.client, response.body.edits);\n\t\tif (!this.edit.size) {\n\t\t\tvscode.window.showErrorMessage(vscode.l10n.t(\"Could not apply refactoring\"));\n\t\t\treturn;\n\t\t}\n\n\t\tif (response.body.renameLocation) {\n\t\t\t// Disable renames in interactive playground https://github.com/microsoft/vscode/issues/75137\n\t\t\tif (this.document.uri.scheme !== fileSchemes.walkThroughSnippet) {\n\t\t\t\tthis.command = {\n\t\t\t\t\tcommand: CompositeCommand.ID,\n\t\t\t\t\ttitle: '',\n\t\t\t\t\targuments: coalesce([\n\t\t\t\t\t\tthis.command,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcommand: 'editor.action.rename',\n\t\t\t\t\t\t\targuments: [[\n\t\t\t\t\t\t\t\tthis.document.uri,\n\t\t\t\t\t\t\t\ttypeConverters.Position.fromLocation(response.body.renameLocation)\n\t\t\t\t\t\t\t]]\n\t\t\t\t\t\t},\n\t\t\t\t\t])\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate static getKind(refactor: Proto.RefactorActionInfo) {\n\t\tif ((refactor as Proto.RefactorActionInfo & { kind?: string }).kind) {\n\t\t\treturn vscode.CodeActionKind.Empty.append((refactor as Proto.RefactorActionInfo & { kind?: string }).kind!);\n\t\t}\n\t\tconst match = allKnownCodeActionKinds.find(kind => kind.matches(refactor));\n\t\treturn match ? match.kind : vscode.CodeActionKind.Refactor;\n\t}\n}\n\nclass MoveToFileCodeAction extends vscode.CodeAction {\n\tconstructor(\n\t\tdocument: vscode.TextDocument,\n\t\taction: Proto.RefactorActionInfo,\n\t\trange: vscode.Range,\n\t\ttrigger: vscode.CodeActionTriggerKind,\n\t) {\n\t\tsuper(action.description, Move_File.kind);\n\n\t\tif (action.notApplicableReason) {\n\t\t\tthis.disabled = { reason: action.notApplicableReason };\n\t\t}\n\n\t\tthis.command = {\n\t\t\ttitle: action.description,\n\t\t\tcommand: MoveToFileRefactorCommand.ID,\n\t\t\targuments: [{ action, document, range, trigger } satisfies MoveToFileRefactorCommand.Args]\n\t\t};\n\t}\n}\n\nclass SelectCodeAction extends vscode.CodeAction {\n\tconstructor(\n\t\tinfo: Proto.ApplicableRefactorInfo,\n\t\tdocument: vscode.TextDocument,\n\t\trangeOrSelection: vscode.Range | vscode.Selection,\n\t\ttrigger: vscode.CodeActionTriggerKind,\n\t) {\n\t\tsuper(info.description, vscode.CodeActionKind.Refactor);\n\t\tthis.command = {\n\t\t\ttitle: info.description,\n\t\t\tcommand: SelectRefactorCommand.ID,\n\t\t\targuments: [{ document, refactor: info, rangeOrSelection, trigger } satisfies SelectRefactorCommand.Args]\n\t\t};\n\t}\n}\ntype TsCodeAction = InlinedCodeAction | MoveToFileCodeAction | SelectCodeAction;\n\nclass TypeScriptRefactorProvider implements vscode.CodeActionProvider<TsCodeAction> {\n\n\tprivate static readonly _declarationKinds = new Set([\n\t\tPConst.Kind.module,\n\t\tPConst.Kind.class,\n\t\tPConst.Kind.interface,\n\t\tPConst.Kind.function,\n\t\tPConst.Kind.enum,\n\t\tPConst.Kind.type,\n\t\tPConst.Kind.const,\n\t\tPConst.Kind.variable,\n\t\tPConst.Kind.let,\n\t]);\n\n\tprivate static isOnSignatureName(node: Proto.NavigationTree, range: vscode.Range): boolean {\n\t\tif (this._declarationKinds.has(node.kind)) {\n\t\t\t// Show when on the name span\n\t\t\tif (node.nameSpan) {\n\t\t\t\tconst convertedSpan = typeConverters.Range.fromTextSpan(node.nameSpan);\n\t\t\t\tif (range.intersection(convertedSpan)) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Show when on the same line as an exported symbols without a name (handles default exports)\n\t\t\tif (!node.nameSpan && /\\bexport\\b/.test(node.kindModifiers) && node.spans.length) {\n\t\t\t\tconst convertedSpan = typeConverters.Range.fromTextSpan(node.spans[0]);\n\t\t\t\tif (range.intersection(new vscode.Range(convertedSpan.start.line, 0, convertedSpan.start.line, Number.MAX_SAFE_INTEGER))) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Show if on the signature of any children\n\t\treturn node.childItems?.some(child => this.isOnSignatureName(child, range)) ?? false;\n\t}\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly cachedNavTree: CachedResponse<Proto.NavTreeResponse>,\n\t\tprivate readonly formattingOptionsManager: FormattingOptionsManager,\n\t\tcommandManager: CommandManager,\n\t\ttelemetryReporter: TelemetryReporter\n\t) {\n\t\tconst didApplyRefactoringCommand = new DidApplyRefactoringCommand(telemetryReporter);\n\t\tcommandManager.register(didApplyRefactoringCommand);\n\n\t\tcommandManager.register(new CompositeCommand());\n\t\tcommandManager.register(new SelectRefactorCommand(this.client));\n\t\tcommandManager.register(new MoveToFileRefactorCommand(this.client, didApplyRefactoringCommand));\n\t\tcommandManager.register(new EditorChatFollowUp(this.client, telemetryReporter));\n\t}\n\n\tpublic static readonly metadata: vscode.CodeActionProviderMetadata = {\n\t\tprovidedCodeActionKinds: [\n\t\t\tvscode.CodeActionKind.Refactor,\n\t\t\t...allKnownCodeActionKinds.map(x => x.kind),\n\t\t],\n\t\tdocumentation: [\n\t\t\t{\n\t\t\t\tkind: vscode.CodeActionKind.Refactor,\n\t\t\t\tcommand: {\n\t\t\t\t\tcommand: LearnMoreAboutRefactoringsCommand.id,\n\t\t\t\t\ttitle: vscode.l10n.t(\"Learn more about JS/TS refactorings\")\n\t\t\t\t}\n\t\t\t}\n\t\t]\n\t};\n\n\tpublic async provideCodeActions(\n\t\tdocument: vscode.TextDocument,\n\t\trangeOrSelection: vscode.Range | vscode.Selection,\n\t\tcontext: vscode.CodeActionContext,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<TsCodeAction[] | undefined> {\n\t\tif (!this.shouldTrigger(context, rangeOrSelection)) {\n\t\t\treturn undefined;\n\t\t}\n\t\tif (!this.client.toOpenTsFilePath(document)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst response = await this.interruptGetErrIfNeeded(context, () => {\n\t\t\tconst file = this.client.toOpenTsFilePath(document);\n\t\t\tif (!file) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tthis.formattingOptionsManager.ensureConfigurationForDocument(document, token);\n\n\t\t\tconst args: Proto.GetApplicableRefactorsRequestArgs = {\n\t\t\t\t...typeConverters.Range.toFileRangeRequestArgs(file, rangeOrSelection),\n\t\t\t\ttriggerReason: this.toTsTriggerReason(context),\n\t\t\t\tkind: context.only?.value,\n\t\t\t\tincludeInteractiveActions: this.client.apiVersion.gte(API.v520),\n\t\t\t};\n\t\t\treturn this.client.execute('getApplicableRefactors', args, token);\n\t\t});\n\t\tif (response?.type !== 'response' || !response.body) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst applicableRefactors = this.convertApplicableRefactors(document, context, response.body, rangeOrSelection);\n\t\tconst actions = coalesce(await Promise.all(Array.from(applicableRefactors, async action => {\n\t\t\tif (this.client.apiVersion.lt(API.v430)) {\n\t\t\t\t// Don't show 'infer return type' refactoring unless it has been explicitly requested\n\t\t\t\t// https://github.com/microsoft/TypeScript/issues/42993\n\t\t\t\tif (!context.only && action.kind?.value === 'refactor.rewrite.function.returnType') {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Don't include move actions on auto light bulb unless you are on a declaration name\n\t\t\tif (this.client.apiVersion.lt(API.v540) && context.triggerKind === vscode.CodeActionTriggerKind.Automatic) {\n\t\t\t\tif (action.kind?.value === Move_NewFile.kind.value || action.kind?.value === Move_File.kind.value) {\n\t\t\t\t\tconst file = this.client.toOpenTsFilePath(document);\n\t\t\t\t\tif (!file) {\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst navTree = await this.cachedNavTree.execute(document, () => this.client.execute('navtree', { file }, token));\n\t\t\t\t\tif (navTree.type !== 'response' || !navTree.body || !TypeScriptRefactorProvider.isOnSignatureName(navTree.body, rangeOrSelection)) {\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn action;\n\t\t})));\n\n\t\tif (!context.only) {\n\t\t\treturn actions;\n\t\t}\n\n\t\treturn this.pruneInvalidActions(this.appendInvalidActions(actions), context.only, /* numberOfInvalid = */ 5);\n\t}\n\n\tprivate interruptGetErrIfNeeded<R>(context: vscode.CodeActionContext, f: () => R): R {\n\t\t// Only interrupt diagnostics computation when code actions are explicitly\n\t\t// (such as using the refactor command or a keybinding). This is a clear\n\t\t// user action so we want to return results as quickly as possible.\n\t\tif (context.triggerKind === vscode.CodeActionTriggerKind.Invoke) {\n\t\t\treturn this.client.interruptGetErr(f);\n\t\t} else {\n\t\t\treturn f();\n\t\t}\n\t}\n\n\tpublic async resolveCodeAction(\n\t\tcodeAction: TsCodeAction,\n\t\ttoken: vscode.CancellationToken,\n\t): Promise<TsCodeAction> {\n\t\tif (codeAction instanceof InlinedCodeAction) {\n\t\t\tawait codeAction.resolve(token);\n\t\t}\n\t\treturn codeAction;\n\t}\n\n\tprivate toTsTriggerReason(context: vscode.CodeActionContext): Proto.RefactorTriggerReason | undefined {\n\t\treturn context.triggerKind === vscode.CodeActionTriggerKind.Invoke ? 'invoked' : 'implicit';\n\t}\n\n\tprivate *convertApplicableRefactors(\n\t\tdocument: vscode.TextDocument,\n\t\tcontext: vscode.CodeActionContext,\n\t\trefactors: readonly Proto.ApplicableRefactorInfo[],\n\t\trangeOrSelection: vscode.Range | vscode.Selection\n\t): Iterable<TsCodeAction> {\n\t\tfor (const refactor of refactors) {\n\t\t\tif (refactor.inlineable === false) {\n\t\t\t\tyield new SelectCodeAction(refactor, document, rangeOrSelection, context.triggerKind);\n\t\t\t} else {\n\t\t\t\tfor (const action of refactor.actions) {\n\t\t\t\t\tfor (const codeAction of this.refactorActionToCodeActions(document, context, refactor, action, rangeOrSelection, refactor.actions)) {\n\t\t\t\t\t\tyield codeAction;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate refactorActionToCodeActions(\n\t\tdocument: vscode.TextDocument,\n\t\tcontext: vscode.CodeActionContext,\n\t\trefactor: Proto.ApplicableRefactorInfo,\n\t\taction: Proto.RefactorActionInfo,\n\t\trangeOrSelection: vscode.Range | vscode.Selection,\n\t\tallActions: readonly Proto.RefactorActionInfo[],\n\t): TsCodeAction[] {\n\t\tconst codeActions: TsCodeAction[] = [];\n\t\tif (action.name === 'Move to file') {\n\t\t\tcodeActions.push(new MoveToFileCodeAction(document, action, rangeOrSelection, context.triggerKind));\n\t\t} else {\n\t\t\tcodeActions.push(new InlinedCodeAction(this.client, document, refactor, action, rangeOrSelection, context.triggerKind));\n\t\t}\n\t\tfor (const codeAction of codeActions) {\n\t\t\tcodeAction.isPreferred = TypeScriptRefactorProvider.isPreferred(action, allActions);\n\t\t}\n\t\treturn codeActions;\n\t}\n\n\tprivate shouldTrigger(context: vscode.CodeActionContext, rangeOrSelection: vscode.Range | vscode.Selection) {\n\t\tif (context.only && !vscode.CodeActionKind.Refactor.contains(context.only)) {\n\t\t\treturn false;\n\t\t}\n\t\tif (context.triggerKind === vscode.CodeActionTriggerKind.Invoke) {\n\t\t\treturn true;\n\t\t}\n\t\treturn rangeOrSelection instanceof vscode.Selection;\n\t}\n\n\tprivate static isPreferred(\n\t\taction: Proto.RefactorActionInfo,\n\t\tallActions: readonly Proto.RefactorActionInfo[],\n\t): boolean {\n\t\tif (Extract_Constant.matches(action)) {\n\t\t\t// Only mark the action with the lowest scope as preferred\n\t\t\tconst getScope = (name: string) => {\n\t\t\t\tconst scope = name.match(/scope_(\\d)/)?.[1];\n\t\t\t\treturn scope ? +scope : undefined;\n\t\t\t};\n\t\t\tconst scope = getScope(action.name);\n\t\t\tif (typeof scope !== 'number') {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn allActions\n\t\t\t\t.filter(otherAtion => otherAtion !== action && Extract_Constant.matches(otherAtion))\n\t\t\t\t.every(otherAction => {\n\t\t\t\t\tconst otherScope = getScope(otherAction.name);\n\t\t\t\t\treturn typeof otherScope === 'number' ? scope < otherScope : true;\n\t\t\t\t});\n\t\t}\n\t\tif (Extract_Type.matches(action) || Extract_Interface.matches(action)) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate appendInvalidActions(actions: vscode.CodeAction[]): vscode.CodeAction[] {\n\t\tif (this.client.apiVersion.gte(API.v400)) {\n\t\t\t// Invalid actions come from TS server instead\n\t\t\treturn actions;\n\t\t}\n\n\t\tif (!actions.some(action => action.kind && Extract_Constant.kind.contains(action.kind))) {\n\t\t\tconst disabledAction = new vscode.CodeAction(\n\t\t\t\tvscode.l10n.t(\"Extract to constant\"),\n\t\t\t\tExtract_Constant.kind);\n\n\t\t\tdisabledAction.disabled = {\n\t\t\t\treason: vscode.l10n.t(\"The current selection cannot be extracted\"),\n\t\t\t};\n\t\t\tdisabledAction.isPreferred = true;\n\n\t\t\tactions.push(disabledAction);\n\t\t}\n\n\t\tif (!actions.some(action => action.kind && Extract_Function.kind.contains(action.kind))) {\n\t\t\tconst disabledAction = new vscode.CodeAction(\n\t\t\t\tvscode.l10n.t(\"Extract to function\"),\n\t\t\t\tExtract_Function.kind);\n\n\t\t\tdisabledAction.disabled = {\n\t\t\t\treason: vscode.l10n.t(\"The current selection cannot be extracted\"),\n\t\t\t};\n\t\t\tactions.push(disabledAction);\n\t\t}\n\t\treturn actions;\n\t}\n\n\tprivate pruneInvalidActions(actions: vscode.CodeAction[], only?: vscode.CodeActionKind, numberOfInvalid?: number): vscode.CodeAction[] {\n\t\tif (this.client.apiVersion.lt(API.v400)) {\n\t\t\t// Older TS version don't return extra actions\n\t\t\treturn actions;\n\t\t}\n\n\t\tconst availableActions: vscode.CodeAction[] = [];\n\t\tconst invalidCommonActions: vscode.CodeAction[] = [];\n\t\tconst invalidUncommonActions: vscode.CodeAction[] = [];\n\t\tfor (const action of actions) {\n\t\t\tif (!action.disabled) {\n\t\t\t\tavailableActions.push(action);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// These are the common refactors that we should always show if applicable.\n\t\t\tif (action.kind && (Extract_Constant.kind.contains(action.kind) || Extract_Function.kind.contains(action.kind))) {\n\t\t\t\tinvalidCommonActions.push(action);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// These are the remaining refactors that we can show if we haven't reached the max limit with just common refactors.\n\t\t\tinvalidUncommonActions.push(action);\n\t\t}\n\n\t\tconst prioritizedActions: vscode.CodeAction[] = [];\n\t\tprioritizedActions.push(...invalidCommonActions);\n\t\tprioritizedActions.push(...invalidUncommonActions);\n\t\tconst topNInvalid = prioritizedActions.filter(action => !only || (action.kind && only.contains(action.kind))).slice(0, numberOfInvalid);\n\t\tavailableActions.push(...topNInvalid);\n\t\treturn availableActions;\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n\tcachedNavTree: CachedResponse<Proto.NavTreeResponse>,\n\tformattingOptionsManager: FormattingOptionsManager,\n\tcommandManager: CommandManager,\n\ttelemetryReporter: TelemetryReporter,\n) {\n\treturn conditionalRegistration([\n\t\trequireSomeCapability(client, ClientCapability.Semantic),\n\t], () => {\n\t\treturn vscode.languages.registerCodeActionsProvider(selector.semantic,\n\t\t\tnew TypeScriptRefactorProvider(client, cachedNavTree, formattingOptionsManager, commandManager, telemetryReporter),\n\t\t\tTypeScriptRefactorProvider.metadata);\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { DocumentSelector } from '../configuration/documentSelector';\nimport * as typeConverters from '../typeConverters';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport { conditionalRegistration, requireSomeCapability } from './util/dependentRegistration';\n\nclass TypeScriptReferenceSupport implements vscode.ReferenceProvider {\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient) { }\n\n\tpublic async provideReferences(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\toptions: vscode.ReferenceContext,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.Location[]> {\n\t\tconst filepath = this.client.toOpenTsFilePath(document);\n\t\tif (!filepath) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst args = typeConverters.Position.toFileLocationRequestArgs(filepath, position);\n\t\tconst response = await this.client.execute('references', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst result: vscode.Location[] = [];\n\t\tfor (const ref of response.body.refs) {\n\t\t\tif (!options.includeDeclaration && ref.isDefinition) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst url = this.client.toResource(ref.file);\n\t\t\tconst location = typeConverters.Location.fromTextSpan(url, ref);\n\t\t\tresult.push(location);\n\t\t}\n\t\treturn result;\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient\n) {\n\treturn conditionalRegistration([\n\t\trequireSomeCapability(client, ClientCapability.EnhancedSyntax, ClientCapability.Semantic),\n\t], () => {\n\t\treturn vscode.languages.registerReferenceProvider(selector.syntax,\n\t\t\tnew TypeScriptReferenceSupport(client));\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as path from 'path';\nimport * as vscode from 'vscode';\nimport { DocumentSelector } from '../configuration/documentSelector';\nimport * as languageIds from '../configuration/languageIds';\nimport { API } from '../tsServer/api';\nimport type * as Proto from '../tsServer/protocol/protocol';\nimport * as typeConverters from '../typeConverters';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport FileConfigurationManager from './fileConfigurationManager';\nimport { conditionalRegistration, requireSomeCapability } from './util/dependentRegistration';\nimport { LanguageDescription } from '../configuration/languageDescription';\n\ntype RenameResponse = {\n\treadonly type: 'rename';\n\treadonly body: Proto.RenameResponseBody;\n} | {\n\treadonly type: 'jsxLinkedEditing';\n\treadonly spans: readonly Proto.TextSpan[];\n};\n\nclass TypeScriptRenameProvider implements vscode.RenameProvider {\n\n\tpublic constructor(\n\t\tprivate readonly language: LanguageDescription,\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly fileConfigurationManager: FileConfigurationManager\n\t) { }\n\n\tpublic async prepareRename(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.Range | undefined> {\n\t\tconst response = await this.execRename(document, position, token);\n\t\tif (!response) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tswitch (response.type) {\n\t\t\tcase 'rename': {\n\t\t\t\tconst renameInfo = response.body.info;\n\t\t\t\tif (!renameInfo.canRename) {\n\t\t\t\t\treturn Promise.reject<vscode.Range>(renameInfo.localizedErrorMessage);\n\t\t\t\t}\n\t\t\t\treturn typeConverters.Range.fromTextSpan(renameInfo.triggerSpan);\n\t\t\t}\n\t\t\tcase 'jsxLinkedEditing': {\n\t\t\t\treturn response.spans\n\t\t\t\t\t.map(typeConverters.Range.fromTextSpan)\n\t\t\t\t\t.find(range => range.contains(position));\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic async provideRenameEdits(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\tnewName: string,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.WorkspaceEdit | undefined> {\n\t\tconst file = this.client.toOpenTsFilePath(document);\n\t\tif (!file) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst response = await this.execRename(document, position, token);\n\t\tif (!response || token.isCancellationRequested) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tswitch (response.type) {\n\t\t\tcase 'rename': {\n\t\t\t\tconst renameInfo = response.body.info;\n\t\t\t\tif (!renameInfo.canRename) {\n\t\t\t\t\treturn Promise.reject<vscode.WorkspaceEdit>(renameInfo.localizedErrorMessage);\n\t\t\t\t}\n\n\t\t\t\tif (renameInfo.fileToRename) {\n\t\t\t\t\tconst edits = await this.renameFile(renameInfo.fileToRename, renameInfo.fullDisplayName, newName, token);\n\t\t\t\t\tif (edits) {\n\t\t\t\t\t\treturn edits;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn Promise.reject<vscode.WorkspaceEdit>(vscode.l10n.t(\"An error occurred while renaming file\"));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn this.updateLocs(response.body.locs, newName);\n\t\t\t}\n\t\t\tcase 'jsxLinkedEditing': {\n\t\t\t\treturn this.updateLocs([{\n\t\t\t\t\tfile,\n\t\t\t\t\tlocs: response.spans.map((span): Proto.RenameTextSpan => ({ ...span })),\n\t\t\t\t}], newName);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic async execRename(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<RenameResponse | undefined> {\n\t\tconst file = this.client.toOpenTsFilePath(document);\n\t\tif (!file) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// Prefer renaming matching jsx tag when available\n\t\tif (this.client.apiVersion.gte(API.v510) &&\n\t\t\tvscode.workspace.getConfiguration(this.language.id).get('preferences.renameMatchingJsxTags', true) &&\n\t\t\tthis.looksLikePotentialJsxTagContext(document, position)\n\t\t) {\n\t\t\tconst args = typeConverters.Position.toFileLocationRequestArgs(file, position);\n\t\t\tconst response = await this.client.execute('linkedEditingRange', args, token);\n\t\t\tif (response.type !== 'response' || !response.body) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\treturn { type: 'jsxLinkedEditing', spans: response.body.ranges };\n\t\t}\n\n\t\tconst args: Proto.RenameRequestArgs = {\n\t\t\t...typeConverters.Position.toFileLocationRequestArgs(file, position),\n\t\t\tfindInStrings: false,\n\t\t\tfindInComments: false\n\t\t};\n\n\t\treturn this.client.interruptGetErr(async () => {\n\t\t\tthis.fileConfigurationManager.ensureConfigurationForDocument(document, token);\n\t\t\tconst response = await this.client.execute('rename', args, token);\n\t\t\tif (response.type !== 'response' || !response.body) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\treturn { type: 'rename', body: response.body };\n\t\t});\n\t}\n\n\tprivate looksLikePotentialJsxTagContext(document: vscode.TextDocument, position: vscode.Position): boolean {\n\t\tif (![languageIds.typescriptreact, languageIds.javascript, languageIds.javascriptreact].includes(document.languageId)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst prefix = document.getText(new vscode.Range(position.line, 0, position.line, position.character));\n\t\treturn /\\<\\/?\\s*[\\w\\d_$.]*$/.test(prefix);\n\t}\n\n\tprivate updateLocs(\n\t\tlocations: ReadonlyArray<Proto.SpanGroup>,\n\t\tnewName: string\n\t) {\n\t\tconst edit = new vscode.WorkspaceEdit();\n\t\tfor (const spanGroup of locations) {\n\t\t\tconst resource = this.client.toResource(spanGroup.file);\n\t\t\tfor (const textSpan of spanGroup.locs) {\n\t\t\t\tedit.replace(resource, typeConverters.Range.fromTextSpan(textSpan),\n\t\t\t\t\t(textSpan.prefixText || '') + newName + (textSpan.suffixText || ''));\n\t\t\t}\n\t\t}\n\t\treturn edit;\n\t}\n\n\tprivate async renameFile(\n\t\tfileToRename: string,\n\t\tfullDisplayName: string,\n\t\tnewName: string,\n\t\ttoken: vscode.CancellationToken,\n\t): Promise<vscode.WorkspaceEdit | undefined> {\n\t\t// Make sure we preserve file extension if extension is unchanged or none provided\n\t\tif (!path.extname(newName)) {\n\t\t\tnewName += path.extname(fileToRename);\n\t\t}\n\t\telse if (path.extname(newName) === path.extname(fullDisplayName)) {\n\t\t\tnewName = newName.slice(0, newName.length - path.extname(newName).length) + path.extname(fileToRename);\n\t\t}\n\n\t\tconst dirname = path.dirname(fileToRename);\n\t\tconst newFilePath = path.join(dirname, newName);\n\n\t\tconst args: Proto.GetEditsForFileRenameRequestArgs & { file: string } = {\n\t\t\tfile: fileToRename,\n\t\t\toldFilePath: fileToRename,\n\t\t\tnewFilePath: newFilePath,\n\t\t};\n\t\tconst response = await this.client.execute('getEditsForFileRename', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst edits = typeConverters.WorkspaceEdit.fromFileCodeEdits(this.client, response.body);\n\t\tedits.renameFile(vscode.Uri.file(fileToRename), vscode.Uri.file(newFilePath));\n\t\treturn edits;\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tlanguage: LanguageDescription,\n\tclient: ITypeScriptServiceClient,\n\tfileConfigurationManager: FileConfigurationManager,\n) {\n\treturn conditionalRegistration([\n\t\trequireSomeCapability(client, ClientCapability.Semantic),\n\t], () => {\n\t\treturn vscode.languages.registerRenameProvider(selector.semantic,\n\t\t\tnew TypeScriptRenameProvider(language, client, fileConfigurationManager));\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { DocumentSelector } from '../configuration/documentSelector';\nimport * as Proto from '../tsServer/protocol/protocol';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport { conditionalRegistration, requireSomeCapability } from './util/dependentRegistration';\n\n// as we don't do deltas, for performance reasons, don't compute semantic tokens for documents above that limit\nconst CONTENT_LENGTH_LIMIT = 100000;\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n) {\n\treturn conditionalRegistration([\n\t\trequireSomeCapability(client, ClientCapability.Semantic),\n\t], () => {\n\t\tconst provider = new DocumentSemanticTokensProvider(client);\n\t\treturn vscode.languages.registerDocumentRangeSemanticTokensProvider(selector.semantic, provider, provider.getLegend());\n\t});\n}\n\nclass DocumentSemanticTokensProvider implements vscode.DocumentSemanticTokensProvider, vscode.DocumentRangeSemanticTokensProvider {\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient\n\t) { }\n\n\tpublic getLegend(): vscode.SemanticTokensLegend {\n\t\treturn new vscode.SemanticTokensLegend(tokenTypes, tokenModifiers);\n\t}\n\n\tpublic async provideDocumentSemanticTokens(document: vscode.TextDocument, token: vscode.CancellationToken): Promise<vscode.SemanticTokens | null> {\n\t\tconst file = this.client.toOpenTsFilePath(document);\n\t\tif (!file || document.getText().length > CONTENT_LENGTH_LIMIT) {\n\t\t\treturn null;\n\t\t}\n\t\treturn this.provideSemanticTokens(document, { file, start: 0, length: document.getText().length }, token);\n\t}\n\n\tpublic async provideDocumentRangeSemanticTokens(document: vscode.TextDocument, range: vscode.Range, token: vscode.CancellationToken): Promise<vscode.SemanticTokens | null> {\n\t\tconst file = this.client.toOpenTsFilePath(document);\n\t\tif (!file || (document.offsetAt(range.end) - document.offsetAt(range.start) > CONTENT_LENGTH_LIMIT)) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst start = document.offsetAt(range.start);\n\t\tconst length = document.offsetAt(range.end) - start;\n\t\treturn this.provideSemanticTokens(document, { file, start, length }, token);\n\t}\n\n\tprivate async provideSemanticTokens(document: vscode.TextDocument, requestArg: Proto.EncodedSemanticClassificationsRequestArgs, token: vscode.CancellationToken): Promise<vscode.SemanticTokens | null> {\n\t\tconst file = this.client.toOpenTsFilePath(document);\n\t\tif (!file) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst versionBeforeRequest = document.version;\n\n\t\tconst response = await this.client.execute('encodedSemanticClassifications-full', { ...requestArg, format: '2020' }, token, {\n\t\t\tcancelOnResourceChange: document.uri\n\t\t});\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst versionAfterRequest = document.version;\n\n\t\tif (versionBeforeRequest !== versionAfterRequest) {\n\t\t\t// cannot convert result's offsets to (line;col) values correctly\n\t\t\t// a new request will come in soon...\n\t\t\t//\n\t\t\t// here we cannot return null, because returning null would remove all semantic tokens.\n\t\t\t// we must throw to indicate that the semantic tokens should not be removed.\n\t\t\t// using the string busy here because it is not logged to error telemetry if the error text contains busy.\n\n\t\t\t// as the new request will come in right after our response, we first wait for the document activity to stop\n\t\t\tawait waitForDocumentChangesToEnd(document);\n\n\t\t\tthrow new vscode.CancellationError();\n\t\t}\n\n\t\tconst tokenSpan = response.body.spans;\n\n\t\tconst builder = new vscode.SemanticTokensBuilder();\n\t\tfor (let i = 0; i < tokenSpan.length;) {\n\t\t\tconst offset = tokenSpan[i++];\n\t\t\tconst length = tokenSpan[i++];\n\t\t\tconst tsClassification = tokenSpan[i++];\n\n\t\t\tconst tokenType = getTokenTypeFromClassification(tsClassification);\n\t\t\tif (tokenType === undefined) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst tokenModifiers = getTokenModifierFromClassification(tsClassification);\n\n\t\t\t// we can use the document's range conversion methods because the result is at the same version as the document\n\t\t\tconst startPos = document.positionAt(offset);\n\t\t\tconst endPos = document.positionAt(offset + length);\n\n\t\t\tfor (let line = startPos.line; line <= endPos.line; line++) {\n\t\t\t\tconst startCharacter = (line === startPos.line ? startPos.character : 0);\n\t\t\t\tconst endCharacter = (line === endPos.line ? endPos.character : document.lineAt(line).text.length);\n\t\t\t\tbuilder.push(line, startCharacter, endCharacter - startCharacter, tokenType, tokenModifiers);\n\t\t\t}\n\t\t}\n\n\t\treturn builder.build();\n\t}\n}\n\nfunction waitForDocumentChangesToEnd(document: vscode.TextDocument) {\n\tlet version = document.version;\n\treturn new Promise<void>((resolve) => {\n\t\tconst iv = setInterval(_ => {\n\t\t\tif (document.version === version) {\n\t\t\t\tclearInterval(iv);\n\t\t\t\tresolve();\n\t\t\t}\n\t\t\tversion = document.version;\n\t\t}, 400);\n\t});\n}\n\n\n// typescript encodes type and modifiers in the classification:\n// TSClassification = (TokenType + 1) << 8 + TokenModifier\n\nconst enum TokenType {\n\tclass = 0,\n\tenum = 1,\n\tinterface = 2,\n\tnamespace = 3,\n\ttypeParameter = 4,\n\ttype = 5,\n\tparameter = 6,\n\tvariable = 7,\n\tenumMember = 8,\n\tproperty = 9,\n\tfunction = 10,\n\tmethod = 11,\n\t_ = 12\n}\n\nconst enum TokenModifier {\n\tdeclaration = 0,\n\tstatic = 1,\n\tasync = 2,\n\treadonly = 3,\n\tdefaultLibrary = 4,\n\tlocal = 5,\n\t_ = 6\n}\n\nconst enum TokenEncodingConsts {\n\ttypeOffset = 8,\n\tmodifierMask = 255\n}\n\nfunction getTokenTypeFromClassification(tsClassification: number): number | undefined {\n\tif (tsClassification > TokenEncodingConsts.modifierMask) {\n\t\treturn (tsClassification >> TokenEncodingConsts.typeOffset) - 1;\n\t}\n\treturn undefined;\n}\n\nfunction getTokenModifierFromClassification(tsClassification: number) {\n\treturn tsClassification & TokenEncodingConsts.modifierMask;\n}\n\nconst tokenTypes: string[] = [];\ntokenTypes[TokenType.class] = 'class';\ntokenTypes[TokenType.enum] = 'enum';\ntokenTypes[TokenType.interface] = 'interface';\ntokenTypes[TokenType.namespace] = 'namespace';\ntokenTypes[TokenType.typeParameter] = 'typeParameter';\ntokenTypes[TokenType.type] = 'type';\ntokenTypes[TokenType.parameter] = 'parameter';\ntokenTypes[TokenType.variable] = 'variable';\ntokenTypes[TokenType.enumMember] = 'enumMember';\ntokenTypes[TokenType.property] = 'property';\ntokenTypes[TokenType.function] = 'function';\ntokenTypes[TokenType.method] = 'method';\n\nconst tokenModifiers: string[] = [];\ntokenModifiers[TokenModifier.async] = 'async';\ntokenModifiers[TokenModifier.declaration] = 'declaration';\ntokenModifiers[TokenModifier.readonly] = 'readonly';\ntokenModifiers[TokenModifier.static] = 'static';\ntokenModifiers[TokenModifier.local] = 'local';\ntokenModifiers[TokenModifier.defaultLibrary] = 'defaultLibrary';\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { DocumentSelector } from '../configuration/documentSelector';\nimport type * as Proto from '../tsServer/protocol/protocol';\nimport * as typeConverters from '../typeConverters';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport { conditionalRegistration, requireSomeCapability } from './util/dependentRegistration';\nimport * as Previewer from './util/textRendering';\n\nclass TypeScriptSignatureHelpProvider implements vscode.SignatureHelpProvider {\n\n\tpublic static readonly triggerCharacters = ['(', ',', '<'];\n\tpublic static readonly retriggerCharacters = [')'];\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient\n\t) { }\n\n\tpublic async provideSignatureHelp(\n\t\tdocument: vscode.TextDocument,\n\t\tposition: vscode.Position,\n\t\ttoken: vscode.CancellationToken,\n\t\tcontext: vscode.SignatureHelpContext,\n\t): Promise<vscode.SignatureHelp | undefined> {\n\t\tconst filepath = this.client.toOpenTsFilePath(document);\n\t\tif (!filepath) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst args: Proto.SignatureHelpRequestArgs = {\n\t\t\t...typeConverters.Position.toFileLocationRequestArgs(filepath, position),\n\t\t\ttriggerReason: toTsTriggerReason(context)\n\t\t};\n\t\tconst response = await this.client.interruptGetErr(() => this.client.execute('signatureHelp', args, token));\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst info = response.body;\n\t\tconst result = new vscode.SignatureHelp();\n\t\tresult.signatures = info.items.map(signature => this.convertSignature(signature, document.uri));\n\t\tresult.activeSignature = this.getActiveSignature(context, info, result.signatures);\n\t\tresult.activeParameter = this.getActiveParameter(info);\n\n\t\treturn result;\n\t}\n\n\tprivate getActiveSignature(context: vscode.SignatureHelpContext, info: Proto.SignatureHelpItems, signatures: readonly vscode.SignatureInformation[]): number {\n\t\t// Try matching the previous active signature's label to keep it selected\n\t\tconst previouslyActiveSignature = context.activeSignatureHelp?.signatures[context.activeSignatureHelp.activeSignature];\n\t\tif (previouslyActiveSignature && context.isRetrigger) {\n\t\t\tconst existingIndex = signatures.findIndex(other => other.label === previouslyActiveSignature?.label);\n\t\t\tif (existingIndex >= 0) {\n\t\t\t\treturn existingIndex;\n\t\t\t}\n\t\t}\n\n\t\treturn info.selectedItemIndex;\n\t}\n\n\tprivate getActiveParameter(info: Proto.SignatureHelpItems): number {\n\t\tconst activeSignature = info.items[info.selectedItemIndex];\n\t\tif (activeSignature?.isVariadic) {\n\t\t\treturn Math.min(info.argumentIndex, activeSignature.parameters.length - 1);\n\t\t}\n\t\treturn info.argumentIndex;\n\t}\n\n\tprivate convertSignature(item: Proto.SignatureHelpItem, baseUri: vscode.Uri) {\n\t\tconst signature = new vscode.SignatureInformation(\n\t\t\tPreviewer.asPlainTextWithLinks(item.prefixDisplayParts, this.client),\n\t\t\tPreviewer.documentationToMarkdown(item.documentation, item.tags.filter(x => x.name !== 'param'), this.client, baseUri));\n\n\t\tlet textIndex = signature.label.length;\n\t\tconst separatorLabel = Previewer.asPlainTextWithLinks(item.separatorDisplayParts, this.client);\n\t\tfor (let i = 0; i < item.parameters.length; ++i) {\n\t\t\tconst parameter = item.parameters[i];\n\t\t\tconst label = Previewer.asPlainTextWithLinks(parameter.displayParts, this.client);\n\n\t\t\tsignature.parameters.push(\n\t\t\t\tnew vscode.ParameterInformation(\n\t\t\t\t\t[textIndex, textIndex + label.length],\n\t\t\t\t\tPreviewer.documentationToMarkdown(parameter.documentation, [], this.client, baseUri)));\n\n\t\t\ttextIndex += label.length;\n\t\t\tsignature.label += label;\n\n\t\t\tif (i !== item.parameters.length - 1) {\n\t\t\t\tsignature.label += separatorLabel;\n\t\t\t\ttextIndex += separatorLabel.length;\n\t\t\t}\n\t\t}\n\n\t\tsignature.label += Previewer.asPlainTextWithLinks(item.suffixDisplayParts, this.client);\n\t\treturn signature;\n\t}\n}\n\nfunction toTsTriggerReason(context: vscode.SignatureHelpContext): Proto.SignatureHelpTriggerReason {\n\tswitch (context.triggerKind) {\n\t\tcase vscode.SignatureHelpTriggerKind.TriggerCharacter:\n\t\t\tif (context.triggerCharacter) {\n\t\t\t\tif (context.isRetrigger) {\n\t\t\t\t\treturn { kind: 'retrigger', triggerCharacter: context.triggerCharacter as any };\n\t\t\t\t} else {\n\t\t\t\t\treturn { kind: 'characterTyped', triggerCharacter: context.triggerCharacter as any };\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn { kind: 'invoked' };\n\t\t\t}\n\n\t\tcase vscode.SignatureHelpTriggerKind.ContentChange:\n\t\t\treturn context.isRetrigger ? { kind: 'retrigger' } : { kind: 'invoked' };\n\n\t\tcase vscode.SignatureHelpTriggerKind.Invoke:\n\t\tdefault:\n\t\t\treturn { kind: 'invoked' };\n\t}\n}\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n) {\n\treturn conditionalRegistration([\n\t\trequireSomeCapability(client, ClientCapability.EnhancedSyntax, ClientCapability.Semantic),\n\t], () => {\n\t\treturn vscode.languages.registerSignatureHelpProvider(selector.syntax,\n\t\t\tnew TypeScriptSignatureHelpProvider(client), {\n\t\t\ttriggerCharacters: TypeScriptSignatureHelpProvider.triggerCharacters,\n\t\t\tretriggerCharacters: TypeScriptSignatureHelpProvider.retriggerCharacters\n\t\t});\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { DocumentSelector } from '../configuration/documentSelector';\nimport type * as Proto from '../tsServer/protocol/protocol';\nimport * as typeConverters from '../typeConverters';\nimport { ITypeScriptServiceClient } from '../typescriptService';\n\nclass SmartSelection implements vscode.SelectionRangeProvider {\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient\n\t) { }\n\n\tpublic async provideSelectionRanges(\n\t\tdocument: vscode.TextDocument,\n\t\tpositions: vscode.Position[],\n\t\ttoken: vscode.CancellationToken,\n\t): Promise<vscode.SelectionRange[] | undefined> {\n\t\tconst file = this.client.toOpenTsFilePath(document);\n\t\tif (!file) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst args: Proto.SelectionRangeRequestArgs = {\n\t\t\tfile,\n\t\t\tlocations: positions.map(typeConverters.Position.toLocation)\n\t\t};\n\t\tconst response = await this.client.execute('selectionRange', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn response.body.map(SmartSelection.convertSelectionRange);\n\t}\n\n\tprivate static convertSelectionRange(\n\t\tselectionRange: Proto.SelectionRange\n\t): vscode.SelectionRange {\n\t\treturn new vscode.SelectionRange(\n\t\t\ttypeConverters.Range.fromTextSpan(selectionRange.textSpan),\n\t\t\tselectionRange.parent ? SmartSelection.convertSelectionRange(selectionRange.parent) : undefined,\n\t\t);\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n) {\n\treturn vscode.languages.registerSelectionRangeProvider(selector.syntax, new SmartSelection(client));\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { Command, CommandManager } from '../commands/commandManager';\nimport { isSupportedLanguageMode } from '../configuration/languageIds';\nimport { API } from '../tsServer/api';\nimport * as typeConverters from '../typeConverters';\nimport { ITypeScriptServiceClient } from '../typescriptService';\n\n\nclass SourceDefinitionCommand implements Command {\n\n\tpublic static readonly context = 'tsSupportsSourceDefinition';\n\tpublic static readonly minVersion = API.v470;\n\n\tpublic readonly id = 'typescript.goToSourceDefinition';\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient\n\t) { }\n\n\tpublic async execute() {\n\t\tif (this.client.apiVersion.lt(SourceDefinitionCommand.minVersion)) {\n\t\t\tvscode.window.showErrorMessage(vscode.l10n.t(\"Go to Source Definition failed. Requires TypeScript 4.7+.\"));\n\t\t\treturn;\n\t\t}\n\n\t\tconst activeEditor = vscode.window.activeTextEditor;\n\t\tif (!activeEditor) {\n\t\t\tvscode.window.showErrorMessage(vscode.l10n.t(\"Go to Source Definition failed. No resource provided.\"));\n\t\t\treturn;\n\t\t}\n\n\t\tconst resource = activeEditor.document.uri;\n\t\tconst document = await vscode.workspace.openTextDocument(resource);\n\t\tif (!isSupportedLanguageMode(document)) {\n\t\t\tvscode.window.showErrorMessage(vscode.l10n.t(\"Go to Source Definition failed. Unsupported file type.\"));\n\t\t\treturn;\n\t\t}\n\n\t\tconst openedFiledPath = this.client.toOpenTsFilePath(document);\n\t\tif (!openedFiledPath) {\n\t\t\tvscode.window.showErrorMessage(vscode.l10n.t(\"Go to Source Definition failed. Unknown file type.\"));\n\t\t\treturn;\n\t\t}\n\n\t\tawait vscode.window.withProgress({\n\t\t\tlocation: vscode.ProgressLocation.Window,\n\t\t\ttitle: vscode.l10n.t(\"Finding source definitions\")\n\t\t}, async (_progress, token) => {\n\n\t\t\tconst position = activeEditor.selection.anchor;\n\t\t\tconst args = typeConverters.Position.toFileLocationRequestArgs(openedFiledPath, position);\n\t\t\tconst response = await this.client.execute('findSourceDefinition', args, token);\n\t\t\tif (response.type === 'response' && response.body) {\n\t\t\t\tconst locations: vscode.Location[] = response.body.map(reference =>\n\t\t\t\t\ttypeConverters.Location.fromTextSpan(this.client.toResource(reference.file), reference));\n\n\t\t\t\tif (locations.length) {\n\t\t\t\t\tif (locations.length === 1) {\n\t\t\t\t\t\tvscode.commands.executeCommand('vscode.open', locations[0].uri.with({\n\t\t\t\t\t\t\tfragment: `L${locations[0].range.start.line + 1},${locations[0].range.start.character + 1}`\n\t\t\t\t\t\t}));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvscode.commands.executeCommand('editor.action.showReferences', resource, position, locations);\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvscode.window.showErrorMessage(vscode.l10n.t(\"No source definitions found.\"));\n\t\t});\n\t}\n}\n\n\nexport function register(\n\tclient: ITypeScriptServiceClient,\n\tcommandManager: CommandManager\n) {\n\tfunction updateContext() {\n\t\tvscode.commands.executeCommand('setContext', SourceDefinitionCommand.context, client.apiVersion.gte(SourceDefinitionCommand.minVersion));\n\t}\n\tupdateContext();\n\n\tcommandManager.register(new SourceDefinitionCommand(client));\n\treturn client.onTsServerStarted(() => updateContext());\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { DocumentSelector } from '../configuration/documentSelector';\nimport { LanguageDescription } from '../configuration/languageDescription';\nimport type * as Proto from '../tsServer/protocol/protocol';\nimport * as typeConverters from '../typeConverters';\nimport { ITypeScriptServiceClient } from '../typescriptService';\nimport { Disposable } from '../utils/dispose';\nimport { Condition, conditionalRegistration } from './util/dependentRegistration';\n\nclass TagClosing extends Disposable {\n\n\tprivate _disposed = false;\n\tprivate _timeout: NodeJS.Timeout | undefined = undefined;\n\tprivate _cancel: vscode.CancellationTokenSource | undefined = undefined;\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient\n\t) {\n\t\tsuper();\n\t\tvscode.workspace.onDidChangeTextDocument(\n\t\t\tevent => this.onDidChangeTextDocument(event),\n\t\t\tnull,\n\t\t\tthis._disposables);\n\t}\n\n\tpublic override dispose() {\n\t\tsuper.dispose();\n\t\tthis._disposed = true;\n\n\t\tif (this._timeout) {\n\t\t\tclearTimeout(this._timeout);\n\t\t\tthis._timeout = undefined;\n\t\t}\n\n\t\tif (this._cancel) {\n\t\t\tthis._cancel.cancel();\n\t\t\tthis._cancel.dispose();\n\t\t\tthis._cancel = undefined;\n\t\t}\n\t}\n\n\tprivate onDidChangeTextDocument(\n\t\t{ document, contentChanges, reason }: vscode.TextDocumentChangeEvent\n\t) {\n\t\tif (contentChanges.length === 0 || reason === vscode.TextDocumentChangeReason.Undo || reason === vscode.TextDocumentChangeReason.Redo) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst activeDocument = vscode.window.activeTextEditor?.document;\n\t\tif (document !== activeDocument) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst filepath = this.client.toOpenTsFilePath(document);\n\t\tif (!filepath) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (typeof this._timeout !== 'undefined') {\n\t\t\tclearTimeout(this._timeout);\n\t\t}\n\n\t\tif (this._cancel) {\n\t\t\tthis._cancel.cancel();\n\t\t\tthis._cancel.dispose();\n\t\t\tthis._cancel = undefined;\n\t\t}\n\n\t\tconst lastChange = contentChanges[contentChanges.length - 1];\n\t\tconst lastCharacter = lastChange.text[lastChange.text.length - 1];\n\t\tif (lastChange.rangeLength > 0 || lastCharacter !== '>' && lastCharacter !== '/') {\n\t\t\treturn;\n\t\t}\n\n\t\tconst priorCharacter = lastChange.range.start.character > 0\n\t\t\t? document.getText(new vscode.Range(lastChange.range.start.translate({ characterDelta: -1 }), lastChange.range.start))\n\t\t\t: '';\n\t\tif (priorCharacter === '>') {\n\t\t\treturn;\n\t\t}\n\n\t\tconst version = document.version;\n\t\tthis._timeout = setTimeout(async () => {\n\t\t\tthis._timeout = undefined;\n\n\t\t\tif (this._disposed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst addedLines = lastChange.text.split(/\\r\\n|\\n/g);\n\t\t\tconst position = addedLines.length <= 1\n\t\t\t\t? lastChange.range.start.translate({ characterDelta: lastChange.text.length })\n\t\t\t\t: new vscode.Position(lastChange.range.start.line + addedLines.length - 1, addedLines[addedLines.length - 1].length);\n\n\t\t\tconst args: Proto.JsxClosingTagRequestArgs = typeConverters.Position.toFileLocationRequestArgs(filepath, position);\n\t\t\tthis._cancel = new vscode.CancellationTokenSource();\n\t\t\tconst response = await this.client.execute('jsxClosingTag', args, this._cancel.token);\n\t\t\tif (response.type !== 'response' || !response.body) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this._disposed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst activeEditor = vscode.window.activeTextEditor;\n\t\t\tif (!activeEditor) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst insertion = response.body;\n\t\t\tconst activeDocument = activeEditor.document;\n\t\t\tif (document === activeDocument && activeDocument.version === version) {\n\t\t\t\tactiveEditor.insertSnippet(\n\t\t\t\t\tthis.getTagSnippet(insertion),\n\t\t\t\t\tthis.getInsertionPositions(activeEditor, position));\n\t\t\t}\n\t\t}, 100);\n\t}\n\n\tprivate getTagSnippet(closingTag: Proto.TextInsertion): vscode.SnippetString {\n\t\tconst snippet = new vscode.SnippetString();\n\t\tsnippet.appendPlaceholder('', 0);\n\t\tsnippet.appendText(closingTag.newText);\n\t\treturn snippet;\n\t}\n\n\tprivate getInsertionPositions(editor: vscode.TextEditor, position: vscode.Position) {\n\t\tconst activeSelectionPositions = editor.selections.map(s => s.active);\n\t\treturn activeSelectionPositions.some(p => p.isEqual(position))\n\t\t\t? activeSelectionPositions\n\t\t\t: position;\n\t}\n}\n\nfunction requireActiveDocumentSetting(\n\tselector: vscode.DocumentSelector,\n\tlanguage: LanguageDescription,\n) {\n\treturn new Condition(\n\t\t() => {\n\t\t\tconst editor = vscode.window.activeTextEditor;\n\t\t\tif (!editor || !vscode.languages.match(selector, editor.document)) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn !!vscode.workspace.getConfiguration(language.id, editor.document).get('autoClosingTags');\n\t\t},\n\t\thandler => {\n\t\t\treturn vscode.Disposable.from(\n\t\t\t\tvscode.window.onDidChangeActiveTextEditor(handler),\n\t\t\t\tvscode.workspace.onDidOpenTextDocument(handler),\n\t\t\t\tvscode.workspace.onDidChangeConfiguration(handler));\n\t\t});\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tlanguage: LanguageDescription,\n\tclient: ITypeScriptServiceClient,\n) {\n\treturn conditionalRegistration([\n\t\trequireActiveDocumentSetting(selector.syntax, language)\n\t], () => new TagClosing(client));\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as jsonc from 'jsonc-parser';\nimport { isAbsolute, posix } from 'path';\nimport * as vscode from 'vscode';\nimport { Utils } from 'vscode-uri';\nimport { coalesce } from '../utils/arrays';\nimport { exists, looksLikeAbsoluteWindowsPath } from '../utils/fs';\n\nfunction mapChildren<R>(node: jsonc.Node | undefined, f: (x: jsonc.Node) => R): R[] {\n\treturn node && node.type === 'array' && node.children\n\t\t? node.children.map(f)\n\t\t: [];\n}\n\nconst openExtendsLinkCommandId = '_typescript.openExtendsLink';\n\nenum TsConfigLinkType {\n\tExtends,\n\tReferences\n}\n\ntype OpenExtendsLinkCommandArgs = {\n\treadonly resourceUri: vscode.Uri;\n\treadonly extendsValue: string;\n\treadonly linkType: TsConfigLinkType;\n};\n\n\nclass TsconfigLinkProvider implements vscode.DocumentLinkProvider {\n\n\tpublic provideDocumentLinks(\n\t\tdocument: vscode.TextDocument,\n\t\t_token: vscode.CancellationToken\n\t): vscode.DocumentLink[] {\n\t\tconst root = jsonc.parseTree(document.getText());\n\t\tif (!root) {\n\t\t\treturn [];\n\t\t}\n\n\t\treturn coalesce([\n\t\t\tthis.getExtendsLink(document, root),\n\t\t\t...this.getFilesLinks(document, root),\n\t\t\t...this.getReferencesLinks(document, root)\n\t\t]);\n\t}\n\n\tprivate getExtendsLink(document: vscode.TextDocument, root: jsonc.Node): vscode.DocumentLink | undefined {\n\t\tconst node = jsonc.findNodeAtLocation(root, ['extends']);\n\t\treturn node && this.tryCreateTsConfigLink(document, node, TsConfigLinkType.Extends);\n\t}\n\n\tprivate getReferencesLinks(document: vscode.TextDocument, root: jsonc.Node) {\n\t\treturn mapChildren(\n\t\t\tjsonc.findNodeAtLocation(root, ['references']),\n\t\t\tchild => {\n\t\t\t\tconst pathNode = jsonc.findNodeAtLocation(child, ['path']);\n\t\t\t\treturn pathNode && this.tryCreateTsConfigLink(document, pathNode, TsConfigLinkType.References);\n\t\t\t});\n\t}\n\n\tprivate tryCreateTsConfigLink(document: vscode.TextDocument, node: jsonc.Node, linkType: TsConfigLinkType): vscode.DocumentLink | undefined {\n\t\tif (!this.isPathValue(node)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst args: OpenExtendsLinkCommandArgs = {\n\t\t\tresourceUri: { ...document.uri.toJSON(), $mid: undefined },\n\t\t\textendsValue: node.value,\n\t\t\tlinkType\n\t\t};\n\n\t\tconst link = new vscode.DocumentLink(\n\t\t\tthis.getRange(document, node),\n\t\t\tvscode.Uri.parse(`command:${openExtendsLinkCommandId}?${JSON.stringify(args)}`));\n\t\tlink.tooltip = vscode.l10n.t(\"Follow link\");\n\t\treturn link;\n\t}\n\n\tprivate getFilesLinks(document: vscode.TextDocument, root: jsonc.Node) {\n\t\treturn mapChildren(\n\t\t\tjsonc.findNodeAtLocation(root, ['files']),\n\t\t\tchild => this.pathNodeToLink(document, child));\n\t}\n\n\tprivate pathNodeToLink(\n\t\tdocument: vscode.TextDocument,\n\t\tnode: jsonc.Node | undefined\n\t): vscode.DocumentLink | undefined {\n\t\treturn this.isPathValue(node)\n\t\t\t? new vscode.DocumentLink(this.getRange(document, node), this.getFileTarget(document, node))\n\t\t\t: undefined;\n\t}\n\n\tprivate isPathValue(node: jsonc.Node | undefined): node is jsonc.Node {\n\t\treturn node\n\t\t\t&& node.type === 'string'\n\t\t\t&& node.value\n\t\t\t&& !(node.value as string).includes('*'); // don't treat globs as links.\n\t}\n\n\tprivate getFileTarget(document: vscode.TextDocument, node: jsonc.Node): vscode.Uri {\n\t\tif (isAbsolute(node.value)) {\n\t\t\treturn vscode.Uri.file(node.value);\n\t\t}\n\n\t\treturn vscode.Uri.joinPath(Utils.dirname(document.uri), node.value);\n\t}\n\n\tprivate getRange(document: vscode.TextDocument, node: jsonc.Node) {\n\t\tconst offset = node.offset;\n\t\tconst start = document.positionAt(offset + 1);\n\t\tconst end = document.positionAt(offset + (node.length - 1));\n\t\treturn new vscode.Range(start, end);\n\t}\n}\n\nasync function resolveNodeModulesPath(baseDirUri: vscode.Uri, pathCandidates: string[]): Promise<vscode.Uri | undefined> {\n\tlet currentUri = baseDirUri;\n\tconst baseCandidate = pathCandidates[0];\n\tconst sepIndex = baseCandidate.startsWith('@') ? 2 : 1;\n\tconst moduleBasePath = baseCandidate.split(posix.sep).slice(0, sepIndex).join(posix.sep);\n\twhile (true) {\n\t\tconst moduleAbsoluteUrl = vscode.Uri.joinPath(currentUri, 'node_modules', moduleBasePath);\n\t\tlet moduleStat: vscode.FileStat | undefined;\n\t\ttry {\n\t\t\tmoduleStat = await vscode.workspace.fs.stat(moduleAbsoluteUrl);\n\t\t} catch (err) {\n\t\t\t// noop\n\t\t}\n\n\t\tif (moduleStat && (moduleStat.type & vscode.FileType.Directory)) {\n\t\t\tfor (const uriCandidate of pathCandidates\n\t\t\t\t.map((relativePath) => relativePath.split(posix.sep).slice(sepIndex).join(posix.sep))\n\t\t\t\t// skip empty paths within module\n\t\t\t\t.filter(Boolean)\n\t\t\t\t.map((relativeModulePath) => vscode.Uri.joinPath(moduleAbsoluteUrl, relativeModulePath))\n\t\t\t) {\n\t\t\t\tif (await exists(uriCandidate)) {\n\t\t\t\t\treturn uriCandidate;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Continue to looking for potentially another version\n\t\t}\n\n\t\tconst oldUri = currentUri;\n\t\tcurrentUri = vscode.Uri.joinPath(currentUri, '..');\n\n\t\t// Can't go next. Reached the system root\n\t\tif (oldUri.path === currentUri.path) {\n\t\t\treturn;\n\t\t}\n\t}\n}\n\n// Reference Extends:https://github.com/microsoft/TypeScript/blob/febfd442cdba343771f478cf433b0892f213ad2f/src/compiler/commandLineParser.ts#L3005\n// Reference Project References: https://github.com/microsoft/TypeScript/blob/7377f5cb9db19d79a6167065b323a45611c812b5/src/compiler/tsbuild.ts#L188C1-L194C2\n/**\n* @returns Returns undefined in case of lack of result while trying to resolve from node_modules\n*/\nasync function getTsconfigPath(baseDirUri: vscode.Uri, pathValue: string, linkType: TsConfigLinkType): Promise<vscode.Uri | undefined> {\n\tasync function resolve(absolutePath: vscode.Uri): Promise<vscode.Uri> {\n\t\tif (absolutePath.path.endsWith('.json') || await exists(absolutePath)) {\n\t\t\treturn absolutePath;\n\t\t}\n\t\treturn absolutePath.with({\n\t\t\tpath: `${absolutePath.path}${linkType === TsConfigLinkType.References ? '/tsconfig.json' : '.json'}`\n\t\t});\n\t}\n\n\tconst isRelativePath = ['./', '../'].some(str => pathValue.startsWith(str));\n\tif (isRelativePath) {\n\t\treturn resolve(vscode.Uri.joinPath(baseDirUri, pathValue));\n\t}\n\n\tif (pathValue.startsWith('/') || looksLikeAbsoluteWindowsPath(pathValue)) {\n\t\treturn resolve(vscode.Uri.file(pathValue));\n\t}\n\n\t// Otherwise resolve like a module\n\treturn resolveNodeModulesPath(baseDirUri, [\n\t\tpathValue,\n\t\t...pathValue.endsWith('.json') ? [] : [\n\t\t\t`${pathValue}.json`,\n\t\t\t`${pathValue}/tsconfig.json`,\n\t\t]\n\t]);\n}\n\nexport function register() {\n\tconst patterns: vscode.GlobPattern[] = [\n\t\t'**/[jt]sconfig.json',\n\t\t'**/[jt]sconfig.*.json',\n\t];\n\n\tconst languages = ['json', 'jsonc'];\n\n\tconst selector: vscode.DocumentSelector =\n\t\tlanguages.map(language => patterns.map((pattern): vscode.DocumentFilter => ({ language, pattern })))\n\t\t\t.flat();\n\n\treturn vscode.Disposable.from(\n\t\tvscode.commands.registerCommand(openExtendsLinkCommandId, async ({ resourceUri, extendsValue, linkType }: OpenExtendsLinkCommandArgs) => {\n\t\t\tconst tsconfigPath = await getTsconfigPath(Utils.dirname(vscode.Uri.from(resourceUri)), extendsValue, linkType);\n\t\t\tif (tsconfigPath === undefined) {\n\t\t\t\tvscode.window.showErrorMessage(vscode.l10n.t(\"Failed to resolve {0} as module\", extendsValue));\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// Will suggest to create a .json variant if it doesn't exist yet (but only for relative paths)\n\t\t\tawait vscode.commands.executeCommand('vscode.open', tsconfigPath);\n\t\t}),\n\t\tvscode.languages.registerDocumentLinkProvider(selector, new TsconfigLinkProvider()),\n\t);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { DocumentSelector } from '../configuration/documentSelector';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport DefinitionProviderBase from './definitionProviderBase';\nimport { conditionalRegistration, requireSomeCapability } from './util/dependentRegistration';\n\nexport default class TypeScriptTypeDefinitionProvider extends DefinitionProviderBase implements vscode.TypeDefinitionProvider {\n\tpublic provideTypeDefinition(document: vscode.TextDocument, position: vscode.Position, token: vscode.CancellationToken): Promise<vscode.Definition | undefined> {\n\t\treturn this.getSymbolLocations('typeDefinition', document, position, token);\n\t}\n}\n\nexport function register(\n\tselector: DocumentSelector,\n\tclient: ITypeScriptServiceClient,\n) {\n\treturn conditionalRegistration([\n\t\trequireSomeCapability(client, ClientCapability.EnhancedSyntax, ClientCapability.Semantic),\n\t], () => {\n\t\treturn vscode.languages.registerTypeDefinitionProvider(selector.syntax,\n\t\t\tnew TypeScriptTypeDefinitionProvider(client));\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as path from 'path';\nimport * as vscode from 'vscode';\nimport * as fileSchemes from '../configuration/fileSchemes';\nimport { doesResourceLookLikeATypeScriptFile } from '../configuration/languageDescription';\nimport type * as Proto from '../tsServer/protocol/protocol';\nimport * as typeConverters from '../typeConverters';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport { Delayer } from '../utils/async';\nimport { nulToken } from '../utils/cancellation';\nimport { Disposable } from '../utils/dispose';\nimport FileConfigurationManager from './fileConfigurationManager';\nimport { conditionalRegistration, requireSomeCapability } from './util/dependentRegistration';\n\n\nconst updateImportsOnFileMoveName = 'updateImportsOnFileMove.enabled';\n\nasync function isDirectory(resource: vscode.Uri): Promise<boolean> {\n\ttry {\n\t\treturn (await vscode.workspace.fs.stat(resource)).type === vscode.FileType.Directory;\n\t} catch {\n\t\treturn false;\n\t}\n}\n\nconst enum UpdateImportsOnFileMoveSetting {\n\tPrompt = 'prompt',\n\tAlways = 'always',\n\tNever = 'never',\n}\n\ninterface RenameAction {\n\treadonly oldUri: vscode.Uri;\n\treadonly newUri: vscode.Uri;\n\treadonly newFilePath: string;\n\treadonly oldFilePath: string;\n\treadonly jsTsFileThatIsBeingMoved: vscode.Uri;\n}\n\nclass UpdateImportsOnFileRenameHandler extends Disposable {\n\n\tprivate readonly _delayer = new Delayer(50);\n\tprivate readonly _pendingRenames = new Set<RenameAction>();\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly fileConfigurationManager: FileConfigurationManager,\n\t\tprivate readonly _handles: (uri: vscode.Uri) => Promise<boolean>,\n\t) {\n\t\tsuper();\n\n\t\tthis._register(vscode.workspace.onDidRenameFiles(async (e) => {\n\t\t\tfor (const { newUri, oldUri } of e.files) {\n\t\t\t\tconst newFilePath = this.client.toTsFilePath(newUri);\n\t\t\t\tif (!newFilePath) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst oldFilePath = this.client.toTsFilePath(oldUri);\n\t\t\t\tif (!oldFilePath) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst config = this.getConfiguration(newUri);\n\t\t\t\tconst setting = config.get<UpdateImportsOnFileMoveSetting>(updateImportsOnFileMoveName);\n\t\t\t\tif (setting === UpdateImportsOnFileMoveSetting.Never) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Try to get a js/ts file that is being moved\n\t\t\t\t// For directory moves, this returns a js/ts file under the directory.\n\t\t\t\tconst jsTsFileThatIsBeingMoved = await this.getJsTsFileBeingMoved(newUri);\n\t\t\t\tif (!jsTsFileThatIsBeingMoved || !this.client.toTsFilePath(jsTsFileThatIsBeingMoved)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tthis._pendingRenames.add({ oldUri, newUri, newFilePath, oldFilePath, jsTsFileThatIsBeingMoved });\n\n\t\t\t\tthis._delayer.trigger(() => {\n\t\t\t\t\tvscode.window.withProgress({\n\t\t\t\t\t\tlocation: vscode.ProgressLocation.Window,\n\t\t\t\t\t\ttitle: vscode.l10n.t(\"Checking for update of JS/TS imports\")\n\t\t\t\t\t}, () => this.flushRenames());\n\t\t\t\t});\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate async flushRenames(): Promise<void> {\n\t\tconst renames = Array.from(this._pendingRenames);\n\t\tthis._pendingRenames.clear();\n\t\tfor (const group of this.groupRenames(renames)) {\n\t\t\tconst edits = new vscode.WorkspaceEdit();\n\t\t\tconst resourcesBeingRenamed: vscode.Uri[] = [];\n\n\t\t\tfor (const { oldUri, newUri, newFilePath, oldFilePath, jsTsFileThatIsBeingMoved } of group) {\n\t\t\t\tconst document = await vscode.workspace.openTextDocument(jsTsFileThatIsBeingMoved);\n\n\t\t\t\t// Make sure TS knows about file\n\t\t\t\tthis.client.bufferSyncSupport.closeResource(oldUri);\n\t\t\t\tthis.client.bufferSyncSupport.openTextDocument(document);\n\n\t\t\t\tif (await this.withEditsForFileRename(edits, document, oldFilePath, newFilePath)) {\n\t\t\t\t\tresourcesBeingRenamed.push(newUri);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (edits.size) {\n\t\t\t\tif (await this.confirmActionWithUser(resourcesBeingRenamed)) {\n\t\t\t\t\tawait vscode.workspace.applyEdit(edits, { isRefactoring: true });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate async confirmActionWithUser(newResources: readonly vscode.Uri[]): Promise<boolean> {\n\t\tif (!newResources.length) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst config = this.getConfiguration(newResources[0]);\n\t\tconst setting = config.get<UpdateImportsOnFileMoveSetting>(updateImportsOnFileMoveName);\n\t\tswitch (setting) {\n\t\t\tcase UpdateImportsOnFileMoveSetting.Always:\n\t\t\t\treturn true;\n\t\t\tcase UpdateImportsOnFileMoveSetting.Never:\n\t\t\t\treturn false;\n\t\t\tcase UpdateImportsOnFileMoveSetting.Prompt:\n\t\t\tdefault:\n\t\t\t\treturn this.promptUser(newResources);\n\t\t}\n\t}\n\n\tprivate getConfiguration(resource: vscode.Uri) {\n\t\treturn vscode.workspace.getConfiguration(doesResourceLookLikeATypeScriptFile(resource) ? 'typescript' : 'javascript', resource);\n\t}\n\n\tprivate async promptUser(newResources: readonly vscode.Uri[]): Promise<boolean> {\n\t\tif (!newResources.length) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst rejectItem: vscode.MessageItem = {\n\t\t\ttitle: vscode.l10n.t(\"No\"),\n\t\t\tisCloseAffordance: true,\n\t\t};\n\n\t\tconst acceptItem: vscode.MessageItem = {\n\t\t\ttitle: vscode.l10n.t(\"Yes\"),\n\t\t};\n\n\t\tconst alwaysItem: vscode.MessageItem = {\n\t\t\ttitle: vscode.l10n.t(\"Always\"),\n\t\t};\n\n\t\tconst neverItem: vscode.MessageItem = {\n\t\t\ttitle: vscode.l10n.t(\"Never\"),\n\t\t};\n\n\t\tconst response = await vscode.window.showInformationMessage(\n\t\t\tnewResources.length === 1\n\t\t\t\t? vscode.l10n.t(\"Update imports for '{0}'?\", path.basename(newResources[0].fsPath))\n\t\t\t\t: this.getConfirmMessage(vscode.l10n.t(\"Update imports for the following {0} files?\", newResources.length), newResources), {\n\t\t\tmodal: true,\n\t\t}, rejectItem, acceptItem, alwaysItem, neverItem);\n\n\n\t\tswitch (response) {\n\t\t\tcase acceptItem: {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tcase rejectItem: {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tcase alwaysItem: {\n\t\t\t\tconst config = this.getConfiguration(newResources[0]);\n\t\t\t\tconfig.update(\n\t\t\t\t\tupdateImportsOnFileMoveName,\n\t\t\t\t\tUpdateImportsOnFileMoveSetting.Always,\n\t\t\t\t\tthis.getConfigTargetScope(config, updateImportsOnFileMoveName));\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tcase neverItem: {\n\t\t\t\tconst config = this.getConfiguration(newResources[0]);\n\t\t\t\tconfig.update(\n\t\t\t\t\tupdateImportsOnFileMoveName,\n\t\t\t\t\tUpdateImportsOnFileMoveSetting.Never,\n\t\t\t\t\tthis.getConfigTargetScope(config, updateImportsOnFileMoveName));\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tdefault: {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate async getJsTsFileBeingMoved(resource: vscode.Uri): Promise<vscode.Uri | undefined> {\n\t\tif (resource.scheme !== fileSchemes.file) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (await isDirectory(resource)) {\n\t\t\tconst files = await vscode.workspace.findFiles(new vscode.RelativePattern(resource, '**/*.{ts,tsx,js,jsx}'), '**/node_modules/**', 1);\n\t\t\treturn files[0];\n\t\t}\n\n\t\treturn (await this._handles(resource)) ? resource : undefined;\n\t}\n\n\tprivate async withEditsForFileRename(\n\t\tedits: vscode.WorkspaceEdit,\n\t\tdocument: vscode.TextDocument,\n\t\toldFilePath: string,\n\t\tnewFilePath: string,\n\t): Promise<boolean> {\n\t\tconst response = await this.client.interruptGetErr(() => {\n\t\t\tthis.fileConfigurationManager.setGlobalConfigurationFromDocument(document, nulToken);\n\t\t\tconst args: Proto.GetEditsForFileRenameRequestArgs = {\n\t\t\t\toldFilePath,\n\t\t\t\tnewFilePath,\n\t\t\t};\n\t\t\treturn this.client.execute('getEditsForFileRename', args, nulToken);\n\t\t});\n\t\tif (response.type !== 'response' || !response.body.length) {\n\t\t\treturn false;\n\t\t}\n\n\t\ttypeConverters.WorkspaceEdit.withFileCodeEdits(edits, this.client, response.body);\n\t\treturn true;\n\t}\n\n\tprivate groupRenames(renames: Iterable<RenameAction>): Iterable<Iterable<RenameAction>> {\n\t\tconst groups = new Map<string, Set<RenameAction>>();\n\n\t\tfor (const rename of renames) {\n\t\t\t// Group renames by type (js/ts) and by workspace.\n\t\t\tconst key = `${this.client.getWorkspaceRootForResource(rename.jsTsFileThatIsBeingMoved)?.fsPath}@@@${doesResourceLookLikeATypeScriptFile(rename.jsTsFileThatIsBeingMoved)}`;\n\t\t\tif (!groups.has(key)) {\n\t\t\t\tgroups.set(key, new Set());\n\t\t\t}\n\t\t\tgroups.get(key)!.add(rename);\n\t\t}\n\n\t\treturn groups.values();\n\t}\n\n\tprivate getConfirmMessage(start: string, resourcesToConfirm: readonly vscode.Uri[]): string {\n\t\tconst MAX_CONFIRM_FILES = 10;\n\n\t\tconst paths = [start];\n\t\tpaths.push('');\n\t\tpaths.push(...resourcesToConfirm.slice(0, MAX_CONFIRM_FILES).map(r => path.basename(r.fsPath)));\n\n\t\tif (resourcesToConfirm.length > MAX_CONFIRM_FILES) {\n\t\t\tif (resourcesToConfirm.length - MAX_CONFIRM_FILES === 1) {\n\t\t\t\tpaths.push(vscode.l10n.t(\"...1 additional file not shown\"));\n\t\t\t} else {\n\t\t\t\tpaths.push(vscode.l10n.t(\"...{0} additional files not shown\", resourcesToConfirm.length - MAX_CONFIRM_FILES));\n\t\t\t}\n\t\t}\n\n\t\tpaths.push('');\n\t\treturn paths.join('\\n');\n\t}\n\n\tprivate getConfigTargetScope(config: vscode.WorkspaceConfiguration, settingsName: string): vscode.ConfigurationTarget {\n\t\tconst inspected = config.inspect(settingsName);\n\t\tif (inspected?.workspaceFolderValue) {\n\t\t\treturn vscode.ConfigurationTarget.WorkspaceFolder;\n\t\t}\n\n\t\tif (inspected?.workspaceValue) {\n\t\t\treturn vscode.ConfigurationTarget.Workspace;\n\t\t}\n\n\t\treturn vscode.ConfigurationTarget.Global;\n\t}\n}\n\nexport function register(\n\tclient: ITypeScriptServiceClient,\n\tfileConfigurationManager: FileConfigurationManager,\n\thandles: (uri: vscode.Uri) => Promise<boolean>,\n) {\n\treturn conditionalRegistration([\n\t\trequireSomeCapability(client, ClientCapability.Semantic),\n\t], () => {\n\t\treturn new UpdateImportsOnFileRenameHandler(client, fileConfigurationManager, handles);\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport type * as Proto from '../../tsServer/protocol/protocol';\nimport * as typeConverters from '../../typeConverters';\nimport { ITypeScriptServiceClient } from '../../typescriptService';\n\nexport function getEditForCodeAction(\n\tclient: ITypeScriptServiceClient,\n\taction: Proto.CodeAction\n): vscode.WorkspaceEdit | undefined {\n\treturn action.changes?.length\n\t\t? typeConverters.WorkspaceEdit.fromFileCodeEdits(client, action.changes)\n\t\t: undefined;\n}\n\nexport async function applyCodeAction(\n\tclient: ITypeScriptServiceClient,\n\taction: Proto.CodeAction,\n\ttoken: vscode.CancellationToken\n): Promise<boolean> {\n\tconst workspaceEdit = getEditForCodeAction(client, action);\n\tif (workspaceEdit) {\n\t\tif (!(await vscode.workspace.applyEdit(workspaceEdit))) {\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn applyCodeActionCommands(client, action.commands, token);\n}\n\nexport async function applyCodeActionCommands(\n\tclient: ITypeScriptServiceClient,\n\tcommands: ReadonlyArray<{}> | undefined,\n\ttoken: vscode.CancellationToken,\n): Promise<boolean> {\n\tif (commands?.length) {\n\t\tfor (const command of commands) {\n\t\t\tawait client.execute('applyCodeActionCommand', { command }, token);\n\t\t}\n\t}\n\treturn true;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { Command } from '../../commands/commandManager';\nimport { nulToken } from '../../utils/cancellation';\nimport type * as Proto from '../../tsServer/protocol/protocol';\nimport * as typeConverters from '../../typeConverters';\nimport { ITypeScriptServiceClient } from '../../typescriptService';\nimport { TelemetryReporter } from '../../logging/telemetry';\n\nexport class EditorChatFollowUp implements Command {\n\tpublic static readonly ID = '_typescript.quickFix.editorChatReplacement2';\n\tpublic readonly id = EditorChatFollowUp.ID;\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly telemetryReporter: TelemetryReporter,\n\t) { }\n\n\tasync execute({ message, document, expand, action }: EditorChatFollowUp_Args) {\n\t\tif (action.type === 'quickfix') {\n\t\t\t/* __GDPR__\n\t\t\t\t\"aiQuickfix.execute\" : {\n\t\t\t\t\t\"owner\": \"mjbvz\",\n\t\t\t\t\t\"action\" : { \"classification\": \"PublicNonPersonalData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\t\"${include}\": [\n\t\t\t\t\t\t\"${TypeScriptCommonProperties}\"\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t*/\n\t\t\tthis.telemetryReporter.logTelemetry('aiQuickfix.execute', {\n\t\t\t\taction: action.quickfix.fixName,\n\t\t\t});\n\t\t} else {\n\t\t\t/* __GDPR__\n\t\t\t\t\"aiRefactor.execute\" : {\n\t\t\t\t\t\"owner\": \"mjbvz\",\n\t\t\t\t\t\"action\" : { \"classification\": \"PublicNonPersonalData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\t\"${include}\": [\n\t\t\t\t\t\t\"${TypeScriptCommonProperties}\"\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t*/\n\t\t\tthis.telemetryReporter.logTelemetry('aiRefactor.execute', {\n\t\t\t\taction: action.refactor.name,\n\t\t\t});\n\t\t}\n\n\t\tconst initialRange =\n\t\t\texpand.kind === 'navtree-function'\n\t\t\t\t? await findScopeEndLineFromNavTree(\n\t\t\t\t\tthis.client,\n\t\t\t\t\tdocument,\n\t\t\t\t\texpand.pos.line\n\t\t\t\t)\n\t\t\t\t: expand.kind === 'refactor-info'\n\t\t\t\t\t? await findEditScope(\n\t\t\t\t\t\tthis.client,\n\t\t\t\t\t\tdocument,\n\t\t\t\t\t\texpand.refactor.edits.flatMap((e) => e.textChanges)\n\t\t\t\t\t)\n\t\t\t\t\t: expand.kind === 'code-action'\n\t\t\t\t\t\t? await findEditScope(\n\t\t\t\t\t\t\tthis.client,\n\t\t\t\t\t\t\tdocument,\n\t\t\t\t\t\t\texpand.action.changes.flatMap((c) => c.textChanges)\n\t\t\t\t\t\t)\n\t\t\t\t\t\t: expand.range;\n\t\tconst initialSelection = initialRange ? new vscode.Selection(initialRange.start, initialRange.end) : undefined;\n\t\tawait vscode.commands.executeCommand('vscode.editorChat.start', {\n\t\t\tinitialRange,\n\t\t\tinitialSelection,\n\t\t\tmessage,\n\t\t\tautoSend: true,\n\t\t});\n\t}\n}\nexport interface EditorChatFollowUp_Args {\n\treadonly message: string;\n\treadonly document: vscode.TextDocument;\n\treadonly expand: Expand;\n\treadonly action: {\n\t\treadonly type: 'refactor';\n\t\treadonly refactor: Proto.RefactorActionInfo;\n\t} | {\n\t\treadonly type: 'quickfix';\n\t\treadonly quickfix: Proto.CodeFixAction;\n\t};\n}\n\nexport class CompositeCommand implements Command {\n\tpublic static readonly ID = '_typescript.compositeCommand';\n\tpublic readonly id = CompositeCommand.ID;\n\n\tpublic async execute(...commands: vscode.Command[]): Promise<void> {\n\t\tfor (const command of commands) {\n\t\t\tawait vscode.commands.executeCommand(\n\t\t\t\tcommand.command,\n\t\t\t\t...(command.arguments ?? [])\n\t\t\t);\n\t\t}\n\t}\n}\n\nexport type Expand =\n\t| { kind: 'none'; readonly range: vscode.Range }\n\t| { kind: 'navtree-function'; readonly pos: vscode.Position }\n\t| { kind: 'refactor-info'; readonly refactor: Proto.RefactorEditInfo }\n\t| { kind: 'code-action'; readonly action: Proto.CodeAction };\n\nfunction findScopeEndLineFromNavTreeWorker(\n\tstartLine: number,\n\tnavigationTree: Proto.NavigationTree[]\n): vscode.Range | undefined {\n\tfor (const node of navigationTree) {\n\t\tconst range = typeConverters.Range.fromTextSpan(node.spans[0]);\n\t\tif (startLine === range.start.line) {\n\t\t\treturn range;\n\t\t} else if (\n\t\t\tstartLine > range.start.line &&\n\t\t\tstartLine <= range.end.line &&\n\t\t\tnode.childItems\n\t\t) {\n\t\t\treturn findScopeEndLineFromNavTreeWorker(startLine, node.childItems);\n\t\t}\n\t}\n\treturn undefined;\n}\n\nasync function findScopeEndLineFromNavTree(\n\tclient: ITypeScriptServiceClient,\n\tdocument: vscode.TextDocument,\n\tstartLine: number\n) {\n\tconst filepath = client.toOpenTsFilePath(document);\n\tif (!filepath) {\n\t\treturn;\n\t}\n\tconst response = await client.execute(\n\t\t'navtree',\n\t\t{ file: filepath },\n\t\tnulToken\n\t);\n\tif (response.type !== 'response' || !response.body?.childItems) {\n\t\treturn;\n\t}\n\treturn findScopeEndLineFromNavTreeWorker(startLine, response.body.childItems);\n}\n\nasync function findEditScope(\n\tclient: ITypeScriptServiceClient,\n\tdocument: vscode.TextDocument,\n\tedits: Proto.CodeEdit[]\n): Promise<vscode.Range> {\n\tlet first = typeConverters.Position.fromLocation(edits[0].start);\n\tlet firstEdit = edits[0];\n\tlet lastEdit = edits[0];\n\tlet last = typeConverters.Position.fromLocation(edits[0].start);\n\tfor (const edit of edits) {\n\t\tconst start = typeConverters.Position.fromLocation(edit.start);\n\t\tconst end = typeConverters.Position.fromLocation(edit.end);\n\t\tif (start.compareTo(first) < 0) {\n\t\t\tfirst = start;\n\t\t\tfirstEdit = edit;\n\t\t}\n\t\tif (end.compareTo(last) > 0) {\n\t\t\tlast = end;\n\t\t\tlastEdit = edit;\n\t\t}\n\t}\n\tconst text = document.getText();\n\tconst startIndex = text.indexOf(firstEdit.newText);\n\tconst start = startIndex > -1 ? document.positionAt(startIndex) : first;\n\tconst endIndex = text.lastIndexOf(lastEdit.newText);\n\tconst end =\n\t\tendIndex > -1\n\t\t\t? document.positionAt(endIndex + lastEdit.newText.length)\n\t\t\t: last;\n\tconst expandEnd = await findScopeEndLineFromNavTree(\n\t\tclient,\n\t\tdocument,\n\t\tend.line\n\t);\n\treturn new vscode.Range(start, expandEnd?.end ?? end);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { API } from '../../tsServer/api';\nimport { ClientCapability, ITypeScriptServiceClient } from '../../typescriptService';\nimport { Disposable } from '../../utils/dispose';\n\nexport class Condition extends Disposable {\n\tprivate _value: boolean;\n\n\tconstructor(\n\t\tprivate readonly getValue: () => boolean,\n\t\tonUpdate: (handler: () => void) => void,\n\t) {\n\t\tsuper();\n\t\tthis._value = this.getValue();\n\n\t\tonUpdate(() => {\n\t\t\tconst newValue = this.getValue();\n\t\t\tif (newValue !== this._value) {\n\t\t\t\tthis._value = newValue;\n\t\t\t\tthis._onDidChange.fire();\n\t\t\t}\n\t\t});\n\t}\n\n\tpublic get value(): boolean { return this._value; }\n\n\tprivate readonly _onDidChange = this._register(new vscode.EventEmitter<void>());\n\tpublic readonly onDidChange = this._onDidChange.event;\n}\n\nclass ConditionalRegistration {\n\tprivate registration: vscode.Disposable | undefined = undefined;\n\n\tpublic constructor(\n\t\tprivate readonly conditions: readonly Condition[],\n\t\tprivate readonly doRegister: () => vscode.Disposable\n\t) {\n\t\tfor (const condition of conditions) {\n\t\t\tcondition.onDidChange(() => this.update());\n\t\t}\n\t\tthis.update();\n\t}\n\n\tpublic dispose() {\n\t\tthis.registration?.dispose();\n\t\tthis.registration = undefined;\n\t}\n\n\tprivate update() {\n\t\tconst enabled = this.conditions.every(condition => condition.value);\n\t\tif (enabled) {\n\t\t\tthis.registration ??= this.doRegister();\n\t\t} else {\n\t\t\tthis.registration?.dispose();\n\t\t\tthis.registration = undefined;\n\t\t}\n\t}\n}\n\nexport function conditionalRegistration(\n\tconditions: readonly Condition[],\n\tdoRegister: () => vscode.Disposable,\n): vscode.Disposable {\n\treturn new ConditionalRegistration(conditions, doRegister);\n}\n\nexport function requireMinVersion(\n\tclient: ITypeScriptServiceClient,\n\tminVersion: API,\n) {\n\treturn new Condition(\n\t\t() => client.apiVersion.gte(minVersion),\n\t\tclient.onTsServerStarted\n\t);\n}\n\nexport function requireGlobalConfiguration(\n\tsection: string,\n\tconfigValue: string,\n) {\n\treturn new Condition(\n\t\t() => {\n\t\t\tconst config = vscode.workspace.getConfiguration(section, null);\n\t\t\treturn !!config.get<boolean>(configValue);\n\t\t},\n\t\tvscode.workspace.onDidChangeConfiguration\n\t);\n}\n\nexport function requireSomeCapability(\n\tclient: ITypeScriptServiceClient,\n\t...capabilities: readonly ClientCapability[]\n) {\n\treturn new Condition(\n\t\t() => capabilities.some(requiredCapability => client.capabilities.has(requiredCapability)),\n\t\tclient.onDidChangeCapabilities\n\t);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport type * as Proto from '../../tsServer/protocol/protocol';\nimport * as PConst from '../../tsServer/protocol/protocol.const';\n\nexport function snippetForFunctionCall(\n\titem: { insertText?: string | vscode.SnippetString; label: string },\n\tdisplayParts: ReadonlyArray<Proto.SymbolDisplayPart>\n): { snippet: vscode.SnippetString; parameterCount: number } {\n\tif (item.insertText && typeof item.insertText !== 'string') {\n\t\treturn { snippet: item.insertText, parameterCount: 0 };\n\t}\n\n\tconst parameterListParts = getParameterListParts(displayParts);\n\tconst snippet = new vscode.SnippetString();\n\tsnippet.appendText(`${item.insertText || item.label}(`);\n\tappendJoinedPlaceholders(snippet, parameterListParts.parts, ', ');\n\tif (parameterListParts.hasOptionalParameters) {\n\t\tsnippet.appendTabstop();\n\t}\n\tsnippet.appendText(')');\n\tsnippet.appendTabstop(0);\n\treturn { snippet, parameterCount: parameterListParts.parts.length + (parameterListParts.hasOptionalParameters ? 1 : 0) };\n}\n\nfunction appendJoinedPlaceholders(\n\tsnippet: vscode.SnippetString,\n\tparts: ReadonlyArray<Proto.SymbolDisplayPart>,\n\tjoiner: string\n) {\n\tfor (let i = 0; i < parts.length; ++i) {\n\t\tconst paramterPart = parts[i];\n\t\tsnippet.appendPlaceholder(paramterPart.text);\n\t\tif (i !== parts.length - 1) {\n\t\t\tsnippet.appendText(joiner);\n\t\t}\n\t}\n}\n\ninterface ParamterListParts {\n\treadonly parts: ReadonlyArray<Proto.SymbolDisplayPart>;\n\treadonly hasOptionalParameters: boolean;\n}\n\nfunction getParameterListParts(\n\tdisplayParts: ReadonlyArray<Proto.SymbolDisplayPart>\n): ParamterListParts {\n\tconst parts: Proto.SymbolDisplayPart[] = [];\n\tlet optionalParams: Proto.SymbolDisplayPart[] = [];\n\tlet isInMethod = false;\n\tlet hasOptionalParameters = false;\n\tlet parenCount = 0;\n\tlet braceCount = 0;\n\n\touter: for (let i = 0; i < displayParts.length; ++i) {\n\t\tconst part = displayParts[i];\n\t\tswitch (part.kind) {\n\t\t\tcase PConst.DisplayPartKind.methodName:\n\t\t\tcase PConst.DisplayPartKind.functionName:\n\t\t\tcase PConst.DisplayPartKind.text:\n\t\t\tcase PConst.DisplayPartKind.propertyName:\n\t\t\t\tif (parenCount === 0 && braceCount === 0) {\n\t\t\t\t\tisInMethod = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase PConst.DisplayPartKind.parameterName:\n\t\t\t\tif (parenCount === 1 && braceCount === 0 && isInMethod) {\n\t\t\t\t\t// Only take top level paren names\n\t\t\t\t\tconst next = displayParts[i + 1];\n\t\t\t\t\t// Skip optional parameters\n\t\t\t\t\tconst nameIsFollowedByOptionalIndicator = next && next.text === '?';\n\t\t\t\t\t// Skip this parameter\n\t\t\t\t\tconst nameIsThis = part.text === 'this';\n\n\t\t\t\t\t/* Add optional param to temp array. Once a non-optional param is encountered,\n\t\t\t\t\tthis means that previous optional params were mid-list ones, thus they should\n\t\t\t\t\tbe displayed */\n\t\t\t\t\tif (nameIsFollowedByOptionalIndicator) {\n\t\t\t\t\t\toptionalParams.push(part);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tparts.push(...optionalParams);\n\t\t\t\t\t\toptionalParams = [];\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!nameIsFollowedByOptionalIndicator && !nameIsThis) {\n\t\t\t\t\t\tparts.push(part);\n\t\t\t\t\t}\n\t\t\t\t\thasOptionalParameters = hasOptionalParameters || nameIsFollowedByOptionalIndicator;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase PConst.DisplayPartKind.punctuation:\n\t\t\t\tif (part.text === '(') {\n\t\t\t\t\t++parenCount;\n\t\t\t\t} else if (part.text === ')') {\n\t\t\t\t\t--parenCount;\n\t\t\t\t\tif (parenCount <= 0 && isInMethod) {\n\t\t\t\t\t\tbreak outer;\n\t\t\t\t\t}\n\t\t\t\t} else if (part.text === '...' && parenCount === 1) {\n\t\t\t\t\t// Found rest parmeter. Do not fill in any further arguments\n\t\t\t\t\thasOptionalParameters = true;\n\t\t\t\t\tbreak outer;\n\t\t\t\t} else if (part.text === '{') {\n\t\t\t\t\t++braceCount;\n\t\t\t\t} else if (part.text === '}') {\n\t\t\t\t\t--braceCount;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn { hasOptionalParameters, parts };\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { OpenJsDocLinkCommand, OpenJsDocLinkCommand_Args } from '../../commands/openJsDocLink';\nimport type * as Proto from '../../tsServer/protocol/protocol';\nimport * as typeConverters from '../../typeConverters';\n\nexport interface IFilePathToResourceConverter {\n\t/**\n\t * Convert a typescript filepath to a VS Code resource.\n\t */\n\ttoResource(filepath: string): vscode.Uri;\n}\n\nfunction getTagBodyText(\n\ttag: Proto.JSDocTagInfo,\n\tfilePathConverter: IFilePathToResourceConverter,\n): string | undefined {\n\tif (!tag.text) {\n\t\treturn undefined;\n\t}\n\n\t// Convert to markdown code block if it does not already contain one\n\tfunction makeCodeblock(text: string): string {\n\t\tif (/^\\s*[~`]{3}/m.test(text)) {\n\t\t\treturn text;\n\t\t}\n\t\treturn '```tsx\\n' + text + '\\n```';\n\t}\n\n\tlet text = convertLinkTags(tag.text, filePathConverter);\n\tswitch (tag.name) {\n\t\tcase 'example': {\n\t\t\t// Example text does not support `{@link}` as it is considered code.\n\t\t\t// TODO: should we support it if it appears outside of an explicit code block?\n\t\t\ttext = asPlainText(tag.text);\n\n\t\t\t// check for caption tags, fix for #79704\n\t\t\tconst captionTagMatches = text.match(/<caption>(.*?)<\\/caption>\\s*(\\r\\n|\\n)/);\n\t\t\tif (captionTagMatches && captionTagMatches.index === 0) {\n\t\t\t\treturn captionTagMatches[1] + '\\n' + makeCodeblock(text.substr(captionTagMatches[0].length));\n\t\t\t} else {\n\t\t\t\treturn makeCodeblock(text);\n\t\t\t}\n\t\t}\n\t\tcase 'author': {\n\t\t\t// fix obsucated email address, #80898\n\t\t\tconst emailMatch = text.match(/(.+)\\s<([-.\\w]+@[-.\\w]+)>/);\n\t\t\tif (emailMatch === null) {\n\t\t\t\treturn text;\n\t\t\t} else {\n\t\t\t\treturn `${emailMatch[1]} ${emailMatch[2]}`;\n\t\t\t}\n\t\t}\n\t\tcase 'default': {\n\t\t\treturn makeCodeblock(text);\n\t\t}\n\t\tdefault: {\n\t\t\treturn text;\n\t\t}\n\t}\n}\n\nfunction getTagDocumentation(\n\ttag: Proto.JSDocTagInfo,\n\tfilePathConverter: IFilePathToResourceConverter,\n): string | undefined {\n\tswitch (tag.name) {\n\t\tcase 'augments':\n\t\tcase 'extends':\n\t\tcase 'param':\n\t\tcase 'template': {\n\t\t\tconst body = getTagBody(tag, filePathConverter);\n\t\t\tif (body?.length === 3) {\n\t\t\t\tconst param = body[1];\n\t\t\t\tconst doc = body[2];\n\t\t\t\tconst label = `*@${tag.name}* \\`${param}\\``;\n\t\t\t\tif (!doc) {\n\t\t\t\t\treturn label;\n\t\t\t\t}\n\t\t\t\treturn label + (doc.match(/\\r\\n|\\n/g) ? '  \\n' + doc : ` \\u2014 ${doc}`);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\tcase 'return':\n\t\tcase 'returns': {\n\t\t\t// For return(s), we require a non-empty body\n\t\t\tif (!tag.text?.length) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tbreak;\n\t\t}\n\t}\n\n\n\t// Generic tag\n\tconst label = `*@${tag.name}*`;\n\tconst text = getTagBodyText(tag, filePathConverter);\n\tif (!text) {\n\t\treturn label;\n\t}\n\treturn label + (text.match(/\\r\\n|\\n/g) ? '  \\n' + text : ` \\u2014 ${text}`);\n}\n\nfunction getTagBody(tag: Proto.JSDocTagInfo, filePathConverter: IFilePathToResourceConverter): Array<string> | undefined {\n\tif (tag.name === 'template') {\n\t\tconst parts = tag.text;\n\t\tif (parts && typeof (parts) !== 'string') {\n\t\t\tconst params = parts.filter(p => p.kind === 'typeParameterName').map(p => p.text).join(', ');\n\t\t\tconst docs = parts.filter(p => p.kind === 'text').map(p => convertLinkTags(p.text.replace(/^\\s*-?\\s*/, ''), filePathConverter)).join(' ');\n\t\t\treturn params ? ['', params, docs] : undefined;\n\t\t}\n\t}\n\treturn (convertLinkTags(tag.text, filePathConverter)).split(/^(\\S+)\\s*-?\\s*/);\n}\n\nfunction asPlainText(parts: readonly Proto.SymbolDisplayPart[] | string): string {\n\tif (typeof parts === 'string') {\n\t\treturn parts;\n\t}\n\treturn parts.map(part => part.text).join('');\n}\n\nexport function asPlainTextWithLinks(\n\tparts: readonly Proto.SymbolDisplayPart[] | string,\n\tfilePathConverter: IFilePathToResourceConverter,\n): string {\n\treturn convertLinkTags(parts, filePathConverter);\n}\n\n/**\n * Convert `@link` inline tags to markdown links\n */\nfunction convertLinkTags(\n\tparts: readonly Proto.SymbolDisplayPart[] | string | undefined,\n\tfilePathConverter: IFilePathToResourceConverter,\n): string {\n\tif (!parts) {\n\t\treturn '';\n\t}\n\n\tif (typeof parts === 'string') {\n\t\treturn parts;\n\t}\n\n\tconst out: string[] = [];\n\n\tlet currentLink: { name?: string; target?: Proto.FileSpan; text?: string; readonly linkcode: boolean } | undefined;\n\tfor (const part of parts) {\n\t\tswitch (part.kind) {\n\t\t\tcase 'link':\n\t\t\t\tif (currentLink) {\n\t\t\t\t\tif (currentLink.target) {\n\t\t\t\t\t\tconst file = filePathConverter.toResource(currentLink.target.file);\n\t\t\t\t\t\tconst args: OpenJsDocLinkCommand_Args = {\n\t\t\t\t\t\t\tfile: { ...file.toJSON(), $mid: undefined }, // Prevent VS Code from trying to transform the uri,\n\t\t\t\t\t\t\tposition: typeConverters.Position.fromLocation(currentLink.target.start)\n\t\t\t\t\t\t};\n\t\t\t\t\t\tconst command = `command:${OpenJsDocLinkCommand.id}?${encodeURIComponent(JSON.stringify([args]))}`;\n\n\t\t\t\t\t\tconst linkText = currentLink.text ? currentLink.text : escapeMarkdownSyntaxTokensForCode(currentLink.name ?? '');\n\t\t\t\t\t\tout.push(`[${currentLink.linkcode ? '`' + linkText + '`' : linkText}](${command})`);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst text = currentLink.text ?? currentLink.name;\n\t\t\t\t\t\tif (text) {\n\t\t\t\t\t\t\tif (/^https?:/.test(text)) {\n\t\t\t\t\t\t\t\tconst parts = text.split(' ');\n\t\t\t\t\t\t\t\tif (parts.length === 1 && !currentLink.linkcode) {\n\t\t\t\t\t\t\t\t\tout.push(`<${parts[0]}>`);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tconst linkText = parts.length > 1 ? parts.slice(1).join(' ') : parts[0];\n\t\t\t\t\t\t\t\t\tout.push(`[${currentLink.linkcode ? '`' + escapeMarkdownSyntaxTokensForCode(linkText) + '`' : linkText}](${parts[0]})`);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tout.push(escapeMarkdownSyntaxTokensForCode(text));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcurrentLink = undefined;\n\t\t\t\t} else {\n\t\t\t\t\tcurrentLink = {\n\t\t\t\t\t\tlinkcode: part.text === '{@linkcode '\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'linkName':\n\t\t\t\tif (currentLink) {\n\t\t\t\t\tcurrentLink.name = part.text;\n\t\t\t\t\tcurrentLink.target = (part as Proto.JSDocLinkDisplayPart).target;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'linkText':\n\t\t\t\tif (currentLink) {\n\t\t\t\t\tcurrentLink.text = part.text;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tout.push(part.text);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\treturn out.join('');\n}\n\nfunction escapeMarkdownSyntaxTokensForCode(text: string): string {\n\treturn text.replace(/`/g, '\\\\$&'); // CodeQL [SM02383] This is only meant to escape backticks. The Markdown is fully sanitized after being rendered.\n}\n\nexport function tagsToMarkdown(\n\ttags: readonly Proto.JSDocTagInfo[],\n\tfilePathConverter: IFilePathToResourceConverter,\n): string {\n\treturn tags.map(tag => getTagDocumentation(tag, filePathConverter)).join('  \\n\\n');\n}\n\nexport function documentationToMarkdown(\n\tdocumentation: readonly Proto.SymbolDisplayPart[] | string,\n\ttags: readonly Proto.JSDocTagInfo[],\n\tfilePathConverter: IFilePathToResourceConverter,\n\tbaseUri: vscode.Uri | undefined,\n): vscode.MarkdownString {\n\tconst out = new vscode.MarkdownString();\n\tappendDocumentationAsMarkdown(out, documentation, tags, filePathConverter);\n\tout.baseUri = baseUri;\n\tout.isTrusted = { enabledCommands: [OpenJsDocLinkCommand.id] };\n\treturn out;\n}\n\nexport function appendDocumentationAsMarkdown(\n\tout: vscode.MarkdownString,\n\tdocumentation: readonly Proto.SymbolDisplayPart[] | string | undefined,\n\ttags: readonly Proto.JSDocTagInfo[] | undefined,\n\tconverter: IFilePathToResourceConverter,\n): vscode.MarkdownString {\n\tif (documentation) {\n\t\tout.appendMarkdown(asPlainTextWithLinks(documentation, converter));\n\t}\n\n\tif (tags) {\n\t\tconst tagsPreview = tagsToMarkdown(tags, converter);\n\t\tif (tagsPreview) {\n\t\t\tout.appendMarkdown('\\n\\n' + tagsPreview);\n\t\t}\n\t}\n\n\tout.isTrusted = { enabledCommands: [OpenJsDocLinkCommand.id] };\n\n\treturn out;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as fileSchemes from '../configuration/fileSchemes';\nimport { doesResourceLookLikeAJavaScriptFile, doesResourceLookLikeATypeScriptFile } from '../configuration/languageDescription';\nimport { API } from '../tsServer/api';\nimport { parseKindModifier } from '../tsServer/protocol/modifiers';\nimport type * as Proto from '../tsServer/protocol/protocol';\nimport * as PConst from '../tsServer/protocol/protocol.const';\nimport * as typeConverters from '../typeConverters';\nimport { ITypeScriptServiceClient } from '../typescriptService';\nimport { coalesce } from '../utils/arrays';\n\nfunction getSymbolKind(item: Proto.NavtoItem): vscode.SymbolKind {\n\tswitch (item.kind) {\n\t\tcase PConst.Kind.method: return vscode.SymbolKind.Method;\n\t\tcase PConst.Kind.enum: return vscode.SymbolKind.Enum;\n\t\tcase PConst.Kind.enumMember: return vscode.SymbolKind.EnumMember;\n\t\tcase PConst.Kind.function: return vscode.SymbolKind.Function;\n\t\tcase PConst.Kind.class: return vscode.SymbolKind.Class;\n\t\tcase PConst.Kind.interface: return vscode.SymbolKind.Interface;\n\t\tcase PConst.Kind.type: return vscode.SymbolKind.Class;\n\t\tcase PConst.Kind.memberVariable: return vscode.SymbolKind.Field;\n\t\tcase PConst.Kind.memberGetAccessor: return vscode.SymbolKind.Field;\n\t\tcase PConst.Kind.memberSetAccessor: return vscode.SymbolKind.Field;\n\t\tcase PConst.Kind.variable: return vscode.SymbolKind.Variable;\n\t\tdefault: return vscode.SymbolKind.Variable;\n\t}\n}\n\nclass TypeScriptWorkspaceSymbolProvider implements vscode.WorkspaceSymbolProvider {\n\n\tpublic constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly modeIds: readonly string[],\n\t) { }\n\n\tpublic async provideWorkspaceSymbols(\n\t\tsearch: string,\n\t\ttoken: vscode.CancellationToken\n\t): Promise<vscode.SymbolInformation[]> {\n\t\tlet file: string | undefined;\n\t\tif (this.searchAllOpenProjects) {\n\t\t\tfile = undefined;\n\t\t} else {\n\t\t\tconst document = this.getDocument();\n\t\t\tfile = document ? await this.toOpenedFiledPath(document) : undefined;\n\n\t\t\tif (!file && this.client.apiVersion.lt(API.v390)) {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t}\n\n\t\tconst args: Proto.NavtoRequestArgs = {\n\t\t\tfile,\n\t\t\tsearchValue: search,\n\t\t\tmaxResultCount: 256,\n\t\t};\n\n\t\tconst response = await this.client.execute('navto', args, token);\n\t\tif (response.type !== 'response' || !response.body) {\n\t\t\treturn [];\n\t\t}\n\n\t\treturn coalesce(response.body.map(item => this.toSymbolInformation(item)));\n\t}\n\n\tprivate get searchAllOpenProjects() {\n\t\treturn this.client.apiVersion.gte(API.v390)\n\t\t\t&& vscode.workspace.getConfiguration('typescript').get('workspaceSymbols.scope', 'allOpenProjects') === 'allOpenProjects';\n\t}\n\n\tprivate async toOpenedFiledPath(document: vscode.TextDocument) {\n\t\tif (document.uri.scheme === fileSchemes.git) {\n\t\t\ttry {\n\t\t\t\tconst path = vscode.Uri.file(JSON.parse(document.uri.query)?.path);\n\t\t\t\tif (doesResourceLookLikeATypeScriptFile(path) || doesResourceLookLikeAJavaScriptFile(path)) {\n\t\t\t\t\tconst document = await vscode.workspace.openTextDocument(path);\n\t\t\t\t\treturn this.client.toOpenTsFilePath(document);\n\t\t\t\t}\n\t\t\t} catch {\n\t\t\t\t// noop\n\t\t\t}\n\t\t}\n\t\treturn this.client.toOpenTsFilePath(document);\n\t}\n\n\tprivate toSymbolInformation(item: Proto.NavtoItem): vscode.SymbolInformation | undefined {\n\t\tif (item.kind === 'alias' && !item.containerName) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst uri = this.client.toResource(item.file);\n\t\tif (fileSchemes.isOfScheme(uri, fileSchemes.chatCodeBlock)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst label = TypeScriptWorkspaceSymbolProvider.getLabel(item);\n\t\tconst info = new vscode.SymbolInformation(\n\t\t\tlabel,\n\t\t\tgetSymbolKind(item),\n\t\t\titem.containerName || '',\n\t\t\ttypeConverters.Location.fromTextSpan(uri, item));\n\t\tconst kindModifiers = item.kindModifiers ? parseKindModifier(item.kindModifiers) : undefined;\n\t\tif (kindModifiers?.has(PConst.KindModifiers.deprecated)) {\n\t\t\tinfo.tags = [vscode.SymbolTag.Deprecated];\n\t\t}\n\t\treturn info;\n\t}\n\n\tprivate static getLabel(item: Proto.NavtoItem) {\n\t\tconst label = item.name;\n\t\tif (item.kind === 'method' || item.kind === 'function') {\n\t\t\treturn label + '()';\n\t\t}\n\t\treturn label;\n\t}\n\n\tprivate getDocument(): vscode.TextDocument | undefined {\n\t\t// typescript wants to have a resource even when asking\n\t\t// general questions so we check the active editor. If this\n\t\t// doesn't match we take the first TS document.\n\n\t\tconst activeDocument = vscode.window.activeTextEditor?.document;\n\t\tif (activeDocument) {\n\t\t\tif (this.modeIds.includes(activeDocument.languageId)) {\n\t\t\t\treturn activeDocument;\n\t\t\t}\n\t\t}\n\n\t\tconst documents = vscode.workspace.textDocuments;\n\t\tfor (const document of documents) {\n\t\t\tif (this.modeIds.includes(document.languageId)) {\n\t\t\t\treturn document;\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nexport function register(\n\tclient: ITypeScriptServiceClient,\n\tmodeIds: readonly string[],\n) {\n\treturn vscode.languages.registerWorkspaceSymbolProvider(\n\t\tnew TypeScriptWorkspaceSymbolProvider(client, modeIds));\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { basename, extname } from 'path';\nimport * as vscode from 'vscode';\nimport { CommandManager } from './commands/commandManager';\nimport { DocumentSelector } from './configuration/documentSelector';\nimport * as fileSchemes from './configuration/fileSchemes';\nimport { LanguageDescription } from './configuration/languageDescription';\nimport { Schemes } from './configuration/schemes';\nimport { DiagnosticKind } from './languageFeatures/diagnostics';\nimport FileConfigurationManager from './languageFeatures/fileConfigurationManager';\nimport { TelemetryReporter } from './logging/telemetry';\nimport { CachedResponse } from './tsServer/cachedResponse';\nimport { ClientCapability } from './typescriptService';\nimport TypeScriptServiceClient from './typescriptServiceClient';\nimport TypingsStatus from './ui/typingsStatus';\nimport { Disposable } from './utils/dispose';\nimport { isWeb, isWebAndHasSharedArrayBuffers, supportsReadableByteStreams } from './utils/platform';\n\n\nconst validateSetting = 'validate.enable';\nconst suggestionSetting = 'suggestionActions.enabled';\n\nexport default class LanguageProvider extends Disposable {\n\n\tconstructor(\n\t\tprivate readonly client: TypeScriptServiceClient,\n\t\tprivate readonly description: LanguageDescription,\n\t\tprivate readonly commandManager: CommandManager,\n\t\tprivate readonly telemetryReporter: TelemetryReporter,\n\t\tprivate readonly typingsStatus: TypingsStatus,\n\t\tprivate readonly fileConfigurationManager: FileConfigurationManager,\n\t\tprivate readonly onCompletionAccepted: (item: vscode.CompletionItem) => void,\n\t) {\n\t\tsuper();\n\t\tvscode.workspace.onDidChangeConfiguration(this.configurationChanged, this, this._disposables);\n\t\tthis.configurationChanged();\n\n\t\tclient.onReady(() => this.registerProviders());\n\t}\n\n\tprivate get documentSelector(): DocumentSelector {\n\t\tconst semantic: vscode.DocumentFilter[] = [];\n\t\tconst syntax: vscode.DocumentFilter[] = [];\n\t\tfor (const language of this.description.languageIds) {\n\t\t\tsyntax.push({ language });\n\t\t\tfor (const scheme of fileSchemes.getSemanticSupportedSchemes()) {\n\t\t\t\tsemantic.push({ language, scheme });\n\t\t\t}\n\t\t}\n\n\t\treturn { semantic, syntax };\n\t}\n\n\tprivate async registerProviders(): Promise<void> {\n\t\tconst selector = this.documentSelector;\n\n\t\tconst cachedNavTreeResponse = new CachedResponse();\n\n\t\tawait Promise.all([\n\t\t\timport('./languageFeatures/callHierarchy').then(provider => this._register(provider.register(selector, this.client))),\n\t\t\timport('./languageFeatures/codeLens/implementationsCodeLens').then(provider => this._register(provider.register(selector, this.description, this.client, cachedNavTreeResponse))),\n\t\t\timport('./languageFeatures/codeLens/referencesCodeLens').then(provider => this._register(provider.register(selector, this.description, this.client, cachedNavTreeResponse))),\n\t\t\timport('./languageFeatures/completions').then(provider => this._register(provider.register(selector, this.description, this.client, this.typingsStatus, this.fileConfigurationManager, this.commandManager, this.telemetryReporter, this.onCompletionAccepted))),\n\t\t\timport('./languageFeatures/copyPaste').then(provider => this._register(provider.register(selector, this.description, this.client, this.fileConfigurationManager))),\n\t\t\timport('./languageFeatures/definitions').then(provider => this._register(provider.register(selector, this.client))),\n\t\t\timport('./languageFeatures/directiveCommentCompletions').then(provider => this._register(provider.register(selector, this.client))),\n\t\t\timport('./languageFeatures/documentHighlight').then(provider => this._register(provider.register(selector, this.client))),\n\t\t\timport('./languageFeatures/documentSymbol').then(provider => this._register(provider.register(selector, this.client, cachedNavTreeResponse))),\n\t\t\timport('./languageFeatures/fileReferences').then(provider => this._register(provider.register(this.client, this.commandManager))),\n\t\t\timport('./languageFeatures/fixAll').then(provider => this._register(provider.register(selector, this.client, this.fileConfigurationManager, this.client.diagnosticsManager))),\n\t\t\timport('./languageFeatures/folding').then(provider => this._register(provider.register(selector, this.client))),\n\t\t\timport('./languageFeatures/formatting').then(provider => this._register(provider.register(selector, this.description, this.client, this.fileConfigurationManager))),\n\t\t\timport('./languageFeatures/hover').then(provider => this._register(provider.register(selector, this.client, this.fileConfigurationManager))),\n\t\t\timport('./languageFeatures/implementations').then(provider => this._register(provider.register(selector, this.client))),\n\t\t\timport('./languageFeatures/inlayHints').then(provider => this._register(provider.register(selector, this.description, this.client, this.fileConfigurationManager, this.telemetryReporter))),\n\t\t\timport('./languageFeatures/jsDocCompletions').then(provider => this._register(provider.register(selector, this.description, this.client, this.fileConfigurationManager))),\n\t\t\timport('./languageFeatures/linkedEditing').then(provider => this._register(provider.register(selector, this.client))),\n\t\t\timport('./languageFeatures/organizeImports').then(provider => this._register(provider.register(selector, this.client, this.commandManager, this.fileConfigurationManager, this.telemetryReporter))),\n\t\t\timport('./languageFeatures/quickFix').then(provider => this._register(provider.register(selector, this.client, this.fileConfigurationManager, this.commandManager, this.client.diagnosticsManager, this.telemetryReporter))),\n\t\t\timport('./languageFeatures/refactor').then(provider => this._register(provider.register(selector, this.client, cachedNavTreeResponse, this.fileConfigurationManager, this.commandManager, this.telemetryReporter))),\n\t\t\timport('./languageFeatures/references').then(provider => this._register(provider.register(selector, this.client))),\n\t\t\timport('./languageFeatures/rename').then(provider => this._register(provider.register(selector, this.description, this.client, this.fileConfigurationManager))),\n\t\t\timport('./languageFeatures/semanticTokens').then(provider => this._register(provider.register(selector, this.client))),\n\t\t\timport('./languageFeatures/signatureHelp').then(provider => this._register(provider.register(selector, this.client))),\n\t\t\timport('./languageFeatures/smartSelect').then(provider => this._register(provider.register(selector, this.client))),\n\t\t\timport('./languageFeatures/sourceDefinition').then(provider => this._register(provider.register(this.client, this.commandManager))),\n\t\t\timport('./languageFeatures/tagClosing').then(provider => this._register(provider.register(selector, this.description, this.client))),\n\t\t\timport('./languageFeatures/typeDefinitions').then(provider => this._register(provider.register(selector, this.client))),\n\t\t]);\n\t}\n\n\tprivate configurationChanged(): void {\n\t\tconst config = vscode.workspace.getConfiguration(this.id, null);\n\t\tthis.updateValidate(config.get(validateSetting, true));\n\t\tthis.updateSuggestionDiagnostics(config.get(suggestionSetting, true));\n\t}\n\n\tpublic handlesUri(resource: vscode.Uri): boolean {\n\t\tconst ext = extname(resource.path).slice(1).toLowerCase();\n\t\treturn this.description.standardFileExtensions.includes(ext) || this.handlesConfigFile(resource);\n\t}\n\n\tpublic handlesDocument(doc: vscode.TextDocument): boolean {\n\t\treturn this.description.languageIds.includes(doc.languageId) || this.handlesConfigFile(doc.uri);\n\t}\n\n\tprivate handlesConfigFile(resource: vscode.Uri) {\n\t\tconst base = basename(resource.fsPath);\n\t\treturn !!base && (!!this.description.configFilePattern && this.description.configFilePattern.test(base));\n\t}\n\n\tprivate get id(): string {\n\t\treturn this.description.id;\n\t}\n\n\tpublic get diagnosticSource(): string {\n\t\treturn this.description.diagnosticSource;\n\t}\n\n\tprivate updateValidate(value: boolean) {\n\t\tthis.client.diagnosticsManager.setValidate(this._diagnosticLanguage, value);\n\t}\n\n\tprivate updateSuggestionDiagnostics(value: boolean) {\n\t\tthis.client.diagnosticsManager.setEnableSuggestions(this._diagnosticLanguage, value);\n\t}\n\n\tpublic reInitialize(): void {\n\t\tthis.client.diagnosticsManager.reInitialize();\n\t}\n\n\tpublic triggerAllDiagnostics(): void {\n\t\tthis.client.bufferSyncSupport.requestAllDiagnostics();\n\t}\n\n\tpublic diagnosticsReceived(\n\t\tdiagnosticsKind: DiagnosticKind,\n\t\tfile: vscode.Uri,\n\t\tdiagnostics: (vscode.Diagnostic & { reportUnnecessary: any; reportDeprecated: any })[],\n\t\tranges: vscode.Range[] | undefined): void {\n\t\tif (diagnosticsKind !== DiagnosticKind.Syntax && !this.client.hasCapabilityForResource(file, ClientCapability.Semantic)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (diagnosticsKind === DiagnosticKind.Semantic && isWeb()) {\n\t\t\tif (\n\t\t\t\t!isWebAndHasSharedArrayBuffers()\n\t\t\t\t|| !supportsReadableByteStreams() // No ata. Will result in lots of false positives\n\t\t\t\t|| this.client.configuration.webProjectWideIntellisenseSuppressSemanticErrors\n\t\t\t\t|| !this.client.configuration.webProjectWideIntellisenseEnabled\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// Disable semantic errors in notebooks until we have better notebook support\n\t\tif (diagnosticsKind === DiagnosticKind.Semantic && file.scheme === Schemes.notebookCell) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst config = vscode.workspace.getConfiguration(this.id, file);\n\t\tconst reportUnnecessary = config.get<boolean>('showUnused', true);\n\t\tconst reportDeprecated = config.get<boolean>('showDeprecated', true);\n\t\tthis.client.diagnosticsManager.updateDiagnostics(file, this._diagnosticLanguage, diagnosticsKind, diagnostics.filter(diag => {\n\t\t\t// Don't bother reporting diagnostics we know will not be rendered\n\t\t\tif (!reportUnnecessary) {\n\t\t\t\tif (diag.reportUnnecessary && diag.severity === vscode.DiagnosticSeverity.Hint) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!reportDeprecated) {\n\t\t\t\tif (diag.reportDeprecated && diag.severity === vscode.DiagnosticSeverity.Hint) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}), ranges);\n\t}\n\n\tpublic configFileDiagnosticsReceived(file: vscode.Uri, diagnostics: vscode.Diagnostic[]): void {\n\t\tthis.client.diagnosticsManager.configFileDiagnosticsReceived(file, diagnostics);\n\t}\n\n\tprivate get _diagnosticLanguage() {\n\t\treturn this.description.diagnosticLanguage;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { CommandManager } from './commands/commandManager';\nimport { IExperimentationTelemetryReporter } from './experimentTelemetryReporter';\nimport { OngoingRequestCancellerFactory } from './tsServer/cancellation';\nimport { ILogDirectoryProvider } from './tsServer/logDirectoryProvider';\nimport { TsServerProcessFactory } from './tsServer/server';\nimport { ITypeScriptVersionProvider } from './tsServer/versionProvider';\nimport TypeScriptServiceClientHost from './typeScriptServiceClientHost';\nimport { ActiveJsTsEditorTracker } from './ui/activeJsTsEditorTracker';\nimport ManagedFileContextManager from './ui/managedFileContext';\nimport { ServiceConfigurationProvider } from './configuration/configuration';\nimport * as fileSchemes from './configuration/fileSchemes';\nimport { standardLanguageDescriptions, isJsConfigOrTsConfigFileName } from './configuration/languageDescription';\nimport { Lazy } from './utils/lazy';\nimport { Logger } from './logging/logger';\nimport { PluginManager } from './tsServer/plugins';\n\nexport function createLazyClientHost(\n\tcontext: vscode.ExtensionContext,\n\tonCaseInsensitiveFileSystem: boolean,\n\tservices: {\n\t\tpluginManager: PluginManager;\n\t\tcommandManager: CommandManager;\n\t\tlogDirectoryProvider: ILogDirectoryProvider;\n\t\tcancellerFactory: OngoingRequestCancellerFactory;\n\t\tversionProvider: ITypeScriptVersionProvider;\n\t\tprocessFactory: TsServerProcessFactory;\n\t\tactiveJsTsEditorTracker: ActiveJsTsEditorTracker;\n\t\tserviceConfigurationProvider: ServiceConfigurationProvider;\n\t\texperimentTelemetryReporter: IExperimentationTelemetryReporter | undefined;\n\t\tlogger: Logger;\n\t},\n\tonCompletionAccepted: (item: vscode.CompletionItem) => void,\n): Lazy<TypeScriptServiceClientHost> {\n\treturn new Lazy(() => {\n\t\tconst clientHost = new TypeScriptServiceClientHost(\n\t\t\tstandardLanguageDescriptions,\n\t\t\tcontext,\n\t\t\tonCaseInsensitiveFileSystem,\n\t\t\tservices,\n\t\t\tonCompletionAccepted);\n\n\t\tcontext.subscriptions.push(clientHost);\n\n\t\treturn clientHost;\n\t});\n}\n\nexport function lazilyActivateClient(\n\tlazyClientHost: Lazy<TypeScriptServiceClientHost>,\n\tpluginManager: PluginManager,\n\tactiveJsTsEditorTracker: ActiveJsTsEditorTracker,\n\tonActivate: () => Promise<void> = () => Promise.resolve(),\n): vscode.Disposable {\n\tconst disposables: vscode.Disposable[] = [];\n\n\tconst supportedLanguage = [\n\t\t...standardLanguageDescriptions.map(x => x.languageIds),\n\t\t...pluginManager.plugins.map(x => x.languages)\n\t].flat();\n\n\tlet hasActivated = false;\n\tconst maybeActivate = (textDocument: vscode.TextDocument): boolean => {\n\t\tif (!hasActivated && isSupportedDocument(supportedLanguage, textDocument)) {\n\t\t\thasActivated = true;\n\n\t\t\tonActivate().then(() => {\n\t\t\t\t// Force activation\n\t\t\t\tvoid lazyClientHost.value;\n\n\t\t\t\tdisposables.push(new ManagedFileContextManager(activeJsTsEditorTracker));\n\t\t\t});\n\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t};\n\n\tconst didActivate = vscode.workspace.textDocuments.some(maybeActivate);\n\tif (!didActivate) {\n\t\tconst openListener = vscode.workspace.onDidOpenTextDocument(doc => {\n\t\t\tif (maybeActivate(doc)) {\n\t\t\t\topenListener.dispose();\n\t\t\t}\n\t\t}, undefined, disposables);\n\t}\n\n\treturn vscode.Disposable.from(...disposables);\n}\n\nfunction isSupportedDocument(\n\tsupportedLanguage: readonly string[],\n\tdocument: vscode.TextDocument\n): boolean {\n\treturn (supportedLanguage.indexOf(document.languageId) >= 0 || isJsConfigOrTsConfigFileName(document.fileName))\n\t\t&& !fileSchemes.disabledSchemes.has(document.uri.scheme);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { TsServerLogLevel } from '../configuration/configuration';\nimport { Disposable } from '../utils/dispose';\n\n\nexport class LogLevelMonitor extends Disposable {\n\n\tprivate static readonly logLevelConfigKey = 'typescript.tsserver.log';\n\tprivate static readonly logLevelChangedStorageKey = 'typescript.tsserver.logLevelChanged';\n\tprivate static readonly doNotPromptLogLevelStorageKey = 'typescript.tsserver.doNotPromptLogLevel';\n\n\tconstructor(private readonly context: vscode.ExtensionContext) {\n\t\tsuper();\n\n\t\tthis._register(vscode.workspace.onDidChangeConfiguration(this.onConfigurationChange, this, this._disposables));\n\n\t\tif (this.shouldNotifyExtendedLogging()) {\n\t\t\tthis.notifyExtendedLogging();\n\t\t}\n\t}\n\n\tprivate onConfigurationChange(event: vscode.ConfigurationChangeEvent) {\n\t\tconst logLevelChanged = event.affectsConfiguration(LogLevelMonitor.logLevelConfigKey);\n\t\tif (!logLevelChanged) {\n\t\t\treturn;\n\t\t}\n\t\tthis.context.globalState.update(LogLevelMonitor.logLevelChangedStorageKey, new Date());\n\t}\n\n\tprivate get logLevel(): TsServerLogLevel {\n\t\treturn TsServerLogLevel.fromString(vscode.workspace.getConfiguration().get<string>(LogLevelMonitor.logLevelConfigKey, 'off'));\n\t}\n\n\t/**\n\t * Last date change if it exists and can be parsed as a date,\n\t * otherwise undefined.\n\t */\n\tprivate get lastLogLevelChange(): Date | undefined {\n\t\tconst lastChange = this.context.globalState.get<string | undefined>(LogLevelMonitor.logLevelChangedStorageKey);\n\n\t\tif (lastChange) {\n\t\t\tconst date = new Date(lastChange);\n\t\t\tif (date instanceof Date && !isNaN(date.valueOf())) {\n\t\t\t\treturn date;\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate get doNotPrompt(): boolean {\n\t\treturn this.context.globalState.get<boolean | undefined>(LogLevelMonitor.doNotPromptLogLevelStorageKey) || false;\n\t}\n\n\tprivate shouldNotifyExtendedLogging(): boolean {\n\t\tconst lastChangeMilliseconds = this.lastLogLevelChange ? new Date(this.lastLogLevelChange).valueOf() : 0;\n\t\tconst lastChangePlusOneWeek = new Date(lastChangeMilliseconds + /* 7 days in milliseconds */ 86400000 * 7);\n\n\t\tif (!this.doNotPrompt && this.logLevel !== TsServerLogLevel.Off && lastChangePlusOneWeek.valueOf() < Date.now()) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate notifyExtendedLogging() {\n\t\tconst enum Choice {\n\t\t\tDisableLogging = 0,\n\t\t\tDoNotShowAgain = 1\n\t\t}\n\t\tinterface Item extends vscode.MessageItem {\n\t\t\treadonly choice: Choice;\n\t\t}\n\n\t\tvscode.window.showInformationMessage<Item>(\n\t\t\tvscode.l10n.t(\"TS Server logging is currently enabled which may impact performance.\"),\n\t\t\t{\n\t\t\t\ttitle: vscode.l10n.t(\"Disable logging\"),\n\t\t\t\tchoice: Choice.DisableLogging\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: vscode.l10n.t(\"Don't show again\"),\n\t\t\t\tchoice: Choice.DoNotShowAgain\n\t\t\t})\n\t\t\t.then(selection => {\n\t\t\t\tif (!selection) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (selection.choice === Choice.DisableLogging) {\n\t\t\t\t\treturn vscode.workspace.getConfiguration().update(LogLevelMonitor.logLevelConfigKey, 'off', true);\n\t\t\t\t} else if (selection.choice === Choice.DoNotShowAgain) {\n\t\t\t\t\treturn this.context.globalState.update(LogLevelMonitor.doNotPromptLogLevelStorageKey, true);\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t});\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { memoize } from '../utils/memoize';\n\nexport class Logger {\n\n\t@memoize\n\tprivate get output(): vscode.LogOutputChannel {\n\t\treturn vscode.window.createOutputChannel('TypeScript', { log: true });\n\t}\n\n\tpublic get logLevel(): vscode.LogLevel {\n\t\treturn this.output.logLevel;\n\t}\n\n\tpublic info(message: string, ...args: any[]): void {\n\t\tthis.output.info(message, ...args);\n\t}\n\n\tpublic trace(message: string, ...args: any[]): void {\n\t\tthis.output.trace(message, ...args);\n\t}\n\n\tpublic error(message: string, data?: any): void {\n\t\t// See https://github.com/microsoft/TypeScript/issues/10496\n\t\tif (data && data.message === 'No content available.') {\n\t\t\treturn;\n\t\t}\n\t\tthis.output.error(message, ...(data ? [data] : []));\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IExperimentationTelemetryReporter } from '../experimentTelemetryReporter';\n\nexport interface TelemetryProperties {\n\treadonly [prop: string]: string | number | boolean | undefined;\n}\n\nexport interface TelemetryReporter {\n\tlogTelemetry(eventName: string, properties?: TelemetryProperties): void;\n}\n\nexport class VSCodeTelemetryReporter implements TelemetryReporter {\n\tconstructor(\n\t\tprivate readonly reporter: IExperimentationTelemetryReporter | undefined,\n\t\tprivate readonly clientVersionDelegate: () => string\n\t) { }\n\n\tpublic logTelemetry(eventName: string, properties: { [prop: string]: string } = {}) {\n\t\tconst reporter = this.reporter;\n\t\tif (!reporter) {\n\t\t\treturn;\n\t\t}\n\n\t\t/* __GDPR__FRAGMENT__\n\t\t\t\"TypeScriptCommonProperties\" : {\n\t\t\t\t\"version\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n\t\t\t}\n\t\t*/\n\t\tproperties['version'] = this.clientVersionDelegate();\n\n\t\treporter.postEventObj(eventName, properties);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport type * as Proto from '../tsServer/protocol/protocol';\nimport { Disposable } from '../utils/dispose';\nimport { Logger } from './logger';\n\ninterface RequestExecutionMetadata {\n\treadonly queuingStartTime: number;\n}\n\nexport default class Tracer extends Disposable {\n\n\tconstructor(\n\t\tprivate readonly logger: Logger\n\t) {\n\t\tsuper();\n\t}\n\n\tpublic traceRequest(serverId: string, request: Proto.Request, responseExpected: boolean, queueLength: number): void {\n\t\tif (this.logger.logLevel === vscode.LogLevel.Trace) {\n\t\t\tthis.trace(serverId, `Sending request: ${request.command} (${request.seq}). Response expected: ${responseExpected ? 'yes' : 'no'}. Current queue length: ${queueLength}`, request.arguments);\n\t\t}\n\t}\n\n\tpublic traceResponse(serverId: string, response: Proto.Response, meta: RequestExecutionMetadata): void {\n\t\tif (this.logger.logLevel === vscode.LogLevel.Trace) {\n\t\t\tthis.trace(serverId, `Response received: ${response.command} (${response.request_seq}). Request took ${Date.now() - meta.queuingStartTime} ms. Success: ${response.success} ${!response.success ? '. Message: ' + response.message : ''}`, response.body);\n\t\t}\n\t}\n\n\tpublic traceRequestCompleted(serverId: string, command: string, request_seq: number, meta: RequestExecutionMetadata): any {\n\t\tif (this.logger.logLevel === vscode.LogLevel.Trace) {\n\t\t\tthis.trace(serverId, `Async response received: ${command} (${request_seq}). Request took ${Date.now() - meta.queuingStartTime} ms.`);\n\t\t}\n\t}\n\n\tpublic traceEvent(serverId: string, event: Proto.Event): void {\n\t\tif (this.logger.logLevel === vscode.LogLevel.Trace) {\n\t\t\tthis.trace(serverId, `Event received: ${event.event} (${event.seq}).`, event.body);\n\t\t}\n\t}\n\n\tpublic trace(serverId: string, message: string, data?: unknown): void {\n\t\tthis.logger.trace(`<${serverId}> ${message}`, ...(data ? [JSON.stringify(data, null, 4)] : []));\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Extension, extensions, Uri } from 'vscode';\n\nexport interface RemoteHubApi {\n\tgetProviderUri(uri: Uri): Uri;\n\tgetProviderRootUri(uri: Uri): Uri;\n\n\tgetVirtualUri(uri: Uri): Uri;\n\tgetVirtualWorkspaceUri(uri: Uri): Uri | undefined;\n\n\tloadWorkspaceContents?(workspaceUri: Uri): Promise<boolean>;\n}\n\nnamespace RemoteRepositories {\n\n\tlet remoteHub: Extension<RemoteHubApi> | undefined;\n\n\tfunction getRemoteExtension(): Extension<RemoteHubApi> {\n\t\tif (remoteHub !== undefined) {\n\t\t\treturn remoteHub;\n\t\t}\n\n\t\tremoteHub = extensions.getExtension<RemoteHubApi>('ms-vscode.remote-repositories')\n\t\t\t?? extensions.getExtension<RemoteHubApi>('GitHub.remoteHub')\n\t\t\t?? extensions.getExtension<RemoteHubApi>('GitHub.remoteHub-insiders');\n\n\t\tif (remoteHub === undefined) {\n\t\t\tthrow new Error(`No Remote repository extension found.`);\n\t\t}\n\t\treturn remoteHub;\n\t}\n\n\texport function getApi(): Thenable<RemoteHubApi> {\n\t\treturn getRemoteExtension().activate();\n\t}\n}\n\nexport default RemoteRepositories;\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as semver from 'semver';\nimport * as vscode from 'vscode';\n\n\nexport class API {\n\tpublic static fromSimpleString(value: string): API {\n\t\treturn new API(value, value, value);\n\t}\n\n\tpublic static readonly defaultVersion = API.fromSimpleString('1.0.0');\n\tpublic static readonly v380 = API.fromSimpleString('3.8.0');\n\tpublic static readonly v390 = API.fromSimpleString('3.9.0');\n\tpublic static readonly v400 = API.fromSimpleString('4.0.0');\n\tpublic static readonly v401 = API.fromSimpleString('4.0.1');\n\tpublic static readonly v420 = API.fromSimpleString('4.2.0');\n\tpublic static readonly v430 = API.fromSimpleString('4.3.0');\n\tpublic static readonly v440 = API.fromSimpleString('4.4.0');\n\tpublic static readonly v460 = API.fromSimpleString('4.6.0');\n\tpublic static readonly v470 = API.fromSimpleString('4.7.0');\n\tpublic static readonly v490 = API.fromSimpleString('4.9.0');\n\tpublic static readonly v500 = API.fromSimpleString('5.0.0');\n\tpublic static readonly v510 = API.fromSimpleString('5.1.0');\n\tpublic static readonly v520 = API.fromSimpleString('5.2.0');\n\tpublic static readonly v544 = API.fromSimpleString('5.4.4');\n\tpublic static readonly v540 = API.fromSimpleString('5.4.0');\n\tpublic static readonly v560 = API.fromSimpleString('5.6.0');\n\tpublic static readonly v570 = API.fromSimpleString('5.7.0');\n\n\tpublic static fromVersionString(versionString: string): API {\n\t\tlet version = semver.valid(versionString);\n\t\tif (!version) {\n\t\t\treturn new API(vscode.l10n.t(\"invalid version\"), '1.0.0', '1.0.0');\n\t\t}\n\n\t\t// Cut off any prerelease tag since we sometimes consume those on purpose.\n\t\tconst index = versionString.indexOf('-');\n\t\tif (index >= 0) {\n\t\t\tversion = version.substr(0, index);\n\t\t}\n\t\treturn new API(versionString, version, versionString);\n\t}\n\n\tprivate constructor(\n\t\t/**\n\t\t * Human readable string for the current version. Displayed in the UI\n\t\t */\n\t\tpublic readonly displayName: string,\n\n\t\t/**\n\t\t * Semver version, e.g. '3.9.0'\n\t\t */\n\t\tpublic readonly version: string,\n\n\t\t/**\n\t\t * Full version string including pre-release tags, e.g. '3.9.0-beta'\n\t\t */\n\t\tpublic readonly fullVersionString: string,\n\t) { }\n\n\tpublic eq(other: API): boolean {\n\t\treturn semver.eq(this.version, other.version);\n\t}\n\n\tpublic gte(other: API): boolean {\n\t\treturn semver.gte(this.version, other.version);\n\t}\n\n\tpublic lt(other: API): boolean {\n\t\treturn !this.gte(other);\n\t}\n\n\tpublic isYarnPnp(): boolean {\n\t\treturn this.fullVersionString.includes('-sdk');\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as fileSchemes from '../configuration/fileSchemes';\nimport * as languageModeIds from '../configuration/languageIds';\nimport * as typeConverters from '../typeConverters';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport { inMemoryResourcePrefix } from '../typescriptServiceClient';\nimport { coalesce } from '../utils/arrays';\nimport { Delayer, setImmediate } from '../utils/async';\nimport { nulToken } from '../utils/cancellation';\nimport { Disposable } from '../utils/dispose';\nimport { ResourceMap } from '../utils/resourceMap';\nimport { API } from './api';\nimport type * as Proto from './protocol/protocol';\n\ntype ScriptKind = 'TS' | 'TSX' | 'JS' | 'JSX';\n\nfunction mode2ScriptKind(mode: string): ScriptKind | undefined {\n\tswitch (mode) {\n\t\tcase languageModeIds.typescript: return 'TS';\n\t\tcase languageModeIds.typescriptreact: return 'TSX';\n\t\tcase languageModeIds.javascript: return 'JS';\n\t\tcase languageModeIds.javascriptreact: return 'JSX';\n\t}\n\treturn undefined;\n}\n\nconst enum BufferState { Initial, Open, Closed }\n\nconst enum BufferOperationType { Close, Open, Change }\n\nclass CloseOperation {\n\treadonly type = BufferOperationType.Close;\n\tconstructor(\n\t\tpublic readonly args: string,\n\t\tpublic readonly scriptKind: ScriptKind | undefined,\n\t) { }\n}\n\nclass OpenOperation {\n\treadonly type = BufferOperationType.Open;\n\tconstructor(\n\t\tpublic readonly args: Proto.OpenRequestArgs,\n\t\tpublic readonly scriptKind: ScriptKind | undefined,\n\t) { }\n}\n\nclass ChangeOperation {\n\treadonly type = BufferOperationType.Change;\n\tconstructor(\n\t\tpublic readonly args: Proto.FileCodeEdits\n\t) { }\n}\n\ntype BufferOperation = CloseOperation | OpenOperation | ChangeOperation;\n\n/**\n * Manages synchronization of buffers with the TS server.\n *\n * If supported, batches together file changes. This allows the TS server to more efficiently process changes.\n */\nclass BufferSynchronizer {\n\n\tprivate readonly _pending: ResourceMap<BufferOperation>;\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tpathNormalizer: (path: vscode.Uri) => string | undefined,\n\t\tonCaseInsensitiveFileSystem: boolean\n\t) {\n\t\tthis._pending = new ResourceMap<BufferOperation>(pathNormalizer, {\n\t\t\tonCaseInsensitiveFileSystem\n\t\t});\n\t}\n\n\tpublic open(resource: vscode.Uri, args: Proto.OpenRequestArgs) {\n\t\tthis.updatePending(resource, new OpenOperation(args, args.scriptKindName));\n\t}\n\n\t/**\n\t * @return Was the buffer open?\n\t */\n\tpublic close(resource: vscode.Uri, filepath: string, scriptKind: ScriptKind | undefined): boolean {\n\t\treturn this.updatePending(resource, new CloseOperation(filepath, scriptKind));\n\t}\n\n\tpublic change(resource: vscode.Uri, filepath: string, events: readonly vscode.TextDocumentContentChangeEvent[]) {\n\t\tif (!events.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.updatePending(resource, new ChangeOperation({\n\t\t\tfileName: filepath,\n\t\t\ttextChanges: events.map((change): Proto.CodeEdit => ({\n\t\t\t\tnewText: change.text,\n\t\t\t\tstart: typeConverters.Position.toLocation(change.range.start),\n\t\t\t\tend: typeConverters.Position.toLocation(change.range.end),\n\t\t\t})).reverse(), // Send the edits end-of-document to start-of-document order\n\t\t}));\n\t}\n\n\tpublic reset(): void {\n\t\tthis._pending.clear();\n\t}\n\n\tpublic beforeCommand(command: string): void {\n\t\tif (command === 'updateOpen') {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.flush();\n\t}\n\n\tprivate flush() {\n\t\tif (this._pending.size > 0) {\n\t\t\tconst closedFiles: string[] = [];\n\t\t\tconst openFiles: Proto.OpenRequestArgs[] = [];\n\t\t\tconst changedFiles: Proto.FileCodeEdits[] = [];\n\t\t\tfor (const change of this._pending.values()) {\n\t\t\t\tswitch (change.type) {\n\t\t\t\t\tcase BufferOperationType.Change: changedFiles.push(change.args); break;\n\t\t\t\t\tcase BufferOperationType.Open: openFiles.push(change.args); break;\n\t\t\t\t\tcase BufferOperationType.Close: closedFiles.push(change.args); break;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.client.execute('updateOpen', { changedFiles, closedFiles, openFiles }, nulToken, { nonRecoverable: true });\n\t\t\tthis._pending.clear();\n\t\t}\n\t}\n\n\tprivate updatePending(resource: vscode.Uri, op: BufferOperation): boolean {\n\t\tswitch (op.type) {\n\t\t\tcase BufferOperationType.Close: {\n\t\t\t\tconst existing = this._pending.get(resource);\n\t\t\t\tswitch (existing?.type) {\n\t\t\t\t\tcase BufferOperationType.Open:\n\t\t\t\t\t\tif (existing.scriptKind === op.scriptKind) {\n\t\t\t\t\t\t\tthis._pending.delete(resource);\n\t\t\t\t\t\t\treturn false; // Open then close. No need to do anything\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (this._pending.has(resource)) {\n\t\t\t// we saw this file before, make sure we flush before working with it again\n\t\t\tthis.flush();\n\t\t}\n\t\tthis._pending.set(resource, op);\n\t\treturn true;\n\t}\n}\n\nclass SyncedBuffer {\n\n\tprivate state = BufferState.Initial;\n\n\tconstructor(\n\t\tprivate readonly document: vscode.TextDocument,\n\t\tpublic readonly filepath: string,\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tprivate readonly synchronizer: BufferSynchronizer,\n\t) { }\n\n\tpublic open(): void {\n\t\tconst args: Proto.OpenRequestArgs = {\n\t\t\tfile: this.filepath,\n\t\t\tfileContent: this.document.getText(),\n\t\t\tprojectRootPath: this.getProjectRootPath(this.document.uri),\n\t\t};\n\n\t\tconst scriptKind = mode2ScriptKind(this.document.languageId);\n\t\tif (scriptKind) {\n\t\t\targs.scriptKindName = scriptKind;\n\t\t}\n\n\t\tconst tsPluginsForDocument = this.client.pluginManager.plugins\n\t\t\t.filter(x => x.languages.indexOf(this.document.languageId) >= 0);\n\n\t\tif (tsPluginsForDocument.length) {\n\t\t\t(args as any).plugins = tsPluginsForDocument.map(plugin => plugin.name);\n\t\t}\n\n\t\tthis.synchronizer.open(this.resource, args);\n\t\tthis.state = BufferState.Open;\n\t}\n\n\tprivate getProjectRootPath(resource: vscode.Uri): string | undefined {\n\t\tlet workspaceRoot = this.client.getWorkspaceRootForResource(resource);\n\n\t\t// If we didn't find a real workspace, we still want to try sending along a workspace folder\n\t\t// to prevent TS from loading projects from outside of any workspace.\n\t\t// Just pick the highest level one on the same FS even though the file is outside of it\n\t\tif (!workspaceRoot && vscode.workspace.workspaceFolders) {\n\t\t\tfor (const root of Array.from(vscode.workspace.workspaceFolders).sort((a, b) => a.uri.path.length - b.uri.path.length)) {\n\t\t\t\tif (root.uri.scheme === resource.scheme && root.uri.authority === resource.authority) {\n\t\t\t\t\tworkspaceRoot = root.uri;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (workspaceRoot) {\n\t\t\tconst tsRoot = this.client.toTsFilePath(workspaceRoot);\n\t\t\treturn tsRoot?.startsWith(inMemoryResourcePrefix) ? undefined : tsRoot;\n\t\t}\n\n\t\treturn fileSchemes.isOfScheme(resource, fileSchemes.officeScript, fileSchemes.chatCodeBlock) ? '/' : undefined;\n\t}\n\n\tpublic get resource(): vscode.Uri {\n\t\treturn this.document.uri;\n\t}\n\n\tpublic get lineCount(): number {\n\t\treturn this.document.lineCount;\n\t}\n\n\tpublic get languageId(): string {\n\t\treturn this.document.languageId;\n\t}\n\n\t/**\n\t * @return Was the buffer open?\n\t */\n\tpublic close(): boolean {\n\t\tif (this.state !== BufferState.Open) {\n\t\t\tthis.state = BufferState.Closed;\n\t\t\treturn false;\n\t\t}\n\t\tthis.state = BufferState.Closed;\n\t\treturn this.synchronizer.close(this.resource, this.filepath, mode2ScriptKind(this.document.languageId));\n\t}\n\n\tpublic onContentChanged(events: readonly vscode.TextDocumentContentChangeEvent[]): void {\n\t\tif (this.state !== BufferState.Open) {\n\t\t\tconsole.error(`Unexpected buffer state: ${this.state}`);\n\t\t}\n\n\t\tthis.synchronizer.change(this.resource, this.filepath, events);\n\t}\n}\n\nclass SyncedBufferMap extends ResourceMap<SyncedBuffer> {\n\n\tpublic getForPath(filePath: string): SyncedBuffer | undefined {\n\t\treturn this.get(vscode.Uri.file(filePath));\n\t}\n\n\tpublic get allBuffers(): Iterable<SyncedBuffer> {\n\t\treturn this.values();\n\t}\n}\n\nclass PendingDiagnostics extends ResourceMap<number> {\n\tpublic getOrderedFileSet(): ResourceMap<void | vscode.Range[]> {\n\t\tconst orderedResources = Array.from(this.entries())\n\t\t\t.sort((a, b) => a.value - b.value)\n\t\t\t.map(entry => entry.resource);\n\n\t\tconst map = new ResourceMap<void | vscode.Range[]>(this._normalizePath, this.config);\n\t\tfor (const resource of orderedResources) {\n\t\t\tmap.set(resource, undefined);\n\t\t}\n\t\treturn map;\n\t}\n}\n\nclass GetErrRequest {\n\n\tpublic static executeGetErrRequest(\n\t\tclient: ITypeScriptServiceClient,\n\t\tfiles: ResourceMap<void | vscode.Range[]>,\n\t\tonDone: () => void\n\t) {\n\t\treturn new GetErrRequest(client, files, onDone);\n\t}\n\n\tprivate _done: boolean = false;\n\tprivate readonly _token: vscode.CancellationTokenSource = new vscode.CancellationTokenSource();\n\n\tprivate constructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t\tpublic readonly files: ResourceMap<void | vscode.Range[]>,\n\t\tonDone: () => void\n\t) {\n\t\tif (!this.isErrorReportingEnabled()) {\n\t\t\tthis._done = true;\n\t\t\tsetImmediate(onDone);\n\t\t\treturn;\n\t\t}\n\n\t\tconst supportsSyntaxGetErr = this.client.apiVersion.gte(API.v440);\n\t\tconst fileEntries = Array.from(files.entries()).filter(entry => supportsSyntaxGetErr || client.hasCapabilityForResource(entry.resource, ClientCapability.Semantic));\n\t\tconst allFiles = coalesce(fileEntries\n\t\t\t.map(entry => client.toTsFilePath(entry.resource)));\n\n\t\tif (!allFiles.length) {\n\t\t\tthis._done = true;\n\t\t\tsetImmediate(onDone);\n\t\t} else {\n\t\t\tlet request;\n\t\t\tif (this.areProjectDiagnosticsEnabled()) {\n\t\t\t\t// Note that geterrForProject is almost certainly not the api we want here as it ends up computing far\n\t\t\t\t// too many diagnostics\n\t\t\t\trequest = client.executeAsync('geterrForProject', { delay: 0, file: allFiles[0] }, this._token.token);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlet requestFiles;\n\t\t\t\tif (this.areRegionDiagnosticsEnabled()) {\n\t\t\t\t\trequestFiles = coalesce(fileEntries\n\t\t\t\t\t\t.map(entry => {\n\t\t\t\t\t\t\tconst file = client.toTsFilePath(entry.resource);\n\t\t\t\t\t\t\tconst ranges = entry.value;\n\t\t\t\t\t\t\tif (file && ranges) {\n\t\t\t\t\t\t\t\treturn typeConverters.Range.toFileRangesRequestArgs(file, ranges);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn file;\n\t\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\trequestFiles = allFiles;\n\t\t\t\t}\n\t\t\t\trequest = client.executeAsync('geterr', { delay: 0, files: requestFiles }, this._token.token);\n\t\t\t}\n\n\t\t\trequest.finally(() => {\n\t\t\t\tif (this._done) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis._done = true;\n\t\t\t\tonDone();\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate isErrorReportingEnabled() {\n\t\tif (this.client.apiVersion.gte(API.v440)) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\t// Older TS versions only support `getErr` on semantic server\n\t\t\treturn this.client.capabilities.has(ClientCapability.Semantic);\n\t\t}\n\t}\n\n\tprivate areProjectDiagnosticsEnabled() {\n\t\treturn this.client.configuration.enableProjectDiagnostics && this.client.capabilities.has(ClientCapability.Semantic);\n\t}\n\n\tprivate areRegionDiagnosticsEnabled() {\n\t\treturn this.client.configuration.enableRegionDiagnostics && this.client.apiVersion.gte(API.v560);\n\t}\n\n\tpublic cancel(): any {\n\t\tif (!this._done) {\n\t\t\tthis._token.cancel();\n\t\t}\n\n\t\tthis._token.dispose();\n\t}\n}\n\nclass TabResourceTracker extends Disposable {\n\n\tprivate readonly _onDidChange = this._register(new vscode.EventEmitter<{\n\t\treadonly closed: Iterable<vscode.Uri>;\n\t\treadonly opened: Iterable<vscode.Uri>;\n\t}>());\n\tpublic readonly onDidChange = this._onDidChange.event;\n\n\tprivate readonly _tabResources: ResourceMap<{ readonly tabs: Set<vscode.Tab> }>;\n\n\tconstructor(\n\t\tnormalizePath: (resource: vscode.Uri) => string | undefined,\n\t\tconfig: {\n\t\t\treadonly onCaseInsensitiveFileSystem: boolean;\n\t\t},\n\t) {\n\t\tsuper();\n\n\t\tthis._tabResources = new ResourceMap<{ readonly tabs: Set<vscode.Tab> }>(normalizePath, config);\n\n\t\tfor (const tabGroup of vscode.window.tabGroups.all) {\n\t\t\tfor (const tab of tabGroup.tabs) {\n\t\t\t\tthis.add(tab);\n\t\t\t}\n\t\t}\n\n\t\tthis._register(vscode.window.tabGroups.onDidChangeTabs(e => {\n\t\t\tconst closed = e.closed.flatMap(tab => this.delete(tab));\n\t\t\tconst opened = e.opened.flatMap(tab => this.add(tab));\n\t\t\tif (closed.length || opened.length) {\n\t\t\t\tthis._onDidChange.fire({ closed, opened });\n\t\t\t}\n\t\t}));\n\t}\n\n\tpublic has(resource: vscode.Uri): boolean {\n\t\tif (resource.scheme === fileSchemes.vscodeNotebookCell) {\n\t\t\tconst notebook = vscode.workspace.notebookDocuments.find(doc =>\n\t\t\t\tdoc.getCells().some(cell => cell.document.uri.toString() === resource.toString()));\n\n\t\t\treturn !!notebook && this.has(notebook.uri);\n\t\t}\n\n\t\tconst entry = this._tabResources.get(resource);\n\t\treturn !!entry && entry.tabs.size > 0;\n\t}\n\n\tprivate add(tab: vscode.Tab): vscode.Uri[] {\n\t\tconst addedResources: vscode.Uri[] = [];\n\t\tfor (const uri of this.getResourcesForTab(tab)) {\n\t\t\tconst entry = this._tabResources.get(uri);\n\t\t\tif (entry) {\n\t\t\t\tentry.tabs.add(tab);\n\t\t\t} else {\n\t\t\t\tthis._tabResources.set(uri, { tabs: new Set([tab]) });\n\t\t\t\taddedResources.push(uri);\n\t\t\t}\n\t\t}\n\t\treturn addedResources;\n\t}\n\n\tprivate delete(tab: vscode.Tab): vscode.Uri[] {\n\t\tconst closedResources: vscode.Uri[] = [];\n\t\tfor (const uri of this.getResourcesForTab(tab)) {\n\t\t\tconst entry = this._tabResources.get(uri);\n\t\t\tif (!entry) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tentry.tabs.delete(tab);\n\t\t\tif (entry.tabs.size === 0) {\n\t\t\t\tthis._tabResources.delete(uri);\n\t\t\t\tclosedResources.push(uri);\n\t\t\t}\n\t\t}\n\t\treturn closedResources;\n\t}\n\n\tprivate getResourcesForTab(tab: vscode.Tab): vscode.Uri[] {\n\t\tif (tab.input instanceof vscode.TabInputText) {\n\t\t\treturn [tab.input.uri];\n\t\t} else if (tab.input instanceof vscode.TabInputTextDiff) {\n\t\t\treturn [tab.input.original, tab.input.modified];\n\t\t} else if (tab.input instanceof vscode.TabInputNotebook) {\n\t\t\treturn [tab.input.uri];\n\t\t} else {\n\t\t\treturn [];\n\t\t}\n\t}\n}\n\n\nexport default class BufferSyncSupport extends Disposable {\n\n\tprivate readonly client: ITypeScriptServiceClient;\n\n\tprivate _validateJavaScript = true;\n\tprivate _validateTypeScript = true;\n\n\tprivate readonly modeIds: Set<string>;\n\tprivate readonly syncedBuffers: SyncedBufferMap;\n\tprivate readonly pendingDiagnostics: PendingDiagnostics;\n\tprivate readonly diagnosticDelayer: Delayer<any>;\n\tprivate pendingGetErr: GetErrRequest | undefined;\n\tprivate listening: boolean = false;\n\tprivate readonly synchronizer: BufferSynchronizer;\n\n\tprivate readonly _tabResources: TabResourceTracker;\n\n\tconstructor(\n\t\tclient: ITypeScriptServiceClient,\n\t\tmodeIds: readonly string[],\n\t\tonCaseInsensitiveFileSystem: boolean\n\t) {\n\t\tsuper();\n\t\tthis.client = client;\n\t\tthis.modeIds = new Set<string>(modeIds);\n\n\t\tthis.diagnosticDelayer = new Delayer<any>(300);\n\n\t\tconst pathNormalizer = (path: vscode.Uri) => this.client.toTsFilePath(path);\n\t\tthis.syncedBuffers = new SyncedBufferMap(pathNormalizer, { onCaseInsensitiveFileSystem });\n\t\tthis.pendingDiagnostics = new PendingDiagnostics(pathNormalizer, { onCaseInsensitiveFileSystem });\n\t\tthis.synchronizer = new BufferSynchronizer(client, pathNormalizer, onCaseInsensitiveFileSystem);\n\n\t\tthis._tabResources = this._register(new TabResourceTracker(pathNormalizer, { onCaseInsensitiveFileSystem }));\n\t\tthis._register(this._tabResources.onDidChange(e => {\n\t\t\tif (this.client.configuration.enableProjectDiagnostics) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfor (const closed of e.closed) {\n\t\t\t\tconst syncedBuffer = this.syncedBuffers.get(closed);\n\t\t\t\tif (syncedBuffer) {\n\t\t\t\t\tthis.pendingDiagnostics.delete(closed);\n\t\t\t\t\tthis.pendingGetErr?.files.delete(closed);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const opened of e.opened) {\n\t\t\t\tconst syncedBuffer = this.syncedBuffers.get(opened);\n\t\t\t\tif (syncedBuffer) {\n\t\t\t\t\tthis.requestDiagnostic(syncedBuffer);\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tthis.updateConfiguration();\n\t\tvscode.workspace.onDidChangeConfiguration(this.updateConfiguration, this, this._disposables);\n\t}\n\n\tprivate readonly _onDelete = this._register(new vscode.EventEmitter<vscode.Uri>());\n\tpublic readonly onDelete = this._onDelete.event;\n\n\tprivate readonly _onWillChange = this._register(new vscode.EventEmitter<vscode.Uri>());\n\tpublic readonly onWillChange = this._onWillChange.event;\n\n\tpublic listen(): void {\n\t\tif (this.listening) {\n\t\t\treturn;\n\t\t}\n\t\tthis.listening = true;\n\t\tvscode.workspace.onDidOpenTextDocument(this.openTextDocument, this, this._disposables);\n\t\tvscode.workspace.onDidCloseTextDocument(this.onDidCloseTextDocument, this, this._disposables);\n\t\tvscode.workspace.onDidChangeTextDocument(this.onDidChangeTextDocument, this, this._disposables);\n\t\tvscode.window.onDidChangeVisibleTextEditors(e => {\n\t\t\tfor (const { document } of e) {\n\t\t\t\tconst syncedBuffer = this.syncedBuffers.get(document.uri);\n\t\t\t\tif (syncedBuffer) {\n\t\t\t\t\tthis.requestDiagnostic(syncedBuffer);\n\t\t\t\t}\n\t\t\t}\n\t\t}, this, this._disposables);\n\t\tvscode.workspace.textDocuments.forEach(this.openTextDocument, this);\n\t}\n\n\tpublic handles(resource: vscode.Uri): boolean {\n\t\treturn this.syncedBuffers.has(resource);\n\t}\n\n\tpublic ensureHasBuffer(resource: vscode.Uri): boolean {\n\t\tif (this.syncedBuffers.has(resource)) {\n\t\t\treturn true;\n\t\t}\n\n\t\tconst existingDocument = vscode.workspace.textDocuments.find(doc => doc.uri.toString() === resource.toString());\n\t\tif (existingDocument) {\n\t\t\treturn this.openTextDocument(existingDocument);\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tpublic toVsCodeResource(resource: vscode.Uri): vscode.Uri {\n\t\tconst filepath = this.client.toTsFilePath(resource);\n\t\tfor (const buffer of this.syncedBuffers.allBuffers) {\n\t\t\tif (buffer.filepath === filepath) {\n\t\t\t\treturn buffer.resource;\n\t\t\t}\n\t\t}\n\t\treturn resource;\n\t}\n\n\tpublic toResource(filePath: string): vscode.Uri {\n\t\tconst buffer = this.syncedBuffers.getForPath(filePath);\n\t\tif (buffer) {\n\t\t\treturn buffer.resource;\n\t\t}\n\t\treturn vscode.Uri.file(filePath);\n\t}\n\n\tpublic reset(): void {\n\t\tthis.pendingGetErr?.cancel();\n\t\tthis.pendingDiagnostics.clear();\n\t\tthis.synchronizer.reset();\n\t}\n\n\tpublic reinitialize(): void {\n\t\tthis.reset();\n\t\tfor (const buffer of this.syncedBuffers.allBuffers) {\n\t\t\tbuffer.open();\n\t\t}\n\t}\n\n\tpublic openTextDocument(document: vscode.TextDocument): boolean {\n\t\tif (!this.modeIds.has(document.languageId)) {\n\t\t\treturn false;\n\t\t}\n\t\tconst resource = document.uri;\n\t\tconst filepath = this.client.toTsFilePath(resource);\n\t\tif (!filepath) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.syncedBuffers.has(resource)) {\n\t\t\treturn true;\n\t\t}\n\n\t\tconst syncedBuffer = new SyncedBuffer(document, filepath, this.client, this.synchronizer);\n\t\tthis.syncedBuffers.set(resource, syncedBuffer);\n\t\tsyncedBuffer.open();\n\t\tthis.requestDiagnostic(syncedBuffer);\n\t\treturn true;\n\t}\n\n\tpublic closeResource(resource: vscode.Uri): void {\n\t\tconst syncedBuffer = this.syncedBuffers.get(resource);\n\t\tif (!syncedBuffer) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.pendingDiagnostics.delete(resource);\n\t\tthis.pendingGetErr?.files.delete(resource);\n\t\tthis.syncedBuffers.delete(resource);\n\t\tconst wasBufferOpen = syncedBuffer.close();\n\t\tthis._onDelete.fire(resource);\n\t\tif (wasBufferOpen) {\n\t\t\tthis.requestAllDiagnostics();\n\t\t}\n\t}\n\n\tpublic interruptGetErr<R>(f: () => R): R {\n\t\tif (!this.pendingGetErr\n\t\t\t|| this.client.configuration.enableProjectDiagnostics // `geterr` happens on separate server so no need to cancel it.\n\t\t) {\n\t\t\treturn f();\n\t\t}\n\n\t\tthis.pendingGetErr.cancel();\n\t\tthis.pendingGetErr = undefined;\n\t\tconst result = f();\n\t\tthis.triggerDiagnostics();\n\t\treturn result;\n\t}\n\n\tpublic beforeCommand(command: string): void {\n\t\tthis.synchronizer.beforeCommand(command);\n\t}\n\n\tpublic lineCount(resource: vscode.Uri): number | undefined {\n\t\treturn this.syncedBuffers.get(resource)?.lineCount;\n\t}\n\n\tprivate onDidCloseTextDocument(document: vscode.TextDocument): void {\n\t\tthis.closeResource(document.uri);\n\t}\n\n\tprivate onDidChangeTextDocument(e: vscode.TextDocumentChangeEvent): void {\n\t\tconst syncedBuffer = this.syncedBuffers.get(e.document.uri);\n\t\tif (!syncedBuffer) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._onWillChange.fire(syncedBuffer.resource);\n\n\t\tsyncedBuffer.onContentChanged(e.contentChanges);\n\t\tconst didTrigger = this.requestDiagnostic(syncedBuffer);\n\n\t\tif (!didTrigger && this.pendingGetErr) {\n\t\t\t// In this case we always want to re-trigger all diagnostics\n\t\t\tthis.pendingGetErr.cancel();\n\t\t\tthis.pendingGetErr = undefined;\n\t\t\tthis.triggerDiagnostics();\n\t\t}\n\t}\n\n\tpublic requestAllDiagnostics() {\n\t\tfor (const buffer of this.syncedBuffers.allBuffers) {\n\t\t\tif (this.shouldValidate(buffer)) {\n\t\t\t\tthis.pendingDiagnostics.set(buffer.resource, Date.now());\n\t\t\t}\n\t\t}\n\t\tthis.triggerDiagnostics();\n\t}\n\n\tpublic getErr(resources: readonly vscode.Uri[]): any {\n\t\tconst handledResources = resources.filter(resource => this.handles(resource));\n\t\tif (!handledResources.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const resource of handledResources) {\n\t\t\tthis.pendingDiagnostics.set(resource, Date.now());\n\t\t}\n\n\t\tthis.triggerDiagnostics();\n\t}\n\n\tprivate triggerDiagnostics(delay: number = 200) {\n\t\tthis.diagnosticDelayer.trigger(() => {\n\t\t\tthis.sendPendingDiagnostics();\n\t\t}, delay);\n\t}\n\n\tprivate requestDiagnostic(buffer: SyncedBuffer): boolean {\n\t\tif (!this.shouldValidate(buffer)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.pendingDiagnostics.set(buffer.resource, Date.now());\n\n\t\tconst delay = Math.min(Math.max(Math.ceil(buffer.lineCount / 20), 300), 800);\n\t\tthis.triggerDiagnostics(delay);\n\t\treturn true;\n\t}\n\n\tpublic hasPendingDiagnostics(resource: vscode.Uri): boolean {\n\t\treturn this.pendingDiagnostics.has(resource);\n\t}\n\n\tprivate sendPendingDiagnostics(): void {\n\t\tconst orderedFileSet = this.pendingDiagnostics.getOrderedFileSet();\n\n\t\tif (this.pendingGetErr) {\n\t\t\tthis.pendingGetErr.cancel();\n\n\t\t\tfor (const { resource } of this.pendingGetErr.files.entries()) {\n\t\t\t\tif (this.syncedBuffers.get(resource)) {\n\t\t\t\t\torderedFileSet.set(resource, undefined);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.pendingGetErr = undefined;\n\t\t}\n\n\t\t// Add all open TS buffers to the geterr request. They might be visible\n\t\tfor (const buffer of this.syncedBuffers.values()) {\n\t\t\tconst editors = vscode.window.visibleTextEditors.filter(editor => editor.document.uri.toString() === buffer.resource.toString());\n\t\t\tconst visibleRanges = editors.flatMap(editor => editor.visibleRanges);\n\t\t\torderedFileSet.set(buffer.resource, visibleRanges.length ? visibleRanges : undefined);\n\t\t}\n\n\t\tfor (const { resource } of orderedFileSet.entries()) {\n\t\t\tconst buffer = this.syncedBuffers.get(resource);\n\t\t\tif (buffer && !this.shouldValidate(buffer)) {\n\t\t\t\torderedFileSet.delete(resource);\n\t\t\t}\n\t\t}\n\n\t\tif (orderedFileSet.size) {\n\t\t\tconst getErr = this.pendingGetErr = GetErrRequest.executeGetErrRequest(this.client, orderedFileSet, () => {\n\t\t\t\tif (this.pendingGetErr === getErr) {\n\t\t\t\t\tthis.pendingGetErr = undefined;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.pendingDiagnostics.clear();\n\t}\n\n\tprivate updateConfiguration() {\n\t\tconst jsConfig = vscode.workspace.getConfiguration('javascript', null);\n\t\tconst tsConfig = vscode.workspace.getConfiguration('typescript', null);\n\n\t\tthis._validateJavaScript = jsConfig.get<boolean>('validate.enable', true);\n\t\tthis._validateTypeScript = tsConfig.get<boolean>('validate.enable', true);\n\t}\n\n\tprivate shouldValidate(buffer: SyncedBuffer): boolean {\n\t\tif (fileSchemes.isOfScheme(buffer.resource, fileSchemes.chatCodeBlock)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.client.configuration.enableProjectDiagnostics && !this._tabResources.has(buffer.resource)) { // Only validate resources that are showing to the user\n\t\t\treturn false;\n\t\t}\n\n\t\tswitch (buffer.languageId) {\n\t\t\tcase languageModeIds.javascript:\n\t\t\tcase languageModeIds.javascriptreact:\n\t\t\t\treturn this._validateJavaScript;\n\n\t\t\tcase languageModeIds.typescript:\n\t\t\tcase languageModeIds.typescriptreact:\n\t\t\tdefault:\n\t\t\t\treturn this._validateTypeScript;\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { ServerResponse } from '../typescriptService';\nimport type * as Proto from './protocol/protocol';\n\ntype Resolve<T extends Proto.Response> = () => Promise<ServerResponse.Response<T>>;\n\n/**\n * Caches a class of TS Server request based on document.\n */\nexport class CachedResponse<T extends Proto.Response> {\n\tprivate response?: Promise<ServerResponse.Response<T>>;\n\tprivate version: number = -1;\n\tprivate document: string = '';\n\n\t/**\n\t * Execute a request. May return cached value or resolve the new value\n\t *\n\t * Caller must ensure that all input `resolve` functions return equivilent results (keyed only off of document).\n\t */\n\tpublic execute(\n\t\tdocument: vscode.TextDocument,\n\t\tresolve: Resolve<T>\n\t): Promise<ServerResponse.Response<T>> {\n\t\tif (this.response && this.matches(document)) {\n\t\t\t// Chain so that on cancellation we fall back to the next resolve\n\t\t\treturn this.response = this.response.then(result => result.type === 'cancelled' ? resolve() : result);\n\t\t}\n\t\treturn this.reset(document, resolve);\n\t}\n\n\tprivate matches(document: vscode.TextDocument): boolean {\n\t\treturn this.version === document.version && this.document === document.uri.toString();\n\t}\n\n\tprivate async reset(\n\t\tdocument: vscode.TextDocument,\n\t\tresolve: Resolve<T>\n\t): Promise<ServerResponse.Response<T>> {\n\t\tthis.version = document.version;\n\t\tthis.document = document.uri.toString();\n\t\treturn this.response = resolve();\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ServerResponse } from '../typescriptService';\nimport type * as Proto from './protocol/protocol';\n\nexport interface CallbackItem<R> {\n\treadonly onSuccess: (value: R) => void;\n\treadonly onError: (err: Error) => void;\n\treadonly queuingStartTime: number;\n\treadonly isAsync: boolean;\n}\n\nexport class CallbackMap<R extends Proto.Response> {\n\tprivate readonly _callbacks = new Map<number, CallbackItem<ServerResponse.Response<R> | undefined>>();\n\tprivate readonly _asyncCallbacks = new Map<number, CallbackItem<ServerResponse.Response<R> | undefined>>();\n\n\tpublic destroy(cause: string): void {\n\t\tconst cancellation = new ServerResponse.Cancelled(cause);\n\t\tfor (const callback of this._callbacks.values()) {\n\t\t\tcallback.onSuccess(cancellation);\n\t\t}\n\t\tthis._callbacks.clear();\n\t\tfor (const callback of this._asyncCallbacks.values()) {\n\t\t\tcallback.onSuccess(cancellation);\n\t\t}\n\t\tthis._asyncCallbacks.clear();\n\t}\n\n\tpublic add(seq: number, callback: CallbackItem<ServerResponse.Response<R> | undefined>, isAsync: boolean) {\n\t\tif (isAsync) {\n\t\t\tthis._asyncCallbacks.set(seq, callback);\n\t\t} else {\n\t\t\tthis._callbacks.set(seq, callback);\n\t\t}\n\t}\n\n\tpublic fetch(seq: number): CallbackItem<ServerResponse.Response<R> | undefined> | undefined {\n\t\tconst callback = this._callbacks.get(seq) || this._asyncCallbacks.get(seq);\n\t\tthis.delete(seq);\n\t\treturn callback;\n\t}\n\n\tprivate delete(seq: number) {\n\t\tif (!this._callbacks.delete(seq)) {\n\t\t\tthis._asyncCallbacks.delete(seq);\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport Tracer from '../logging/tracer';\n\nexport interface OngoingRequestCanceller {\n\treadonly cancellationPipeName: string | undefined;\n\ttryCancelOngoingRequest(seq: number): boolean;\n}\n\nexport interface OngoingRequestCancellerFactory {\n\tcreate(serverId: string, tracer: Tracer): OngoingRequestCanceller;\n}\n\nconst noopRequestCanceller = new class implements OngoingRequestCanceller {\n\tpublic readonly cancellationPipeName = undefined;\n\n\tpublic tryCancelOngoingRequest(_seq: number): boolean {\n\t\treturn false;\n\t}\n};\n\nexport const noopRequestCancellerFactory = new class implements OngoingRequestCancellerFactory {\n\tcreate(_serverId: string, _tracer: Tracer): OngoingRequestCanceller {\n\t\treturn noopRequestCanceller;\n\t}\n};\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { Utils } from 'vscode-uri';\nimport { Schemes } from '../configuration/schemes';\nimport { Logger } from '../logging/logger';\nimport { disposeAll, IDisposable } from '../utils/dispose';\nimport { ResourceMap } from '../utils/resourceMap';\n\ninterface DirWatcherEntry {\n\treadonly uri: vscode.Uri;\n\treadonly disposables: readonly IDisposable[];\n}\n\n\nexport class FileWatcherManager implements IDisposable {\n\n\tprivate readonly _fileWatchers = new Map<number, {\n\t\treadonly uri: vscode.Uri;\n\t\treadonly watcher: vscode.FileSystemWatcher;\n\t\treadonly dirWatchers: DirWatcherEntry[];\n\t}>();\n\n\tprivate readonly _dirWatchers = new ResourceMap<{\n\t\treadonly uri: vscode.Uri;\n\t\treadonly watcher: vscode.FileSystemWatcher;\n\t\trefCount: number;\n\t}>(uri => uri.toString(), { onCaseInsensitiveFileSystem: false });\n\n\tconstructor(\n\t\tprivate readonly logger: Logger,\n\t) { }\n\n\tdispose(): void {\n\t\tfor (const entry of this._fileWatchers.values()) {\n\t\t\tentry.watcher.dispose();\n\t\t}\n\t\tthis._fileWatchers.clear();\n\n\t\tfor (const entry of this._dirWatchers.values()) {\n\t\t\tentry.watcher.dispose();\n\t\t}\n\t\tthis._dirWatchers.clear();\n\t}\n\n\tcreate(id: number, uri: vscode.Uri, watchParentDirs: boolean, isRecursive: boolean, listeners: { create?: (uri: vscode.Uri) => void; change?: (uri: vscode.Uri) => void; delete?: (uri: vscode.Uri) => void }): void {\n\t\tthis.logger.trace(`Creating file watcher for ${uri.toString()}`);\n\n\t\t// Non-writable file systems do not support file watching\n\t\tif (!vscode.workspace.fs.isWritableFileSystem(uri.scheme)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst watcher = vscode.workspace.createFileSystemWatcher(new vscode.RelativePattern(uri, isRecursive ? '**' : '*'), !listeners.create, !listeners.change, !listeners.delete);\n\t\tconst parentDirWatchers: DirWatcherEntry[] = [];\n\t\tthis._fileWatchers.set(id, { uri, watcher, dirWatchers: parentDirWatchers });\n\n\t\tif (listeners.create) { watcher.onDidCreate(listeners.create); }\n\t\tif (listeners.change) { watcher.onDidChange(listeners.change); }\n\t\tif (listeners.delete) { watcher.onDidDelete(listeners.delete); }\n\n\t\tif (watchParentDirs && uri.scheme !== Schemes.untitled) {\n\t\t\t// We need to watch the parent directories too for when these are deleted / created\n\t\t\tfor (let dirUri = Utils.dirname(uri); dirUri.path.length > 1; dirUri = Utils.dirname(dirUri)) {\n\t\t\t\tconst disposables: IDisposable[] = [];\n\n\t\t\t\tlet parentDirWatcher = this._dirWatchers.get(dirUri);\n\t\t\t\tif (!parentDirWatcher) {\n\t\t\t\t\tthis.logger.trace(`Creating parent dir watcher for ${dirUri.toString()}`);\n\t\t\t\t\tconst glob = new vscode.RelativePattern(Utils.dirname(dirUri), Utils.basename(dirUri));\n\t\t\t\t\tconst parentWatcher = vscode.workspace.createFileSystemWatcher(glob, !listeners.create, true, !listeners.delete);\n\t\t\t\t\tparentDirWatcher = { uri: dirUri, refCount: 0, watcher: parentWatcher };\n\t\t\t\t\tthis._dirWatchers.set(dirUri, parentDirWatcher);\n\t\t\t\t}\n\t\t\t\tparentDirWatcher.refCount++;\n\n\t\t\t\tif (listeners.create) {\n\t\t\t\t\tdisposables.push(parentDirWatcher.watcher.onDidCreate(async () => {\n\t\t\t\t\t\t// Just because the parent dir was created doesn't mean our file was created\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst stat = await vscode.workspace.fs.stat(uri);\n\t\t\t\t\t\t\tif (stat.type === vscode.FileType.File) {\n\t\t\t\t\t\t\t\tlisteners.create!(uri);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch {\n\t\t\t\t\t\t\t// Noop\n\t\t\t\t\t\t}\n\t\t\t\t\t}));\n\t\t\t\t}\n\n\t\t\t\tif (listeners.delete) {\n\t\t\t\t\t// When the parent dir is deleted, consider our file deleted too\n\t\t\t\t\t// TODO: this fires if the file previously did not exist and then the parent is deleted\n\t\t\t\t\tdisposables.push(parentDirWatcher.watcher.onDidDelete(listeners.delete));\n\t\t\t\t}\n\n\t\t\t\tparentDirWatchers.push({ uri: dirUri, disposables });\n\t\t\t}\n\t\t}\n\t}\n\n\n\tdelete(id: number): void {\n\t\tconst entry = this._fileWatchers.get(id);\n\t\tif (entry) {\n\t\t\tthis.logger.trace(`Deleting file watcher for ${entry.uri}`);\n\n\t\t\tfor (const dirWatcher of entry.dirWatchers) {\n\t\t\t\tdisposeAll(dirWatcher.disposables);\n\n\t\t\t\tconst dirWatcherEntry = this._dirWatchers.get(dirWatcher.uri);\n\t\t\t\tif (dirWatcherEntry) {\n\t\t\t\t\tif (--dirWatcherEntry.refCount <= 0) {\n\t\t\t\t\t\tthis.logger.trace(`Deleting parent dir ${dirWatcherEntry.uri}`);\n\t\t\t\t\t\tdirWatcherEntry.watcher.dispose();\n\t\t\t\t\t\tthis._dirWatchers.delete(dirWatcher.uri);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tentry.watcher.dispose();\n\t\t}\n\n\t\tthis._fileWatchers.delete(id);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\n\nexport interface ILogDirectoryProvider {\n\tgetNewLogDirectory(): vscode.Uri | undefined;\n}\n\nexport const noopLogDirectoryProvider = new class implements ILogDirectoryProvider {\n\tpublic getNewLogDirectory(): undefined {\n\t\treturn undefined;\n\t}\n};\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { TypeScriptServiceConfiguration } from '../configuration/configuration';\nimport { setImmediate } from '../utils/async';\nimport { Disposable } from '../utils/dispose';\n\n\nconst useWorkspaceNodeStorageKey = 'typescript.useWorkspaceNode';\nconst lastKnownWorkspaceNodeStorageKey = 'typescript.lastKnownWorkspaceNode';\ntype UseWorkspaceNodeState = undefined | boolean;\ntype LastKnownWorkspaceNodeState = undefined | string;\n\nexport class NodeVersionManager extends Disposable {\n\tprivate _currentVersion: string | undefined;\n\n\tpublic constructor(\n\t\tprivate configuration: TypeScriptServiceConfiguration,\n\t\tprivate readonly workspaceState: vscode.Memento\n\t) {\n\t\tsuper();\n\n\t\tthis._currentVersion = this.configuration.globalNodePath || undefined;\n\t\tif (vscode.workspace.isTrusted) {\n\t\t\tconst workspaceVersion = this.configuration.localNodePath;\n\t\t\tif (workspaceVersion) {\n\t\t\t\tconst useWorkspaceNode = this.canUseWorkspaceNode(workspaceVersion);\n\t\t\t\tif (useWorkspaceNode === undefined) {\n\t\t\t\t\tsetImmediate(() => {\n\t\t\t\t\t\tthis.promptAndSetWorkspaceNode();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse if (useWorkspaceNode) {\n\t\t\t\t\tthis._currentVersion = workspaceVersion;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis._disposables.push(vscode.workspace.onDidGrantWorkspaceTrust(() => {\n\t\t\t\tconst workspaceVersion = this.configuration.localNodePath;\n\t\t\t\tif (workspaceVersion) {\n\t\t\t\t\tconst useWorkspaceNode = this.canUseWorkspaceNode(workspaceVersion);\n\t\t\t\t\tif (useWorkspaceNode === undefined) {\n\t\t\t\t\t\tsetImmediate(() => {\n\t\t\t\t\t\t\tthis.promptAndSetWorkspaceNode();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse if (useWorkspaceNode) {\n\t\t\t\t\t\tthis.updateActiveVersion(workspaceVersion);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t}\n\n\tprivate readonly _onDidPickNewVersion = this._register(new vscode.EventEmitter<void>());\n\tpublic readonly onDidPickNewVersion = this._onDidPickNewVersion.event;\n\n\tpublic get currentVersion(): string | undefined {\n\t\treturn this._currentVersion;\n\t}\n\n\tpublic async updateConfiguration(nextConfiguration: TypeScriptServiceConfiguration) {\n\t\tconst oldConfiguration = this.configuration;\n\t\tthis.configuration = nextConfiguration;\n\t\tif (oldConfiguration.globalNodePath !== nextConfiguration.globalNodePath\n\t\t\t|| oldConfiguration.localNodePath !== nextConfiguration.localNodePath) {\n\t\t\tawait this.computeNewVersion();\n\t\t}\n\t}\n\n\tprivate async computeNewVersion() {\n\t\tlet version = this.configuration.globalNodePath || undefined;\n\t\tconst workspaceVersion = this.configuration.localNodePath;\n\t\tif (vscode.workspace.isTrusted && workspaceVersion) {\n\t\t\tconst useWorkspaceNode = this.canUseWorkspaceNode(workspaceVersion);\n\t\t\tif (useWorkspaceNode === undefined) {\n\t\t\t\tversion = await this.promptUseWorkspaceNode() || version;\n\t\t\t}\n\t\t\telse if (useWorkspaceNode) {\n\t\t\t\tversion = workspaceVersion;\n\t\t\t}\n\t\t}\n\t\tthis.updateActiveVersion(version);\n\t}\n\n\tprivate async promptUseWorkspaceNode(): Promise<string | undefined> {\n\t\tconst workspaceVersion = this.configuration.localNodePath;\n\t\tif (workspaceVersion === null) {\n\t\t\tthrow new Error('Could not prompt to use workspace Node installation because no workspace Node installation is specified');\n\t\t}\n\n\t\tconst allow = vscode.l10n.t(\"Yes\");\n\t\tconst disallow = vscode.l10n.t(\"No\");\n\t\tconst dismiss = vscode.l10n.t(\"Not now\");\n\n\t\tconst result = await vscode.window.showInformationMessage(vscode.l10n.t(\"This workspace wants to use the Node installation at '{0}' to run TS Server. Would you like to use it?\", workspaceVersion),\n\t\t\tallow,\n\t\t\tdisallow,\n\t\t\tdismiss,\n\t\t);\n\n\t\tlet version = undefined;\n\t\tswitch (result) {\n\t\t\tcase allow:\n\t\t\t\tawait this.setUseWorkspaceNodeState(true, workspaceVersion);\n\t\t\t\tversion = workspaceVersion;\n\t\t\t\tbreak;\n\t\t\tcase disallow:\n\t\t\t\tawait this.setUseWorkspaceNodeState(false, workspaceVersion);\n\t\t\t\tbreak;\n\t\t\tcase dismiss:\n\t\t\t\tawait this.setUseWorkspaceNodeState(undefined, workspaceVersion);\n\t\t\t\tbreak;\n\t\t}\n\t\treturn version;\n\t}\n\n\tprivate async promptAndSetWorkspaceNode(): Promise<void> {\n\t\tconst version = await this.promptUseWorkspaceNode();\n\t\tif (version !== undefined) {\n\t\t\tthis.updateActiveVersion(version);\n\t\t}\n\t}\n\n\tprivate updateActiveVersion(pickedVersion: string | undefined): void {\n\t\tconst oldVersion = this.currentVersion;\n\t\tthis._currentVersion = pickedVersion;\n\t\tif (oldVersion !== pickedVersion) {\n\t\t\tthis._onDidPickNewVersion.fire();\n\t\t}\n\t}\n\n\tprivate canUseWorkspaceNode(nodeVersion: string): boolean | undefined {\n\t\tconst lastKnownWorkspaceNode = this.workspaceState.get<LastKnownWorkspaceNodeState>(lastKnownWorkspaceNodeStorageKey);\n\t\tif (lastKnownWorkspaceNode === nodeVersion) {\n\t\t\treturn this.workspaceState.get<UseWorkspaceNodeState>(useWorkspaceNodeStorageKey);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate async setUseWorkspaceNodeState(allow: boolean | undefined, nodeVersion: string) {\n\t\tawait this.workspaceState.update(lastKnownWorkspaceNodeStorageKey, nodeVersion);\n\t\tawait this.workspaceState.update(useWorkspaceNodeStorageKey, allow);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as path from 'path';\nimport * as vscode from 'vscode';\nimport { RelativeWorkspacePathResolver } from '../utils/relativePathResolver';\nimport { TypeScriptServiceConfiguration } from '../configuration/configuration';\n\n\nexport class TypeScriptPluginPathsProvider {\n\n\tpublic constructor(\n\t\tprivate configuration: TypeScriptServiceConfiguration\n\t) { }\n\n\tpublic updateConfiguration(configuration: TypeScriptServiceConfiguration): void {\n\t\tthis.configuration = configuration;\n\t}\n\n\tpublic getPluginPaths(): string[] {\n\t\tconst pluginPaths = [];\n\t\tfor (const pluginPath of this.configuration.tsServerPluginPaths) {\n\t\t\tpluginPaths.push(...this.resolvePluginPath(pluginPath));\n\t\t}\n\t\treturn pluginPaths;\n\t}\n\n\tprivate resolvePluginPath(pluginPath: string): string[] {\n\t\tif (path.isAbsolute(pluginPath)) {\n\t\t\treturn [pluginPath];\n\t\t}\n\n\t\tconst workspacePath = RelativeWorkspacePathResolver.asAbsoluteWorkspacePath(pluginPath);\n\t\tif (workspacePath !== undefined) {\n\t\t\treturn [workspacePath];\n\t\t}\n\n\t\treturn (vscode.workspace.workspaceFolders || [])\n\t\t\t.map(workspaceFolder => path.join(workspaceFolder.uri.fsPath, pluginPath));\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as arrays from '../utils/arrays';\nimport { Disposable } from '../utils/dispose';\n\nexport interface TypeScriptServerPlugin {\n\treadonly extension: vscode.Extension<unknown>;\n\treadonly uri: vscode.Uri;\n\treadonly name: string;\n\treadonly enableForWorkspaceTypeScriptVersions: boolean;\n\treadonly languages: ReadonlyArray<string>;\n\treadonly configNamespace?: string;\n}\n\nnamespace TypeScriptServerPlugin {\n\texport function equals(a: TypeScriptServerPlugin, b: TypeScriptServerPlugin): boolean {\n\t\treturn a.uri.toString() === b.uri.toString()\n\t\t\t&& a.name === b.name\n\t\t\t&& a.enableForWorkspaceTypeScriptVersions === b.enableForWorkspaceTypeScriptVersions\n\t\t\t&& arrays.equals(a.languages, b.languages);\n\t}\n}\n\nexport class PluginManager extends Disposable {\n\tprivate readonly _pluginConfigurations = new Map<string, {}>();\n\n\tprivate _plugins?: Map<string, ReadonlyArray<TypeScriptServerPlugin>>;\n\n\tconstructor() {\n\t\tsuper();\n\n\t\tvscode.extensions.onDidChange(() => {\n\t\t\tif (!this._plugins) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst newPlugins = this.readPlugins();\n\t\t\tif (!arrays.equals(Array.from(this._plugins.values()).flat(), Array.from(newPlugins.values()).flat(), TypeScriptServerPlugin.equals)) {\n\t\t\t\tthis._plugins = newPlugins;\n\t\t\t\tthis._onDidUpdatePlugins.fire(this);\n\t\t\t}\n\t\t}, undefined, this._disposables);\n\t}\n\n\tpublic get plugins(): ReadonlyArray<TypeScriptServerPlugin> {\n\t\tthis._plugins ??= this.readPlugins();\n\t\treturn Array.from(this._plugins.values()).flat();\n\t}\n\n\tprivate readonly _onDidUpdatePlugins = this._register(new vscode.EventEmitter<this>());\n\tpublic readonly onDidChangePlugins = this._onDidUpdatePlugins.event;\n\n\tprivate readonly _onDidUpdateConfig = this._register(new vscode.EventEmitter<{ pluginId: string; config: {} }>());\n\tpublic readonly onDidUpdateConfig = this._onDidUpdateConfig.event;\n\n\tpublic setConfiguration(pluginId: string, config: {}) {\n\t\tthis._pluginConfigurations.set(pluginId, config);\n\t\tthis._onDidUpdateConfig.fire({ pluginId, config });\n\t}\n\n\tpublic configurations(): IterableIterator<[string, {}]> {\n\t\treturn this._pluginConfigurations.entries();\n\t}\n\n\tprivate readPlugins() {\n\t\tconst pluginMap = new Map<string, ReadonlyArray<TypeScriptServerPlugin>>();\n\t\tfor (const extension of vscode.extensions.all) {\n\t\t\tconst pack = extension.packageJSON;\n\t\t\tif (pack.contributes && Array.isArray(pack.contributes.typescriptServerPlugins)) {\n\t\t\t\tconst plugins: TypeScriptServerPlugin[] = [];\n\t\t\t\tfor (const plugin of pack.contributes.typescriptServerPlugins) {\n\t\t\t\t\tplugins.push({\n\t\t\t\t\t\textension,\n\t\t\t\t\t\tname: plugin.name,\n\t\t\t\t\t\tenableForWorkspaceTypeScriptVersions: !!plugin.enableForWorkspaceTypeScriptVersions,\n\t\t\t\t\t\turi: extension.extensionUri,\n\t\t\t\t\t\tlanguages: Array.isArray(plugin.languages) ? plugin.languages : [],\n\t\t\t\t\t\tconfigNamespace: plugin.configNamespace,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (plugins.length) {\n\t\t\t\t\tpluginMap.set(extension.id, plugins);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn pluginMap;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport const variableDeclaredButNeverUsed = new Set([6196, 6133]);\nexport const propertyDeclaretedButNeverUsed = new Set([6138]);\nexport const allImportsAreUnused = new Set([6192]);\nexport const unreachableCode = new Set([7027]);\nexport const unusedLabel = new Set([7028]);\nexport const fallThroughCaseInSwitch = new Set([7029]);\nexport const notAllCodePathsReturnAValue = new Set([7030]);\nexport const incorrectlyImplementsInterface = new Set([2420]);\nexport const cannotFindName = new Set([2552, 2304]);\nexport const extendsShouldBeImplements = new Set([2689]);\nexport const asyncOnlyAllowedInAsyncFunctions = new Set([1308]);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport const addMissingAwait = 'addMissingAwait';\nexport const addMissingNewOperator = 'addMissingNewOperator';\nexport const addMissingOverride = 'fixOverrideModifier';\nexport const annotateWithTypeFromJSDoc = 'annotateWithTypeFromJSDoc';\nexport const awaitInSyncFunction = 'fixAwaitInSyncFunction';\nexport const classDoesntImplementInheritedAbstractMember = 'fixClassDoesntImplementInheritedAbstractMember';\nexport const classIncorrectlyImplementsInterface = 'fixClassIncorrectlyImplementsInterface';\nexport const constructorForDerivedNeedSuperCall = 'constructorForDerivedNeedSuperCall';\nexport const extendsInterfaceBecomesImplements = 'extendsInterfaceBecomesImplements';\nexport const fixImport = 'import';\nexport const forgottenThisPropertyAccess = 'forgottenThisPropertyAccess';\nexport const removeUnnecessaryAwait = 'removeUnnecessaryAwait';\nexport const spelling = 'spelling';\nexport const inferFromUsage = 'inferFromUsage';\nexport const addNameToNamelessParameter = 'addNameToNamelessParameter';\nexport const fixMissingFunctionDeclaration = 'fixMissingFunctionDeclaration';\nexport const fixClassDoesntImplementInheritedAbstractMember = 'fixClassDoesntImplementInheritedAbstractMember';\nexport const unreachableCode = 'fixUnreachableCode';\nexport const unusedIdentifier = 'unusedIdentifier';\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport function parseKindModifier(kindModifiers: string): Set<string> {\n\treturn new Set(kindModifiers.split(/,|\\s+/g));\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport class Kind {\n\tpublic static readonly alias = 'alias';\n\tpublic static readonly callSignature = 'call';\n\tpublic static readonly class = 'class';\n\tpublic static readonly const = 'const';\n\tpublic static readonly constructorImplementation = 'constructor';\n\tpublic static readonly constructSignature = 'construct';\n\tpublic static readonly directory = 'directory';\n\tpublic static readonly enum = 'enum';\n\tpublic static readonly enumMember = 'enum member';\n\tpublic static readonly externalModuleName = 'external module name';\n\tpublic static readonly function = 'function';\n\tpublic static readonly indexSignature = 'index';\n\tpublic static readonly interface = 'interface';\n\tpublic static readonly keyword = 'keyword';\n\tpublic static readonly let = 'let';\n\tpublic static readonly localFunction = 'local function';\n\tpublic static readonly localVariable = 'local var';\n\tpublic static readonly method = 'method';\n\tpublic static readonly memberGetAccessor = 'getter';\n\tpublic static readonly memberSetAccessor = 'setter';\n\tpublic static readonly memberVariable = 'property';\n\tpublic static readonly module = 'module';\n\tpublic static readonly primitiveType = 'primitive type';\n\tpublic static readonly script = 'script';\n\tpublic static readonly type = 'type';\n\tpublic static readonly variable = 'var';\n\tpublic static readonly warning = 'warning';\n\tpublic static readonly string = 'string';\n\tpublic static readonly parameter = 'parameter';\n\tpublic static readonly typeParameter = 'type parameter';\n}\n\n\nexport class DiagnosticCategory {\n\tpublic static readonly error = 'error';\n\tpublic static readonly warning = 'warning';\n\tpublic static readonly suggestion = 'suggestion';\n}\n\nexport class KindModifiers {\n\tpublic static readonly optional = 'optional';\n\tpublic static readonly deprecated = 'deprecated';\n\tpublic static readonly color = 'color';\n\n\tpublic static readonly dtsFile = '.d.ts';\n\tpublic static readonly tsFile = '.ts';\n\tpublic static readonly tsxFile = '.tsx';\n\tpublic static readonly jsFile = '.js';\n\tpublic static readonly jsxFile = '.jsx';\n\tpublic static readonly jsonFile = '.json';\n\n\tpublic static readonly fileExtensionKindModifiers = [\n\t\tKindModifiers.dtsFile,\n\t\tKindModifiers.tsFile,\n\t\tKindModifiers.tsxFile,\n\t\tKindModifiers.jsFile,\n\t\tKindModifiers.jsxFile,\n\t\tKindModifiers.jsonFile,\n\t];\n}\n\nexport class DisplayPartKind {\n\tpublic static readonly functionName = 'functionName';\n\tpublic static readonly methodName = 'methodName';\n\tpublic static readonly parameterName = 'parameterName';\n\tpublic static readonly propertyName = 'propertyName';\n\tpublic static readonly punctuation = 'punctuation';\n\tpublic static readonly text = 'text';\n}\n\nexport enum EventName {\n\tsyntaxDiag = 'syntaxDiag',\n\tsemanticDiag = 'semanticDiag',\n\tsuggestionDiag = 'suggestionDiag',\n\tregionSemanticDiag = 'regionSemanticDiag',\n\tconfigFileDiag = 'configFileDiag',\n\ttelemetry = 'telemetry',\n\tprojectLanguageServiceState = 'projectLanguageServiceState',\n\tprojectsUpdatedInBackground = 'projectsUpdatedInBackground',\n\tbeginInstallTypes = 'beginInstallTypes',\n\tendInstallTypes = 'endInstallTypes',\n\ttypesInstallerInitializationFailed = 'typesInstallerInitializationFailed',\n\tsurveyReady = 'surveyReady',\n\tprojectLoadingStart = 'projectLoadingStart',\n\tprojectLoadingFinish = 'projectLoadingFinish',\n\tcreateFileWatcher = 'createFileWatcher',\n\tcreateDirectoryWatcher = 'createDirectoryWatcher',\n\tcloseFileWatcher = 'closeFileWatcher',\n\trequestCompleted = 'requestCompleted',\n}\n\nexport enum OrganizeImportsMode {\n\tAll = 'All',\n\tSortAndCombine = 'SortAndCombine',\n\tRemoveUnused = 'RemoveUnused',\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type * as Proto from './protocol/protocol';\n\nexport enum RequestQueueingType {\n\t/**\n\t * Normal request that is executed in order.\n\t */\n\tNormal = 1,\n\n\t/**\n\t * Request that normal requests jump in front of in the queue.\n\t */\n\tLowPriority = 2,\n\n\t/**\n\t * A fence that blocks request reordering.\n\t *\n\t * Fences are not reordered. Unlike a normal request, a fence will never jump in front of a low priority request\n\t * in the request queue.\n\t */\n\tFence = 3,\n}\n\nexport interface RequestItem {\n\treadonly request: Proto.Request;\n\treadonly expectsResponse: boolean;\n\treadonly isAsync: boolean;\n\treadonly queueingType: RequestQueueingType;\n}\n\nexport class RequestQueue {\n\tprivate readonly queue: RequestItem[] = [];\n\tprivate sequenceNumber: number = 0;\n\n\tpublic get length(): number {\n\t\treturn this.queue.length;\n\t}\n\n\tpublic enqueue(item: RequestItem): void {\n\t\tif (item.queueingType === RequestQueueingType.Normal) {\n\t\t\tlet index = this.queue.length - 1;\n\t\t\twhile (index >= 0) {\n\t\t\t\tif (this.queue[index].queueingType !== RequestQueueingType.LowPriority) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t--index;\n\t\t\t}\n\t\t\tthis.queue.splice(index + 1, 0, item);\n\t\t} else {\n\t\t\t// Only normal priority requests can be reordered. All other requests just go to the end.\n\t\t\tthis.queue.push(item);\n\t\t}\n\t}\n\n\tpublic dequeue(): RequestItem | undefined {\n\t\treturn this.queue.shift();\n\t}\n\n\tpublic tryDeletePendingRequest(seq: number): boolean {\n\t\tfor (let i = 0; i < this.queue.length; i++) {\n\t\t\tif (this.queue[i].request.seq === seq) {\n\t\t\t\tthis.queue.splice(i, 1);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic createRequest(command: string, args: any): Proto.Request {\n\t\treturn {\n\t\t\tseq: this.sequenceNumber++,\n\t\t\ttype: 'request',\n\t\t\tcommand: command,\n\t\t\targuments: args\n\t\t};\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Cancellation } from '@vscode/sync-api-common/lib/common/messageCancellation';\nimport * as vscode from 'vscode';\nimport { TypeScriptServiceConfiguration } from '../configuration/configuration';\nimport { TelemetryReporter } from '../logging/telemetry';\nimport Tracer from '../logging/tracer';\nimport { CallbackMap } from '../tsServer/callbackMap';\nimport { RequestItem, RequestQueue, RequestQueueingType } from '../tsServer/requestQueue';\nimport { TypeScriptServerError } from '../tsServer/serverError';\nimport { ServerResponse, ServerType, TypeScriptRequests } from '../typescriptService';\nimport { Disposable } from '../utils/dispose';\nimport { isWebAndHasSharedArrayBuffers } from '../utils/platform';\nimport { OngoingRequestCanceller } from './cancellation';\nimport type * as Proto from './protocol/protocol';\nimport { EventName } from './protocol/protocol.const';\nimport { TypeScriptVersionManager } from './versionManager';\nimport { TypeScriptVersion } from './versionProvider';\nimport { NodeVersionManager } from './nodeManager';\n\nexport enum ExecutionTarget {\n\tSemantic,\n\tSyntax\n}\n\nexport interface TypeScriptServerExitEvent {\n\treadonly code: number | null;\n\treadonly signal: string | null;\n}\n\nexport type TsServerLog =\n\t{ readonly type: 'file'; readonly uri: vscode.Uri } |\n\t{ readonly type: 'output'; readonly output: vscode.OutputChannel };\n\nexport interface ITypeScriptServer {\n\treadonly onEvent: vscode.Event<Proto.Event>;\n\treadonly onExit: vscode.Event<TypeScriptServerExitEvent>;\n\treadonly onError: vscode.Event<any>;\n\n\treadonly tsServerLog: TsServerLog | undefined;\n\n\tkill(): void;\n\n\t/**\n\t * @return A list of all execute requests. If there are multiple entries, the first item is the primary\n\t * request while the rest are secondary ones.\n\t */\n\texecuteImpl(command: keyof TypeScriptRequests, args: any, executeInfo: { isAsync: boolean; token?: vscode.CancellationToken; expectsResult: boolean; lowPriority?: boolean; executionTarget?: ExecutionTarget }): Array<Promise<ServerResponse.Response<Proto.Response>> | undefined>;\n\n\tdispose(): void;\n}\n\nexport interface TsServerDelegate {\n\tonFatalError(command: string, error: Error): void;\n}\n\nexport const enum TsServerProcessKind {\n\tMain = 'main',\n\tSyntax = 'syntax',\n\tSemantic = 'semantic',\n\tDiagnostics = 'diagnostics'\n}\n\nexport interface TsServerProcessFactory {\n\tfork(\n\t\tversion: TypeScriptVersion,\n\t\targs: readonly string[],\n\t\tkind: TsServerProcessKind,\n\t\tconfiguration: TypeScriptServiceConfiguration,\n\t\tversionManager: TypeScriptVersionManager,\n\t\tnodeVersionManager: NodeVersionManager,\n\t\ttsServerLog: TsServerLog | undefined,\n\t): TsServerProcess;\n}\n\nexport interface TsServerProcess {\n\twrite(serverRequest: Proto.Request): void;\n\n\tonData(handler: (data: Proto.Response) => void): void;\n\tonExit(handler: (code: number | null, signal: string | null) => void): void;\n\tonError(handler: (error: Error) => void): void;\n\n\tkill(): void;\n}\n\nexport class SingleTsServer extends Disposable implements ITypeScriptServer {\n\tprivate readonly _requestQueue = new RequestQueue();\n\tprivate readonly _callbacks = new CallbackMap<Proto.Response>();\n\tprivate readonly _pendingResponses = new Set<number>();\n\n\tconstructor(\n\t\tprivate readonly _serverId: string,\n\t\tprivate readonly _serverSource: ServerType,\n\t\tprivate readonly _process: TsServerProcess,\n\t\tprivate readonly _tsServerLog: TsServerLog | undefined,\n\t\tprivate readonly _requestCanceller: OngoingRequestCanceller,\n\t\tprivate readonly _version: TypeScriptVersion,\n\t\tprivate readonly _telemetryReporter: TelemetryReporter,\n\t\tprivate readonly _tracer: Tracer,\n\t) {\n\t\tsuper();\n\n\t\tthis._process.onData(msg => {\n\t\t\tthis.dispatchMessage(msg);\n\t\t});\n\n\t\tthis._process.onExit((code, signal) => {\n\t\t\tthis._onExit.fire({ code, signal });\n\t\t\tthis._callbacks.destroy('server exited');\n\t\t});\n\n\t\tthis._process.onError(error => {\n\t\t\tthis._onError.fire(error);\n\t\t\tthis._callbacks.destroy('server errored');\n\t\t});\n\t}\n\n\tprivate readonly _onEvent = this._register(new vscode.EventEmitter<Proto.Event>());\n\tpublic readonly onEvent = this._onEvent.event;\n\n\tprivate readonly _onExit = this._register(new vscode.EventEmitter<TypeScriptServerExitEvent>());\n\tpublic readonly onExit = this._onExit.event;\n\n\tprivate readonly _onError = this._register(new vscode.EventEmitter<any>());\n\tpublic readonly onError = this._onError.event;\n\n\tpublic get tsServerLog() { return this._tsServerLog; }\n\n\tprivate write(serverRequest: Proto.Request) {\n\t\tthis._process.write(serverRequest);\n\t}\n\n\tpublic override dispose() {\n\t\tsuper.dispose();\n\t\tthis._callbacks.destroy('server disposed');\n\t\tthis._pendingResponses.clear();\n\t}\n\n\tpublic kill() {\n\t\tthis._process.kill();\n\t}\n\n\tprivate dispatchMessage(message: Proto.Message) {\n\t\ttry {\n\t\t\tswitch (message.type) {\n\t\t\t\tcase 'response':\n\t\t\t\t\tif (this._serverSource) {\n\t\t\t\t\t\tthis.dispatchResponse({\n\t\t\t\t\t\t\t...(message as Proto.Response),\n\t\t\t\t\t\t\t_serverType: this._serverSource\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.dispatchResponse(message as Proto.Response);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'event': {\n\t\t\t\t\tconst event = message as Proto.Event;\n\t\t\t\t\tif (event.event === 'requestCompleted') {\n\t\t\t\t\t\tconst seq = (event as Proto.RequestCompletedEvent).body.request_seq;\n\t\t\t\t\t\tconst callback = this._callbacks.fetch(seq);\n\t\t\t\t\t\tif (callback) {\n\t\t\t\t\t\t\tthis._tracer.traceRequestCompleted(this._serverId, 'requestCompleted', seq, callback);\n\t\t\t\t\t\t\tcallback.onSuccess(undefined);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ((event as Proto.RequestCompletedEvent).body.performanceData) {\n\t\t\t\t\t\t\tthis._onEvent.fire(event);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._tracer.traceEvent(this._serverId, event);\n\t\t\t\t\t\tthis._onEvent.fire(event);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error(`Unknown message type ${message.type} received`);\n\t\t\t}\n\t\t} finally {\n\t\t\tthis.sendNextRequests();\n\t\t}\n\t}\n\n\tprivate tryCancelRequest(request: Proto.Request, command: string): boolean {\n\t\tconst seq = request.seq;\n\t\ttry {\n\t\t\tif (this._requestQueue.tryDeletePendingRequest(seq)) {\n\t\t\t\tthis.logTrace(`Canceled request with sequence number ${seq}`);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif (this._requestCanceller.tryCancelOngoingRequest(seq)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tthis.logTrace(`Tried to cancel request with sequence number ${seq}. But request got already delivered.`);\n\t\t\treturn false;\n\t\t} finally {\n\t\t\tconst callback = this.fetchCallback(seq);\n\t\t\tcallback?.onSuccess(new ServerResponse.Cancelled(`Cancelled request ${seq} - ${command}`));\n\t\t}\n\t}\n\n\tprivate dispatchResponse(response: Proto.Response) {\n\t\tconst callback = this.fetchCallback(response.request_seq);\n\t\tif (!callback) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._tracer.traceResponse(this._serverId, response, callback);\n\t\tif (response.success) {\n\t\t\tcallback.onSuccess(response);\n\t\t} else if (response.message === 'No content available.') {\n\t\t\t// Special case where response itself is successful but there is not any data to return.\n\t\t\tcallback.onSuccess(ServerResponse.NoContent);\n\t\t} else {\n\t\t\tcallback.onError(TypeScriptServerError.create(this._serverId, this._version, response));\n\t\t}\n\t}\n\n\tpublic executeImpl(command: keyof TypeScriptRequests, args: any, executeInfo: { isAsync: boolean; token?: vscode.CancellationToken; expectsResult: boolean; lowPriority?: boolean; executionTarget?: ExecutionTarget }): Array<Promise<ServerResponse.Response<Proto.Response>> | undefined> {\n\t\tconst request = this._requestQueue.createRequest(command, args);\n\t\tconst requestInfo: RequestItem = {\n\t\t\trequest,\n\t\t\texpectsResponse: executeInfo.expectsResult,\n\t\t\tisAsync: executeInfo.isAsync,\n\t\t\tqueueingType: SingleTsServer.getQueueingType(command, executeInfo.lowPriority)\n\t\t};\n\t\tlet result: Promise<ServerResponse.Response<Proto.Response>> | undefined;\n\t\tif (executeInfo.expectsResult) {\n\t\t\tresult = new Promise<ServerResponse.Response<Proto.Response>>((resolve, reject) => {\n\t\t\t\tthis._callbacks.add(request.seq, { onSuccess: resolve as () => ServerResponse.Response<Proto.Response> | undefined, onError: reject, queuingStartTime: Date.now(), isAsync: executeInfo.isAsync }, executeInfo.isAsync);\n\n\t\t\t\tif (executeInfo.token) {\n\n\t\t\t\t\tconst cancelViaSAB = isWebAndHasSharedArrayBuffers()\n\t\t\t\t\t\t? Cancellation.addData(request)\n\t\t\t\t\t\t: undefined;\n\n\t\t\t\t\texecuteInfo.token.onCancellationRequested(() => {\n\t\t\t\t\t\tcancelViaSAB?.();\n\t\t\t\t\t\tthis.tryCancelRequest(request, command);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}).catch((err: Error) => {\n\t\t\t\tif (err instanceof TypeScriptServerError) {\n\t\t\t\t\tif (!executeInfo.token?.isCancellationRequested) {\n\t\t\t\t\t\t/* __GDPR__\n\t\t\t\t\t\t\t\"languageServiceErrorResponse\" : {\n\t\t\t\t\t\t\t\t\"owner\": \"mjbvz\",\n\t\t\t\t\t\t\t\t\"${include}\": [\n\t\t\t\t\t\t\t\t\t\"${TypeScriptCommonProperties}\",\n\t\t\t\t\t\t\t\t\t\"${TypeScriptRequestErrorProperties}\"\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t*/\n\t\t\t\t\t\tthis._telemetryReporter.logTelemetry('languageServiceErrorResponse', err.telemetry);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthrow err;\n\t\t\t});\n\t\t}\n\n\t\tthis._requestQueue.enqueue(requestInfo);\n\t\tthis.sendNextRequests();\n\n\t\treturn [result];\n\t}\n\n\tprivate sendNextRequests(): void {\n\t\twhile (this._pendingResponses.size === 0 && this._requestQueue.length > 0) {\n\t\t\tconst item = this._requestQueue.dequeue();\n\t\t\tif (item) {\n\t\t\t\tthis.sendRequest(item);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate sendRequest(requestItem: RequestItem): void {\n\t\tconst serverRequest = requestItem.request;\n\t\tthis._tracer.traceRequest(this._serverId, serverRequest, requestItem.expectsResponse, this._requestQueue.length);\n\n\t\tif (requestItem.expectsResponse && !requestItem.isAsync) {\n\t\t\tthis._pendingResponses.add(requestItem.request.seq);\n\t\t}\n\n\t\ttry {\n\t\t\tthis.write(serverRequest);\n\t\t} catch (err) {\n\t\t\tconst callback = this.fetchCallback(serverRequest.seq);\n\t\t\tcallback?.onError(err);\n\t\t}\n\t}\n\n\tprivate fetchCallback(seq: number) {\n\t\tconst callback = this._callbacks.fetch(seq);\n\t\tif (!callback) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tthis._pendingResponses.delete(seq);\n\t\treturn callback;\n\t}\n\n\tprivate logTrace(message: string) {\n\t\tthis._tracer.trace(this._serverId, message);\n\t}\n\n\tprivate static readonly fenceCommands = new Set(['change', 'close', 'open', 'updateOpen']);\n\n\tprivate static getQueueingType(\n\t\tcommand: string,\n\t\tlowPriority?: boolean\n\t): RequestQueueingType {\n\t\tif (SingleTsServer.fenceCommands.has(command)) {\n\t\t\treturn RequestQueueingType.Fence;\n\t\t}\n\t\treturn lowPriority ? RequestQueueingType.LowPriority : RequestQueueingType.Normal;\n\t}\n}\n\n\ninterface ExecuteInfo {\n\treadonly isAsync: boolean;\n\treadonly token?: vscode.CancellationToken;\n\treadonly expectsResult: boolean;\n\treadonly lowPriority?: boolean;\n\treadonly executionTarget?: ExecutionTarget;\n}\n\nclass RequestRouter {\n\n\tprivate static readonly sharedCommands = new Set<keyof TypeScriptRequests>([\n\t\t'change',\n\t\t'close',\n\t\t'open',\n\t\t'updateOpen',\n\t\t'configure',\n\t]);\n\n\tconstructor(\n\t\tprivate readonly servers: ReadonlyArray<{\n\t\t\treadonly server: ITypeScriptServer;\n\t\t\tcanRun?(command: keyof TypeScriptRequests, executeInfo: ExecuteInfo): boolean;\n\t\t}>,\n\t\tprivate readonly delegate: TsServerDelegate,\n\t) { }\n\n\tpublic execute(\n\t\tcommand: keyof TypeScriptRequests,\n\t\targs: any,\n\t\texecuteInfo: ExecuteInfo,\n\t): Array<Promise<ServerResponse.Response<Proto.Response>> | undefined> {\n\t\tif (RequestRouter.sharedCommands.has(command) && typeof executeInfo.executionTarget === 'undefined') {\n\t\t\t// Dispatch shared commands to all servers but use first one as the primary response\n\n\t\t\tconst requestStates: RequestState.State[] = this.servers.map(() => RequestState.Unresolved);\n\n\t\t\t// Also make sure we never cancel requests to just one server\n\t\t\tlet token: vscode.CancellationToken | undefined = undefined;\n\t\t\tif (executeInfo.token) {\n\t\t\t\tconst source = new vscode.CancellationTokenSource();\n\t\t\t\texecuteInfo.token.onCancellationRequested(() => {\n\t\t\t\t\tif (requestStates.some(state => state === RequestState.Resolved)) {\n\t\t\t\t\t\t// Don't cancel.\n\t\t\t\t\t\t// One of the servers completed this request so we don't want to leave the other\n\t\t\t\t\t\t// in a different state.\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tsource.cancel();\n\t\t\t\t});\n\t\t\t\ttoken = source.token;\n\t\t\t}\n\n\t\t\tconst allRequests: Array<Promise<ServerResponse.Response<Proto.Response>> | undefined> = [];\n\n\t\t\tfor (let serverIndex = 0; serverIndex < this.servers.length; ++serverIndex) {\n\t\t\t\tconst server = this.servers[serverIndex].server;\n\n\t\t\t\tconst request = server.executeImpl(command, args, { ...executeInfo, token })[0];\n\t\t\t\tallRequests.push(request);\n\t\t\t\tif (request) {\n\t\t\t\t\trequest\n\t\t\t\t\t\t.then(result => {\n\t\t\t\t\t\t\trequestStates[serverIndex] = RequestState.Resolved;\n\t\t\t\t\t\t\tconst erroredRequest = requestStates.find(state => state.type === RequestState.Type.Errored) as RequestState.Errored | undefined;\n\t\t\t\t\t\t\tif (erroredRequest) {\n\t\t\t\t\t\t\t\t// We've gone out of sync\n\t\t\t\t\t\t\t\tthis.delegate.onFatalError(command, erroredRequest.err);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn result;\n\t\t\t\t\t\t}, err => {\n\t\t\t\t\t\t\trequestStates[serverIndex] = new RequestState.Errored(err);\n\t\t\t\t\t\t\tif (requestStates.some(state => state === RequestState.Resolved)) {\n\t\t\t\t\t\t\t\t// We've gone out of sync\n\t\t\t\t\t\t\t\tthis.delegate.onFatalError(command, err);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthrow err;\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn allRequests;\n\t\t}\n\n\t\tfor (const { canRun, server } of this.servers) {\n\t\t\tif (!canRun || canRun(command, executeInfo)) {\n\t\t\t\treturn server.executeImpl(command, args, executeInfo);\n\t\t\t}\n\t\t}\n\n\t\tthrow new Error(`Could not find server for command: '${command}'`);\n\t}\n}\n\nexport class GetErrRoutingTsServer extends Disposable implements ITypeScriptServer {\n\n\tprivate static readonly diagnosticEvents = new Set<string>([\n\t\tEventName.configFileDiag,\n\t\tEventName.syntaxDiag,\n\t\tEventName.semanticDiag,\n\t\tEventName.suggestionDiag\n\t]);\n\n\tprivate readonly getErrServer: ITypeScriptServer;\n\tprivate readonly mainServer: ITypeScriptServer;\n\tprivate readonly router: RequestRouter;\n\n\tpublic constructor(\n\t\tservers: { getErr: ITypeScriptServer; primary: ITypeScriptServer },\n\t\tdelegate: TsServerDelegate,\n\t) {\n\t\tsuper();\n\n\t\tthis.getErrServer = servers.getErr;\n\t\tthis.mainServer = servers.primary;\n\n\t\tthis.router = new RequestRouter(\n\t\t\t[\n\t\t\t\t{ server: this.getErrServer, canRun: (command) => ['geterr', 'geterrForProject'].includes(command) },\n\t\t\t\t{ server: this.mainServer, canRun: undefined /* gets all other commands */ }\n\t\t\t],\n\t\t\tdelegate);\n\n\t\tthis._register(this.getErrServer.onEvent(e => {\n\t\t\tif (GetErrRoutingTsServer.diagnosticEvents.has(e.event)) {\n\t\t\t\tthis._onEvent.fire(e);\n\t\t\t}\n\t\t\t// Ignore all other events\n\t\t}));\n\t\tthis._register(this.mainServer.onEvent(e => {\n\t\t\tif (!GetErrRoutingTsServer.diagnosticEvents.has(e.event)) {\n\t\t\t\tthis._onEvent.fire(e);\n\t\t\t}\n\t\t\t// Ignore all other events\n\t\t}));\n\n\t\tthis._register(this.getErrServer.onError(e => this._onError.fire(e)));\n\t\tthis._register(this.mainServer.onError(e => this._onError.fire(e)));\n\n\t\tthis._register(this.mainServer.onExit(e => {\n\t\t\tthis._onExit.fire(e);\n\t\t\tthis.getErrServer.kill();\n\t\t}));\n\t}\n\n\tprivate readonly _onEvent = this._register(new vscode.EventEmitter<Proto.Event>());\n\tpublic readonly onEvent = this._onEvent.event;\n\n\tprivate readonly _onExit = this._register(new vscode.EventEmitter<TypeScriptServerExitEvent>());\n\tpublic readonly onExit = this._onExit.event;\n\n\tprivate readonly _onError = this._register(new vscode.EventEmitter<any>());\n\tpublic readonly onError = this._onError.event;\n\n\tpublic get tsServerLog() { return this.mainServer.tsServerLog; }\n\n\tpublic kill(): void {\n\t\tthis.getErrServer.kill();\n\t\tthis.mainServer.kill();\n\t}\n\n\tpublic executeImpl(command: keyof TypeScriptRequests, args: any, executeInfo: { isAsync: boolean; token?: vscode.CancellationToken; expectsResult: boolean; lowPriority?: boolean; executionTarget?: ExecutionTarget }): Array<Promise<ServerResponse.Response<Proto.Response>> | undefined> {\n\t\treturn this.router.execute(command, args, executeInfo);\n\t}\n}\n\n\nexport class SyntaxRoutingTsServer extends Disposable implements ITypeScriptServer {\n\n\t/**\n\t * Commands that should always be run on the syntax server.\n\t */\n\tprivate static readonly syntaxAlwaysCommands = new Set<keyof TypeScriptRequests>([\n\t\t'navtree',\n\t\t'getOutliningSpans',\n\t\t'jsxClosingTag',\n\t\t'selectionRange',\n\t\t'format',\n\t\t'formatonkey',\n\t\t'docCommentTemplate',\n\t\t'linkedEditingRange'\n\t]);\n\n\t/**\n\t * Commands that should always be run on the semantic server.\n\t */\n\tprivate static readonly semanticCommands = new Set<keyof TypeScriptRequests>([\n\t\t'geterr',\n\t\t'geterrForProject',\n\t\t'projectInfo',\n\t\t'configurePlugin',\n\t]);\n\n\t/**\n\t * Commands that can be run on the syntax server but would benefit from being upgraded to the semantic server.\n\t */\n\tprivate static readonly syntaxAllowedCommands = new Set<keyof TypeScriptRequests>([\n\t\t'completions',\n\t\t'completionEntryDetails',\n\t\t'completionInfo',\n\t\t'definition',\n\t\t'definitionAndBoundSpan',\n\t\t'documentHighlights',\n\t\t'implementation',\n\t\t'navto',\n\t\t'quickinfo',\n\t\t'references',\n\t\t'rename',\n\t\t'signatureHelp',\n\t]);\n\n\tprivate readonly syntaxServer: ITypeScriptServer;\n\tprivate readonly semanticServer: ITypeScriptServer;\n\tprivate readonly router: RequestRouter;\n\n\tprivate _projectLoading = true;\n\n\tpublic constructor(\n\t\tservers: { syntax: ITypeScriptServer; semantic: ITypeScriptServer },\n\t\tdelegate: TsServerDelegate,\n\t\tenableDynamicRouting: boolean,\n\t) {\n\t\tsuper();\n\n\t\tthis.syntaxServer = servers.syntax;\n\t\tthis.semanticServer = servers.semantic;\n\n\t\tthis.router = new RequestRouter(\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\tserver: this.syntaxServer,\n\t\t\t\t\tcanRun: (command, execInfo) => {\n\t\t\t\t\t\tswitch (execInfo.executionTarget) {\n\t\t\t\t\t\t\tcase ExecutionTarget.Semantic: return false;\n\t\t\t\t\t\t\tcase ExecutionTarget.Syntax: return true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (SyntaxRoutingTsServer.syntaxAlwaysCommands.has(command)) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (SyntaxRoutingTsServer.semanticCommands.has(command)) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (enableDynamicRouting && this.projectLoading && SyntaxRoutingTsServer.syntaxAllowedCommands.has(command)) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}, {\n\t\t\t\t\tserver: this.semanticServer,\n\t\t\t\t\tcanRun: undefined /* gets all other commands */\n\t\t\t\t}\n\t\t\t],\n\t\t\tdelegate);\n\n\t\tthis._register(this.syntaxServer.onEvent(e => {\n\t\t\treturn this._onEvent.fire(e);\n\t\t}));\n\n\t\tthis._register(this.semanticServer.onEvent(e => {\n\t\t\tswitch (e.event) {\n\t\t\t\tcase EventName.projectLoadingStart:\n\t\t\t\t\tthis._projectLoading = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase EventName.projectLoadingFinish:\n\t\t\t\tcase EventName.semanticDiag:\n\t\t\t\tcase EventName.syntaxDiag:\n\t\t\t\tcase EventName.suggestionDiag:\n\t\t\t\tcase EventName.configFileDiag:\n\t\t\t\t\tthis._projectLoading = false;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\treturn this._onEvent.fire(e);\n\t\t}));\n\n\t\tthis._register(this.semanticServer.onExit(e => {\n\t\t\tthis._onExit.fire(e);\n\t\t\tthis.syntaxServer.kill();\n\t\t}));\n\n\t\tthis._register(this.semanticServer.onError(e => this._onError.fire(e)));\n\t}\n\n\tprivate get projectLoading() { return this._projectLoading; }\n\n\tprivate readonly _onEvent = this._register(new vscode.EventEmitter<Proto.Event>());\n\tpublic readonly onEvent = this._onEvent.event;\n\n\tprivate readonly _onExit = this._register(new vscode.EventEmitter<any>());\n\tpublic readonly onExit = this._onExit.event;\n\n\tprivate readonly _onError = this._register(new vscode.EventEmitter<any>());\n\tpublic readonly onError = this._onError.event;\n\n\tpublic get tsServerLog() { return this.semanticServer.tsServerLog; }\n\n\tpublic kill(): void {\n\t\tthis.syntaxServer.kill();\n\t\tthis.semanticServer.kill();\n\t}\n\n\tpublic executeImpl(command: keyof TypeScriptRequests, args: any, executeInfo: { isAsync: boolean; token?: vscode.CancellationToken; expectsResult: boolean; lowPriority?: boolean; executionTarget?: ExecutionTarget }): Array<Promise<ServerResponse.Response<Proto.Response>> | undefined> {\n\t\treturn this.router.execute(command, args, executeInfo);\n\t}\n}\n\nnamespace RequestState {\n\texport const enum Type { Unresolved, Resolved, Errored }\n\n\texport const Unresolved = { type: Type.Unresolved } as const;\n\n\texport const Resolved = { type: Type.Resolved } as const;\n\n\texport class Errored {\n\t\treadonly type = Type.Errored;\n\n\t\tconstructor(\n\t\t\tpublic readonly err: Error\n\t\t) { }\n\t}\n\n\texport type State = typeof Unresolved | typeof Resolved | Errored;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type * as Proto from './protocol/protocol';\nimport { TypeScriptVersion } from './versionProvider';\n\n\nexport class TypeScriptServerError extends Error {\n\tpublic static create(\n\t\tserverId: string,\n\t\tversion: TypeScriptVersion,\n\t\tresponse: Proto.Response\n\t): TypeScriptServerError {\n\t\tconst parsedResult = TypeScriptServerError.parseErrorText(response);\n\t\treturn new TypeScriptServerError(serverId, version, response, parsedResult?.message, parsedResult?.stack, parsedResult?.sanitizedStack);\n\t}\n\n\tprivate constructor(\n\t\tpublic readonly serverId: string,\n\t\tpublic readonly version: TypeScriptVersion,\n\t\tprivate readonly response: Proto.Response,\n\t\tpublic readonly serverMessage: string | undefined,\n\t\tpublic readonly serverStack: string | undefined,\n\t\tprivate readonly sanitizedStack: string | undefined\n\t) {\n\t\tsuper([\n\t\t\t`<${serverId}> TypeScript Server Error (${version.displayName})`,\n\t\t\tserverMessage,\n\t\t\tserverStack\n\t\t].filter(Boolean).join('\\n'));\n\t}\n\n\tpublic get serverErrorText() { return this.response.message; }\n\n\tpublic get serverCommand() { return this.response.command; }\n\n\tpublic get telemetry() {\n\t\t// The \"sanitizedstack\" has been purged of error messages, paths, and file names (other than tsserver)\n\t\t// and, thus, can be classified as SystemMetaData, rather than CallstackOrException.\n\t\t/* __GDPR__FRAGMENT__\n\t\t\t\"TypeScriptRequestErrorProperties\" : {\n\t\t\t\t\"command\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"serverid\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\t\t\"sanitizedstack\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\t\t\"badclient\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" }\n\t\t\t}\n\t\t*/\n\t\treturn {\n\t\t\tcommand: this.serverCommand,\n\t\t\tserverid: this.serverId,\n\t\t\tsanitizedstack: this.sanitizedStack || '',\n\t\t\tbadclient: /\\bBADCLIENT\\b/.test(this.stack || ''),\n\t\t} as const;\n\t}\n\n\t/**\n\t * Given a `errorText` from a tsserver request indicating failure in handling a request,\n\t * prepares a payload for telemetry-logging.\n\t */\n\tprivate static parseErrorText(response: Proto.Response) {\n\t\tconst errorText = response.message;\n\t\tif (errorText) {\n\t\t\tconst errorPrefix = 'Error processing request. ';\n\t\t\tif (errorText.startsWith(errorPrefix)) {\n\t\t\t\tconst prefixFreeErrorText = errorText.substr(errorPrefix.length);\n\t\t\t\tconst newlineIndex = prefixFreeErrorText.indexOf('\\n');\n\t\t\t\tif (newlineIndex >= 0) {\n\t\t\t\t\t// Newline expected between message and stack.\n\t\t\t\t\tconst stack = prefixFreeErrorText.substring(newlineIndex + 1);\n\t\t\t\t\treturn {\n\t\t\t\t\t\tmessage: prefixFreeErrorText.substring(0, newlineIndex),\n\t\t\t\t\t\tstack,\n\t\t\t\t\t\tsanitizedStack: TypeScriptServerError.sanitizeStack(stack)\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\t/**\n\t * Drop everything but \".js\" and line/column numbers (though retain \"tsserver\" if that's the filename).\n\t */\n\tprivate static sanitizeStack(message: string | undefined) {\n\t\tif (!message) {\n\t\t\treturn '';\n\t\t}\n\t\tconst regex = /(\\btsserver)?(\\.(?:ts|tsx|js|jsx)(?::\\d+(?::\\d+)?)?)\\)?$/igm;\n\t\tlet serverStack = '';\n\t\twhile (true) {\n\t\t\tconst match = regex.exec(message);\n\t\t\tif (!match) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t// [1] is 'tsserver' or undefined\n\t\t\t// [2] is '.js:{line_number}:{column_number}'\n\t\t\tserverStack += `${match[1] || 'suppressed'}${match[2]}\\n`;\n\t\t}\n\t\treturn serverStack;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n/// <reference lib='webworker' />\nimport { ServiceConnection } from '@vscode/sync-api-common/browser';\nimport { ApiService, Requests } from '@vscode/sync-api-service';\nimport * as vscode from 'vscode';\nimport { TypeScriptServiceConfiguration } from '../configuration/configuration';\nimport { Logger } from '../logging/logger';\nimport { supportsReadableByteStreams } from '../utils/platform';\nimport { FileWatcherManager } from './fileWatchingManager';\nimport { NodeVersionManager } from './nodeManager';\nimport type * as Proto from './protocol/protocol';\nimport { TsServerLog, TsServerProcess, TsServerProcessFactory, TsServerProcessKind } from './server';\nimport { TypeScriptVersionManager } from './versionManager';\nimport { TypeScriptVersion } from './versionProvider';\n\ntype BrowserWatchEvent = {\n\ttype: 'watchDirectory' | 'watchFile';\n\trecursive?: boolean;\n\turi: {\n\t\tscheme: string;\n\t\tauthority: string;\n\t\tpath: string;\n\t};\n\tid: number;\n} | {\n\ttype: 'dispose';\n\tid: number;\n};\n\nexport class WorkerServerProcessFactory implements TsServerProcessFactory {\n\tconstructor(\n\t\tprivate readonly _extensionUri: vscode.Uri,\n\t\tprivate readonly _logger: Logger,\n\t) { }\n\n\tpublic fork(\n\t\tversion: TypeScriptVersion,\n\t\targs: readonly string[],\n\t\tkind: TsServerProcessKind,\n\t\tconfiguration: TypeScriptServiceConfiguration,\n\t\t_versionManager: TypeScriptVersionManager,\n\t\t_nodeVersionManager: NodeVersionManager,\n\t\ttsServerLog: TsServerLog | undefined,\n\t) {\n\t\tconst tsServerPath = version.tsServerPath;\n\t\tconst launchArgs = [\n\t\t\t...args,\n\t\t\t// Explicitly give TS Server its path so it can load local resources\n\t\t\t'--executingFilePath', tsServerPath,\n\t\t\t// Enable/disable web type acquisition\n\t\t\t(configuration.webTypeAcquisitionEnabled && supportsReadableByteStreams() ? '--experimentalTypeAcquisition' : '--disableAutomaticTypingAcquisition'),\n\t\t];\n\n\t\treturn new WorkerServerProcess(kind, tsServerPath, this._extensionUri, launchArgs, tsServerLog, this._logger);\n\t}\n}\n\nclass WorkerServerProcess implements TsServerProcess {\n\n\tprivate static idPool = 0;\n\n\tprivate readonly id = WorkerServerProcess.idPool++;\n\n\tprivate readonly _onDataHandlers = new Set<(data: Proto.Response) => void>();\n\tprivate readonly _onErrorHandlers = new Set<(err: Error) => void>();\n\tprivate readonly _onExitHandlers = new Set<(code: number | null, signal: string | null) => void>();\n\n\tprivate readonly _worker: Worker;\n\tprivate readonly _watches: FileWatcherManager;\n\n\t/** For communicating with TS server synchronously */\n\tprivate readonly _tsserver: MessagePort;\n\t/** For communicating watches asynchronously */\n\tprivate readonly _watcher: MessagePort;\n\t/** For communicating with filesystem synchronously */\n\tprivate readonly _syncFs: MessagePort;\n\n\tpublic constructor(\n\t\tprivate readonly kind: TsServerProcessKind,\n\t\ttsServerPath: string,\n\t\textensionUri: vscode.Uri,\n\t\targs: readonly string[],\n\t\tprivate readonly tsServerLog: TsServerLog | undefined,\n\t\tlogger: Logger,\n\t) {\n\t\tthis._worker = new Worker(tsServerPath, { name: `TS ${kind} server #${this.id}` });\n\n\t\tthis._watches = new FileWatcherManager(logger);\n\n\t\tconst tsserverChannel = new MessageChannel();\n\t\tconst watcherChannel = new MessageChannel();\n\t\tconst syncChannel = new MessageChannel();\n\t\tthis._tsserver = tsserverChannel.port2;\n\t\tthis._watcher = watcherChannel.port2;\n\t\tthis._syncFs = syncChannel.port2;\n\n\t\tthis._tsserver.onmessage = (event) => {\n\t\t\tif (event.data.type === 'log') {\n\t\t\t\tconsole.error(`unexpected log message on tsserver channel: ${JSON.stringify(event)}`);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tfor (const handler of this._onDataHandlers) {\n\t\t\t\thandler(event.data);\n\t\t\t}\n\t\t};\n\n\t\tthis._watcher.onmessage = (event: MessageEvent<BrowserWatchEvent>) => {\n\t\t\tswitch (event.data.type) {\n\t\t\t\tcase 'dispose': {\n\t\t\t\t\tthis._watches.delete(event.data.id);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase 'watchDirectory':\n\t\t\t\tcase 'watchFile': {\n\t\t\t\t\tthis._watches.create(event.data.id, vscode.Uri.from(event.data.uri), /*watchParentDirs*/ true, !!event.data.recursive, {\n\t\t\t\t\t\tchange: uri => this._watcher.postMessage({ type: 'watch', event: 'change', uri }),\n\t\t\t\t\t\tcreate: uri => this._watcher.postMessage({ type: 'watch', event: 'create', uri }),\n\t\t\t\t\t\tdelete: uri => this._watcher.postMessage({ type: 'watch', event: 'delete', uri }),\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.error(`unexpected message on watcher channel: ${JSON.stringify(event)}`);\n\t\t\t}\n\t\t};\n\n\t\tthis._worker.onmessage = (msg: any) => {\n\t\t\t// for logging only\n\t\t\tif (msg.data.type === 'log') {\n\t\t\t\tthis.appendLog(msg.data.body);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconsole.error(`unexpected message on main channel: ${JSON.stringify(msg)}`);\n\t\t};\n\n\t\tthis._worker.onerror = (err: ErrorEvent) => {\n\t\t\tconsole.error('error! ' + JSON.stringify(err));\n\t\t\tfor (const handler of this._onErrorHandlers) {\n\t\t\t\t// TODO: The ErrorEvent type might be wrong; previously this was typed as Error and didn't have the property access.\n\t\t\t\thandler(err.error);\n\t\t\t}\n\t\t};\n\n\t\tthis._worker.postMessage(\n\t\t\t{ args, extensionUri },\n\t\t\t[syncChannel.port1, tsserverChannel.port1, watcherChannel.port1]\n\t\t);\n\n\t\tconst connection = new ServiceConnection<Requests>(syncChannel.port2);\n\t\tnew ApiService('vscode-wasm-typescript', connection);\n\t\tconnection.signalReady();\n\t}\n\n\twrite(serverRequest: Proto.Request): void {\n\t\tthis._tsserver.postMessage(serverRequest);\n\t}\n\n\tonData(handler: (response: Proto.Response) => void): void {\n\t\tthis._onDataHandlers.add(handler);\n\t}\n\n\tonError(handler: (err: Error) => void): void {\n\t\tthis._onErrorHandlers.add(handler);\n\t}\n\n\tonExit(handler: (code: number | null, signal: string | null) => void): void {\n\t\tthis._onExitHandlers.add(handler);\n\t\t// Todo: not implemented\n\t}\n\n\tkill(): void {\n\t\tthis._worker.terminate();\n\t\tthis._tsserver.close();\n\t\tthis._watcher.close();\n\t\tthis._syncFs.close();\n\t\tthis._watches.dispose();\n\t}\n\n\tprivate appendLog(msg: string) {\n\t\tif (this.tsServerLog?.type === 'output') {\n\t\t\tthis.tsServerLog.output.appendLine(`(${this.id} - ${this.kind}) ${msg}`);\n\t\t}\n\t}\n}\n\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { SyntaxServerConfiguration, TsServerLogLevel, TypeScriptServiceConfiguration } from '../configuration/configuration';\nimport { Logger } from '../logging/logger';\nimport { TelemetryReporter } from '../logging/telemetry';\nimport Tracer from '../logging/tracer';\nimport { OngoingRequestCancellerFactory } from '../tsServer/cancellation';\nimport { ClientCapabilities, ClientCapability, ServerType } from '../typescriptService';\nimport { memoize } from '../utils/memoize';\nimport { isWeb, isWebAndHasSharedArrayBuffers } from '../utils/platform';\nimport { API } from './api';\nimport { ILogDirectoryProvider } from './logDirectoryProvider';\nimport { TypeScriptPluginPathsProvider } from './pluginPathsProvider';\nimport { PluginManager } from './plugins';\nimport { GetErrRoutingTsServer, ITypeScriptServer, SingleTsServer, SyntaxRoutingTsServer, TsServerDelegate, TsServerLog, TsServerProcessFactory, TsServerProcessKind } from './server';\nimport { TypeScriptVersionManager } from './versionManager';\nimport { ITypeScriptVersionProvider, TypeScriptVersion } from './versionProvider';\nimport { NodeVersionManager } from './nodeManager';\n\nconst enum CompositeServerType {\n\t/** Run a single server that handles all commands  */\n\tSingle,\n\n\t/** Run a separate server for syntax commands */\n\tSeparateSyntax,\n\n\t/** Use a separate syntax server while the project is loading */\n\tDynamicSeparateSyntax,\n\n\t/** Only enable the syntax server */\n\tSyntaxOnly\n}\n\nexport class TypeScriptServerSpawner {\n\n\t@memoize\n\tpublic static get tsServerLogOutputChannel(): vscode.OutputChannel {\n\t\treturn vscode.window.createOutputChannel(vscode.l10n.t(\"TypeScript Server Log\"));\n\t}\n\n\tpublic constructor(\n\t\tprivate readonly _versionProvider: ITypeScriptVersionProvider,\n\t\tprivate readonly _versionManager: TypeScriptVersionManager,\n\t\tprivate readonly _nodeVersionManager: NodeVersionManager,\n\t\tprivate readonly _logDirectoryProvider: ILogDirectoryProvider,\n\t\tprivate readonly _pluginPathsProvider: TypeScriptPluginPathsProvider,\n\t\tprivate readonly _logger: Logger,\n\t\tprivate readonly _telemetryReporter: TelemetryReporter,\n\t\tprivate readonly _tracer: Tracer,\n\t\tprivate readonly _factory: TsServerProcessFactory,\n\t) { }\n\n\tpublic spawn(\n\t\tversion: TypeScriptVersion,\n\t\tcapabilities: ClientCapabilities,\n\t\tconfiguration: TypeScriptServiceConfiguration,\n\t\tpluginManager: PluginManager,\n\t\tcancellerFactory: OngoingRequestCancellerFactory,\n\t\tdelegate: TsServerDelegate,\n\t): ITypeScriptServer {\n\t\tlet primaryServer: ITypeScriptServer;\n\t\tconst serverType = this.getCompositeServerType(version, capabilities, configuration);\n\t\tconst shouldUseSeparateDiagnosticsServer = this.shouldUseSeparateDiagnosticsServer(configuration);\n\n\t\tswitch (serverType) {\n\t\t\tcase CompositeServerType.SeparateSyntax:\n\t\t\tcase CompositeServerType.DynamicSeparateSyntax:\n\t\t\t\t{\n\t\t\t\t\tconst enableDynamicRouting = !shouldUseSeparateDiagnosticsServer && serverType === CompositeServerType.DynamicSeparateSyntax;\n\t\t\t\t\tprimaryServer = new SyntaxRoutingTsServer({\n\t\t\t\t\t\tsyntax: this.spawnTsServer(TsServerProcessKind.Syntax, version, configuration, pluginManager, cancellerFactory),\n\t\t\t\t\t\tsemantic: this.spawnTsServer(TsServerProcessKind.Semantic, version, configuration, pluginManager, cancellerFactory),\n\t\t\t\t\t}, delegate, enableDynamicRouting);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tcase CompositeServerType.Single:\n\t\t\t\t{\n\t\t\t\t\tprimaryServer = this.spawnTsServer(TsServerProcessKind.Main, version, configuration, pluginManager, cancellerFactory);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tcase CompositeServerType.SyntaxOnly:\n\t\t\t\t{\n\t\t\t\t\tprimaryServer = this.spawnTsServer(TsServerProcessKind.Syntax, version, configuration, pluginManager, cancellerFactory);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t}\n\n\t\tif (shouldUseSeparateDiagnosticsServer) {\n\t\t\treturn new GetErrRoutingTsServer({\n\t\t\t\tgetErr: this.spawnTsServer(TsServerProcessKind.Diagnostics, version, configuration, pluginManager, cancellerFactory),\n\t\t\t\tprimary: primaryServer,\n\t\t\t}, delegate);\n\t\t}\n\n\t\treturn primaryServer;\n\t}\n\n\tprivate getCompositeServerType(\n\t\tversion: TypeScriptVersion,\n\t\tcapabilities: ClientCapabilities,\n\t\tconfiguration: TypeScriptServiceConfiguration,\n\t): CompositeServerType {\n\t\tif (!capabilities.has(ClientCapability.Semantic)) {\n\t\t\treturn CompositeServerType.SyntaxOnly;\n\t\t}\n\n\t\tswitch (configuration.useSyntaxServer) {\n\t\t\tcase SyntaxServerConfiguration.Always:\n\t\t\t\treturn CompositeServerType.SyntaxOnly;\n\n\t\t\tcase SyntaxServerConfiguration.Never:\n\t\t\t\treturn CompositeServerType.Single;\n\n\t\t\tcase SyntaxServerConfiguration.Auto:\n\t\t\t\treturn version.apiVersion?.gte(API.v400)\n\t\t\t\t\t? CompositeServerType.DynamicSeparateSyntax\n\t\t\t\t\t: CompositeServerType.SeparateSyntax;\n\t\t}\n\t}\n\n\tprivate shouldUseSeparateDiagnosticsServer(\n\t\tconfiguration: TypeScriptServiceConfiguration,\n\t): boolean {\n\t\treturn configuration.enableProjectDiagnostics;\n\t}\n\n\tprivate spawnTsServer(\n\t\tkind: TsServerProcessKind,\n\t\tversion: TypeScriptVersion,\n\t\tconfiguration: TypeScriptServiceConfiguration,\n\t\tpluginManager: PluginManager,\n\t\tcancellerFactory: OngoingRequestCancellerFactory,\n\t): ITypeScriptServer {\n\t\tconst apiVersion = version.apiVersion || API.defaultVersion;\n\n\t\tconst canceller = cancellerFactory.create(kind, this._tracer);\n\t\tconst { args, tsServerLog, tsServerTraceDirectory } = this.getTsServerArgs(kind, configuration, version, apiVersion, pluginManager, canceller.cancellationPipeName);\n\n\t\tif (TypeScriptServerSpawner.isLoggingEnabled(configuration)) {\n\t\t\tif (tsServerLog?.type === 'file') {\n\t\t\t\tthis._logger.info(`<${kind}> Log file: ${tsServerLog.uri.fsPath}`);\n\t\t\t} else if (tsServerLog?.type === 'output') {\n\t\t\t\tthis._logger.info(`<${kind}> Logging to output`);\n\t\t\t} else {\n\t\t\t\tthis._logger.error(`<${kind}> Could not create TS Server log`);\n\t\t\t}\n\t\t}\n\n\t\tif (configuration.enableTsServerTracing) {\n\t\t\tif (tsServerTraceDirectory) {\n\t\t\t\tthis._logger.info(`<${kind}> Trace directory: ${tsServerTraceDirectory.fsPath}`);\n\t\t\t} else {\n\t\t\t\tthis._logger.error(`<${kind}> Could not create trace directory`);\n\t\t\t}\n\t\t}\n\n\t\tthis._logger.info(`<${kind}> Forking...`);\n\t\tconst process = this._factory.fork(version, args, kind, configuration, this._versionManager, this._nodeVersionManager, tsServerLog);\n\t\tthis._logger.info(`<${kind}> Starting...`);\n\n\t\treturn new SingleTsServer(\n\t\t\tkind,\n\t\t\tthis.kindToServerType(kind),\n\t\t\tprocess!,\n\t\t\ttsServerLog,\n\t\t\tcanceller,\n\t\t\tversion,\n\t\t\tthis._telemetryReporter,\n\t\t\tthis._tracer);\n\t}\n\n\tprivate kindToServerType(kind: TsServerProcessKind): ServerType {\n\t\tswitch (kind) {\n\t\t\tcase TsServerProcessKind.Syntax:\n\t\t\t\treturn ServerType.Syntax;\n\n\t\t\tcase TsServerProcessKind.Main:\n\t\t\tcase TsServerProcessKind.Semantic:\n\t\t\tcase TsServerProcessKind.Diagnostics:\n\t\t\tdefault:\n\t\t\t\treturn ServerType.Semantic;\n\t\t}\n\t}\n\n\tprivate getTsServerArgs(\n\t\tkind: TsServerProcessKind,\n\t\tconfiguration: TypeScriptServiceConfiguration,\n\t\tcurrentVersion: TypeScriptVersion,\n\t\tapiVersion: API,\n\t\tpluginManager: PluginManager,\n\t\tcancellationPipeName: string | undefined,\n\t): { args: string[]; tsServerLog: TsServerLog | undefined; tsServerTraceDirectory: vscode.Uri | undefined } {\n\t\tconst args: string[] = [];\n\t\tlet tsServerLog: TsServerLog | undefined;\n\t\tlet tsServerTraceDirectory: vscode.Uri | undefined;\n\n\t\tif (kind === TsServerProcessKind.Syntax) {\n\t\t\tif (apiVersion.gte(API.v401)) {\n\t\t\t\targs.push('--serverMode', 'partialSemantic');\n\t\t\t} else {\n\t\t\t\targs.push('--syntaxOnly');\n\t\t\t}\n\t\t}\n\n\t\targs.push('--useInferredProjectPerProjectRoot');\n\n\t\tif (configuration.disableAutomaticTypeAcquisition || kind === TsServerProcessKind.Syntax || kind === TsServerProcessKind.Diagnostics) {\n\t\t\targs.push('--disableAutomaticTypingAcquisition');\n\t\t}\n\n\t\tif (kind === TsServerProcessKind.Semantic || kind === TsServerProcessKind.Main) {\n\t\t\targs.push('--enableTelemetry');\n\t\t}\n\n\t\tif (cancellationPipeName) {\n\t\t\targs.push('--cancellationPipeName', cancellationPipeName + '*');\n\t\t}\n\n\t\tif (TypeScriptServerSpawner.isLoggingEnabled(configuration)) {\n\t\t\tif (isWeb()) {\n\t\t\t\targs.push('--logVerbosity', TsServerLogLevel.toString(configuration.tsServerLogLevel));\n\t\t\t\ttsServerLog = { type: 'output', output: TypeScriptServerSpawner.tsServerLogOutputChannel };\n\t\t\t} else {\n\t\t\t\tconst logDir = this._logDirectoryProvider.getNewLogDirectory();\n\t\t\t\tif (logDir) {\n\t\t\t\t\tconst logFilePath = vscode.Uri.joinPath(logDir, `tsserver.log`);\n\t\t\t\t\ttsServerLog = { type: 'file', uri: logFilePath };\n\n\t\t\t\t\targs.push('--logVerbosity', TsServerLogLevel.toString(configuration.tsServerLogLevel));\n\t\t\t\t\targs.push('--logFile', logFilePath.fsPath);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (configuration.enableTsServerTracing && !isWeb()) {\n\t\t\ttsServerTraceDirectory = this._logDirectoryProvider.getNewLogDirectory();\n\t\t\tif (tsServerTraceDirectory) {\n\t\t\t\targs.push('--traceDirectory', `\"${tsServerTraceDirectory.fsPath}\"`);\n\t\t\t}\n\t\t}\n\n\t\tconst pluginPaths = isWeb() ? [] : this._pluginPathsProvider.getPluginPaths();\n\n\t\tif (pluginManager.plugins.length) {\n\t\t\targs.push('--globalPlugins', pluginManager.plugins.map(x => x.name).join(','));\n\n\t\t\tconst isUsingBundledTypeScriptVersion = currentVersion.path === this._versionProvider.defaultVersion.path;\n\t\t\tfor (const plugin of pluginManager.plugins) {\n\t\t\t\tif (isUsingBundledTypeScriptVersion || plugin.enableForWorkspaceTypeScriptVersions) {\n\t\t\t\t\tpluginPaths.push(isWeb() ? plugin.uri.toString() : plugin.uri.fsPath);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (pluginPaths.length !== 0) {\n\t\t\targs.push('--pluginProbeLocations', pluginPaths.join(','));\n\t\t}\n\n\t\tif (configuration.npmLocation && !isWeb()) {\n\t\t\targs.push('--npmLocation', `\"${configuration.npmLocation}\"`);\n\t\t}\n\n\t\targs.push('--locale', TypeScriptServerSpawner.getTsLocale(configuration));\n\n\t\targs.push('--noGetErrOnBackgroundUpdate');\n\n\t\tconst configUseVsCodeWatcher = configuration.useVsCodeWatcher;\n\t\tconst isYarnPnp = apiVersion.isYarnPnp();\n\t\tif (\n\t\t\tapiVersion.gte(API.v544)\n\t\t\t&& configUseVsCodeWatcher\n\t\t\t&& !isYarnPnp // Disable for yarn pnp as it currently breaks with the VS Code watcher\n\t\t) {\n\t\t\targs.push('--canUseWatchEvents');\n\t\t} else {\n\t\t\tif (!configUseVsCodeWatcher) {\n\t\t\t\tthis._logger.info(`<${kind}> Falling back to legacy node.js based file watching because of user settings.`);\n\t\t\t} else if (isYarnPnp) {\n\t\t\t\tthis._logger.info(`<${kind}> Falling back to legacy node.js based file watching because of Yarn PnP.`);\n\t\t\t}\n\t\t}\n\n\t\targs.push('--validateDefaultNpmLocation');\n\n\t\tif (isWebAndHasSharedArrayBuffers()) {\n\t\t\targs.push('--enableProjectWideIntelliSenseOnWeb');\n\t\t}\n\n\t\treturn { args, tsServerLog, tsServerTraceDirectory };\n\t}\n\n\tprivate static isLoggingEnabled(configuration: TypeScriptServiceConfiguration) {\n\t\treturn configuration.tsServerLogLevel !== TsServerLogLevel.Off;\n\t}\n\n\tprivate static getTsLocale(configuration: TypeScriptServiceConfiguration): string {\n\t\treturn configuration.locale\n\t\t\t? configuration.locale\n\t\t\t: vscode.env.language;\n\t}\n}\n\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { TypeScriptServiceConfiguration } from '../configuration/configuration';\nimport { setImmediate } from '../utils/async';\nimport { Disposable } from '../utils/dispose';\nimport { ITypeScriptVersionProvider, TypeScriptVersion } from './versionProvider';\n\n\nconst useWorkspaceTsdkStorageKey = 'typescript.useWorkspaceTsdk';\nconst suppressPromptWorkspaceTsdkStorageKey = 'typescript.suppressPromptWorkspaceTsdk';\n\ninterface QuickPickItem extends vscode.QuickPickItem {\n\trun(): void;\n}\n\nexport class TypeScriptVersionManager extends Disposable {\n\n\tprivate _currentVersion: TypeScriptVersion;\n\n\tpublic constructor(\n\t\tprivate configuration: TypeScriptServiceConfiguration,\n\t\tprivate readonly versionProvider: ITypeScriptVersionProvider,\n\t\tprivate readonly workspaceState: vscode.Memento\n\t) {\n\t\tsuper();\n\n\t\tthis._currentVersion = this.versionProvider.defaultVersion;\n\n\t\tif (this.useWorkspaceTsdkSetting) {\n\t\t\tif (vscode.workspace.isTrusted) {\n\t\t\t\tconst localVersion = this.versionProvider.localVersion;\n\t\t\t\tif (localVersion) {\n\t\t\t\t\tthis._currentVersion = localVersion;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._disposables.push(vscode.workspace.onDidGrantWorkspaceTrust(() => {\n\t\t\t\t\tif (this.versionProvider.localVersion) {\n\t\t\t\t\t\tthis.updateActiveVersion(this.versionProvider.localVersion);\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t}\n\t\t}\n\n\t\tif (this.isInPromptWorkspaceTsdkState(configuration)) {\n\t\t\tsetImmediate(() => {\n\t\t\t\tthis.promptUseWorkspaceTsdk();\n\t\t\t});\n\t\t}\n\n\t}\n\n\tprivate readonly _onDidPickNewVersion = this._register(new vscode.EventEmitter<void>());\n\tpublic readonly onDidPickNewVersion = this._onDidPickNewVersion.event;\n\n\tpublic updateConfiguration(nextConfiguration: TypeScriptServiceConfiguration) {\n\t\tconst lastConfiguration = this.configuration;\n\t\tthis.configuration = nextConfiguration;\n\n\t\tif (\n\t\t\t!this.isInPromptWorkspaceTsdkState(lastConfiguration)\n\t\t\t&& this.isInPromptWorkspaceTsdkState(nextConfiguration)\n\t\t) {\n\t\t\tthis.promptUseWorkspaceTsdk();\n\t\t}\n\t}\n\n\tpublic get currentVersion(): TypeScriptVersion {\n\t\treturn this._currentVersion;\n\t}\n\n\tpublic reset(): void {\n\t\tthis._currentVersion = this.versionProvider.bundledVersion;\n\t}\n\n\tpublic async promptUserForVersion(): Promise<void> {\n\t\tconst selected = await vscode.window.showQuickPick<QuickPickItem>([\n\t\t\tthis.getBundledPickItem(),\n\t\t\t...this.getLocalPickItems(),\n\t\t\t{\n\t\t\t\tkind: vscode.QuickPickItemKind.Separator,\n\t\t\t\tlabel: '',\n\t\t\t\trun: () => { /* noop */ },\n\t\t\t},\n\t\t\tLearnMorePickItem,\n\t\t], {\n\t\t\tplaceHolder: vscode.l10n.t(\"Select the TypeScript version used for JavaScript and TypeScript language features\"),\n\t\t});\n\n\t\treturn selected?.run();\n\t}\n\n\tprivate getBundledPickItem(): QuickPickItem {\n\t\tconst bundledVersion = this.versionProvider.defaultVersion;\n\t\treturn {\n\t\t\tlabel: (!this.useWorkspaceTsdkSetting || !vscode.workspace.isTrusted\n\t\t\t\t? ' '\n\t\t\t\t: '') + vscode.l10n.t(\"Use VS Code's Version\"),\n\t\t\tdescription: bundledVersion.displayName,\n\t\t\tdetail: bundledVersion.pathLabel,\n\t\t\trun: async () => {\n\t\t\t\tawait this.workspaceState.update(useWorkspaceTsdkStorageKey, false);\n\t\t\t\tthis.updateActiveVersion(bundledVersion);\n\t\t\t},\n\t\t};\n\t}\n\n\tprivate getLocalPickItems(): QuickPickItem[] {\n\t\treturn this.versionProvider.localVersions.map(version => {\n\t\t\treturn {\n\t\t\t\tlabel: (this.useWorkspaceTsdkSetting && vscode.workspace.isTrusted && this.currentVersion.eq(version)\n\t\t\t\t\t? ' '\n\t\t\t\t\t: '') + vscode.l10n.t(\"Use Workspace Version\"),\n\t\t\t\tdescription: version.displayName,\n\t\t\t\tdetail: version.pathLabel,\n\t\t\t\trun: async () => {\n\t\t\t\t\tconst trusted = await vscode.workspace.requestWorkspaceTrust();\n\t\t\t\t\tif (trusted) {\n\t\t\t\t\t\tawait this.workspaceState.update(useWorkspaceTsdkStorageKey, true);\n\t\t\t\t\t\tconst tsConfig = vscode.workspace.getConfiguration('typescript');\n\t\t\t\t\t\tawait tsConfig.update('tsdk', version.pathLabel, false);\n\t\t\t\t\t\tthis.updateActiveVersion(version);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t};\n\t\t});\n\t}\n\n\tprivate async promptUseWorkspaceTsdk(): Promise<void> {\n\t\tconst workspaceVersion = this.versionProvider.localVersion;\n\n\t\tif (workspaceVersion === undefined) {\n\t\t\tthrow new Error('Could not prompt to use workspace TypeScript version because no workspace version is specified');\n\t\t}\n\n\t\tconst allowIt = vscode.l10n.t(\"Allow\");\n\t\tconst dismissPrompt = vscode.l10n.t(\"Dismiss\");\n\t\tconst suppressPrompt = vscode.l10n.t(\"Never in this Workspace\");\n\n\t\tconst result = await vscode.window.showInformationMessage(vscode.l10n.t(\"This workspace contains a TypeScript version. Would you like to use the workspace TypeScript version for TypeScript and JavaScript language features?\"),\n\t\t\tallowIt,\n\t\t\tdismissPrompt,\n\t\t\tsuppressPrompt\n\t\t);\n\n\t\tif (result === allowIt) {\n\t\t\tawait this.workspaceState.update(useWorkspaceTsdkStorageKey, true);\n\t\t\tthis.updateActiveVersion(workspaceVersion);\n\t\t} else if (result === suppressPrompt) {\n\t\t\tawait this.workspaceState.update(suppressPromptWorkspaceTsdkStorageKey, true);\n\t\t}\n\t}\n\n\tprivate updateActiveVersion(pickedVersion: TypeScriptVersion) {\n\t\tconst oldVersion = this.currentVersion;\n\t\tthis._currentVersion = pickedVersion;\n\t\tif (!oldVersion.eq(pickedVersion)) {\n\t\t\tthis._onDidPickNewVersion.fire();\n\t\t}\n\t}\n\n\tprivate get useWorkspaceTsdkSetting(): boolean {\n\t\treturn this.workspaceState.get<boolean>(useWorkspaceTsdkStorageKey, false);\n\t}\n\n\tprivate get suppressPromptWorkspaceTsdkSetting(): boolean {\n\t\treturn this.workspaceState.get<boolean>(suppressPromptWorkspaceTsdkStorageKey, false);\n\t}\n\n\tprivate isInPromptWorkspaceTsdkState(configuration: TypeScriptServiceConfiguration) {\n\t\treturn (\n\t\t\tconfiguration.localTsdk !== null\n\t\t\t&& configuration.enablePromptUseWorkspaceTsdk === true\n\t\t\t&& this.suppressPromptWorkspaceTsdkSetting === false\n\t\t\t&& this.useWorkspaceTsdkSetting === false\n\t\t);\n\t}\n}\n\nconst LearnMorePickItem: QuickPickItem = {\n\tlabel: vscode.l10n.t(\"Learn more about managing TypeScript versions\"),\n\tdescription: '',\n\trun: () => {\n\t\tvscode.env.openExternal(vscode.Uri.parse('https://go.microsoft.com/fwlink/?linkid=839919'));\n\t}\n};\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { TypeScriptServiceConfiguration } from '../configuration/configuration';\nimport { API } from './api';\n\n\nexport const enum TypeScriptVersionSource {\n\tBundled = 'bundled',\n\tTsNightlyExtension = 'ts-nightly-extension',\n\tNodeModules = 'node-modules',\n\tUserSetting = 'user-setting',\n\tWorkspaceSetting = 'workspace-setting',\n}\n\nexport class TypeScriptVersion {\n\n\tconstructor(\n\t\tpublic readonly source: TypeScriptVersionSource,\n\t\tpublic readonly path: string,\n\t\tpublic readonly apiVersion: API | undefined,\n\t\tprivate readonly _pathLabel?: string,\n\t) { }\n\n\tpublic get tsServerPath(): string {\n\t\treturn this.path;\n\t}\n\n\tpublic get pathLabel(): string {\n\t\treturn this._pathLabel ?? this.path;\n\t}\n\n\tpublic get isValid(): boolean {\n\t\treturn this.apiVersion !== undefined;\n\t}\n\n\tpublic eq(other: TypeScriptVersion): boolean {\n\t\tif (this.path !== other.path) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.apiVersion === other.apiVersion) {\n\t\t\treturn true;\n\t\t}\n\t\tif (!this.apiVersion || !other.apiVersion) {\n\t\t\treturn false;\n\t\t}\n\t\treturn this.apiVersion.eq(other.apiVersion);\n\t}\n\n\tpublic get displayName(): string {\n\t\tconst version = this.apiVersion;\n\t\treturn version ? version.displayName : vscode.l10n.t(\"Could not load the TypeScript version at this path\");\n\t}\n}\n\nexport interface ITypeScriptVersionProvider {\n\tupdateConfiguration(configuration: TypeScriptServiceConfiguration): void;\n\n\treadonly defaultVersion: TypeScriptVersion;\n\treadonly globalVersion: TypeScriptVersion | undefined;\n\treadonly localVersion: TypeScriptVersion | undefined;\n\treadonly localVersions: readonly TypeScriptVersion[];\n\treadonly bundledVersion: TypeScriptVersion;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { TypeScriptServiceConfiguration } from './configuration/configuration';\nimport { API } from './tsServer/api';\nimport type * as Proto from './tsServer/protocol/protocol';\nimport { ITypeScriptServiceClient, ServerResponse } from './typescriptService';\nimport { nulToken } from './utils/cancellation';\n\n\nexport const enum ProjectType {\n\tTypeScript,\n\tJavaScript,\n}\n\nexport function isImplicitProjectConfigFile(configFileName: string) {\n\treturn configFileName.startsWith('/dev/null/');\n}\n\nexport function inferredProjectCompilerOptions(\n\tversion: API,\n\tprojectType: ProjectType,\n\tserviceConfig: TypeScriptServiceConfiguration,\n): Proto.ExternalProjectCompilerOptions {\n\tconst projectConfig: Proto.ExternalProjectCompilerOptions = {\n\t\tmodule: (version.gte(API.v540) ? 'Preserve' : 'ESNext') as Proto.ModuleKind,\n\t\tmoduleResolution: (version.gte(API.v540) ? 'Bundler' : 'Node') as Proto.ModuleResolutionKind,\n\t\ttarget: 'ES2022' as Proto.ScriptTarget,\n\t\tjsx: 'react' as Proto.JsxEmit,\n\t};\n\n\tif (version.gte(API.v500)) {\n\t\tprojectConfig.allowImportingTsExtensions = true;\n\t}\n\n\tif (serviceConfig.implicitProjectConfiguration.checkJs) {\n\t\tprojectConfig.checkJs = true;\n\t\tif (projectType === ProjectType.TypeScript) {\n\t\t\tprojectConfig.allowJs = true;\n\t\t}\n\t}\n\n\tif (serviceConfig.implicitProjectConfiguration.experimentalDecorators) {\n\t\tprojectConfig.experimentalDecorators = true;\n\t}\n\n\tif (serviceConfig.implicitProjectConfiguration.strictNullChecks) {\n\t\tprojectConfig.strictNullChecks = true;\n\t}\n\n\tif (serviceConfig.implicitProjectConfiguration.strictFunctionTypes) {\n\t\tprojectConfig.strictFunctionTypes = true;\n\t}\n\n\tif (serviceConfig.implicitProjectConfiguration.module) {\n\t\tprojectConfig.module = serviceConfig.implicitProjectConfiguration.module as Proto.ModuleKind;\n\t}\n\n\tif (serviceConfig.implicitProjectConfiguration.target) {\n\t\tprojectConfig.target = serviceConfig.implicitProjectConfiguration.target as Proto.ScriptTarget;\n\t}\n\n\tif (projectType === ProjectType.TypeScript) {\n\t\tprojectConfig.sourceMap = true;\n\t}\n\n\treturn projectConfig;\n}\n\nfunction inferredProjectConfigSnippet(\n\tversion: API,\n\tprojectType: ProjectType,\n\tconfig: TypeScriptServiceConfiguration\n) {\n\tconst baseConfig = inferredProjectCompilerOptions(version, projectType, config);\n\tif (projectType === ProjectType.TypeScript) {\n\t\tdelete baseConfig.allowImportingTsExtensions;\n\t}\n\n\tconst compilerOptions = Object.keys(baseConfig).map(key => `\"${key}\": ${JSON.stringify(baseConfig[key])}`);\n\treturn new vscode.SnippetString(`{\n\t\"compilerOptions\": {\n\t\t${compilerOptions.join(',\\n\\t\\t')}$0\n\t},\n\t\"exclude\": [\n\t\t\"node_modules\",\n\t\t\"**/node_modules/*\"\n\t]\n}`);\n}\n\nexport async function openOrCreateConfig(\n\tversion: API,\n\tprojectType: ProjectType,\n\trootPath: vscode.Uri,\n\tconfiguration: TypeScriptServiceConfiguration,\n): Promise<vscode.TextEditor | null> {\n\tconst configFile = vscode.Uri.joinPath(rootPath, projectType === ProjectType.TypeScript ? 'tsconfig.json' : 'jsconfig.json');\n\tconst col = vscode.window.activeTextEditor?.viewColumn;\n\ttry {\n\t\tconst doc = await vscode.workspace.openTextDocument(configFile);\n\t\treturn vscode.window.showTextDocument(doc, col);\n\t} catch {\n\t\tconst doc = await vscode.workspace.openTextDocument(configFile.with({ scheme: 'untitled' }));\n\t\tconst editor = await vscode.window.showTextDocument(doc, col);\n\t\tif (editor.document.getText().length === 0) {\n\t\t\tawait editor.insertSnippet(inferredProjectConfigSnippet(version, projectType, configuration));\n\t\t}\n\t\treturn editor;\n\t}\n}\n\nexport async function openProjectConfigOrPromptToCreate(\n\tprojectType: ProjectType,\n\tclient: ITypeScriptServiceClient,\n\trootPath: vscode.Uri,\n\tconfigFilePath: string,\n): Promise<void> {\n\tif (!isImplicitProjectConfigFile(configFilePath)) {\n\t\tconst doc = await vscode.workspace.openTextDocument(client.toResource(configFilePath));\n\t\tvscode.window.showTextDocument(doc, vscode.window.activeTextEditor?.viewColumn);\n\t\treturn;\n\t}\n\n\tconst CreateConfigItem: vscode.MessageItem = {\n\t\ttitle: projectType === ProjectType.TypeScript\n\t\t\t? vscode.l10n.t(\"Configure tsconfig.json\")\n\t\t\t: vscode.l10n.t(\"Configure jsconfig.json\"),\n\t};\n\n\tconst selected = await vscode.window.showInformationMessage(\n\t\t(projectType === ProjectType.TypeScript\n\t\t\t? vscode.l10n.t(\"File is not part of a TypeScript project. View the [tsconfig.json documentation]({0}) to learn more.\", 'https://go.microsoft.com/fwlink/?linkid=841896')\n\t\t\t: vscode.l10n.t(\"File is not part of a JavaScript project. View the [jsconfig.json documentation]({0}) to learn more.\", 'https://go.microsoft.com/fwlink/?linkid=759670')\n\t\t),\n\t\tCreateConfigItem);\n\n\tswitch (selected) {\n\t\tcase CreateConfigItem:\n\t\t\topenOrCreateConfig(client.apiVersion, projectType, rootPath, client.configuration);\n\t\t\treturn;\n\t}\n}\n\nexport async function openProjectConfigForFile(\n\tprojectType: ProjectType,\n\tclient: ITypeScriptServiceClient,\n\tresource: vscode.Uri,\n): Promise<void> {\n\tconst rootPath = client.getWorkspaceRootForResource(resource);\n\tif (!rootPath) {\n\t\tvscode.window.showInformationMessage(\n\t\t\tvscode.l10n.t(\"Please open a folder in VS Code to use a TypeScript or JavaScript project\"));\n\t\treturn;\n\t}\n\n\tconst file = client.toTsFilePath(resource);\n\t// TSServer errors when 'projectInfo' is invoked on a non js/ts file\n\tif (!file || !client.toTsFilePath(resource)) {\n\t\tvscode.window.showWarningMessage(\n\t\t\tvscode.l10n.t(\"Could not determine TypeScript or JavaScript project. Unsupported file type\"));\n\t\treturn;\n\t}\n\n\tlet res: ServerResponse.Response<Proto.ProjectInfoResponse> | undefined;\n\ttry {\n\t\tres = await client.execute('projectInfo', { file, needFileNameList: false }, nulToken);\n\t} catch {\n\t\t// noop\n\t}\n\n\tif (res?.type !== 'response' || !res.body) {\n\t\tvscode.window.showWarningMessage(vscode.l10n.t(\"Could not determine TypeScript or JavaScript project\"));\n\t\treturn;\n\t}\n\treturn openProjectConfigOrPromptToCreate(projectType, client, rootPath, res.body.configFileName);\n}\n\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n/**\n * Helpers for converting FROM vscode types TO ts types\n */\n\nimport * as vscode from 'vscode';\nimport type * as Proto from './tsServer/protocol/protocol';\nimport * as PConst from './tsServer/protocol/protocol.const';\nimport { ITypeScriptServiceClient } from './typescriptService';\n\nexport namespace Range {\n\texport const fromTextSpan = (span: Proto.TextSpan): vscode.Range =>\n\t\tfromLocations(span.start, span.end);\n\n\texport const toTextSpan = (range: vscode.Range): Proto.TextSpan => ({\n\t\tstart: Position.toLocation(range.start),\n\t\tend: Position.toLocation(range.end)\n\t});\n\n\texport const fromLocations = (start: Proto.Location, end: Proto.Location): vscode.Range =>\n\t\tnew vscode.Range(\n\t\t\tMath.max(0, start.line - 1), Math.max(start.offset - 1, 0),\n\t\t\tMath.max(0, end.line - 1), Math.max(0, end.offset - 1));\n\n\texport const toFileRange = (range: vscode.Range): Proto.FileRange => ({\n\t\tstartLine: range.start.line + 1,\n\t\tstartOffset: range.start.character + 1,\n\t\tendLine: range.end.line + 1,\n\t\tendOffset: range.end.character + 1\n\t});\n\n\texport const toFileRangeRequestArgs = (file: string, range: vscode.Range): Proto.FileRangeRequestArgs => ({\n\t\tfile,\n\t\t...toFileRange(range)\n\t});\n\n\texport const toFileRangesRequestArgs = (file: string, ranges: vscode.Range[]): Proto.FileRangesRequestArgs => ({\n\t\tfile,\n\t\tranges: ranges.map(toFileRange)\n\t});\n\n\texport const toFormattingRequestArgs = (file: string, range: vscode.Range): Proto.FormatRequestArgs => ({\n\t\tfile,\n\t\tline: range.start.line + 1,\n\t\toffset: range.start.character + 1,\n\t\tendLine: range.end.line + 1,\n\t\tendOffset: range.end.character + 1\n\t});\n}\n\nexport namespace Position {\n\texport const fromLocation = (tslocation: Proto.Location): vscode.Position =>\n\t\tnew vscode.Position(tslocation.line - 1, tslocation.offset - 1);\n\n\texport const toLocation = (vsPosition: vscode.Position): Proto.Location => ({\n\t\tline: vsPosition.line + 1,\n\t\toffset: vsPosition.character + 1,\n\t});\n\n\texport const toFileLocationRequestArgs = (file: string, position: vscode.Position): Proto.FileLocationRequestArgs => ({\n\t\tfile,\n\t\tline: position.line + 1,\n\t\toffset: position.character + 1,\n\t});\n}\n\nexport namespace Location {\n\texport const fromTextSpan = (resource: vscode.Uri, tsTextSpan: Proto.TextSpan): vscode.Location =>\n\t\tnew vscode.Location(resource, Range.fromTextSpan(tsTextSpan));\n}\n\nexport namespace TextEdit {\n\texport const fromCodeEdit = (edit: Proto.CodeEdit): vscode.TextEdit =>\n\t\tnew vscode.TextEdit(\n\t\t\tRange.fromTextSpan(edit),\n\t\t\tedit.newText);\n}\n\nexport namespace WorkspaceEdit {\n\texport function fromFileCodeEdits(\n\t\tclient: ITypeScriptServiceClient,\n\t\tedits: Iterable<Proto.FileCodeEdits>\n\t): vscode.WorkspaceEdit {\n\t\treturn withFileCodeEdits(new vscode.WorkspaceEdit(), client, edits);\n\t}\n\n\texport function withFileCodeEdits(\n\t\tworkspaceEdit: vscode.WorkspaceEdit,\n\t\tclient: ITypeScriptServiceClient,\n\t\tedits: Iterable<Proto.FileCodeEdits>\n\t): vscode.WorkspaceEdit {\n\t\tfor (const edit of edits) {\n\t\t\tconst resource = client.toResource(edit.fileName);\n\t\t\tfor (const textChange of edit.textChanges) {\n\t\t\t\tworkspaceEdit.replace(resource,\n\t\t\t\t\tRange.fromTextSpan(textChange),\n\t\t\t\t\ttextChange.newText);\n\t\t\t}\n\t\t}\n\n\t\treturn workspaceEdit;\n\t}\n}\n\nexport namespace SymbolKind {\n\texport function fromProtocolScriptElementKind(kind: Proto.ScriptElementKind) {\n\t\tswitch (kind) {\n\t\t\tcase PConst.Kind.module: return vscode.SymbolKind.Module;\n\t\t\tcase PConst.Kind.class: return vscode.SymbolKind.Class;\n\t\t\tcase PConst.Kind.enum: return vscode.SymbolKind.Enum;\n\t\t\tcase PConst.Kind.enumMember: return vscode.SymbolKind.EnumMember;\n\t\t\tcase PConst.Kind.interface: return vscode.SymbolKind.Interface;\n\t\t\tcase PConst.Kind.indexSignature: return vscode.SymbolKind.Method;\n\t\t\tcase PConst.Kind.callSignature: return vscode.SymbolKind.Method;\n\t\t\tcase PConst.Kind.method: return vscode.SymbolKind.Method;\n\t\t\tcase PConst.Kind.memberVariable: return vscode.SymbolKind.Property;\n\t\t\tcase PConst.Kind.memberGetAccessor: return vscode.SymbolKind.Property;\n\t\t\tcase PConst.Kind.memberSetAccessor: return vscode.SymbolKind.Property;\n\t\t\tcase PConst.Kind.variable: return vscode.SymbolKind.Variable;\n\t\t\tcase PConst.Kind.let: return vscode.SymbolKind.Variable;\n\t\t\tcase PConst.Kind.const: return vscode.SymbolKind.Variable;\n\t\t\tcase PConst.Kind.localVariable: return vscode.SymbolKind.Variable;\n\t\t\tcase PConst.Kind.alias: return vscode.SymbolKind.Variable;\n\t\t\tcase PConst.Kind.function: return vscode.SymbolKind.Function;\n\t\t\tcase PConst.Kind.localFunction: return vscode.SymbolKind.Function;\n\t\t\tcase PConst.Kind.constructSignature: return vscode.SymbolKind.Constructor;\n\t\t\tcase PConst.Kind.constructorImplementation: return vscode.SymbolKind.Constructor;\n\t\t\tcase PConst.Kind.typeParameter: return vscode.SymbolKind.TypeParameter;\n\t\t\tcase PConst.Kind.string: return vscode.SymbolKind.String;\n\t\t\tdefault: return vscode.SymbolKind.Variable;\n\t\t}\n\t}\n}\n\nexport namespace CompletionTriggerKind {\n\texport function toProtocolCompletionTriggerKind(kind: vscode.CompletionTriggerKind): Proto.CompletionTriggerKind {\n\t\tswitch (kind) {\n\t\t\tcase vscode.CompletionTriggerKind.Invoke: return 1;\n\t\t\tcase vscode.CompletionTriggerKind.TriggerCharacter: return 2;\n\t\t\tcase vscode.CompletionTriggerKind.TriggerForIncompleteCompletions: return 3;\n\t\t}\n\t}\n}\n\nexport namespace OrganizeImportsMode {\n\texport function toProtocolOrganizeImportsMode(mode: PConst.OrganizeImportsMode): Proto.OrganizeImportsMode {\n\t\tswitch (mode) {\n\t\t\tcase PConst.OrganizeImportsMode.All: return 'All' as Proto.OrganizeImportsMode.All;\n\t\t\tcase PConst.OrganizeImportsMode.SortAndCombine: return 'SortAndCombine' as Proto.OrganizeImportsMode.SortAndCombine;\n\t\t\tcase PConst.OrganizeImportsMode.RemoveUnused: return 'RemoveUnused' as Proto.OrganizeImportsMode.RemoveUnused;\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n/* --------------------------------------------------------------------------------------------\n * Includes code from typescript-sublime-plugin project, obtained from\n * https://github.com/microsoft/TypeScript-Sublime-Plugin/blob/master/TypeScript%20Indent.tmPreferences\n * ------------------------------------------------------------------------------------------ */\n\nimport * as vscode from 'vscode';\nimport { CommandManager } from './commands/commandManager';\nimport { ServiceConfigurationProvider } from './configuration/configuration';\nimport { DiagnosticLanguage, LanguageDescription } from './configuration/languageDescription';\nimport { IExperimentationTelemetryReporter } from './experimentTelemetryReporter';\nimport { DiagnosticKind } from './languageFeatures/diagnostics';\nimport FileConfigurationManager from './languageFeatures/fileConfigurationManager';\nimport LanguageProvider from './languageProvider';\nimport { LogLevelMonitor } from './logging/logLevelMonitor';\nimport { Logger } from './logging/logger';\nimport { OngoingRequestCancellerFactory } from './tsServer/cancellation';\nimport { ILogDirectoryProvider } from './tsServer/logDirectoryProvider';\nimport { PluginManager } from './tsServer/plugins';\nimport * as errorCodes from './tsServer/protocol/errorCodes';\nimport * as Proto from './tsServer/protocol/protocol';\nimport * as PConst from './tsServer/protocol/protocol.const';\nimport { TsServerProcessFactory } from './tsServer/server';\nimport { ITypeScriptVersionProvider } from './tsServer/versionProvider';\nimport * as typeConverters from './typeConverters';\nimport TypeScriptServiceClient from './typescriptServiceClient';\nimport { ActiveJsTsEditorTracker } from './ui/activeJsTsEditorTracker';\nimport { IntellisenseStatus } from './ui/intellisenseStatus';\nimport * as LargeProjectStatus from './ui/largeProjectStatus';\nimport TypingsStatus, { AtaProgressReporter } from './ui/typingsStatus';\nimport { VersionStatus } from './ui/versionStatus';\nimport { coalesce } from './utils/arrays';\nimport { Disposable } from './utils/dispose';\n\n// Style check diagnostics that can be reported as warnings\nconst styleCheckDiagnostics = new Set([\n\t...errorCodes.variableDeclaredButNeverUsed,\n\t...errorCodes.propertyDeclaretedButNeverUsed,\n\t...errorCodes.allImportsAreUnused,\n\t...errorCodes.unreachableCode,\n\t...errorCodes.unusedLabel,\n\t...errorCodes.fallThroughCaseInSwitch,\n\t...errorCodes.notAllCodePathsReturnAValue,\n]);\n\nexport default class TypeScriptServiceClientHost extends Disposable {\n\n\tprivate readonly client: TypeScriptServiceClient;\n\tprivate readonly languages: LanguageProvider[] = [];\n\tprivate readonly languagePerId = new Map<string, LanguageProvider>();\n\n\tprivate readonly typingsStatus: TypingsStatus;\n\n\tprivate readonly fileConfigurationManager: FileConfigurationManager;\n\n\tprivate reportStyleCheckAsWarnings: boolean = true;\n\n\tprivate readonly commandManager: CommandManager;\n\n\tconstructor(\n\t\tdescriptions: LanguageDescription[],\n\t\tcontext: vscode.ExtensionContext,\n\t\tonCaseInsensitiveFileSystem: boolean,\n\t\tservices: {\n\t\t\tpluginManager: PluginManager;\n\t\t\tcommandManager: CommandManager;\n\t\t\tlogDirectoryProvider: ILogDirectoryProvider;\n\t\t\tcancellerFactory: OngoingRequestCancellerFactory;\n\t\t\tversionProvider: ITypeScriptVersionProvider;\n\t\t\tprocessFactory: TsServerProcessFactory;\n\t\t\tactiveJsTsEditorTracker: ActiveJsTsEditorTracker;\n\t\t\tserviceConfigurationProvider: ServiceConfigurationProvider;\n\t\t\texperimentTelemetryReporter: IExperimentationTelemetryReporter | undefined;\n\t\t\tlogger: Logger;\n\t\t},\n\t\tonCompletionAccepted: (item: vscode.CompletionItem) => void,\n\t) {\n\t\tsuper();\n\n\t\tthis.commandManager = services.commandManager;\n\n\t\tconst allModeIds = this.getAllModeIds(descriptions, services.pluginManager);\n\t\tthis.client = this._register(new TypeScriptServiceClient(\n\t\t\tcontext,\n\t\t\tonCaseInsensitiveFileSystem,\n\t\t\tservices,\n\t\t\tallModeIds));\n\n\t\tthis.client.onDiagnosticsReceived(({ kind, resource, diagnostics, spans }) => {\n\t\t\tthis.diagnosticsReceived(kind, resource, diagnostics, spans);\n\t\t}, null, this._disposables);\n\n\t\tthis.client.onConfigDiagnosticsReceived(diag => this.configFileDiagnosticsReceived(diag), null, this._disposables);\n\t\tthis.client.onResendModelsRequested(() => this.populateService(), null, this._disposables);\n\n\t\tthis._register(new VersionStatus(this.client));\n\t\tthis._register(new IntellisenseStatus(this.client, services.commandManager, services.activeJsTsEditorTracker));\n\t\tthis._register(new AtaProgressReporter(this.client));\n\t\tthis.typingsStatus = this._register(new TypingsStatus(this.client));\n\t\tthis._register(LargeProjectStatus.create(this.client));\n\n\t\tthis.fileConfigurationManager = this._register(new FileConfigurationManager(this.client, onCaseInsensitiveFileSystem));\n\n\t\tfor (const description of descriptions) {\n\t\t\tconst manager = new LanguageProvider(this.client, description, this.commandManager, this.client.telemetryReporter, this.typingsStatus, this.fileConfigurationManager, onCompletionAccepted);\n\t\t\tthis.languages.push(manager);\n\t\t\tthis._register(manager);\n\t\t\tthis.languagePerId.set(description.id, manager);\n\t\t}\n\n\t\timport('./languageFeatures/updatePathsOnRename').then(module =>\n\t\t\tthis._register(module.register(this.client, this.fileConfigurationManager, uri => this.handles(uri))));\n\n\t\timport('./languageFeatures/workspaceSymbols').then(module =>\n\t\t\tthis._register(module.register(this.client, allModeIds)));\n\n\t\tthis.client.ensureServiceStarted();\n\t\tthis.client.onReady(() => {\n\t\t\tconst languages = new Set<string>();\n\t\t\tfor (const plugin of services.pluginManager.plugins) {\n\t\t\t\tif (plugin.configNamespace && plugin.languages.length) {\n\t\t\t\t\tthis.registerExtensionLanguageProvider({\n\t\t\t\t\t\tid: plugin.configNamespace,\n\t\t\t\t\t\tlanguageIds: Array.from(plugin.languages),\n\t\t\t\t\t\tdiagnosticSource: 'ts-plugin',\n\t\t\t\t\t\tdiagnosticLanguage: DiagnosticLanguage.TypeScript,\n\t\t\t\t\t\tdiagnosticOwner: 'typescript',\n\t\t\t\t\t\tisExternal: true,\n\t\t\t\t\t\tstandardFileExtensions: [],\n\t\t\t\t\t}, onCompletionAccepted);\n\t\t\t\t} else {\n\t\t\t\t\tfor (const language of plugin.languages) {\n\t\t\t\t\t\tlanguages.add(language);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (languages.size) {\n\t\t\t\tthis.registerExtensionLanguageProvider({\n\t\t\t\t\tid: 'typescript-plugins',\n\t\t\t\t\tlanguageIds: Array.from(languages.values()),\n\t\t\t\t\tdiagnosticSource: 'ts-plugin',\n\t\t\t\t\tdiagnosticLanguage: DiagnosticLanguage.TypeScript,\n\t\t\t\t\tdiagnosticOwner: 'typescript',\n\t\t\t\t\tisExternal: true,\n\t\t\t\t\tstandardFileExtensions: [],\n\t\t\t\t}, onCompletionAccepted);\n\t\t\t}\n\t\t});\n\n\t\tthis.client.onTsServerStarted(() => {\n\t\t\tthis.triggerAllDiagnostics();\n\t\t});\n\n\t\tvscode.workspace.onDidChangeConfiguration(this.configurationChanged, this, this._disposables);\n\t\tthis.configurationChanged();\n\t\tthis._register(new LogLevelMonitor(context));\n\t}\n\n\tprivate registerExtensionLanguageProvider(description: LanguageDescription, onCompletionAccepted: (item: vscode.CompletionItem) => void) {\n\t\tconst manager = new LanguageProvider(this.client, description, this.commandManager, this.client.telemetryReporter, this.typingsStatus, this.fileConfigurationManager, onCompletionAccepted);\n\t\tthis.languages.push(manager);\n\t\tthis._register(manager);\n\t\tthis.languagePerId.set(description.id, manager);\n\t}\n\n\tprivate getAllModeIds(descriptions: LanguageDescription[], pluginManager: PluginManager) {\n\t\treturn [\n\t\t\t...descriptions.map(x => x.languageIds),\n\t\t\t...pluginManager.plugins.map(x => x.languages)\n\t\t].flat();\n\t}\n\n\tpublic get serviceClient(): TypeScriptServiceClient {\n\t\treturn this.client;\n\t}\n\n\tpublic reloadProjects(): void {\n\t\tthis.client.executeWithoutWaitingForResponse('reloadProjects', null);\n\t\tthis.triggerAllDiagnostics();\n\t}\n\n\tpublic async handles(resource: vscode.Uri): Promise<boolean> {\n\t\tconst provider = await this.findLanguage(resource);\n\t\tif (provider) {\n\t\t\treturn true;\n\t\t}\n\t\treturn this.client.bufferSyncSupport.handles(resource);\n\t}\n\n\tprivate configurationChanged(): void {\n\t\tconst typescriptConfig = vscode.workspace.getConfiguration('typescript');\n\n\t\tthis.reportStyleCheckAsWarnings = typescriptConfig.get('reportStyleChecksAsWarnings', true);\n\t}\n\n\tprivate async findLanguage(resource: vscode.Uri): Promise<LanguageProvider | undefined> {\n\t\ttry {\n\t\t\t// First try finding language just based on the resource.\n\t\t\t// This is not strictly correct but should be in the vast majority of cases\n\t\t\t// (except when someone goes and maps `.js` to `typescript` or something...)\n\t\t\tfor (const language of this.languages) {\n\t\t\t\tif (language.handlesUri(resource)) {\n\t\t\t\t\treturn language;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// If that doesn't work, fallback to using a text document language mode.\n\t\t\t// This is not ideal since we have to open the document but should always\n\t\t\t// be correct\n\t\t\tconst doc = await vscode.workspace.openTextDocument(resource);\n\t\t\treturn this.languages.find(language => language.handlesDocument(doc));\n\t\t} catch {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tprivate triggerAllDiagnostics() {\n\t\tfor (const language of this.languagePerId.values()) {\n\t\t\tlanguage.triggerAllDiagnostics();\n\t\t}\n\t}\n\n\tprivate populateService(): void {\n\t\tthis.fileConfigurationManager.reset();\n\n\t\tfor (const language of this.languagePerId.values()) {\n\t\t\tlanguage.reInitialize();\n\t\t}\n\t}\n\n\tprivate async diagnosticsReceived(\n\t\tkind: DiagnosticKind,\n\t\tresource: vscode.Uri,\n\t\tdiagnostics: Proto.Diagnostic[],\n\t\tspans: Proto.TextSpan[] | undefined,\n\t): Promise<void> {\n\t\tconst language = await this.findLanguage(resource);\n\t\tif (language) {\n\t\t\tlanguage.diagnosticsReceived(\n\t\t\t\tkind,\n\t\t\t\tresource,\n\t\t\t\tthis.createMarkerDatas(diagnostics, language.diagnosticSource),\n\t\t\t\tspans?.map(span => typeConverters.Range.fromTextSpan(span)));\n\t\t}\n\t}\n\n\tprivate configFileDiagnosticsReceived(event: Proto.ConfigFileDiagnosticEvent): void {\n\t\t// See https://github.com/microsoft/TypeScript/issues/10384\n\t\tconst body = event.body;\n\t\tif (!body?.diagnostics || !body.configFile) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.findLanguage(this.client.toResource(body.configFile)).then(language => {\n\t\t\tlanguage?.configFileDiagnosticsReceived(this.client.toResource(body.configFile), body.diagnostics.map(tsDiag => {\n\t\t\t\tconst range = tsDiag.start && tsDiag.end ? typeConverters.Range.fromTextSpan(tsDiag) : new vscode.Range(0, 0, 0, 1);\n\t\t\t\tconst diagnostic = new vscode.Diagnostic(range, tsDiag.text, this.getDiagnosticSeverity(tsDiag));\n\t\t\t\tdiagnostic.source = language.diagnosticSource;\n\t\t\t\treturn diagnostic;\n\t\t\t}));\n\t\t});\n\t}\n\n\tprivate createMarkerDatas(\n\t\tdiagnostics: Proto.Diagnostic[],\n\t\tsource: string\n\t): (vscode.Diagnostic & { reportUnnecessary: any; reportDeprecated: any })[] {\n\t\treturn diagnostics.map(tsDiag => this.tsDiagnosticToVsDiagnostic(tsDiag, source));\n\t}\n\n\tprivate tsDiagnosticToVsDiagnostic(diagnostic: Proto.Diagnostic, source: string): vscode.Diagnostic & { reportUnnecessary: any; reportDeprecated: any } {\n\t\tconst { start, end, text } = diagnostic;\n\t\tconst range = new vscode.Range(typeConverters.Position.fromLocation(start), typeConverters.Position.fromLocation(end));\n\t\tconst converted = new vscode.Diagnostic(range, text, this.getDiagnosticSeverity(diagnostic));\n\t\tconverted.source = diagnostic.source || source;\n\t\tif (diagnostic.code) {\n\t\t\tconverted.code = diagnostic.code;\n\t\t}\n\t\tconst relatedInformation = diagnostic.relatedInformation;\n\t\tif (relatedInformation) {\n\t\t\tconverted.relatedInformation = coalesce(relatedInformation.map((info: any) => {\n\t\t\t\tconst span = info.span;\n\t\t\t\tif (!span) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t\treturn new vscode.DiagnosticRelatedInformation(typeConverters.Location.fromTextSpan(this.client.toResource(span.file), span), info.message);\n\t\t\t}));\n\t\t}\n\t\tconst tags: vscode.DiagnosticTag[] = [];\n\t\tif (diagnostic.reportsUnnecessary) {\n\t\t\ttags.push(vscode.DiagnosticTag.Unnecessary);\n\t\t}\n\t\tif (diagnostic.reportsDeprecated) {\n\t\t\ttags.push(vscode.DiagnosticTag.Deprecated);\n\t\t}\n\t\tconverted.tags = tags.length ? tags : undefined;\n\n\t\tconst resultConverted = converted as vscode.Diagnostic & { reportUnnecessary: any; reportDeprecated: any };\n\t\tresultConverted.reportUnnecessary = diagnostic.reportsUnnecessary;\n\t\tresultConverted.reportDeprecated = diagnostic.reportsDeprecated;\n\t\treturn resultConverted;\n\t}\n\n\tprivate getDiagnosticSeverity(diagnostic: Proto.Diagnostic): vscode.DiagnosticSeverity {\n\t\tif (this.reportStyleCheckAsWarnings\n\t\t\t&& this.isStyleCheckDiagnostic(diagnostic.code)\n\t\t\t&& diagnostic.category === PConst.DiagnosticCategory.error\n\t\t) {\n\t\t\treturn vscode.DiagnosticSeverity.Warning;\n\t\t}\n\n\t\tswitch (diagnostic.category) {\n\t\t\tcase PConst.DiagnosticCategory.error:\n\t\t\t\treturn vscode.DiagnosticSeverity.Error;\n\n\t\t\tcase PConst.DiagnosticCategory.warning:\n\t\t\t\treturn vscode.DiagnosticSeverity.Warning;\n\n\t\t\tcase PConst.DiagnosticCategory.suggestion:\n\t\t\t\treturn vscode.DiagnosticSeverity.Hint;\n\n\t\t\tdefault:\n\t\t\t\treturn vscode.DiagnosticSeverity.Error;\n\t\t}\n\t}\n\n\tprivate isStyleCheckDiagnostic(code: number | undefined): boolean {\n\t\treturn typeof code === 'number' && styleCheckDiagnostics.has(code);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as Proto from './tsServer/protocol/protocol';\nimport BufferSyncSupport from './tsServer/bufferSyncSupport';\nimport { ExecutionTarget } from './tsServer/server';\nimport { TypeScriptVersion } from './tsServer/versionProvider';\nimport { API } from './tsServer/api';\nimport { TypeScriptServiceConfiguration } from './configuration/configuration';\nimport { PluginManager } from './tsServer/plugins';\nimport { TelemetryReporter } from './logging/telemetry';\n\nexport enum ServerType {\n\tSyntax = 'syntax',\n\tSemantic = 'semantic',\n}\n\nexport namespace ServerResponse {\n\n\texport class Cancelled {\n\t\tpublic readonly type = 'cancelled';\n\n\t\tconstructor(\n\t\t\tpublic readonly reason: string\n\t\t) { }\n\t}\n\n\texport const NoContent = { type: 'noContent' } as const;\n\n\texport const NoServer = { type: 'noServer' } as const;\n\n\texport type Response<T extends Proto.Response> = T | Cancelled | typeof NoContent | typeof NoServer;\n}\n\ninterface StandardTsServerRequests {\n\t'applyCodeActionCommand': [Proto.ApplyCodeActionCommandRequestArgs, Proto.ApplyCodeActionCommandResponse];\n\t'completionEntryDetails': [Proto.CompletionDetailsRequestArgs, Proto.CompletionDetailsResponse];\n\t'completionInfo': [Proto.CompletionsRequestArgs, Proto.CompletionInfoResponse];\n\t'completions': [Proto.CompletionsRequestArgs, Proto.CompletionsResponse];\n\t'configure': [Proto.ConfigureRequestArguments, Proto.ConfigureResponse];\n\t'definition': [Proto.FileLocationRequestArgs, Proto.DefinitionResponse];\n\t'definitionAndBoundSpan': [Proto.FileLocationRequestArgs, Proto.DefinitionInfoAndBoundSpanResponse];\n\t'docCommentTemplate': [Proto.FileLocationRequestArgs, Proto.DocCommandTemplateResponse];\n\t'documentHighlights': [Proto.DocumentHighlightsRequestArgs, Proto.DocumentHighlightsResponse];\n\t'format': [Proto.FormatRequestArgs, Proto.FormatResponse];\n\t'formatonkey': [Proto.FormatOnKeyRequestArgs, Proto.FormatResponse];\n\t'getApplicableRefactors': [Proto.GetApplicableRefactorsRequestArgs, Proto.GetApplicableRefactorsResponse];\n\t'getCodeFixes': [Proto.CodeFixRequestArgs, Proto.CodeFixResponse];\n\t'getCombinedCodeFix': [Proto.GetCombinedCodeFixRequestArgs, Proto.GetCombinedCodeFixResponse];\n\t'getEditsForFileRename': [Proto.GetEditsForFileRenameRequestArgs, Proto.GetEditsForFileRenameResponse];\n\t'getEditsForRefactor': [Proto.GetEditsForRefactorRequestArgs, Proto.GetEditsForRefactorResponse];\n\t'getOutliningSpans': [Proto.FileRequestArgs, Proto.OutliningSpansResponse];\n\t'getSupportedCodeFixes': [null, Proto.GetSupportedCodeFixesResponse];\n\t'implementation': [Proto.FileLocationRequestArgs, Proto.ImplementationResponse];\n\t'jsxClosingTag': [Proto.JsxClosingTagRequestArgs, Proto.JsxClosingTagResponse];\n\t'navto': [Proto.NavtoRequestArgs, Proto.NavtoResponse];\n\t'navtree': [Proto.FileRequestArgs, Proto.NavTreeResponse];\n\t'organizeImports': [Proto.OrganizeImportsRequestArgs, Proto.OrganizeImportsResponse];\n\t'projectInfo': [Proto.ProjectInfoRequestArgs, Proto.ProjectInfoResponse];\n\t'quickinfo': [Proto.FileLocationRequestArgs, Proto.QuickInfoResponse];\n\t'references': [Proto.FileLocationRequestArgs, Proto.ReferencesResponse];\n\t'rename': [Proto.RenameRequestArgs, Proto.RenameResponse];\n\t'selectionRange': [Proto.SelectionRangeRequestArgs, Proto.SelectionRangeResponse];\n\t'signatureHelp': [Proto.SignatureHelpRequestArgs, Proto.SignatureHelpResponse];\n\t'typeDefinition': [Proto.FileLocationRequestArgs, Proto.TypeDefinitionResponse];\n\t'updateOpen': [Proto.UpdateOpenRequestArgs, Proto.Response];\n\t'prepareCallHierarchy': [Proto.FileLocationRequestArgs, Proto.PrepareCallHierarchyResponse];\n\t'provideCallHierarchyIncomingCalls': [Proto.FileLocationRequestArgs, Proto.ProvideCallHierarchyIncomingCallsResponse];\n\t'provideCallHierarchyOutgoingCalls': [Proto.FileLocationRequestArgs, Proto.ProvideCallHierarchyOutgoingCallsResponse];\n\t'fileReferences': [Proto.FileRequestArgs, Proto.FileReferencesResponse];\n\t'provideInlayHints': [Proto.InlayHintsRequestArgs, Proto.InlayHintsResponse];\n\t'encodedSemanticClassifications-full': [Proto.EncodedSemanticClassificationsRequestArgs, Proto.EncodedSemanticClassificationsResponse];\n\t'findSourceDefinition': [Proto.FileLocationRequestArgs, Proto.DefinitionResponse];\n\t'getMoveToRefactoringFileSuggestions': [Proto.GetMoveToRefactoringFileSuggestionsRequestArgs, Proto.GetMoveToRefactoringFileSuggestions];\n\t'linkedEditingRange': [Proto.FileLocationRequestArgs, Proto.LinkedEditingRangeResponse];\n\t'mapCode': [Proto.MapCodeRequestArgs, Proto.MapCodeResponse];\n\t'getPasteEdits': [Proto.GetPasteEditsRequestArgs, Proto.GetPasteEditsResponse];\n\t'preparePasteEdits': [Proto.PreparePasteEditsRequestArgs, Proto.PreparePasteEditsResponse];\n}\n\ninterface NoResponseTsServerRequests {\n\t'open': [Proto.OpenRequestArgs, null];\n\t'close': [Proto.FileRequestArgs, null];\n\t'change': [Proto.ChangeRequestArgs, null];\n\t'compilerOptionsForInferredProjects': [Proto.SetCompilerOptionsForInferredProjectsArgs, null];\n\t'reloadProjects': [null, null];\n\t'configurePlugin': [Proto.ConfigurePluginRequest, Proto.ConfigurePluginResponse];\n\t'watchChange': [Proto.Request, null];\n}\n\ninterface AsyncTsServerRequests {\n\t'geterr': [Proto.GeterrRequestArgs, Proto.Response];\n\t'geterrForProject': [Proto.GeterrForProjectRequestArgs, Proto.Response];\n}\n\nexport type TypeScriptRequests = StandardTsServerRequests & NoResponseTsServerRequests & AsyncTsServerRequests;\n\nexport type ExecConfig = {\n\treadonly lowPriority?: boolean;\n\treadonly nonRecoverable?: boolean;\n\treadonly cancelOnResourceChange?: vscode.Uri;\n\treadonly executionTarget?: ExecutionTarget;\n};\n\nexport enum ClientCapability {\n\t/**\n\t * Basic syntax server. All clients should support this.\n\t */\n\tSyntax,\n\n\t/**\n\t * Advanced syntax server that can provide single file IntelliSense.\n\t */\n\tEnhancedSyntax,\n\n\t/**\n\t * Complete, multi-file semantic server\n\t */\n\tSemantic,\n}\n\nexport class ClientCapabilities {\n\tprivate readonly capabilities: ReadonlySet<ClientCapability>;\n\n\tconstructor(...capabilities: ClientCapability[]) {\n\t\tthis.capabilities = new Set(capabilities);\n\t}\n\n\tpublic has(capability: ClientCapability): boolean {\n\t\treturn this.capabilities.has(capability);\n\t}\n}\n\nexport interface ITypeScriptServiceClient {\n\n\t/**\n\t * Convert a (VS Code) resource to a path that TypeScript server understands.\n\t */\n\ttoTsFilePath(resource: vscode.Uri): string | undefined;\n\n\t/**\n\t * Convert a path to a resource.\n\t */\n\ttoResource(filepath: string): vscode.Uri;\n\n\t/**\n\t * Tries to ensure that a vscode document is open on the TS server.\n\t *\n\t * @return The normalized path or `undefined` if the document is not open on the server.\n\t */\n\ttoOpenTsFilePath(document: vscode.TextDocument | vscode.Uri, options?: {\n\t\tsuppressAlertOnFailure?: boolean;\n\t}): string | undefined;\n\n\t/**\n\t * Checks if `resource` has a given capability.\n\t */\n\thasCapabilityForResource(resource: vscode.Uri, capability: ClientCapability): boolean;\n\n\tgetWorkspaceRootForResource(resource: vscode.Uri): vscode.Uri | undefined;\n\n\treadonly onTsServerStarted: vscode.Event<{ version: TypeScriptVersion; usedApiVersion: API }>;\n\treadonly onProjectLanguageServiceStateChanged: vscode.Event<Proto.ProjectLanguageServiceStateEventBody>;\n\treadonly onDidBeginInstallTypings: vscode.Event<Proto.BeginInstallTypesEventBody>;\n\treadonly onDidEndInstallTypings: vscode.Event<Proto.EndInstallTypesEventBody>;\n\treadonly onTypesInstallerInitializationFailed: vscode.Event<Proto.TypesInstallerInitializationFailedEventBody>;\n\n\treadonly capabilities: ClientCapabilities;\n\treadonly onDidChangeCapabilities: vscode.Event<void>;\n\n\tonReady(f: () => void): Promise<void>;\n\n\tshowVersionPicker(): void;\n\n\treadonly apiVersion: API;\n\n\treadonly pluginManager: PluginManager;\n\treadonly configuration: TypeScriptServiceConfiguration;\n\treadonly bufferSyncSupport: BufferSyncSupport;\n\treadonly telemetryReporter: TelemetryReporter;\n\n\texecute<K extends keyof StandardTsServerRequests>(\n\t\tcommand: K,\n\t\targs: StandardTsServerRequests[K][0],\n\t\ttoken: vscode.CancellationToken,\n\t\tconfig?: ExecConfig\n\t): Promise<ServerResponse.Response<StandardTsServerRequests[K][1]>>;\n\n\texecuteWithoutWaitingForResponse<K extends keyof NoResponseTsServerRequests>(\n\t\tcommand: K,\n\t\targs: NoResponseTsServerRequests[K][0]\n\t): void;\n\n\texecuteAsync<K extends keyof AsyncTsServerRequests>(\n\t\tcommand: K,\n\t\targs: AsyncTsServerRequests[K][0],\n\t\ttoken: vscode.CancellationToken\n\t): Promise<ServerResponse.Response<Proto.Response>>;\n\n\t/**\n\t * Cancel on going geterr requests and re-queue them after `f` has been evaluated.\n\t */\n\tinterruptGetErr<R>(f: () => R): R;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { homedir } from 'os';\nimport * as path from 'path';\nimport * as vscode from 'vscode';\nimport { ServiceConfigurationProvider, SyntaxServerConfiguration, TsServerLogLevel, TypeScriptServiceConfiguration, areServiceConfigurationsEqual } from './configuration/configuration';\nimport * as fileSchemes from './configuration/fileSchemes';\nimport { Schemes } from './configuration/schemes';\nimport { IExperimentationTelemetryReporter } from './experimentTelemetryReporter';\nimport { DiagnosticKind, DiagnosticsManager } from './languageFeatures/diagnostics';\nimport { Logger } from './logging/logger';\nimport { TelemetryReporter, VSCodeTelemetryReporter } from './logging/telemetry';\nimport Tracer from './logging/tracer';\nimport { ProjectType, inferredProjectCompilerOptions } from './tsconfig';\nimport { API } from './tsServer/api';\nimport BufferSyncSupport from './tsServer/bufferSyncSupport';\nimport { OngoingRequestCancellerFactory } from './tsServer/cancellation';\nimport { ILogDirectoryProvider } from './tsServer/logDirectoryProvider';\nimport { NodeVersionManager } from './tsServer/nodeManager';\nimport { TypeScriptPluginPathsProvider } from './tsServer/pluginPathsProvider';\nimport { PluginManager } from './tsServer/plugins';\nimport * as Proto from './tsServer/protocol/protocol';\nimport { EventName } from './tsServer/protocol/protocol.const';\nimport { ITypeScriptServer, TsServerLog, TsServerProcessFactory, TypeScriptServerExitEvent } from './tsServer/server';\nimport { TypeScriptServerError } from './tsServer/serverError';\nimport { TypeScriptServerSpawner } from './tsServer/spawner';\nimport { TypeScriptVersionManager } from './tsServer/versionManager';\nimport { ITypeScriptVersionProvider, TypeScriptVersion } from './tsServer/versionProvider';\nimport { ClientCapabilities, ClientCapability, ExecConfig, ITypeScriptServiceClient, ServerResponse, TypeScriptRequests } from './typescriptService';\nimport { Disposable, DisposableStore, disposeAll } from './utils/dispose';\nimport { hash } from './utils/hash';\nimport { isWeb, isWebAndHasSharedArrayBuffers } from './utils/platform';\n\n\nexport interface TsDiagnostics {\n\treadonly kind: DiagnosticKind;\n\treadonly resource: vscode.Uri;\n\treadonly diagnostics: Proto.Diagnostic[];\n\treadonly spans?: Proto.TextSpan[];\n}\n\ninterface ToCancelOnResourceChanged {\n\treadonly resource: vscode.Uri;\n\tcancel(): void;\n}\n\nnamespace ServerState {\n\texport const enum Type {\n\t\tNone,\n\t\tRunning,\n\t\tErrored\n\t}\n\n\texport const None = { type: Type.None } as const;\n\n\texport class Running {\n\t\treadonly type = Type.Running;\n\n\t\tconstructor(\n\t\t\tpublic readonly server: ITypeScriptServer,\n\n\t\t\t/**\n\t\t\t * API version obtained from the version picker after checking the corresponding path exists.\n\t\t\t */\n\t\t\tpublic readonly apiVersion: API,\n\n\t\t\t/**\n\t\t\t * Version reported by currently-running tsserver.\n\t\t\t */\n\t\t\tpublic tsserverVersion: string | undefined,\n\t\t\tpublic languageServiceEnabled: boolean,\n\t\t) { }\n\n\t\tpublic readonly toCancelOnResourceChange = new Set<ToCancelOnResourceChanged>();\n\n\t\tupdateTsserverVersion(tsserverVersion: string) {\n\t\t\tthis.tsserverVersion = tsserverVersion;\n\t\t}\n\n\t\tupdateLanguageServiceEnabled(enabled: boolean) {\n\t\t\tthis.languageServiceEnabled = enabled;\n\t\t}\n\t}\n\n\texport class Errored {\n\t\treadonly type = Type.Errored;\n\t\tconstructor(\n\t\t\tpublic readonly error: Error,\n\t\t\tpublic readonly tsServerLog: TsServerLog | undefined,\n\t\t) { }\n\t}\n\n\texport type State = typeof None | Running | Errored;\n}\n\nexport const emptyAuthority = 'ts-nul-authority';\n\nexport const inMemoryResourcePrefix = '^';\n\ninterface WatchEvent {\n\tupdated?: Set<string>;\n\tcreated?: Set<string>;\n\tdeleted?: Set<string>;\n}\n\nexport default class TypeScriptServiceClient extends Disposable implements ITypeScriptServiceClient {\n\n\n\tprivate readonly _onReady?: { promise: Promise<void>; resolve: () => void; reject: () => void };\n\tprivate _configuration: TypeScriptServiceConfiguration;\n\tprivate readonly pluginPathsProvider: TypeScriptPluginPathsProvider;\n\tprivate readonly _versionManager: TypeScriptVersionManager;\n\tprivate readonly _nodeVersionManager: NodeVersionManager;\n\n\tprivate readonly logger: Logger;\n\tprivate readonly tracer: Tracer;\n\n\tprivate readonly typescriptServerSpawner: TypeScriptServerSpawner;\n\tprivate serverState: ServerState.State = ServerState.None;\n\tprivate lastStart: number;\n\tprivate numberRestarts: number;\n\tprivate _isPromptingAfterCrash = false;\n\tprivate isRestarting: boolean = false;\n\tprivate hasServerFatallyCrashedTooManyTimes = false;\n\tprivate readonly loadingIndicator: ServerInitializingIndicator;\n\n\tpublic readonly telemetryReporter: TelemetryReporter;\n\tpublic readonly bufferSyncSupport: BufferSyncSupport;\n\tpublic readonly diagnosticsManager: DiagnosticsManager;\n\tpublic readonly pluginManager: PluginManager;\n\n\tprivate readonly logDirectoryProvider: ILogDirectoryProvider;\n\tprivate readonly cancellerFactory: OngoingRequestCancellerFactory;\n\tprivate readonly versionProvider: ITypeScriptVersionProvider;\n\tprivate readonly processFactory: TsServerProcessFactory;\n\n\tprivate readonly watches = new Map<number, Disposable>();\n\tprivate readonly watchEvents = new Map<number, WatchEvent>();\n\tprivate watchChangeTimeout: NodeJS.Timeout | undefined;\n\n\tconstructor(\n\t\tprivate readonly context: vscode.ExtensionContext,\n\t\tonCaseInsensitiveFileSystem: boolean,\n\t\tservices: {\n\t\t\tpluginManager: PluginManager;\n\t\t\tlogDirectoryProvider: ILogDirectoryProvider;\n\t\t\tcancellerFactory: OngoingRequestCancellerFactory;\n\t\t\tversionProvider: ITypeScriptVersionProvider;\n\t\t\tprocessFactory: TsServerProcessFactory;\n\t\t\tserviceConfigurationProvider: ServiceConfigurationProvider;\n\t\t\texperimentTelemetryReporter: IExperimentationTelemetryReporter | undefined;\n\t\t\tlogger: Logger;\n\t\t},\n\t\tallModeIds: readonly string[]\n\t) {\n\t\tsuper();\n\n\t\tthis.loadingIndicator = this._register(new ServerInitializingIndicator(this));\n\n\t\tthis.logger = services.logger;\n\t\tthis.tracer = new Tracer(this.logger);\n\n\t\tthis.pluginManager = services.pluginManager;\n\t\tthis.logDirectoryProvider = services.logDirectoryProvider;\n\t\tthis.cancellerFactory = services.cancellerFactory;\n\t\tthis.versionProvider = services.versionProvider;\n\t\tthis.processFactory = services.processFactory;\n\n\t\tthis.lastStart = Date.now();\n\n\t\tlet resolve: () => void;\n\t\tlet reject: () => void;\n\t\tconst p = new Promise<void>((res, rej) => {\n\t\t\tresolve = res;\n\t\t\treject = rej;\n\t\t});\n\t\tthis._onReady = { promise: p, resolve: resolve!, reject: reject! };\n\n\t\tthis.numberRestarts = 0;\n\n\t\tthis._configuration = services.serviceConfigurationProvider.loadFromWorkspace();\n\t\tthis.versionProvider.updateConfiguration(this._configuration);\n\n\t\tthis.pluginPathsProvider = new TypeScriptPluginPathsProvider(this._configuration);\n\t\tthis._versionManager = this._register(new TypeScriptVersionManager(this._configuration, this.versionProvider, context.workspaceState));\n\t\tthis._register(this._versionManager.onDidPickNewVersion(() => {\n\t\t\tthis.restartTsServer();\n\t\t}));\n\n\t\tthis._nodeVersionManager = this._register(new NodeVersionManager(this._configuration, context.workspaceState));\n\t\tthis._register(this._nodeVersionManager.onDidPickNewVersion(() => {\n\t\t\tthis.restartTsServer();\n\t\t}));\n\n\t\tthis.bufferSyncSupport = new BufferSyncSupport(this, allModeIds, onCaseInsensitiveFileSystem);\n\t\tthis.onReady(() => { this.bufferSyncSupport.listen(); });\n\n\t\tthis.bufferSyncSupport.onDelete(resource => {\n\t\t\tthis.cancelInflightRequestsForResource(resource);\n\t\t\tthis.diagnosticsManager.deleteAllDiagnosticsInFile(resource);\n\t\t}, null, this._disposables);\n\n\t\tthis.bufferSyncSupport.onWillChange(resource => {\n\t\t\tthis.cancelInflightRequestsForResource(resource);\n\t\t});\n\n\t\tvscode.workspace.onDidChangeConfiguration(() => {\n\t\t\tconst oldConfiguration = this._configuration;\n\t\t\tthis._configuration = services.serviceConfigurationProvider.loadFromWorkspace();\n\n\t\t\tthis.versionProvider.updateConfiguration(this._configuration);\n\t\t\tthis._versionManager.updateConfiguration(this._configuration);\n\t\t\tthis.pluginPathsProvider.updateConfiguration(this._configuration);\n\t\t\tthis._nodeVersionManager.updateConfiguration(this._configuration);\n\n\t\t\tif (this.serverState.type === ServerState.Type.Running) {\n\t\t\t\tif (!this._configuration.implicitProjectConfiguration.isEqualTo(oldConfiguration.implicitProjectConfiguration)) {\n\t\t\t\t\tthis.setCompilerOptionsForInferredProjects(this._configuration);\n\t\t\t\t}\n\n\t\t\t\tif (!areServiceConfigurationsEqual(this._configuration, oldConfiguration)) {\n\t\t\t\t\tthis.restartTsServer();\n\t\t\t\t}\n\t\t\t}\n\t\t}, this, this._disposables);\n\n\t\tthis.telemetryReporter = new VSCodeTelemetryReporter(services.experimentTelemetryReporter, () => {\n\t\t\tif (this.serverState.type === ServerState.Type.Running) {\n\t\t\t\tif (this.serverState.tsserverVersion) {\n\t\t\t\t\treturn this.serverState.tsserverVersion;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this.apiVersion.fullVersionString;\n\t\t});\n\n\t\tthis.diagnosticsManager = new DiagnosticsManager('typescript', this._configuration, this.telemetryReporter, onCaseInsensitiveFileSystem);\n\t\tthis.typescriptServerSpawner = new TypeScriptServerSpawner(this.versionProvider, this._versionManager, this._nodeVersionManager, this.logDirectoryProvider, this.pluginPathsProvider, this.logger, this.telemetryReporter, this.tracer, this.processFactory);\n\n\t\tthis._register(this.pluginManager.onDidUpdateConfig(update => {\n\t\t\tthis.configurePlugin(update.pluginId, update.config);\n\t\t}));\n\n\t\tthis._register(this.pluginManager.onDidChangePlugins(() => {\n\t\t\tthis.restartTsServer();\n\t\t}));\n\t}\n\n\tpublic get capabilities() {\n\t\tif (this._configuration.useSyntaxServer === SyntaxServerConfiguration.Always) {\n\t\t\treturn new ClientCapabilities(\n\t\t\t\tClientCapability.Syntax,\n\t\t\t\tClientCapability.EnhancedSyntax);\n\t\t}\n\n\t\tif (isWeb()) {\n\t\t\tif (this.isProjectWideIntellisenseOnWebEnabled()) {\n\t\t\t\treturn new ClientCapabilities(\n\t\t\t\t\tClientCapability.Syntax,\n\t\t\t\t\tClientCapability.EnhancedSyntax,\n\t\t\t\t\tClientCapability.Semantic);\n\t\t\t} else {\n\t\t\t\treturn new ClientCapabilities(\n\t\t\t\t\tClientCapability.Syntax,\n\t\t\t\t\tClientCapability.EnhancedSyntax);\n\t\t\t}\n\t\t}\n\n\t\tif (this.apiVersion.gte(API.v400)) {\n\t\t\treturn new ClientCapabilities(\n\t\t\t\tClientCapability.Syntax,\n\t\t\t\tClientCapability.EnhancedSyntax,\n\t\t\t\tClientCapability.Semantic);\n\t\t}\n\n\t\treturn new ClientCapabilities(\n\t\t\tClientCapability.Syntax,\n\t\t\tClientCapability.Semantic);\n\t}\n\n\tprivate readonly _onDidChangeCapabilities = this._register(new vscode.EventEmitter<void>());\n\treadonly onDidChangeCapabilities = this._onDidChangeCapabilities.event;\n\n\tprivate isProjectWideIntellisenseOnWebEnabled(): boolean {\n\t\treturn isWebAndHasSharedArrayBuffers() && this._configuration.webProjectWideIntellisenseEnabled;\n\t}\n\n\tprivate cancelInflightRequestsForResource(resource: vscode.Uri): void {\n\t\tif (this.serverState.type !== ServerState.Type.Running) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const request of this.serverState.toCancelOnResourceChange) {\n\t\t\tif (request.resource.toString() === resource.toString()) {\n\t\t\t\trequest.cancel();\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic get configuration() {\n\t\treturn this._configuration;\n\t}\n\n\tpublic override dispose() {\n\t\tsuper.dispose();\n\n\t\tthis.bufferSyncSupport.dispose();\n\n\t\tif (this.serverState.type === ServerState.Type.Running) {\n\t\t\tthis.serverState.server.kill();\n\t\t}\n\n\t\tthis.loadingIndicator.reset();\n\n\t\tthis.resetWatchers();\n\t}\n\n\tpublic restartTsServer(fromUserAction = false): void {\n\t\tif (this.serverState.type === ServerState.Type.Running) {\n\t\t\tthis.logger.info('Killing TS Server');\n\t\t\tthis.isRestarting = true;\n\t\t\tthis.serverState.server.kill();\n\t\t}\n\n\t\tif (fromUserAction) {\n\t\t\t// Reset crash trackers\n\t\t\tthis.hasServerFatallyCrashedTooManyTimes = false;\n\t\t\tthis.numberRestarts = 0;\n\t\t\tthis.lastStart = Date.now();\n\t\t}\n\n\t\tthis.serverState = this.startService(true);\n\t}\n\n\tprivate readonly _onTsServerStarted = this._register(new vscode.EventEmitter<{ version: TypeScriptVersion; usedApiVersion: API }>());\n\tpublic readonly onTsServerStarted = this._onTsServerStarted.event;\n\n\tprivate readonly _onDiagnosticsReceived = this._register(new vscode.EventEmitter<TsDiagnostics>());\n\tpublic readonly onDiagnosticsReceived = this._onDiagnosticsReceived.event;\n\n\tprivate readonly _onConfigDiagnosticsReceived = this._register(new vscode.EventEmitter<Proto.ConfigFileDiagnosticEvent>());\n\tpublic readonly onConfigDiagnosticsReceived = this._onConfigDiagnosticsReceived.event;\n\n\tprivate readonly _onResendModelsRequested = this._register(new vscode.EventEmitter<void>());\n\tpublic readonly onResendModelsRequested = this._onResendModelsRequested.event;\n\n\tprivate readonly _onProjectLanguageServiceStateChanged = this._register(new vscode.EventEmitter<Proto.ProjectLanguageServiceStateEventBody>());\n\tpublic readonly onProjectLanguageServiceStateChanged = this._onProjectLanguageServiceStateChanged.event;\n\n\tprivate readonly _onDidBeginInstallTypings = this._register(new vscode.EventEmitter<Proto.BeginInstallTypesEventBody>());\n\tpublic readonly onDidBeginInstallTypings = this._onDidBeginInstallTypings.event;\n\n\tprivate readonly _onDidEndInstallTypings = this._register(new vscode.EventEmitter<Proto.EndInstallTypesEventBody>());\n\tpublic readonly onDidEndInstallTypings = this._onDidEndInstallTypings.event;\n\n\tprivate readonly _onTypesInstallerInitializationFailed = this._register(new vscode.EventEmitter<Proto.TypesInstallerInitializationFailedEventBody>());\n\tpublic readonly onTypesInstallerInitializationFailed = this._onTypesInstallerInitializationFailed.event;\n\n\tprivate readonly _onSurveyReady = this._register(new vscode.EventEmitter<Proto.SurveyReadyEventBody>());\n\tpublic readonly onSurveyReady = this._onSurveyReady.event;\n\n\tpublic get apiVersion(): API {\n\t\tif (this.serverState.type === ServerState.Type.Running) {\n\t\t\treturn this.serverState.apiVersion;\n\t\t}\n\t\treturn API.defaultVersion;\n\t}\n\n\tpublic onReady(f: () => void): Promise<void> {\n\t\treturn this._onReady!.promise.then(f);\n\t}\n\n\tpublic ensureServiceStarted() {\n\t\tif (this.serverState.type !== ServerState.Type.Running) {\n\t\t\tthis.startService();\n\t\t}\n\t}\n\n\tprivate token: number = 0;\n\tprivate startService(resendModels: boolean = false): ServerState.State {\n\t\tthis.logger.info(`Starting TS Server`);\n\n\t\tif (this.isDisposed) {\n\t\t\tthis.logger.info(`Not starting server: disposed`);\n\t\t\treturn ServerState.None;\n\t\t}\n\n\t\tif (this.hasServerFatallyCrashedTooManyTimes) {\n\t\t\tthis.logger.info(`Not starting server: too many crashes`);\n\t\t\treturn ServerState.None;\n\t\t}\n\n\t\tlet version = this._versionManager.currentVersion;\n\t\tif (!version.isValid) {\n\t\t\tvscode.window.showWarningMessage(vscode.l10n.t(\"The path {0} doesn't point to a valid tsserver install. Falling back to bundled TypeScript version.\", version.path));\n\n\t\t\tthis._versionManager.reset();\n\t\t\tversion = this._versionManager.currentVersion;\n\t\t}\n\n\t\tthis.logger.info(`Using tsserver from: ${version.path}`);\n\t\tconst nodePath = this._nodeVersionManager.currentVersion;\n\t\tif (nodePath) {\n\t\t\tthis.logger.info(`Using Node installation from ${nodePath} to run TS Server`);\n\t\t}\n\n\t\tthis.resetWatchers();\n\n\t\tconst apiVersion = version.apiVersion || API.defaultVersion;\n\t\tconst mytoken = ++this.token;\n\t\tconst handle = this.typescriptServerSpawner.spawn(version, this.capabilities, this.configuration, this.pluginManager, this.cancellerFactory, {\n\t\t\tonFatalError: (command, err) => this.fatalError(command, err),\n\t\t});\n\t\tthis.serverState = new ServerState.Running(handle, apiVersion, undefined, true);\n\t\tthis.lastStart = Date.now();\n\n\n\t\t/* __GDPR__FRAGMENT__\n\t\t\t\"TypeScriptServerEnvCommonProperties\" : {\n\t\t\t\t\"hasGlobalPlugins\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"globalPluginNameHashes\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n\t\t\t}\n\t\t*/\n\t\tconst typeScriptServerEnvCommonProperties = {\n\t\t\thasGlobalPlugins: this.pluginManager.plugins.length > 0,\n\t\t\tglobalPluginNameHashes: JSON.stringify(this.pluginManager.plugins.map(plugin => hash(plugin.name))),\n\t\t};\n\n\t\t/* __GDPR__\n\t\t\t\"tsserver.spawned\" : {\n\t\t\t\t\"owner\": \"mjbvz\",\n\t\t\t\t\"${include}\": [\n\t\t\t\t\t\"${TypeScriptCommonProperties}\",\n\t\t\t\t\t\"${TypeScriptServerEnvCommonProperties}\"\n\t\t\t\t],\n\t\t\t\t\"localTypeScriptVersion\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"typeScriptVersionSource\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n\t\t\t}\n\t\t*/\n\t\tthis.telemetryReporter.logTelemetry('tsserver.spawned', {\n\t\t\t...typeScriptServerEnvCommonProperties,\n\t\t\tlocalTypeScriptVersion: this.versionProvider.localVersion ? this.versionProvider.localVersion.displayName : '',\n\t\t\ttypeScriptVersionSource: version.source,\n\t\t});\n\n\t\thandle.onError((err: Error) => {\n\t\t\tif (this.token !== mytoken) {\n\t\t\t\t// this is coming from an old process\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (err) {\n\t\t\t\tvscode.window.showErrorMessage(vscode.l10n.t(\"TypeScript language server exited with error. Error message is: {0}\", err.message || err.name));\n\t\t\t}\n\n\t\t\tthis.serverState = new ServerState.Errored(err, handle.tsServerLog);\n\t\t\tthis.logger.error('TSServer errored with error.', err);\n\t\t\tif (handle.tsServerLog?.type === 'file') {\n\t\t\t\tthis.logger.error(`TSServer log file: ${handle.tsServerLog.uri.fsPath}`);\n\t\t\t}\n\n\t\t\t/* __GDPR__\n\t\t\t\t\"tsserver.error\" : {\n\t\t\t\t\t\"owner\": \"mjbvz\",\n\t\t\t\t\t\"${include}\": [\n\t\t\t\t\t\t\"${TypeScriptCommonProperties}\",\n\t\t\t\t\t\t\"${TypeScriptServerEnvCommonProperties}\"\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t*/\n\t\t\tthis.telemetryReporter.logTelemetry('tsserver.error', {\n\t\t\t\t...typeScriptServerEnvCommonProperties\n\t\t\t});\n\t\t\tthis.serviceExited(false, apiVersion);\n\t\t});\n\n\t\thandle.onExit((data: TypeScriptServerExitEvent) => {\n\t\t\tconst { code, signal } = data;\n\t\t\tthis.logger.error(`TSServer exited. Code: ${code}. Signal: ${signal}`);\n\n\t\t\t// In practice, the exit code is an integer with no ties to any identity,\n\t\t\t// so it can be classified as SystemMetaData, rather than CallstackOrException.\n\t\t\t/* __GDPR__\n\t\t\t\t\"tsserver.exitWithCode\" : {\n\t\t\t\t\t\"owner\": \"mjbvz\",\n\t\t\t\t\t\"${include}\": [\n\t\t\t\t\t\t\"${TypeScriptCommonProperties}\",\n\t\t\t\t\t\t\"${TypeScriptServerEnvCommonProperties}\"\n\t\t\t\t\t],\n\t\t\t\t\t\"code\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\t\t\t\"signal\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" }\n\t\t\t\t}\n\t\t\t*/\n\t\t\tthis.telemetryReporter.logTelemetry('tsserver.exitWithCode', {\n\t\t\t\t...typeScriptServerEnvCommonProperties,\n\t\t\t\tcode: code ?? undefined,\n\t\t\t\tsignal: signal ?? undefined,\n\t\t\t});\n\n\t\t\tif (this.token !== mytoken) {\n\t\t\t\t// this is coming from an old process\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (handle.tsServerLog?.type === 'file') {\n\t\t\t\tthis.logger.info(`TSServer log file: ${handle.tsServerLog.uri.fsPath}`);\n\t\t\t}\n\t\t\tthis.serviceExited(!this.isRestarting, apiVersion);\n\t\t\tthis.isRestarting = false;\n\t\t});\n\n\t\thandle.onEvent(event => this.dispatchEvent(event));\n\n\t\tthis.serviceStarted(resendModels);\n\n\t\tthis._onReady!.resolve();\n\t\tthis._onTsServerStarted.fire({ version: version, usedApiVersion: apiVersion });\n\t\tthis._onDidChangeCapabilities.fire();\n\t\treturn this.serverState;\n\t}\n\n\tprivate resetWatchers() {\n\t\tclearTimeout(this.watchChangeTimeout);\n\t\tdisposeAll(Array.from(this.watches.values()));\n\t}\n\n\tpublic async showVersionPicker(): Promise<void> {\n\t\tthis._versionManager.promptUserForVersion();\n\t}\n\n\tpublic async openTsServerLogFile(): Promise<boolean> {\n\t\tif (this._configuration.tsServerLogLevel === TsServerLogLevel.Off) {\n\t\t\tvscode.window.showErrorMessage<vscode.MessageItem>(\n\t\t\t\tvscode.l10n.t(\"TS Server logging is off. Please set 'typescript.tsserver.log' and restart the TS server to enable logging\"),\n\t\t\t\t{\n\t\t\t\t\ttitle: vscode.l10n.t(\"Enable logging and restart TS server\"),\n\t\t\t\t})\n\t\t\t\t.then(selection => {\n\t\t\t\t\tif (selection) {\n\t\t\t\t\t\treturn vscode.workspace.getConfiguration().update('typescript.tsserver.log', 'verbose', true).then(() => {\n\t\t\t\t\t\t\tthis.restartTsServer();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn undefined;\n\t\t\t\t});\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.serverState.type !== ServerState.Type.Running || !this.serverState.server.tsServerLog) {\n\t\t\tvscode.window.showWarningMessage(vscode.l10n.t(\"TS Server has not started logging.\"));\n\t\t\treturn false;\n\t\t}\n\n\t\tswitch (this.serverState.server.tsServerLog.type) {\n\t\t\tcase 'output': {\n\t\t\t\tthis.serverState.server.tsServerLog.output.show();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tcase 'file': {\n\t\t\t\ttry {\n\t\t\t\t\tconst doc = await vscode.workspace.openTextDocument(this.serverState.server.tsServerLog.uri);\n\t\t\t\t\tawait vscode.window.showTextDocument(doc);\n\t\t\t\t\treturn true;\n\t\t\t\t} catch {\n\t\t\t\t\t// noop\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tawait vscode.commands.executeCommand('revealFileInOS', this.serverState.server.tsServerLog.uri);\n\t\t\t\t\treturn true;\n\t\t\t\t} catch {\n\t\t\t\t\tvscode.window.showWarningMessage(vscode.l10n.t(\"Could not open TS Server log file\"));\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate serviceStarted(resendModels: boolean): void {\n\t\tthis.bufferSyncSupport.reset();\n\n\t\tconst watchOptions = this.apiVersion.gte(API.v380)\n\t\t\t? this.configuration.watchOptions\n\t\t\t: undefined;\n\n\t\tconst configureOptions: Proto.ConfigureRequestArguments = {\n\t\t\thostInfo: 'vscode',\n\t\t\tpreferences: {\n\t\t\t\tprovidePrefixAndSuffixTextForRename: true,\n\t\t\t\tallowRenameOfImportPath: true,\n\t\t\t\tincludePackageJsonAutoImports: this._configuration.includePackageJsonAutoImports,\n\t\t\t\texcludeLibrarySymbolsInNavTo: this._configuration.workspaceSymbolsExcludeLibrarySymbols,\n\t\t\t},\n\t\t\twatchOptions\n\t\t};\n\t\tthis.executeWithoutWaitingForResponse('configure', configureOptions);\n\t\tthis.setCompilerOptionsForInferredProjects(this._configuration);\n\t\tif (resendModels) {\n\t\t\tthis._onResendModelsRequested.fire();\n\t\t\tthis.bufferSyncSupport.reinitialize();\n\t\t\tthis.bufferSyncSupport.requestAllDiagnostics();\n\t\t}\n\n\t\t// Reconfigure any plugins\n\t\tfor (const [pluginName, config] of this.pluginManager.configurations()) {\n\t\t\tthis.configurePlugin(pluginName, config);\n\t\t}\n\t}\n\n\tprivate setCompilerOptionsForInferredProjects(configuration: TypeScriptServiceConfiguration): void {\n\t\tconst args: Proto.SetCompilerOptionsForInferredProjectsArgs = {\n\t\t\toptions: this.getCompilerOptionsForInferredProjects(configuration)\n\t\t};\n\t\tthis.executeWithoutWaitingForResponse('compilerOptionsForInferredProjects', args);\n\t}\n\n\tprivate getCompilerOptionsForInferredProjects(configuration: TypeScriptServiceConfiguration): Proto.ExternalProjectCompilerOptions {\n\t\treturn {\n\t\t\t...inferredProjectCompilerOptions(this.apiVersion, ProjectType.TypeScript, configuration),\n\t\t\tallowJs: true,\n\t\t\tallowSyntheticDefaultImports: true,\n\t\t\tallowNonTsExtensions: true,\n\t\t\tresolveJsonModule: true,\n\t\t};\n\t}\n\n\tprivate serviceExited(restart: boolean, tsVersion: API): void {\n\t\tthis.resetWatchers();\n\t\tthis.loadingIndicator.reset();\n\n\t\tthis.serverState = ServerState.None;\n\n\t\tif (restart) {\n\t\t\tconst diff = Date.now() - this.lastStart;\n\t\t\tthis.numberRestarts++;\n\t\t\tlet startService = true;\n\n\t\t\tconst pluginExtensionList = this.pluginManager.plugins.map(plugin => plugin.extension.id).join(', ');\n\t\t\tconst reportIssueItem: vscode.MessageItem = {\n\t\t\t\ttitle: vscode.l10n.t(\"Report Issue\"),\n\t\t\t};\n\t\t\tlet prompt: Thenable<undefined | vscode.MessageItem> | undefined = undefined;\n\n\t\t\tif (this.numberRestarts > 5) {\n\t\t\t\tthis.numberRestarts = 0;\n\t\t\t\tif (diff < 10 * 1000 /* 10 seconds */) {\n\t\t\t\t\tthis.lastStart = Date.now();\n\t\t\t\t\tstartService = false;\n\t\t\t\t\tthis.hasServerFatallyCrashedTooManyTimes = true;\n\t\t\t\t\tif (this.pluginManager.plugins.length) {\n\t\t\t\t\t\tprompt = vscode.window.showErrorMessage<vscode.MessageItem>(\n\t\t\t\t\t\t\tvscode.l10n.t(\"The JS/TS language service immediately crashed 5 times. The service will not be restarted.\\nThis may be caused by a plugin contributed by one of these extensions: {0}.\\nPlease try disabling these extensions before filing an issue against VS Code.\", pluginExtensionList));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tprompt = vscode.window.showErrorMessage(\n\t\t\t\t\t\t\tvscode.l10n.t(\"The JS/TS language service immediately crashed 5 times. The service will not be restarted.\"),\n\t\t\t\t\t\t\treportIssueItem);\n\t\t\t\t\t}\n\n\t\t\t\t\t/* __GDPR__\n\t\t\t\t\t\t\"serviceExited\" : {\n\t\t\t\t\t\t\t\"owner\": \"mjbvz\",\n\t\t\t\t\t\t\t\"${include}\": [\n\t\t\t\t\t\t\t\t\"${TypeScriptCommonProperties}\"\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t*/\n\t\t\t\t\tthis.telemetryReporter.logTelemetry('serviceExited');\n\t\t\t\t} else if (diff < 60 * 1000 * 5 /* 5 Minutes */) {\n\t\t\t\t\tthis.lastStart = Date.now();\n\t\t\t\t\tif (!this._isPromptingAfterCrash) {\n\t\t\t\t\t\tif (this.pluginManager.plugins.length) {\n\t\t\t\t\t\t\tprompt = vscode.window.showWarningMessage<vscode.MessageItem>(\n\t\t\t\t\t\t\t\tvscode.l10n.t(\"The JS/TS language service crashed 5 times in the last 5 Minutes.\\nThis may be caused by a plugin contributed by one of these extensions: {0}\\nPlease try disabling these extensions before filing an issue against VS Code.\", pluginExtensionList));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tprompt = vscode.window.showWarningMessage(\n\t\t\t\t\t\t\t\tvscode.l10n.t(\"The JS/TS language service crashed 5 times in the last 5 Minutes.\"),\n\t\t\t\t\t\t\t\treportIssueItem);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (['vscode-insiders', 'code-oss'].includes(vscode.env.uriScheme)) {\n\t\t\t\t// Prompt after a single restart\n\t\t\t\tthis.numberRestarts = 0;\n\t\t\t\tif (!this._isPromptingAfterCrash) {\n\t\t\t\t\tif (this.pluginManager.plugins.length) {\n\t\t\t\t\t\tprompt = vscode.window.showWarningMessage<vscode.MessageItem>(\n\t\t\t\t\t\t\tvscode.l10n.t(\"The JS/TS language service crashed.\\nThis may be caused by a plugin contributed by one of these extensions: {0}.\\nPlease try disabling these extensions before filing an issue against VS Code.\", pluginExtensionList));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tprompt = vscode.window.showWarningMessage(\n\t\t\t\t\t\t\tvscode.l10n.t(\"The JS/TS language service crashed.\"),\n\t\t\t\t\t\t\treportIssueItem);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (prompt) {\n\t\t\t\tthis._isPromptingAfterCrash = true;\n\t\t\t}\n\n\t\t\tprompt?.then(async item => {\n\t\t\t\tthis._isPromptingAfterCrash = false;\n\n\t\t\t\tif (item === reportIssueItem) {\n\n\t\t\t\t\tconst minModernTsVersion = this.versionProvider.bundledVersion.apiVersion;\n\n\t\t\t\t\t// Don't allow reporting issues using the PnP patched version of TS Server\n\t\t\t\t\tif (tsVersion.isYarnPnp()) {\n\t\t\t\t\t\tconst reportIssue: vscode.MessageItem = {\n\t\t\t\t\t\t\ttitle: vscode.l10n.t(\"Report issue against Yarn PnP\"),\n\t\t\t\t\t\t};\n\t\t\t\t\t\tconst response = await vscode.window.showWarningMessage(\n\t\t\t\t\t\t\tvscode.l10n.t(\"Please report an issue against Yarn PnP\"),\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmodal: true,\n\t\t\t\t\t\t\t\tdetail: vscode.l10n.t(\"The workspace is using a version of the TypeScript Server that has been patched by Yarn PnP. This patching is a common source of bugs.\"),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\treportIssue);\n\n\t\t\t\t\t\tif (response === reportIssue) {\n\t\t\t\t\t\t\tvscode.env.openExternal(vscode.Uri.parse('https://github.com/yarnpkg/berry/issues'));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// Don't allow reporting issues with old TS versions\n\t\t\t\t\telse if (\n\t\t\t\t\t\tminModernTsVersion &&\n\t\t\t\t\t\ttsVersion.lt(minModernTsVersion)\n\t\t\t\t\t) {\n\t\t\t\t\t\tvscode.window.showWarningMessage(\n\t\t\t\t\t\t\tvscode.l10n.t(\"Please update your TypeScript version\"),\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmodal: true,\n\t\t\t\t\t\t\t\tdetail: vscode.l10n.t(\n\t\t\t\t\t\t\t\t\t\"The workspace is using an old version of TypeScript ({0}).\\n\\nBefore reporting an issue, please update the workspace to use TypeScript {1} or newer to make sure the bug has not already been fixed.\",\n\t\t\t\t\t\t\t\t\ttsVersion.displayName,\n\t\t\t\t\t\t\t\t\tminModernTsVersion.displayName),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvscode.env.openExternal(vscode.Uri.parse('https://github.com/microsoft/vscode/wiki/TypeScript-Issues'));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (startService) {\n\t\t\t\tthis.startService(true);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic toTsFilePath(resource: vscode.Uri): string | undefined {\n\t\tif (fileSchemes.disabledSchemes.has(resource.scheme)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (resource.scheme === fileSchemes.file && !isWeb()) {\n\t\t\treturn resource.fsPath;\n\t\t}\n\n\t\treturn (this.isProjectWideIntellisenseOnWebEnabled() ? '' : inMemoryResourcePrefix)\n\t\t\t+ '/' + resource.scheme\n\t\t\t+ '/' + (resource.authority || emptyAuthority)\n\t\t\t+ (resource.path.startsWith('/') ? resource.path : '/' + resource.path)\n\t\t\t+ (resource.fragment ? '#' + resource.fragment : '');\n\t}\n\n\n\tpublic toOpenTsFilePath(document: vscode.TextDocument | vscode.Uri, options: { suppressAlertOnFailure?: boolean } = {}): string | undefined {\n\t\tconst uri = document instanceof vscode.Uri ? document : document.uri;\n\t\tif (!this.bufferSyncSupport.ensureHasBuffer(uri)) {\n\t\t\tif (!options.suppressAlertOnFailure && !fileSchemes.disabledSchemes.has(uri.scheme)) {\n\t\t\t\tconsole.error(`Unexpected resource ${uri}`);\n\t\t\t}\n\t\t\treturn undefined;\n\t\t}\n\t\treturn this.toTsFilePath(uri);\n\t}\n\n\tpublic hasCapabilityForResource(resource: vscode.Uri, capability: ClientCapability): boolean {\n\t\tif (!this.capabilities.has(capability)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tswitch (capability) {\n\t\t\tcase ClientCapability.Semantic: {\n\t\t\t\treturn fileSchemes.getSemanticSupportedSchemes().includes(resource.scheme);\n\t\t\t}\n\t\t\tcase ClientCapability.Syntax:\n\t\t\tcase ClientCapability.EnhancedSyntax: {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic toResource(filepath: string): vscode.Uri {\n\t\tif (isWeb()) {\n\t\t\t// On web, the stdlib paths that TS return look like: '/lib.es2015.collection.d.ts'\n\t\t\t// TODO: Find out what extensionUri is when testing (should be http://localhost:8080/static/sources/extensions/typescript-language-features/)\n\t\t\t// TODO:  make sure that this code path is getting hit\n\t\t\tif (filepath.startsWith('/lib.') && filepath.endsWith('.d.ts')) {\n\t\t\t\treturn vscode.Uri.joinPath(this.context.extensionUri, 'dist', 'browser', 'typescript', filepath.slice(1));\n\t\t\t}\n\t\t\tconst parts = filepath.match(/^\\/([^\\/]+)\\/([^\\/]*)\\/(.+)$/);\n\t\t\tif (parts) {\n\t\t\t\tconst resource = vscode.Uri.parse(parts[1] + '://' + (parts[2] === emptyAuthority ? '' : parts[2]) + '/' + parts[3]);\n\t\t\t\treturn this.bufferSyncSupport.toVsCodeResource(resource);\n\t\t\t}\n\t\t}\n\n\t\tif (filepath.startsWith(inMemoryResourcePrefix)) {\n\t\t\tconst parts = filepath.match(/^\\^\\/([^\\/]+)\\/([^\\/]*)\\/(.+)$/);\n\t\t\tif (parts) {\n\t\t\t\tconst resource = vscode.Uri.parse(parts[1] + '://' + (parts[2] === emptyAuthority ? '' : parts[2]) + '/' + parts[3]);\n\t\t\t\treturn this.bufferSyncSupport.toVsCodeResource(resource);\n\t\t\t}\n\t\t}\n\t\treturn this.bufferSyncSupport.toResource(filepath);\n\t}\n\n\tpublic getWorkspaceRootForResource(resource: vscode.Uri): vscode.Uri | undefined {\n\t\tconst roots = vscode.workspace.workspaceFolders ? Array.from(vscode.workspace.workspaceFolders) : undefined;\n\t\tif (!roots?.length) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// For notebook cells, we need to use the notebook document to look up the workspace\n\t\tif (resource.scheme === Schemes.notebookCell) {\n\t\t\tfor (const notebook of vscode.workspace.notebookDocuments) {\n\t\t\t\tfor (const cell of notebook.getCells()) {\n\t\t\t\t\tif (cell.document.uri.toString() === resource.toString()) {\n\t\t\t\t\t\tresource = notebook.uri;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Find the highest level workspace folder that contains the file\n\t\tfor (const root of roots.sort((a, b) => a.uri.path.length - b.uri.path.length)) {\n\t\t\tif (root.uri.scheme === resource.scheme && root.uri.authority === resource.authority) {\n\t\t\t\tif (resource.path.startsWith(root.uri.path + '/')) {\n\t\t\t\t\treturn root.uri;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn vscode.workspace.getWorkspaceFolder(resource)?.uri;\n\t}\n\n\tpublic execute(command: keyof TypeScriptRequests, args: any, token: vscode.CancellationToken, config?: ExecConfig): Promise<ServerResponse.Response<Proto.Response>> {\n\t\tlet executions: Array<Promise<ServerResponse.Response<Proto.Response>> | undefined> | undefined;\n\n\t\tif (config?.cancelOnResourceChange) {\n\t\t\tconst runningServerState = this.serverState;\n\t\t\tif (runningServerState.type === ServerState.Type.Running) {\n\t\t\t\tconst source = new vscode.CancellationTokenSource();\n\t\t\t\ttoken.onCancellationRequested(() => source.cancel());\n\n\t\t\t\tconst inFlight: ToCancelOnResourceChanged = {\n\t\t\t\t\tresource: config.cancelOnResourceChange,\n\t\t\t\t\tcancel: () => source.cancel(),\n\t\t\t\t};\n\t\t\t\trunningServerState.toCancelOnResourceChange.add(inFlight);\n\n\t\t\t\texecutions = this.executeImpl(command, args, {\n\t\t\t\t\tisAsync: false,\n\t\t\t\t\ttoken: source.token,\n\t\t\t\t\texpectsResult: true,\n\t\t\t\t\t...config,\n\t\t\t\t});\n\t\t\t\texecutions[0]!.finally(() => {\n\t\t\t\t\trunningServerState.toCancelOnResourceChange.delete(inFlight);\n\t\t\t\t\tsource.dispose();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (!executions) {\n\t\t\texecutions = this.executeImpl(command, args, {\n\t\t\t\tisAsync: false,\n\t\t\t\ttoken,\n\t\t\t\texpectsResult: true,\n\t\t\t\t...config,\n\t\t\t});\n\t\t}\n\n\t\tif (config?.nonRecoverable) {\n\t\t\texecutions[0]!.catch(err => this.fatalError(command, err));\n\t\t}\n\n\t\tif (command === 'updateOpen') {\n\t\t\t// If update open has completed, consider that the project has loaded\n\t\t\tconst updateOpenTask = Promise.all(executions).then(() => {\n\t\t\t\tthis.loadingIndicator.reset();\n\t\t\t});\n\n\t\t\tconst updateOpenArgs = (args as Proto.UpdateOpenRequestArgs);\n\t\t\tif (updateOpenArgs.openFiles?.length === 1) {\n\t\t\t\tthis.loadingIndicator.startedLoadingFile(updateOpenArgs.openFiles[0].file, updateOpenTask);\n\t\t\t}\n\t\t}\n\n\t\treturn executions[0]!;\n\t}\n\n\tpublic executeWithoutWaitingForResponse(command: keyof TypeScriptRequests, args: any): void {\n\t\tthis.executeImpl(command, args, {\n\t\t\tisAsync: false,\n\t\t\ttoken: undefined,\n\t\t\texpectsResult: false\n\t\t});\n\t}\n\n\tpublic executeAsync(command: keyof TypeScriptRequests, args: Proto.GeterrRequestArgs, token: vscode.CancellationToken): Promise<ServerResponse.Response<Proto.Response>> {\n\t\treturn this.executeImpl(command, args, {\n\t\t\tisAsync: true,\n\t\t\ttoken,\n\t\t\texpectsResult: true\n\t\t})[0]!;\n\t}\n\n\tprivate executeImpl(command: keyof TypeScriptRequests, args: any, executeInfo: { isAsync: boolean; token?: vscode.CancellationToken; expectsResult: boolean; lowPriority?: boolean; requireSemantic?: boolean }): Array<Promise<ServerResponse.Response<Proto.Response>> | undefined> {\n\t\tconst serverState = this.serverState;\n\t\tif (serverState.type === ServerState.Type.Running) {\n\t\t\tthis.bufferSyncSupport.beforeCommand(command);\n\t\t\treturn serverState.server.executeImpl(command, args, executeInfo);\n\t\t} else {\n\t\t\treturn [Promise.resolve(ServerResponse.NoServer)];\n\t\t}\n\t}\n\n\tpublic interruptGetErr<R>(f: () => R): R {\n\t\treturn this.bufferSyncSupport.interruptGetErr(f);\n\t}\n\n\tprivate fatalError(command: string, error: unknown): void {\n\t\t/* __GDPR__\n\t\t\t\"fatalError\" : {\n\t\t\t\t\"owner\": \"mjbvz\",\n\t\t\t\t\"${include}\": [\n\t\t\t\t\t\"${TypeScriptCommonProperties}\",\n\t\t\t\t\t\"${TypeScriptRequestErrorProperties}\"\n\t\t\t\t],\n\t\t\t\t\"command\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" }\n\t\t\t}\n\t\t*/\n\t\tthis.telemetryReporter.logTelemetry('fatalError', { ...(error instanceof TypeScriptServerError ? error.telemetry : { command }) });\n\t\tconsole.error(`A non-recoverable error occurred while executing tsserver command: ${command}`);\n\t\tif (error instanceof TypeScriptServerError && error.serverErrorText) {\n\t\t\tconsole.error(error.serverErrorText);\n\t\t}\n\n\t\tif (this.serverState.type === ServerState.Type.Running) {\n\t\t\tthis.logger.info('Killing TS Server');\n\t\t\tconst logfile = this.serverState.server.tsServerLog;\n\t\t\tthis.serverState.server.kill();\n\t\t\tif (error instanceof TypeScriptServerError) {\n\t\t\t\tthis.serverState = new ServerState.Errored(error, logfile);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate dispatchEvent(event: Proto.Event) {\n\t\tswitch (event.event) {\n\t\t\tcase EventName.syntaxDiag:\n\t\t\tcase EventName.semanticDiag:\n\t\t\tcase EventName.suggestionDiag:\n\t\t\tcase EventName.regionSemanticDiag: {\n\t\t\t\t// This event also roughly signals that projects have been loaded successfully (since the TS server is synchronous)\n\t\t\t\tthis.loadingIndicator.reset();\n\n\t\t\t\tconst diagnosticEvent = event as Proto.DiagnosticEvent;\n\t\t\t\tif (diagnosticEvent.body?.diagnostics) {\n\t\t\t\t\tthis._onDiagnosticsReceived.fire({\n\t\t\t\t\t\tkind: getDiagnosticsKind(event),\n\t\t\t\t\t\tresource: this.toResource(diagnosticEvent.body.file),\n\t\t\t\t\t\tdiagnostics: diagnosticEvent.body.diagnostics,\n\t\t\t\t\t\tspans: diagnosticEvent.body.spans,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcase EventName.configFileDiag:\n\t\t\t\tthis._onConfigDiagnosticsReceived.fire(event as Proto.ConfigFileDiagnosticEvent);\n\t\t\t\treturn;\n\n\t\t\tcase EventName.telemetry: {\n\t\t\t\tconst body = (event as Proto.TelemetryEvent).body;\n\t\t\t\tthis.dispatchTelemetryEvent(body);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcase EventName.projectLanguageServiceState: {\n\t\t\t\tconst body = (event as Proto.ProjectLanguageServiceStateEvent).body!;\n\t\t\t\tif (this.serverState.type === ServerState.Type.Running) {\n\t\t\t\t\tthis.serverState.updateLanguageServiceEnabled(body.languageServiceEnabled);\n\t\t\t\t}\n\t\t\t\tthis._onProjectLanguageServiceStateChanged.fire(body);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcase EventName.projectsUpdatedInBackground: {\n\t\t\t\tthis.loadingIndicator.reset();\n\n\t\t\t\tconst body = (event as Proto.ProjectsUpdatedInBackgroundEvent).body;\n\t\t\t\tconst resources = body.openFiles.map(file => this.toResource(file));\n\t\t\t\tthis.bufferSyncSupport.getErr(resources);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcase EventName.beginInstallTypes:\n\t\t\t\tthis._onDidBeginInstallTypings.fire((event as Proto.BeginInstallTypesEvent).body);\n\t\t\t\treturn;\n\n\t\t\tcase EventName.endInstallTypes:\n\t\t\t\tthis._onDidEndInstallTypings.fire((event as Proto.EndInstallTypesEvent).body);\n\t\t\t\treturn;\n\n\t\t\tcase EventName.typesInstallerInitializationFailed:\n\t\t\t\tthis._onTypesInstallerInitializationFailed.fire((event as Proto.TypesInstallerInitializationFailedEvent).body);\n\t\t\t\treturn;\n\n\t\t\tcase EventName.surveyReady:\n\t\t\t\tthis._onSurveyReady.fire((event as Proto.SurveyReadyEvent).body);\n\t\t\t\treturn;\n\n\t\t\tcase EventName.projectLoadingStart:\n\t\t\t\tthis.loadingIndicator.startedLoadingProject((event as Proto.ProjectLoadingStartEvent).body.projectName);\n\t\t\t\treturn;\n\n\t\t\tcase EventName.projectLoadingFinish:\n\t\t\t\tthis.loadingIndicator.finishedLoadingProject((event as Proto.ProjectLoadingFinishEvent).body.projectName);\n\t\t\t\treturn;\n\n\t\t\tcase EventName.createDirectoryWatcher: {\n\t\t\t\tconst fpath = (event.body as Proto.CreateDirectoryWatcherEventBody).path;\n\t\t\t\tif (fpath.startsWith(inMemoryResourcePrefix)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (process.platform === 'darwin' && fpath === path.join(homedir(), 'Library')) {\n\t\t\t\t\t// ignore directory watch requests on ~/Library\n\t\t\t\t\t// until microsoft/TypeScript#59831 is resolved\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.createFileSystemWatcher(\n\t\t\t\t\t(event.body as Proto.CreateDirectoryWatcherEventBody).id,\n\t\t\t\t\tnew vscode.RelativePattern(\n\t\t\t\t\t\tvscode.Uri.file(fpath),\n\t\t\t\t\t\t(event.body as Proto.CreateDirectoryWatcherEventBody).recursive ? '**' : '*'\n\t\t\t\t\t),\n\t\t\t\t\t(event.body as Proto.CreateDirectoryWatcherEventBody).ignoreUpdate\n\t\t\t\t);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcase EventName.createFileWatcher: {\n\t\t\t\tconst path = (event.body as Proto.CreateFileWatcherEventBody).path;\n\t\t\t\tif (path.startsWith(inMemoryResourcePrefix)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.createFileSystemWatcher(\n\t\t\t\t\t(event.body as Proto.CreateFileWatcherEventBody).id,\n\t\t\t\t\tnew vscode.RelativePattern(\n\t\t\t\t\t\tvscode.Uri.file(path),\n\t\t\t\t\t\t'*'\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcase EventName.closeFileWatcher:\n\t\t\t\tthis.closeFileSystemWatcher(event.body.id);\n\t\t\t\treturn;\n\n\t\t\tcase EventName.requestCompleted: {\n\t\t\t\tconst diagnosticsDuration = (event.body as Proto.RequestCompletedEventBody).performanceData?.diagnosticsDuration;\n\t\t\t\tif (diagnosticsDuration) {\n\t\t\t\t\tthis.diagnosticsManager.logDiagnosticsPerformanceTelemetry(\n\t\t\t\t\t\tdiagnosticsDuration.map(fileData => {\n\t\t\t\t\t\t\tconst resource = this.toResource(fileData.file);\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t...fileData,\n\t\t\t\t\t\t\t\tfileLineCount: this.bufferSyncSupport.lineCount(resource),\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate scheduleExecuteWatchChangeRequest() {\n\t\tif (!this.watchChangeTimeout) {\n\t\t\tthis.watchChangeTimeout = setTimeout(() => {\n\t\t\t\tthis.watchChangeTimeout = undefined;\n\t\t\t\tconst allEvents = Array.from(this.watchEvents, ([id, event]) => ({\n\t\t\t\t\tid,\n\t\t\t\t\tupdated: event.updated && Array.from(event.updated),\n\t\t\t\t\tcreated: event.created && Array.from(event.created),\n\t\t\t\t\tdeleted: event.deleted && Array.from(event.deleted)\n\t\t\t\t}));\n\t\t\t\tthis.watchEvents.clear();\n\t\t\t\tthis.executeWithoutWaitingForResponse('watchChange', allEvents);\n\t\t\t}, 100); /* aggregate events over 100ms to reduce client<->server IPC overhead */\n\t\t}\n\t}\n\n\tprivate addWatchEvent(id: number, eventType: keyof WatchEvent, path: string) {\n\t\tlet event = this.watchEvents.get(id);\n\t\tconst removeEvent = (typeOfEventToRemove: keyof WatchEvent) => {\n\t\t\tif (event?.[typeOfEventToRemove]?.delete(path) && event[typeOfEventToRemove].size === 0) {\n\t\t\t\tevent[typeOfEventToRemove] = undefined;\n\t\t\t}\n\t\t};\n\t\tconst aggregateEvent = () => {\n\t\t\tif (!event) {\n\t\t\t\tthis.watchEvents.set(id, event = {});\n\t\t\t}\n\t\t\t(event[eventType] ??= new Set()).add(path);\n\t\t};\n\t\tswitch (eventType) {\n\t\t\tcase 'created':\n\t\t\t\tremoveEvent('deleted');\n\t\t\t\tremoveEvent('updated');\n\t\t\t\taggregateEvent();\n\t\t\t\tbreak;\n\t\t\tcase 'deleted':\n\t\t\t\tremoveEvent('created');\n\t\t\t\tremoveEvent('updated');\n\t\t\t\taggregateEvent();\n\t\t\t\tbreak;\n\t\t\tcase 'updated':\n\t\t\t\tif (event?.created?.has(path)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tremoveEvent('deleted');\n\t\t\t\taggregateEvent();\n\t\t\t\tbreak;\n\t\t}\n\t\tthis.scheduleExecuteWatchChangeRequest();\n\t}\n\n\tprivate createFileSystemWatcher(\n\t\tid: number,\n\t\tpattern: vscode.RelativePattern,\n\t\tignoreChangeEvents?: boolean,\n\t) {\n\t\tconst disposable = new DisposableStore();\n\t\tconst watcher = disposable.add(vscode.workspace.createFileSystemWatcher(pattern, undefined, ignoreChangeEvents));\n\t\tdisposable.add(watcher.onDidChange(changeFile =>\n\t\t\tthis.addWatchEvent(id, 'updated', changeFile.fsPath)\n\t\t));\n\t\tdisposable.add(watcher.onDidCreate(createFile =>\n\t\t\tthis.addWatchEvent(id, 'created', createFile.fsPath)\n\t\t));\n\t\tdisposable.add(watcher.onDidDelete(deletedFile =>\n\t\t\tthis.addWatchEvent(id, 'deleted', deletedFile.fsPath)\n\t\t));\n\t\tdisposable.add({\n\t\t\tdispose: () => {\n\t\t\t\tthis.watchEvents.delete(id);\n\t\t\t\tthis.watches.delete(id);\n\t\t\t}\n\t\t});\n\n\t\tif (this.watches.has(id)) {\n\t\t\tthis.closeFileSystemWatcher(id);\n\t\t}\n\t\tthis.watches.set(id, disposable);\n\t}\n\n\tprivate closeFileSystemWatcher(id: number) {\n\t\tconst existing = this.watches.get(id);\n\t\texisting?.dispose();\n\t}\n\n\tprivate dispatchTelemetryEvent(telemetryData: Proto.TelemetryEventBody): void {\n\t\tconst properties: { [key: string]: string } = Object.create(null);\n\t\tswitch (telemetryData.telemetryEventName) {\n\t\t\tcase 'typingsInstalled': {\n\t\t\t\tconst typingsInstalledPayload: Proto.TypingsInstalledTelemetryEventPayload = (telemetryData.payload as Proto.TypingsInstalledTelemetryEventPayload);\n\t\t\t\tproperties['installedPackages'] = typingsInstalledPayload.installedPackages;\n\n\t\t\t\tif (typeof typingsInstalledPayload.installSuccess === 'boolean') {\n\t\t\t\t\tproperties['installSuccess'] = typingsInstalledPayload.installSuccess.toString();\n\t\t\t\t}\n\t\t\t\tif (typeof typingsInstalledPayload.typingsInstallerVersion === 'string') {\n\t\t\t\t\tproperties['typingsInstallerVersion'] = typingsInstalledPayload.typingsInstallerVersion;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdefault: {\n\t\t\t\tconst payload = telemetryData.payload;\n\t\t\t\tif (payload) {\n\t\t\t\t\tObject.keys(payload).forEach((key) => {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (payload.hasOwnProperty(key)) {\n\t\t\t\t\t\t\t\tproperties[key] = typeof payload[key] === 'string' ? payload[key] : JSON.stringify(payload[key]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t// noop\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\t// Add plugin data here\n\t\tif (telemetryData.telemetryEventName === 'projectInfo') {\n\t\t\tif (this.serverState.type === ServerState.Type.Running) {\n\t\t\t\tthis.serverState.updateTsserverVersion(properties['version']);\n\t\t\t}\n\t\t}\n\n\t\t/* __GDPR__\n\t\t\t\"typingsInstalled\" : {\n\t\t\t\t\"owner\": \"mjbvz\",\n\t\t\t\t\"installedPackages\" : { \"classification\": \"PublicNonPersonalData\", \"purpose\": \"FeatureInsight\" },\n\t\t\t\t\"installSuccess\": { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\t\t\"typingsInstallerVersion\": { \"classification\": \"SystemMetaData\", \"purpose\": \"PerformanceAndHealth\" },\n\t\t\t\t\"${include}\": [\n\t\t\t\t\t\"${TypeScriptCommonProperties}\"\n\t\t\t\t]\n\t\t\t}\n\t\t*/\n\t\t// __GDPR__COMMENT__: Other events are defined by TypeScript.\n\t\tthis.telemetryReporter.logTelemetry(telemetryData.telemetryEventName, properties);\n\t}\n\n\tprivate configurePlugin(pluginName: string, configuration: {}): any {\n\t\tthis.executeWithoutWaitingForResponse('configurePlugin', { pluginName, configuration });\n\t}\n}\n\nfunction getDiagnosticsKind(event: Proto.Event) {\n\tswitch (event.event) {\n\t\tcase 'syntaxDiag': return DiagnosticKind.Syntax;\n\t\tcase 'semanticDiag': return DiagnosticKind.Semantic;\n\t\tcase 'suggestionDiag': return DiagnosticKind.Suggestion;\n\t\tcase 'regionSemanticDiag': return DiagnosticKind.RegionSemantic;\n\t}\n\tthrow new Error('Unknown dignostics kind');\n}\n\nclass ServerInitializingIndicator extends Disposable {\n\n\tprivate _task?: { project: string; resolve: () => void };\n\n\tconstructor(\n\t\tprivate readonly client: ITypeScriptServiceClient,\n\t) {\n\t\tsuper();\n\t}\n\n\tpublic reset(): void {\n\t\tif (this._task) {\n\t\t\tthis._task.resolve();\n\t\t\tthis._task = undefined;\n\t\t}\n\t}\n\n\t/**\n\t * Signal that a project has started loading.\n\t */\n\tpublic startedLoadingProject(projectName: string): void {\n\t\t// TS projects are loaded sequentially. Cancel existing task because it should always be resolved before\n\t\t// the incoming project loading task is.\n\t\tthis.reset();\n\n\t\tconst projectDisplayName = this.getProjectDisplayName(projectName);\n\n\t\tvscode.window.withProgress({\n\t\t\tlocation: vscode.ProgressLocation.Window,\n\t\t\ttitle: vscode.l10n.t(\"Initializing '{0}'\", projectDisplayName),\n\t\t}, () => new Promise<void>(resolve => {\n\t\t\tthis._task = { project: projectName, resolve };\n\t\t}));\n\t}\n\n\tprivate getProjectDisplayName(projectName: string): string {\n\t\tconst projectUri = this.client.toResource(projectName);\n\t\tconst relPath = vscode.workspace.asRelativePath(projectUri);\n\n\t\tconst maxDisplayLength = 60;\n\t\tif (relPath.length > maxDisplayLength) {\n\t\t\treturn '...' + relPath.slice(-maxDisplayLength);\n\t\t}\n\n\t\treturn relPath;\n\t}\n\n\tpublic startedLoadingFile(fileName: string, task: Promise<unknown>): void {\n\t\tif (!this._task) {\n\t\t\tvscode.window.withProgress({\n\t\t\t\tlocation: vscode.ProgressLocation.Window,\n\t\t\t\ttitle: vscode.l10n.t(\"Analyzing '{0}' and its dependencies\", path.basename(fileName)),\n\t\t\t}, () => task);\n\t\t}\n\t}\n\n\tpublic finishedLoadingProject(projectName: string): void {\n\t\tif (this._task && this._task.project === projectName) {\n\t\t\tthis._task.resolve();\n\t\t\tthis._task = undefined;\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { isJsConfigOrTsConfigFileName } from '../configuration/languageDescription';\nimport { isSupportedLanguageMode } from '../configuration/languageIds';\nimport { Disposable } from '../utils/dispose';\nimport { coalesce } from '../utils/arrays';\n\n/**\n * Tracks the active JS/TS editor.\n *\n * This tries to handle the case where the user focuses in the output view / debug console.\n * When this happens, we want to treat the last real focused editor as the active editor,\n * instead of using `vscode.window.activeTextEditor`\n */\nexport class ActiveJsTsEditorTracker extends Disposable {\n\n\tprivate _activeJsTsEditor: vscode.TextEditor | undefined;\n\n\tprivate readonly _onDidChangeActiveJsTsEditor = this._register(new vscode.EventEmitter<vscode.TextEditor | undefined>());\n\tpublic readonly onDidChangeActiveJsTsEditor = this._onDidChangeActiveJsTsEditor.event;\n\n\tpublic constructor() {\n\t\tsuper();\n\n\t\tthis._register(vscode.window.onDidChangeActiveTextEditor(_ => this.update()));\n\t\tthis._register(vscode.window.onDidChangeVisibleTextEditors(_ => this.update()));\n\t\tthis._register(vscode.window.tabGroups.onDidChangeTabGroups(_ => this.update()));\n\n\t\tthis.update();\n\t}\n\n\tpublic get activeJsTsEditor(): vscode.TextEditor | undefined {\n\t\treturn this._activeJsTsEditor;\n\t}\n\n\n\tprivate update() {\n\t\t// Use tabs to find the active editor.\n\t\t// This correctly handles switching to the output view / debug console, which changes the activeEditor but not\n\t\t// the active tab.\n\t\tconst editorCandidates = this.getEditorCandidatesForActiveTab();\n\t\tconst managedEditors = editorCandidates.filter(editor => this.isManagedFile(editor));\n\t\tconst newActiveJsTsEditor = managedEditors.at(0);\n\t\tif (this._activeJsTsEditor !== newActiveJsTsEditor) {\n\t\t\tthis._activeJsTsEditor = newActiveJsTsEditor;\n\t\t\tthis._onDidChangeActiveJsTsEditor.fire(this._activeJsTsEditor);\n\t\t}\n\t}\n\n\tprivate getEditorCandidatesForActiveTab(): vscode.TextEditor[] {\n\t\tconst tab = vscode.window.tabGroups.activeTabGroup.activeTab;\n\t\tif (!tab) {\n\t\t\treturn [];\n\t\t}\n\n\t\t// Basic text editor tab\n\t\tif (tab.input instanceof vscode.TabInputText) {\n\t\t\tconst inputUri = tab.input.uri;\n\t\t\tconst editor = vscode.window.visibleTextEditors.find(editor => {\n\t\t\t\treturn editor.document.uri.toString() === inputUri.toString()\n\t\t\t\t\t&& editor.viewColumn === tab.group.viewColumn;\n\t\t\t});\n\t\t\treturn editor ? [editor] : [];\n\t\t}\n\n\t\t// Diff editor tab. We could be focused on either side of the editor.\n\t\tif (tab.input instanceof vscode.TabInputTextDiff) {\n\t\t\tconst original = tab.input.original;\n\t\t\tconst modified = tab.input.modified;\n\t\t\t// Check the active editor first. However if a non tab editor like the output view is focused,\n\t\t\t// we still need to check the visible text editors.\n\t\t\t// TODO: This may return incorrect editors incorrect as there does not seem to be a reliable way to map from an editor to the\n\t\t\t// view column of its parent diff editor. See https://github.com/microsoft/vscode/issues/201845\n\t\t\treturn coalesce([vscode.window.activeTextEditor, ...vscode.window.visibleTextEditors]).filter(editor => {\n\t\t\t\treturn (editor.document.uri.toString() === original.toString() || editor.document.uri.toString() === modified.toString())\n\t\t\t\t\t&& editor.viewColumn === undefined; // Editors in diff views have undefined view columns\n\t\t\t});\n\t\t}\n\n\t\t// Notebook editor. Find editor for notebook cell.\n\t\tif (tab.input instanceof vscode.TabInputNotebook) {\n\t\t\tconst activeEditor = vscode.window.activeTextEditor;\n\t\t\tif (!activeEditor) {\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\t// Notebooks cell editors have undefined view columns.\n\t\t\tif (activeEditor.viewColumn !== undefined) {\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tconst notebook = vscode.window.visibleNotebookEditors.find(editor =>\n\t\t\t\teditor.notebook.uri.toString() === (tab.input as vscode.TabInputNotebook).uri.toString()\n\t\t\t\t&& editor.viewColumn === tab.group.viewColumn);\n\n\t\t\treturn notebook?.notebook.getCells().some(cell => cell.document.uri.toString() === activeEditor.document.uri.toString()) ? [activeEditor] : [];\n\t\t}\n\n\t\treturn [];\n\t}\n\n\tprivate isManagedFile(editor: vscode.TextEditor): boolean {\n\t\treturn this.isManagedScriptFile(editor) || this.isManagedConfigFile(editor);\n\t}\n\n\tprivate isManagedScriptFile(editor: vscode.TextEditor): boolean {\n\t\treturn isSupportedLanguageMode(editor.document);\n\t}\n\n\tprivate isManagedConfigFile(editor: vscode.TextEditor): boolean {\n\t\treturn isJsConfigOrTsConfigFileName(editor.document.fileName);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { CommandManager } from '../commands/commandManager';\nimport { isSupportedLanguageMode, isTypeScriptDocument, jsTsLanguageModes } from '../configuration/languageIds';\nimport { ProjectType, isImplicitProjectConfigFile, openOrCreateConfig, openProjectConfigForFile, openProjectConfigOrPromptToCreate } from '../tsconfig';\nimport { ClientCapability, ITypeScriptServiceClient } from '../typescriptService';\nimport { Disposable } from '../utils/dispose';\nimport { ActiveJsTsEditorTracker } from './activeJsTsEditorTracker';\n\n\nnamespace IntellisenseState {\n\texport const enum Type { None, Pending, Resolved, SyntaxOnly }\n\n\texport const None = Object.freeze({ type: Type.None } as const);\n\n\texport const SyntaxOnly = Object.freeze({ type: Type.SyntaxOnly } as const);\n\n\texport class Pending {\n\t\tpublic readonly type = Type.Pending;\n\n\t\tpublic readonly cancellation = new vscode.CancellationTokenSource();\n\n\t\tconstructor(\n\t\t\tpublic readonly resource: vscode.Uri,\n\t\t\tpublic readonly projectType: ProjectType,\n\t\t) { }\n\t}\n\n\texport class Resolved {\n\t\tpublic readonly type = Type.Resolved;\n\n\t\tconstructor(\n\t\t\tpublic readonly resource: vscode.Uri,\n\t\t\tpublic readonly projectType: ProjectType,\n\t\t\tpublic readonly configFile: string,\n\t\t) { }\n\t}\n\n\texport type State = typeof None | Pending | Resolved | typeof SyntaxOnly;\n}\n\ntype CreateOrOpenConfigCommandArgs = [root: vscode.Uri, projectType: ProjectType];\n\nexport class IntellisenseStatus extends Disposable {\n\n\tpublic readonly openOpenConfigCommandId = '_typescript.openConfig';\n\tpublic readonly createOrOpenConfigCommandId = '_typescript.createOrOpenConfig';\n\n\tprivate _statusItem?: vscode.LanguageStatusItem;\n\n\tprivate _ready = false;\n\tprivate _state: IntellisenseState.State = IntellisenseState.None;\n\n\tconstructor(\n\t\tprivate readonly _client: ITypeScriptServiceClient,\n\t\tcommandManager: CommandManager,\n\t\tprivate readonly _activeTextEditorManager: ActiveJsTsEditorTracker,\n\t) {\n\t\tsuper();\n\n\t\tcommandManager.register({\n\t\t\tid: this.openOpenConfigCommandId,\n\t\t\texecute: async (...[root, projectType]: CreateOrOpenConfigCommandArgs) => {\n\t\t\t\tif (this._state.type === IntellisenseState.Type.Resolved) {\n\t\t\t\t\tawait openProjectConfigOrPromptToCreate(projectType, this._client, root, this._state.configFile);\n\t\t\t\t} else if (this._state.type === IntellisenseState.Type.Pending) {\n\t\t\t\t\tawait openProjectConfigForFile(projectType, this._client, this._state.resource);\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\t\tcommandManager.register({\n\t\t\tid: this.createOrOpenConfigCommandId,\n\t\t\texecute: async (...[root, projectType]: CreateOrOpenConfigCommandArgs) => {\n\t\t\t\tawait openOrCreateConfig(this._client.apiVersion, projectType, root, this._client.configuration);\n\t\t\t},\n\t\t});\n\n\t\t_activeTextEditorManager.onDidChangeActiveJsTsEditor(this.updateStatus, this, this._disposables);\n\n\t\tthis._client.onReady(() => {\n\t\t\tthis._ready = true;\n\t\t\tthis.updateStatus();\n\t\t});\n\t}\n\n\toverride dispose() {\n\t\tsuper.dispose();\n\t\tthis._statusItem?.dispose();\n\t}\n\n\tprivate async updateStatus() {\n\t\tconst doc = this._activeTextEditorManager.activeJsTsEditor?.document;\n\t\tif (!doc || !isSupportedLanguageMode(doc)) {\n\t\t\tthis.updateState(IntellisenseState.None);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._client.hasCapabilityForResource(doc.uri, ClientCapability.Semantic)) {\n\t\t\tthis.updateState(IntellisenseState.SyntaxOnly);\n\t\t\treturn;\n\t\t}\n\n\t\tconst file = this._client.toOpenTsFilePath(doc, { suppressAlertOnFailure: true });\n\t\tif (!file) {\n\t\t\tthis.updateState(IntellisenseState.None);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._ready) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst projectType = isTypeScriptDocument(doc) ? ProjectType.TypeScript : ProjectType.JavaScript;\n\n\t\tconst pendingState = new IntellisenseState.Pending(doc.uri, projectType);\n\t\tthis.updateState(pendingState);\n\n\t\tconst response = await this._client.execute('projectInfo', { file, needFileNameList: false }, pendingState.cancellation.token);\n\t\tif (response.type === 'response' && response.body) {\n\t\t\tif (this._state === pendingState) {\n\t\t\t\tthis.updateState(new IntellisenseState.Resolved(doc.uri, projectType, response.body.configFileName));\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate updateState(newState: IntellisenseState.State): void {\n\t\tif (this._state === newState) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._state.type === IntellisenseState.Type.Pending) {\n\t\t\tthis._state.cancellation.cancel();\n\t\t\tthis._state.cancellation.dispose();\n\t\t}\n\n\t\tthis._state = newState;\n\n\t\tswitch (this._state.type) {\n\t\t\tcase IntellisenseState.Type.None: {\n\t\t\t\tthis._statusItem?.dispose();\n\t\t\t\tthis._statusItem = undefined;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase IntellisenseState.Type.Pending: {\n\t\t\t\tconst statusItem = this.ensureStatusItem();\n\t\t\t\tstatusItem.severity = vscode.LanguageStatusSeverity.Information;\n\t\t\t\tstatusItem.text = vscode.l10n.t(\"Loading IntelliSense status\");\n\t\t\t\tstatusItem.detail = undefined;\n\t\t\t\tstatusItem.command = undefined;\n\t\t\t\tstatusItem.busy = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase IntellisenseState.Type.Resolved: {\n\t\t\t\tconst noConfigFileText = this._state.projectType === ProjectType.TypeScript\n\t\t\t\t\t? vscode.l10n.t(\"No tsconfig\")\n\t\t\t\t\t: vscode.l10n.t(\"No jsconfig\");\n\n\t\t\t\tconst rootPath = this._client.getWorkspaceRootForResource(this._state.resource);\n\t\t\t\tif (!rootPath) {\n\t\t\t\t\tif (this._statusItem) {\n\t\t\t\t\t\tthis._statusItem.text = noConfigFileText;\n\t\t\t\t\t\tthis._statusItem.detail = !vscode.workspace.workspaceFolders\n\t\t\t\t\t\t\t? vscode.l10n.t(\"No opened folders\")\n\t\t\t\t\t\t\t: vscode.l10n.t(\"File is not part opened folders\");\n\t\t\t\t\t\tthis._statusItem.busy = false;\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst statusItem = this.ensureStatusItem();\n\t\t\t\tstatusItem.busy = false;\n\t\t\t\tstatusItem.detail = undefined;\n\n\t\t\t\tstatusItem.severity = vscode.LanguageStatusSeverity.Information;\n\t\t\t\tif (isImplicitProjectConfigFile(this._state.configFile)) {\n\t\t\t\t\tstatusItem.text = noConfigFileText;\n\t\t\t\t\tstatusItem.detail = undefined;\n\t\t\t\t\tstatusItem.command = {\n\t\t\t\t\t\tcommand: this.createOrOpenConfigCommandId,\n\t\t\t\t\t\ttitle: this._state.projectType === ProjectType.TypeScript\n\t\t\t\t\t\t\t? vscode.l10n.t(\"Configure TSConfig\")\n\t\t\t\t\t\t\t: vscode.l10n.t(\"Configure JSConfig\"),\n\t\t\t\t\t\targuments: [rootPath, this._state.projectType] satisfies CreateOrOpenConfigCommandArgs,\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\tstatusItem.text = vscode.workspace.asRelativePath(this._state.configFile);\n\t\t\t\t\tstatusItem.detail = undefined;\n\t\t\t\t\tstatusItem.command = {\n\t\t\t\t\t\tcommand: this.openOpenConfigCommandId,\n\t\t\t\t\t\ttitle: vscode.l10n.t(\"Open Config File\"),\n\t\t\t\t\t\targuments: [rootPath, this._state.projectType] satisfies CreateOrOpenConfigCommandArgs,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase IntellisenseState.Type.SyntaxOnly: {\n\t\t\t\tconst statusItem = this.ensureStatusItem();\n\t\t\t\tstatusItem.severity = vscode.LanguageStatusSeverity.Warning;\n\t\t\t\tstatusItem.text = vscode.l10n.t(\"Partial mode\");\n\t\t\t\tstatusItem.detail = vscode.l10n.t(\"Project wide IntelliSense not available\");\n\t\t\t\tstatusItem.busy = false;\n\t\t\t\tstatusItem.command = {\n\t\t\t\t\ttitle: vscode.l10n.t(\"Learn More\"),\n\t\t\t\t\tcommand: 'vscode.open',\n\t\t\t\t\targuments: [\n\t\t\t\t\t\tvscode.Uri.parse('https://aka.ms/vscode/jsts/partial-mode'),\n\t\t\t\t\t]\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate ensureStatusItem(): vscode.LanguageStatusItem {\n\t\tif (!this._statusItem) {\n\t\t\tthis._statusItem = vscode.languages.createLanguageStatusItem('typescript.projectStatus', jsTsLanguageModes);\n\t\t\tthis._statusItem.name = vscode.l10n.t(\"JS/TS IntelliSense Status\");\n\t\t}\n\t\treturn this._statusItem;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { TelemetryReporter } from '../logging/telemetry';\nimport { isImplicitProjectConfigFile, openOrCreateConfig, ProjectType } from '../tsconfig';\nimport { ITypeScriptServiceClient } from '../typescriptService';\n\n\ninterface Hint {\n\tmessage: string;\n}\n\nclass ExcludeHintItem {\n\tpublic configFileName?: string;\n\tprivate readonly _item: vscode.StatusBarItem;\n\tprivate _currentHint?: Hint;\n\n\tconstructor(\n\t\tprivate readonly telemetryReporter: TelemetryReporter\n\t) {\n\t\tthis._item = vscode.window.createStatusBarItem('status.typescript.exclude', vscode.StatusBarAlignment.Right, 98 /* to the right of typescript version status (99) */);\n\t\tthis._item.name = vscode.l10n.t(\"TypeScript: Configure Excludes\");\n\t\tthis._item.command = 'js.projectStatus.command';\n\t}\n\n\tpublic getCurrentHint(): Hint {\n\t\treturn this._currentHint!;\n\t}\n\n\tpublic hide() {\n\t\tthis._item.hide();\n\t}\n\n\tpublic show(largeRoots?: string) {\n\t\tthis._currentHint = {\n\t\t\tmessage: largeRoots\n\t\t\t\t? vscode.l10n.t(\"To enable project-wide JavaScript/TypeScript language features, exclude folders with many files, like: {0}\", largeRoots)\n\t\t\t\t: vscode.l10n.t(\"To enable project-wide JavaScript/TypeScript language features, exclude large folders with source files that you do not work on.\")\n\t\t};\n\t\tthis._item.tooltip = this._currentHint.message;\n\t\tthis._item.text = vscode.l10n.t(\"Configure Excludes\");\n\t\tthis._item.tooltip = vscode.l10n.t(\"To enable project-wide JavaScript/TypeScript language features, exclude large folders with source files that you do not work on.\");\n\t\tthis._item.color = '#A5DF3B';\n\t\tthis._item.show();\n\t\t/* __GDPR__\n\t\t\t\"js.hintProjectExcludes\" : {\n\t\t\t\t\"owner\": \"mjbvz\",\n\t\t\t\t\"${include}\": [\n\t\t\t\t\t\"${TypeScriptCommonProperties}\"\n\t\t\t\t]\n\t\t\t}\n\t\t*/\n\t\tthis.telemetryReporter.logTelemetry('js.hintProjectExcludes');\n\t}\n}\n\n\nfunction createLargeProjectMonitorFromTypeScript(item: ExcludeHintItem, client: ITypeScriptServiceClient): vscode.Disposable {\n\n\tinterface LargeProjectMessageItem extends vscode.MessageItem {\n\t\tindex: number;\n\t}\n\n\treturn client.onProjectLanguageServiceStateChanged(body => {\n\t\tif (body.languageServiceEnabled) {\n\t\t\titem.hide();\n\t\t} else {\n\t\t\titem.show();\n\t\t\tconst configFileName = body.projectName;\n\t\t\tif (configFileName) {\n\t\t\t\titem.configFileName = configFileName;\n\t\t\t\tvscode.window.showWarningMessage<LargeProjectMessageItem>(item.getCurrentHint().message,\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: vscode.l10n.t(\"Configure Excludes\"),\n\t\t\t\t\t\tindex: 0\n\t\t\t\t\t}).then(selected => {\n\t\t\t\t\t\tif (selected && selected.index === 0) {\n\t\t\t\t\t\t\tonConfigureExcludesSelected(client, configFileName);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction onConfigureExcludesSelected(\n\tclient: ITypeScriptServiceClient,\n\tconfigFileName: string\n) {\n\tif (!isImplicitProjectConfigFile(configFileName)) {\n\t\tvscode.workspace.openTextDocument(configFileName)\n\t\t\t.then(vscode.window.showTextDocument);\n\t} else {\n\t\tconst root = client.getWorkspaceRootForResource(vscode.Uri.file(configFileName));\n\t\tif (root) {\n\t\t\topenOrCreateConfig(\n\t\t\t\tclient.apiVersion,\n\t\t\t\t/tsconfig\\.?.*\\.json/.test(configFileName) ? ProjectType.TypeScript : ProjectType.JavaScript,\n\t\t\t\troot,\n\t\t\t\tclient.configuration);\n\t\t}\n\t}\n}\n\nexport function create(\n\tclient: ITypeScriptServiceClient,\n): vscode.Disposable {\n\tconst toDispose: vscode.Disposable[] = [];\n\n\tconst item = new ExcludeHintItem(client.telemetryReporter);\n\ttoDispose.push(vscode.commands.registerCommand('js.projectStatus.command', () => {\n\t\tif (item.configFileName) {\n\t\t\tonConfigureExcludesSelected(client, item.configFileName);\n\t\t}\n\t\tconst { message } = item.getCurrentHint();\n\t\treturn vscode.window.showInformationMessage(message);\n\t}));\n\n\ttoDispose.push(createLargeProjectMonitorFromTypeScript(item, client));\n\n\treturn vscode.Disposable.from(...toDispose);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { disabledSchemes } from '../configuration/fileSchemes';\nimport { isJsConfigOrTsConfigFileName } from '../configuration/languageDescription';\nimport { isSupportedLanguageMode } from '../configuration/languageIds';\nimport { Disposable } from '../utils/dispose';\nimport { ActiveJsTsEditorTracker } from './activeJsTsEditorTracker';\n\n/**\n * When clause context set when the current file is managed by vscode's built-in typescript extension.\n */\nexport default class ManagedFileContextManager extends Disposable {\n\tprivate static readonly contextName = 'typescript.isManagedFile';\n\n\tprivate isInManagedFileContext: boolean = false;\n\n\tpublic constructor(activeJsTsEditorTracker: ActiveJsTsEditorTracker) {\n\t\tsuper();\n\t\tactiveJsTsEditorTracker.onDidChangeActiveJsTsEditor(this.onDidChangeActiveTextEditor, this, this._disposables);\n\n\t\tthis.onDidChangeActiveTextEditor(activeJsTsEditorTracker.activeJsTsEditor);\n\t}\n\n\tprivate onDidChangeActiveTextEditor(editor?: vscode.TextEditor): void {\n\t\tif (editor) {\n\t\t\tthis.updateContext(this.isManagedFile(editor));\n\t\t} else {\n\t\t\tthis.updateContext(false);\n\t\t}\n\t}\n\n\tprivate updateContext(newValue: boolean) {\n\t\tif (newValue === this.isInManagedFileContext) {\n\t\t\treturn;\n\t\t}\n\n\t\tvscode.commands.executeCommand('setContext', ManagedFileContextManager.contextName, newValue);\n\t\tthis.isInManagedFileContext = newValue;\n\t}\n\n\tprivate isManagedFile(editor: vscode.TextEditor): boolean {\n\t\treturn this.isManagedScriptFile(editor) || this.isManagedConfigFile(editor);\n\t}\n\n\tprivate isManagedScriptFile(editor: vscode.TextEditor): boolean {\n\t\treturn isSupportedLanguageMode(editor.document) && !disabledSchemes.has(editor.document.uri.scheme);\n\t}\n\n\tprivate isManagedConfigFile(editor: vscode.TextEditor): boolean {\n\t\treturn isJsConfigOrTsConfigFileName(editor.document.fileName);\n\t}\n}\n\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { ITypeScriptServiceClient } from '../typescriptService';\nimport { Disposable } from '../utils/dispose';\n\n\nconst typingsInstallTimeout = 30 * 1000;\n\nexport default class TypingsStatus extends Disposable {\n\tprivate readonly _acquiringTypings = new Map<number, NodeJS.Timeout>();\n\tprivate readonly _client: ITypeScriptServiceClient;\n\n\tconstructor(client: ITypeScriptServiceClient) {\n\t\tsuper();\n\t\tthis._client = client;\n\n\t\tthis._register(\n\t\t\tthis._client.onDidBeginInstallTypings(event => this.onBeginInstallTypings(event.eventId)));\n\n\t\tthis._register(\n\t\t\tthis._client.onDidEndInstallTypings(event => this.onEndInstallTypings(event.eventId)));\n\t}\n\n\tpublic override dispose(): void {\n\t\tsuper.dispose();\n\n\t\tfor (const timeout of this._acquiringTypings.values()) {\n\t\t\tclearTimeout(timeout);\n\t\t}\n\t}\n\n\tpublic get isAcquiringTypings(): boolean {\n\t\treturn Object.keys(this._acquiringTypings).length > 0;\n\t}\n\n\tprivate onBeginInstallTypings(eventId: number): void {\n\t\tif (this._acquiringTypings.has(eventId)) {\n\t\t\treturn;\n\t\t}\n\t\tthis._acquiringTypings.set(eventId, setTimeout(() => {\n\t\t\tthis.onEndInstallTypings(eventId);\n\t\t}, typingsInstallTimeout));\n\t}\n\n\tprivate onEndInstallTypings(eventId: number): void {\n\t\tconst timer = this._acquiringTypings.get(eventId);\n\t\tif (timer) {\n\t\t\tclearTimeout(timer);\n\t\t}\n\t\tthis._acquiringTypings.delete(eventId);\n\t}\n}\n\nexport class AtaProgressReporter extends Disposable {\n\n\tprivate readonly _promises = new Map<number, Function>();\n\n\tconstructor(client: ITypeScriptServiceClient) {\n\t\tsuper();\n\t\tthis._register(client.onDidBeginInstallTypings(e => this._onBegin(e.eventId)));\n\t\tthis._register(client.onDidEndInstallTypings(e => this._onEndOrTimeout(e.eventId)));\n\t\tthis._register(client.onTypesInstallerInitializationFailed(_ => this.onTypesInstallerInitializationFailed()));\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\t\tthis._promises.forEach(value => value());\n\t}\n\n\tprivate _onBegin(eventId: number): void {\n\t\tconst handle = setTimeout(() => this._onEndOrTimeout(eventId), typingsInstallTimeout);\n\t\tconst promise = new Promise<void>(resolve => {\n\t\t\tthis._promises.set(eventId, () => {\n\t\t\t\tclearTimeout(handle);\n\t\t\t\tresolve();\n\t\t\t});\n\t\t});\n\n\t\tvscode.window.withProgress({\n\t\t\tlocation: vscode.ProgressLocation.Window,\n\t\t\ttitle: vscode.l10n.t(\"Fetching data for better TypeScript IntelliSense\")\n\t\t}, () => promise);\n\t}\n\n\tprivate _onEndOrTimeout(eventId: number): void {\n\t\tconst resolve = this._promises.get(eventId);\n\t\tif (resolve) {\n\t\t\tthis._promises.delete(eventId);\n\t\t\tresolve();\n\t\t}\n\t}\n\n\tprivate async onTypesInstallerInitializationFailed() {\n\t\tconst config = vscode.workspace.getConfiguration('typescript');\n\n\t\tif (config.get<boolean>('check.npmIsInstalled', true)) {\n\t\t\tconst dontShowAgain: vscode.MessageItem = {\n\t\t\t\ttitle: vscode.l10n.t(\"Don't Show Again\"),\n\t\t\t};\n\t\t\tconst selected = await vscode.window.showWarningMessage(\n\t\t\t\tvscode.l10n.t(\n\t\t\t\t\t\"Could not install typings files for JavaScript language features. Please ensure that NPM is installed, or configure 'typescript.npm' in your user settings. Alternatively, check the [documentation]({0}) to learn more.\",\n\t\t\t\t\t'https://go.microsoft.com/fwlink/?linkid=847635'\n\t\t\t\t),\n\t\t\t\tdontShowAgain);\n\n\t\t\tif (selected === dontShowAgain) {\n\t\t\t\tconfig.update('check.npmIsInstalled', false, true);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { SelectTypeScriptVersionCommand } from '../commands/selectTypeScriptVersion';\nimport { jsTsLanguageModes } from '../configuration/languageIds';\nimport { TypeScriptVersion } from '../tsServer/versionProvider';\nimport { ITypeScriptServiceClient } from '../typescriptService';\nimport { Disposable } from '../utils/dispose';\n\n\nexport class VersionStatus extends Disposable {\n\n\tprivate readonly _statusItem: vscode.LanguageStatusItem;\n\n\tconstructor(\n\t\tprivate readonly _client: ITypeScriptServiceClient,\n\t) {\n\t\tsuper();\n\n\t\tthis._statusItem = this._register(vscode.languages.createLanguageStatusItem('typescript.version', jsTsLanguageModes));\n\n\t\tthis._statusItem.name = vscode.l10n.t(\"TypeScript Version\");\n\t\tthis._statusItem.detail = vscode.l10n.t(\"TypeScript version\");\n\n\t\tthis._register(this._client.onTsServerStarted(({ version }) => this.onDidChangeTypeScriptVersion(version)));\n\t}\n\n\tprivate onDidChangeTypeScriptVersion(version: TypeScriptVersion) {\n\t\tthis._statusItem.text = version.displayName;\n\t\tthis._statusItem.command = {\n\t\t\tcommand: SelectTypeScriptVersionCommand.id,\n\t\t\ttitle: vscode.l10n.t(\"Select Version\"),\n\t\t\ttooltip: version.path\n\t\t};\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport const empty = Object.freeze([]);\n\nexport function equals<T>(\n\ta: ReadonlyArray<T>,\n\tb: ReadonlyArray<T>,\n\titemEquals: (a: T, b: T) => boolean = (a, b) => a === b\n): boolean {\n\tif (a === b) {\n\t\treturn true;\n\t}\n\tif (a.length !== b.length) {\n\t\treturn false;\n\t}\n\treturn a.every((x, i) => itemEquals(x, b[i]));\n}\n\nexport function coalesce<T>(array: ReadonlyArray<T | undefined>): T[] {\n\treturn array.filter((e): e is T => !!e);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable } from 'vscode';\n\nexport interface ITask<T> {\n\t(): T;\n}\n\nexport class Delayer<T> {\n\n\tpublic defaultDelay: number;\n\tprivate timeout: any; // Timer\n\tprivate completionPromise: Promise<T | undefined> | null;\n\tprivate onSuccess: ((value: T | PromiseLike<T> | undefined) => void) | null;\n\tprivate task: ITask<T> | null;\n\n\tconstructor(defaultDelay: number) {\n\t\tthis.defaultDelay = defaultDelay;\n\t\tthis.timeout = null;\n\t\tthis.completionPromise = null;\n\t\tthis.onSuccess = null;\n\t\tthis.task = null;\n\t}\n\n\tpublic trigger(task: ITask<T>, delay: number = this.defaultDelay): Promise<T | undefined> {\n\t\tthis.task = task;\n\t\tif (delay >= 0) {\n\t\t\tthis.cancelTimeout();\n\t\t}\n\n\t\tif (!this.completionPromise) {\n\t\t\tthis.completionPromise = new Promise<T | undefined>((resolve) => {\n\t\t\t\tthis.onSuccess = resolve;\n\t\t\t}).then(() => {\n\t\t\t\tthis.completionPromise = null;\n\t\t\t\tthis.onSuccess = null;\n\t\t\t\tconst result = this.task?.();\n\t\t\t\tthis.task = null;\n\t\t\t\treturn result;\n\t\t\t});\n\t\t}\n\n\t\tif (delay >= 0 || this.timeout === null) {\n\t\t\tthis.timeout = setTimeout(() => {\n\t\t\t\tthis.timeout = null;\n\t\t\t\tthis.onSuccess?.(undefined);\n\t\t\t}, delay >= 0 ? delay : this.defaultDelay);\n\t\t}\n\n\t\treturn this.completionPromise;\n\t}\n\n\tprivate cancelTimeout(): void {\n\t\tif (this.timeout !== null) {\n\t\t\tclearTimeout(this.timeout);\n\t\t\tthis.timeout = null;\n\t\t}\n\t}\n}\n\nexport function setImmediate(callback: (...args: any[]) => void, ...args: any[]): Disposable {\n\tif (global.setImmediate) {\n\t\tconst handle = global.setImmediate(callback, ...args);\n\t\treturn { dispose: () => global.clearImmediate(handle) };\n\t} else {\n\t\tconst handle = setTimeout(callback, 0, ...args);\n\t\treturn { dispose: () => clearTimeout(handle) };\n\t}\n}\n\n\n/**\n * A helper to prevent accumulation of sequential async tasks.\n *\n * Imagine a mail man with the sole task of delivering letters. As soon as\n * a letter submitted for delivery, he drives to the destination, delivers it\n * and returns to his base. Imagine that during the trip, N more letters were submitted.\n * When the mail man returns, he picks those N letters and delivers them all in a\n * single trip. Even though N+1 submissions occurred, only 2 deliveries were made.\n *\n * The throttler implements this via the queue() method, by providing it a task\n * factory. Following the example:\n *\n * \t\tconst throttler = new Throttler();\n * \t\tconst letters = [];\n *\n * \t\tfunction deliver() {\n * \t\t\tconst lettersToDeliver = letters;\n * \t\t\tletters = [];\n * \t\t\treturn makeTheTrip(lettersToDeliver);\n * \t\t}\n *\n * \t\tfunction onLetterReceived(l) {\n * \t\t\tletters.push(l);\n * \t\t\tthrottler.queue(deliver);\n * \t\t}\n */\nexport class Throttler {\n\n\tprivate activePromise: Promise<any> | null;\n\tprivate queuedPromise: Promise<any> | null;\n\tprivate queuedPromiseFactory: ITask<Promise<any>> | null;\n\n\tprivate isDisposed = false;\n\n\tconstructor() {\n\t\tthis.activePromise = null;\n\t\tthis.queuedPromise = null;\n\t\tthis.queuedPromiseFactory = null;\n\t}\n\n\tqueue<T>(promiseFactory: ITask<Promise<T>>): Promise<T> {\n\t\tif (this.isDisposed) {\n\t\t\treturn Promise.reject(new Error('Throttler is disposed'));\n\t\t}\n\n\t\tif (this.activePromise) {\n\t\t\tthis.queuedPromiseFactory = promiseFactory;\n\n\t\t\tif (!this.queuedPromise) {\n\t\t\t\tconst onComplete = () => {\n\t\t\t\t\tthis.queuedPromise = null;\n\n\t\t\t\t\tif (this.isDisposed) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst result = this.queue(this.queuedPromiseFactory!);\n\t\t\t\t\tthis.queuedPromiseFactory = null;\n\n\t\t\t\t\treturn result;\n\t\t\t\t};\n\n\t\t\t\tthis.queuedPromise = new Promise(resolve => {\n\t\t\t\t\tthis.activePromise!.then(onComplete, onComplete).then(resolve);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tthis.queuedPromise!.then(resolve, reject);\n\t\t\t});\n\t\t}\n\n\t\tthis.activePromise = promiseFactory();\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.activePromise!.then((result: T) => {\n\t\t\t\tthis.activePromise = null;\n\t\t\t\tresolve(result);\n\t\t\t}, (err: unknown) => {\n\t\t\t\tthis.activePromise = null;\n\t\t\t\treject(err);\n\t\t\t});\n\t\t});\n\t}\n\n\tdispose(): void {\n\t\tthis.isDisposed = true;\n\t}\n}\n\nexport function raceTimeout<T>(promise: Promise<T>, timeout: number, onTimeout?: () => void): Promise<T | undefined> {\n\tlet promiseResolve: ((value: T | undefined) => void) | undefined = undefined;\n\n\tconst timer = setTimeout(() => {\n\t\tpromiseResolve?.(undefined);\n\t\tonTimeout?.();\n\t}, timeout);\n\n\treturn Promise.race([\n\t\tpromise.finally(() => clearTimeout(timer)),\n\t\tnew Promise<T | undefined>(resolve => promiseResolve = resolve)\n\t]);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\n\nconst noopDisposable = vscode.Disposable.from();\n\nexport const nulToken: vscode.CancellationToken = {\n\tisCancellationRequested: false,\n\tonCancellationRequested: () => noopDisposable\n};\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\n\n\nexport function disposeAll(disposables: Iterable<vscode.Disposable>) {\n\tconst errors: any[] = [];\n\n\tfor (const disposable of disposables) {\n\t\ttry {\n\t\t\tdisposable.dispose();\n\t\t} catch (e) {\n\t\t\terrors.push(e);\n\t\t}\n\t}\n\n\tif (errors.length === 1) {\n\t\tthrow errors[0];\n\t} else if (errors.length > 1) {\n\t\tthrow new AggregateError(errors, 'Encountered errors while disposing of store');\n\t}\n}\n\nexport interface IDisposable {\n\tdispose(): void;\n}\n\nexport abstract class Disposable {\n\tprivate _isDisposed = false;\n\n\tprotected _disposables: vscode.Disposable[] = [];\n\n\tpublic dispose(): any {\n\t\tif (this._isDisposed) {\n\t\t\treturn;\n\t\t}\n\t\tthis._isDisposed = true;\n\t\tdisposeAll(this._disposables);\n\t}\n\n\tprotected _register<T extends vscode.Disposable>(value: T): T {\n\t\tif (this._isDisposed) {\n\t\t\tvalue.dispose();\n\t\t} else {\n\t\t\tthis._disposables.push(value);\n\t\t}\n\t\treturn value;\n\t}\n\n\tprotected get isDisposed() {\n\t\treturn this._isDisposed;\n\t}\n}\n\nexport class DisposableStore extends Disposable {\n\n\tpublic add<T extends IDisposable>(disposable: T): T {\n\t\tthis._register(disposable);\n\n\t\treturn disposable;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\n\nexport async function exists(resource: vscode.Uri): Promise<boolean> {\n\ttry {\n\t\tconst stat = await vscode.workspace.fs.stat(resource);\n\t\t// stat.type is an enum flag\n\t\treturn !!(stat.type & vscode.FileType.File);\n\t} catch {\n\t\treturn false;\n\t}\n}\n\nexport function looksLikeAbsoluteWindowsPath(path: string): boolean {\n\treturn /^[a-zA-Z]:[\\/\\\\]/.test(path);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n/**\n * Return a hash value for an object.\n */\nexport function hash(obj: any, hashVal = 0): number {\n\tswitch (typeof obj) {\n\t\tcase 'object':\n\t\t\tif (obj === null) {\n\t\t\t\treturn numberHash(349, hashVal);\n\t\t\t} else if (Array.isArray(obj)) {\n\t\t\t\treturn arrayHash(obj, hashVal);\n\t\t\t}\n\t\t\treturn objectHash(obj, hashVal);\n\t\tcase 'string':\n\t\t\treturn stringHash(obj, hashVal);\n\t\tcase 'boolean':\n\t\t\treturn booleanHash(obj, hashVal);\n\t\tcase 'number':\n\t\t\treturn numberHash(obj, hashVal);\n\t\tcase 'undefined':\n\t\t\treturn 937 * 31;\n\t\tdefault:\n\t\t\treturn numberHash(obj, 617);\n\t}\n}\n\nfunction numberHash(val: number, initialHashVal: number): number {\n\treturn (((initialHashVal << 5) - initialHashVal) + val) | 0;  // hashVal * 31 + ch, keep as int32\n}\n\nfunction booleanHash(b: boolean, initialHashVal: number): number {\n\treturn numberHash(b ? 433 : 863, initialHashVal);\n}\n\nfunction stringHash(s: string, hashVal: number) {\n\thashVal = numberHash(149417, hashVal);\n\tfor (let i = 0, length = s.length; i < length; i++) {\n\t\thashVal = numberHash(s.charCodeAt(i), hashVal);\n\t}\n\treturn hashVal;\n}\n\nfunction arrayHash(arr: any[], initialHashVal: number): number {\n\tinitialHashVal = numberHash(104579, initialHashVal);\n\treturn arr.reduce((hashVal, item) => hash(item, hashVal), initialHashVal);\n}\n\nfunction objectHash(obj: any, initialHashVal: number): number {\n\tinitialHashVal = numberHash(181387, initialHashVal);\n\treturn Object.keys(obj).sort().reduce((hashVal, key) => {\n\t\thashVal = stringHash(key, hashVal);\n\t\treturn hash(obj[key], hashVal);\n\t}, initialHashVal);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport class Lazy<T> {\n\n\tprivate _didRun: boolean = false;\n\tprivate _value?: T;\n\tprivate _error: Error | undefined;\n\n\tconstructor(\n\t\tprivate readonly executor: () => T,\n\t) { }\n\n\t/**\n\t * True if the lazy value has been resolved.\n\t */\n\tget hasValue() { return this._didRun; }\n\n\t/**\n\t * Get the wrapped value.\n\t *\n\t * This will force evaluation of the lazy value if it has not been resolved yet. Lazy values are only\n\t * resolved once. `getValue` will re-throw exceptions that are hit while resolving the value\n\t */\n\tget value(): T {\n\t\tif (!this._didRun) {\n\t\t\ttry {\n\t\t\t\tthis._value = this.executor();\n\t\t\t} catch (err) {\n\t\t\t\tthis._error = err;\n\t\t\t} finally {\n\t\t\t\tthis._didRun = true;\n\t\t\t}\n\t\t}\n\t\tif (this._error) {\n\t\t\tthrow this._error;\n\t\t}\n\t\treturn this._value!;\n\t}\n\n\t/**\n\t * Get the wrapped value without forcing evaluation.\n\t */\n\tget rawValue(): T | undefined { return this._value; }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport function memoize(_target: any, key: string, descriptor: any) {\n\tlet fnKey: string | undefined;\n\tlet fn: Function | undefined;\n\n\tif (typeof descriptor.value === 'function') {\n\t\tfnKey = 'value';\n\t\tfn = descriptor.value;\n\t} else if (typeof descriptor.get === 'function') {\n\t\tfnKey = 'get';\n\t\tfn = descriptor.get;\n\t} else {\n\t\tthrow new Error('not supported');\n\t}\n\n\tconst memoizeKey = `$memoize$${key}`;\n\n\tdescriptor[fnKey] = function (...args: any[]) {\n\t\tif (!this.hasOwnProperty(memoizeKey)) {\n\t\t\tObject.defineProperty(this, memoizeKey, {\n\t\t\t\tconfigurable: false,\n\t\t\t\tenumerable: false,\n\t\t\t\twritable: false,\n\t\t\t\tvalue: fn!.apply(this, args)\n\t\t\t});\n\t\t}\n\n\t\treturn this[memoizeKey];\n\t};\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as array from './arrays';\n\nexport function equals(one: any, other: any): boolean {\n\tif (one === other) {\n\t\treturn true;\n\t}\n\tif (one === null || one === undefined || other === null || other === undefined) {\n\t\treturn false;\n\t}\n\tif (typeof one !== typeof other) {\n\t\treturn false;\n\t}\n\tif (typeof one !== 'object') {\n\t\treturn false;\n\t}\n\tif (Array.isArray(one) !== Array.isArray(other)) {\n\t\treturn false;\n\t}\n\n\tif (Array.isArray(one)) {\n\t\treturn array.equals(one, other, equals);\n\t} else {\n\t\tconst oneKeys: string[] = [];\n\t\tfor (const key in one) {\n\t\t\toneKeys.push(key);\n\t\t}\n\t\toneKeys.sort();\n\t\tconst otherKeys: string[] = [];\n\t\tfor (const key in other) {\n\t\t\totherKeys.push(key);\n\t\t}\n\t\totherKeys.sort();\n\t\tif (!array.equals(oneKeys, otherKeys)) {\n\t\t\treturn false;\n\t\t}\n\t\treturn oneKeys.every(key => equals(one[key], other[key]));\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\n\nexport interface PackageInfo {\n\tname: string;\n\tversion: string;\n\taiKey: string;\n}\n\nexport function getPackageInfo(context: vscode.ExtensionContext) {\n\tconst packageJSON = context.extension.packageJSON;\n\tif (packageJSON && typeof packageJSON === 'object') {\n\t\treturn {\n\t\t\tname: packageJSON.name ?? '',\n\t\t\tversion: packageJSON.version ?? '',\n\t\t\taiKey: packageJSON.aiKey ?? '',\n\t\t};\n\t}\n\treturn null;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\n\nexport function isWeb(): boolean {\n\treturn 'navigator' in globalThis && vscode.env.uiKind === vscode.UIKind.Web;\n}\n\nexport function isWebAndHasSharedArrayBuffers(): boolean {\n\treturn isWeb() && (globalThis as any)['crossOriginIsolated'];\n}\n\nexport function supportsReadableByteStreams(): boolean {\n\treturn isWeb() && 'ReadableByteStreamController' in globalThis;\n}\n\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport function escapeRegExp(text: string) {\n\treturn text.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, '\\\\$&');\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as path from 'path';\nimport * as vscode from 'vscode';\n\nexport class RelativeWorkspacePathResolver {\n\tpublic static asAbsoluteWorkspacePath(relativePath: string): string | undefined {\n\t\tfor (const root of vscode.workspace.workspaceFolders || []) {\n\t\t\tconst rootPrefixes = [`./${root.name}/`, `${root.name}/`, `.\\\\${root.name}\\\\`, `${root.name}\\\\`];\n\t\t\tfor (const rootPrefix of rootPrefixes) {\n\t\t\t\tif (relativePath.startsWith(rootPrefix)) {\n\t\t\t\t\treturn path.join(root.uri.fsPath, relativePath.replace(rootPrefix, ''));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport * as fileSchemes from '../configuration/fileSchemes';\nimport { looksLikeAbsoluteWindowsPath } from './fs';\n\n/**\n * Maps of file resources\n *\n * Attempts to handle correct mapping on both case sensitive and case in-sensitive\n * file systems.\n */\nexport class ResourceMap<T> {\n\n\tprivate static readonly defaultPathNormalizer = (resource: vscode.Uri): string => {\n\t\tif (resource.scheme === fileSchemes.file) {\n\t\t\treturn resource.fsPath;\n\t\t}\n\t\treturn resource.toString(true);\n\t};\n\n\tprivate readonly _map = new Map<string, { readonly resource: vscode.Uri; value: T }>();\n\n\tconstructor(\n\t\tprotected readonly _normalizePath: (resource: vscode.Uri) => string | undefined = ResourceMap.defaultPathNormalizer,\n\t\tprotected readonly config: {\n\t\t\treadonly onCaseInsensitiveFileSystem: boolean;\n\t\t},\n\t) { }\n\n\tpublic get size() {\n\t\treturn this._map.size;\n\t}\n\n\tpublic has(resource: vscode.Uri): boolean {\n\t\tconst file = this.toKey(resource);\n\t\treturn !!file && this._map.has(file);\n\t}\n\n\tpublic get(resource: vscode.Uri): T | undefined {\n\t\tconst file = this.toKey(resource);\n\t\tif (!file) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst entry = this._map.get(file);\n\t\treturn entry ? entry.value : undefined;\n\t}\n\n\tpublic set(resource: vscode.Uri, value: T) {\n\t\tconst file = this.toKey(resource);\n\t\tif (!file) {\n\t\t\treturn;\n\t\t}\n\t\tconst entry = this._map.get(file);\n\t\tif (entry) {\n\t\t\tentry.value = value;\n\t\t} else {\n\t\t\tthis._map.set(file, { resource, value });\n\t\t}\n\t}\n\n\tpublic delete(resource: vscode.Uri): void {\n\t\tconst file = this.toKey(resource);\n\t\tif (file) {\n\t\t\tthis._map.delete(file);\n\t\t}\n\t}\n\n\tpublic clear(): void {\n\t\tthis._map.clear();\n\t}\n\n\tpublic values(): Iterable<T> {\n\t\treturn Array.from(this._map.values(), x => x.value);\n\t}\n\n\tpublic entries(): Iterable<{ resource: vscode.Uri; value: T }> {\n\t\treturn this._map.values();\n\t}\n\n\tprivate toKey(resource: vscode.Uri): string | undefined {\n\t\tconst key = this._normalizePath(resource);\n\t\tif (!key) {\n\t\t\treturn key;\n\t\t}\n\t\treturn this.isCaseInsensitivePath(key) ? key.toLowerCase() : key;\n\t}\n\n\tprivate isCaseInsensitivePath(path: string) {\n\t\tif (looksLikeAbsoluteWindowsPath(path)) {\n\t\t\treturn true;\n\t\t}\n\t\treturn path[0] === '/' && this.config.onCaseInsensitiveFileSystem;\n\t}\n}\n","module.exports = require(\"vscode\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.b = self.location + \"\";\n\n// object to store loaded chunks\n// \"1\" means \"already loaded\"\nvar installedChunks = {\n\t606: 1\n};\n\n// no chunk install function needed\n// no chunk loading\n\n// no HMR\n\n// no HMR manifest","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(3406);\n"],"names":["defaultConfig","endpointUrl","S","propertyStorageOverride","isVal","getProperty","setProperty","_super","AppInsightsCore","_this","call","this","_self","_base","config","extensions","logger","notificationManager","cfg","e","logger_1","message","track","item","telemetryItem","trackStart","latency","itemExt","ext","sdk","ver","baseData","itemProperties","pluginVersionString","eventName","__ieDyn","ValueKind","NotSet","Pii_DistinguishedName","Pii_GenericData","Pii_IPV4Address","Pii_IPv6Address","Pii_MailSubject","Pii_PhoneNumber","Pii_QueryString","Pii_SipAddress","Pii_SmtpAddress","Pii_Identity","Pii_Uri","Pii_Fqdn","Pii_IPV4AddressLegacy","Pii_IPv6ScrubLastHextets","Pii_DropValue","CustomerContent_GenericContent","EventLatency","Normal","CostDeferred","RealTime","Immediate","EventPropertyType","Unspecified","String","Int32","UInt32","Int64","UInt64","Double","Bool","Guid","DateTime","EventPersistence","Critical","TraceLevel","NONE","ERROR","WARNING","INFORMATION","ValueSanitizer","fieldSanitizerProvider","_sanitizerMap","_sanitizers","_fieldSanitizers","_getFieldSanitizer","path","name","result","fieldLookup","lp","canHandle","fieldHandler","handler","_handleProperty","mapValue","fieldType","property","stringifyObjects","toString","_callFieldSanitizer","_convertToProperty","value","fieldProvider","theType","sanitizer","getSanitizer","propertyType","newValue_1","propValue","propKey","theValue","newPath","newProp","details","type","prop","push","clearCache","addSanitizer","newSanitizer","addFieldSanitizer","fieldSanitizer","theSanitizer","idx","splice","theFieldSanitizer","isEmpty","JSON","stringify","subType","getFieldType","MinChannelPriorty","LoggingSeverity","DISABLED","CRITICAL","DEBUG","STR_EMPTY","STR_DEFAULT_ENDPOINT_URL","STR_VERSION","STR_PROPERTIES","_a","Version","FullVersionString","ObjHasOwnProperty","hasOwnProperty","strDisabledPropertyName","strWithCredentials","strTimeout","_fieldTypeEventPropMap","uInt8ArraySupported","isDocumentObjectAvailable","isWindowObjectAvailable","isValueAssigned","getTenantId","apiKey","indexTenantId","isUint8ArrayAvailable","Uint8Array","nav","userAgent","ua","toLowerCase","isSafariOrFirefox","isLatency","sanitizeProperty","propType","isArrayValid","isValueKind","getCommonSchemaMetaData","kind","encodedTypeValue","isDataType","getFieldValueType","getCookieValue","cookieMgr","decode","cookieValue","get","decodeURIComponent","createGuid","style","theGuid","replace","extend","obj","obj2","obj3","obj4","obj5","extended","deep","i","length","arguments","theArgs","arrayValue","arrayIndex","getTime","setProcessTelemetryTimings","event","identifier","evt","objType","isChromium","openXhr","method","urlString","withCredentials","disabled","isSync","timeout","_wrapSetXhrProp","xhr","XMLHttpRequest","open","isGreaterThanZero","_DYN_INITIALIZE","_DYN_LOGGER","_DYN_INDEX_OF","_DYN_TIMINGS","_DYN_POLL_INTERNAL_LOGS","_DYN_VALUE","_DYN_KIND","_DYN_LENGTH","_DYN_PROCESS_TELEMETRY_ST0","_DYN_HANDLE_FIELD","_DYN_RM_SANITIZER","_DYN_RM_FIELD_SANITIZER","_DYN_CAN_HANDLE","RT_PROFILE","NRT_PROFILE","BE_PROFILE","STR_DROPPED","STR_REQUEUE","DEFAULT_CACHE_CONTROL","DEFAULT_CONTENT_TYPE","STR_CACHE_CONTROL","STR_CONTENT_TYPE_HEADER","STR_CLIENT_VERSION","STR_CLIENT_ID","STR_TIME_DELTA_TO_APPLY","STR_UPLOAD_TIME","STR_API_KEY","STR_MSA_DEVICE_TICKET","STR_AUTH_WEB_TOKEN","STR_AUTH_XTOKEN","STR_MSFPC","STR_TRACE","STR_USER","_DYN_ALLOW_REQUEST_SENDIN0","_DYN_FIRST_REQUEST_SENT","_DYN_SHOULD_ADD_CLOCK_SKE1","_DYN_GET_CLOCK_SKEW_HEADE2","_DYN_SET_CLOCK_SKEW","_DYN_CONCAT","_DYN_I_KEY","_DYN_COUNT","_DYN_EVENTS","_DYN_PUSH","_DYN_SPLIT","_DYN_SPLICE","_DYN_TO_LOWER_CASE","_DYN_HDRS","_DYN_USE_HDRS","_DYN_SET_TIMEOUT_OVERRIDE","_DYN_CLEAR_TIMEOUT_OVERRI3","_DYN_OVERRIDE_ENDPOINT_UR4","_DYN_AVOID_OPTIONS","_DYN_ENABLE_COMPOUND_KEY","_DYN_DISABLE_XHR_SYNC","_DYN_DISABLE_FETCH_KEEP_A6","_DYN_USE_SEND_BEACON","_DYN_FETCH_CREDENTIALS","_DYN_ALWAYS_USE_XHR_OVERR7","_DYN_SERIALIZE_OFFLINE_EV8","_DYN_GET_OFFLINE_REQUEST_9","_DYN_CREATE_PAYLOAD","_DYN_CREATE_ONE_DSPAYLOAD","_DYN_PAYLOAD_BLOB","_DYN_HEADERS","_DYN__THE_PAYLOAD","_DYN_URL_STRING","_DYN_BATCHES","_DYN_SEND_TYPE","_DYN_ADD_HEADER","_DYN_CAN_SEND_REQUEST","_DYN_SEND_QUEUED_REQUESTS","_DYN_IS_COMPLETELY_IDLE","_DYN_SET_UNLOADING","_DYN_RESUME","_DYN_SEND_SYNCHRONOUS_BAT10","_DYN__TRANSPORT","_DYN_GET_WPARAM","_DYN_IS_BEACON","_DYN_IS_TEARDOWN","_DYN_IS_SYNC","_DYN_DATA","_DYN__SEND_REASON","_DYN_SET_KILL_SWITCH_TENA11","_DYN__BACK_OFF_TRANSMISSI12","_DYN_IDENTIFIER","_DYN_EVENTS_LIMIT_IN_MEM","_DYN_AUTO_FLUSH_EVENTS_LI14","_DYN_BASE_DATA","_DYN_SEND_ATTEMPT","_DYN_LATENCY","_DYN_SYNC","_getEventMsfpc","theEvent","intWeb","_getMsfpc","theEvents","msfpc","EventBatch","iKey","addEvents","events","_msfpc","Msfpc","addEvent","fromEvent","numEvents","cnt","create","ClockSkewManager","_allowRequestSending","_shouldAddClockSkewHeaders","_isFirstRequest","_clockSkewHeaderValue","_clockSkewSet","timeDeltaInMillis","KillSwitch","_killedTokenDictionary","killTokens","killDuration","killedTokens","values","durationMs","parseInt","ex","tenantToken","killDictionary","undefined","retryPolicyGetMillisToBackoffForRetry","retriesSoFar","waitDuration","randomBackoff","Math","floor","random","BaseBackoff","pow","min","MaxRecordSize","MaxBeaconRecordSize","metadata","f","rCheckDot","Serializer","perfManager","valueSanitizer","enableCompoundKey","getEncodedTypeOverride","excludeCsMetaData","strData","strBaseData","_checkForCompoundkey","_processSubKeys","_theSanitizer","_isReservedCache","_excludeCsMetaData","_getEncodedType","_processPathKeys","srcObj","target","thePath","checkReserved","metadataPathKeys","metadataCallback","processSubKeys","key","srcValue","name_1","theMetaPathKeys","destObj","test","subKeys","split","keyLen","slice","subKey","isReserved","_isReservedField","handleField","newValue","createPayload","retryCnt","isTeardown","isReducedPayload","sendReason","sendType","apiKeys","payloadBlob","overflow","sizeExceed","failedEvts","batches","isBeacon","appendPayload","payload","theBatch","maxEventsPerBatch","canAddEvents","payloadEvents","eventsAdded","sizeExceeded","isBeaconPayload","requestMaxSize","recordMaxSize","joinCount","eventBlob","getEventBlob","blobLength","evts","max","eventData","serializedEvent","time","_addMetadataCallback","serializedExt","pathKeys","getEncodedType","json","propKeys","propertyValue","metaData","metaTarget","newTarget","t","_addJSONPropertyMetaData","eventExt","serializedData","baseType","serializedBaseData","data","createTimeoutWrapper","argSetTimeout","argClearTimeout","set","callback","ms","args","_i","strSendAttempt","UrlQueryString","_eventActionMap","_collectorQsHeaders","_collectorHeaderToQs","_addCollectorHeaderQsMapping","qsName","headerName","allowQs","_hasHeader","headers","header","hasHeader","keys","lowerHeader","_addRequestDetails","useHeaders","url","HttpManager","maxConnections","maxRequestRetriesBeforeBackoff","actions","_urlString","_killSwitch","_paused","_clockSkewManager","_outstandingRequests","_postManager","_logger","_sendInterfaces","_core","_customHttpInterface","_queryStringParameters","_headers","_batchQueue","_serializer","_enableEventTimings","_cookieMgr","_isUnloading","_useHeaders","_xhrTimeout","_disableXhrSync","_disableFetchKeepAlive","_canHaveReducedPayload","_addNoResponse","_unloadHooks","_sendHook","_sendListener","_responseHandlers","_isInitialized","_timeoutWrapper","_sendPostMgr","_fetchCredentials","_useBeacons","_getSenderInterface","transports","syncSupport","getSenderInst","_getSendPostMgrConfig","enableSendPromise","isOneDs","disableCredentials","fetchCredentials","disableXhr","disableBeacon","disableBeaconSync","disableFetchKeepAlive","timeWrapper","addNoResponse","senderOnCompleteCallBack","xdrOnComplete","_xdrOncomplete","fetchOnComplete","_fetchOnComplete","xhrOnComplete","_xhrOnComplete","beaconOnRetry","_onBeaconRetry","xdr","oncomplete","response","_doOnComplete","_handleCollectorResponse","onComplete","resValue","headerMap","status","responseText","handleResponse","request","canSend","thePayload","theUrl","nav_1","persistStorage","getPlugin","droppedBatches_1","sentBatches_1","sendBeacon","sentEvts","_sendBatchesNotification","_isBeaconPayload","_adjustSendType","_hasIdleConnection","_clearQueue","theQueue","_canSendPayload","theBatches","_createDebugBatches","_sendBatches","retryCount","orgBatches_1","isSynchronous_1","perfEvt","droppedBatches","serializationStart","sendInterface","sendTransport","_isSync","shift","isTenantKilled","_doPayloadSend","isSynchronous","useSendBeacon","_buildRequestDetails","requestDetails","hdrs","useHdrs","apiQsKeys","encodeURIComponent","wParam","_setTimingValue","timings","serializationCompleted","useSendHook_1","sendInterface_1","useHeaders_1","requestDetails_1","sendEventStart_1","batchLp","evtLp","orgPayloadData","_thePayload","_sendReason","disableXhrSync","sender","httpStatusCode","reason","isRetrying","backOffTrans","shouldRetry","killToken","removedEvents","retryCount_1","_doAction","batchReason","_clearBackOff","sendEventCompleted_1","sendEventCompleted","_addEventCompletedTimings","_addCompleteTimings","sendQueuedRequests","_handleRequestFinished","_retryRequestIfNeeded","sendPOST","hookData_1","senderCalled_1","cb","interval","responseHandlers","parse","webResult","sendSync","theAction_1","action","isSyncRequest_1","undefValue","_initDefaults","theConfig","core","postChannel","getCookieMgr","diagLog","coreConfig","channelConfig","extensionConfig","anonCookieName","qsParams","_addQueryStringParameter","_removeQueryStringParameter","payloadListener","httpInterface","httpXHROverride","xhrTimeout","sendPostConfig","SetConfig","SenderPostManager","syncHttpInterface","beaconHttpInterface","fetchSyncHttpInterface","beaconUnloadTransports","theTransports","addResponseHandler","responseHandler","rm","index","indexOf","optimize","theBatches_1","batch","payloadData","removeHeader","addBatch","teardown","hook","pause","MaxEventsLimitInMem","strEventsDiscarded","defaultPostChannelConfig","eventsLimitInMem","v","immediateEventLimit","autoFlushEventsLimit","disableAutoBatchFlushLimit","overrideInstrumentationKey","overrideEndpointUrl","disableTelemetry","ignoreMc1Ms0CookieProcessing","setTimeoutOverride","clearTimeoutOverride","payloadPreprocessor","disableEventTimings","disableOptimizeObj","unloadTransports","avoidOptions","alwaysUseXhrOverride","maxEventRetryAttempts","maxUnloadEventRetryAttempts","PostChannel","_postConfig","priority","version","_flushCallbackTimer","_immediateQueueSizeLimit","_queueSizeLimit","_scheduledTimer","_immediateTimer","_currentBackoffCount","_timerCount","_httpManager","_batchQueues","_autoFlushEventsLimit","_autoFlushBatchLimit","_delayedBatchSendLatency","_delayedBatchReason","_optimizeObject","_isPageUnloadTriggered","_maxEventSendAttempts","_maxUnloadEventSendAttempts","_evtNamespace","_ignoreMc1Ms0CookieProcessing","_disableAutoBatchFlushLimit","_notificationManager","_unloadHandlersAdded","_overrideInstrumentationKey","_disableTelemetry","_isTeardownCalled","_flushCallbackQueue","_immediateQueueSize","_queueSize","_profiles","_currentProfile","_removeUnloadHandlers","_batch","arr","rlt","_serialize","_cleanEvent","_handleUnloadEvents","_releaseAllQueues","_handleShowEvents","_addEventToQueues","append","evtLatency","queueSize","queueLimit","eventDropped","_addEventToProperQueue","dropLatency","dropNumber","currentLatency","eventBatch","_getEventBatch","droppedEvents","droppedCount","_notifyBatchEvents","EventsDiscardedReason","QueueFull","_resetQueueCounts","_dropEventWithLatencyOrLess","_notifyEvents","_sendEventsForLatencyAndAbove","queued","_queueBatches","_hasEvents","_scheduleTimer","immediateTimeOut","_createTimer","timeOut","requeue","_requeueEvents","send","_sendingEvent","sent","_eventsSentEvent","drop","_eventsDropped","rspFail","_eventsResponseFail","oth","_otherEvent","_initializeProfiles","iKeyMap","_setAutoLimits","theTimerFunc","timerMultiplier","_clearScheduledTimer","cancel","batchQueue","_performAutoFlush","isAsync","doFlush","flush","sync","immediateQueue","normalQueue","_loop_1","eventsQueued","latencyToProcess","_flushImpl","_waitForIdleManager","maxSendAttempts","NonRetryableStatus","_callNotification","evtName","manager","notifyFunc","apply","extraArgs","isSyncRequest","Unknown","MaxNumberEventPerBatch","getNotifyMgr","evtNamespace","_addHook","ctx","getExtCfg","existingGetWParamMethod","wparam","_hookWParam","excludePageUnloadEvents","disablePageUnloadEvents","disablePageShowEvents","setInitialized","processTelemetry","ev","itemCtx","_getTelCtx","processNext","getOfflineSupport","details_1","getUrl","serialize","shouldProcess","createOneDSPayload","_doTeardown","unloadCtx","unloadState","setEventQueueLimits","eventLimit","autoFlushLimit","_loadTransmitProfiles","profiles","profileName","profileValue","profLen","directValue","ceil","async","resolve","cleared","setMsaAuthTicket","ticket","setAuthPluginHeader","token","removeAuthPluginHeader","hasEvents","_setTransmitProfile","BaseTelemetryPlugin","BreezeChannelIdentifier","_stringToBoolOrDefault","defaultValue","cfgDfMerge","mrg","cfgDfValidate","validator","fallBackName","fb","cfgDfBoolean","_isConfigDefaults","_getDefault","dynamicHandler","cfgDefaults","defValue","isDefaultValid","dfVal","fallbacks","fallback","fbValue","_resolveDefaultValue","_applyDefaultValue","isValid","setFn","mergeDf","reference","readOnly","blkDynamicValue","ref","usingDefault","cfgValue","dfName","dfValue","aggregationErrorType","arrayMethodsToPatch","_throwDynamicError","desc","concat","_getOwnPropGetter","propDesc","_setDynamicProperty","state","getter","detail","n","h","trk","fn","clr","checkDynamic","isObjectOrArray","_getProperty","_makeDynamicObject","activeHandler","act","chng","add","g","s","ro","upd","isReferenced","rf","hdlr","valueState","newIsObjectOrArray","_createDynamicProperty","_setDynamicPropertyState","flags","isDynamic","inPlace","rdOnly","blkProp","blkVal","orgMethod","_patchArray","symPrefix","symPostfix","_createDynamicHandler","theState","uid","cfgHandler","defaultValues","configHandler","use","_createAndUseHandler","_block","allowUpdate","prevUpd","c","w","dynamicPropertySymbol","dynamicPropertyReadOnly","dynamicPropertyReferenced","dynamicPropertyBlockValue","dynamicPropertyDetail","_waitingHandlers","_watcherTimer","_useHandler","prevWatcher","bind","setDf","_notifyWatchers","notifyHandlers","watcherFailures_1","sourceErrors","self","errors","theMessage","srcError","throwAggregationError","_createState","createDynamicConfig","onConfigChange","_logInvalidAccess","CFG_HANDLER_LINK","BLOCK_DYNAMIC","FORCE_DYNAMIC","_cfgDeepCopy","source","target_1","getDynamicConfigHandler","blockDynamicConversion","forceDynamicConversion","_canMakeDynamic","getFunc","throwInvalidAccess","createEnumStyle","createValueMap","InvalidEvent","SizeLimitExceeded","CleanStorage","MaxInStorageTimeExceeded","ActiveStatus","PENDING","INACTIVE","ACTIVE","TelemetryInitializerPlugin","_id","_initializers","addTelemetryInitializer","telemetryInitializer","id","theInitializer","remove","initializer","_addInitializer","doNotSendItem","telemetryInitializersCount","exception","_runInitializers","strValidationError","strSdkUnloadingError","cookieCfg","loggingLevelConsole","diagnosticLogInterval","_createPerfManager","notificationMgr","PerfManager","_isPluginPresent","thePlugin","plugins","exists","plugin","_deepMergeConfig","newValues","merge","_findWatcher","listeners","newWatcher","theListener","listener","l","_configHandler","_eventQueue","_perfManager","_cfgPerfManager","_cookieManager","_pluginChain","_configExtensions","_channelConfig","_channels","_telemetryInitializerPlugin","_internalLogsEventName","_unloadHandlers","_hookContainer","_debugListener","_traceCtx","_instrumentationKey","_cfgListeners","_extensions","_pluginVersionStringArr","_pluginVersionString","_activeStatus","_endpoint","_initInMemoMaxSize","_isStatusSet","_internalLogPoller","_internalLogPollerListening","_forceStopInternalLogPoller","_setStatus","_releaseQueues","releaseQueue","_startLogPoller","alwaysStart","queue","_addUnloadHook","isRunning","_flushInternalLogs","unref","_setPluginVersions","thePlugins","_addPluginVersions","channels","updateCfg","join","DiagnosticLogger","newLogger","cfgExtensions","_createTelCtx","theCtx","_getPluginChain","_initPluginChain","updateState","theExtensions","channelPriority","allExtensions","coreExtensions","extPriorities","extPriority","_validateExtensions","rootCtx","_doUpdate","_getPlugin","pluginIdentifier","theExt","channelHosts","getChannel","host","setEnabled","enabled","isEnabled","pluginState","removeCb","pluginsToRemove","_removePlugins","removed","removeComplete","unloadChain","newConfigExtensions","newChannelConfig","newQueue","channel","logMessage","Date","dataType","_flushChannels","callBack","cbTimeout","waiting","doneIterating","cbTimer","doCallback","iterate","handled_1","updateCtx","_updateHook","_logOrThrowError","_notifyInvalidEvent","hooks","activeStatus","_setPendingStatus","prevCfgPerfMgr","rootCfg","initInMemoMaxSize","ikey","msg","promises","initTimeout","initTimeOut","allPromises","rejected","ikeyRes","endpointRes","extCfg","unloadContainer","debugListener","disableDbgExt","_initDebugListener","enablePerfMgr","createPerfMgr","teeController","unloadHdl","_registerDelayedCfgListener","getChannels","controls","NotificationManager","setCookieMgr","setPerfMgr","perfMgr","eventCnt","eventQueue","unloadComplete","flushComplete","processUnloadCtx","_doUnload","run","addPlugin","replaceExisting","addCb","existingPlugin","_addPlugin","added","removedPlugins_1","newConfig","mergeExisting","oldCfg","getTraceCtx","createNew","setTraceCtx","traceCtx","addUnloadHook","onCfgChange","unloadHook","fnd","_createUnloadHook","getWParam","enableWParam","runTargetUnload","doUnloadAll","targets","done","resolved","strGetPlugin","_isinitialized","_rootCtx","_nextPlugin","_unloadHandlerContainer","currentCtx","_setDefaults","pluginChain","nextPlugin","unloadDone","theUnloadCtx","theUnloadState","_unloadCallback","updateDone","theUpdateCtx","theUpdateState","_updateCallback","getCfg","isInitialized","next","env","ChannelControllerPriority","DisabledPropertyName","_b","_doc","strToGMTString","strToUTCString","strCookie","strExpires","strIsCookieUseDisabled","strDisableCookiesUsage","strConfigCookieMgr","_supportsCookies","_allowUaSameSite","_parsedCookieValue","_cookieCache","_globalCookieConfig","rootDefaultConfig","ignoreCookies","blockedCookies","cookieDomain","cookiePath","_getDoc","_isMgrEnabled","_isIgnoredCookie","cookieMgrCfg","_isCfgEnabled","rootConfig","cookieMgrConfig","isCfgEnabled","cookieEnabled","safeGetCookieMgr","createCookieMgr","inst","_gblCookieMgr","_path","_domain","unloadHandler","_enabled","_getCookieFn","_setCookieFn","_delCookieFn","getCookie","_getCookieValue","setCookie","_setCookieValue","delCookie","areCookiesSupported","gblManager","maxAgeSec","domain","_isBlockedCookie","_extractParts","_isIE","expireMs","expiry","setTime","_formatDate","location_1","uaDisallowsSameSiteNone","_formatCookieValue","del","purge","doc","parts","thePart","theDate","func","theCookie","newGuid","uuid","generateW3CId","tmp","hexValues","oct","a","clockSequenceHi","instanceName","_dataUid","_canAcceptData","createUniqueNamespace","includeVersion","createElmNodeData","accept","addDefault","theCache","_getCache","kill","listenerFuncs","_aiNamespace","_listenerProxyFunc","dbgExt","getDebugExt","ns","getDebugListener","STR_WARN_TO_CONSOLE","loggingLevelTelemetry","maxMessageLimit","enableDebug","_logFuncs","_sanitizeDiagnosticText","text","_logToConsole","theConsole","logFunc","_InternalLogMessage","msgId","isUserAct","properties","strProps","diagnosticText","safeGetLogger","_loggingLevelConsole","_loggingLevelTelemetry","_maxInternalMessageLimit","_enableDebug","_unloadHandler","_messageCount","_messageLogged","_logInternalMessage","severity","messageKey","_debugExtMsg","throttleLimitMessage","throttleMessage","errorToConsole","_setDefaultsFromConfig","consoleLoggingLevel","debugToConsole","resetInternalMessageCount","_getLogger","_throwInternal","_warnToConsole","strDocumentMode","strLocation","strConsole","strJSON","strCrypto","strMsCrypto","strReactNative","strMsie","strTrident","strXMLHttpRequest","_isTrident","_navUserAgentCheck","_enableMocks","_useXDomainRequest","_beaconsSupported","_hasProperty","theClass","supported","proto","setEnableEnvMocks","getLocation","checkForMock","mockLocation","location","getConsole","console","hasJSON","Boolean","getJSON","getCrypto","getMsCrypto","isReactNative","product","isIE","getIEVersion","userAgentStr","navigator_1","tridentVer","isBeaconsSupported","useCached","isFetchSupported","withKeepAlive","isSupported","useXDomainRequest","XDomainRequest","isXhrSupported","_getNamedValue","findMetaTag","querySelectorAll","content","findNamedServerTiming","perf","navPerf","getEntriesByType","serverTiming","description","strOnPrefix","strAttachEvent","strAddEventHelper","strDetachEvent","strRemoveEventListener","strEvents","strVisibilityChangeEvt","strPageHide","strPageShow","strUnload","strBeforeUnload","strPageHideNamespace","strPageShowNamespace","rRemoveEmptyNs","rRemoveTrailingEmptyNs","_guid","elmNodeData","eventNamespace","_normalizeNamespace","_getEvtNamespace","theNamespace_1","parsedEvent","exec","sort","__getRegisteredEvents","eventCache","evtType","registeredEvents","_getRegisteredEvents","aiEvts","_doDetach","handlerRef","useCapture","_doUnregister","unRegFn","capture","mergeEvtNamespace","theNamespace","namespaces","eventOn","_doAttach","registeredEvent","guid","eventOff","evtName_1","found_1","_unregisterEvents","regEvent","attachEvent","eventNameWithoutOn","detachEvent","addEventHandler","removeEventHandler","_addEventListeners","excludeEvents","addEventListeners","removeEventListeners","addPageUnloadEventListener","removePageUnloadEventListener","addPageHideEventListener","newNamespaces","pageUnloadAdded","visibilityState","removePageHideEventListener","addPageShowEventListener","pageShowAdded","removePageShowEventListener","rCamelCase","rNormalizeInvalid","rLeadingNumeric","isNotNullOrUndefined","normalizeJsName","_all","letter","toUpperCase","match","strContains","search","toISOString","date","getExceptionName","object","setValue","field","valChk","srcChk","getSetValue","_createProxyFunction","funcName","srcFunc","src","originalArguments","proxyAssign","chkSet","proxyFunctionAs","theFunc","overwriteTarget","proxyFunctions","functionsToProxy","theFuncName","createClassFromInterface","defaults","optimizeObject","theObject","objExtend","obj1","obj6","argLen","arg","isArgArray","isArgObj","isNewArray","clone","getResponseText","formatErrorMessageXdr","formatErrorMessageXhr","prependTransports","newTransports","Object","convertAllHeadersToMap","headersString","headersArray","headerEntry","substring","_appendHeader","theHeaders","STR_KILL_DURATION_HEADER","STR_KILL_DURATION_SECONDS_HEADER","STR_TIME_DELTA_HEADER","_getAllResponseHeaders","UNDEFINED_VALUE","STR_CHANNELS","STR_CORE","STR_CREATE_PERF_MGR","STR_DISABLED","STR_EXTENSION_CONFIG","STR_EXTENSIONS","STR_PROCESS_TELEMETRY","STR_PRIORITY","STR_EVENTS_SENT","STR_EVENTS_DISCARDED","STR_EVENTS_SEND_REQUEST","STR_PERF_EVENT","STR_OFFLINE_STORE","STR_OFFLINE_SENT","STR_OFFLINE_DROP","STR_GET_PERF_MGR","STR_DOMAIN","STR_PATH","STR_NOT_DYNAMIC_ERROR","perfEvtsSendAll","_runScheduledListeners","asyncNotifications","callbacks","_runListeners","_listeners","_asyncNotifications","perfEvent","rn_1","_finishUnload","asyncUnload","strExecutionContextKey","strParentContextKey","strChildrenContextKey","_defaultPerfManager","PerfEvent","payloadDetails","theDetails_1","start","childTime","childEvts","childEvt","exTime","ParentContextKey","ChildrenContextKey","fire","doPerfActiveKey","doPerf","mgrSource","getSource","currentActive","children","getGblPerfMgr","strTelemetryPluginChain","strHasRunFlags","strGetTelCtx","_chainId","_createInternalContext","telemetryChain","startAt","_nextProxy","_onComplete","proxy","createTelemetryProxyChain","_getNextProxyStart","context","_next","nextProxy","completeDetails","_getExtCfg","getConfig","extConfig","hasNext","getNext","setNext","that","createIfMissing","idCfg","createProcessTelemetryContext","internalContext","createProcessTelemetryUnloadContext","createProcessTelemetryUpdateContext","firstProxy","lastProxy_1","newProxy","chainId","hasProcessTelemetry","hasSetNext","proxyChain","_processChain","unload","hasRun","pluginCore","update","_setNext","processPluginFn","hasRunContext","nextId","error","hasNextRun","createTelemetryPluginProxy","ProcessTelemetryContext","UInt32Mask","MaxUInt32","SEED1","SEED2","_mwcSeeded","_mwcW","_mwcZ","_autoSeedMwc","now","seedValue","randomValue","maxValue","random32","signed","getRandomValues","Uint32Array","mwcRandom32","newId","maxLength","number","chars","charAt","parseResponse","itemsAccepted","itemsReceived","_noResponseQs","STR_POST_METHOD","_enableSendPromise","_diagLog","_isOneDs","_onCompleteFuncs","_disableCredentials","_fallbackInst","_disableXhr","_disableBeacon","_disableBeaconSync","_syncFetchPayload","_sendCredentials","_onError","_onNoPayloadUrl","_doBeaconSend","plainTextBatch","Blob","_beaconSender","onRetry","_xhrSender","thePromise","resolveFunc","rejectFunc","reject","endPointUrl","_doOnReadyFunc","onReadyFunc","onreadystatechange","readyState","onload","onerror","ontimeout","_doFetchSender","requestHeaders","Headers","batchLength","ignoreResponse","responseHandled","init","body","credentials","keepalive","Request","_handleError","res","_onFetchComplete","onCompleteFunc","fetch","response_1","ok","resp","statusText","_xdrSender","_window","onloadFunc","onprogress","hostingProtocol","endpoint","lastIndexOf","protocol","getSyncFetchPayload","transportType","sendPostFunc","_transport","getFallbackInst","pluginStateData","_getPluginState","initializePlugins","processContext","initPlugins","lastPlugin","sortPlugins","extA","extB","bHasProcess","createDistributedTraceContext","parentCtx","trace","getName","setName","getTraceId","setTraceId","getSpanId","setSpanId","getTraceFlags","setTraceFlags","newTraceFlags","createUnloadHandlerContainer","handlers","_maxHooks","_hookAddMonitor","_testHookMaxUnloadHooksCb","maxHooks","addMonitor","createUnloadHookContainer","_hooks","oldHooks","TRACE_PARENT_REGEX","DEFAULT_VERSION","INVALID_VERSION","INVALID_TRACE_ID","INVALID_SPAN_ID","SAMPLED_FLAG","_isValid","len","invalidValue","_formatValue","_formatFlags","isNaN","createTraceParent","traceId","spanId","isValidTraceId","isValidSpanId","traceFlags","parseTraceParent","selectIdx","isValidTraceParent","isSampledFlag","formatTraceParent","findW3cTraceParent","traceParent","_DYN_BLK_VAL","_DYN_RD_ONLY","_DYN_NOTIFY","_DYN_WARN_TO_CONSOLE","_DYN_THROW_INTERNAL","_DYN_SET_DF","_DYN_WATCH","_DYN_APPLY","_DYN_HDLR","_DYN_CANCEL","_DYN_REMOVE_NOTIFICATION_0","_DYN_ADD_NOTIFICATION_LIS1","_DYN_IS_INITIALIZED","_DYN_INSTRUMENTATION_KEY","_DYN__INACTIVE","_DYN_GET_NOTIFY_MGR","_DYN_GET_PLUGIN","_DYN_NAME","_DYN_TIME","_DYN_PROCESS_NEXT","_DYN_GET_PROCESS_TEL_CONT2","_DYN_ENABLED","_DYN_STOP_POLLING_INTERNA3","_DYN_UNLOAD","_DYN_ON_COMPLETE","_DYN_VERSION","_DYN_LOGGING_LEVEL_CONSOL4","_DYN_CREATE_NEW","_DYN_TEARDOWN","_DYN_MESSAGE_ID","_DYN_MESSAGE","_DYN_IS_ASYNC","_DYN_DIAG_LOG","_DYN__DO_TEARDOWN","_DYN_UPDATE","_DYN_GET_NEXT","_DYN_SET_NEXT_PLUGIN","_DYN_PROTOCOL","_DYN_USER_AGENT","_DYN_NODE_TYPE","_DYN_REPLACE","_DYN_LOG_INTERNAL_MESSAGE","_DYN_TYPE","_DYN_HANDLER","_DYN_STATUS","_DYN_GET_RESPONSE_HEADER","_DYN_GET_ALL_RESPONSE_HEA5","_DYN_IS_CHILD_EVT","_DYN_GET_CTX","_DYN_SET_CTX","_DYN_COMPLETE","_DYN_ITEMS_RECEIVED","_DYN_SEND_POST","_DYN_TIMEOUT","_DYN_SET_REQUEST_HEADER","_DYN_TRACE_ID","_DYN_SPAN_ID","_DYN_TRACE_FLAGS","strShimFunction","strShimObject","strShimUndefined","strShimPrototype","ObjClass","ObjProto","strHasOwnProperty","__assignFn","p","extendStaticsFn","d","b","__proto__","Array","__extendsFn","__","constructor","__spreadArrayFn","to","from","il","j","SampleRate","ProcessLegacy","HttpMethod","DEFAULT_BREEZE_ENDPOINT","DEFAULT_BREEZE_PATH","strNotSpecified","_DYN_INGESTIONENDPOINT","_DYN_TO_STRING","_DYN_STRINGIFY","_DYN_EXCEPTIONS","_DYN_PARSED_STACK","_DYN_PROPERTIES","_DYN_MEASUREMENTS","_DYN_SIZE_IN_BYTES","_DYN_TYPE_NAME","_DYN_SEVERITY_LEVEL","_DYN_PROBLEM_GROUP","_DYN_IS_MANUAL","_DYN__CREATE_FROM_INTERFA1","_DYN_ASSEMBLY","_DYN_FILE_NAME","_DYN_HAS_FULL_STACK","_DYN_LEVEL","_DYN_METHOD","_DYN_LINE","_DYN_DURATION","_DYN_RECEIVED_RESPONSE","dataSanitizeKeyAndAddUniqueness","map","origLength","nameTrunc","dataSanitizeKey","uniqueField","dataSanitizeString","valueTrunc","dataSanitizeUrl","dataSanitizeInput","dataSanitizeMessage","messageTrunc","dataSanitizeProperties","tempProps_1","dataSanitizeMeasurements","measurements","tempMeasurements_1","measure","input","_msgId","inputTrunc","Event","aiDataContract","envelopeType","Trace","severityLevel","msToTimeSpan","totalms","round","sec","hour","days","PageView","duration","dataSanitizeId","PageViewPerformance","unused","cs4BaseData","perfTotal","networkConnect","sentRequest","receivedResponse","domProcessing","strError","strStack","strStackDetails","strErrorSrc","strMessage","strDescription","_stringify","convertToString","_formatMessage","errorType","evtMessage","_isStackDetails","_convertStackObj","errorStack","items","_getStackFromErrorObj","errorObj","errorMessage","stack","lines","entry","_getOperaStack","_getErrorType","typeName","results","_formatErrorCode","Exception","exceptions","_isExceptionInternal","_ExceptionDetails","CreateAutoException","lineNumber","columnNumber","errorSrc","stackDetails","CreateFromInterface","prototype","toInterface","problemGroup","isManual","exceptionDetailsInterface","CreateSimpleException","assembly","fileName","line","formatError","outerId","hasFullStack","parsedStack","_isExceptionDetailsInternal","frames","level_1","totalSizeInBytes_1","frame","theFrame","_StackFrame","regex","parsedFrame","left","right","size","acceptedLeft","acceptedRight","howMany","_parseStack","exceptionTrunc","dataSanitizeException","_formatStackTrace","sourceFrame","level","matches","sizeInBytes","baseSize","DataPoint","count","stdDev","Metric","metrics","dataPoint","_document","_htmlAnchorIdx","_htmlAnchorElement","urlParseHost","inclPort","fullHost","port","_internalEndpoints","isInternalApplicationInsightsEndpoint","RemoteDependencyData","absoluteUrl","commandName","success","resultCode","requestAPI","correlationContext","dependencyKind","dependencySource","dependencyTypeName","dependencyFields","anchorIdx","anchorCache","tempAnchor","parsedUrl","createElement","href","pathName","pathname","AjaxHelperParseDependencyPath","_disableEvents","LocalStorage","SessionStorage","_canUseSessionStorage","AI","AI_AND_W3C","W3C","_storagePrefix","_getVerifiedStorageObject","storageType","storage","setItem","fail","getItem","_getSessionStorageObject","utlCanUseSessionStorage","reset","utlGetSessionStorage","utlSetSessionStorage","requestContextHeader","requestContextTargetKey","requestContextAppIdFormat","requestIdHeader","traceParentHeader","traceStateHeader","sdkContextHeader","sdkContextHeaderAppIdRequest","requestContextHeaderLowerCase","_aiNameFunc","baseName","aiName","_aiApplication","_aiDevice","_aiLocation","_aiOperation","_aiSession","_aiUser","_aiCloud","_aiInternal","ContextTagKeys","applicationVersion","applicationBuild","applicationTypeId","applicationId","applicationLayer","deviceId","deviceIp","deviceLanguage","deviceLocale","deviceModel","deviceFriendlyName","deviceNetwork","deviceNetworkName","deviceOEMName","deviceOS","deviceOSVersion","deviceRoleInstance","deviceRoleName","deviceScreenResolution","deviceType","deviceMachineName","deviceVMName","deviceBrowser","deviceBrowserVersion","locationIp","locationCountry","locationProvince","locationCity","operationId","operationName","operationParentId","operationRootId","operationSyntheticSource","operationCorrelationVector","sessionId","sessionIsFirst","sessionIsNew","userAccountAcquisitionDate","userAccountId","userId","userStoreRegion","userAuthUserId","userAnonymousUserAcquisitionDate","userAuthenticatedUserAcquisitionDate","cloudName","cloudRole","cloudRoleVer","cloudRoleInstance","cloudEnvironment","cloudLocation","cloudDeploymentUnit","internalNodeName","internalSdkVersion","internalAgentVersion","internalSnippet","internalSdkSrc","CtxTagKeys","Envelope","sampleRate","tags","Data","STR_DURATION","_DYN_TAGS","_DYN_DEVICE_TYPE","_DYN_DATA_TYPE","_DYN_ENVELOPE_TYPE","_DYN__GET","_DYN_ENQUEUE","_DYN_ITEM","_DYN_EMIT_LINE_DELIMITED_0","_DYN_CLEAR","_DYN_MARK_AS_SENT","_DYN_CLEAR_SENT","_DYN_BUFFER_OVERRIDE","_DYN__BUFFER__KEY","_DYN__SENT__BUFFER__KEY","_DYN__MAX__BUFFER__SIZE","_DYN_TRIGGER_SEND","_DYN__SENDER","_DYN_ENDPOINT_URL","_DYN_CUSTOM_HEADERS","_DYN_MAX_BATCH_SIZE_IN_BY1","_DYN_ONUNLOAD_DISABLE_BEA2","_DYN_IS_BEACON_API_DISABL3","_DYN_ALWAYS_USE_XHR_OVERR4","_DYN_DISABLE_XHR","_DYN_ENABLE_SESSION_STORA5","_DYN__BUFFER","_DYN_ONUNLOAD_DISABLE_FET6","_DYN_DISABLE_SEND_BEACON_7","_DYN_ENABLE_SEND_PROMISE","_DYN_GET_SENDER_INST","_DYN_UNLOAD_TRANSPORTS","_DYN_CONVERT_UNDEFINED","_DYN_MAX_BATCH_INTERVAL","_DYN_SERIALIZE","_DYN__ON_ERROR","_DYN__ON_PARTIAL_SUCCESS","_DYN__ON_SUCCESS","_DYN_ITEMS_ACCEPTED","_DYN_ORI_PAYLOAD","_DYN_BASE_TYPE","_DYN_SAMPLE_RATE","_DYN_EVENTS_SEND_REQUEST","_DYN_GET_SAMPLING_SCORE","strBaseType","strProperties","strTrue","_setValueIf","_extractPropsAndMeasurements","_convertPropsUndefinedToCustomDefinedValue","customUndefinedValue","_createEnvelope","envelope","startTime","iKeyNoDashes","envTags","itmExt","itmTags","extUser","user","authId","localId","extApp","app","sesId","extDevice","device","deviceClass","ip","model","web","browserLang","browserVer","browser","envData","envBaseData","envProps","screenRes","userConsent","extOs","os","osVer","extTrace","parentID","tgs","tg","theTags","EnvelopeCreator","_extractPartAExtensions","EnvelopeCreatorInit","EventEnvelopeCreator","customProperties","customMeasurements","BaseSendBuffer","_buffer","_bufferFullMessageSent","_maxRetryCnt","maxRetryCnt","_set","buffer","getItems","batchPayloads","payloads","payloadStr_1","canUseSessionStorage","newBuffer","SessionStorageSendBuffer","ArraySendBuffer","PREVIOUS_KEYS","_namePrefix","namePrefix","bufferItems","_getBuffer","itemsInSentBuffer","previousItems","_getItemsFromPreviousKey","prefixEvents","_getPreviousEvents","notDeliveredItems","_removePayloadsFromBuffer","remaining","payloadStr","_getBufferBase","bufferJson","buffer_1","_setBuffer","prefixedKey","transFormedItems_1","internalItem","utlRemoveSessionStorage","BUFFER_KEY","sentElements","unsentItems","sentItems","VERSION","SENT_BUFFER_KEY","MAX_BUFFER_SIZE","_serializeObject","circularReferenceCheck","output","_serializeStringMap","_serializeArray","contract","isRequired","isHidden","isArray","isPresent","isObj","sources","expectedType","num","parseFloat","HashCodeScoreGenerator","getHashCodeScore","getHashCode","INT_MAX_VALUE","hash","charCodeAt","abs","SamplingScoreGenerator","hashCodeGenerator","telemetryTrace","Sample","throwInternal","samplingRate","samplingScoreGenerator","isSampledIn","samplingPercentage","_getResponseText","defaultAppInsightsChannelConfig","isRetryDisabled","retryCodes","EnvelopeTypeCreator","props","currentContextId","bd","uri","refUri","pageType","isLoggedIn","pageTags","pageViewData","exData","baseMetricData","average","sampleCount","remoteDepData","responseCode","Sender","_consecutiveErrors","_retryAt","_timeoutHandle","_stamp_specific_redirects","_syncUnloadSender","_offlineListener","_endpointUrl","_orgEndpointUrl","_maxBatchSizeInBytes","_beaconSupported","_beaconOnUnloadSupported","_beaconNormalSupported","_customHeaders","_convertUndefined","_isRetryDisabled","_maxBatchInterval","_sessionStorageUsed","_bufferOverrideUsed","_alwaysUseCustomSend","_fetchKeepAlive","_xhrSend","_fallbackSend","_disableBeaconSplit","_retryCodes","_xdrOnLoad","_xhrReadyStateChange","countOfItemsInPayload","_checkResponsStatus","responseURL","_getPayloadArr","_validate","diagLogger","_sample","_getEnvelope","defaultEnvelopeIkey","aiEnvelope","constructEnvelope","valid","_createPayload","_getHeaders","_doSend","markAsSent","_getPayload","_onSuccess","_getOnComplete","_checkMaxSize","incomingPayload","incomingSize","isOnline","responseUrl","_appId","appId","_checkAndUpdateEndPointUrl","_resendPayload","_isRetriable","_doUnloadSend","_isStringArr","_fetchKeepAliveSender","transport","payloadSize","linearFactor","payload_1","delayInSeconds","backOffSlot","backOffDelay","retryAfterTimeSpan","_setRetryTime","_setupTimer","retryInterval","timerValue","statusCode","resume","onunloadFlush","addHeader","parentEvtNamespace","_navigator","_isListening","listenerList","rState","onLine","uState","_currentState","calCurrentState","_enableEvents","ononline","_setOnline","_setOffline","listnerNoticeCheck","newState","offlineState","isListening","win","addListener","setOnlineState","createOfflineListener","storagePrefix","senderConfig","curExtUrl","coreUrl","customHeader","bufferOverride","shouldUpdate","instrumentationKey","disableValidation","disableInstrumentationKeyValidation","RegExp","_validateInstrumentationKey","onCompleteFuncs","droppedPayload","customInterface","syncInterface","xhrInterface","syncTransports","filter","payloadItem","isCompletelyIdle","getOfflineListener","forcedSender","sendRequest","_notifySendRequest","ieVer","failed","retry","errors_1","reverse","extracted","_onPartialSuccess","orig","convertUndefined","parseConnectionString","connectionString","kvPairs","fields","kv","kvParts","endpointsuffix","locationPrefix","_DYN_CONNECTION_STRING","_DYN_INSTRUMENTATIONKEY0","_DYN_USER_OVERRIDE_ENDPOI1","SeverityLevel","Verbose","Information","Warning","Error","defaultConfigValues","ApplicationInsights","_config","_track","_initialize","configCs","ikeyPromise","curCs","urlPromise","ingest","cs","initialize","Constructor","Prototype","strFunction","DynInstFuncTable","DynProxyTag","DynClassName","DynClassNamePrefix","DynInstChkTag","DynAllowInstChkTag","DynProtoDefaultOptions","UnknownValue","str__Proto","DynProtoBaseProto","DynProtoGlobalSettings","DynProtoCurrent","strUseBaseInst","strSetInstFuncs","Obj","_objGetPrototypeOf","_objGetOwnProps","_gbl","_gblInst","o","_isObjectOrArrayPrototype","_isObjectArrayOrFunctionPrototype","Function","_getObjProto","newProto","curProto","_forEachProp","_isDynamicCandidate","skipOwn","_throwTypeError","_hasVisited","_populatePrototype","className","baseInstFuncs","setInstanceFunc","instFuncTable","instFuncs_1","dynProtoProxy","instFunc","currentDynProtoProxy","canAddInst","objProto","visited","protoFunc","_getInstFunc","_getProtoFunc","_createDynamicPrototype","_getObjName","unknownValue","dynamicProto","delegateFunc","options","classProto","thisTarget","thisProto","_checkPrototype","perfOptions","useBaseInst","instFuncs","_getInstanceFuncs","baseFuncs","_instFuncProxy","funcHost","baseProto","_getBaseFuncs","_debugState","_debugResult","_debugHandled","STR_PROMISE","REJECTED","doAwaitResponse","doAwait","resolveFn","rejectFn","finallyFn","then","err","finally","doFinally","_hasInitEvent","_promiseDebugEnabled","STRING_STATES","DISPATCH_EVENT","_hasInitEventFn","createEvent","initEvent","_hasPromiseRejectionEvent","_promiseCls","_allSyncSettledCreator","_promiseCreator","NODE_UNHANDLED_REJECTION","UNHANDLED_REJECTION","_currentPromiseId","_uniquePromiseId","_unhandledRejectionTimeout","dumpFnObj","_createPromise","newPromise","processor","executor","_settledValue","_thePromise","additionalArgs","_state","_hasResolved","_queue","_parentId","_handled","_unHandledRejectionHandler","_then","onResolved","onRejected","_processQueue","pop","_strState","pending","_createSettleIfFn","allowState","_notifyUnhandledRejection","process","emit","gbl","populateEvent","useNewEvent","theEvt","emitEvent","onFinally","thenFinally","catchFinally","stateFn","resultFn","handledFn","_addDebugState$1","_rejectFn","_createAllPromise","values_1","pending_1","syncItemProcessor","createAsyncPromise","callbackTimeout","timeoutItemProcessor","createNativePromise","PrmCls","createSyncPromise","createSyncAllSettledPromise","processItem","createPromise","createAllPromise","_pureAssign","func1","func2","_pureRef","_primitiveTypes","UNDEF_VALUE","NULL_VALUE","EMPTY","FUNCTION","OBJECT","PROTOTYPE","__PROTO__","UNDEFINED","CONSTRUCTOR","SYMBOL","POLYFILL_TAG","LENGTH","NAME","CALL","TO_STRING","StrCls","StrProto","MathCls","ArrCls","ArrProto","ArrSlice","safe","argArray","_createIs","_createObjIs","theName","objToString","isTypeof","isUndefined","isNullOrUndefined","isDefined","isString","isFunction","isObject","isDate","isNumber","isBoolean","isError","isPromiseLike","isNotTruthy","isTruthy","objGetOwnPropertyDescriptor","objHasOwnProperty","objHasOwn","polyObjHasOwn","objForEachKey","callbackfn","thisArg","propMap","_createProp","objDefineProp","objDefineProperties","objDefineAccessors","getProp","setProp","configurable","enumerable","objDefine","_createKeyValueMap","keyType","valueType","completeFn","writable","theMap","_assignMapValue","asString","ERROR_TYPE","dumpObj","format","propertyValueDump","throwError","throwTypeError","TypeError","_objFreeze","_doNothing","_getProto","objAssign","objKeys","objDeepFreeze","objFreeze","objSeal","objGetPrototypeOf","createEnum","createEnumKeyMap","createTypeMap","mapClass","createSimpleMap","_globalCfg","_wellKnownSymbolMap","asyncIterator","hasInstance","isConcatSpreadable","iterator","matchAll","species","toPrimitive","toStringTag","unscopables","GLOBAL_CONFIG_KEY","_getGlobalValue","globalThis","window","_getGlobalConfig","_unwrapFunction","_unwrapFunctionWithPoly","clsProto","polyFunc","clsFn","_unwrapProp","propName","mathMax","strSlice","strSubstring","strSubstr","polyStrSubstr","strLeft","_polySymbols","_wellKnownSymbolCache","_globalLazyTestHooks","UNIQUE_REGISTRY_ID","polyNewSymbol","theSymbol","polySymbolFor","registry","gblCfg","gblSym","k","_globalSymbolRegistry","newSymbol_1","regId_1","_initTestHooks","getLazy","lazyValue","lzy","createCachedValue","toJSON","_cachedGlobal","WINDOW","_getGlobalInstFn","getFn","cachedValue","getGlobal","getInst","hasDocument","getDocument","hasWindow","getWindow","hasNavigator","getNavigator","hasHistory","getHistory","_symbol","_symbolFor","_iterSymbol$1","isNode","versions","node","_initSymbol","_getSymbolKey","hasSymbol","getSymbol","getKnownSymbol","noPoly","knownName","sym","polyGetKnownSymbol","newSymbol","symbolFor","isIterator","isIterable","isStrictNullOrUndefined","iterForOf","iter","iterResult","throw","return","fnApply","arrAppend","elms","elm","arrForEach","theArray","arrIndexOf","arrMap","arrSlice","end","polyArrIncludes","searchElement","fromIndex","_isProtoArray","arrIncludes","arrReduce","objCreate","polyObjCreate","tempFunc","objSetPrototypeOf","_setName","baseClass","createCustomError","constructCb","errorBase","theBaseClass","orgName","captureFn","captureStackTrace","_createCustomError","orgProto","utcNow","polyUtcNow","_createTrimFn","exp","_fnToString","_objCtrFnString","_gblWindow","strTrim","isPlainObject","_defaultDeepCopyHandler","plainObjDeepCopyHandler","defaultDeepCopyHandlers","copyTo","_deepCopy","visitMap","userHandler","newCtx","isPlain","isPrim","isPrimitiveType","origin","copy","newKey","_copyProps","theEntry","newEntry","_getSetVisited","deepExtend","theArg","objCopyProps","_doExtend","_perf","getLength","getPerformance","perfNow","strEndsWith","polyStrEndsWith","searchString","searchValue","strIndexOf","strStartsWith","polyStrStartsWith","position","pos","REF","UNREF","HAS_REF","ENABLED","_createTimeoutWith","startTimer","overrideFn","isArr","setTimeout","clearFn","clearTimeout","timerFn","dn","refreshFn","cancelFn","theTimerHandler","timerId","_unref","_cancel","_refresh","refresh","_createTimerHandler","scheduleTimeout","scheduleTimeoutWith","createTimeout","InstantiationStatus","TelemetryUtil","applyReplacements","replacementOptions","option","lookup","replacementString","shouldUseOneDataSystemSDK","getAdditionalCommonProperties","osShim","platform","architecture","release","getInstance","_instance","BaseTelemetryReporter","telemetrySender","vscodeAPI","initializationOptions","userOptIn","errorOptIn","disposables","_onDidChangeTelemetryLevel","EventEmitter","onDidChangeTelemetryLevel","telemetryLogger","createTelemetryLogger","updateUserOptIn","onDidChangeEnableStates","isErrorsEnabled","isUsageEnabled","instantiateSender","telemetryLevel","internalSendTelemetryEvent","dangerous","sendEventData","logUsage","sendTelemetryEvent","sendRawTelemetryEvent","modifiedProperties","propertyKey","TelemetryTrustedValue","sendDangerousTelemetryEvent","internalSendTelemetryErrorEvent","logError","sendTelemetryErrorEvent","sendDangerousTelemetryErrorEvent","dispose","Promise","all","BaseTelemetrySender","clientFactory","_instantiationStatus","NOT_INSTANTIATED","_exceptionQueue","_clientFactory","_key","_telemetryClient","logEvent","INSTANTIATED","sendErrorData","errorData","errorProperties","_flushQueues","forEach","INSTANTIATING","client","catch","getBrowserRelease","navigator","userAgentData","brands","brand","TelemetryReporter","machineId","xhrOverride","appInsightsClient","basicAISDK","startsWith","authConfig","disableAjaxTracking","disableExceptionTracking","disableFetchTracking","disableCorrelationHeaders","disableCookiesUsage","autoTrackPageVisitTime","emitLineDelimitedJson","appInsightsClientFactory","appInsightsCore","oneDs","postPlugin","collectorChannelPlugin","internalTesting","workspace","getConfiguration","getAICore","completedFlush","oneDataSystemClientFactory","super","additionalCommonProperties","ral","module","exports","default","__importDefault","mod","__esModule","defineProperty","ServiceConnection","ClientConnection","ral_1","connection_1","BaseClientConnection","onmessage","handleMessage","postMessage","sharedArrayBuffer","BaseServiceConnection","__createBinding","m","k2","getOwnPropertyDescriptor","__exportStar","MessageConnection","install","messageConnection_1","BaseMessageConnection","transfer","listen","encoder","TextEncoder","decoder","TextDecoder","TestServiceConnection","script","testCase","worker","Worker","terminate","_ril","freeze","Type","Browser","encoding","timer","handle","setImmediate","setInterval","clearInterval","$testing","RIL","Cancellation","RAL","messageCancellation_1","_Uint8Result_length","_Int8Result_length","_Uint16Result_length","_Int16Result_length","_Uint32Result_length","_Int32Result_length","_Uint64Result_length","_Int64Result_length","_VariableResult_mode","__classPrivateFieldSet","receiver","has","__classPrivateFieldGet","RequestResult","RPCError","RPCErrno","VariableResult","Int64Result","Uint64Result","Int32Result","Uint32Result","Int16Result","Uint16Result","Int8Result","Uint8Result","Notification","TypedArray","TypedArrayResult","ResultType","is","Int8Array","Uint16Array","Int16Array","Int32Array","BigUint64Array","BigInt64Array","offset","candidate","NoResult","byteLength","getPadding","createResultArray","fromLength","fromByteLength","BYTES_PER_ELEMENT","WeakMap","mode","_offset","Success","TimedOut","UnknownError","LazyResultFailed","NoHandlerFound","InvalidMessageFormat","$Custom","errno","_sendRequest","textEncoder","textDecoder","readyPromise","readyCallbacks","serviceReady","arg1","arg2","arg3","params","resultType","requestData","encode","binaryData","binary","binaryDataLength","binaryOffset","resultByteLength","resultPadding","resultOffset","sharedArrayBufferLength","SharedArrayBuffer","raw","Atomics","store","wait","load","lazyResultLength","lazyResult","resultId","hasData","onRequest","_onRequest","requestHandlers","Map","requestResults","delete","requestOffset","requestLength","binaryParamsLength","binaryParamsOffset","resultKind","handlerResult","requestResult","resultBuffer","notify","signalReady","addData","$cancellationData","typedArray","retrieveCheck","_Request","_Notification","_Response","sendNotification","_sendNotification","onNotification","_onNotification","responsePromises","notificationHandlers","transferList","notification","sendResultResponse","sendErrorResponse","promise","Response","DTOs","FileSystemError","FileType","FilePermission","Stat","FileNotFound","FileExists","FileNotADirectory","FileIsADirectory","NoPermissions","Unavailable","typedResult","memory","ctime","mtime","permission","_RALType","_ral","__setModuleDefault","__importStar","ApiService","ServicePseudoTerminal","TerminalMode","vscode","sync_api_common_1","terminalRegExp","LineBuffer","cursor","clear","getLine","getCursor","isCursorAtEnd","isCursorAtBeginning","insert","char","backspace","moveCursorRelative","characters","moveCursorStartOfLine","moveCursorEndOfLine","moveCursorWordLeft","moveCursorWordRight","ServiceTerminalImpl","_onDidClose","onDidClose","_onDidWrite","onDidWrite","_onDidChangeName","onDidChangeName","_onDidCtrlC","onDidCtrlC","_onAnyKey","onAnyKey","lineBuffer","isOpen","setMode","nameBuffer","writeBuffer","close","readline","readlineCallback","write","str","handleInput","idle","previousCursor","adjustCursor","bell","handleEnter","oldCursor","newCursor","change","sequence","repeat","_name","connection","pty","inUse","handleError","asFileSystemError","m1","m2","Uri","vStat","fs","stat","permissions","readFile","writeFile","readDirectory","createDirectory","rename","activeEditor","activeTextEditor","document","workspaceFolders","folder","exitHandler","rval","getPty","code","packagePath","ResolvedProject","PackageManager","PackageType","path_1","node_maintainer_1","node_maintainer_bg_wasm_1","initSync","dataURI","byteString","atob","ab","ArrayBuffer","ia","dataURItoUint8Array","nassun","Nassun","resolveProject","root","opts","addPackages","removePackages","updateJson","maintainer","resolveMaintainer","timeEnd","packageJsonPath","packageType","Dependency","corgis","pkg","corgiMetadata","pkgJson","readJson","packageName","dependencies","devDependencies","optionalDependencies","peerDependencies","corgi","stringified","kdlPkgLock","kdlLock","npmPkgLock","npmLock","resolveManifest","trim","prefix","metaPath","restore","pruneExtraneous","extractMissing","writeLockfile","restorePackageAt","checkPath","meta","packages","projRoot","getProjectRoot","pkgPath","packageAtPath","rimraf","extractPackageTo","free","directoryExists","entryPath","contents","walkDir","subPath","isAbsolute","mkdirCache","Set","mkdirp","file","basename","reader","entries","getReader","fileCount","read","dirname","drainStream","streamToArrayBuffer","forEachPackage","fullPath","toKdl","stream","closed","cache","reduce","dir","joined","deleteFile","wasm","heap","fill","getObject","heap_next","takeObject","ret","dropObject","cachedTextDecoder","ignoreBOM","fatal","cachedUint8Memory0","getUint8Memory0","getStringFromWasm0","ptr","subarray","addHeapObject","WASM_VECTOR_LEN","cachedTextEncoder","encodeString","encodeInto","view","buf","written","passStringToWasm0","malloc","realloc","mem","isLikeNone","x","cachedInt32Memory0","getInt32Memory0","cachedFloat64Memory0","cachedBigInt64Memory0","debugString","val","debug","builtInMatches","_","makeMutClosure","arg0","dtor","real","__wbindgen_export_2","original","__wbg_adapter_50","__wbindgen_export_3","__wbg_adapter_53","__wbindgen_export_4","resolveSpec","spec","ptr0","__wbindgen_export_0","__wbindgen_export_1","len0","manifest","packument","corgiPackument","tarball","__wbindgen_export_6","IntoUnderlyingByteSource","__wrap","__destroy_into_raw","__wbg_intounderlyingbytesource_free","intounderlyingbytesource_type","autoAllocateChunkSize","intounderlyingbytesource_autoAllocateChunkSize","controller","intounderlyingbytesource_start","pull","intounderlyingbytesource_pull","intounderlyingbytesource_cancel","IntoUnderlyingSink","__wbg_intounderlyingsink_free","chunk","intounderlyingsink_write","intounderlyingsink_close","abort","intounderlyingsink_abort","IntoUnderlyingSource","__wbg_intounderlyingsource_free","intounderlyingsource_pull","intounderlyingsource_cancel","__wbg_nassun_free","retptr","__wbindgen_add_to_stack_pointer","nassun_new","r0","r1","nassun_resolve","nassun_packument","nassun_metadata","nassun_corgiPackument","nassun_corgiMetadata","nassun_tarball","nassun_entries","NodeMaintainer","__wbg_nodemaintainer_free","nodemaintainer_resolveSpec","nodemaintainer_resolveManifest","nodemaintainer_toKdl","r2","r3","__wbindgen_export_5","nodemaintainer_packageAtPath","Package","nodemaintainer_forEachPackage","NodeMaintainerOptions","__wbg_nodemaintaineroptions_free","__wbg_package_free","package_from","package_name","package_resolved","package_corgiPackument","package_corgiMetadata","package_packument","package_metadata","package_tarball","package_entries","PipeOptions","__wbg_pipeoptions_free","preventClose","pipeoptions_preventClose","preventCancel","pipeoptions_preventCancel","preventAbort","pipeoptions_preventAbort","signal","pipeoptions_signal","QueuingStrategy","__wbg_queuingstrategy_free","highWaterMark","queuingstrategy_highWaterMark","ReadableStreamGetReaderOptions","__wbg_readablestreamgetreaderoptions_free","readablestreamgetreaderoptions_mode","getImports","imports","wbg","__wbindgen_object_drop_ref","__wbindgen_string_new","__wbindgen_string_get","__wbg_nodemaintainer_new","__wbindgen_is_bigint","__wbindgen_bigint_from_u64","BigInt","asUintN","__wbindgen_jsval_eq","__wbindgen_is_object","__wbindgen_is_undefined","__wbindgen_in","__wbindgen_cb_drop","__wbindgen_error_new","__wbindgen_number_new","__wbindgen_is_string","__wbg_package_new","__wbindgen_object_clone_ref","__wbg_new_abda76e883ba8a5f","__wbg_stack_658279fe44541cf6","__wbg_error_f851667af71bcfc6","__wbindgen_bigint_from_i64","__wbindgen_jsval_loose_eq","__wbindgen_boolean_get","__wbindgen_number_get","Float64Array","__wbg_String_91fba7ded13ba54c","__wbg_getwithrefkey_15c62c2b8546208d","__wbg_set_20cbc34131e76824","__wbg_fetch_cf75ae0b20981e3e","__wbg_newwithsource_d169ed5262a23b74","ReadableStream","__wbg_newwithbytesource_33937abb6afe07ad","__wbg_getReader_2dcca5fb18e09eed","__wbg_close_a41954830b65c455","__wbg_enqueue_3a8a8e67e44d2567","enqueue","__wbg_byobRequest_a3c74c3694777d1b","byobRequest","__wbg_close_045ed342139beb7d","__wbg_view_d1a31268af734e5d","__wbg_respond_f4778bef04e912a6","respond","__wbg_buffer_610b70c8fd30da2d","__wbg_byteOffset_ede786cfcf88d3dd","byteOffset","__wbg_byteLength_1fef7842ca4200fa","__wbg_cancel_ec971cf80c0cb93c","__wbg_releaseLock_63a4cb6bda4eb742","releaseLock","__wbg_read_2ca7e46df6e5a6f6","__wbg_done_a0a250be29d69e10","__wbg_value_b71fc239df8382f0","__wbg_bytesliteral_efe7d360639bf32b","__wbg_newwithstrandinit_c45f0dc6da26fd03","__wbg_signal_686bf5a4acff74a1","__wbg_new_a16bcd3b8d000a4f","AbortController","__wbg_abort_5f06bf3b2954cf33","__wbg_fetch_661ffba2a4f2519c","__wbg_instanceof_Response_fb3a4df648c1859b","__wbg_url_8ec2534cdfacb103","__wbg_status_d483a4ac847f380a","__wbg_headers_6093927dc359903e","__wbg_body_aeb10a3b63770556","__wbg_text_f61464d781b099f0","__wbg_new_f1c3a9c2533a55b8","__wbg_append_1be1d651f9ecf2eb","arg4","__wbg_get_27fe3dac1c4d0224","__wbg_length_e498fbc24f9c1d4f","__wbg_new_b525de17f44a8943","__wbindgen_is_function","__wbg_newnoargs_2b8b6bd7753c76ba","__wbg_new_f841cc6f2098f4b5","__wbg_next_b7d530c04fd8b217","__wbg_next_88560ec06a094dea","__wbg_done_1ebec03bbd919843","__wbg_value_6ac8da5cc5b3efda","__wbg_iterator_55f114446221aa5a","Symbol","__wbg_get_baf4855f9a986186","Reflect","__wbg_call_95d1ea488d03e4e8","__wbg_new_f9876326328f45ed","__wbg_self_e7c1f827057f6584","__wbg_window_a09ec664e14b1b81","__wbg_globalThis_87cbb8506fecf3a9","__wbg_global_c85a9259e621f3db","global","__wbg_set_17224bc548dd1d7b","__wbg_isArray_39d28997bf6b96b4","__wbg_instanceof_ArrayBuffer_a69f02ee4c4f5065","__wbg_new_15d3966e9981a196","__wbg_call_9495de66fdbe016b","__wbg_call_96878afb7a8201ca","__wbg_set_388c4c6422704173","__wbg_isSafeInteger_8c4789029e885159","Number","isSafeInteger","__wbg_entries_4e1315b774245952","__wbg_instanceof_Promise_4333c4e5587e8936","__wbg_new_9d3a9ce4282a18a8","state0","__wbindgen_export_7","__wbg_adapter_224","__wbg_resolve_fd40f858d9db1a04","__wbg_catch_44bf25c15946bac0","__wbg_then_ec5db6d509eb475f","__wbg_then_f753623316e2873a","__wbg_buffer_cf65c07de34b9a08","__wbg_newwithbyteoffsetandlength_9fb2f11355ecadf5","__wbg_new_537b7341ce90bb31","__wbg_set_17499e8aa4003ebd","__wbg_length_27a2afe8ab42b09f","__wbg_instanceof_Uint8Array_01cebe79ca606cca","__wbg_has_3feea89d34bd7ad5","__wbg_set_6aa458a4ebdb65cb","__wbg_stringify_029a979dfb73aa17","__wbindgen_bigint_get_as_i64","__wbindgen_debug_string","__wbindgen_throw","__wbindgen_rethrow","__wbindgen_memory","__wbindgen_closure_wrapper2178","__wbindgen_closure_wrapper2759","finalizeInit","instance","__wbindgen_wasm_module","WebAssembly","Module","Instance","URL","instantiateStreaming","warn","bytes","arrayBuffer","instantiate","createScanner","ignoreTrivia","tokenOffset","lineStartOffset","tokenLineStartOffset","prevTokenLineStartOffset","scanError","scanHexDigits","exact","digits","ch","scanNext","isWhiteSpace","fromCharCode","isLineBreak","ch3","scanString","safeLength","commentClosed","isDigit","scanNumber","isUnknownContentCharacter","setPosition","newPosition","getPosition","scan","getToken","getTokenValue","getTokenOffset","getTokenLength","getTokenStartLine","getTokenStartCharacter","getTokenError","CharacterCodes","ParseOptions","documentText","range","initialIndentLevel","formatText","formatTextStart","rangeStart","rangeEnd","isEOL","endOffset","nChars","tabSize","computeIndentLevel","eol","getEOL","indentValue","numberLineBreaks","indentLevel","insertSpaces","scanner","hasError","newLinesAndIndent","keepLines","editOperations","addEdit","startOffset","firstToken","firstTokenStart","firstTokenEnd","secondToken","replaceContent","needsLineBreak","insertFinalNewline","parseTree","DEFAULT","currentParent","parent","ensurePropertyComplete","onValue","valueNode","visit","onObjectBegin","onObjectProperty","onObjectEnd","onArrayBegin","onArrayEnd","onLiteralValue","getNodeType","onSeparator","sep","colonOffset","onError","findNodeAtLocation","segment","found","propertyNode","visitor","_scanner","_jsonPath","toNoArgVisit","visitFunction","toNoArgVisitWithPath","toOneArgVisit","toOneArgVisitWithPath","onComment","disallowComments","allowTrailingComma","skipUntilAfter","skipUntil","parseString","isValue","allowEmptyContent","parseValue","isFirstElement","needsComma","parseArray","parseObject","tokenValue","parseLiteral","withFormatting","edit","formattingOptions","newText","applyEdit","begin","edits","ScanError","SyntaxKind","segments","earlyReturnException","previousNode","previousNodeInst","isAtPropertyKey","setPreviousNode","last","pattern","currentProperty","previousParents","array","findNodeAtOffset","includeRightBound","contains","getNodePath","getNodeValue","replaceCh","ParseErrorCode","printParseErrorCode","modify","originalPath","lastSegment","existing","propertyIndex","removeBegin","removeEnd","previous","newProperty","getInsertionIndex","insertIndex","removalIndex","toRemove","isArrayInsertion","toModify","applyEdits","sortedEdits","diff","lastModifiedOffset","Yallist","MAX","LENGTH_CALCULATOR","ALLOW_STALE","MAX_AGE","DISPOSE","NO_DISPOSE_ON_SET","LRU_LIST","CACHE","UPDATE_AGE_ON_GET","naiveLength","doUse","hit","isStale","unshiftNode","maxAge","walker","tail","prev","removeNode","Entry","forEachStep","thisp","Infinity","lc","stale","noDisposeOnSet","updateAgeOnGet","mL","allowStale","mA","lengthCalculator","lC","itemCount","rforEach","head","toArray","dump","dumpLru","unshift","peek","expiresAt","prune","ANY","Comparator","comp","parseOptions","loose","semver","operator","r","re","COMPARATORLOOSE","COMPARATOR","SemVer","er","cmp","intersects","Range","includePrerelease","includes","safeRe","parseRange","first","isNullSet","isAny","comps","memoKey","FLAG_INCLUDE_PRERELEASE","FLAG_LOOSE","cached","hr","HYPHENRANGELOOSE","HYPHENRANGE","hyphenReplace","COMPARATORTRIM","comparatorTrimReplace","rangeList","TILDETRIM","tildeTrimReplace","CARETTRIM","caretTrimReplace","parseComparator","replaceGTE0","rangeMap","comparators","some","thisComparators","isSatisfiable","rangeComparators","every","thisComparator","rangeComparator","testSet","remainingComparators","testComparator","otherComparator","replaceCarets","replaceTildes","replaceXRanges","replaceStars","isX","replaceTilde","TILDELOOSE","TILDE","M","pr","replaceCaret","CARETLOOSE","CARET","z","replaceXRange","XRANGELOOSE","XRANGE","gtlt","xM","xm","xp","anyX","STAR","GTE0PRE","GTE0","incPr","$0","fM","fm","fp","fpr","tM","tm","tp","tpr","tb","prerelease","allowed","major","minor","patch","MAX_LENGTH","MAX_SAFE_INTEGER","compareIdentifiers","LOOSE","FULL","build","compare","other","compareMain","comparePre","compareBuild","inc","identifierBase","base","eq","neq","gt","gte","lt","lte","op","rtl","COERCERTL","lastIndex","COERCE","versionA","versionB","version1","version2","v1","v2","comparison","v1Higher","highVersion","lowVersion","highHasPre","throwErrors","parsed","list","internalRe","constants","identifiers","clean","rcompare","compareLoose","rsort","coerce","satisfies","toComparators","maxSatisfying","minSatisfying","minVersion","validRange","outside","gtr","ltr","simplifyRange","subset","tokens","SEMVER_SPEC_VERSION","RELEASE_TYPES","rcompareIdentifiers","MAX_SAFE_COMPONENT_LENGTH","NODE_DEBUG","numeric","anum","bnum","looseOption","emptyOpts","R","createToken","isGlobal","NUMERICIDENTIFIER","NUMERICIDENTIFIERLOOSE","NONNUMERICIDENTIFIER","PRERELEASEIDENTIFIER","PRERELEASEIDENTIFIERLOOSE","BUILDIDENTIFIER","MAINVERSION","PRERELEASE","BUILD","FULLPLAIN","MAINVERSIONLOOSE","PRERELEASELOOSE","LOOSEPLAIN","XRANGEIDENTIFIER","XRANGEIDENTIFIERLOOSE","GTLT","XRANGEPLAIN","XRANGEPLAINLOOSE","LONETILDE","LONECARET","maxSV","rangeObj","minSV","minver","setMin","comparator","compver","hilo","gtfn","ltefn","ltfn","ecomp","high","low","ranges","simplified","minimumVersionWithPreRelease","minimumVersion","simpleSubset","sub","dom","eqSet","gtltComp","higher","lower","hasDomLT","hasDomGT","higherGT","lowerLT","needDomLTPre","needDomGTPre","sawNonNull","OUTER","simpleSub","simpleDom","isSub","LIB","cwd","normalize","relative","u","_makeLong","extname","delimiter","win32","posix","URI","Utils","P","setPrototypeOf","scheme","authority","query","fragment","isUri","fsPath","with","A","y","O","revive","_formatted","external","_fsPath","_sep","$mid","substr","C","U","I","joinPath","resolvePath","inserted","Node","pushNode","forEachReverse","getReverse","mapReverse","initial","acc","reduceReverse","toArrayReverse","sliceReverse","deleteCount","nodes","assertPath","normalizeStringPosix","allowAboveRoot","lastSegmentLength","lastSlash","dots","lastSlashIndex","resolvedPath","resolvedAbsolute","trailingSeparator","fromStart","fromEnd","fromLen","toStart","toLen","lastCommonSep","fromCode","out","hasRoot","matchedSlash","extIdx","firstNonSlashEnd","startDot","startPart","preDotState","pathObject","_format","onCompletionAccepted","pluginManager","getAPI","ApiV0","_pluginManager","configurePlugin","pluginId","configuration","setConfiguration","commands","registration","register","command","refCount","registerCommand","execute","Disposable","activeJsTsEditorTracker","lazyClientHost","editor","activeJsTsEditor","openProjectConfigForFile","serviceClient","commandManager","ReloadTypeScriptProjectsCommand","ReloadJavaScriptProjectsCommand","SelectTypeScriptVersionCommand","OpenTsServerLogCommand","RestartTsServerCommand","TypeScriptGoToProjectConfigCommand","JavaScriptGoToProjectConfigCommand","ConfigurePluginCommand","LearnMoreAboutRefactoringsCommand","TSServerRequestCommand","OpenJsDocLinkCommand","docUrl","isTypeScriptDocument","openExternal","character","Position","executeCommand","selection","openTsServerLogFile","reloadProjects","restartTsServer","showVersionPicker","isCancellationRequested","onCancellationRequested","nulToken","requestArgs","newArgs","toOpenTsFilePath","BrowserServiceConfigurationProvider","BaseServiceConfigurationProvider","readGlobalTsdk","_configuration","readLocalTsdk","readLocalNodePath","readGlobalNodePath","objects","equals","TsServerLogLevel","fromString","Terse","Off","ImplicitProjectConfiguration","readTarget","readModule","checkJs","readCheckJs","experimentalDecorators","readExperimentalDecorators","strictNullChecks","readImplicitStrictNullChecks","strictFunctionTypes","readImplicitStrictFunctionTypes","isEqualTo","vscodeWatcherName","loadFromWorkspace","locale","readLocale","globalTsdk","localTsdk","npmLocation","readNpmLocation","tsServerLogLevel","readTsServerLogLevel","tsServerPluginPaths","readTsServerPluginPaths","implicitProjectConfiguration","disableAutomaticTypeAcquisition","readDisableAutomaticTypeAcquisition","useSyntaxServer","readUseSyntaxServer","webProjectWideIntellisenseEnabled","readWebProjectWideIntellisenseEnable","webProjectWideIntellisenseSuppressSemanticErrors","readWebProjectWideIntellisenseSuppressSemanticErrors","webTypeAcquisitionEnabled","readWebTypeAcquisition","enableDiagnosticsTelemetry","readEnableDiagnosticsTelemetry","enableProjectDiagnostics","readEnableProjectDiagnostics","maxTsServerMemory","readMaxTsServerMemory","enablePromptUseWorkspaceTsdk","readEnablePromptUseWorkspaceTsdk","useVsCodeWatcher","readUseVsCodeWatcher","watchOptions","readWatchOptions","includePackageJsonAutoImports","readIncludePackageJsonAutoImports","enableTsServerTracing","readEnableTsServerTracing","localNodePath","globalNodePath","workspaceSymbolsExcludeLibrarySymbols","readWorkspaceSymbolsExcludeLibrarySymbols","enableRegionDiagnostics","readEnableRegionDiagnostics","setting","deprecatedValue","watcherExcludes","experimentalConfig","inspect","globalValue","workspaceValue","workspaceFolderValue","memoryInMB","alwaysSupportedSchemes","untitled","walkThroughSnippet","vscodeNotebookCell","chatCodeBlock","isWeb","schemes","normalizedUriScheme","git","github","azurerepos","vsls","officeScript","disabledSchemes","resource","allDiagnosticLanguages","standardLanguageDescriptions","diagnosticOwner","diagnosticSource","diagnosticLanguage","languageIds","typescript","typescriptreact","configFilePattern","standardFileExtensions","javascript","javascriptreact","languages","jsxTags","jsTsLanguageModes","link","Schemes","mailto","notebookCell","reporter","_sharedProperties","_reporter","setSharedProperty","postEvent","propsObject","fromEntries","postEventObj","PluginManager","subscriptions","CommandManager","ActiveJsTsEditorTracker","versionProvider","StaticVersionProvider","TypeScriptVersion","extensionUri","API","fromSimpleString","experimentTelemetryReporter","packageInfo","getPackageInfo","aiKey","vscTelemetryReporter","ExperimentationTelemetryReporter","Logger","createLazyClientHost","logDirectoryProvider","noopLogDirectoryProvider","cancellerFactory","noopRequestCancellerFactory","processFactory","WorkerServerProcessFactory","serviceConfigurationProvider","registerBaseCommands","lazilyActivateClient","isWebAndHasSharedArrayBuffers","workspaceUri","info","loader","RemoteWorkspaceContentsPreloader","triggerPreload","startPreloadWorkspaceContentsIfNeeded","registerAtaSupport","getExtensionApi","_version","globalVersion","localVersion","localVersions","updateConfiguration","defaultVersion","bundledVersion","fsWatcher","_register","createFileSystemWatcher","RelativePattern","onDidChange","_preload","doPreload","remoteHubApi","getApi","loadWorkspaceContents","supportsReadableByteStreams","conditionalRegistration","requireGlobalConfiguration","registerFileSystemProvider","MemFs","isCaseSensitive","isReadonly","AutoInstallerFs","TEXT_DECODER","TEXT_ENCODER","_projectCache","_emitter","onDidChangeFile","memfs","packageManager","_exclude","_include","_depth","_writeByteOrderMark","overwrite","Directory","_encoding","watch","mapped","MappedUri","ensurePackageContents","_uri","_content","_options","_oldUri","_newUri","incomingUri","existingInstall","installing","proj","getInstallOpts","originalUri","vsfs","flatPath","FsDirectoryEntry","watchers","getEntry","FsFileEntry","getParent","dirContents","FileChangeType","Changed","Created","Deleted","component","sy","watcher","File","selector","requireMinVersion","TypeScriptCallHierarchySupport","requireSomeCapability","ClientCapability","Semantic","registerCallHierarchyProvider","semantic","prepareCallHierarchy","filepath","typeConverters","toFileLocationRequestArgs","fromProtocolCallHierarchyItem","provideCallHierarchyIncomingCalls","toTsFilePath","selectionRange","fromProtocolCallHierarchyIncomingCall","provideCallHierarchyOutgoingCalls","fromProtocolCallHierarchyOutgoingCall","useFileName","PConst","Kind","selectionSpan","isSourceFileItem","asRelativePath","containerName","CallHierarchyItem","SymbolKind","fromProtocolScriptElementKind","fromTextSpan","span","kindModifiers","parseKindModifier","KindModifiers","deprecated","SymbolTag","Deprecated","CallHierarchyIncomingCall","fromSpans","CallHierarchyOutgoingCall","v380","nameSpan","spans","getText","escapeRegExp","prefixLength","offsetAt","positionAt","ReferencesCodeLens","CodeLens","TypeScriptBaseCodeLensProvider","cachedResponse","changeEmitter","onDidChangeCodeLenses","provideCodeLenses","referenceableSpans","childItems","walkNavTree","extractSymbol","child","cancelledCommand","title","errorCommand","l10n","language","registerCodeLensProvider","TypeScriptImplementationsCodeLensProvider","_cachedResponse","onDidChangeConfiguration","affectsConfiguration","resolveCodeLens","codeLens","lowPriority","executionTarget","ExecutionTarget","cancelOnResourceChange","locations","Location","toResource","fromLocation","getCommand","getTitle","interface","getSymbolRange","class","memberVariable","memberGetAccessor","memberSetAccessor","TypeScriptReferencesCodeLensProvider","refs","isDefinition","getCodeLensLabel","enum","function","const","let","variable","constructorImplementation","isEqual","typingsStatus","fileConfigurationManager","telemetryReporter","EnhancedSyntax","registerCompletionItemProvider","syntax","TypeScriptCompletionItemProvider","triggerCharacters","MyCompletionItem","CompletionItem","tsEntry","completionContext","defaultCommitCharacters","label","insertText","convertKind","hasAction","apiVersion","v490","sortText","qualifierCandidate","sourceDisplay","isSnippet","Previewer","asPlainTextWithLinks","labelDetails","preselect","isRecommended","useCodeSnippet","completeFunctionCalls","CompletionItemKind","Method","getRangeFromReplacementSpan","commitCharacters","getCommitCharacters","SnippetString","filterText","getFilterText","isMemberCompletion","dotAccessorContext","textLabel","replacementRange","wordRange","inserting","replacing","union","optional","CompletionItemTag","color","Color","extModifier","fileExtensionKindModifiers","endsWith","getScriptKindDetails","resolveRange","resolveCompletionItem","_resolvedPromise","requestToken","CancellationTokenSource","entryNames","interruptGetErr","newItemDetails","getDetails","documentation","getDocumentation","codeAction","getCodeActions","CompletionAcceptedCommand","ID","additionalTextEdits","isValidFunctionCompletionContext","snippet","parameterCount","snippetForFunctionCall","displayParts","codeActions","baseUri","MarkdownString","appendDocumentationAsMarkdown","lineAt","hasRemainingCommandsOrEdits","tsAction","changes","textChanges","TextEdit","fromCodeEdit","ApplyCompletionCodeActionCommand","replacementSpan","optionalReplacementRange","replaceRange","isSingleLine","wordStart","primitiveType","keyword","Keyword","localVariable","alias","parameter","Variable","Field","localFunction","constructSignature","callSignature","indexSignature","Enum","enumMember","EnumMember","externalModuleName","Class","Interface","warning","Text","directory","Folder","string","Constant","Property","enableCallCompletions","isNewIdentifierLocation","logTelemetry","isPackageJsonImport","isImportStatementCompletion","ApplyCompletionCommand","workspaceEdit","WorkspaceEdit","_file","applyCodeAction","showQuickPick","placeHolder","CompletionConfiguration","nameSuggestions","pathSuggestions","autoImportSuggestions","importStatementSuggestions","getConfigurationForResource","modeId","provideCompletionItems","isAcquiringTypings","comment","completionConfiguration","shouldTrigger","getWordRangeAtPosition","secondCharPosition","translate","ensureConfigurationForDocument","includeExternalModuleExports","includeInsertTextCompletions","triggerCharacter","getTsTriggerCharacter","triggerKind","CompletionTriggerKind","toProtocolCompletionTriggerKind","logCompletionsTelemetry","dotMatch","characterDelta","isIncomplete","optionalReplacementSpan","includesPackageJsonImport","includesImportStatementCompletion","shouldExcludeCompletionEntry","CompletionList","updateGraphDurationMs","performanceData","createAutoImportProviderProgramDurationMs","v430","element","v570","enabledSettingId","registerDocumentPasteEditProvider","DocumentPasteProvider","providedPasteEditKinds","copyMimeTypes","metadataMimeType","pasteMimeTypes","CopyMetadata","parsedData","copyOperation","TsPasteEdit","DocumentPasteEdit","tryCreateFromResponse","pasteEdit","additionalEdit","yieldTo","DocumentDropOrPasteEditKind","TsPendingPasteEdit","operation","_modeId","_client","prepareDocumentPaste","dataTransfer","copyRequest","copiedTextSpan","toTextSpan","raceTimeout","DataTransferItem","provideDocumentPasteEdits","_context","extractMetadata","copiedFrom","copyFile","pasteCts","copyResponse","_err","pasteOperation","pastedText","pasteLocations","pasteTimeout","resolveDocumentPasteEdit","inEdit","_token","TextUpdateImports","getSymbolLocations","definitionType","registerDefinitionProvider","TypeScriptDefinitionProvider","provideDefinition","textSpan","definitions","languageId","v470","sourceDefinitionsResponse","contextStart","contextEnd","originSelectionRange","targetRange","fromLocations","targetUri","targetSelectionRange","FileDiagnostics","_diagnostics","updateDiagnostics","diagnostics","updateRegionDiagnostics","getAllDiagnostics","settings","getValidate","getSuggestionDiagnostics","toDelete","diags","diag","arrays","relatedInformation","empty","newDiagnostics","intersection","enableSuggestions","getEnableSuggestions","DiagnosticTag","Unnecessary","DiagnosticSettings","_languageSettings","validate","setValidate","setEnableSuggestions","defaultSettings","currentSettings","newSettings","areLanguageDiagnosticSettingsEqual","DiagnosticsTelemetryManager","_telemetryReporter","_diagnosticsCollection","_diagnosticCodesMap","_diagnosticSnapshotsMap","ResourceMap","onCaseInsensitiveFileSystem","onDidChangeTextDocument","_updateAllDiagnosticCodesAfterTimeout","_registerTelemetryEventEmitter","logDiagnosticsPerformanceTelemetry","syntaxDiagDuration","syntaxDiag","semanticDiagDuration","semanticDiag","suggestionDiagDuration","suggestionDiag","regionSemanticDiagDuration","regionSemanticDiag","fileLineCount","_timeout","_updateDiagnosticCodes","_increaseDiagnosticCodeCount","previousDiagnostics","diagnostic","previousDiagnostic","_telemetryEmitter","diagnosticCodes","DiagnosticsManager","owner","_settings","_updateDelay","_pendingUpdates","_currentDiagnostics","createDiagnosticCollection","_diagnosticsTelemetryManager","reInitialize","rebuildAll","didUpdate","fileDiagnostics","scheduleDiagnosticsUpdate","configFileDiagnosticsReceived","deleteAllDiagnosticsInFile","deleteDiagnostic","rebuildFile","getDiagnostics","updateCurrentDiagnostics","fileDiagnostic","DirectiveCommentCompletionProvider","tsDirectives","tsDirectives390","v390","directive","Snippet","provider","TypeScriptDocumentHighlightProvider","registerDocumentHighlightProvider","registerMultiDocumentHighlightProvider","provideMultiDocumentHighlights","otherDocuments","allFiles","filesToSearch","highlightItem","MultiDocumentHighlight","convertDocumentHighlight","provideDocumentHighlights","flatMap","highlight","highlightSpans","DocumentHighlight","DocumentHighlightKind","Write","Read","registerDocumentSymbolProvider","TypeScriptDocumentSymbolProvider","provideDocumentSymbols","convertNavTree","shouldInclude","shouldInclueEntry","symbolInfo","convertSymbol","includedChild","DocumentSymbol","getSymbolKind","FileConfigurationManager","formatOptions","onDidCloseTextDocument","textDocument","_disposables","getFormattingOptions","ensureConfigurationOptions","visibleTextEditors","find","currentOptions","getFileOptions","cachedOptions","cachedOptionsValue","task","setGlobalConfigurationFromDocument","getFormatOptions","preferences","getPreferences","indentSize","convertTabsToSpaces","newLineCharacter","insertSpaceAfterCommaDelimiter","insertSpaceAfterConstructor","insertSpaceAfterSemicolonInForStatements","insertSpaceBeforeAndAfterBinaryOperators","insertSpaceAfterKeywordsInControlFlowStatements","insertSpaceAfterFunctionKeywordForAnonymousFunctions","insertSpaceBeforeFunctionParenthesis","insertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis","insertSpaceAfterOpeningAndBeforeClosingNonemptyBrackets","insertSpaceAfterOpeningAndBeforeClosingNonemptyBraces","insertSpaceAfterOpeningAndBeforeClosingEmptyBraces","insertSpaceAfterOpeningAndBeforeClosingTemplateStringBraces","insertSpaceAfterOpeningAndBeforeClosingJsxExpressionBraces","insertSpaceAfterTypeAssertion","placeOpenBraceOnNewLineForFunctions","placeOpenBraceOnNewLineForControlBlocks","semicolons","indentSwitchCase","preferencesConfig","quotePreference","getQuoteStylePreference","importModuleSpecifierPreference","getImportModuleSpecifierPreference","importModuleSpecifierEnding","getImportModuleSpecifierEndingPreference","jsxAttributeCompletionStyle","getJsxAttributeCompletionStyle","allowTextChangesInNewFiles","fileSchemes","providePrefixAndSuffixTextForRename","allowRenameOfImportPath","includeAutomaticOptionalChainCompletions","provideRefactorNotApplicableReason","generateReturnInDocTemplate","includeCompletionsForImportStatements","includeCompletionsWithSnippetText","includeCompletionsWithClassMemberSnippets","includeCompletionsWithObjectLiteralMethodSnippets","autoImportFileExcludePatterns","getAutoImportFileExcludePatternsPreference","getWorkspaceFolder","autoImportSpecifierExcludeRegexes","preferTypeOnlyAutoImports","useLabelDetailsInCompletionEntries","allowIncompleteCompletions","displayPartsForJSDoc","disableLineTextInReferences","interactiveInlayHints","includeCompletionsForModuleExports","getInlayHintsPreferences","getOrganizeImportsPreferences","workspaceFolder","isRelative","wildcardPrefix","v540","organizeImportsCollation","organizeImportsCaseSensitivity","organizeImportsTypeOrder","withDefaultAsUndefined","organizeImportsIgnoreCase","organizeImportsCaseFirst","organizeImportsAccentCollation","organizeImportsLocale","organizeImportsNumericCollation","def","InlayHintSettingNames","includeInlayParameterNameHints","getInlayParameterNameHintsPreference","includeInlayParameterNameHintsWhenArgumentMatchesName","parameterNamesSuppressWhenArgumentMatchesName","includeInlayFunctionParameterTypeHints","parameterNamesEnabled","includeInlayVariableTypeHints","variableTypesEnabled","includeInlayVariableTypeHintsWhenTypeMatchesName","variableTypesSuppressWhenTypeMatchesName","includeInlayPropertyDeclarationTypeHints","propertyDeclarationTypesEnabled","includeInlayFunctionLikeReturnTypeHints","functionLikeReturnTypesEnabled","includeInlayEnumMemberValueHints","enumMemberValuesEnabled","updateContext","FileReferencesCommand","onTsServerStarted","showErrorMessage","openTextDocument","isSupportedLanguageMode","openedFiledPath","withProgress","ProgressLocation","Window","_progress","existingSetting","v420","diagnosticsManager","TypeScriptAutoFixProvider","registerCodeActionsProvider","buildCombinedFix","fixes","codes","fixName","toFileRangeRequestArgs","errorCodes","fix","fixId","withFileCodeEdits","combinedArgs","scope","combinedResponse","SourceAction","CodeAction","SourceFixAll","buildIndividualFixes","incorrectlyImplementsInterface","fixNames","classIncorrectlyImplementsInterface","asyncOnlyAllowedInAsyncFunctions","awaitInSyncFunction","unreachableCode","CodeActionKind","SourceRemoveUnused","variableDeclaredButNeverUsed","unusedIdentifier","Source","SourceAddMissingImports","cannotFindName","fixImport","providedCodeActionKinds","kindProviders","provideCodeActions","_range","only","getFixAllActions","registerFoldingRangeProvider","TypeScriptFoldingProvider","provideFoldingRanges","coalesce","convertOutliningSpan","getFoldingRangeKind","adjustFoldingEnd","FoldingRange","foldEndCharacter","foldEndPairCharacters","FoldingRangeKind","Comment","Region","Imports","formattingProvider","TypeScriptFormattingProvider","registerOnTypeFormattingEditProvider","registerDocumentRangeFormattingEditProvider","provideDocumentRangeFormattingEdits","toFormattingRequestArgs","provideOnTypeFormattingEdits","textEdit","lText","registerHoverProvider","TypeScriptHoverProvider","provideHover","Hover","getContents","_serverType","displayString","ServerType","Syntax","hasCapabilityForResource","appendCodeblock","md","documentationToMarkdown","registerImplementationProvider","TypeScriptImplementationProvider","provideImplementation","TypeScriptInlayHintsProvider","registerInlayHintsProvider","inlayHintSettingNames","_onDidChangeInlayHints","onDidChangeInlayHints","hasReportedTelemetry","settingName","provideInlayHints","areInlayHintsEnabledForFile","hint","InlayHint","convertInlayHintText","InlayHintKind","Parameter","fromProtocolInlayHintKind","paddingLeft","whitespaceBefore","paddingRight","whitespaceAfter","tsHint","part","InlayHintLabelPart","v440","JsDocCompletionProvider","defaultJsDoc","JsDocCompletionItem","suffix","isPotentiallyValidDocCompletionPosition","templateToSnippet","template","snippetIndex","_param","post","LinkedEditingSupport","registerLinkedEditingRangeProvider","provideLinkedEditingRanges","wordPattern","LinkedEditingRanges","v510","organizeImportsCommand","sortImportsCommand","removeUnusedImportsCommand","ImportsCodeActionProvider","commandIds","SourceOrganizeImports","OrganizeImportsMode","All","SortAndCombine","RemoveUnused","DidOrganizeImportsCommand","ImportCodeAction","commandMetadata","fileConfigManager","resolveCodeAction","skipDestructiveCodeActions","toProtocolOrganizeImportsMode","fromFileCodeEdits","TypeScriptQuickFixProvider","ApplyCodeActionCommand","diagnosticManager","followupAction","codeActionResult","applyCodeActionCommands","ApplyFixAllCodeAction","DiagnosticsSet","_values","VsCodeCodeAction","VsCodeFixAllCodeAction","CodeActionSet","_actions","_fixAllActions","_aiActions","addAction","isAI","existingFixAll","addFixAllAction","hasFixAllAction","SupportedCodeActionProvider","getFixableDiagnosticsForContext","fixableCodes","fixableDiagnosticCodes","memoize","formattingConfigurationManager","CompositeCommand","EditorChatFollowUp","supportedCodeActionProvider","bufferSyncSupport","hasPendingDiagnostics","allDiagnostics","_maxCodeActionsPerFile","fixableDiagnostics","getFixesForDiagnostic","allActions","isPreferred","isPreferredFix","tsCodeFix","getFixesForTsCodeAction","addFixAllForTsCodeAction","QuickFix","getEditForCodeAction","copilot","getExtension","isActive","expand","fixClassDoesntImplementInheritedAbstractMember","fixMissingFunctionDeclaration","inferFromUsage","inferFromBody","quickfix","addNameToNamelessParameter","textChange","aiCodeAction","fixAllErrorCodes","fixAllDescription","preferredFixes","annotateWithTypeFromJSDoc","constructorForDerivedNeedSuperCall","extendsInterfaceBecomesImplements","removeUnnecessaryAwait","classDoesntImplementInheritedAbstractMember","forgottenThisPropertyAccess","spelling","addMissingAwait","addMissingOverride","addMissingNewOperator","thereCanOnlyBeOne","fixPriority","otherAction","otherFixPriority","cachedNavTree","formattingOptionsManager","TypeScriptRefactorProvider","toWorkspaceEdit","createFile","ignoreIfExists","DidApplyRefactoringCommand","trigger","SelectRefactorCommand","selected","refactor","InlinedCodeAction","rangeOrSelection","isRefactoring","MoveToFileRefactorCommand","didApplyCommand","targetFile","getTargetFile","fileSuggestionArgs","interactiveRefactorArguments","selectExistingFileItem","selectNewFileItem","quickPick","createQuickPick","ignoreFocusOut","quickPickInRelativeMode","updateItems","relativeQuery","destinationItems","files","parentDir","filename","relativePath","QuickPickItemKind","Separator","placeholder","matchOnDescription","onDidChangeValue","picked","onDidAccept","selectedItems","onDidHide","show","showOpenDialog","openLabel","defaultUri","showSaveDialog","saveLabel","newFileName","Extract_Function","RefactorExtract","Extract_Constant","Extract_Type","Extract_Interface","Move_File","RefactorMove","Move_NewFile","Rewrite_Import","RefactorRewrite","Rewrite_Export","Rewrite_Arrow_Braces","Rewrite_Parameters_ToDestructured","Rewrite_Property_GenerateAccessors","allKnownCodeActionKinds","getKind","notApplicableReason","renameLocation","Empty","Refactor","MoveToFileCodeAction","SelectCodeAction","isOnSignatureName","_declarationKinds","convertedSpan","didApplyRefactoringCommand","interruptGetErrIfNeeded","triggerReason","toTsTriggerReason","includeInteractiveActions","v520","applicableRefactors","convertApplicableRefactors","CodeActionTriggerKind","Automatic","navTree","pruneInvalidActions","appendInvalidActions","Invoke","refactors","inlineable","refactorActionToCodeActions","Selection","getScope","otherAtion","otherScope","v400","disabledAction","numberOfInvalid","availableActions","invalidCommonActions","invalidUncommonActions","prioritizedActions","topNInvalid","registerReferenceProvider","TypeScriptReferenceSupport","provideReferences","includeDeclaration","registerRenameProvider","TypeScriptRenameProvider","prepareRename","execRename","renameInfo","canRename","triggerSpan","localizedErrorMessage","provideRenameEdits","newName","fileToRename","renameFile","fullDisplayName","updateLocs","locs","looksLikePotentialJsxTagContext","findInStrings","findInComments","spanGroup","prefixText","suffixText","newFilePath","oldFilePath","DocumentSemanticTokensProvider","registerDocumentRangeSemanticTokensProvider","getLegend","CONTENT_LENGTH_LIMIT","SemanticTokensLegend","tokenTypes","tokenModifiers","provideDocumentSemanticTokens","provideSemanticTokens","provideDocumentRangeSemanticTokens","requestArg","versionBeforeRequest","iv","waitForDocumentChangesToEnd","CancellationError","tokenSpan","builder","SemanticTokensBuilder","tsClassification","tokenType","getTokenTypeFromClassification","getTokenModifierFromClassification","startPos","endPos","startCharacter","endCharacter","registerSignatureHelpProvider","TypeScriptSignatureHelpProvider","retriggerCharacters","provideSignatureHelp","SignatureHelp","signatures","signature","convertSignature","activeSignature","getActiveSignature","activeParameter","getActiveParameter","previouslyActiveSignature","activeSignatureHelp","isRetrigger","existingIndex","findIndex","selectedItemIndex","isVariadic","argumentIndex","parameters","SignatureInformation","prefixDisplayParts","textIndex","separatorLabel","separatorDisplayParts","ParameterInformation","suffixDisplayParts","SignatureHelpTriggerKind","TriggerCharacter","ContentChange","registerSelectionRangeProvider","SmartSelection","provideSelectionRanges","positions","toLocation","convertSelectionRange","SelectionRange","SourceDefinitionCommand","anchor","requireActiveDocumentSetting","TagClosing","_disposed","contentChanges","TextDocumentChangeReason","Undo","Redo","activeDocument","lastChange","lastCharacter","rangeLength","addedLines","insertion","insertSnippet","getTagSnippet","getInsertionPositions","closingTag","appendPlaceholder","appendText","activeSelectionPositions","selections","active","Condition","onDidChangeActiveTextEditor","onDidOpenTextDocument","patterns","flat","openExtendsLinkCommandId","resourceUri","extendsValue","linkType","tsconfigPath","baseDirUri","pathValue","absolutePath","TsConfigLinkType","References","looksLikeAbsoluteWindowsPath","pathCandidates","currentUri","baseCandidate","sepIndex","moduleBasePath","moduleAbsoluteUrl","moduleStat","uriCandidate","relativeModulePath","oldUri","resolveNodeModulesPath","getTsconfigPath","registerDocumentLinkProvider","TsconfigLinkProvider","mapChildren","provideDocumentLinks","jsonc","getExtendsLink","getFilesLinks","getReferencesLinks","tryCreateTsConfigLink","Extends","pathNode","isPathValue","DocumentLink","getRange","tooltip","pathNodeToLink","getFileTarget","registerTypeDefinitionProvider","TypeScriptTypeDefinitionProvider","provideTypeDefinition","handles","UpdateImportsOnFileRenameHandler","updateImportsOnFileMoveName","_handles","_delayer","Delayer","_pendingRenames","onDidRenameFiles","newUri","jsTsFileThatIsBeingMoved","getJsTsFileBeingMoved","flushRenames","renames","group","groupRenames","resourcesBeingRenamed","closeResource","withEditsForFileRename","confirmActionWithUser","newResources","promptUser","doesResourceLookLikeATypeScriptFile","rejectItem","isCloseAffordance","acceptItem","alwaysItem","neverItem","showInformationMessage","getConfirmMessage","modal","getConfigTargetScope","isDirectory","findFiles","groups","getWorkspaceRootForResource","resourcesToConfirm","paths","settingsName","inspected","ConfigurationTarget","WorkspaceFolder","Workspace","Global","initialRange","findScopeEndLineFromNavTree","findEditScope","initialSelection","autoSend","findScopeEndLineFromNavTreeWorker","startLine","navigationTree","firstEdit","lastEdit","compareTo","startIndex","endIndex","expandEnd","conditions","doRegister","ConditionalRegistration","section","configValue","capabilities","requiredCapability","onDidChangeCapabilities","getValue","onUpdate","_onDidChange","_value","condition","parameterListParts","optionalParams","isInMethod","hasOptionalParameters","parenCount","braceCount","outer","DisplayPartKind","methodName","functionName","propertyName","parameterName","nameIsFollowedByOptionalIndicator","nameIsThis","punctuation","getParameterListParts","joiner","paramterPart","appendJoinedPlaceholders","appendTabstop","filePathConverter","isTrusted","enabledCommands","convertLinkTags","currentLink","linkText","escapeMarkdownSyntaxTokensForCode","linkcode","tagsToMarkdown","tag","docs","getTagBody","param","makeCodeblock","captionTagMatches","emailMatch","getTagBodyText","getTagDocumentation","converter","appendMarkdown","tagsPreview","modeIds","registerWorkspaceSymbolProvider","TypeScriptWorkspaceSymbolProvider","provideWorkspaceSymbols","searchAllOpenProjects","toOpenedFiledPath","maxResultCount","toSymbolInformation","doesResourceLookLikeAJavaScriptFile","isOfScheme","getLabel","SymbolInformation","documents","textDocuments","LanguageProvider","configurationChanged","onReady","registerProviders","documentSelector","getSemanticSupportedSchemes","cachedNavTreeResponse","CachedResponse","updateValidate","updateSuggestionDiagnostics","handlesUri","handlesConfigFile","handlesDocument","_diagnosticLanguage","triggerAllDiagnostics","requestAllDiagnostics","diagnosticsReceived","diagnosticsKind","reportUnnecessary","reportDeprecated","DiagnosticSeverity","Hint","services","Lazy","clientHost","onActivate","supportedLanguage","hasActivated","maybeActivate","isJsConfigOrTsConfigFileName","isSupportedDocument","openListener","LogLevelMonitor","onConfigurationChange","shouldNotifyExtendedLogging","notifyExtendedLogging","logLevelConfigKey","globalState","logLevelChangedStorageKey","logLevel","lastLogLevelChange","valueOf","doNotPrompt","doNotPromptLogLevelStorageKey","lastChangeMilliseconds","lastChangePlusOneWeek","choice","createOutputChannel","log","clientVersionDelegate","Tracer","traceRequest","serverId","responseExpected","queueLength","LogLevel","seq","traceResponse","request_seq","queuingStartTime","traceRequestCompleted","traceEvent","RemoteRepositories","remoteHub","getRemoteExtension","activate","fromVersionString","versionString","displayName","fullVersionString","isYarnPnp","v401","v460","v500","v544","v560","mode2ScriptKind","languageModeIds","CloseOperation","scriptKind","OpenOperation","ChangeOperation","BufferSynchronizer","pathNormalizer","_pending","updatePending","scriptKindName","beforeCommand","closedFiles","openFiles","changedFiles","nonRecoverable","SyncedBuffer","synchronizer","fileContent","projectRootPath","getProjectRootPath","tsPluginsForDocument","workspaceRoot","tsRoot","inMemoryResourcePrefix","lineCount","onContentChanged","SyncedBufferMap","getForPath","filePath","allBuffers","PendingDiagnostics","getOrderedFileSet","orderedResources","_normalizePath","GetErrRequest","executeGetErrRequest","onDone","_done","isErrorReportingEnabled","supportsSyntaxGetErr","fileEntries","areProjectDiagnosticsEnabled","executeAsync","delay","requestFiles","areRegionDiagnosticsEnabled","toFileRangesRequestArgs","TabResourceTracker","normalizePath","_tabResources","tabGroup","tabGroups","tab","tabs","onDidChangeTabs","opened","notebook","notebookDocuments","getCells","cell","addedResources","getResourcesForTab","closedResources","TabInputText","TabInputTextDiff","modified","TabInputNotebook","BufferSyncSupport","_validateJavaScript","_validateTypeScript","listening","_onDelete","onDelete","_onWillChange","onWillChange","diagnosticDelayer","syncedBuffers","pendingDiagnostics","pendingGetErr","syncedBuffer","requestDiagnostic","onDidChangeVisibleTextEditors","ensureHasBuffer","existingDocument","toVsCodeResource","reinitialize","wasBufferOpen","triggerDiagnostics","shouldValidate","getErr","resources","handledResources","sendPendingDiagnostics","orderedFileSet","visibleRanges","jsConfig","tsConfig","_callbacks","_asyncCallbacks","destroy","cause","cancellation","ServerResponse","Cancelled","onSuccess","noopRequestCanceller","cancellationPipeName","tryCancelOngoingRequest","_seq","_serverId","_tracer","_fileWatchers","_dirWatchers","watchParentDirs","isRecursive","isWritableFileSystem","parentDirWatchers","dirWatchers","onDidCreate","onDidDelete","dirUri","parentDirWatcher","glob","dirWatcher","disposeAll","dirWatcherEntry","getNewLogDirectory","useWorkspaceNodeStorageKey","lastKnownWorkspaceNodeStorageKey","NodeVersionManager","workspaceState","_onDidPickNewVersion","onDidPickNewVersion","_currentVersion","workspaceVersion","useWorkspaceNode","canUseWorkspaceNode","promptAndSetWorkspaceNode","onDidGrantWorkspaceTrust","updateActiveVersion","currentVersion","nextConfiguration","oldConfiguration","computeNewVersion","promptUseWorkspaceNode","allow","disallow","dismiss","setUseWorkspaceNodeState","pickedVersion","oldVersion","nodeVersion","getPluginPaths","pluginPaths","pluginPath","resolvePluginPath","workspacePath","RelativeWorkspacePathResolver","asAbsoluteWorkspacePath","TypeScriptServerPlugin","enableForWorkspaceTypeScriptVersions","_pluginConfigurations","_onDidUpdatePlugins","onDidChangePlugins","_onDidUpdateConfig","onDidUpdateConfig","_plugins","newPlugins","readPlugins","configurations","pluginMap","extension","pack","packageJSON","contributes","typescriptServerPlugins","configNamespace","propertyDeclaretedButNeverUsed","allImportsAreUnused","unusedLabel","fallThroughCaseInSwitch","notAllCodePathsReturnAValue","extendsShouldBeImplements","typeParameter","DiagnosticCategory","suggestion","dtsFile","tsFile","tsxFile","jsFile","jsxFile","jsonFile","EventName","RequestQueueingType","sequenceNumber","queueingType","LowPriority","dequeue","tryDeletePendingRequest","createRequest","RequestState","SingleTsServer","_serverSource","_process","_tsServerLog","_requestCanceller","_requestQueue","RequestQueue","CallbackMap","_pendingResponses","_onEvent","onEvent","_onExit","onExit","onData","dispatchMessage","tsServerLog","serverRequest","dispatchResponse","sendNextRequests","tryCancelRequest","logTrace","fetchCallback","NoContent","TypeScriptServerError","executeImpl","executeInfo","requestInfo","expectsResponse","expectsResult","getQueueingType","cancelViaSAB","telemetry","requestItem","fenceCommands","Fence","RequestRouter","servers","delegate","sharedCommands","requestStates","Unresolved","Resolved","allRequests","serverIndex","server","erroredRequest","onFatalError","Errored","canRun","GetErrRoutingTsServer","getErrServer","mainServer","primary","router","diagnosticEvents","configFileDiag","SyntaxRoutingTsServer","enableDynamicRouting","_projectLoading","syntaxServer","semanticServer","execInfo","syntaxAlwaysCommands","semanticCommands","projectLoading","syntaxAllowedCommands","projectLoadingStart","projectLoadingFinish","parsedResult","parseErrorText","sanitizedStack","serverMessage","serverStack","serverErrorText","serverCommand","serverid","sanitizedstack","badclient","errorText","errorPrefix","prefixFreeErrorText","newlineIndex","sanitizeStack","_extensionUri","fork","_versionManager","_nodeVersionManager","tsServerPath","launchArgs","WorkerServerProcess","idPool","_onDataHandlers","_onErrorHandlers","_onExitHandlers","_worker","_watches","FileWatcherManager","tsserverChannel","MessageChannel","watcherChannel","syncChannel","_tsserver","port2","_watcher","_syncFs","recursive","appendLog","port1","appendLine","TypeScriptServerSpawner","tsServerLogOutputChannel","_versionProvider","_logDirectoryProvider","_pluginPathsProvider","_factory","spawn","primaryServer","serverType","getCompositeServerType","shouldUseSeparateDiagnosticsServer","spawnTsServer","canceller","tsServerTraceDirectory","getTsServerArgs","isLoggingEnabled","kindToServerType","logDir","logFilePath","isUsingBundledTypeScriptVersion","getTsLocale","configUseVsCodeWatcher","useWorkspaceTsdkStorageKey","suppressPromptWorkspaceTsdkStorageKey","TypeScriptVersionManager","useWorkspaceTsdkSetting","isInPromptWorkspaceTsdkState","promptUseWorkspaceTsdk","lastConfiguration","promptUserForVersion","getBundledPickItem","getLocalPickItems","LearnMorePickItem","pathLabel","requestWorkspaceTrust","allowIt","dismissPrompt","suppressPrompt","suppressPromptWorkspaceTsdkSetting","_pathLabel","projectType","rootPath","showWarningMessage","needFileNameList","openProjectConfigOrPromptToCreate","configFileName","isImplicitProjectConfigFile","inferredProjectCompilerOptions","serviceConfig","projectConfig","moduleResolution","jsx","allowImportingTsExtensions","allowJs","sourceMap","openOrCreateConfig","configFile","col","viewColumn","showTextDocument","baseConfig","compilerOptions","inferredProjectConfigSnippet","configFilePath","CreateConfigItem","toFileRange","endLine","tslocation","vsPosition","tsTextSpan","TypeParameter","TriggerForIncompleteCompletions","styleCheckDiagnostics","TypeScriptServiceClientHost","descriptions","languagePerId","reportStyleCheckAsWarnings","allModeIds","getAllModeIds","onDiagnosticsReceived","onConfigDiagnosticsReceived","onResendModelsRequested","populateService","VersionStatus","IntellisenseStatus","AtaProgressReporter","LargeProjectStatus","ensureServiceStarted","registerExtensionLanguageProvider","isExternal","executeWithoutWaitingForResponse","findLanguage","typescriptConfig","createMarkerDatas","tsDiag","Diagnostic","getDiagnosticSeverity","tsDiagnosticToVsDiagnostic","converted","DiagnosticRelatedInformation","reportsUnnecessary","reportsDeprecated","resultConverted","isStyleCheckDiagnostic","category","NoServer","capability","ServerState","None","Running","tsserverVersion","languageServiceEnabled","toCancelOnResourceChange","updateTsserverVersion","updateLanguageServiceEnabled","emptyAuthority","TypeScriptServiceClient","serverState","_isPromptingAfterCrash","isRestarting","hasServerFatallyCrashedTooManyTimes","watches","watchEvents","_onDidChangeCapabilities","_onTsServerStarted","_onDiagnosticsReceived","_onConfigDiagnosticsReceived","_onResendModelsRequested","_onProjectLanguageServiceStateChanged","onProjectLanguageServiceStateChanged","_onDidBeginInstallTypings","onDidBeginInstallTypings","_onDidEndInstallTypings","onDidEndInstallTypings","_onTypesInstallerInitializationFailed","onTypesInstallerInitializationFailed","_onSurveyReady","onSurveyReady","loadingIndicator","ServerInitializingIndicator","tracer","lastStart","rej","_onReady","numberRestarts","pluginPathsProvider","TypeScriptPluginPathsProvider","cancelInflightRequestsForResource","setCompilerOptionsForInferredProjects","areServiceConfigurationsEqual","VSCodeTelemetryReporter","typescriptServerSpawner","ClientCapabilities","isProjectWideIntellisenseOnWebEnabled","resetWatchers","fromUserAction","startService","resendModels","isDisposed","nodePath","mytoken","fatalError","typeScriptServerEnvCommonProperties","hasGlobalPlugins","globalPluginNameHashes","localTypeScriptVersion","typeScriptVersionSource","serviceExited","dispatchEvent","serviceStarted","usedApiVersion","watchChangeTimeout","configureOptions","hostInfo","excludeLibrarySymbolsInNavTo","pluginName","getCompilerOptionsForInferredProjects","allowSyntheticDefaultImports","allowNonTsExtensions","resolveJsonModule","restart","tsVersion","pluginExtensionList","reportIssueItem","prompt","uriScheme","minModernTsVersion","reportIssue","suppressAlertOnFailure","roots","executions","runningServerState","inFlight","updateOpenTask","updateOpenArgs","startedLoadingFile","logfile","diagnosticEvent","getDiagnosticsKind","dispatchTelemetryEvent","projectLanguageServiceState","projectsUpdatedInBackground","beginInstallTypes","endInstallTypes","typesInstallerInitializationFailed","surveyReady","startedLoadingProject","projectName","finishedLoadingProject","createDirectoryWatcher","fpath","ignoreUpdate","createFileWatcher","closeFileWatcher","closeFileSystemWatcher","requestCompleted","diagnosticsDuration","fileData","scheduleExecuteWatchChangeRequest","allEvents","updated","created","deleted","addWatchEvent","eventType","removeEvent","typeOfEventToRemove","aggregateEvent","ignoreChangeEvents","disposable","DisposableStore","changeFile","deletedFile","telemetryData","telemetryEventName","typingsInstalledPayload","installedPackages","installSuccess","typingsInstallerVersion","_task","projectDisplayName","getProjectDisplayName","project","projectUri","relPath","_onDidChangeActiveJsTsEditor","onDidChangeActiveJsTsEditor","onDidChangeTabGroups","_activeJsTsEditor","newActiveJsTsEditor","getEditorCandidatesForActiveTab","isManagedFile","at","activeTabGroup","activeTab","inputUri","visibleNotebookEditors","isManagedScriptFile","isManagedConfigFile","IntellisenseState","SyntaxOnly","Pending","_activeTextEditorManager","openOpenConfigCommandId","createOrOpenConfigCommandId","_ready","updateStatus","_statusItem","pendingState","statusItem","ensureStatusItem","LanguageStatusSeverity","busy","noConfigFileText","createLanguageStatusItem","toDispose","ExcludeHintItem","onConfigureExcludesSelected","getCurrentHint","hide","createLargeProjectMonitorFromTypeScript","_item","createStatusBarItem","StatusBarAlignment","Right","_currentHint","largeRoots","ManagedFileContextManager","isInManagedFileContext","contextName","TypingsStatus","_acquiringTypings","onBeginInstallTypings","eventId","onEndInstallTypings","_promises","_onBegin","_onEndOrTimeout","dontShowAgain","onDidChangeTypeScriptVersion","itemEquals","clearImmediate","onTimeout","promiseResolve","race","defaultDelay","completionPromise","cancelTimeout","activePromise","queuedPromise","queuedPromiseFactory","promiseFactory","noopDisposable","AggregateError","_isDisposed","numberHash","initialHashVal","stringHash","hashVal","objectHash","booleanHash","_didRun","hasValue","_error","rawValue","_target","descriptor","fnKey","memoizeKey","one","oneKeys","otherKeys","uiKind","UIKind","Web","rootPrefixes","rootPrefix","defaultPathNormalizer","_map","toKey","isCaseInsensitivePath","require","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","definition","__webpack_exports__"],"sourceRoot":""}