var A7=Object.defineProperty;var w2=n=>{throw TypeError(n)};var R7=(n,e,t)=>e in n?A7(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var At=(n,e,t)=>R7(n,typeof e!="symbol"?e+"":e,t),Y_=(n,e,t)=>e.has(n)||w2("Cannot "+t);var A=(n,e,t)=>(Y_(n,e,"read from private field"),t?t.call(n):e.get(n)),ge=(n,e,t)=>e.has(n)?w2("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),ie=(n,e,t,i)=>(Y_(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t),ld=(n,e,t)=>(Y_(n,e,"access private method"),t);class Ci{constructor(e){this.executor=e,this._didRun=!1}get hasValue(){return this._didRun}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}}let L7=class{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?Wr.isErrorNoTelemetry(e)?new Wr(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.listeners.push(e),()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(t=>{t(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}};const Uf=new L7;function Lv(n){Uf.setUnexpectedErrorHandler(n)}function Jp(n){Uf.onUnexpectedError(n)}function Fn(n){dl(n)||Uf.onUnexpectedError(n)}function iI(n){dl(n)||Uf.onUnexpectedExternalError(n)}function lu(n){if(n instanceof Error){const{name:e,message:t,cause:i}=n,r=n.stacktrace||n.stack;return{$isError:!0,name:e,message:t,stack:r,noTelemetry:Wr.isErrorNoTelemetry(n),cause:i?lu(i):void 0,code:n.code}}return n}function rI(n){let e;return n.noTelemetry?e=new Wr:(e=new Error,e.name=n.name),e.message=n.message,e.stack=n.stack,n.code&&(e.code=n.code),n.cause&&(e.cause=rI(n.cause)),e}const Xp="Canceled";function dl(n){return n instanceof qr?!0:n instanceof Error&&n.name===Xp&&n.message===Xp}class qr extends Error{constructor(){super(Xp),this.name=this.message}}function b2(){const n=new Error(Xp);return n.name=n.message,n}function Be(n){return n?new Error(`Illegal argument: ${n}`):new Error("Illegal argument")}function sx(n){return n?new Error(`Illegal state: ${n}`):new Error("Illegal state")}class la extends TypeError{constructor(e){super(e?`${e} is read-only and cannot be changed`:"Cannot change read-only property")}}class N7 extends Error{constructor(e){super("NotImplemented"),e&&(this.message=e)}}class Nv extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}}class Wr extends Error{constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof Wr)return e;const t=new Wr;return t.message=e.message,t.stack=e.stack,t}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}}class ur extends Error{constructor(e){super(e||"An unexpected bug occurred."),Object.setPrototypeOf(this,ur.prototype)}}function $r(n,e,t=(i,r)=>i===r){if(n===e)return!0;if(!n||!e||n.length!==e.length)return!1;for(let i=0,r=n.length;i<r;i++)if(!t(n[i],e[i]))return!1;return!0}function O7(n,e){const t=[];let i;for(const r of n.slice(0).sort(e))!i||e(i[0],r)!==0?(i=[r],t.push(i)):i.push(r);return t}function sI(n,e,t){const i=[];function r(a,l,c){if(l===0&&c.length===0)return;const u=i[i.length-1];u&&u.start+u.deleteCount===a?(u.deleteCount+=l,u.toInsert.push(...c)):i.push({start:a,deleteCount:l,toInsert:c})}let s=0,o=0;for(;;){if(s===n.length){r(s,0,e.slice(o));break}if(o===e.length){r(s,n.length-s,[]);break}const a=n[s],l=e[o],c=t(a,l);c===0?(s+=1,o+=1):c<0?(r(s,1,[]),s+=1):c>0&&(r(s,0,[l]),o+=1)}return i}function F7(n,e,t){const i=sI(n,e,t),r=[],s=[];for(const o of i)r.push(...n.slice(o.start,o.start+o.deleteCount)),s.push(...o.toInsert);return{removed:r,added:s}}function sn(n){return n.filter(e=>!!e)}function M7(n){let e=0;for(let t=0;t<n.length;t++)n[t]&&(n[e]=n[t],e+=1);n.length=e}function ox(n){return!Array.isArray(n)||n.length===0}function ju(n){return Array.isArray(n)&&n.length>0}function Yl(n,e=t=>t){const t=new Set;return n.filter(i=>{const r=e(i);return t.has(r)?!1:(t.add(r),!0)})}function y2(n,e){let t;t=Math.random;for(let i=n.length-1;i>0;i-=1){const r=Math.floor(t()*(i+1)),s=n[i];n[i]=n[r],n[r]=s}}function Ov(n,e){return Array.isArray(n)?n.map(e):e(n)}function Bi(n){return Array.isArray(n)?n:[n]}var Fv;(function(n){function e(s){return s<0}n.isLessThan=e;function t(s){return s<=0}n.isLessThanOrEqual=t;function i(s){return s>0}n.isGreaterThan=i;function r(s){return s===0}n.isNeitherLessOrGreaterThan=r,n.greaterThan=1,n.lessThan=-1,n.neitherLessOrGreaterThan=0})(Fv||(Fv={}));function $7(n,e){return(t,i)=>e(n(t),n(i))}const U7=(n,e)=>n-e,hc=class hc{constructor(e){this.iterate=e}forEach(e){this.iterate(t=>(e(t),!0))}toArray(){const e=[];return this.iterate(t=>(e.push(t),!0)),e}filter(e){return new hc(t=>this.iterate(i=>e(i)?t(i):!0))}map(e){return new hc(t=>this.iterate(i=>t(e(i))))}some(e){let t=!1;return this.iterate(i=>(t=e(i),!t)),t}findFirst(e){let t;return this.iterate(i=>e(i)?(t=i,!1):!0),t}findLast(e){let t;return this.iterate(i=>(e(i)&&(t=i),!0)),t}findLastMaxBy(e){let t,i=!0;return this.iterate(r=>((i||Fv.isGreaterThan(e(r,t)))&&(i=!1,t=r),!0)),t}};hc.empty=new hc(e=>{});let x2=hc;function oI(n,e){const t=Object.create(null);for(const i of n){const r=e(i);let s=t[r];s||(s=t[r]=[]),s.push(i)}return t}function H7(n,e){const t=[],i=[];for(const r of n)e.has(r)||t.push(r);for(const r of e)n.has(r)||i.push(r);return{removed:t,added:i}}var E2,S2,D2;function B7(n,e,t){let i=n.get(e);return i===void 0&&(i=t,n.set(e,i)),i}class W7{constructor(e,t){this.uri=e,this.value=t}}function V7(n){return Array.isArray(n)}const ta=class ta{constructor(e,t){if(this[E2]="ResourceMap",e instanceof ta)this.map=new Map(e.map),this.toKey=t??ta.defaultToKey;else if(V7(e)){this.map=new Map,this.toKey=t??ta.defaultToKey;for(const[i,r]of e)this.set(i,r)}else this.map=new Map,this.toKey=e??ta.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new W7(e,t)),this}get(e){var t;return(t=this.map.get(this.toKey(e)))==null?void 0:t.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t<"u"&&(e=e.bind(t));for(const[i,r]of this.map)e(r.value,r.uri,this)}*values(){for(const e of this.map.values())yield e.value}*keys(){for(const e of this.map.values())yield e.uri}*entries(){for(const e of this.map.values())yield[e.uri,e.value]}*[(E2=Symbol.toStringTag,Symbol.iterator)](){for(const[,e]of this.map)yield[e.uri,e.value]}};ta.defaultToKey=e=>e.toString();let on=ta;class aI{constructor(e,t){this[S2]="ResourceSet",!e||typeof e=="function"?this._map=new on(e):(this._map=new on(t),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,t){this._map.forEach((i,r)=>e.call(t,r,r,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[(S2=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}}var Bn;(function(n){n[n.None=0]="None",n[n.AsOld=1]="AsOld",n[n.AsNew=2]="AsNew"})(Bn||(Bn={}));class z7{constructor(){this[D2]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,t=Bn.None){const i=this._map.get(e);if(i)return t!==Bn.None&&this.touch(i,t),i.value}set(e,t,i=Bn.None){let r=this._map.get(e);if(r)r.value=t,i!==Bn.None&&this.touch(r,i);else{switch(r={key:e,value:t,next:void 0,previous:void 0},i){case Bn.None:this.addItemLast(r);break;case Bn.AsOld:this.addItemFirst(r);break;case Bn.AsNew:this.addItemLast(r);break;default:this.addItemLast(r);break}this._map.set(e,r),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const i=this._state;let r=this._head;for(;r;){if(t?e.bind(t)(r.value,r.key,this):e(r.value,r.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");r=r.next}}keys(){const e=this,t=this._state;let i=this._head;const r={[Symbol.iterator](){return r},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const s={value:i.key,done:!1};return i=i.next,s}else return{value:void 0,done:!0}}};return r}values(){const e=this,t=this._state;let i=this._head;const r={[Symbol.iterator](){return r},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const s={value:i.value,done:!1};return i=i.next,s}else return{value:void 0,done:!0}}};return r}entries(){const e=this,t=this._state;let i=this._head;const r={[Symbol.iterator](){return r},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const s={value:[i.key,i.value],done:!1};return i=i.next,s}else return{value:void 0,done:!0}}};return r}[(D2=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.next,i--;this._head=t,this._size=i,t&&(t.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._tail,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.previous,i--;this._tail=t,this._size=i,t&&(t.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,i=e.previous;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==Bn.AsOld&&t!==Bn.AsNew)){if(t===Bn.AsOld){if(e===this._head)return;const i=e.next,r=e.previous;e===this._tail?(r.next=void 0,this._tail=r):(i.previous=r,r.next=i),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===Bn.AsNew){if(e===this._tail)return;const i=e.next,r=e.previous;e===this._head?(i.previous=void 0,this._head=i):(i.previous=r,r.next=i),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((t,i)=>{e.push([i,t])}),e}fromJSON(e){this.clear();for(const[t,i]of e)this.set(t,i)}}let q7=class extends z7{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=Bn.AsNew){return super.get(e,t)}peek(e){return super.get(e,Bn.None)}set(e,t){return super.set(e,t,Bn.AsNew),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}};class ax extends q7{constructor(e,t=1){super(e,t)}trim(e){this.trimOld(e)}set(e,t){return super.set(e,t),this.checkTrim(),this}}class lI{constructor(){this.map=new Map}add(e,t){let i=this.map.get(e);i||(i=new Set,this.map.set(e,i)),i.add(t)}delete(e,t){const i=this.map.get(e);i&&(i.delete(t),i.size===0&&this.map.delete(e))}forEach(e,t){const i=this.map.get(e);i&&i.forEach(t)}get(e){const t=this.map.get(e);return t||new Set}}function lx(n,e){const t=this;let i=!1,r;return function(){return i||(i=!0,r=n.apply(t,arguments)),r}}function Vn(n,e){if(!n)throw new Error(e?`Assertion failed (${e})`:"Assertion Failed")}function Mv(n,e="Unreachable"){throw new Error(e)}function j7(n,e="unexpected state"){if(!n)throw typeof e=="string"?new ur(`Assertion Failed: ${e}`):e}function cI(n){if(!n()){debugger;n(),Fn(new ur("Assertion Failed"))}}function Ze(n){return typeof n=="string"}function G7(n){return Array.isArray(n)&&n.every(e=>Ze(e))}function Zt(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)&&!(n instanceof RegExp)&&!(n instanceof Date)}function Q7(n){const e=Object.getPrototypeOf(Uint8Array);return typeof n=="object"&&n instanceof e}function Ua(n){return typeof n=="number"&&!isNaN(n)}function J7(n){return!!n&&typeof n[Symbol.iterator]=="function"}function Ed(n){return typeof n>"u"}function Ui(n){return!Yt(n)}function Yt(n){return Ed(n)||n===null}function uI(n,e){if(!n)throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}function cu(n){return j7(n!=null,"Argument is `undefined` or `null`."),n}const X7=Object.prototype.hasOwnProperty;function dI(n){if(!Zt(n))return!1;for(const e in n)if(X7.call(n,e))return!1;return!0}function Y7(n){return typeof n=="function"}function Z7(n,e){if(Ze(e)){if(typeof n!==e)throw new Error(`argument does not match constraint: typeof ${e}`)}else if(Y7(e)){try{if(n instanceof e)return}catch{}if(!Yt(n)&&n.constructor===e||e.length===1&&e.call(void 0,n)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}var zn;(function(n){function e(T){return T&&typeof T=="object"&&typeof T[Symbol.iterator]=="function"}n.is=e;const t=Object.freeze([]);function i(){return t}n.empty=i;function*r(T){yield T}n.single=r;function s(T){return e(T)?T:r(T)}n.wrap=s;function o(T){return T||t}n.from=o;function*a(T){for(let z=T.length-1;z>=0;z--)yield T[z]}n.reverse=a;function l(T){return!T||T[Symbol.iterator]().next().done===!0}n.isEmpty=l;function c(T){return T[Symbol.iterator]().next().value}n.first=c;function u(T,z){let K=0;for(const Ee of T)if(z(Ee,K++))return!0;return!1}n.some=u;function d(T,z){for(const K of T)if(z(K))return K}n.find=d;function*f(T,z){for(const K of T)z(K)&&(yield K)}n.filter=f;function*p(T,z){let K=0;for(const Ee of T)yield z(Ee,K++)}n.map=p;function*w(T,z){let K=0;for(const Ee of T)yield*z(Ee,K++)}n.flatMap=w;function*v(...T){for(const z of T)J7(z)?yield*z:yield z}n.concat=v;function m(T,z,K){let Ee=K;for(const Q of T)Ee=z(Ee,Q);return Ee}n.reduce=m;function x(T){let z=0;for(const K of T)z++;return z}n.length=x;function*k(T,z,K=T.length){for(z<-T.length&&(z=0),z<0&&(z+=T.length),K<0?K+=T.length:K>T.length&&(K=T.length);z<K;z++)yield T[z]}n.slice=k;function D(T,z=Number.POSITIVE_INFINITY){const K=[];if(z===0)return[K,T];const Ee=T[Symbol.iterator]();for(let Q=0;Q<z;Q++){const le=Ee.next();if(le.done)return[K,n.empty()];K.push(le.value)}return[K,{[Symbol.iterator](){return Ee}}]}n.consume=D;async function B(T){const z=[];for await(const K of T)z.push(K);return Promise.resolve(z)}n.asyncToArray=B})(zn||(zn={}));const D1=class D1{constructor(){this.livingDisposables=new Map}getDisposableData(e){let t=this.livingDisposables.get(e);return t||(t={parent:null,source:null,isSingleton:!1,value:e,idx:D1.idx++},this.livingDisposables.set(e,t)),t}trackDisposable(e){const t=this.getDisposableData(e);t.source||(t.source=new Error().stack)}setParent(e,t){const i=this.getDisposableData(e);i.parent=t}markAsDisposed(e){this.livingDisposables.delete(e)}markAsSingleton(e){this.getDisposableData(e).isSingleton=!0}getRootParent(e,t){const i=t.get(e);if(i)return i;const r=e.parent?this.getRootParent(this.getDisposableData(e.parent),t):e;return t.set(e,r),r}getTrackedDisposables(){const e=new Map;return[...this.livingDisposables.entries()].filter(([,i])=>i.source!==null&&!this.getRootParent(i,e).isSingleton).flatMap(([i])=>i)}computeLeakingDisposables(e=10,t){let i;if(t)i=t;else{const l=new Map,c=[...this.livingDisposables.values()].filter(d=>d.source!==null&&!this.getRootParent(d,l).isSingleton);if(c.length===0)return;const u=new Set(c.map(d=>d.value));if(i=c.filter(d=>!(d.parent&&u.has(d.parent))),i.length===0)throw new Error("There are cyclic diposable chains!")}if(!i)return;function r(l){function c(d,f){for(;d.length>0&&f.some(p=>typeof p=="string"?p===d[0]:d[0].match(p));)d.shift()}const u=l.source.split(`
`).map(d=>d.trim().replace("at ","")).filter(d=>d!=="");return c(u,["Error",/^trackDisposable \(.*\)$/,/^DisposableTracker.trackDisposable \(.*\)$/]),u.reverse()}const s=new lI;for(const l of i){const c=r(l);for(let u=0;u<=c.length;u++)s.add(c.slice(0,u).join(`
`),l)}i.sort($7(l=>l.idx,U7));let o="",a=0;for(const l of i.slice(0,e)){a++;const c=r(l),u=[];for(let d=0;d<c.length;d++){let f=c[d];f=`(shared with ${s.get(c.slice(0,d+1).join(`
`)).size}/${i.length} leaks) at ${f}`;const w=s.get(c.slice(0,d).join(`
`)),v=oI([...w].map(m=>r(m)[d]),m=>m);delete v[c[d]];for(const[m,x]of Object.entries(v))u.unshift(`    - stacktraces of ${x.length} other leaks continue with ${m}`);u.unshift(f)}o+=`


==================== Leaking disposable ${a}/${i.length}: ${l.value.constructor.name} ====================
${u.join(`
`)}
============================================================

`}return i.length>e&&(o+=`


... and ${i.length-e} more leaking disposables

`),{leaks:i,details:o}}};D1.idx=0;let k2=D1;function K7(n){return typeof n=="object"&&n!==null&&typeof n.dispose=="function"&&n.dispose.length===0}function Ns(n){if(zn.is(n)){const e=[];for(const t of n)if(t)try{t.dispose()}catch(i){e.push(i)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(n)?[]:n}else if(n)return n.dispose(),n}function hI(...n){return Se(()=>Ns(n))}function Se(n){return{dispose:lx(()=>{n()})}}const k1=class k1{constructor(){this._toDispose=new Set,this._isDisposed=!1}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{Ns(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?k1.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}delete(e){if(e){if(e===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(e),e.dispose()}}deleteAndLeak(e){e&&this._toDispose.has(e)&&this._toDispose.delete(e)}};k1.DISABLE_DISPOSED_WARNING=!1;let Ie=k1;var Wc;let Te=(Wc=class{constructor(){this._store=new Ie,this._store}dispose(){this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}},Wc.None=Object.freeze({dispose(){}}),Wc);class go{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(e){var t;this._isDisposed||e===this._value||((t=this._value)==null||t.dispose(),this._value=e)}clear(){this.value=void 0}dispose(){var e;this._isDisposed=!0,(e=this._value)==null||e.dispose(),this._value=void 0}clearAndLeak(){const e=this._value;return this._value=void 0,e}}class Yp{constructor(){this._store=new Map,this._isDisposed=!1}dispose(){this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{Ns(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get size(){return this._store.size}get(e){return this._store.get(e)}set(e,t,i=!1){var r;this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),i||(r=this._store.get(e))==null||r.dispose(),this._store.set(e,t)}deleteAndDispose(e){var t;(t=this._store.get(e))==null||t.dispose(),this._store.delete(e)}deleteAndLeak(e){const t=this._store.get(e);return this._store.delete(e),t}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}}const ip=typeof Buffer<"u",eP=new Ci(()=>new Uint8Array(256));let Z_,K_;class Pe{static alloc(e){return ip?new Pe(Buffer.allocUnsafe(e)):new Pe(new Uint8Array(e))}static wrap(e){return ip&&!Buffer.isBuffer(e)&&(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),new Pe(e)}static fromString(e,t){return!((t==null?void 0:t.dontUseNodeBuffer)||!1)&&ip?new Pe(Buffer.from(e)):(Z_||(Z_=new TextEncoder),new Pe(Z_.encode(e)))}static fromByteArray(e){const t=Pe.alloc(e.length);for(let i=0,r=e.length;i<r;i++)t.buffer[i]=e[i];return t}static concat(e,t){if(typeof t>"u"){t=0;for(let s=0,o=e.length;s<o;s++)t+=e[s].byteLength}const i=Pe.alloc(t);let r=0;for(let s=0,o=e.length;s<o;s++){const a=e[s];i.set(a,r),r+=a.byteLength}return i}constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}clone(){const e=Pe.alloc(this.byteLength);return e.set(this),e}toString(){return ip?this.buffer.toString():(K_||(K_=new TextDecoder),K_.decode(this.buffer))}slice(e,t){return new Pe(this.buffer.subarray(e,t))}set(e,t){if(e instanceof Pe)this.buffer.set(e.buffer,t);else if(e instanceof Uint8Array)this.buffer.set(e,t);else if(e instanceof ArrayBuffer)this.buffer.set(new Uint8Array(e),t);else if(ArrayBuffer.isView(e))this.buffer.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),t);else throw new Error("Unknown argument 'array'")}readUInt32BE(e){return Ep(this.buffer,e)}writeUInt32BE(e,t){Sp(this.buffer,e,t)}readUInt32LE(e){return rP(this.buffer,e)}writeUInt32LE(e,t){sP(this.buffer,e,t)}readUInt8(e){return oP(this.buffer,e)}writeUInt8(e,t){aP(this.buffer,e,t)}indexOf(e,t=0){return tP(this.buffer,e instanceof Pe?e.buffer:e,t)}equals(e){return this===e?!0:this.byteLength!==e.byteLength?!1:this.buffer.every((t,i)=>t===e.buffer[i])}}function tP(n,e,t=0){const i=e.byteLength,r=n.byteLength;if(i===0)return 0;if(i===1)return n.indexOf(e[0]);if(i>r-t)return-1;const s=eP.value;s.fill(e.length);for(let c=0;c<e.length;c++)s[e[c]]=e.length-c-1;let o=t+e.length-1,a=o,l=-1;for(;o<r;)if(n[o]===e[a]){if(a===0){l=o;break}o--,a--}else o+=Math.max(e.length-a,s[n[o]]),a=e.length-1;return l}function nP(n,e){return n[e+0]<<0>>>0|n[e+1]<<8>>>0}function iP(n,e,t){n[t+0]=e&255,e=e>>>8,n[t+1]=e&255}function Ep(n,e){return n[e]*2**24+n[e+1]*2**16+n[e+2]*2**8+n[e+3]}function Sp(n,e,t){n[t+3]=e,e=e>>>8,n[t+2]=e,e=e>>>8,n[t+1]=e,e=e>>>8,n[t]=e}function rP(n,e){return n[e+0]<<0>>>0|n[e+1]<<8>>>0|n[e+2]<<16>>>0|n[e+3]<<24>>>0}function sP(n,e,t){n[t+0]=e&255,e=e>>>8,n[t+1]=e&255,e=e>>>8,n[t+2]=e&255,e=e>>>8,n[t+3]=e&255}function oP(n,e){return n[e]}function aP(n,e,t){n[t]=e}function Zp(n){let e=0,t=0,i=0;const r=new Uint8Array(Math.floor(n.length/4*3)),s=a=>{switch(t){case 3:r[i++]=e|a,t=0;break;case 2:r[i++]=e|a>>>2,e=a<<6,t=3;break;case 1:r[i++]=e|a>>>4,e=a<<4,t=2;break;default:e=a<<2,t=1}};for(let a=0;a<n.length;a++){const l=n.charCodeAt(a);if(l>=65&&l<=90)s(l-65);else if(l>=97&&l<=122)s(l-97+26);else if(l>=48&&l<=57)s(l-48+52);else if(l===43||l===45)s(62);else if(l===47||l===95)s(63);else{if(l===61)break;throw new SyntaxError(`Unexpected base64 character ${n[a]}`)}}const o=i;for(;t>0;)s(0);return Pe.wrap(r).slice(0,o)}const lP="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",cP="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";function cx({buffer:n},e=!0,t=!1){const i=t?cP:lP;let r="";const s=n.byteLength%3;let o=0;for(;o<n.byteLength-s;o+=3){const a=n[o+0],l=n[o+1],c=n[o+2];r+=i[a>>>2],r+=i[(a<<4|l>>>4)&63],r+=i[(l<<2|c>>>6)&63],r+=i[c&63]}if(s===1){const a=n[o+0];r+=i[a>>>2],r+=i[a<<4&63],e&&(r+="==")}else if(s===2){const a=n[o+0],l=n[o+1];r+=i[a>>>2],r+=i[(a<<4|l>>>4)&63],r+=i[l<<2&63],e&&(r+="=")}return r}var Cs;let Vt=(Cs=class{constructor(e){this.element=e,this.next=Cs.Undefined,this.prev=Cs.Undefined}},Cs.Undefined=new Cs(void 0),Cs);class Hf{constructor(){this._first=Vt.Undefined,this._last=Vt.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===Vt.Undefined}clear(){let e=this._first;for(;e!==Vt.Undefined;){const t=e.next;e.prev=Vt.Undefined,e.next=Vt.Undefined,e=t}this._first=Vt.Undefined,this._last=Vt.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){const i=new Vt(e);if(this._first===Vt.Undefined)this._first=i,this._last=i;else if(t){const s=this._last;this._last=i,i.prev=s,s.next=i}else{const s=this._first;this._first=i,i.next=s,s.prev=i}this._size+=1;let r=!1;return()=>{r||(r=!0,this._remove(i))}}shift(){if(this._first!==Vt.Undefined){const e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==Vt.Undefined){const e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==Vt.Undefined&&e.next!==Vt.Undefined){const t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===Vt.Undefined&&e.next===Vt.Undefined?(this._first=Vt.Undefined,this._last=Vt.Undefined):e.next===Vt.Undefined?(this._last=this._last.prev,this._last.next=Vt.Undefined):e.prev===Vt.Undefined&&(this._first=this._first.next,this._first.prev=Vt.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==Vt.Undefined;)yield e.element,e=e.next}}const uP=globalThis.performance&&typeof globalThis.performance.now=="function";class Os{static create(e){return new Os(e)}constructor(e){this._now=uP&&e===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}}var Ht;(function(n){n.None=()=>Te.None;function e(Y,j){return f(Y,()=>{},0,void 0,!0,void 0,j)}n.defer=e;function t(Y){return(j,ae=null,ne)=>{let he=!1,_e;return _e=Y(Ve=>{if(!he)return _e?_e.dispose():he=!0,j.call(ae,Ve)},null,ne),he&&_e.dispose(),_e}}n.once=t;function i(Y,j){return n.once(n.filter(Y,j))}n.onceIf=i;function r(Y,j,ae){return u((ne,he=null,_e)=>Y(Ve=>ne.call(he,j(Ve)),null,_e),ae)}n.map=r;function s(Y,j,ae){return u((ne,he=null,_e)=>Y(Ve=>{j(Ve),ne.call(he,Ve)},null,_e),ae)}n.forEach=s;function o(Y,j,ae){return u((ne,he=null,_e)=>Y(Ve=>j(Ve)&&ne.call(he,Ve),null,_e),ae)}n.filter=o;function a(Y){return Y}n.signal=a;function l(...Y){return(j,ae=null,ne)=>{const he=hI(...Y.map(_e=>_e(Ve=>j.call(ae,Ve))));return d(he,ne)}}n.any=l;function c(Y,j,ae,ne){let he=ae;return r(Y,_e=>(he=j(he,_e),he),ne)}n.reduce=c;function u(Y,j){let ae;const ne={onWillAddFirstListener(){ae=Y(he.fire,he)},onDidRemoveLastListener(){ae==null||ae.dispose()}},he=new L(ne);return j==null||j.add(he),he.event}function d(Y,j){return j instanceof Array?j.push(Y):j&&j.add(Y),Y}function f(Y,j,ae=100,ne=!1,he=!1,_e,Ve){let yt,$e,Gt,Un=0,xt;const mi={leakWarningThreshold:_e,onWillAddFirstListener(){yt=Y(Wt=>{Un++,$e=j($e,Wt),ne&&!Gt&&(_n.fire($e),$e=void 0),xt=()=>{const Ri=$e;$e=void 0,Gt=void 0,(!ne||Un>1)&&_n.fire(Ri),Un=0},typeof ae=="number"?(clearTimeout(Gt),Gt=setTimeout(xt,ae)):Gt===void 0&&(Gt=0,queueMicrotask(xt))})},onWillRemoveListener(){he&&Un>0&&(xt==null||xt())},onDidRemoveLastListener(){xt=void 0,yt.dispose()}},_n=new L(mi);return Ve==null||Ve.add(_n),_n.event}n.debounce=f;function p(Y,j=0,ae){return n.debounce(Y,(ne,he)=>ne?(ne.push(he),ne):[he],j,void 0,!0,void 0,ae)}n.accumulate=p;function w(Y,j=(ne,he)=>ne===he,ae){let ne=!0,he;return o(Y,_e=>{const Ve=ne||!j(_e,he);return ne=!1,he=_e,Ve},ae)}n.latch=w;function v(Y,j,ae){return[n.filter(Y,j,ae),n.filter(Y,ne=>!j(ne),ae)]}n.split=v;function m(Y,j=!1,ae=[],ne){let he=ae.slice(),_e=Y($e=>{he?he.push($e):yt.fire($e)});ne&&ne.add(_e);const Ve=()=>{he==null||he.forEach($e=>yt.fire($e)),he=null},yt=new L({onWillAddFirstListener(){_e||(_e=Y($e=>yt.fire($e)),ne&&ne.add(_e))},onDidAddFirstListener(){he&&(j?setTimeout(Ve):Ve())},onDidRemoveLastListener(){_e&&_e.dispose(),_e=null}});return ne&&ne.add(yt),yt.event}n.buffer=m;function x(Y,j){return(ne,he,_e)=>{const Ve=j(new D);return Y(function(yt){const $e=Ve.evaluate(yt);$e!==k&&ne.call(he,$e)},void 0,_e)}}n.chain=x;const k=Symbol("HaltChainable");class D{constructor(){this.steps=[]}map(j){return this.steps.push(j),this}forEach(j){return this.steps.push(ae=>(j(ae),ae)),this}filter(j){return this.steps.push(ae=>j(ae)?ae:k),this}reduce(j,ae){let ne=ae;return this.steps.push(he=>(ne=j(ne,he),ne)),this}latch(j=(ae,ne)=>ae===ne){let ae=!0,ne;return this.steps.push(he=>{const _e=ae||!j(he,ne);return ae=!1,ne=he,_e?he:k}),this}evaluate(j){for(const ae of this.steps)if(j=ae(j),j===k)break;return j}}function B(Y,j,ae=ne=>ne){const ne=(...yt)=>Ve.fire(ae(...yt)),he=()=>Y.on(j,ne),_e=()=>Y.removeListener(j,ne),Ve=new L({onWillAddFirstListener:he,onDidRemoveLastListener:_e});return Ve.event}n.fromNodeEventEmitter=B;function T(Y,j,ae=ne=>ne){const ne=(...yt)=>Ve.fire(ae(...yt)),he=()=>Y.addEventListener(j,ne),_e=()=>Y.removeEventListener(j,ne),Ve=new L({onWillAddFirstListener:he,onDidRemoveLastListener:_e});return Ve.event}n.fromDOMEventEmitter=T;function z(Y,j){return new Promise(ae=>t(Y)(ae,null,j))}n.toPromise=z;function K(Y){const j=new L;return Y.then(ae=>{j.fire(ae)},()=>{j.fire(void 0)}).finally(()=>{j.dispose()}),j.event}n.fromPromise=K;function Ee(Y,j){return Y(ae=>j.fire(ae))}n.forward=Ee;function Q(Y,j,ae){return j(ae),Y(ne=>j(ne))}n.runAndSubscribe=Q;class le{constructor(j,ae){this._observable=j,this._counter=0,this._hasChanged=!1;const ne={onWillAddFirstListener:()=>{j.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{j.removeObserver(this)}};this.emitter=new L(ne),ae&&ae.add(this.emitter)}beginUpdate(j){this._counter++}handlePossibleChange(j){}handleChange(j,ae){this._hasChanged=!0}endUpdate(j){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function Ye(Y,j){return new le(Y,j).emitter.event}n.fromObservable=Ye;function Ce(Y){return(j,ae,ne)=>{let he=0,_e=!1;const Ve={beginUpdate(){he++},endUpdate(){he--,he===0&&(Y.reportChanges(),_e&&(_e=!1,j.call(ae)))},handlePossibleChange(){},handleChange(){_e=!0}};Y.addObserver(Ve),Y.reportChanges();const yt={dispose(){Y.removeObserver(Ve)}};return ne instanceof Ie?ne.add(yt):Array.isArray(ne)&&ne.push(yt),yt}}n.fromObservableLight=Ce})(Ht||(Ht={}));const fc=class fc{constructor(e){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${e}_${fc._idPool++}`,fc.all.add(this)}start(e){this._stopWatch=new Os,this.listenerCount=e}stop(){if(this._stopWatch){const e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}};fc.all=new Set,fc._idPool=0;let $v=fc,dP=-1;const I1=class I1{constructor(e,t,i=(I1._idPool++).toString(16).padStart(3,"0")){this._errorHandler=e,this.threshold=t,this.name=i,this._warnCountdown=0}dispose(){var e;(e=this._stacks)==null||e.clear()}check(e,t){const i=this.threshold;if(i<=0||t<i)return;this._stacks||(this._stacks=new Map);const r=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,r+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=i*.5;const[s,o]=this.getMostFrequentStack(),a=`[${this.name}] potential listener LEAK detected, having ${t} listeners already. MOST frequent listener (${o}):`;console.warn(a),console.warn(s);const l=new hP(a,s);this._errorHandler(l)}return()=>{const s=this._stacks.get(e.value)||0;this._stacks.set(e.value,s-1)}}getMostFrequentStack(){if(!this._stacks)return;let e,t=0;for(const[i,r]of this._stacks)(!e||t<r)&&(e=[i,r],t=r);return e}};I1._idPool=1;let Uv=I1;class ux{static create(){const e=new Error;return new ux(e.stack??"")}constructor(e){this.value=e}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}}class hP extends Error{constructor(e,t){super(e),this.name="ListenerLeakError",this.stack=t}}class fP extends Error{constructor(e,t){super(e),this.name="ListenerRefusalError",this.stack=t}}let pP=0;class Dp{constructor(e){this.value=e,this.id=pP++}}const gP=2,mP=(n,e)=>{if(n instanceof Dp)e(n);else for(let t=0;t<n.length;t++){const i=n[t];i&&e(i)}};class L{constructor(e){var t,i,r,s;this._size=0,this._options=e,this._leakageMon=(t=this._options)!=null&&t.leakWarningThreshold?new Uv((e==null?void 0:e.onListenerError)??Fn,((i=this._options)==null?void 0:i.leakWarningThreshold)??dP):void 0,this._perfMon=(r=this._options)!=null&&r._profName?new $v(this._options._profName):void 0,this._deliveryQueue=(s=this._options)==null?void 0:s.deliveryQueue}dispose(){var e,t,i,r;this._disposed||(this._disposed=!0,((e=this._deliveryQueue)==null?void 0:e.current)===this&&this._deliveryQueue.reset(),this._listeners&&(this._listeners=void 0,this._size=0),(i=(t=this._options)==null?void 0:t.onDidRemoveLastListener)==null||i.call(t),(r=this._leakageMon)==null||r.dispose())}get event(){return this._event??(this._event=(e,t,i)=>{var a,l,c,u,d,f,p;if(this._leakageMon&&this._size>this._leakageMon.threshold**2){const w=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(w);const v=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],m=new fP(`${w}. HINT: Stack shows most frequent listener (${v[1]}-times)`,v[0]);return(((a=this._options)==null?void 0:a.onListenerError)||Fn)(m),Te.None}if(this._disposed)return Te.None;t&&(e=e.bind(t));const r=new Dp(e);let s;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(r.stack=ux.create(),s=this._leakageMon.check(r.stack,this._size+1)),this._listeners?this._listeners instanceof Dp?(this._deliveryQueue??(this._deliveryQueue=new _P),this._listeners=[this._listeners,r]):this._listeners.push(r):((c=(l=this._options)==null?void 0:l.onWillAddFirstListener)==null||c.call(l,this),this._listeners=r,(d=(u=this._options)==null?void 0:u.onDidAddFirstListener)==null||d.call(u,this)),(p=(f=this._options)==null?void 0:f.onDidAddListener)==null||p.call(f,this),this._size++;const o=Se(()=>{s==null||s(),this._removeListener(r)});return i instanceof Ie?i.add(o):Array.isArray(i)&&i.push(o),o}),this._event}_removeListener(e){var s,o,a,l;if((o=(s=this._options)==null?void 0:s.onWillRemoveListener)==null||o.call(s,this),!this._listeners)return;if(this._size===1){this._listeners=void 0,(l=(a=this._options)==null?void 0:a.onDidRemoveLastListener)==null||l.call(a,this),this._size=0;return}const t=this._listeners,i=t.indexOf(e);if(i===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,t[i]=void 0;const r=this._deliveryQueue.current===this;if(this._size*gP<=t.length){let c=0;for(let u=0;u<t.length;u++)t[u]?t[c++]=t[u]:r&&c<this._deliveryQueue.end&&(this._deliveryQueue.end--,c<this._deliveryQueue.i&&this._deliveryQueue.i--);t.length=c}}_deliver(e,t){var r;if(!e)return;const i=((r=this._options)==null?void 0:r.onListenerError)||Fn;if(!i){e.value(t);return}try{e.value(t)}catch(s){i(s)}}_deliverQueue(e){const t=e.current._listeners;for(;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}fire(e){var t,i,r,s;if((t=this._deliveryQueue)!=null&&t.current&&(this._deliverQueue(this._deliveryQueue),(i=this._perfMon)==null||i.stop()),(r=this._perfMon)==null||r.start(this._size),this._listeners)if(this._listeners instanceof Dp)this._deliver(this._listeners,e);else{const o=this._deliveryQueue;o.enqueue(this,e,this._listeners.length),this._deliverQueue(o)}(s=this._perfMon)==null||s.stop()}hasListeners(){return this._size>0}}class _P{constructor(){this.i=-1,this.end=0}enqueue(e,t,i){this.i=0,this.end=i,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}}class Td extends L{async fireAsync(e,t,i){if(this._listeners)for(this._asyncDeliveryQueue||(this._asyncDeliveryQueue=new Hf),mP(this._listeners,r=>this._asyncDeliveryQueue.push([r.value,e]));this._asyncDeliveryQueue.size>0&&!t.isCancellationRequested;){const[r,s]=this._asyncDeliveryQueue.shift(),o=[],a={...s,token:t,waitUntil:l=>{if(Object.isFrozen(o))throw new Error("waitUntil can NOT be called asynchronous");i&&(l=i(l,r)),o.push(l)}};try{r(a)}catch(l){Fn(l);continue}await Promise.allSettled(o).then(l=>{for(const c of l)c.status==="rejected"&&Fn(c.reason)})}}}class Kp extends L{get isPaused(){return this._isPaused!==0}constructor(e){super(e),this._isPaused=0,this._eventQueue=new Hf,this._mergeFn=e==null?void 0:e.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){const e=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(e))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(e){this._size&&(this._isPaused!==0?this._eventQueue.push(e):super.fire(e))}}class vP extends Kp{constructor(e){super(e),this._delay=e.delay??100}fire(e){this._handle||(this.pause(),this._handle=setTimeout(()=>{this._handle=void 0,this.resume()},this._delay)),super.fire(e)}}var dh;(function(n){n[n.Desktop=1]="Desktop",n[n.Web=2]="Web"})(dh||(dh={}));var I2;(function(n){n[n.VersionMismatch=55]="VersionMismatch",n[n.UnexpectedError=81]="UnexpectedError"})(I2||(I2={}));var dr;(function(n){n[n.Initialized=0]="Initialized",n[n.Ready=1]="Ready",n[n.Terminate=2]="Terminate"})(dr||(dr={}));function C2(n){const e=Pe.alloc(1);switch(n){case dr.Initialized:e.writeUInt8(1,0);break;case dr.Ready:e.writeUInt8(2,0);break;case dr.Terminate:e.writeUInt8(3,0);break}return e}function wP(n,e){if(n.byteLength!==1)return!1;switch(n.readUInt8(0)){case 1:return e===dr.Initialized;case 2:return e===dr.Ready;case 3:return e===dr.Terminate;default:return!1}}var P2;(function(n){n.Start="START_NATIVE_LOG",n.End="END_NATIVE_LOG"})(P2||(P2={}));function ev(n){const e=[];typeof n=="number"&&e.push("code/timeOrigin",n);function t(r,s){e.push(r,(s==null?void 0:s.startTime)??Date.now())}function i(){const r=[];for(let s=0;s<e.length;s+=2)r.push({name:e[s],startTime:e[s+1]});return r}return{mark:t,getMarks:i}}function bP(){if(typeof performance=="object"&&typeof performance.mark=="function"&&!performance.nodeTiming)return typeof performance.timeOrigin!="number"&&!performance.timing?ev():{mark(n,e){performance.mark(n,e)},getMarks(){let n=performance.timeOrigin;typeof n!="number"&&(n=performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart);const e=[{name:"code/timeOrigin",startTime:Math.round(n)}];for(const t of performance.getEntriesByType("mark"))e.push({name:t.name,startTime:Math.round(n+t.startTime)});return e}};if(typeof process=="object"){const n=performance==null?void 0:performance.timeOrigin;return ev(n)}else return console.trace("perf-util loaded in UNKNOWN environment"),ev()}function yP(n){return n.MonacoPerformanceMarks||(n.MonacoPerformanceMarks=bP()),n.MonacoPerformanceMarks}const fI=yP(globalThis),ti=fI.mark,xP=fI.getMarks;var P;(function(n){n[n.Null=0]="Null",n[n.Backspace=8]="Backspace",n[n.Tab=9]="Tab",n[n.LineFeed=10]="LineFeed",n[n.CarriageReturn=13]="CarriageReturn",n[n.Space=32]="Space",n[n.ExclamationMark=33]="ExclamationMark",n[n.DoubleQuote=34]="DoubleQuote",n[n.Hash=35]="Hash",n[n.DollarSign=36]="DollarSign",n[n.PercentSign=37]="PercentSign",n[n.Ampersand=38]="Ampersand",n[n.SingleQuote=39]="SingleQuote",n[n.OpenParen=40]="OpenParen",n[n.CloseParen=41]="CloseParen",n[n.Asterisk=42]="Asterisk",n[n.Plus=43]="Plus",n[n.Comma=44]="Comma",n[n.Dash=45]="Dash",n[n.Period=46]="Period",n[n.Slash=47]="Slash",n[n.Digit0=48]="Digit0",n[n.Digit1=49]="Digit1",n[n.Digit2=50]="Digit2",n[n.Digit3=51]="Digit3",n[n.Digit4=52]="Digit4",n[n.Digit5=53]="Digit5",n[n.Digit6=54]="Digit6",n[n.Digit7=55]="Digit7",n[n.Digit8=56]="Digit8",n[n.Digit9=57]="Digit9",n[n.Colon=58]="Colon",n[n.Semicolon=59]="Semicolon",n[n.LessThan=60]="LessThan",n[n.Equals=61]="Equals",n[n.GreaterThan=62]="GreaterThan",n[n.QuestionMark=63]="QuestionMark",n[n.AtSign=64]="AtSign",n[n.A=65]="A",n[n.B=66]="B",n[n.C=67]="C",n[n.D=68]="D",n[n.E=69]="E",n[n.F=70]="F",n[n.G=71]="G",n[n.H=72]="H",n[n.I=73]="I",n[n.J=74]="J",n[n.K=75]="K",n[n.L=76]="L",n[n.M=77]="M",n[n.N=78]="N",n[n.O=79]="O",n[n.P=80]="P",n[n.Q=81]="Q",n[n.R=82]="R",n[n.S=83]="S",n[n.T=84]="T",n[n.U=85]="U",n[n.V=86]="V",n[n.W=87]="W",n[n.X=88]="X",n[n.Y=89]="Y",n[n.Z=90]="Z",n[n.OpenSquareBracket=91]="OpenSquareBracket",n[n.Backslash=92]="Backslash",n[n.CloseSquareBracket=93]="CloseSquareBracket",n[n.Caret=94]="Caret",n[n.Underline=95]="Underline",n[n.BackTick=96]="BackTick",n[n.a=97]="a",n[n.b=98]="b",n[n.c=99]="c",n[n.d=100]="d",n[n.e=101]="e",n[n.f=102]="f",n[n.g=103]="g",n[n.h=104]="h",n[n.i=105]="i",n[n.j=106]="j",n[n.k=107]="k",n[n.l=108]="l",n[n.m=109]="m",n[n.n=110]="n",n[n.o=111]="o",n[n.p=112]="p",n[n.q=113]="q",n[n.r=114]="r",n[n.s=115]="s",n[n.t=116]="t",n[n.u=117]="u",n[n.v=118]="v",n[n.w=119]="w",n[n.x=120]="x",n[n.y=121]="y",n[n.z=122]="z",n[n.OpenCurlyBrace=123]="OpenCurlyBrace",n[n.Pipe=124]="Pipe",n[n.CloseCurlyBrace=125]="CloseCurlyBrace",n[n.Tilde=126]="Tilde",n[n.NoBreakSpace=160]="NoBreakSpace",n[n.U_Combining_Grave_Accent=768]="U_Combining_Grave_Accent",n[n.U_Combining_Acute_Accent=769]="U_Combining_Acute_Accent",n[n.U_Combining_Circumflex_Accent=770]="U_Combining_Circumflex_Accent",n[n.U_Combining_Tilde=771]="U_Combining_Tilde",n[n.U_Combining_Macron=772]="U_Combining_Macron",n[n.U_Combining_Overline=773]="U_Combining_Overline",n[n.U_Combining_Breve=774]="U_Combining_Breve",n[n.U_Combining_Dot_Above=775]="U_Combining_Dot_Above",n[n.U_Combining_Diaeresis=776]="U_Combining_Diaeresis",n[n.U_Combining_Hook_Above=777]="U_Combining_Hook_Above",n[n.U_Combining_Ring_Above=778]="U_Combining_Ring_Above",n[n.U_Combining_Double_Acute_Accent=779]="U_Combining_Double_Acute_Accent",n[n.U_Combining_Caron=780]="U_Combining_Caron",n[n.U_Combining_Vertical_Line_Above=781]="U_Combining_Vertical_Line_Above",n[n.U_Combining_Double_Vertical_Line_Above=782]="U_Combining_Double_Vertical_Line_Above",n[n.U_Combining_Double_Grave_Accent=783]="U_Combining_Double_Grave_Accent",n[n.U_Combining_Candrabindu=784]="U_Combining_Candrabindu",n[n.U_Combining_Inverted_Breve=785]="U_Combining_Inverted_Breve",n[n.U_Combining_Turned_Comma_Above=786]="U_Combining_Turned_Comma_Above",n[n.U_Combining_Comma_Above=787]="U_Combining_Comma_Above",n[n.U_Combining_Reversed_Comma_Above=788]="U_Combining_Reversed_Comma_Above",n[n.U_Combining_Comma_Above_Right=789]="U_Combining_Comma_Above_Right",n[n.U_Combining_Grave_Accent_Below=790]="U_Combining_Grave_Accent_Below",n[n.U_Combining_Acute_Accent_Below=791]="U_Combining_Acute_Accent_Below",n[n.U_Combining_Left_Tack_Below=792]="U_Combining_Left_Tack_Below",n[n.U_Combining_Right_Tack_Below=793]="U_Combining_Right_Tack_Below",n[n.U_Combining_Left_Angle_Above=794]="U_Combining_Left_Angle_Above",n[n.U_Combining_Horn=795]="U_Combining_Horn",n[n.U_Combining_Left_Half_Ring_Below=796]="U_Combining_Left_Half_Ring_Below",n[n.U_Combining_Up_Tack_Below=797]="U_Combining_Up_Tack_Below",n[n.U_Combining_Down_Tack_Below=798]="U_Combining_Down_Tack_Below",n[n.U_Combining_Plus_Sign_Below=799]="U_Combining_Plus_Sign_Below",n[n.U_Combining_Minus_Sign_Below=800]="U_Combining_Minus_Sign_Below",n[n.U_Combining_Palatalized_Hook_Below=801]="U_Combining_Palatalized_Hook_Below",n[n.U_Combining_Retroflex_Hook_Below=802]="U_Combining_Retroflex_Hook_Below",n[n.U_Combining_Dot_Below=803]="U_Combining_Dot_Below",n[n.U_Combining_Diaeresis_Below=804]="U_Combining_Diaeresis_Below",n[n.U_Combining_Ring_Below=805]="U_Combining_Ring_Below",n[n.U_Combining_Comma_Below=806]="U_Combining_Comma_Below",n[n.U_Combining_Cedilla=807]="U_Combining_Cedilla",n[n.U_Combining_Ogonek=808]="U_Combining_Ogonek",n[n.U_Combining_Vertical_Line_Below=809]="U_Combining_Vertical_Line_Below",n[n.U_Combining_Bridge_Below=810]="U_Combining_Bridge_Below",n[n.U_Combining_Inverted_Double_Arch_Below=811]="U_Combining_Inverted_Double_Arch_Below",n[n.U_Combining_Caron_Below=812]="U_Combining_Caron_Below",n[n.U_Combining_Circumflex_Accent_Below=813]="U_Combining_Circumflex_Accent_Below",n[n.U_Combining_Breve_Below=814]="U_Combining_Breve_Below",n[n.U_Combining_Inverted_Breve_Below=815]="U_Combining_Inverted_Breve_Below",n[n.U_Combining_Tilde_Below=816]="U_Combining_Tilde_Below",n[n.U_Combining_Macron_Below=817]="U_Combining_Macron_Below",n[n.U_Combining_Low_Line=818]="U_Combining_Low_Line",n[n.U_Combining_Double_Low_Line=819]="U_Combining_Double_Low_Line",n[n.U_Combining_Tilde_Overlay=820]="U_Combining_Tilde_Overlay",n[n.U_Combining_Short_Stroke_Overlay=821]="U_Combining_Short_Stroke_Overlay",n[n.U_Combining_Long_Stroke_Overlay=822]="U_Combining_Long_Stroke_Overlay",n[n.U_Combining_Short_Solidus_Overlay=823]="U_Combining_Short_Solidus_Overlay",n[n.U_Combining_Long_Solidus_Overlay=824]="U_Combining_Long_Solidus_Overlay",n[n.U_Combining_Right_Half_Ring_Below=825]="U_Combining_Right_Half_Ring_Below",n[n.U_Combining_Inverted_Bridge_Below=826]="U_Combining_Inverted_Bridge_Below",n[n.U_Combining_Square_Below=827]="U_Combining_Square_Below",n[n.U_Combining_Seagull_Below=828]="U_Combining_Seagull_Below",n[n.U_Combining_X_Above=829]="U_Combining_X_Above",n[n.U_Combining_Vertical_Tilde=830]="U_Combining_Vertical_Tilde",n[n.U_Combining_Double_Overline=831]="U_Combining_Double_Overline",n[n.U_Combining_Grave_Tone_Mark=832]="U_Combining_Grave_Tone_Mark",n[n.U_Combining_Acute_Tone_Mark=833]="U_Combining_Acute_Tone_Mark",n[n.U_Combining_Greek_Perispomeni=834]="U_Combining_Greek_Perispomeni",n[n.U_Combining_Greek_Koronis=835]="U_Combining_Greek_Koronis",n[n.U_Combining_Greek_Dialytika_Tonos=836]="U_Combining_Greek_Dialytika_Tonos",n[n.U_Combining_Greek_Ypogegrammeni=837]="U_Combining_Greek_Ypogegrammeni",n[n.U_Combining_Bridge_Above=838]="U_Combining_Bridge_Above",n[n.U_Combining_Equals_Sign_Below=839]="U_Combining_Equals_Sign_Below",n[n.U_Combining_Double_Vertical_Line_Below=840]="U_Combining_Double_Vertical_Line_Below",n[n.U_Combining_Left_Angle_Below=841]="U_Combining_Left_Angle_Below",n[n.U_Combining_Not_Tilde_Above=842]="U_Combining_Not_Tilde_Above",n[n.U_Combining_Homothetic_Above=843]="U_Combining_Homothetic_Above",n[n.U_Combining_Almost_Equal_To_Above=844]="U_Combining_Almost_Equal_To_Above",n[n.U_Combining_Left_Right_Arrow_Below=845]="U_Combining_Left_Right_Arrow_Below",n[n.U_Combining_Upwards_Arrow_Below=846]="U_Combining_Upwards_Arrow_Below",n[n.U_Combining_Grapheme_Joiner=847]="U_Combining_Grapheme_Joiner",n[n.U_Combining_Right_Arrowhead_Above=848]="U_Combining_Right_Arrowhead_Above",n[n.U_Combining_Left_Half_Ring_Above=849]="U_Combining_Left_Half_Ring_Above",n[n.U_Combining_Fermata=850]="U_Combining_Fermata",n[n.U_Combining_X_Below=851]="U_Combining_X_Below",n[n.U_Combining_Left_Arrowhead_Below=852]="U_Combining_Left_Arrowhead_Below",n[n.U_Combining_Right_Arrowhead_Below=853]="U_Combining_Right_Arrowhead_Below",n[n.U_Combining_Right_Arrowhead_And_Up_Arrowhead_Below=854]="U_Combining_Right_Arrowhead_And_Up_Arrowhead_Below",n[n.U_Combining_Right_Half_Ring_Above=855]="U_Combining_Right_Half_Ring_Above",n[n.U_Combining_Dot_Above_Right=856]="U_Combining_Dot_Above_Right",n[n.U_Combining_Asterisk_Below=857]="U_Combining_Asterisk_Below",n[n.U_Combining_Double_Ring_Below=858]="U_Combining_Double_Ring_Below",n[n.U_Combining_Zigzag_Above=859]="U_Combining_Zigzag_Above",n[n.U_Combining_Double_Breve_Below=860]="U_Combining_Double_Breve_Below",n[n.U_Combining_Double_Breve=861]="U_Combining_Double_Breve",n[n.U_Combining_Double_Macron=862]="U_Combining_Double_Macron",n[n.U_Combining_Double_Macron_Below=863]="U_Combining_Double_Macron_Below",n[n.U_Combining_Double_Tilde=864]="U_Combining_Double_Tilde",n[n.U_Combining_Double_Inverted_Breve=865]="U_Combining_Double_Inverted_Breve",n[n.U_Combining_Double_Rightwards_Arrow_Below=866]="U_Combining_Double_Rightwards_Arrow_Below",n[n.U_Combining_Latin_Small_Letter_A=867]="U_Combining_Latin_Small_Letter_A",n[n.U_Combining_Latin_Small_Letter_E=868]="U_Combining_Latin_Small_Letter_E",n[n.U_Combining_Latin_Small_Letter_I=869]="U_Combining_Latin_Small_Letter_I",n[n.U_Combining_Latin_Small_Letter_O=870]="U_Combining_Latin_Small_Letter_O",n[n.U_Combining_Latin_Small_Letter_U=871]="U_Combining_Latin_Small_Letter_U",n[n.U_Combining_Latin_Small_Letter_C=872]="U_Combining_Latin_Small_Letter_C",n[n.U_Combining_Latin_Small_Letter_D=873]="U_Combining_Latin_Small_Letter_D",n[n.U_Combining_Latin_Small_Letter_H=874]="U_Combining_Latin_Small_Letter_H",n[n.U_Combining_Latin_Small_Letter_M=875]="U_Combining_Latin_Small_Letter_M",n[n.U_Combining_Latin_Small_Letter_R=876]="U_Combining_Latin_Small_Letter_R",n[n.U_Combining_Latin_Small_Letter_T=877]="U_Combining_Latin_Small_Letter_T",n[n.U_Combining_Latin_Small_Letter_V=878]="U_Combining_Latin_Small_Letter_V",n[n.U_Combining_Latin_Small_Letter_X=879]="U_Combining_Latin_Small_Letter_X",n[n.LINE_SEPARATOR=8232]="LINE_SEPARATOR",n[n.PARAGRAPH_SEPARATOR=8233]="PARAGRAPH_SEPARATOR",n[n.NEXT_LINE=133]="NEXT_LINE",n[n.U_CIRCUMFLEX=94]="U_CIRCUMFLEX",n[n.U_GRAVE_ACCENT=96]="U_GRAVE_ACCENT",n[n.U_DIAERESIS=168]="U_DIAERESIS",n[n.U_MACRON=175]="U_MACRON",n[n.U_ACUTE_ACCENT=180]="U_ACUTE_ACCENT",n[n.U_CEDILLA=184]="U_CEDILLA",n[n.U_MODIFIER_LETTER_LEFT_ARROWHEAD=706]="U_MODIFIER_LETTER_LEFT_ARROWHEAD",n[n.U_MODIFIER_LETTER_RIGHT_ARROWHEAD=707]="U_MODIFIER_LETTER_RIGHT_ARROWHEAD",n[n.U_MODIFIER_LETTER_UP_ARROWHEAD=708]="U_MODIFIER_LETTER_UP_ARROWHEAD",n[n.U_MODIFIER_LETTER_DOWN_ARROWHEAD=709]="U_MODIFIER_LETTER_DOWN_ARROWHEAD",n[n.U_MODIFIER_LETTER_CENTRED_RIGHT_HALF_RING=722]="U_MODIFIER_LETTER_CENTRED_RIGHT_HALF_RING",n[n.U_MODIFIER_LETTER_CENTRED_LEFT_HALF_RING=723]="U_MODIFIER_LETTER_CENTRED_LEFT_HALF_RING",n[n.U_MODIFIER_LETTER_UP_TACK=724]="U_MODIFIER_LETTER_UP_TACK",n[n.U_MODIFIER_LETTER_DOWN_TACK=725]="U_MODIFIER_LETTER_DOWN_TACK",n[n.U_MODIFIER_LETTER_PLUS_SIGN=726]="U_MODIFIER_LETTER_PLUS_SIGN",n[n.U_MODIFIER_LETTER_MINUS_SIGN=727]="U_MODIFIER_LETTER_MINUS_SIGN",n[n.U_BREVE=728]="U_BREVE",n[n.U_DOT_ABOVE=729]="U_DOT_ABOVE",n[n.U_RING_ABOVE=730]="U_RING_ABOVE",n[n.U_OGONEK=731]="U_OGONEK",n[n.U_SMALL_TILDE=732]="U_SMALL_TILDE",n[n.U_DOUBLE_ACUTE_ACCENT=733]="U_DOUBLE_ACUTE_ACCENT",n[n.U_MODIFIER_LETTER_RHOTIC_HOOK=734]="U_MODIFIER_LETTER_RHOTIC_HOOK",n[n.U_MODIFIER_LETTER_CROSS_ACCENT=735]="U_MODIFIER_LETTER_CROSS_ACCENT",n[n.U_MODIFIER_LETTER_EXTRA_HIGH_TONE_BAR=741]="U_MODIFIER_LETTER_EXTRA_HIGH_TONE_BAR",n[n.U_MODIFIER_LETTER_HIGH_TONE_BAR=742]="U_MODIFIER_LETTER_HIGH_TONE_BAR",n[n.U_MODIFIER_LETTER_MID_TONE_BAR=743]="U_MODIFIER_LETTER_MID_TONE_BAR",n[n.U_MODIFIER_LETTER_LOW_TONE_BAR=744]="U_MODIFIER_LETTER_LOW_TONE_BAR",n[n.U_MODIFIER_LETTER_EXTRA_LOW_TONE_BAR=745]="U_MODIFIER_LETTER_EXTRA_LOW_TONE_BAR",n[n.U_MODIFIER_LETTER_YIN_DEPARTING_TONE_MARK=746]="U_MODIFIER_LETTER_YIN_DEPARTING_TONE_MARK",n[n.U_MODIFIER_LETTER_YANG_DEPARTING_TONE_MARK=747]="U_MODIFIER_LETTER_YANG_DEPARTING_TONE_MARK",n[n.U_MODIFIER_LETTER_UNASPIRATED=749]="U_MODIFIER_LETTER_UNASPIRATED",n[n.U_MODIFIER_LETTER_LOW_DOWN_ARROWHEAD=751]="U_MODIFIER_LETTER_LOW_DOWN_ARROWHEAD",n[n.U_MODIFIER_LETTER_LOW_UP_ARROWHEAD=752]="U_MODIFIER_LETTER_LOW_UP_ARROWHEAD",n[n.U_MODIFIER_LETTER_LOW_LEFT_ARROWHEAD=753]="U_MODIFIER_LETTER_LOW_LEFT_ARROWHEAD",n[n.U_MODIFIER_LETTER_LOW_RIGHT_ARROWHEAD=754]="U_MODIFIER_LETTER_LOW_RIGHT_ARROWHEAD",n[n.U_MODIFIER_LETTER_LOW_RING=755]="U_MODIFIER_LETTER_LOW_RING",n[n.U_MODIFIER_LETTER_MIDDLE_GRAVE_ACCENT=756]="U_MODIFIER_LETTER_MIDDLE_GRAVE_ACCENT",n[n.U_MODIFIER_LETTER_MIDDLE_DOUBLE_GRAVE_ACCENT=757]="U_MODIFIER_LETTER_MIDDLE_DOUBLE_GRAVE_ACCENT",n[n.U_MODIFIER_LETTER_MIDDLE_DOUBLE_ACUTE_ACCENT=758]="U_MODIFIER_LETTER_MIDDLE_DOUBLE_ACUTE_ACCENT",n[n.U_MODIFIER_LETTER_LOW_TILDE=759]="U_MODIFIER_LETTER_LOW_TILDE",n[n.U_MODIFIER_LETTER_RAISED_COLON=760]="U_MODIFIER_LETTER_RAISED_COLON",n[n.U_MODIFIER_LETTER_BEGIN_HIGH_TONE=761]="U_MODIFIER_LETTER_BEGIN_HIGH_TONE",n[n.U_MODIFIER_LETTER_END_HIGH_TONE=762]="U_MODIFIER_LETTER_END_HIGH_TONE",n[n.U_MODIFIER_LETTER_BEGIN_LOW_TONE=763]="U_MODIFIER_LETTER_BEGIN_LOW_TONE",n[n.U_MODIFIER_LETTER_END_LOW_TONE=764]="U_MODIFIER_LETTER_END_LOW_TONE",n[n.U_MODIFIER_LETTER_SHELF=765]="U_MODIFIER_LETTER_SHELF",n[n.U_MODIFIER_LETTER_OPEN_SHELF=766]="U_MODIFIER_LETTER_OPEN_SHELF",n[n.U_MODIFIER_LETTER_LOW_LEFT_ARROW=767]="U_MODIFIER_LETTER_LOW_LEFT_ARROW",n[n.U_GREEK_LOWER_NUMERAL_SIGN=885]="U_GREEK_LOWER_NUMERAL_SIGN",n[n.U_GREEK_TONOS=900]="U_GREEK_TONOS",n[n.U_GREEK_DIALYTIKA_TONOS=901]="U_GREEK_DIALYTIKA_TONOS",n[n.U_GREEK_KORONIS=8125]="U_GREEK_KORONIS",n[n.U_GREEK_PSILI=8127]="U_GREEK_PSILI",n[n.U_GREEK_PERISPOMENI=8128]="U_GREEK_PERISPOMENI",n[n.U_GREEK_DIALYTIKA_AND_PERISPOMENI=8129]="U_GREEK_DIALYTIKA_AND_PERISPOMENI",n[n.U_GREEK_PSILI_AND_VARIA=8141]="U_GREEK_PSILI_AND_VARIA",n[n.U_GREEK_PSILI_AND_OXIA=8142]="U_GREEK_PSILI_AND_OXIA",n[n.U_GREEK_PSILI_AND_PERISPOMENI=8143]="U_GREEK_PSILI_AND_PERISPOMENI",n[n.U_GREEK_DASIA_AND_VARIA=8157]="U_GREEK_DASIA_AND_VARIA",n[n.U_GREEK_DASIA_AND_OXIA=8158]="U_GREEK_DASIA_AND_OXIA",n[n.U_GREEK_DASIA_AND_PERISPOMENI=8159]="U_GREEK_DASIA_AND_PERISPOMENI",n[n.U_GREEK_DIALYTIKA_AND_VARIA=8173]="U_GREEK_DIALYTIKA_AND_VARIA",n[n.U_GREEK_DIALYTIKA_AND_OXIA=8174]="U_GREEK_DIALYTIKA_AND_OXIA",n[n.U_GREEK_VARIA=8175]="U_GREEK_VARIA",n[n.U_GREEK_OXIA=8189]="U_GREEK_OXIA",n[n.U_GREEK_DASIA=8190]="U_GREEK_DASIA",n[n.U_IDEOGRAPHIC_FULL_STOP=12290]="U_IDEOGRAPHIC_FULL_STOP",n[n.U_LEFT_CORNER_BRACKET=12300]="U_LEFT_CORNER_BRACKET",n[n.U_RIGHT_CORNER_BRACKET=12301]="U_RIGHT_CORNER_BRACKET",n[n.U_LEFT_BLACK_LENTICULAR_BRACKET=12304]="U_LEFT_BLACK_LENTICULAR_BRACKET",n[n.U_RIGHT_BLACK_LENTICULAR_BRACKET=12305]="U_RIGHT_BLACK_LENTICULAR_BRACKET",n[n.U_OVERLINE=8254]="U_OVERLINE",n[n.UTF8_BOM=65279]="UTF8_BOM",n[n.U_FULLWIDTH_SEMICOLON=65307]="U_FULLWIDTH_SEMICOLON",n[n.U_FULLWIDTH_COMMA=65292]="U_FULLWIDTH_COMMA"})(P||(P={}));var rt;(function(n){n[n.Uri=1]="Uri",n[n.Regexp=2]="Regexp",n[n.ScmResource=3]="ScmResource",n[n.ScmResourceGroup=4]="ScmResourceGroup",n[n.ScmProvider=5]="ScmProvider",n[n.CommentController=6]="CommentController",n[n.CommentThread=7]="CommentThread",n[n.CommentThreadInstance=8]="CommentThreadInstance",n[n.CommentThreadReply=9]="CommentThreadReply",n[n.CommentNode=10]="CommentNode",n[n.CommentThreadNode=11]="CommentThreadNode",n[n.TimelineActionContext=12]="TimelineActionContext",n[n.NotebookCellActionContext=13]="NotebookCellActionContext",n[n.NotebookActionContext=14]="NotebookActionContext",n[n.TerminalContext=15]="TerminalContext",n[n.TestItemContext=16]="TestItemContext",n[n.Date=17]="Date",n[n.TestMessageMenuArgs=18]="TestMessageMenuArgs",n[n.ChatViewContext=19]="ChatViewContext",n[n.LanguageModelToolResult=20]="LanguageModelToolResult",n[n.LanguageModelTextPart=21]="LanguageModelTextPart",n[n.LanguageModelPromptTsxPart=22]="LanguageModelPromptTsxPart",n[n.LanguageModelDataPart=23]="LanguageModelDataPart"})(rt||(rt={}));function EP(){return globalThis._VSCODE_NLS_MESSAGES}function pI(){return globalThis._VSCODE_NLS_LANGUAGE}const SP=pI()==="pseudo"||typeof document<"u"&&document.location&&typeof document.location.hash=="string"&&document.location.hash.indexOf("pseudo=true")>=0;function eg(n,e){let t;return e.length===0?t=n:t=n.replace(/\{(\d+)\}/g,(i,r)=>{const s=r[0],o=e[s];let a=i;return typeof o=="string"?a=o:(typeof o=="number"||typeof o=="boolean"||o===void 0||o===null)&&(a=String(o)),a}),SP&&(t=""+t.replace(/[aouei]/g,"$&$&")+""),t}function h(n,e,...t){return eg(typeof n=="number"?gI(n,e):e,t)}function gI(n,e){var i;const t=(i=EP())==null?void 0:i[n];if(typeof t!="string"){if(typeof e=="string")return e;throw new Error(`!!! NLS MISSING: ${n} !!!`)}return t}function dx(n,e,...t){let i;typeof n=="number"?i=gI(n,e):i=e;const r=eg(i,t);return{value:r,original:e===i?r:eg(e,t)}}const mo="en";let hh=!1,fh=!1,Ad=!1,mI=!1,hx=!1,fx=!1,_I=!1,vI=!1,rp,kp=mo,T2=mo,DP,qi;const Ps=globalThis;let Tn;var Jk;typeof Ps.vscode<"u"&&typeof Ps.vscode.process<"u"?Tn=Ps.vscode.process:typeof process<"u"&&typeof((Jk=process==null?void 0:process.versions)==null?void 0:Jk.node)=="string"&&(Tn=process);var Xk;const kP=typeof((Xk=Tn==null?void 0:Tn.versions)==null?void 0:Xk.electron)=="string",IP=kP&&(Tn==null?void 0:Tn.type)==="renderer";var Yk;if(typeof Tn=="object"){hh=Tn.platform==="win32",fh=Tn.platform==="darwin",Ad=Tn.platform==="linux",Ad&&Tn.env.SNAP&&Tn.env.SNAP_REVISION,_I=!!Tn.env.CI||!!Tn.env.BUILD_ARTIFACTSTAGINGDIRECTORY,rp=mo,kp=mo;const n=Tn.env.VSCODE_NLS_CONFIG;if(n)try{const e=JSON.parse(n);rp=e.userLocale,T2=e.osLocale,kp=e.resolvedLanguage||mo,DP=(Yk=e.languagePack)==null?void 0:Yk.translationsConfigFile}catch{}mI=!0}else typeof navigator=="object"&&!IP?(qi=navigator.userAgent,hh=qi.indexOf("Windows")>=0,fh=qi.indexOf("Macintosh")>=0,fx=(qi.indexOf("Macintosh")>=0||qi.indexOf("iPad")>=0||qi.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,Ad=qi.indexOf("Linux")>=0,vI=(qi==null?void 0:qi.indexOf("Mobi"))>=0,hx=!0,kp=pI()||mo,rp=navigator.language.toLowerCase(),T2=rp):console.error("Unable to resolve platform.");var ar;(function(n){n[n.Web=0]="Web",n[n.Mac=1]="Mac",n[n.Linux=2]="Linux",n[n.Windows=3]="Windows"})(ar||(ar={}));function CP(n){switch(n){case ar.Web:return"Web";case ar.Mac:return"Mac";case ar.Linux:return"Linux";case ar.Windows:return"Windows"}}ar.Web;fh?ar.Mac:hh?ar.Windows:Ad&&ar.Linux;const ni=hh,Pi=fh,Fs=Ad,wI=mI,Bf=hx,ph=hx&&typeof Ps.importScripts=="function",PP=ph?Ps.origin:void 0,TP=fx,AP=vI,$o=_I,Vr=qi,zs=kp;var A2;(function(n){function e(){return zs}n.value=e;function t(){return zs.length===2?zs==="en":zs.length>=3?zs[0]==="e"&&zs[1]==="n"&&zs[2]==="-":!1}n.isDefaultVariant=t;function i(){return zs==="en"}n.isDefault=i})(A2||(A2={}));const RP=typeof Ps.postMessage=="function"&&!Ps.importScripts,bI=(()=>{if(RP){const n=[];Ps.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let i=0,r=n.length;i<r;i++){const s=n[i];if(s.id===t.data.vscodeScheduleAsyncWork){n.splice(i,1),s.callback();return}}});let e=0;return t=>{const i=++e;n.push({id:i,callback:t}),Ps.postMessage({vscodeScheduleAsyncWork:i},"*")}}return n=>setTimeout(n)})();var Ec;(function(n){n[n.Windows=1]="Windows",n[n.Macintosh=2]="Macintosh",n[n.Linux=3]="Linux"})(Ec||(Ec={}));fh||fx?Ec.Macintosh:hh?Ec.Windows:Ec.Linux;let R2=!0,L2=!1;function yI(){if(!L2){L2=!0;const n=new Uint8Array(2);n[0]=1,n[1]=2,R2=new Uint16Array(n.buffer)[0]===513}return R2}const px=!!(Vr&&Vr.indexOf("Chrome")>=0),LP=!!(Vr&&Vr.indexOf("Firefox")>=0),NP=!!(!px&&Vr&&Vr.indexOf("Safari")>=0),xI=!!(Vr&&Vr.indexOf("Edg/")>=0);Vr&&Vr.indexOf("Android")>=0;var N2={};let Ha;const tv=globalThis.vscode;var Zk;if(typeof tv<"u"&&typeof tv.process<"u"){const n=tv.process;Ha={get platform(){return n.platform},get arch(){return n.arch},get env(){return n.env},cwd(){return n.cwd()}}}else typeof process<"u"&&typeof((Zk=process==null?void 0:process.versions)==null?void 0:Zk.node)=="string"?Ha={get platform(){return process.platform},get arch(){return process.arch},get env(){return N2},cwd(){return N2.VSCODE_CWD||process.cwd()}}:Ha={get platform(){return ni?"win32":Pi?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};const uu=Ha.cwd,du=Ha.env,OP=Ha.platform;Ha.arch;const FP=65,MP=97,$P=90,UP=122,Ba=46,bn=47,ri=92,Yr=58,HP=63;class EI extends Error{constructor(e,t,i){let r;typeof t=="string"&&t.indexOf("not ")===0?(r="must not be",t=t.replace(/^not /,"")):r="must be";const s=e.indexOf(".")!==-1?"property":"argument";let o=`The "${e}" ${s} ${r} of type ${t}`;o+=`. Received type ${typeof i}`,super(o),this.code="ERR_INVALID_ARG_TYPE"}}function BP(n,e){if(n===null||typeof n!="object")throw new EI(e,"Object",n)}function Jt(n,e){if(typeof n!="string")throw new EI(e,"string",n)}const mr=OP==="win32";function ze(n){return n===bn||n===ri}function Hv(n){return n===bn}function Zr(n){return n>=FP&&n<=$P||n>=MP&&n<=UP}function tg(n,e,t,i){let r="",s=0,o=-1,a=0,l=0;for(let c=0;c<=n.length;++c){if(c<n.length)l=n.charCodeAt(c);else{if(i(l))break;l=bn}if(i(l)){if(!(o===c-1||a===1))if(a===2){if(r.length<2||s!==2||r.charCodeAt(r.length-1)!==Ba||r.charCodeAt(r.length-2)!==Ba){if(r.length>2){const u=r.lastIndexOf(t);u===-1?(r="",s=0):(r=r.slice(0,u),s=r.length-1-r.lastIndexOf(t)),o=c,a=0;continue}else if(r.length!==0){r="",s=0,o=c,a=0;continue}}e&&(r+=r.length>0?`${t}..`:"..",s=2)}else r.length>0?r+=`${t}${n.slice(o+1,c)}`:r=n.slice(o+1,c),s=c-o-1;o=c,a=0}else l===Ba&&a!==-1?++a:a=-1}return r}function WP(n){return n?`${n[0]==="."?"":"."}${n}`:""}function SI(n,e){BP(e,"pathObject");const t=e.dir||e.root,i=e.base||`${e.name||""}${WP(e.ext)}`;return t?t===e.root?`${t}${i}`:`${t}${n}${i}`:i}const kn={resolve(...n){let e="",t="",i=!1;for(let r=n.length-1;r>=-1;r--){let s;if(r>=0){if(s=n[r],Jt(s,`paths[${r}]`),s.length===0)continue}else e.length===0?s=uu():(s=du[`=${e}`]||uu(),(s===void 0||s.slice(0,2).toLowerCase()!==e.toLowerCase()&&s.charCodeAt(2)===ri)&&(s=`${e}\\`));const o=s.length;let a=0,l="",c=!1;const u=s.charCodeAt(0);if(o===1)ze(u)&&(a=1,c=!0);else if(ze(u))if(c=!0,ze(s.charCodeAt(1))){let d=2,f=d;for(;d<o&&!ze(s.charCodeAt(d));)d++;if(d<o&&d!==f){const p=s.slice(f,d);for(f=d;d<o&&ze(s.charCodeAt(d));)d++;if(d<o&&d!==f){for(f=d;d<o&&!ze(s.charCodeAt(d));)d++;(d===o||d!==f)&&(l=`\\\\${p}\\${s.slice(f,d)}`,a=d)}}}else a=1;else Zr(u)&&s.charCodeAt(1)===Yr&&(l=s.slice(0,2),a=2,o>2&&ze(s.charCodeAt(2))&&(c=!0,a=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(i){if(e.length>0)break}else if(t=`${s.slice(a)}\\${t}`,i=c,c&&e.length>0)break}return t=tg(t,!i,"\\",ze),i?`${e}\\${t}`:`${e}${t}`||"."},normalize(n){Jt(n,"path");const e=n.length;if(e===0)return".";let t=0,i,r=!1;const s=n.charCodeAt(0);if(e===1)return Hv(s)?"\\":n;if(ze(s))if(r=!0,ze(n.charCodeAt(1))){let a=2,l=a;for(;a<e&&!ze(n.charCodeAt(a));)a++;if(a<e&&a!==l){const c=n.slice(l,a);for(l=a;a<e&&ze(n.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!ze(n.charCodeAt(a));)a++;if(a===e)return`\\\\${c}\\${n.slice(l)}\\`;a!==l&&(i=`\\\\${c}\\${n.slice(l,a)}`,t=a)}}}else t=1;else Zr(s)&&n.charCodeAt(1)===Yr&&(i=n.slice(0,2),t=2,e>2&&ze(n.charCodeAt(2))&&(r=!0,t=3));let o=t<e?tg(n.slice(t),!r,"\\",ze):"";if(o.length===0&&!r&&(o="."),o.length>0&&ze(n.charCodeAt(e-1))&&(o+="\\"),!r&&i===void 0&&n.includes(":")){if(o.length>=2&&Zr(o.charCodeAt(0))&&o.charCodeAt(1)===Yr)return`.\\${o}`;let a=n.indexOf(":");do if(a===e-1||ze(n.charCodeAt(a+1)))return`.\\${o}`;while((a=n.indexOf(":",a+1))!==-1)}return i===void 0?r?`\\${o}`:o:r?`${i}\\${o}`:`${i}${o}`},isAbsolute(n){Jt(n,"path");const e=n.length;if(e===0)return!1;const t=n.charCodeAt(0);return ze(t)||e>2&&Zr(t)&&n.charCodeAt(1)===Yr&&ze(n.charCodeAt(2))},join(...n){if(n.length===0)return".";let e,t;for(let s=0;s<n.length;++s){const o=n[s];Jt(o,"path"),o.length>0&&(e===void 0?e=t=o:e+=`\\${o}`)}if(e===void 0)return".";let i=!0,r=0;if(typeof t=="string"&&ze(t.charCodeAt(0))){++r;const s=t.length;s>1&&ze(t.charCodeAt(1))&&(++r,s>2&&(ze(t.charCodeAt(2))?++r:i=!1))}if(i){for(;r<e.length&&ze(e.charCodeAt(r));)r++;r>=2&&(e=`\\${e.slice(r)}`)}return kn.normalize(e)},relative(n,e){if(Jt(n,"from"),Jt(e,"to"),n===e)return"";const t=kn.resolve(n),i=kn.resolve(e);if(t===i||(n=t.toLowerCase(),e=i.toLowerCase(),n===e))return"";if(t.length!==n.length||i.length!==e.length){const w=t.split("\\"),v=i.split("\\");w[w.length-1]===""&&w.pop(),v[v.length-1]===""&&v.pop();const m=w.length,x=v.length,k=m<x?m:x;let D;for(D=0;D<k&&w[D].toLowerCase()===v[D].toLowerCase();D++);return D===0?i:D===k?x>k?v.slice(D).join("\\"):m>k?"..\\".repeat(m-1-D)+"..":"":"..\\".repeat(m-D)+v.slice(D).join("\\")}let r=0;for(;r<n.length&&n.charCodeAt(r)===ri;)r++;let s=n.length;for(;s-1>r&&n.charCodeAt(s-1)===ri;)s--;const o=s-r;let a=0;for(;a<e.length&&e.charCodeAt(a)===ri;)a++;let l=e.length;for(;l-1>a&&e.charCodeAt(l-1)===ri;)l--;const c=l-a,u=o<c?o:c;let d=-1,f=0;for(;f<u;f++){const w=n.charCodeAt(r+f);if(w!==e.charCodeAt(a+f))break;w===ri&&(d=f)}if(f!==u){if(d===-1)return i}else{if(c>u){if(e.charCodeAt(a+f)===ri)return i.slice(a+f+1);if(f===2)return i.slice(a+f)}o>u&&(n.charCodeAt(r+f)===ri?d=f:f===2&&(d=3)),d===-1&&(d=0)}let p="";for(f=r+d+1;f<=s;++f)(f===s||n.charCodeAt(f)===ri)&&(p+=p.length===0?"..":"\\..");return a+=d,p.length>0?`${p}${i.slice(a,l)}`:(i.charCodeAt(a)===ri&&++a,i.slice(a,l))},toNamespacedPath(n){if(typeof n!="string"||n.length===0)return n;const e=kn.resolve(n);if(e.length<=2)return n;if(e.charCodeAt(0)===ri){if(e.charCodeAt(1)===ri){const t=e.charCodeAt(2);if(t!==HP&&t!==Ba)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(Zr(e.charCodeAt(0))&&e.charCodeAt(1)===Yr&&e.charCodeAt(2)===ri)return`\\\\?\\${e}`;return e},dirname(n){Jt(n,"path");const e=n.length;if(e===0)return".";let t=-1,i=0;const r=n.charCodeAt(0);if(e===1)return ze(r)?n:".";if(ze(r)){if(t=i=1,ze(n.charCodeAt(1))){let a=2,l=a;for(;a<e&&!ze(n.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&ze(n.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!ze(n.charCodeAt(a));)a++;if(a===e)return n;a!==l&&(t=i=a+1)}}}}else Zr(r)&&n.charCodeAt(1)===Yr&&(t=e>2&&ze(n.charCodeAt(2))?3:2,i=t);let s=-1,o=!0;for(let a=e-1;a>=i;--a)if(ze(n.charCodeAt(a))){if(!o){s=a;break}}else o=!1;if(s===-1){if(t===-1)return".";s=t}return n.slice(0,s)},basename(n,e){e!==void 0&&Jt(e,"suffix"),Jt(n,"path");let t=0,i=-1,r=!0,s;if(n.length>=2&&Zr(n.charCodeAt(0))&&n.charCodeAt(1)===Yr&&(t=2),e!==void 0&&e.length>0&&e.length<=n.length){if(e===n)return"";let o=e.length-1,a=-1;for(s=n.length-1;s>=t;--s){const l=n.charCodeAt(s);if(ze(l)){if(!r){t=s+1;break}}else a===-1&&(r=!1,a=s+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(i=s):(o=-1,i=a))}return t===i?i=a:i===-1&&(i=n.length),n.slice(t,i)}for(s=n.length-1;s>=t;--s)if(ze(n.charCodeAt(s))){if(!r){t=s+1;break}}else i===-1&&(r=!1,i=s+1);return i===-1?"":n.slice(t,i)},extname(n){Jt(n,"path");let e=0,t=-1,i=0,r=-1,s=!0,o=0;n.length>=2&&n.charCodeAt(1)===Yr&&Zr(n.charCodeAt(0))&&(e=i=2);for(let a=n.length-1;a>=e;--a){const l=n.charCodeAt(a);if(ze(l)){if(!s){i=a+1;break}continue}r===-1&&(s=!1,r=a+1),l===Ba?t===-1?t=a:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||r===-1||o===0||o===1&&t===r-1&&t===i+1?"":n.slice(t,r)},format:SI.bind(null,"\\"),parse(n){Jt(n,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return e;const t=n.length;let i=0,r=n.charCodeAt(0);if(t===1)return ze(r)?(e.root=e.dir=n,e):(e.base=e.name=n,e);if(ze(r)){if(i=1,ze(n.charCodeAt(1))){let d=2,f=d;for(;d<t&&!ze(n.charCodeAt(d));)d++;if(d<t&&d!==f){for(f=d;d<t&&ze(n.charCodeAt(d));)d++;if(d<t&&d!==f){for(f=d;d<t&&!ze(n.charCodeAt(d));)d++;d===t?i=d:d!==f&&(i=d+1)}}}}else if(Zr(r)&&n.charCodeAt(1)===Yr){if(t<=2)return e.root=e.dir=n,e;if(i=2,ze(n.charCodeAt(2))){if(t===3)return e.root=e.dir=n,e;i=3}}i>0&&(e.root=n.slice(0,i));let s=-1,o=i,a=-1,l=!0,c=n.length-1,u=0;for(;c>=i;--c){if(r=n.charCodeAt(c),ze(r)){if(!l){o=c+1;break}continue}a===-1&&(l=!1,a=c+1),r===Ba?s===-1?s=c:u!==1&&(u=1):s!==-1&&(u=-1)}return a!==-1&&(s===-1||u===0||u===1&&s===a-1&&s===o+1?e.base=e.name=n.slice(o,a):(e.name=n.slice(o,s),e.base=n.slice(o,a),e.ext=n.slice(s,a))),o>0&&o!==i?e.dir=n.slice(0,o-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},VP=(()=>{if(mr){const n=/\\/g;return()=>{const e=uu().replace(n,"/");return e.slice(e.indexOf("/"))}}return()=>uu()})(),ot={resolve(...n){let e="",t=!1;for(let i=n.length-1;i>=0&&!t;i--){const r=n[i];Jt(r,`paths[${i}]`),r.length!==0&&(e=`${r}/${e}`,t=r.charCodeAt(0)===bn)}if(!t){const i=VP();e=`${i}/${e}`,t=i.charCodeAt(0)===bn}return e=tg(e,!t,"/",Hv),t?`/${e}`:e.length>0?e:"."},normalize(n){if(Jt(n,"path"),n.length===0)return".";const e=n.charCodeAt(0)===bn,t=n.charCodeAt(n.length-1)===bn;return n=tg(n,!e,"/",Hv),n.length===0?e?"/":t?"./":".":(t&&(n+="/"),e?`/${n}`:n)},isAbsolute(n){return Jt(n,"path"),n.length>0&&n.charCodeAt(0)===bn},join(...n){if(n.length===0)return".";const e=[];for(let t=0;t<n.length;++t){const i=n[t];Jt(i,"path"),i.length>0&&e.push(i)}return e.length===0?".":ot.normalize(e.join("/"))},relative(n,e){if(Jt(n,"from"),Jt(e,"to"),n===e||(n=ot.resolve(n),e=ot.resolve(e),n===e))return"";const t=1,i=n.length,r=i-t,s=1,o=e.length-s,a=r<o?r:o;let l=-1,c=0;for(;c<a;c++){const d=n.charCodeAt(t+c);if(d!==e.charCodeAt(s+c))break;d===bn&&(l=c)}if(c===a)if(o>a){if(e.charCodeAt(s+c)===bn)return e.slice(s+c+1);if(c===0)return e.slice(s+c)}else r>a&&(n.charCodeAt(t+c)===bn?l=c:c===0&&(l=0));let u="";for(c=t+l+1;c<=i;++c)(c===i||n.charCodeAt(c)===bn)&&(u+=u.length===0?"..":"/..");return`${u}${e.slice(s+l)}`},toNamespacedPath(n){return n},dirname(n){if(Jt(n,"path"),n.length===0)return".";const e=n.charCodeAt(0)===bn;let t=-1,i=!0;for(let r=n.length-1;r>=1;--r)if(n.charCodeAt(r)===bn){if(!i){t=r;break}}else i=!1;return t===-1?e?"/":".":e&&t===1?"//":n.slice(0,t)},basename(n,e){e!==void 0&&Jt(e,"suffix"),Jt(n,"path");let t=0,i=-1,r=!0,s;if(e!==void 0&&e.length>0&&e.length<=n.length){if(e===n)return"";let o=e.length-1,a=-1;for(s=n.length-1;s>=0;--s){const l=n.charCodeAt(s);if(l===bn){if(!r){t=s+1;break}}else a===-1&&(r=!1,a=s+1),o>=0&&(l===e.charCodeAt(o)?--o===-1&&(i=s):(o=-1,i=a))}return t===i?i=a:i===-1&&(i=n.length),n.slice(t,i)}for(s=n.length-1;s>=0;--s)if(n.charCodeAt(s)===bn){if(!r){t=s+1;break}}else i===-1&&(r=!1,i=s+1);return i===-1?"":n.slice(t,i)},extname(n){Jt(n,"path");let e=-1,t=0,i=-1,r=!0,s=0;for(let o=n.length-1;o>=0;--o){const a=n[o];if(a==="/"){if(!r){t=o+1;break}continue}i===-1&&(r=!1,i=o+1),a==="."?e===-1?e=o:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||i===-1||s===0||s===1&&e===i-1&&e===t+1?"":n.slice(e,i)},format:SI.bind(null,"/"),parse(n){Jt(n,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return e;const t=n.charCodeAt(0)===bn;let i;t?(e.root="/",i=1):i=0;let r=-1,s=0,o=-1,a=!0,l=n.length-1,c=0;for(;l>=i;--l){const u=n.charCodeAt(l);if(u===bn){if(!a){s=l+1;break}continue}o===-1&&(a=!1,o=l+1),u===Ba?r===-1?r=l:c!==1&&(c=1):r!==-1&&(c=-1)}if(o!==-1){const u=s===0&&t?1:s;r===-1||c===0||c===1&&r===o-1&&r===s+1?e.base=e.name=n.slice(u,o):(e.name=n.slice(u,r),e.base=n.slice(u,o),e.ext=n.slice(r,o))}return s>0?e.dir=n.slice(0,s-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};ot.win32=kn.win32=kn;ot.posix=kn.posix=ot;const hu=mr?kn.normalize:ot.normalize,ng=mr?kn.isAbsolute:ot.isAbsolute,Bv=mr?kn.join:ot.join,zP=mr?kn.resolve:ot.resolve,gh=mr?kn.relative:ot.relative,Sc=mr?kn.dirname:ot.dirname,ci=mr?kn.basename:ot.basename,Wv=mr?kn.extname:ot.extname;mr?kn.parse:ot.parse;const hr=mr?kn.sep:ot.sep,qP=/^\w[\w\d+.-]*$/,jP=/^\//,GP=/^\/\//;function QP(n,e){if(!n.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${n.authority}", path: "${n.path}", query: "${n.query}", fragment: "${n.fragment}"}`);if(n.scheme&&!qP.test(n.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(n.path){if(n.authority){if(!jP.test(n.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(GP.test(n.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function JP(n,e){return!n&&!e?"file":n}function XP(n,e){switch(n){case"https":case"http":case"file":e?e[0]!==ir&&(e=ir+e):e=ir;break}return e}const It="",ir="/",YP=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class y{static isUri(e){return e instanceof y?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}constructor(e,t,i,r,s,o=!1){typeof e=="object"?(this.scheme=e.scheme||It,this.authority=e.authority||It,this.path=e.path||It,this.query=e.query||It,this.fragment=e.fragment||It):(this.scheme=JP(e,o),this.authority=t||It,this.path=XP(this.scheme,i||It),this.query=r||It,this.fragment=s||It,QP(this,o))}get fsPath(){return ig(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:i,path:r,query:s,fragment:o}=e;return t===void 0?t=this.scheme:t===null&&(t=It),i===void 0?i=this.authority:i===null&&(i=It),r===void 0?r=this.path:r===null&&(r=It),s===void 0?s=this.query:s===null&&(s=It),o===void 0?o=this.fragment:o===null&&(o=It),t===this.scheme&&i===this.authority&&r===this.path&&s===this.query&&o===this.fragment?this:new Ul(t,i,r,s,o)}static parse(e,t=!1){const i=YP.exec(e);return i?new Ul(i[2]||It,sp(i[4]||It),sp(i[5]||It),sp(i[7]||It),sp(i[9]||It),t):new Ul(It,It,It,It,It)}static file(e){let t=It;if(ni&&(e=e.replace(/\\/g,ir)),e[0]===ir&&e[1]===ir){const i=e.indexOf(ir,2);i===-1?(t=e.substring(2),e=ir):(t=e.substring(2,i),e=e.substring(i)||ir)}return new Ul("file",t,e,It,It)}static from(e,t){return new Ul(e.scheme,e.authority,e.path,e.query,e.fragment,t)}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let i;return ni&&e.scheme==="file"?i=y.file(kn.join(ig(e,!0),...t)).path:i=ot.join(e.path,...t),e.with({path:i})}toString(e=!1){return Vv(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof y)return e;{const t=new Ul(e);return t._formatted=e.external??null,t._fsPath=e._sep===DI?e.fsPath??null:null,t}}else return e}[Symbol.for("debug.description")](){return`URI(${this.toString()})`}}function O2(n){return!n||typeof n!="object"?!1:typeof n.scheme=="string"&&(typeof n.authority=="string"||typeof n.authority>"u")&&(typeof n.path=="string"||typeof n.path>"u")&&(typeof n.query=="string"||typeof n.query>"u")&&(typeof n.fragment=="string"||typeof n.fragment>"u")}const DI=ni?1:void 0;class Ul extends y{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=ig(this,!1)),this._fsPath}toString(e=!1){return e?Vv(this,!0):(this._formatted||(this._formatted=Vv(this,!1)),this._formatted)}toJSON(){const e={$mid:rt.Uri};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=DI),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}}const kI={[P.Colon]:"%3A",[P.Slash]:"%2F",[P.QuestionMark]:"%3F",[P.Hash]:"%23",[P.OpenSquareBracket]:"%5B",[P.CloseSquareBracket]:"%5D",[P.AtSign]:"%40",[P.ExclamationMark]:"%21",[P.DollarSign]:"%24",[P.Ampersand]:"%26",[P.SingleQuote]:"%27",[P.OpenParen]:"%28",[P.CloseParen]:"%29",[P.Asterisk]:"%2A",[P.Plus]:"%2B",[P.Comma]:"%2C",[P.Semicolon]:"%3B",[P.Equals]:"%3D",[P.Space]:"%20"};function F2(n,e,t){let i,r=-1;for(let s=0;s<n.length;s++){const o=n.charCodeAt(s);if(o>=P.a&&o<=P.z||o>=P.A&&o<=P.Z||o>=P.Digit0&&o<=P.Digit9||o===P.Dash||o===P.Period||o===P.Underline||o===P.Tilde||e&&o===P.Slash||t&&o===P.OpenSquareBracket||t&&o===P.CloseSquareBracket||t&&o===P.Colon)r!==-1&&(i+=encodeURIComponent(n.substring(r,s)),r=-1),i!==void 0&&(i+=n.charAt(s));else{i===void 0&&(i=n.substr(0,s));const a=kI[o];a!==void 0?(r!==-1&&(i+=encodeURIComponent(n.substring(r,s)),r=-1),i+=a):r===-1&&(r=s)}}return r!==-1&&(i+=encodeURIComponent(n.substring(r))),i!==void 0?i:n}function ZP(n){let e;for(let t=0;t<n.length;t++){const i=n.charCodeAt(t);i===P.Hash||i===P.QuestionMark?(e===void 0&&(e=n.substr(0,t)),e+=kI[i]):e!==void 0&&(e+=n[t])}return e!==void 0?e:n}function ig(n,e){let t;return n.authority&&n.path.length>1&&n.scheme==="file"?t=`//${n.authority}${n.path}`:n.path.charCodeAt(0)===P.Slash&&(n.path.charCodeAt(1)>=P.A&&n.path.charCodeAt(1)<=P.Z||n.path.charCodeAt(1)>=P.a&&n.path.charCodeAt(1)<=P.z)&&n.path.charCodeAt(2)===P.Colon?e?t=n.path.substr(1):t=n.path[1].toLowerCase()+n.path.substr(2):t=n.path,ni&&(t=t.replace(/\//g,"\\")),t}function Vv(n,e){const t=e?ZP:F2;let i="",{scheme:r,authority:s,path:o,query:a,fragment:l}=n;if(r&&(i+=r,i+=":"),(s||r==="file")&&(i+=ir,i+=ir),s){let c=s.indexOf("@");if(c!==-1){const u=s.substr(0,c);s=s.substr(c+1),c=u.lastIndexOf(":"),c===-1?i+=t(u,!1,!1):(i+=t(u.substr(0,c),!1,!1),i+=":",i+=t(u.substr(c+1),!1,!0)),i+="@"}s=s.toLowerCase(),c=s.lastIndexOf(":"),c===-1?i+=t(s,!1,!0):(i+=t(s.substr(0,c),!1,!0),i+=s.substr(c))}if(o){if(o.length>=3&&o.charCodeAt(0)===P.Slash&&o.charCodeAt(2)===P.Colon){const c=o.charCodeAt(1);c>=P.A&&c<=P.Z&&(o=`/${String.fromCharCode(c+32)}:${o.substr(3)}`)}else if(o.length>=2&&o.charCodeAt(1)===P.Colon){const c=o.charCodeAt(0);c>=P.A&&c<=P.Z&&(o=`${String.fromCharCode(c+32)}:${o.substr(2)}`)}i+=t(o,!0,!1)}return a&&(i+="?",i+=t(a,!1,!1)),l&&(i+="#",i+=e?l:F2(l,!1,!1)),i}function II(n){try{return decodeURIComponent(n)}catch{return n.length>3?n.substr(0,3)+II(n.substr(3)):n}}const M2=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function sp(n){return n.match(M2)?n.replace(M2,e=>II(e)):n}const C1=class C1{constructor(e){this._proxyIdentifierBrand=void 0,this.sid=e,this.nid=++C1.count}};C1.count=0;let rg=C1;const CI=[];function H(n){const e=new rg(n);return CI[e.nid]=e,e}function op(n){return CI[n].sid}class hi{constructor(e){this.value=e}}var $2;(function(n){n[n.Default=0]="Default",n[n.InCenter=1]="InCenter",n[n.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",n[n.AtTop=3]="AtTop"})($2||($2={}));var vi;(function(n){n[n.UnknownInput=0]="UnknownInput",n[n.TextInput=1]="TextInput",n[n.TextDiffInput=2]="TextDiffInput",n[n.TextMergeInput=3]="TextMergeInput",n[n.NotebookInput=4]="NotebookInput",n[n.NotebookDiffInput=5]="NotebookDiffInput",n[n.CustomEditorInput=6]="CustomEditorInput",n[n.WebviewEditorInput=7]="WebviewEditorInput",n[n.TerminalEditorInput=8]="TerminalEditorInput",n[n.InteractiveEditorInput=9]="InteractiveEditorInput",n[n.ChatEditorInput=10]="ChatEditorInput",n[n.MultiDiffEditorInput=11]="MultiDiffEditorInput"})(vi||(vi={}));var xs;(function(n){n[n.TAB_OPEN=0]="TAB_OPEN",n[n.TAB_CLOSE=1]="TAB_CLOSE",n[n.TAB_UPDATE=2]="TAB_UPDATE",n[n.TAB_MOVE=3]="TAB_MOVE"})(xs||(xs={}));var U2;(function(n){n[n.Editable=0]="Editable",n[n.SupportsHotExit=1]="SupportsHotExit"})(U2||(U2={}));var Ut;(function(n){n[n.Int8Array=1]="Int8Array",n[n.Uint8Array=2]="Uint8Array",n[n.Uint8ClampedArray=3]="Uint8ClampedArray",n[n.Int16Array=4]="Int16Array",n[n.Uint16Array=5]="Uint16Array",n[n.Int32Array=6]="Int32Array",n[n.Uint32Array=7]="Uint32Array",n[n.Float32Array=8]="Float32Array",n[n.Float64Array=9]="Float64Array",n[n.BigInt64Array=10]="BigInt64Array",n[n.BigUint64Array=11]="BigUint64Array"})(Ut||(Ut={}));var H2;(function(n){n[n.Text=1]="Text",n[n.Error=2]="Error",n[n.Rich=3]="Rich"})(H2||(H2={}));var B2;(function(n){n[n.Default=0]="Default",n[n.InCenter=1]="InCenter",n[n.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",n[n.AtTop=3]="AtTop"})(B2||(B2={}));var zv;(function(n){n[n.None=0]="None",n[n.Process=1]="Process",n[n.Output=2]="Output",n[n.Hybrid=3]="Hybrid"})(zv||(zv={}));var Fe;(function(n){n.label="a",n.kind="b",n.detail="c",n.documentation="d",n.sortText="e",n.filterText="f",n.preselect="g",n.insertText="h",n.insertTextRules="i",n.range="j",n.commitCharacters="k",n.additionalTextEdits="l",n.kindModifier="m",n.commandIdent="n",n.commandId="o",n.commandArguments="p"})(Fe||(Fe={}));var Zl;(function(n){n.defaultRanges="a",n.completions="b",n.isIncomplete="c",n.duration="d"})(Zl||(Zl={}));var W2;(function(n){n[n.Workspace=0]="Workspace",n[n.TextDocument=1]="TextDocument"})(W2||(W2={}));const Z={MainThreadAuthentication:H("MainThreadAuthentication"),MainThreadBulkEdits:H("MainThreadBulkEdits"),MainThreadLanguageModels:H("MainThreadLanguageModels"),MainThreadEmbeddings:H("MainThreadEmbeddings"),MainThreadChatAgents2:H("MainThreadChatAgents2"),MainThreadCodeMapper:H("MainThreadCodeMapper"),MainThreadLanguageModelTools:H("MainThreadChatSkills"),MainThreadClipboard:H("MainThreadClipboard"),MainThreadCommands:H("MainThreadCommands"),MainThreadComments:H("MainThreadComments"),MainThreadConfiguration:H("MainThreadConfiguration"),MainThreadConsole:H("MainThreadConsole"),MainThreadDebugService:H("MainThreadDebugService"),MainThreadDecorations:H("MainThreadDecorations"),MainThreadDiagnostics:H("MainThreadDiagnostics"),MainThreadDialogs:H("MainThreadDiaglogs"),MainThreadDocuments:H("MainThreadDocuments"),MainThreadDocumentContentProviders:H("MainThreadDocumentContentProviders"),MainThreadTextEditors:H("MainThreadTextEditors"),MainThreadEditorInsets:H("MainThreadEditorInsets"),MainThreadEditorTabs:H("MainThreadEditorTabs"),MainThreadErrors:H("MainThreadErrors"),MainThreadTreeViews:H("MainThreadTreeViews"),MainThreadDownloadService:H("MainThreadDownloadService"),MainThreadLanguageFeatures:H("MainThreadLanguageFeatures"),MainThreadLanguages:H("MainThreadLanguages"),MainThreadLogger:H("MainThreadLogger"),MainThreadMessageService:H("MainThreadMessageService"),MainThreadOutputService:H("MainThreadOutputService"),MainThreadProgress:H("MainThreadProgress"),MainThreadQuickDiff:H("MainThreadQuickDiff"),MainThreadQuickOpen:H("MainThreadQuickOpen"),MainThreadStatusBar:H("MainThreadStatusBar"),MainThreadSecretState:H("MainThreadSecretState"),MainThreadStorage:H("MainThreadStorage"),MainThreadSpeech:H("MainThreadSpeechProvider"),MainThreadTelemetry:H("MainThreadTelemetry"),MainThreadTerminalService:H("MainThreadTerminalService"),MainThreadTerminalShellIntegration:H("MainThreadTerminalShellIntegration"),MainThreadWebviews:H("MainThreadWebviews"),MainThreadWebviewPanels:H("MainThreadWebviewPanels"),MainThreadWebviewViews:H("MainThreadWebviewViews"),MainThreadCustomEditors:H("MainThreadCustomEditors"),MainThreadUrls:H("MainThreadUrls"),MainThreadUriOpeners:H("MainThreadUriOpeners"),MainThreadProfileContentHandlers:H("MainThreadProfileContentHandlers"),MainThreadWorkspace:H("MainThreadWorkspace"),MainThreadFileSystem:H("MainThreadFileSystem"),MainThreadFileSystemEventService:H("MainThreadFileSystemEventService"),MainThreadExtensionService:H("MainThreadExtensionService"),MainThreadSCM:H("MainThreadSCM"),MainThreadSearch:H("MainThreadSearch"),MainThreadShare:H("MainThreadShare"),MainThreadTask:H("MainThreadTask"),MainThreadWindow:H("MainThreadWindow"),MainThreadLabelService:H("MainThreadLabelService"),MainThreadNotebook:H("MainThreadNotebook"),MainThreadNotebookDocuments:H("MainThreadNotebookDocumentsShape"),MainThreadNotebookEditors:H("MainThreadNotebookEditorsShape"),MainThreadNotebookKernels:H("MainThreadNotebookKernels"),MainThreadNotebookRenderers:H("MainThreadNotebookRenderers"),MainThreadInteractive:H("MainThreadInteractive"),MainThreadTheming:H("MainThreadTheming"),MainThreadTunnelService:H("MainThreadTunnelService"),MainThreadManagedSockets:H("MainThreadManagedSockets"),MainThreadTimeline:H("MainThreadTimeline"),MainThreadTesting:H("MainThreadTesting"),MainThreadLocalization:H("MainThreadLocalizationShape"),MainThreadMcp:H("MainThreadMcpShape"),MainThreadAiRelatedInformation:H("MainThreadAiRelatedInformation"),MainThreadAiEmbeddingVector:H("MainThreadAiEmbeddingVector"),MainThreadChatStatus:H("MainThreadChatStatus")},de={ExtHostCodeMapper:H("ExtHostCodeMapper"),ExtHostCommands:H("ExtHostCommands"),ExtHostConfiguration:H("ExtHostConfiguration"),ExtHostDiagnostics:H("ExtHostDiagnostics"),ExtHostDebugService:H("ExtHostDebugService"),ExtHostDecorations:H("ExtHostDecorations"),ExtHostDocumentsAndEditors:H("ExtHostDocumentsAndEditors"),ExtHostDocuments:H("ExtHostDocuments"),ExtHostDocumentContentProviders:H("ExtHostDocumentContentProviders"),ExtHostDocumentSaveParticipant:H("ExtHostDocumentSaveParticipant"),ExtHostEditors:H("ExtHostEditors"),ExtHostTreeViews:H("ExtHostTreeViews"),ExtHostFileSystem:H("ExtHostFileSystem"),ExtHostFileSystemInfo:H("ExtHostFileSystemInfo"),ExtHostFileSystemEventService:H("ExtHostFileSystemEventService"),ExtHostLanguages:H("ExtHostLanguages"),ExtHostLanguageFeatures:H("ExtHostLanguageFeatures"),ExtHostQuickOpen:H("ExtHostQuickOpen"),ExtHostQuickDiff:H("ExtHostQuickDiff"),ExtHostStatusBar:H("ExtHostStatusBar"),ExtHostShare:H("ExtHostShare"),ExtHostExtensionService:H("ExtHostExtensionService"),ExtHostLogLevelServiceShape:H("ExtHostLogLevelServiceShape"),ExtHostTerminalService:H("ExtHostTerminalService"),ExtHostTerminalShellIntegration:H("ExtHostTerminalShellIntegration"),ExtHostSCM:H("ExtHostSCM"),ExtHostSearch:H("ExtHostSearch"),ExtHostTask:H("ExtHostTask"),ExtHostWorkspace:H("ExtHostWorkspace"),ExtHostWindow:H("ExtHostWindow"),ExtHostWebviews:H("ExtHostWebviews"),ExtHostWebviewPanels:H("ExtHostWebviewPanels"),ExtHostCustomEditors:H("ExtHostCustomEditors"),ExtHostWebviewViews:H("ExtHostWebviewViews"),ExtHostEditorInsets:H("ExtHostEditorInsets"),ExtHostEditorTabs:H("ExtHostEditorTabs"),ExtHostProgress:H("ExtHostProgress"),ExtHostComments:H("ExtHostComments"),ExtHostSecretState:H("ExtHostSecretState"),ExtHostStorage:H("ExtHostStorage"),ExtHostUrls:H("ExtHostUrls"),ExtHostUriOpeners:H("ExtHostUriOpeners"),ExtHostProfileContentHandlers:H("ExtHostProfileContentHandlers"),ExtHostOutputService:H("ExtHostOutputService"),ExtHostLabelService:H("ExtHostLabelService"),ExtHostNotebook:H("ExtHostNotebook"),ExtHostNotebookDocuments:H("ExtHostNotebookDocuments"),ExtHostNotebookEditors:H("ExtHostNotebookEditors"),ExtHostNotebookKernels:H("ExtHostNotebookKernels"),ExtHostNotebookRenderers:H("ExtHostNotebookRenderers"),ExtHostNotebookDocumentSaveParticipant:H("ExtHostNotebookDocumentSaveParticipant"),ExtHostInteractive:H("ExtHostInteractive"),ExtHostChatAgents2:H("ExtHostChatAgents"),ExtHostLanguageModelTools:H("ExtHostChatSkills"),ExtHostChatProvider:H("ExtHostChatProvider"),ExtHostSpeech:H("ExtHostSpeech"),ExtHostEmbeddings:H("ExtHostEmbeddings"),ExtHostAiRelatedInformation:H("ExtHostAiRelatedInformation"),ExtHostAiEmbeddingVector:H("ExtHostAiEmbeddingVector"),ExtHostTheming:H("ExtHostTheming"),ExtHostTunnelService:H("ExtHostTunnelService"),ExtHostManagedSockets:H("ExtHostManagedSockets"),ExtHostAuthentication:H("ExtHostAuthentication"),ExtHostTimeline:H("ExtHostTimeline"),ExtHostTesting:H("ExtHostTesting"),ExtHostTelemetry:H("ExtHostTelemetry"),ExtHostLocalization:H("ExtHostLocalization"),ExtHostMcp:H("ExtHostMcp")},PI=Object.freeze(function(n,e){const t=setTimeout(n.bind(e),0);return{dispose(){clearTimeout(t)}}});var Pt;(function(n){function e(t){return t===n.None||t===n.Cancelled||t instanceof Ip?!0:!t||typeof t!="object"?!1:typeof t.isCancellationRequested=="boolean"&&typeof t.onCancellationRequested=="function"}n.isCancellationToken=e,n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Ht.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:PI})})(Pt||(Pt={}));class Ip{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?PI:(this._emitter||(this._emitter=new L),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}}class Bt{constructor(e){this._token=void 0,this._parentListener=void 0,this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new Ip),this._token}cancel(){this._token?this._token instanceof Ip&&this._token.cancel():this._token=Pt.Cancelled}dispose(e=!1){var t;e&&this.cancel(),(t=this._parentListener)==null||t.dispose(),this._token?this._token instanceof Ip&&this._token.dispose():this._token=Pt.None}}function KP(n){return n}class e9{constructor(e,t){this.lastCache=void 0,this.lastArgKey=void 0,typeof e=="function"?(this._fn=e,this._computeKey=KP):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){const t=this._computeKey(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this._fn(e)),this.lastCache}}var Wn;(function(n){n[n.MAX_SAFE_SMALL_INTEGER=1073741824]="MAX_SAFE_SMALL_INTEGER",n[n.MIN_SAFE_SMALL_INTEGER=-1073741824]="MIN_SAFE_SMALL_INTEGER",n[n.MAX_UINT_8=255]="MAX_UINT_8",n[n.MAX_UINT_16=65535]="MAX_UINT_16",n[n.MAX_UINT_32=4294967295]="MAX_UINT_32",n[n.UNICODE_SUPPLEMENTARY_PLANE_BEGIN=65536]="UNICODE_SUPPLEMENTARY_PLANE_BEGIN"})(Wn||(Wn={}));function V2(n){return n<0?0:n>Wn.MAX_UINT_8?Wn.MAX_UINT_8:n|0}function Hl(n){return n<0?0:n>Wn.MAX_UINT_32?Wn.MAX_UINT_32:n|0}function mh(n){return!n||typeof n!="string"?!0:n.trim().length===0}const t9=/{([^}]+)}/g;function z2(n,e){return Object.keys(e).length===0?n:n.replace(t9,(t,i)=>e[i]??t)}function hl(n){return n.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function n9(n,e){let t=0,i=n.indexOf(e);for(;i!==-1;)t++,i=n.indexOf(e,i+e.length);return t}function i9(n,e){if(!n||!e)return n;const t=e.length;if(t===0||n.length===0)return n;let i=0;for(;n.indexOf(e,i)===i;)i=i+t;return n.substring(i)}function qv(n,e){if(!n||!e)return n;const t=e.length,i=n.length;if(t===0||i===0)return n;let r=i,s=-1;for(;s=n.lastIndexOf(e,r-1),!(s===-1||s+t!==r);){if(s===0)return"";r=s}return n.substring(0,r)}function r9(n,e,t={}){if(!n)throw new Error("Cannot create regex from empty string");e||(n=hl(n)),t.wholeWord&&(/\B/.test(n.charAt(0))||(n="\\b"+n),/\B/.test(n.charAt(n.length-1))||(n=n+"\\b"));let i="";return t.global&&(i+="g"),t.matchCase||(i+="i"),t.multiline&&(i+="m"),t.unicode&&(i+="u"),new RegExp(n,i)}function TI(n){return n.source==="^"||n.source==="^$"||n.source==="$"||n.source==="^\\s*$"?!1:!!(n.exec("")&&n.lastIndex===0)}function AI(n){return n.split(/\r\n|\r|\n/)}function nv(n){for(let e=0,t=n.length;e<t;e++){const i=n.charCodeAt(e);if(i!==P.Space&&i!==P.Tab)return e}return-1}function s9(n,e=n.length-1){for(let t=e;t>=0;t--){const i=n.charCodeAt(t);if(i!==P.Space&&i!==P.Tab)return t}return-1}function fl(n,e){return n<e?-1:n>e?1:0}function gx(n,e,t=0,i=n.length,r=0,s=e.length){for(;t<i&&r<s;t++,r++){const l=n.charCodeAt(t),c=e.charCodeAt(r);if(l<c)return-1;if(l>c)return 1}const o=i-t,a=s-r;return o<a?-1:o>a?1:0}function q2(n,e){return Wf(n,e,0,n.length,0,e.length)}function Wf(n,e,t=0,i=n.length,r=0,s=e.length){for(;t<i&&r<s;t++,r++){let l=n.charCodeAt(t),c=e.charCodeAt(r);if(l===c)continue;if(l>=128||c>=128)return gx(n.toLowerCase(),e.toLowerCase(),t,i,r,s);j2(l)&&(l-=32),j2(c)&&(c-=32);const u=l-c;if(u!==0)return u}const o=i-t,a=s-r;return o<a?-1:o>a?1:0}function j2(n){return n>=P.a&&n<=P.z}function ca(n,e){return n.length===e.length&&Wf(n,e)===0}function mx(n,e){const t=e.length;return e.length>n.length?!1:Wf(n,e,0,t)===0}function o9(n,e){const t=Math.min(n.length,e.length);let i;for(i=0;i<t;i++)if(n.charCodeAt(i)!==e.charCodeAt(i))return i;return t}function i_(n){return 55296<=n&&n<=56319}function sg(n){return 56320<=n&&n<=57343}function _x(n,e){return(n-55296<<10)+(e-56320)+65536}function RI(n,e,t){const i=n.charCodeAt(t);if(i_(i)&&t+1<e){const r=n.charCodeAt(t+1);if(sg(r))return _x(i,r)}return i}function a9(n,e){const t=n.charCodeAt(e-1);if(sg(t)&&e>1){const i=n.charCodeAt(e-2);if(i_(i))return _x(i,t)}return t}class l9{get offset(){return this._offset}constructor(e,t=0){this._str=e,this._len=e.length,this._offset=t}setOffset(e){this._offset=e}prevCodePoint(){const e=a9(this._str,this._offset);return this._offset-=e>=Wn.UNICODE_SUPPLEMENTARY_PLANE_BEGIN?2:1,e}nextCodePoint(){const e=RI(this._str,this._len,this._offset);return this._offset+=e>=Wn.UNICODE_SUPPLEMENTARY_PLANE_BEGIN?2:1,e}eol(){return this._offset>=this._len}}class c9{get offset(){return this._iterator.offset}constructor(e,t=0){this._iterator=new l9(e,t)}nextGraphemeLength(){const e=og.getInstance(),t=this._iterator,i=t.offset;let r=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){const s=t.offset,o=e.getGraphemeBreakType(t.nextCodePoint());if(J2(r,o)){t.setOffset(s);break}r=o}return t.offset-i}prevGraphemeLength(){const e=og.getInstance(),t=this._iterator,i=t.offset;let r=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){const s=t.offset,o=e.getGraphemeBreakType(t.prevCodePoint());if(J2(o,r)){t.setOffset(s);break}r=o}return i-t.offset}eol(){return this._iterator.eol()}}function G2(n,e){return new c9(n,e).nextGraphemeLength()}let iv;function u9(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function LI(n){return iv||(iv=u9()),iv.test(n)}const d9=/^[\t\n\r\x20-\x7E]*$/;function h9(n){return d9.test(n)}const f9=/[\u2028\u2029]/;function NI(n){return f9.test(n)}const p9=String.fromCharCode(P.UTF8_BOM);function g9(n){return!!(n&&n.length>0&&n.charCodeAt(0)===P.UTF8_BOM)}function Q2(n,e=!1){return n?(e&&(n=n.replace(/\\./g,"")),n.toLowerCase()!==n):!1}function m9(n,e=1){if(e===0)return"";let t=-1;do t=n.indexOf(`
`,t+1),e--;while(e>0&&t>=0);return t===-1?n:(n[t-1]==="\r"&&t--,n.substr(0,t))}function J2(n,e){return n===Qe.Other?e!==Qe.Extend&&e!==Qe.SpacingMark:n===Qe.CR&&e===Qe.LF?!1:n===Qe.Control||n===Qe.CR||n===Qe.LF||e===Qe.Control||e===Qe.CR||e===Qe.LF?!0:!(n===Qe.L&&(e===Qe.L||e===Qe.V||e===Qe.LV||e===Qe.LVT)||(n===Qe.LV||n===Qe.V)&&(e===Qe.V||e===Qe.T)||(n===Qe.LVT||n===Qe.T)&&e===Qe.T||e===Qe.Extend||e===Qe.ZWJ||e===Qe.SpacingMark||n===Qe.Prepend||n===Qe.ZWJ&&e===Qe.Extended_Pictographic||n===Qe.Regional_Indicator&&e===Qe.Regional_Indicator)}var Qe;(function(n){n[n.Other=0]="Other",n[n.Prepend=1]="Prepend",n[n.CR=2]="CR",n[n.LF=3]="LF",n[n.Control=4]="Control",n[n.Extend=5]="Extend",n[n.Regional_Indicator=6]="Regional_Indicator",n[n.SpacingMark=7]="SpacingMark",n[n.L=8]="L",n[n.V=9]="V",n[n.T=10]="T",n[n.LV=11]="LV",n[n.LVT=12]="LVT",n[n.ZWJ=13]="ZWJ",n[n.Extended_Pictographic=14]="Extended_Pictographic"})(Qe||(Qe={}));const na=class na{static getInstance(){return na._INSTANCE||(na._INSTANCE=new na),na._INSTANCE}constructor(){this._data=_9()}getGraphemeBreakType(e){if(e<32)return e===P.LineFeed?Qe.LF:e===P.CarriageReturn?Qe.CR:Qe.Control;if(e<127)return Qe.Other;const t=this._data,i=t.length/3;let r=1;for(;r<=i;)if(e<t[3*r])r=2*r;else if(e>t[3*r+1])r=2*r+1;else return t[3*r+2];return Qe.Other}};na._INSTANCE=null;let og=na;function _9(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}var jv;(function(n){n[n.zwj=8205]="zwj",n[n.emojiVariantSelector=65039]="emojiVariantSelector",n[n.enclosingKeyCap=8419]="enclosingKeyCap",n[n.space=32]="space"})(jv||(jv={}));const Er=class Er{static getInstance(e){return Er.cache.get(Array.from(e))}static getLocales(){return Er._locales.value}constructor(e){this.confusableDictionary=e}isAmbiguous(e){return this.confusableDictionary.has(e)}containsAmbiguousCharacter(e){for(let t=0;t<e.length;t++){const i=e.codePointAt(t);if(typeof i=="number"&&this.isAmbiguous(i))return!0}return!1}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}};Er.ambiguousCharacterData=new Ci(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,1523,96,8242,96,1370,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,118002,50,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,118003,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,118004,52,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,118005,53,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,118006,54,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,118007,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,118008,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,118009,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,117974,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,117975,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71913,67,71922,67,65315,67,8557,67,8450,67,8493,67,117976,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,117977,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,117978,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,117979,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,117980,71,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,117981,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,117983,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,117984,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,118001,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,117982,108,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,117985,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,117986,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,117987,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,118000,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,117988,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,117989,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,117990,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,117991,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,117992,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,117993,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,117994,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,117995,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71910,87,71919,87,117996,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,117997,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,117998,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,71909,90,66293,90,65338,90,8484,90,8488,90,117999,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65283,35,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"cs":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"es":[8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"fr":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"it":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"ja":[8211,45,8218,44,65281,33,8216,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65292,44,65297,49,65307,59],"ko":[8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"pt-BR":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"ru":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"zh-hans":[160,32,65374,126,8218,44,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65297,49],"zh-hant":[8211,45,65374,126,8218,44,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89]}')),Er.cache=new e9({getCacheKey:JSON.stringify},e=>{function t(u){const d=new Map;for(let f=0;f<u.length;f+=2)d.set(u[f],u[f+1]);return d}function i(u,d){const f=new Map(u);for(const[p,w]of d)f.set(p,w);return f}function r(u,d){if(!u)return d;const f=new Map;for(const[p,w]of u)d.has(p)&&f.set(p,w);return f}const s=Er.ambiguousCharacterData.value;let o=e.filter(u=>!u.startsWith("_")&&u in s);o.length===0&&(o=["_default"]);let a;for(const u of o){const d=t(s[u]);a=r(a,d)}const l=t(s._common),c=i(l,a);return new Er(c)}),Er._locales=new Ci(()=>Object.keys(Er.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")));let X2=Er;const ia=class ia{static getRawData(){return JSON.parse('{"_common":[11,12,13,127,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999],"cs":[173,8203,12288],"de":[173,8203,12288],"es":[8203,12288],"fr":[173,8203,12288],"it":[160,173,12288],"ja":[173],"ko":[173,12288],"pl":[173,8203,12288],"pt-BR":[173,8203,12288],"qps-ploc":[160,173,8203,12288],"ru":[173,12288],"tr":[160,173,8203,12288],"zh-hans":[160,173,8203,12288],"zh-hant":[173,12288]}')}static getData(){return this._data||(this._data=new Set([...Object.values(ia.getRawData())].flat())),this._data}static isInvisibleCharacter(e){return ia.getData().has(e)}static containsInvisibleCharacter(e){for(let t=0;t<e.length;t++){const i=e.codePointAt(t);if(typeof i=="number"&&(ia.isInvisibleCharacter(i)||i===jv.space))return!0}return!1}static get codePoints(){return ia.getData()}};ia._data=void 0;let Y2=ia;function qs(n){return n===P.Slash||n===P.Backslash}function OI(n){return n.replace(/[\\/]/g,ot.sep)}function v9(n){return n.indexOf("/")===-1&&(n=OI(n)),/^[a-zA-Z]:(\/|$)/.test(n)&&(n="/"+n),n}function Z2(n,e=ot.sep){if(!n)return"";const t=n.length,i=n.charCodeAt(0);if(qs(i)){if(qs(n.charCodeAt(1))&&!qs(n.charCodeAt(2))){let s=3;const o=s;for(;s<t&&!qs(n.charCodeAt(s));s++);if(o!==s&&!qs(n.charCodeAt(s+1))){for(s+=1;s<t;s++)if(qs(n.charCodeAt(s)))return n.slice(0,s+1).replace(/[\\/]/g,e)}}return e}else if(FI(i)&&n.charCodeAt(1)===P.Colon)return qs(n.charCodeAt(2))?n.slice(0,2)+e:n.slice(0,2);let r=n.indexOf("://");if(r!==-1){for(r+=3;r<t;r++)if(qs(n.charCodeAt(r)))return n.slice(0,r+1)}return""}function ag(n,e,t,i=hr){if(n===e)return!0;if(!n||!e||e.length>n.length)return!1;if(t){if(!mx(n,e))return!1;if(e.length===n.length)return!0;let s=e.length;return e.charAt(e.length-1)===i&&s--,n.charAt(s)===i}return e.charAt(e.length-1)!==i&&(e+=i),n.indexOf(e)===0}function FI(n){return n>=P.A&&n<=P.Z||n>=P.a&&n<=P.z}function w9(n,e=ni){return e?FI(n.charCodeAt(0))&&n.charCodeAt(1)===P.Colon:!1}var oe;(function(n){n.inMemory="inmemory",n.vscode="vscode",n.internal="private",n.walkThrough="walkThrough",n.walkThroughSnippet="walkThroughSnippet",n.http="http",n.https="https",n.file="file",n.mailto="mailto",n.untitled="untitled",n.data="data",n.command="command",n.vscodeRemote="vscode-remote",n.vscodeRemoteResource="vscode-remote-resource",n.vscodeManagedRemoteResource="vscode-managed-remote-resource",n.vscodeUserData="vscode-userdata",n.vscodeCustomEditor="vscode-custom-editor",n.vscodeNotebookCell="vscode-notebook-cell",n.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",n.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff",n.vscodeNotebookCellOutput="vscode-notebook-cell-output",n.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff",n.vscodeNotebookMetadata="vscode-notebook-metadata",n.vscodeInteractiveInput="vscode-interactive-input",n.vscodeSettings="vscode-settings",n.vscodeWorkspaceTrust="vscode-workspace-trust",n.vscodeTerminal="vscode-terminal",n.vscodeChatCodeBlock="vscode-chat-code-block",n.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",n.vscodeChatSesssion="vscode-chat-editor",n.webviewPanel="webview-panel",n.vscodeWebview="vscode-webview",n.extension="extension",n.vscodeFileResource="vscode-file",n.tmp="tmp",n.vsls="vsls",n.vscodeSourceControl="vscode-scm",n.commentsInput="comment",n.codeSetting="code-setting",n.outputChannel="output",n.accessibleView="accessible-view"})(oe||(oe={}));function Gv(n,e){return y.isUri(n)?ca(n.scheme,e):mx(n,e+":")}function b9(n,...e){return e.some(t=>Gv(n,t))}const y9="tkn";class x9{constructor(){this._hosts=Object.create(null),this._ports=Object.create(null),this._connectionTokens=Object.create(null),this._preferredWebSchema="http",this._delegate=null,this._serverRootPath="/"}setPreferredWebSchema(e){this._preferredWebSchema=e}setDelegate(e){this._delegate=e}setServerRootPath(e,t){this._serverRootPath=ot.join(t??"/",S9(e))}getServerRootPath(){return this._serverRootPath}get _remoteResourcesPath(){return ot.join(this._serverRootPath,oe.vscodeRemoteResource)}set(e,t,i){this._hosts[e]=t,this._ports[e]=i}setConnectionToken(e,t){this._connectionTokens[e]=t}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(a){return Fn(a),e}const t=e.authority;let i=this._hosts[t];i&&i.indexOf(":")!==-1&&i.indexOf("[")===-1&&(i=`[${i}]`);const r=this._ports[t],s=this._connectionTokens[t];let o=`path=${encodeURIComponent(e.path)}`;return typeof s=="string"&&(o+=`&${y9}=${encodeURIComponent(s)}`),y.from({scheme:Bf?this._preferredWebSchema:oe.vscodeRemoteResource,authority:`${i}:${r}`,path:this._remoteResourcesPath,query:o})}}const E9=new x9;function S9(n){return`${n.quality??"oss"}-${n.commit??"dev"}`}const D9="vs/../../node_modules",MI="vscode-app",pc=class pc{constructor(){this.staticBrowserUris=new on,this.appResourcePathUrls=new Map}registerAppResourcePathUrl(e,t){this.appResourcePathUrls.set(e,t)}toUrl(e){var i;let t=this.appResourcePathUrls.get(e);return typeof t=="function"&&(t=t()),new URL(t??e,((i=globalThis.location)==null?void 0:i.href)??import.meta.url).toString()}asBrowserUri(e){const t=this.toUri(e);return this.uriToBrowserUri(t)}uriToBrowserUri(e){return e.scheme===oe.vscodeRemote?E9.rewrite(e):e.scheme===oe.file&&(wI||PP===`${oe.vscodeFileResource}://${pc.FALLBACK_AUTHORITY}`)?e.with({scheme:oe.vscodeFileResource,authority:e.authority||pc.FALLBACK_AUTHORITY,query:null,fragment:null}):this.staticBrowserUris.get(e)??e}asFileUri(e){const t=this.toUri(e);return this.uriToFileUri(t)}uriToFileUri(e){return e.scheme===oe.vscodeFileResource?e.with({scheme:oe.file,authority:e.authority!==pc.FALLBACK_AUTHORITY?e.authority:null,query:null,fragment:null}):e}toUri(e){if(y.isUri(e))return e;if(globalThis._VSCODE_FILE_ROOT){const t=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(t))return y.joinPath(y.parse(t,!0),e);const i=Bv(t,e);return y.file(i)}return y.parse(this.toUrl(e))}registerStaticBrowserUri(e,t){return this.staticBrowserUris.set(e,t),Se(()=>{this.staticBrowserUris.get(e)===t&&this.staticBrowserUris.delete(e)})}getRegisteredBrowserUris(){return this.staticBrowserUris.keys()}};pc.FALLBACK_AUTHORITY=MI;let Qv=pc;const k9=new Qv;var K2;(function(n){const e=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);n.CoopAndCoep=Object.freeze(e.get("3"));const t="vscode-coi";function i(s){let o;typeof s=="string"?o=new URL(s).searchParams:s instanceof URL?o=s.searchParams:y.isUri(s)&&(o=new URL(s.toString(!0)).searchParams);const a=o==null?void 0:o.get(t);if(a)return e.get(a)}n.getHeadersFromQuery=i;function r(s,o,a){if(!globalThis.crossOriginIsolated)return;const l=o&&a?"3":a?"2":"1";s instanceof URLSearchParams?s.set(t,l):s[t]=l}n.addSearchParam=r})(K2||(K2={}));function Gi(n){return ig(n,!0)}class Vf{constructor(e){this._ignorePathCasing=e}compare(e,t,i=!1){return e===t?0:fl(this.getComparisonKey(e,i),this.getComparisonKey(t,i))}isEqual(e,t,i=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,i)===this.getComparisonKey(t,i)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,t,i=!1){if(e.scheme===t.scheme){if(e.scheme===oe.file)return ag(Gi(e),Gi(t),this._ignorePathCasing(e))&&e.query===t.query&&(i||e.fragment===t.fragment);if(eE(e.authority,t.authority))return ag(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(i||e.fragment===t.fragment)}return!1}joinPath(e,...t){return y.joinPath(e,...t)}basenameOrAuthority(e){return Lo(e)||e.authority}basename(e){return ot.basename(e.path)}extname(e){return ot.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===oe.file?t=y.file(Sc(Gi(e))).path:(t=ot.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==P.Slash&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===oe.file?t=y.file(hu(Gi(e))).path:t=ot.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!eE(e.authority,t.authority))return;if(e.scheme===oe.file){const s=gh(Gi(e),Gi(t));return ni?OI(s):s}let i=e.path||"/";const r=t.path||"/";if(this._ignorePathCasing(e)){let s=0;for(const o=Math.min(i.length,r.length);s<o&&!(i.charCodeAt(s)!==r.charCodeAt(s)&&i.charAt(s).toLowerCase()!==r.charAt(s).toLowerCase());s++);i=r.substr(0,s)+i.substr(s)}return ot.relative(i,r)}resolvePath(e,t){if(e.scheme===oe.file){const i=y.file(zP(Gi(e),t));return e.with({authority:i.authority,path:i.path})}return t=v9(t),e.with({path:ot.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&ca(e,t)}hasTrailingPathSeparator(e,t=hr){if(e.scheme===oe.file){const i=Gi(e);return i.length>Z2(i).length&&i[i.length-1]===t}else{const i=e.path;return i.length>1&&i.charCodeAt(i.length-1)===P.Slash&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=hr){return tE(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=hr){let i=!1;if(e.scheme===oe.file){const r=Gi(e);i=r!==void 0&&r.length===Z2(r).length&&r[r.length-1]===t}else{t="/";const r=e.path;i=r.length===1&&r.charCodeAt(r.length-1)===P.Slash}return!i&&!tE(e,t)?e.with({path:e.path+"/"}):e}}const et=new Vf(()=>!1),I9=new Vf(n=>n.scheme===oe.file?!Fs:!0),C9=new Vf(n=>!0),Dc=et.isEqual.bind(et);et.isEqualOrParent.bind(et);et.getComparisonKey.bind(et);const Jv=et.basenameOrAuthority.bind(et),Lo=et.basename.bind(et),P9=et.extname.bind(et),r_=et.dirname.bind(et),An=et.joinPath.bind(et);et.normalizePath.bind(et);const $I=et.relativePath.bind(et);et.resolvePath.bind(et);const T9=et.isAbsolutePath.bind(et),eE=et.isEqualAuthority.bind(et),tE=et.hasTrailingPathSeparator.bind(et);et.removeTrailingPathSeparator.bind(et);et.addTrailingPathSeparator.bind(et);var nE;(function(n){n.META_DATA_LABEL="label",n.META_DATA_DESCRIPTION="description",n.META_DATA_SIZE="size",n.META_DATA_MIME="mime";function e(t){const i=new Map;t.path.substring(t.path.indexOf(";")+1,t.path.lastIndexOf(";")).split(";").forEach(o=>{const[a,l]=o.split(":");a&&l&&i.set(a,l)});const s=t.path.substring(0,t.path.indexOf(";"));return s&&i.set(n.META_DATA_MIME,s),i}n.parseMetaData=e})(nE||(nE={}));const A9=Symbol("MicrotaskDelay");function Io(n){return!!n&&typeof n.then=="function"}function R9(n){const e=new Bt,t=n(e.token),i=new Promise((r,s)=>{const o=e.token.onCancellationRequested(()=>{o.dispose(),s(new qr)});Promise.resolve(t).then(a=>{o.dispose(),e.dispose(),r(a)},a=>{o.dispose(),e.dispose(),s(a)})});return new class{cancel(){e.cancel(),e.dispose()}then(r,s){return i.then(r,s)}catch(r){return this.then(void 0,r)}finally(r){return i.finally(r)}}}function UI(n,e,t){return new Promise((i,r)=>{const s=e.onCancellationRequested(()=>{s.dispose(),i(t)});n.then(i,r).finally(()=>s.dispose())})}function L9(n,e){return new Promise((t,i)=>{const r=e.onCancellationRequested(()=>{r.dispose(),i(new qr)});n.then(t,i).finally(()=>r.dispose())})}function Nn(n){return new Promise((e,t)=>{const i=n();Io(i)?i.then(e,t):e(i)})}function N9(){let n,e;return{promise:new Promise((i,r)=>{n=i,e=r}),resolve:n,reject:e}}let O9=class{constructor(){this.isDisposed=!1,this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(e){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){const t=()=>{if(this.queuedPromise=null,this.isDisposed)return;const i=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,i};this.queuedPromise=new Promise(i=>{this.activePromise.then(t,t).then(i)})}return new Promise((t,i)=>{this.queuedPromise.then(t,i)})}return this.activePromise=e(),new Promise((t,i)=>{this.activePromise.then(r=>{this.activePromise=null,t(r)},r=>{this.activePromise=null,i(r)})})}dispose(){this.isDisposed=!0}};class F9{constructor(){this.current=Promise.resolve(null)}queue(e){return this.current=this.current.then(()=>e(),()=>e())}}const M9=(n,e)=>{let t=!0;const i=setTimeout(()=>{t=!1,e()},n);return{isTriggered:()=>t,dispose:()=>{clearTimeout(i),t=!1}}},$9=n=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,n())}),{isTriggered:()=>e,dispose:()=>{e=!1}}};class U9{constructor(e){this.defaultDelay=e,this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((r,s)=>{this.doResolve=r,this.doReject=s}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){const r=this.task;return this.task=null,r()}}));const i=()=>{var r;this.deferred=null,(r=this.doResolve)==null||r.call(this,null)};return this.deferred=t===A9?$9(i):M9(t,i),this.completionPromise}isTriggered(){var e;return!!((e=this.deferred)!=null&&e.isTriggered())}cancel(){var e;this.cancelTimeout(),this.completionPromise&&((e=this.doReject)==null||e.call(this,new qr),this.completionPromise=null)}cancelTimeout(){var e;(e=this.deferred)==null||e.dispose(),this.deferred=null}dispose(){this.cancel()}}class H9{constructor(e){this.delayer=new U9(e),this.throttler=new O9}trigger(e,t){return this.delayer.trigger(()=>this.throttler.queue(e),t)}isTriggered(){return this.delayer.isTriggered()}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}}class Nr{constructor(){this._isOpen=!1,this._promise=new Promise((e,t)=>{this._completePromise=e})}isOpen(){return this._isOpen}open(){this._isOpen=!0,this._completePromise(!0)}wait(){return this._promise}}function Eo(n,e){return e?new Promise((t,i)=>{const r=setTimeout(()=>{s.dispose(),t()},n),s=e.onCancellationRequested(()=>{clearTimeout(r),s.dispose(),i(new qr)})}):R9(t=>Eo(n,t))}function B9(n,e=0,t){const i=setTimeout(()=>{n()},e);return Se(()=>{clearTimeout(i)})}class W9{constructor(e){this._size=0,this._isDisposed=!1,this.maxDegreeOfParalellism=e,this.outstandingPromises=[],this.runningPromises=0,this._onDrained=new L}whenIdle(){return this.size>0?Ht.toPromise(this.onDrained):Promise.resolve()}get onDrained(){return this._onDrained.event}get size(){return this._size}queue(e){if(this._isDisposed)throw new Error("Object has been disposed");return this._size++,new Promise((t,i)=>{this.outstandingPromises.push({factory:e,c:t,e:i}),this.consume()})}consume(){for(;this.outstandingPromises.length&&this.runningPromises<this.maxDegreeOfParalellism;){const e=this.outstandingPromises.shift();this.runningPromises++;const t=e.factory();t.then(e.c,e.e),t.then(()=>this.consumed(),()=>this.consumed())}}consumed(){this._isDisposed||(this.runningPromises--,--this._size===0&&this._onDrained.fire(),this.outstandingPromises.length>0&&this.consume())}clear(){if(this._isDisposed)throw new Error("Object has been disposed");this.outstandingPromises.length=0,this._size=this.runningPromises}dispose(){this._isDisposed=!0,this.outstandingPromises.length=0,this._size=0,this._onDrained.dispose()}}class V9 extends W9{constructor(){super(1)}}class z9{constructor(){this.queues=new Map,this.drainers=new Set,this.drainListeners=void 0,this.drainListenerCount=0}async whenDrained(){if(this.isDrained())return;const e=new Sl;return this.drainers.add(e),e.p}isDrained(){for(const[,e]of this.queues)if(e.size>0)return!1;return!0}queueSize(e,t=et){var r;const i=t.getComparisonKey(e);return((r=this.queues.get(i))==null?void 0:r.size)??0}queueFor(e,t,i=et){const r=i.getComparisonKey(e);let s=this.queues.get(r);if(!s){s=new V9;const o=this.drainListenerCount++,a=Ht.once(s.onDrained)(()=>{var l,c;s==null||s.dispose(),this.queues.delete(r),this.onDidQueueDrain(),(l=this.drainListeners)==null||l.deleteAndDispose(o),((c=this.drainListeners)==null?void 0:c.size)===0&&(this.drainListeners.dispose(),this.drainListeners=void 0)});this.drainListeners||(this.drainListeners=new Yp),this.drainListeners.set(o,a),this.queues.set(r,s)}return s.queue(t)}onDidQueueDrain(){this.isDrained()&&this.releaseDrainers()}releaseDrainers(){for(const e of this.drainers)e.complete();this.drainers.clear()}dispose(){var e;for(const[,t]of this.queues)t.dispose();this.queues.clear(),this.releaseDrainers(),(e=this.drainListeners)==null||e.dispose()}}class q9{constructor(){this.disposable=void 0,this.isDisposed=!1}cancel(){var e;(e=this.disposable)==null||e.dispose(),this.disposable=void 0}cancelAndSet(e,t,i=globalThis){if(this.isDisposed)throw new ur("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();const r=i.setInterval(()=>{e()},t);this.disposable=Se(()=>{i.clearInterval(r),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}}class Gu{constructor(e,t){this.timeoutToken=-1,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==-1}flush(){this.isScheduled()&&(this.cancel(),this.doRun())}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){var e;(e=this.runner)==null||e.call(this)}}let HI,Cp;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?Cp=(n,e,t)=>{bI(()=>{if(i)return;const r=Date.now()+15;e(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,r-Date.now())}}))});let i=!1;return{dispose(){i||(i=!0)}}}:Cp=(n,e,t)=>{const i=n.requestIdleCallback(e,typeof t=="number"?{timeout:t}:void 0);let r=!1;return{dispose(){r||(r=!0,n.cancelIdleCallback(i))}}},HI=(n,e)=>Cp(globalThis,n,e)})();class j9{constructor(e,t){this._didRun=!1,this._executor=()=>{try{this._value=t()}catch(i){this._error=i}finally{this._didRun=!0}},this._handle=Cp(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}}class G9 extends j9{constructor(e){super(globalThis,e)}}var Qo;(function(n){n[n.Resolved=0]="Resolved",n[n.Rejected=1]="Rejected"})(Qo||(Qo={}));class Sl{get isRejected(){var e;return((e=this.outcome)==null?void 0:e.outcome)===Qo.Rejected}get isResolved(){var e;return((e=this.outcome)==null?void 0:e.outcome)===Qo.Resolved}get isSettled(){return!!this.outcome}get value(){var e,t;return((e=this.outcome)==null?void 0:e.outcome)===Qo.Resolved?(t=this.outcome)==null?void 0:t.value:void 0}constructor(){this.p=new Promise((e,t)=>{this.completeCallback=e,this.errorCallback=t})}complete(e){return new Promise(t=>{this.completeCallback(e),this.outcome={outcome:Qo.Resolved,value:e},t()})}error(e){return new Promise(t=>{this.errorCallback(e),this.outcome={outcome:Qo.Rejected,value:e},t()})}cancel(){return this.error(new qr)}}var fu;(function(n){async function e(i){let r;const s=await Promise.all(i.map(o=>o.then(a=>a,a=>{r||(r=a)})));if(typeof r<"u")throw r;return s}n.settled=e;function t(i){return new Promise(async(r,s)=>{try{await i(r,s)}catch(o){s(o)}})}n.withAsyncBody=t})(fu||(fu={}));var Qi;(function(n){n[n.Initial=0]="Initial",n[n.DoneOK=1]="DoneOK",n[n.DoneError=2]="DoneError"})(Qi||(Qi={}));const Yn=class Yn{static fromArray(e){return new Yn(t=>{t.emitMany(e)})}static fromPromise(e){return new Yn(async t=>{t.emitMany(await e)})}static fromPromisesResolveOrder(e){return new Yn(async t=>{await Promise.all(e.map(async i=>t.emitOne(await i)))})}static merge(e){return new Yn(async t=>{await Promise.all(e.map(async i=>{for await(const r of i)t.emitOne(r)}))})}constructor(e,t){this._state=Qi.Initial,this._results=[],this._error=null,this._onReturn=t,this._onStateChanged=new L,queueMicrotask(async()=>{const i={emitOne:r=>this.emitOne(r),emitMany:r=>this.emitMany(r),reject:r=>this.reject(r)};try{await Promise.resolve(e(i)),this.resolve()}catch(r){this.reject(r)}finally{i.emitOne=void 0,i.emitMany=void 0,i.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===Qi.DoneError)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===Qi.DoneOK)return{done:!0,value:void 0};await Ht.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>{var t;return(t=this._onReturn)==null||t.call(this),{done:!0,value:void 0}}}}static map(e,t){return new Yn(async i=>{for await(const r of e)i.emitOne(t(r))})}map(e){return Yn.map(this,e)}static filter(e,t){return new Yn(async i=>{for await(const r of e)t(r)&&i.emitOne(r)})}filter(e){return Yn.filter(this,e)}static coalesce(e){return Yn.filter(e,t=>!!t)}coalesce(){return Yn.coalesce(this)}static async toPromise(e){const t=[];for await(const i of e)t.push(i);return t}toPromise(){return Yn.toPromise(this)}emitOne(e){this._state===Qi.Initial&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===Qi.Initial&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===Qi.Initial&&(this._state=Qi.DoneOK,this._onStateChanged.fire())}reject(e){this._state===Qi.Initial&&(this._state=Qi.DoneError,this._error=e,this._onStateChanged.fire())}};Yn.EMPTY=Yn.fromArray([]);let pl=Yn;class Xv{constructor(e){this._deferred=new Sl,this._asyncIterable=new pl(r=>{if(t){r.reject(t);return}return i&&r.emitMany(i),this._errorFn=s=>r.reject(s),this._emitFn=s=>r.emitOne(s),this._deferred.p},e);let t,i;this._emitFn=r=>{i||(i=[]),i.push(r)},this._errorFn=r=>{t||(t=r)}}get asyncIterable(){return this._asyncIterable}resolve(){this._deferred.complete()}reject(e){this._errorFn(e),this._deferred.complete()}emitOne(e){this._emitFn(e)}}function BI(n,e,t,i){if(!n||i>200)return null;if(typeof n=="object"){if(n.$mid===rt.Uri)return t?y.revive(e.transformIncoming(n)):e.transformIncoming(n);if(n instanceof Pe)return null;for(const r in n)if(Object.hasOwnProperty.call(n,r)){const s=BI(n[r],e,t,i+1);s!==null&&(n[r]=s)}}return null}function cd(n,e){const t=BI(n,e,!1,0);return t===null?n:t}class WI{constructor(){this._actual=null,this._actualOk=null,this._actualErr=null,this._hasValue=!1,this._value=null,this._hasErr=!1,this._err=null}get[Symbol.toStringTag](){return this.toString()}_ensureActual(){return this._actual||(this._actual=new Promise((e,t)=>{this._actualOk=e,this._actualErr=t,this._hasValue&&this._actualOk(this._value),this._hasErr&&this._actualErr(this._err)})),this._actual}resolveOk(e){this._hasValue||this._hasErr||(this._hasValue=!0,this._value=e,this._actual&&this._actualOk(e))}resolveErr(e){this._hasValue||this._hasErr||(this._hasErr=!0,this._err=e,this._actual?this._actualErr(e):Fn(e))}then(e,t){return this._ensureActual().then(e,t)}catch(e){return this._ensureActual().then(void 0,e)}finally(e){return this._ensureActual().finally(e)}}class Q9 extends WI{constructor(){super(),this._hasErr=!0,this._err=new qr}}var iE;function Yv(n,e){try{return JSON.stringify(n,e)}catch{return"null"}}const vx="$$ref$$",J9={[vx]:-1};function rE(n,e=null,t=!1){const i=[];return{jsonString:(t?Yv:JSON.stringify)(n,(s,o)=>{if(typeof o>"u")return J9;if(typeof o=="object"){if(o instanceof Pe){const a=i.push(o)-1;return{[vx]:a}}if(e)return e(s,o)}return o}),referencedBuffers:i}}function VI(n,e,t){return JSON.parse(n,(i,r)=>{if(r){const s=r[vx];if(typeof s=="number")return e[s];if(t&&r.$mid===rt.Uri)return t.transformIncoming(r)}return r})}function sE(n,e){return JSON.stringify(n,e)}function X9(n){return n?(e,t)=>t&&t.$mid===rt.Uri?n.transformOutgoing(t):t:null}var Oi;(function(n){n[n.LocalSide=0]="LocalSide",n[n.OtherSide=1]="OtherSide"})(Oi||(Oi={}));var Rd;(function(n){n[n.Responsive=0]="Responsive",n[n.Unresponsive=1]="Unresponsive"})(Rd||(Rd={}));const Y9=()=>{},Z9=Symbol.for("rpcProtocol"),K9=Symbol.for("rpcProxy"),oh=class oh extends Te{constructor(e,t=null,i=null){super(),this[iE]=!0,this._onDidChangeResponsiveState=this._register(new L),this.onDidChangeResponsiveState=this._onDidChangeResponsiveState.event,this._protocol=e,this._logger=t,this._uriTransformer=i,this._uriReplacer=X9(this._uriTransformer),this._isDisposed=!1,this._locals=[],this._proxies=[];for(let r=0,s=rg.count;r<s;r++)this._locals[r]=null,this._proxies[r]=null;this._lastMessageId=0,this._cancelInvokedHandlers=Object.create(null),this._pendingRPCReplies={},this._responsiveState=Rd.Responsive,this._unacknowledgedCount=0,this._unresponsiveTime=0,this._asyncCheckUresponsive=this._register(new Gu(()=>this._checkUnresponsive(),1e3)),this._register(this._protocol.onMessage(r=>this._receiveOneMessage(r)))}dispose(){this._isDisposed=!0,Object.keys(this._pendingRPCReplies).forEach(e=>{const t=this._pendingRPCReplies[e];delete this._pendingRPCReplies[e],t.resolveErr(b2())}),super.dispose()}drain(){return typeof this._protocol.drain=="function"?this._protocol.drain():Promise.resolve()}_onWillSendRequest(e){this._unacknowledgedCount===0&&(this._unresponsiveTime=Date.now()+oh.UNRESPONSIVE_TIME),this._unacknowledgedCount++,this._asyncCheckUresponsive.isScheduled()||this._asyncCheckUresponsive.schedule()}_onDidReceiveAcknowledge(e){this._unresponsiveTime=Date.now()+oh.UNRESPONSIVE_TIME,this._unacknowledgedCount--,this._unacknowledgedCount===0&&this._asyncCheckUresponsive.cancel(),this._setResponsiveState(Rd.Responsive)}_checkUnresponsive(){this._unacknowledgedCount!==0&&(Date.now()>this._unresponsiveTime?this._setResponsiveState(Rd.Unresponsive):this._asyncCheckUresponsive.schedule())}_setResponsiveState(e){this._responsiveState!==e&&(this._responsiveState=e,this._onDidChangeResponsiveState.fire(this._responsiveState))}get responsiveState(){return this._responsiveState}transformIncomingURIs(e){return this._uriTransformer?cd(e,this._uriTransformer):e}getProxy(e){const{nid:t,sid:i}=e;return this._proxies[t]||(this._proxies[t]=this._createProxy(t,i)),this._proxies[t]}_createProxy(e,t){const i={get:(r,s)=>(typeof s=="string"&&!r[s]&&s.charCodeAt(0)===P.DollarSign&&(r[s]=(...o)=>this._remoteCall(e,s,o)),s===K9?t:r[s])};return new Proxy(Object.create(null),i)}set(e,t){return this._locals[e.nid]=t,t}assertRegistered(e){for(let t=0,i=e.length;t<i;t++){const r=e[t];if(!this._locals[r.nid])throw new Error(`Missing proxy instance ${r.sid}`)}}_receiveOneMessage(e){var o;if(this._isDisposed)return;const t=e.byteLength,i=Ot.read(e,0),r=i.readUInt8(),s=i.readUInt32();switch(r){case St.RequestJSONArgs:case St.RequestJSONArgsWithCancellation:{let{rpcId:a,method:l,args:c}=Ni.deserializeRequestJSONArgs(i);this._uriTransformer&&(c=cd(c,this._uriTransformer)),this._receiveRequest(t,s,a,l,c,r===St.RequestJSONArgsWithCancellation);break}case St.RequestMixedArgs:case St.RequestMixedArgsWithCancellation:{let{rpcId:a,method:l,args:c}=Ni.deserializeRequestMixedArgs(i);this._uriTransformer&&(c=cd(c,this._uriTransformer)),this._receiveRequest(t,s,a,l,c,r===St.RequestMixedArgsWithCancellation);break}case St.Acknowledged:{(o=this._logger)==null||o.logIncoming(t,s,Oi.LocalSide,"ack"),this._onDidReceiveAcknowledge(s);break}case St.Cancel:{this._receiveCancel(t,s);break}case St.ReplyOKEmpty:{this._receiveReply(t,s,void 0);break}case St.ReplyOKJSON:{let a=Ni.deserializeReplyOKJSON(i);this._uriTransformer&&(a=cd(a,this._uriTransformer)),this._receiveReply(t,s,a);break}case St.ReplyOKJSONWithBuffers:{const a=Ni.deserializeReplyOKJSONWithBuffers(i,this._uriTransformer);this._receiveReply(t,s,a);break}case St.ReplyOKVSBuffer:{const a=Ni.deserializeReplyOKVSBuffer(i);this._receiveReply(t,s,a);break}case St.ReplyErrError:{let a=Ni.deserializeReplyErrError(i);this._uriTransformer&&(a=cd(a,this._uriTransformer)),this._receiveReplyErr(t,s,a);break}case St.ReplyErrEmpty:{this._receiveReplyErr(t,s,void 0);break}default:console.error("received unexpected message"),console.error(e)}}_receiveRequest(e,t,i,r,s,o){var d,f;(d=this._logger)==null||d.logIncoming(e,t,Oi.OtherSide,`receiveRequest ${op(i)}.${r}(`,s);const a=String(t);let l,c;if(o){const p=new Bt;s.push(p.token),l=this._invokeHandler(i,r,s),c=()=>p.cancel()}else l=this._invokeHandler(i,r,s),c=Y9;this._cancelInvokedHandlers[a]=c;const u=Ni.serializeAcknowledged(t);(f=this._logger)==null||f.logOutgoing(u.byteLength,t,Oi.OtherSide,"ack"),this._protocol.send(u),l.then(p=>{var v;delete this._cancelInvokedHandlers[a];const w=Ni.serializeReplyOK(t,p,this._uriReplacer);(v=this._logger)==null||v.logOutgoing(w.byteLength,t,Oi.OtherSide,"reply:",p),this._protocol.send(w)},p=>{var v;delete this._cancelInvokedHandlers[a];const w=Ni.serializeReplyErr(t,p);(v=this._logger)==null||v.logOutgoing(w.byteLength,t,Oi.OtherSide,"replyErr:",p),this._protocol.send(w)})}_receiveCancel(e,t){var r,s,o;(r=this._logger)==null||r.logIncoming(e,t,Oi.OtherSide,"receiveCancel");const i=String(t);(o=(s=this._cancelInvokedHandlers)[i])==null||o.call(s)}_receiveReply(e,t,i){var o;(o=this._logger)==null||o.logIncoming(e,t,Oi.LocalSide,"receiveReply:",i);const r=String(t);if(!this._pendingRPCReplies.hasOwnProperty(r))return;const s=this._pendingRPCReplies[r];delete this._pendingRPCReplies[r],s.resolveOk(i)}_receiveReplyErr(e,t,i){var a;(a=this._logger)==null||a.logIncoming(e,t,Oi.LocalSide,"receiveReplyErr:",i);const r=String(t);if(!this._pendingRPCReplies.hasOwnProperty(r))return;const s=this._pendingRPCReplies[r];delete this._pendingRPCReplies[r];let o;i&&(i.$isError?(o=new Error,o.name=i.name,o.message=i.message,o.stack=i.stack):o=i),s.resolveErr(o)}_invokeHandler(e,t,i){try{return Promise.resolve(this._doInvokeHandler(e,t,i))}catch(r){return Promise.reject(r)}}_doInvokeHandler(e,t,i){const r=this._locals[e];if(!r)throw new Error("Unknown actor "+op(e));const s=r[t];if(typeof s!="function")throw new Error("Unknown method "+t+" on actor "+op(e));return s.apply(r,i)}_remoteCall(e,t,i){var d;if(this._isDisposed)return new Q9;let r=null;if(i.length>0&&Pt.isCancellationToken(i[i.length-1])&&(r=i.pop()),r&&r.isCancellationRequested)return Promise.reject(b2());const s=Ni.serializeRequestArguments(i,this._uriReplacer),o=++this._lastMessageId,a=String(o),l=new WI,c=new Ie;r&&c.add(r.onCancellationRequested(()=>{var p;const f=Ni.serializeCancel(o);(p=this._logger)==null||p.logOutgoing(f.byteLength,o,Oi.LocalSide,"cancel"),this._protocol.send(f)})),this._pendingRPCReplies[a]=new eT(l,c),this._onWillSendRequest(o);const u=Ni.serializeRequest(o,e,t,s,!!r);return(d=this._logger)==null||d.logOutgoing(u.byteLength,o,Oi.LocalSide,`request: ${op(e)}.${t}(`,i),this._protocol.send(u),l}};iE=Z9,oh.UNRESPONSIVE_TIME=3*1e3;let Zv=oh;class eT{constructor(e,t){this._promise=e,this._disposable=t}resolveOk(e){this._promise.resolveOk(e),this._disposable.dispose()}resolveErr(e){this._promise.resolveErr(e),this._disposable.dispose()}}const ah=class ah{static alloc(e,t,i){const r=new ah(Pe.alloc(i+1+4),0);return r.writeUInt8(e),r.writeUInt32(t),r}static read(e,t){return new ah(e,t)}get buffer(){return this._buff}constructor(e,t){this._buff=e,this._offset=t}static sizeUInt8(){return 1}writeUInt8(e){this._buff.writeUInt8(e,this._offset),this._offset+=1}readUInt8(){const e=this._buff.readUInt8(this._offset);return this._offset+=1,e}writeUInt32(e){this._buff.writeUInt32BE(e,this._offset),this._offset+=4}readUInt32(){const e=this._buff.readUInt32BE(this._offset);return this._offset+=4,e}static sizeShortString(e){return 1+e.byteLength}writeShortString(e){this._buff.writeUInt8(e.byteLength,this._offset),this._offset+=1,this._buff.set(e,this._offset),this._offset+=e.byteLength}readShortString(){const e=this._buff.readUInt8(this._offset);this._offset+=1;const i=this._buff.slice(this._offset,this._offset+e).toString();return this._offset+=e,i}static sizeLongString(e){return 4+e.byteLength}writeLongString(e){this._buff.writeUInt32BE(e.byteLength,this._offset),this._offset+=4,this._buff.set(e,this._offset),this._offset+=e.byteLength}readLongString(){const e=this._buff.readUInt32BE(this._offset);this._offset+=4;const i=this._buff.slice(this._offset,this._offset+e).toString();return this._offset+=e,i}writeBuffer(e){this._buff.writeUInt32BE(e.byteLength,this._offset),this._offset+=4,this._buff.set(e,this._offset),this._offset+=e.byteLength}static sizeVSBuffer(e){return 4+e.byteLength}writeVSBuffer(e){this._buff.writeUInt32BE(e.byteLength,this._offset),this._offset+=4,this._buff.set(e,this._offset),this._offset+=e.byteLength}readVSBuffer(){const e=this._buff.readUInt32BE(this._offset);this._offset+=4;const t=this._buff.slice(this._offset,this._offset+e);return this._offset+=e,t}static sizeMixedArray(e){let t=0;t+=1;for(let i=0,r=e.length;i<r;i++){const s=e[i];switch(t+=1,s.type){case tn.String:t+=this.sizeLongString(s.value);break;case tn.VSBuffer:t+=this.sizeVSBuffer(s.value);break;case tn.SerializedObjectWithBuffers:t+=this.sizeUInt32,t+=this.sizeLongString(s.value);for(let o=0;o<s.buffers.length;++o)t+=this.sizeVSBuffer(s.buffers[o]);break}}return t}writeMixedArray(e){this._buff.writeUInt8(e.length,this._offset),this._offset+=1;for(let t=0,i=e.length;t<i;t++){const r=e[t];switch(r.type){case tn.String:this.writeUInt8(tn.String),this.writeLongString(r.value);break;case tn.VSBuffer:this.writeUInt8(tn.VSBuffer),this.writeVSBuffer(r.value);break;case tn.SerializedObjectWithBuffers:this.writeUInt8(tn.SerializedObjectWithBuffers),this.writeUInt32(r.buffers.length),this.writeLongString(r.value);for(let s=0;s<r.buffers.length;++s)this.writeBuffer(r.buffers[s]);break;case tn.Undefined:this.writeUInt8(tn.Undefined);break}}}readMixedArray(){const e=this._buff.readUInt8(this._offset);this._offset+=1;const t=new Array(e);for(let i=0;i<e;i++)switch(this.readUInt8()){case tn.String:t[i]=this.readLongString();break;case tn.VSBuffer:t[i]=this.readVSBuffer();break;case tn.SerializedObjectWithBuffers:{const s=this.readUInt32(),o=this.readLongString(),a=[];for(let l=0;l<s;++l)a.push(this.readVSBuffer());t[i]=new hi(VI(o,a,null));break}case tn.Undefined:t[i]=void 0;break}return t}};ah.sizeUInt32=4;let Ot=ah;var Kl;(function(n){n[n.Simple=0]="Simple",n[n.Mixed=1]="Mixed"})(Kl||(Kl={}));class Ni{static _useMixedArgSerialization(e){for(let t=0,i=e.length;t<i;t++)if(e[t]instanceof Pe||e[t]instanceof hi||typeof e[t]>"u")return!0;return!1}static serializeRequestArguments(e,t){if(this._useMixedArgSerialization(e)){const i=[];for(let r=0,s=e.length;r<s;r++){const o=e[r];if(o instanceof Pe)i[r]={type:tn.VSBuffer,value:o};else if(typeof o>"u")i[r]={type:tn.Undefined};else if(o instanceof hi){const{jsonString:a,referencedBuffers:l}=rE(o.value,t);i[r]={type:tn.SerializedObjectWithBuffers,value:Pe.fromString(a),buffers:l}}else i[r]={type:tn.String,value:Pe.fromString(sE(o,t))}}return{type:Kl.Mixed,args:i}}return{type:Kl.Simple,args:sE(e,t)}}static serializeRequest(e,t,i,r,s){switch(r.type){case Kl.Simple:return this._requestJSONArgs(e,t,i,r.args,s);case Kl.Mixed:return this._requestMixedArgs(e,t,i,r.args,s)}}static _requestJSONArgs(e,t,i,r,s){const o=Pe.fromString(i),a=Pe.fromString(r);let l=0;l+=Ot.sizeUInt8(),l+=Ot.sizeShortString(o),l+=Ot.sizeLongString(a);const c=Ot.alloc(s?St.RequestJSONArgsWithCancellation:St.RequestJSONArgs,e,l);return c.writeUInt8(t),c.writeShortString(o),c.writeLongString(a),c.buffer}static deserializeRequestJSONArgs(e){const t=e.readUInt8(),i=e.readShortString(),r=e.readLongString();return{rpcId:t,method:i,args:JSON.parse(r)}}static _requestMixedArgs(e,t,i,r,s){const o=Pe.fromString(i);let a=0;a+=Ot.sizeUInt8(),a+=Ot.sizeShortString(o),a+=Ot.sizeMixedArray(r);const l=Ot.alloc(s?St.RequestMixedArgsWithCancellation:St.RequestMixedArgs,e,a);return l.writeUInt8(t),l.writeShortString(o),l.writeMixedArray(r),l.buffer}static deserializeRequestMixedArgs(e){const t=e.readUInt8(),i=e.readShortString(),r=e.readMixedArray(),s=new Array(r.length);for(let o=0,a=r.length;o<a;o++){const l=r[o];typeof l=="string"?s[o]=JSON.parse(l):s[o]=l}return{rpcId:t,method:i,args:s}}static serializeAcknowledged(e){return Ot.alloc(St.Acknowledged,e,0).buffer}static serializeCancel(e){return Ot.alloc(St.Cancel,e,0).buffer}static serializeReplyOK(e,t,i){if(typeof t>"u")return this._serializeReplyOKEmpty(e);if(t instanceof Pe)return this._serializeReplyOKVSBuffer(e,t);if(t instanceof hi){const{jsonString:r,referencedBuffers:s}=rE(t.value,i,!0);return this._serializeReplyOKJSONWithBuffers(e,r,s)}else return this._serializeReplyOKJSON(e,Yv(t,i))}static _serializeReplyOKEmpty(e){return Ot.alloc(St.ReplyOKEmpty,e,0).buffer}static _serializeReplyOKVSBuffer(e,t){let i=0;i+=Ot.sizeVSBuffer(t);const r=Ot.alloc(St.ReplyOKVSBuffer,e,i);return r.writeVSBuffer(t),r.buffer}static deserializeReplyOKVSBuffer(e){return e.readVSBuffer()}static _serializeReplyOKJSON(e,t){const i=Pe.fromString(t);let r=0;r+=Ot.sizeLongString(i);const s=Ot.alloc(St.ReplyOKJSON,e,r);return s.writeLongString(i),s.buffer}static _serializeReplyOKJSONWithBuffers(e,t,i){const r=Pe.fromString(t);let s=0;s+=Ot.sizeUInt32,s+=Ot.sizeLongString(r);for(const a of i)s+=Ot.sizeVSBuffer(a);const o=Ot.alloc(St.ReplyOKJSONWithBuffers,e,s);o.writeUInt32(i.length),o.writeLongString(r);for(const a of i)o.writeBuffer(a);return o.buffer}static deserializeReplyOKJSON(e){const t=e.readLongString();return JSON.parse(t)}static deserializeReplyOKJSONWithBuffers(e,t){const i=e.readUInt32(),r=e.readLongString(),s=[];for(let o=0;o<i;++o)s.push(e.readVSBuffer());return new hi(VI(r,s,t))}static serializeReplyErr(e,t){const i=t?Yv(lu(t),null):void 0;if(typeof i!="string")return this._serializeReplyErrEmpty(e);const r=Pe.fromString(i);let s=0;s+=Ot.sizeLongString(r);const o=Ot.alloc(St.ReplyErrError,e,s);return o.writeLongString(r),o.buffer}static deserializeReplyErrError(e){const t=e.readLongString();return JSON.parse(t)}static _serializeReplyErrEmpty(e){return Ot.alloc(St.ReplyErrEmpty,e,0).buffer}}var St;(function(n){n[n.RequestJSONArgs=1]="RequestJSONArgs",n[n.RequestJSONArgsWithCancellation=2]="RequestJSONArgsWithCancellation",n[n.RequestMixedArgs=3]="RequestMixedArgs",n[n.RequestMixedArgsWithCancellation=4]="RequestMixedArgsWithCancellation",n[n.Acknowledged=5]="Acknowledged",n[n.Cancel=6]="Cancel",n[n.ReplyOKEmpty=7]="ReplyOKEmpty",n[n.ReplyOKVSBuffer=8]="ReplyOKVSBuffer",n[n.ReplyOKJSON=9]="ReplyOKJSON",n[n.ReplyOKJSONWithBuffers=10]="ReplyOKJSONWithBuffers",n[n.ReplyErrError=11]="ReplyErrError",n[n.ReplyErrEmpty=12]="ReplyErrEmpty"})(St||(St={}));var tn;(function(n){n[n.String=1]="String",n[n.VSBuffer=2]="VSBuffer",n[n.SerializedObjectWithBuffers=3]="SerializedObjectWithBuffers",n[n.Undefined=4]="Undefined"})(tn||(tn={}));function wx(n){if(!n)return;const e=n.indexOf("+");return e<0?n:n.substr(0,e)}const tT=["AI","Azure","Chat","Data Science","Debuggers","Extension Packs","Education","Formatters","Keymaps","Language Packs","Linters","Machine Learning","Notebooks","Programming Languages","SCM Providers","Snippets","Testing","Themes","Visualization","Other"];var oE;(function(n){n[n.System=0]="System",n[n.User=1]="User"})(oE||(oE={}));var Kv;(function(n){n.WIN32_X64="win32-x64",n.WIN32_ARM64="win32-arm64",n.LINUX_X64="linux-x64",n.LINUX_ARM64="linux-arm64",n.LINUX_ARMHF="linux-armhf",n.ALPINE_X64="alpine-x64",n.ALPINE_ARM64="alpine-arm64",n.DARWIN_X64="darwin-x64",n.DARWIN_ARM64="darwin-arm64",n.WEB="web",n.UNIVERSAL="universal",n.UNKNOWN="unknown",n.UNDEFINED="undefined"})(Kv||(Kv={}));class Ke{constructor(e){this.value=e,this._lower=e.toLowerCase()}static equals(e,t){if(typeof e>"u"||e===null)return typeof t>"u"||t===null;if(typeof t>"u"||t===null)return!1;if(typeof e=="string"||typeof t=="string"){const i=typeof e=="string"?e:e.value,r=typeof t=="string"?t:t.value;return ca(i,r)}return e._lower===t._lower}static toKey(e){return typeof e=="string"?e.toLowerCase():e._lower}}class Dl{get size(){return this._set.size}constructor(e){if(this._set=new Set,e)for(const t of e)this.add(t)}add(e){this._set.add(Ke.toKey(e))}delete(e){return this._set.delete(Ke.toKey(e))}has(e){return this._set.has(Ke.toKey(e))}}class Ms{constructor(){this._map=new Map}clear(){this._map.clear()}delete(e){this._map.delete(Ke.toKey(e))}get(e){return this._map.get(Ke.toKey(e))}has(e){return this._map.has(Ke.toKey(e))}set(e,t){this._map.set(Ke.toKey(e),t)}values(){return this._map.values()}forEach(e){this._map.forEach(e)}[Symbol.iterator](){return this._map[Symbol.iterator]()}}class zI extends Error{constructor(e,t,i){super(`Error in extension ${Ke.toKey(e)}: ${i??t.message}`,{cause:t}),this.name="ExtensionError",this.extension=e}}var lr;(function(n){n.serviceIds=new Map,n.DI_TARGET="$di$target",n.DI_DEPENDENCIES="$di$dependencies";function e(t){return t[n.DI_DEPENDENCIES]||[]}n.getServiceDependencies=e})(lr||(lr={}));const zf=De("instantiationService");function nT(n,e,t){e[lr.DI_TARGET]===e?e[lr.DI_DEPENDENCIES].push({id:n,index:t}):(e[lr.DI_DEPENDENCIES]=[{id:n,index:t}],e[lr.DI_TARGET]=e)}function De(n){if(lr.serviceIds.has(n))return lr.serviceIds.get(n);const e=function(t,i,r){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");nT(e,t,r)};return e.toString=()=>n,lr.serviceIds.set(n,e),e}const ct=De("logService"),Qu=De("loggerService");class rr{constructor(e,t=[],i=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=i}}const qI=[];var gt;(function(n){n[n.Eager=0]="Eager",n[n.Delayed=1]="Delayed"})(gt||(gt={}));function bt(n,e,t){e instanceof rr||(e=new rr(e,[],!!t)),qI.push([n,e])}function iT(){return qI}class bx{constructor(...e){this._entries=new Map;for(const[t,i]of e)this.set(t,i)}set(e,t){const i=this._entries.get(e);return this._entries.set(e,t),i}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}}const In=De("IExtHostInitDataService");let rT=class{constructor(e,t){this.key=e,this.data=t,this.incoming=new Map,this.outgoing=new Map}};class aE{constructor(e){this._hashFn=e,this._nodes=new Map}roots(){const e=[];for(const t of this._nodes.values())t.outgoing.size===0&&e.push(t);return e}insertEdge(e,t){const i=this.lookupOrInsertNode(e),r=this.lookupOrInsertNode(t);i.outgoing.set(r.key,r),r.incoming.set(i.key,i)}removeNode(e){const t=this._hashFn(e);this._nodes.delete(t);for(const i of this._nodes.values())i.outgoing.delete(t),i.incoming.delete(t)}lookupOrInsertNode(e){const t=this._hashFn(e);let i=this._nodes.get(t);return i||(i=new rT(t,e),this._nodes.set(t,i)),i}lookup(e){return this._nodes.get(this._hashFn(e))}isEmpty(){return this._nodes.size===0}toString(){const e=[];for(const[t,i]of this._nodes)e.push(`${t}
	(-> incoming)[${[...i.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...i.outgoing.keys()].join(",")}]
`);return e.join(`
`)}findCycleSlow(){for(const[e,t]of this._nodes){const i=new Set([e]),r=this._findCycle(t,i);if(r)return r}}_findCycle(e,t){for(const[i,r]of e.outgoing){if(t.has(i))return[...t,i].join(" -> ");t.add(i);const s=this._findCycle(r,t);if(s)return s;t.delete(i)}}}const sT=!1;class lE extends Error{constructor(e){super("cyclic dependency between services"),this.message=e.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}}class lg{constructor(e=new bx,t=!1,i,r=sT){this._services=e,this._strict=t,this._parent=i,this._enableTracing=r,this._isDisposed=!1,this._servicesToMaybeDispose=new Set,this._children=new Set,this._activeInstantiations=new Set,this._services.set(zf,this),this._globalGraph=r?(i==null?void 0:i._globalGraph)??new aE(s=>s):void 0}dispose(){if(!this._isDisposed){this._isDisposed=!0,Ns(this._children),this._children.clear();for(const e of this._servicesToMaybeDispose)K7(e)&&e.dispose();this._servicesToMaybeDispose.clear()}}_throwIfDisposed(){if(this._isDisposed)throw new Error("InstantiationService has been disposed")}createChild(e,t){this._throwIfDisposed();const i=this,r=new class extends lg{dispose(){i._children.delete(r),super.dispose()}}(e,this._strict,this,this._enableTracing);return this._children.add(r),t==null||t.add(r),r}invokeFunction(e,...t){this._throwIfDisposed();const i=Ld.traceInvocation(this._enableTracing,e);let r=!1;try{return e({get:o=>{if(r)throw sx("service accessor is only valid during the invocation of its target method");const a=this._getOrCreateServiceInstance(o,i);if(!a)throw new Error(`[invokeFunction] unknown service '${o}'`);return a}},...t)}finally{r=!0,i.stop()}}createInstance(e,...t){this._throwIfDisposed();let i,r;return e instanceof rr?(i=Ld.traceCreation(this._enableTracing,e.ctor),r=this._createInstance(e.ctor,e.staticArguments.concat(t),i)):(i=Ld.traceCreation(this._enableTracing,e),r=this._createInstance(e,t,i)),i.stop(),r}_createInstance(e,t=[],i){const r=lr.getServiceDependencies(e).sort((a,l)=>a.index-l.index),s=[];for(const a of r){const l=this._getOrCreateServiceInstance(a.id,i);l||this._throwIfStrict(`[createInstance] ${e.name} depends on UNKNOWN service ${a.id}.`,!1),s.push(l)}const o=r.length>0?r[0].index:t.length;if(t.length!==o){console.trace(`[createInstance] First service dependency of ${e.name} at position ${o+1} conflicts with ${t.length} static arguments`);const a=o-t.length;a>0?t=t.concat(new Array(a)):t=t.slice(0,o)}return Reflect.construct(e,t.concat(s))}_setCreatedServiceInstance(e,t){if(this._services.get(e)instanceof rr)this._services.set(e,t);else if(this._parent)this._parent._setCreatedServiceInstance(e,t);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(e){const t=this._services.get(e);return!t&&this._parent?this._parent._getServiceInstanceOrDescriptor(e):t}_getOrCreateServiceInstance(e,t){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(e));const i=this._getServiceInstanceOrDescriptor(e);return i instanceof rr?this._safeCreateAndCacheServiceInstance(e,i,t.branch(e,!0)):(t.branch(e,!1),i)}_safeCreateAndCacheServiceInstance(e,t,i){if(this._activeInstantiations.has(e))throw new Error(`illegal state - RECURSIVELY instantiating service '${e}'`);this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,t,i)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,t,i){var l;const r=new aE(c=>c.id.toString());let s=0;const o=[{id:e,desc:t,_trace:i}],a=new Set;for(;o.length;){const c=o.pop();if(!a.has(String(c.id))){if(a.add(String(c.id)),r.lookupOrInsertNode(c),s++>1e3)throw new lE(r);for(const u of lr.getServiceDependencies(c.desc.ctor)){const d=this._getServiceInstanceOrDescriptor(u.id);if(d||this._throwIfStrict(`[createInstance] ${e} depends on ${u.id} which is NOT registered.`,!0),(l=this._globalGraph)==null||l.insertEdge(String(c.id),String(u.id)),d instanceof rr){const f={id:u.id,desc:d,_trace:c._trace.branch(u.id,!0)};r.lookup(f)||o.push(f),r.insertEdge(c,f)}}}}for(;;){const c=r.roots();if(c.length===0){if(!r.isEmpty())throw new lE(r);break}for(const{data:u}of c){if(this._getServiceInstanceOrDescriptor(u.id)instanceof rr){const f=this._createServiceInstanceWithOwner(u.id,u.desc.ctor,u.desc.staticArguments,u.desc.supportsDelayedInstantiation,u._trace);this._setCreatedServiceInstance(u.id,f)}r.removeNode(u)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,t,i=[],r,s){if(this._services.get(e)instanceof rr)return this._createServiceInstance(e,t,i,r,s,this._servicesToMaybeDispose);if(this._parent)return this._parent._createServiceInstanceWithOwner(e,t,i,r,s);throw new Error(`illegalState - creating UNKNOWN service instance ${t.name}`)}_createServiceInstance(e,t,i=[],r,s,o){if(r){const a=new lg(void 0,this._strict,this,this._enableTracing);a._globalGraphImplicitDependency=String(e);const l=new Map,c=new G9(()=>{const u=a._createInstance(t,i,s);for(const[d,f]of l){const p=u[d];if(typeof p=="function")for(const w of f)w.disposable=p.apply(u,w.listener)}return l.clear(),o.add(u),u});return new Proxy(Object.create(null),{get(u,d){if(!c.isInitialized&&typeof d=="string"&&(d.startsWith("onDid")||d.startsWith("onWill"))){let w=l.get(d);return w||(w=new Hf,l.set(d,w)),(m,x,k)=>{if(c.isInitialized)return c.value[d](m,x,k);{const D={listener:[m,x,k],disposable:void 0},B=w.push(D);return Se(()=>{var z;B(),(z=D.disposable)==null||z.dispose()})}}}if(d in u)return u[d];const f=c.value;let p=f[d];return typeof p!="function"||(p=p.bind(f),u[d]=p),p},set(u,d,f){return c.value[d]=f,!0},getPrototypeOf(u){return t.prototype}})}else{const a=this._createInstance(t,i,s);return o.add(a),a}}_throwIfStrict(e,t){if(t&&console.warn(e),this._strict)throw new Error(e)}}var Jo;(function(n){n[n.None=0]="None",n[n.Creation=1]="Creation",n[n.Invocation=2]="Invocation",n[n.Branch=3]="Branch"})(Jo||(Jo={}));const oi=class oi{static traceInvocation(e,t){return e?new oi(Jo.Invocation,t.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):oi._None}static traceCreation(e,t){return e?new oi(Jo.Creation,t.name):oi._None}constructor(e,t){this.type=e,this.name=t,this._start=Date.now(),this._dep=[]}branch(e,t){const i=new oi(Jo.Branch,e.toString());return this._dep.push([e,t,i]),i}stop(){const e=Date.now()-this._start;oi._totals+=e;let t=!1;function i(s,o){const a=[],l=new Array(s+1).join("	");for(const[c,u,d]of o._dep)if(u&&d){t=!0,a.push(`${l}CREATES -> ${c}`);const f=i(s+1,d);f&&a.push(f)}else a.push(`${l}uses -> ${c}`);return a.join(`
`)}const r=[`${this.type===Jo.Creation?"CREATE":"CALL"} ${this.name}`,`${i(1,this)}`,`DONE, took ${e.toFixed(2)}ms (grand total ${oi._totals.toFixed(2)}ms)`];(e>2||t)&&oi.all.add(r.join(`
`))}};oi.all=new Set,oi._None=new class extends oi{constructor(){super(Jo.None,null)}stop(){}branch(){return this}},oi._totals=0;let Ld=oi;const tt=De("IExtHostRpcService");class oT{constructor(e){this.getProxy=e.getProxy.bind(e),this.set=e.set.bind(e),this.dispose=e.dispose.bind(e),this.assertRegistered=e.assertRegistered.bind(e),this.drain=e.drain.bind(e)}}const s_=De("IURITransformerService");class aT{constructor(e){e?(this.transformIncoming=e.transformIncoming.bind(e),this.transformOutgoing=e.transformOutgoing.bind(e),this.transformOutgoingURI=e.transformOutgoingURI.bind(e),this.transformOutgoingScheme=e.transformOutgoingScheme.bind(e)):(this.transformIncoming=t=>t,this.transformOutgoing=t=>t,this.transformOutgoingURI=t=>t,this.transformOutgoingScheme=t=>t)}}function V(n,e,t,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s}function F(n,e){return function(t,i){e(t,i,n)}}class lT{constructor(){this._value="",this._pos=0}reset(e){return this._value=e,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(e){const t=e.charCodeAt(0),i=this._value.charCodeAt(this._pos);return t-i}value(){return this._value[this._pos]}}class cT{constructor(e=!0){this._caseSensitive=e}reset(e){return this._value=e,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let e=!0;for(;this._to<this._value.length;this._to++)if(this._value.charCodeAt(this._to)===P.Period)if(e)this._from++;else break;else e=!1;return this}cmp(e){return this._caseSensitive?gx(e,this._value,0,e.length,this._from,this._to):Wf(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class jI{constructor(e=!0,t=!0){this._splitOnBackslash=e,this._caseSensitive=t}reset(e){this._from=0,this._to=0,this._value=e,this._valueLen=e.length;for(let t=e.length-1;t>=0;t--,this._valueLen--){const i=this._value.charCodeAt(t);if(!(i===P.Slash||this._splitOnBackslash&&i===P.Backslash))break}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let e=!0;for(;this._to<this._valueLen;this._to++){const t=this._value.charCodeAt(this._to);if(t===P.Slash||this._splitOnBackslash&&t===P.Backslash)if(e)this._from++;else break;else e=!1}return this}cmp(e){return this._caseSensitive?gx(e,this._value,0,e.length,this._from,this._to):Wf(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}var hn;(function(n){n[n.Scheme=1]="Scheme",n[n.Authority=2]="Authority",n[n.Path=3]="Path",n[n.Query=4]="Query",n[n.Fragment=5]="Fragment"})(hn||(hn={}));class GI{constructor(e,t){this._ignorePathCasing=e,this._ignoreQueryAndFragment=t,this._states=[],this._stateIdx=0}reset(e){return this._value=e,this._states=[],this._value.scheme&&this._states.push(hn.Scheme),this._value.authority&&this._states.push(hn.Authority),this._value.path&&(this._pathIterator=new jI(!1,!this._ignorePathCasing(e)),this._pathIterator.reset(e.path),this._pathIterator.value()&&this._states.push(hn.Path)),this._ignoreQueryAndFragment(e)||(this._value.query&&this._states.push(hn.Query),this._value.fragment&&this._states.push(hn.Fragment)),this._stateIdx=0,this}next(){return this._states[this._stateIdx]===hn.Path&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return this._states[this._stateIdx]===hn.Path&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(e){if(this._states[this._stateIdx]===hn.Scheme)return q2(e,this._value.scheme);if(this._states[this._stateIdx]===hn.Authority)return q2(e,this._value.authority);if(this._states[this._stateIdx]===hn.Path)return this._pathIterator.cmp(e);if(this._states[this._stateIdx]===hn.Query)return fl(e,this._value.query);if(this._states[this._stateIdx]===hn.Fragment)return fl(e,this._value.fragment);throw new Error}value(){if(this._states[this._stateIdx]===hn.Scheme)return this._value.scheme;if(this._states[this._stateIdx]===hn.Authority)return this._value.authority;if(this._states[this._stateIdx]===hn.Path)return this._pathIterator.value();if(this._states[this._stateIdx]===hn.Query)return this._value.query;if(this._states[this._stateIdx]===hn.Fragment)return this._value.fragment;throw new Error}}const lh=class lh{static wrap(e){return e===void 0?lh.Val:e}static unwrap(e){return e===lh.Val?void 0:e}};lh.Val=Symbol("undefined_placeholder");let is=lh;class ap{constructor(){this.height=1}isEmpty(){return!this.left&&!this.mid&&!this.right&&this.value===void 0}rotateLeft(){const e=this.right;return this.right=e.left,e.left=this,this.updateHeight(),e.updateHeight(),e}rotateRight(){const e=this.left;return this.left=e.right,e.right=this,this.updateHeight(),e.updateHeight(),e}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){var e;return((e=this.left)==null?void 0:e.height)??0}get heightRight(){var e;return((e=this.right)==null?void 0:e.height)??0}}var Nt;(function(n){n[n.Left=-1]="Left",n[n.Mid=0]="Mid",n[n.Right=1]="Right"})(Nt||(Nt={}));class ki{static forUris(e=()=>!1,t=()=>!1){return new ki(new GI(e,t))}static forPaths(e=!1){return new ki(new jI(void 0,!e))}static forStrings(){return new ki(new lT)}static forConfigKeys(){return new ki(new cT)}constructor(e){this._iter=e}clear(){this._root=void 0}fill(e,t){if(t){const i=t.slice(0);y2(i);for(const r of i)this.set(r,e)}else{const i=e.slice(0);y2(i);for(const r of i)this.set(r[0],r[1])}}set(e,t){const i=this._iter.reset(e);let r;this._root||(this._root=new ap,this._root.segment=i.value());const s=[];for(r=this._root;;){const a=i.cmp(r.segment);if(a>0)r.left||(r.left=new ap,r.left.segment=i.value()),s.push([Nt.Left,r]),r=r.left;else if(a<0)r.right||(r.right=new ap,r.right.segment=i.value()),s.push([Nt.Right,r]),r=r.right;else if(i.hasNext())i.next(),r.mid||(r.mid=new ap,r.mid.segment=i.value()),s.push([Nt.Mid,r]),r=r.mid;else break}const o=is.unwrap(r.value);r.value=is.wrap(t),r.key=e;for(let a=s.length-1;a>=0;a--){const l=s[a][1];l.updateHeight();const c=l.balanceFactor();if(c<-1||c>1){const u=s[a][0],d=s[a+1][0];if(u===Nt.Right&&d===Nt.Right)s[a][1]=l.rotateLeft();else if(u===Nt.Left&&d===Nt.Left)s[a][1]=l.rotateRight();else if(u===Nt.Right&&d===Nt.Left)l.right=s[a+1][1]=s[a+1][1].rotateRight(),s[a][1]=l.rotateLeft();else if(u===Nt.Left&&d===Nt.Right)l.left=s[a+1][1]=s[a+1][1].rotateLeft(),s[a][1]=l.rotateRight();else throw new Error;if(a>0)switch(s[a-1][0]){case Nt.Left:s[a-1][1].left=s[a][1];break;case Nt.Right:s[a-1][1].right=s[a][1];break;case Nt.Mid:s[a-1][1].mid=s[a][1];break}else this._root=s[0][1]}}return o}get(e){var t;return is.unwrap((t=this._getNode(e))==null?void 0:t.value)}_getNode(e){const t=this._iter.reset(e);let i=this._root;for(;i;){const r=t.cmp(i.segment);if(r>0)i=i.left;else if(r<0)i=i.right;else if(t.hasNext())t.next(),i=i.mid;else break}return i}has(e){const t=this._getNode(e);return!((t==null?void 0:t.value)===void 0&&(t==null?void 0:t.mid)===void 0)}delete(e){return this._delete(e,!1)}deleteSuperstr(e){return this._delete(e,!0)}_delete(e,t){const i=this._iter.reset(e),r=[];let s=this._root;for(;s;){const o=i.cmp(s.segment);if(o>0)r.push([Nt.Left,s]),s=s.left;else if(o<0)r.push([Nt.Right,s]),s=s.right;else if(i.hasNext())i.next(),r.push([Nt.Mid,s]),s=s.mid;else break}if(s){if(t?(s.left=void 0,s.mid=void 0,s.right=void 0,s.height=1):(s.key=void 0,s.value=void 0),!s.mid&&!s.value)if(s.left&&s.right){const o=this._min(s.right);if(o.key){const{key:a,value:l,segment:c}=o;this._delete(o.key,!1),s.key=a,s.value=l,s.segment=c}}else{const o=s.left??s.right;if(r.length>0){const[a,l]=r[r.length-1];switch(a){case Nt.Left:l.left=o;break;case Nt.Mid:l.mid=o;break;case Nt.Right:l.right=o;break}}else this._root=o}for(let o=r.length-1;o>=0;o--){const a=r[o][1];a.updateHeight();const l=a.balanceFactor();if(l>1?(a.right.balanceFactor()>=0||(a.right=a.right.rotateRight()),r[o][1]=a.rotateLeft()):l<-1&&(a.left.balanceFactor()<=0||(a.left=a.left.rotateLeft()),r[o][1]=a.rotateRight()),o>0)switch(r[o-1][0]){case Nt.Left:r[o-1][1].left=r[o][1];break;case Nt.Right:r[o-1][1].right=r[o][1];break;case Nt.Mid:r[o-1][1].mid=r[o][1];break}else this._root=r[0][1]}}}_min(e){for(;e.left;)e=e.left;return e}findSubstr(e){const t=this._iter.reset(e);let i=this._root,r;for(;i;){const s=t.cmp(i.segment);if(s>0)i=i.left;else if(s<0)i=i.right;else if(t.hasNext())t.next(),r=is.unwrap(i.value)||r,i=i.mid;else break}return i&&is.unwrap(i.value)||r}findSuperstr(e){return this._findSuperstrOrElement(e,!1)}_findSuperstrOrElement(e,t){const i=this._iter.reset(e);let r=this._root;for(;r;){const s=i.cmp(r.segment);if(s>0)r=r.left;else if(s<0)r=r.right;else if(i.hasNext())i.next(),r=r.mid;else return r.mid?this._entries(r.mid):t?is.unwrap(r.value):void 0}}hasElementOrSubtree(e){return this._findSuperstrOrElement(e,!0)!==void 0}forEach(e){for(const[t,i]of this)e(i,t)}*[Symbol.iterator](){yield*this._entries(this._root)}_entries(e){const t=[];return this._dfsEntries(e,t),t[Symbol.iterator]()}_dfsEntries(e,t){e&&(e.left&&this._dfsEntries(e.left,t),e.value!==void 0&&t.push([e.key,is.unwrap(e.value)]),e.mid&&this._dfsEntries(e.mid,t),e.right&&this._dfsEntries(e.right,t))}_isBalanced(){const e=t=>{if(!t)return!0;const i=t.balanceFactor();return i<-1||i>1?!1:e(t.left)&&e(t.right)};return e(this._root)}}function _t(n){if(!n||typeof n!="object"||n instanceof RegExp)return n;const e=Array.isArray(n)?[]:{};return Object.entries(n).forEach(([t,i])=>{e[t]=i&&typeof i=="object"?_t(i):i}),e}function QI(n){if(!n||typeof n!="object")return n;const e=[n];for(;e.length>0;){const t=e.shift();for(const i in t)if(JI.call(t,i)){const r=t[i];typeof r=="object"&&!Object.isFrozen(r)&&!Q7(r)&&e.push(r)}}return n}const JI=Object.prototype.hasOwnProperty;function pu(n,e){return ew(n,e,new Set)}function ew(n,e,t){if(Yt(n))return n;const i=e(n);if(typeof i<"u")return i;if(Array.isArray(n)){const r=[];for(const s of n)r.push(ew(s,e,t));return r}if(Zt(n)){if(t.has(n))throw new Error("Cannot clone recursive data-structure");t.add(n);const r={};for(const s in n)JI.call(n,s)&&(r[s]=ew(n[s],e,t));return t.delete(n),r}return n}function gl(n,e,t=!0){return Zt(n)?(Zt(e)&&Object.keys(e).forEach(i=>{i in n?t&&(Zt(n[i])&&Zt(e[i])?gl(n[i],e[i],t):n[i]=e[i]):n[i]=e[i]}),n):e}function fi(n,e){if(n===e)return!0;if(n==null||e===null||e===void 0||typeof n!=typeof e||typeof n!="object"||Array.isArray(n)!==Array.isArray(e))return!1;let t,i;if(Array.isArray(n)){if(n.length!==e.length)return!1;for(t=0;t<n.length;t++)if(!fi(n[t],e[t]))return!1}else{const r=[];for(i in n)r.push(i);r.sort();const s=[];for(i in e)s.push(i);if(s.sort(),!fi(r,s))return!1;for(t=0;t<r.length;t++)if(!fi(n[r[t]],e[r[t]]))return!1}return!0}function uT(n){const e=new Set;return JSON.stringify(n,(t,i)=>{if(Zt(i)||Array.isArray(i)){if(e.has(i))return"[Circular]";e.add(i)}return typeof i=="bigint"?`[BigInt ${i.toString()}]`:i})}function cE(n,e){const t=Object.create(null);for(const[i,r]of Object.entries(n))e(i,r)&&(t[i]=r);return t}class dT{constructor(){this._next=0}getNext(){return this._next++}}var Wa;(function(n){n[n.Unknown=0]="Unknown",n[n.File=1]="File",n[n.Directory=2]="Directory",n[n.SymbolicLink=64]="SymbolicLink"})(Wa||(Wa={}));var gu;(function(n){n[n.Readonly=1]="Readonly",n[n.Locked=2]="Locked"})(gu||(gu={}));var Xs;(function(n){n[n.UPDATED=2]="UPDATED",n[n.ADDED=4]="ADDED",n[n.DELETED=8]="DELETED"})(Xs||(Xs={}));var Cr;(function(n){n[n.None=0]="None",n[n.FileReadWrite=2]="FileReadWrite",n[n.FileOpenReadWriteClose=4]="FileOpenReadWriteClose",n[n.FileReadStream=16]="FileReadStream",n[n.FileFolderCopy=8]="FileFolderCopy",n[n.PathCaseSensitive=1024]="PathCaseSensitive",n[n.Readonly=2048]="Readonly",n[n.Trash=4096]="Trash",n[n.FileWriteUnlock=8192]="FileWriteUnlock",n[n.FileAtomicRead=16384]="FileAtomicRead",n[n.FileAtomicWrite=32768]="FileAtomicWrite",n[n.FileAtomicDelete=65536]="FileAtomicDelete",n[n.FileClone=131072]="FileClone"})(Cr||(Cr={}));var Ne;(function(n){n.FileExists="EntryExists",n.FileNotFound="EntryNotFound",n.FileNotADirectory="EntryNotADirectory",n.FileIsADirectory="EntryIsADirectory",n.FileExceedsStorageQuota="EntryExceedsStorageQuota",n.FileTooLarge="EntryTooLarge",n.FileWriteLocked="EntryWriteLocked",n.NoPermissions="NoPermissions",n.Unavailable="Unavailable",n.Unknown="Unknown"})(Ne||(Ne={}));class o_ extends Error{static create(e,t){const i=new o_(e.toString(),t);return XI(i,t),i}constructor(e,t){super(e),this.code=t}}function XI(n,e){return n.name=e?`${e} (FileSystemError)`:"FileSystemError",n}function cg(n){if(!n)return Ne.Unknown;if(n instanceof o_)return n.code;const e=/^(.+) \(FileSystemError\)$/.exec(n.name);if(!e)return Ne.Unknown;switch(e[1]){case Ne.FileExists:return Ne.FileExists;case Ne.FileIsADirectory:return Ne.FileIsADirectory;case Ne.FileNotADirectory:return Ne.FileNotADirectory;case Ne.FileNotFound:return Ne.FileNotFound;case Ne.FileTooLarge:return Ne.FileTooLarge;case Ne.FileWriteLocked:return Ne.FileWriteLocked;case Ne.NoPermissions:return Ne.NoPermissions;case Ne.Unavailable:return Ne.Unavailable}return Ne.Unknown}function hT(n){if(n instanceof tw)return n.fileOperationResult;switch(cg(n)){case Ne.FileNotFound:return Ei.FILE_NOT_FOUND;case Ne.FileIsADirectory:return Ei.FILE_IS_DIRECTORY;case Ne.FileNotADirectory:return Ei.FILE_NOT_DIRECTORY;case Ne.FileWriteLocked:return Ei.FILE_WRITE_LOCKED;case Ne.NoPermissions:return Ei.FILE_PERMISSION_DENIED;case Ne.FileExists:return Ei.FILE_MOVE_CONFLICT;case Ne.FileTooLarge:return Ei.FILE_TOO_LARGE;default:return Ei.FILE_OTHER_ERROR}}var xr;(function(n){n[n.CREATE=0]="CREATE",n[n.DELETE=1]="DELETE",n[n.MOVE=2]="MOVE",n[n.COPY=3]="COPY",n[n.WRITE=4]="WRITE"})(xr||(xr={}));var sr;(function(n){n[n.UPDATED=0]="UPDATED",n[n.ADDED=1]="ADDED",n[n.DELETED=2]="DELETED"})(sr||(sr={}));const gc=class gc{constructor(e,t){this.ignorePathCasing=t,this.correlationId=void 0,this.added=new Ci(()=>{const i=ki.forUris(()=>this.ignorePathCasing);return i.fill(this.rawAdded.map(r=>[r,!0])),i}),this.updated=new Ci(()=>{const i=ki.forUris(()=>this.ignorePathCasing);return i.fill(this.rawUpdated.map(r=>[r,!0])),i}),this.deleted=new Ci(()=>{const i=ki.forUris(()=>this.ignorePathCasing);return i.fill(this.rawDeleted.map(r=>[r,!0])),i}),this.rawAdded=[],this.rawUpdated=[],this.rawDeleted=[];for(const i of e){switch(i.type){case sr.ADDED:this.rawAdded.push(i.resource);break;case sr.UPDATED:this.rawUpdated.push(i.resource);break;case sr.DELETED:this.rawDeleted.push(i.resource);break}this.correlationId!==gc.MIXED_CORRELATION&&(typeof i.cId=="number"?this.correlationId===void 0?this.correlationId=i.cId:this.correlationId!==i.cId&&(this.correlationId=gc.MIXED_CORRELATION):this.correlationId!==void 0&&(this.correlationId=gc.MIXED_CORRELATION))}}contains(e,...t){return this.doContains(e,{includeChildren:!1},...t)}affects(e,...t){return this.doContains(e,{includeChildren:!0},...t)}doContains(e,t,...i){if(!e)return!1;const r=i.length>0;return!!((!r||i.includes(sr.ADDED))&&(this.added.value.get(e)||t.includeChildren&&this.added.value.findSuperstr(e))||(!r||i.includes(sr.UPDATED))&&(this.updated.value.get(e)||t.includeChildren&&this.updated.value.findSuperstr(e))||(!r||i.includes(sr.DELETED))&&(this.deleted.value.findSubstr(e)||t.includeChildren&&this.deleted.value.findSuperstr(e)))}gotAdded(){return this.rawAdded.length>0}gotDeleted(){return this.rawDeleted.length>0}gotUpdated(){return this.rawUpdated.length>0}correlates(e){return this.correlationId===e}hasCorrelation(){return typeof this.correlationId=="number"}};gc.MIXED_CORRELATION=null;let uE=gc;class tw extends Error{constructor(e,t,i){super(e),this.fileOperationResult=t,this.options=i}}var Ei;(function(n){n[n.FILE_IS_DIRECTORY=0]="FILE_IS_DIRECTORY",n[n.FILE_NOT_FOUND=1]="FILE_NOT_FOUND",n[n.FILE_NOT_MODIFIED_SINCE=2]="FILE_NOT_MODIFIED_SINCE",n[n.FILE_MODIFIED_SINCE=3]="FILE_MODIFIED_SINCE",n[n.FILE_MOVE_CONFLICT=4]="FILE_MOVE_CONFLICT",n[n.FILE_WRITE_LOCKED=5]="FILE_WRITE_LOCKED",n[n.FILE_PERMISSION_DENIED=6]="FILE_PERMISSION_DENIED",n[n.FILE_TOO_LARGE=7]="FILE_TOO_LARGE",n[n.FILE_INVALID_PATH=8]="FILE_INVALID_PATH",n[n.FILE_NOT_DIRECTORY=9]="FILE_NOT_DIRECTORY",n[n.FILE_OTHER_ERROR=10]="FILE_OTHER_ERROR"})(Ei||(Ei={}));var dE;(function(n){n[n.FILE=0]="FILE",n[n.FOLDER=1]="FOLDER",n[n.ROOT_FOLDER=2]="ROOT_FOLDER"})(dE||(dE={}));const fT="";function hE(n){if(!(typeof n.size!="number"||typeof n.mtime!="number"))return n.mtime.toString(29)+n.size.toString(31)}const an=class an{static formatSize(e){return Ua(e)||(e=0),e<an.KB?h(1863,"{0}B",e.toFixed(0)):e<an.MB?h(1864,"{0}KB",(e/an.KB).toFixed(2)):e<an.GB?h(1865,"{0}MB",(e/an.MB).toFixed(2)):e<an.TB?h(1866,"{0}GB",(e/an.GB).toFixed(2)):h(1867,"{0}TB",(e/an.TB).toFixed(2))}};an.KB=1024,an.MB=an.KB*an.KB,an.GB=an.MB*an.KB,an.TB=an.GB*an.KB;let fE=an;var _h;(function(n){n[n.Ignore=0]="Ignore",n[n.Info=1]="Info",n[n.Warning=2]="Warning",n[n.Error=3]="Error"})(_h||(_h={}));(function(n){const e="error",t="warning",i="warn",r="info",s="ignore";function o(l){return l?ca(e,l)?n.Error:ca(t,l)||ca(i,l)?n.Warning:ca(r,l)?n.Info:n.Ignore:n.Ignore}n.fromValue=o;function a(l){switch(l){case n.Error:return e;case n.Warning:return t;case n.Info:return r;default:return s}}n.toString=a})(_h||(_h={}));var qt=_h,pE;(function(n){n[n.DEFAULT=0]="DEFAULT",n[n.SILENT=1]="SILENT",n[n.URGENT=2]="URGENT"})(pE||(pE={}));var gE;(function(n){n[n.WORKSPACE=0]="WORKSPACE",n[n.PROFILE=1]="PROFILE",n[n.APPLICATION=2]="APPLICATION"})(gE||(gE={}));var mE;(function(n){n[n.OFF=0]="OFF",n[n.ERROR=1]="ERROR"})(mE||(mE={}));function pT(n){const e=n;return typeof(e==null?void 0:e.id)=="string"&&y.isUri(e.uri)}function gT(n){const e=n;return typeof(e==null?void 0:e.id)=="string"&&y.isUri(e.configPath)}var ug;(function(n){n[n.EMPTY=1]="EMPTY",n[n.FOLDER=2]="FOLDER",n[n.WORKSPACE=3]="WORKSPACE"})(ug||(ug={}));let mT=class{get folders(){return this._folders}set folders(e){this._folders=e,this.updateFoldersMap()}constructor(e,t,i,r,s){this._id=e,this._transient=i,this._configuration=r,this.ignorePathCasing=s,this.foldersMap=ki.forUris(this.ignorePathCasing,()=>!0),this.folders=t}update(e){this._id=e.id,this._configuration=e.configuration,this._transient=e.transient,this.ignorePathCasing=e.ignorePathCasing,this.folders=e.folders}get id(){return this._id}get transient(){return this._transient}get configuration(){return this._configuration}set configuration(e){this._configuration=e}getFolder(e){return e&&this.foldersMap.findSubstr(e)||null}updateFoldersMap(){this.foldersMap=ki.forUris(this.ignorePathCasing,()=>!0);for(const e of this.folders)this.foldersMap.set(e.uri,e)}toJSON(){return{id:this.id,folders:this.folders,transient:this.transient,configuration:this.configuration}}};class YI{constructor(e,t){this.raw=t,this.uri=e.uri,this.index=e.index,this.name=e.name}toResource(e){return An(this.uri,e)}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}}function rv(n){return new YI({uri:n,index:0,name:Jv(n)},{uri:n.toString()})}const _T="code-workspace";h(2362,"Code Workspace");class vT{constructor(){this._systemSchemes=new Set(Object.keys(oe)),this._providerInfo=new Map,this.extUri=new Vf(e=>{const t=this._providerInfo.get(e.scheme);return!(t===void 0||t&Cr.PathCaseSensitive)})}$acceptProviderInfos(e,t){t===null?this._providerInfo.delete(e.scheme):this._providerInfo.set(e.scheme,t)}isFreeScheme(e){return!this._providerInfo.has(e)&&!this._systemSchemes.has(e)}getCapabilities(e){return this._providerInfo.get(e)}}const Ju=De("IExtHostFileSystemInfo"),Mn=function(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);const n=new Uint8Array(16),e=[];for(let t=0;t<256;t++)e.push(t.toString(16).padStart(2,"0"));return function(){crypto.getRandomValues(n),n[6]=n[6]&15|64,n[8]=n[8]&63|128;let i=0,r="";return r+=e[n[i++]],r+=e[n[i++]],r+=e[n[i++]],r+=e[n[i++]],r+="-",r+=e[n[i++]],r+=e[n[i++]],r+="-",r+=e[n[i++]],r+=e[n[i++]],r+="-",r+=e[n[i++]],r+=e[n[i++]],r+="-",r+=e[n[i++]],r+=e[n[i++]],r+=e[n[i++]],r+=e[n[i++]],r+=e[n[i++]],r+=e[n[i++]],r}}(),nw=Object.freeze({create:n=>Yl(n.map(e=>e.toString())).join(`\r
`),split:n=>n.split(`\r
`),parse:n=>nw.split(n).filter(e=>!e.startsWith("#"))});var _E;(function(n){n[n.InitialConsonant=4352]="InitialConsonant",n[n.Vowel=4449]="Vowel",n[n.FinalConsonant=4520]="FinalConsonant",n[n.CompatibilityJamo=12593]="CompatibilityJamo"})(_E||(_E={}));var ee;(function(n){n[n.NUL=0]="NUL",n[n.A=65]="A",n[n.B=66]="B",n[n.C=67]="C",n[n.D=68]="D",n[n.E=69]="E",n[n.F=70]="F",n[n.G=71]="G",n[n.H=72]="H",n[n.I=73]="I",n[n.J=74]="J",n[n.K=75]="K",n[n.L=76]="L",n[n.M=77]="M",n[n.N=78]="N",n[n.O=79]="O",n[n.P=80]="P",n[n.Q=81]="Q",n[n.R=82]="R",n[n.S=83]="S",n[n.T=84]="T",n[n.U=85]="U",n[n.V=86]="V",n[n.W=87]="W",n[n.X=88]="X",n[n.Y=89]="Y",n[n.Z=90]="Z",n[n.a=97]="a",n[n.b=98]="b",n[n.c=99]="c",n[n.d=100]="d",n[n.e=101]="e",n[n.f=102]="f",n[n.g=103]="g",n[n.h=104]="h",n[n.i=105]="i",n[n.j=106]="j",n[n.k=107]="k",n[n.l=108]="l",n[n.m=109]="m",n[n.n=110]="n",n[n.o=111]="o",n[n.p=112]="p",n[n.q=113]="q",n[n.r=114]="r",n[n.s=115]="s",n[n.t=116]="t",n[n.u=117]="u",n[n.v=118]="v",n[n.w=119]="w",n[n.x=120]="x",n[n.y=121]="y",n[n.z=122]="z"})(ee||(ee={}));var Je;(function(n){n[n.fa=24934]="fa",n[n.fg=26470]="fg",n[n.fq=29030]="fq",n[n.fr=29286]="fr",n[n.ft=29798]="ft",n[n.fv=30310]="fv",n[n.fx=30822]="fx",n[n.hk=27496]="hk",n[n.hl=27752]="hl",n[n.ho=28520]="ho",n[n.ml=27757]="ml",n[n.nj=27246]="nj",n[n.nl=27758]="nl",n[n.np=28782]="np",n[n.qt=29809]="qt",n[n.rt=29810]="rt",n[n.sg=26483]="sg",n[n.sw=30579]="sw"})(Je||(Je={}));new Uint8Array([ee.r,ee.R,ee.s,ee.e,ee.E,ee.f,ee.a,ee.q,ee.Q,ee.t,ee.T,ee.d,ee.w,ee.W,ee.c,ee.z,ee.x,ee.v,ee.g]);new Uint16Array([ee.k,ee.o,ee.i,ee.O,ee.j,ee.p,ee.u,ee.P,ee.h,Je.hk,Je.ho,Je.hl,ee.y,ee.n,Je.nj,Je.np,Je.nl,ee.b,ee.m,Je.ml,ee.l]);new Uint16Array([ee.r,ee.R,Je.rt,ee.s,Je.sw,Je.sg,ee.e,ee.f,Je.fr,Je.fa,Je.fq,Je.ft,Je.fx,Je.fv,Je.fg,ee.a,ee.q,Je.qt,ee.t,ee.T,ee.d,ee.w,ee.c,ee.z,ee.x,ee.v,ee.g]);new Uint16Array([ee.r,ee.R,Je.rt,ee.s,Je.sw,Je.sg,ee.e,ee.E,ee.f,Je.fr,Je.fa,Je.fq,Je.ft,Je.fx,Je.fv,Je.fg,ee.a,ee.q,ee.Q,Je.qt,ee.t,ee.T,ee.d,ee.w,ee.W,ee.c,ee.z,ee.x,ee.v,ee.g,ee.k,ee.o,ee.i,ee.O,ee.j,ee.p,ee.u,ee.P,ee.h,Je.hk,Je.ho,Je.hl,ee.y,ee.n,Je.nj,Je.np,Je.nl,ee.b,ee.m,Je.ml,ee.l]);function ZI(...n){return function(e,t){for(let i=0,r=n.length;i<r;i++){const s=n[i](e,t);if(s)return s}return null}}eC.bind(void 0,!1);const KI=eC.bind(void 0,!0);function eC(n,e,t){if(!t||t.length<e.length)return null;let i;return n?i=mx(t,e):i=t.indexOf(e)===0,i?e.length>0?[{start:0,end:e.length}]:[]:null}function wT(n,e){const t=e.toLowerCase().indexOf(n.toLowerCase());return t===-1?null:[{start:t,end:t+n.length}]}function bT(n,e){return iw(n.toLowerCase(),e.toLowerCase(),0,0)}function iw(n,e,t,i){if(t===n.length)return[];if(i===e.length)return null;if(n[t]===e[i]){let r=null;return(r=iw(n,e,t+1,i+1))?nC({start:i,end:i+1},r):null}return iw(n,e,t,i+1)}function yx(n){return P.a<=n&&n<=P.z}function a_(n){return P.A<=n&&n<=P.Z}function xx(n){return P.Digit0<=n&&n<=P.Digit9}function yT(n){return n===P.Space||n===P.Tab||n===P.LineFeed||n===P.CarriageReturn}const xT=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(n=>xT.add(n.charCodeAt(0)));function tC(n){return yx(n)||a_(n)||xx(n)}function nC(n,e){return e.length===0?e=[n]:n.end===e[0].start?e[0].start=n.start:e.unshift(n),e}function iC(n,e){for(let t=e;t<n.length;t++){const i=n.charCodeAt(t);if(a_(i)||xx(i)||t>0&&!tC(n.charCodeAt(t-1)))return t}return n.length}function rw(n,e,t,i){if(t===n.length)return[];if(i===e.length)return null;if(n[t]!==e[i].toLowerCase())return null;{let r=null,s=i+1;for(r=rw(n,e,t+1,i+1);!r&&(s=iC(e,s))<e.length;)r=rw(n,e,t+1,s),s++;return r===null?null:nC({start:i,end:i+1},r)}}function ET(n){let e=0,t=0,i=0,r=0,s=0;for(let u=0;u<n.length;u++)s=n.charCodeAt(u),a_(s)&&e++,yx(s)&&t++,tC(s)&&i++,xx(s)&&r++;const o=e/n.length,a=t/n.length,l=i/n.length,c=r/n.length;return{upperPercent:o,lowerPercent:a,alphaPercent:l,numericPercent:c}}function ST(n){const{upperPercent:e,lowerPercent:t}=n;return t===0&&e>.6}function DT(n){const{upperPercent:e,lowerPercent:t,alphaPercent:i,numericPercent:r}=n;return t>.2&&e<.8&&i>.6&&r<.2}function kT(n){let e=0,t=0,i=0,r=0;for(let s=0;s<n.length;s++)i=n.charCodeAt(s),a_(i)&&e++,yx(i)&&t++,yT(i)&&r++;return(e===0||t===0)&&r===0?n.length<=30:e<=5}function rC(n,e){if(!e||(e=e.trim(),e.length===0)||!kT(n))return null;e.length>60&&(e=e.substring(0,60));const t=ET(e);if(!DT(t)){if(!ST(t))return null;e=e.toLowerCase()}let i=null,r=0;for(n=n.toLowerCase();r<e.length&&(i=rw(n,e,0,r))===null;)r=iC(e,r+1);return i}ZI(KI,rC,wT);ZI(KI,rC,bT);new ax(1e4);const vE=128;function Ex(){const n=[],e=[];for(let t=0;t<=vE;t++)e[t]=0;for(let t=0;t<=vE;t++)n.push(e.slice(0));return n}Ex();Ex();Ex();var wE;(function(n){n[n.Diag=1]="Diag",n[n.Left=2]="Left",n[n.LeftLeft=3]="LeftLeft"})(wE||(wE={}));var bE;(function(n){n.Default=[-100,0];function e(t){return!t||t.length===2&&t[0]===-100&&t[1]===0}n.isDefault=e})(bE||(bE={}));const sw=Object.create(null);function g(n,e){if(Ze(e)){const t=sw[e];if(t===void 0)throw new Error(`${n} references an unknown codicon: ${e}`);e=t}return sw[n]=e,{id:n}}function IT(){return sw}const CT={add:g("add",6e4),plus:g("plus",6e4),gistNew:g("gist-new",6e4),repoCreate:g("repo-create",6e4),lightbulb:g("lightbulb",60001),lightBulb:g("light-bulb",60001),repo:g("repo",60002),repoDelete:g("repo-delete",60002),gistFork:g("gist-fork",60003),repoForked:g("repo-forked",60003),gitPullRequest:g("git-pull-request",60004),gitPullRequestAbandoned:g("git-pull-request-abandoned",60004),recordKeys:g("record-keys",60005),keyboard:g("keyboard",60005),tag:g("tag",60006),gitPullRequestLabel:g("git-pull-request-label",60006),tagAdd:g("tag-add",60006),tagRemove:g("tag-remove",60006),person:g("person",60007),personFollow:g("person-follow",60007),personOutline:g("person-outline",60007),personFilled:g("person-filled",60007),gitBranch:g("git-branch",60008),gitBranchCreate:g("git-branch-create",60008),gitBranchDelete:g("git-branch-delete",60008),sourceControl:g("source-control",60008),mirror:g("mirror",60009),mirrorPublic:g("mirror-public",60009),star:g("star",60010),starAdd:g("star-add",60010),starDelete:g("star-delete",60010),starEmpty:g("star-empty",60010),comment:g("comment",60011),commentAdd:g("comment-add",60011),alert:g("alert",60012),warning:g("warning",60012),search:g("search",60013),searchSave:g("search-save",60013),logOut:g("log-out",60014),signOut:g("sign-out",60014),logIn:g("log-in",60015),signIn:g("sign-in",60015),eye:g("eye",60016),eyeUnwatch:g("eye-unwatch",60016),eyeWatch:g("eye-watch",60016),circleFilled:g("circle-filled",60017),primitiveDot:g("primitive-dot",60017),closeDirty:g("close-dirty",60017),debugBreakpoint:g("debug-breakpoint",60017),debugBreakpointDisabled:g("debug-breakpoint-disabled",60017),debugHint:g("debug-hint",60017),terminalDecorationSuccess:g("terminal-decoration-success",60017),primitiveSquare:g("primitive-square",60018),edit:g("edit",60019),pencil:g("pencil",60019),info:g("info",60020),issueOpened:g("issue-opened",60020),gistPrivate:g("gist-private",60021),gitForkPrivate:g("git-fork-private",60021),lock:g("lock",60021),mirrorPrivate:g("mirror-private",60021),close:g("close",60022),removeClose:g("remove-close",60022),x:g("x",60022),repoSync:g("repo-sync",60023),sync:g("sync",60023),clone:g("clone",60024),desktopDownload:g("desktop-download",60024),beaker:g("beaker",60025),microscope:g("microscope",60025),vm:g("vm",60026),deviceDesktop:g("device-desktop",60026),file:g("file",60027),fileText:g("file-text",60027),more:g("more",60028),ellipsis:g("ellipsis",60028),kebabHorizontal:g("kebab-horizontal",60028),mailReply:g("mail-reply",60029),reply:g("reply",60029),organization:g("organization",60030),organizationFilled:g("organization-filled",60030),organizationOutline:g("organization-outline",60030),newFile:g("new-file",60031),fileAdd:g("file-add",60031),newFolder:g("new-folder",60032),fileDirectoryCreate:g("file-directory-create",60032),trash:g("trash",60033),trashcan:g("trashcan",60033),history:g("history",60034),clock:g("clock",60034),folder:g("folder",60035),fileDirectory:g("file-directory",60035),symbolFolder:g("symbol-folder",60035),logoGithub:g("logo-github",60036),markGithub:g("mark-github",60036),github:g("github",60036),terminal:g("terminal",60037),console:g("console",60037),repl:g("repl",60037),zap:g("zap",60038),symbolEvent:g("symbol-event",60038),error:g("error",60039),stop:g("stop",60039),variable:g("variable",60040),symbolVariable:g("symbol-variable",60040),array:g("array",60042),symbolArray:g("symbol-array",60042),symbolModule:g("symbol-module",60043),symbolPackage:g("symbol-package",60043),symbolNamespace:g("symbol-namespace",60043),symbolObject:g("symbol-object",60043),symbolMethod:g("symbol-method",60044),symbolFunction:g("symbol-function",60044),symbolConstructor:g("symbol-constructor",60044),symbolBoolean:g("symbol-boolean",60047),symbolNull:g("symbol-null",60047),symbolNumeric:g("symbol-numeric",60048),symbolNumber:g("symbol-number",60048),symbolStructure:g("symbol-structure",60049),symbolStruct:g("symbol-struct",60049),symbolParameter:g("symbol-parameter",60050),symbolTypeParameter:g("symbol-type-parameter",60050),symbolKey:g("symbol-key",60051),symbolText:g("symbol-text",60051),symbolReference:g("symbol-reference",60052),goToFile:g("go-to-file",60052),symbolEnum:g("symbol-enum",60053),symbolValue:g("symbol-value",60053),symbolRuler:g("symbol-ruler",60054),symbolUnit:g("symbol-unit",60054),activateBreakpoints:g("activate-breakpoints",60055),archive:g("archive",60056),arrowBoth:g("arrow-both",60057),arrowDown:g("arrow-down",60058),arrowLeft:g("arrow-left",60059),arrowRight:g("arrow-right",60060),arrowSmallDown:g("arrow-small-down",60061),arrowSmallLeft:g("arrow-small-left",60062),arrowSmallRight:g("arrow-small-right",60063),arrowSmallUp:g("arrow-small-up",60064),arrowUp:g("arrow-up",60065),bell:g("bell",60066),bold:g("bold",60067),book:g("book",60068),bookmark:g("bookmark",60069),debugBreakpointConditionalUnverified:g("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:g("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:g("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:g("debug-breakpoint-data-unverified",60072),debugBreakpointData:g("debug-breakpoint-data",60073),debugBreakpointDataDisabled:g("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:g("debug-breakpoint-log-unverified",60074),debugBreakpointLog:g("debug-breakpoint-log",60075),debugBreakpointLogDisabled:g("debug-breakpoint-log-disabled",60075),briefcase:g("briefcase",60076),broadcast:g("broadcast",60077),browser:g("browser",60078),bug:g("bug",60079),calendar:g("calendar",60080),caseSensitive:g("case-sensitive",60081),check:g("check",60082),checklist:g("checklist",60083),chevronDown:g("chevron-down",60084),chevronLeft:g("chevron-left",60085),chevronRight:g("chevron-right",60086),chevronUp:g("chevron-up",60087),chromeClose:g("chrome-close",60088),chromeMaximize:g("chrome-maximize",60089),chromeMinimize:g("chrome-minimize",60090),chromeRestore:g("chrome-restore",60091),circleOutline:g("circle-outline",60092),circle:g("circle",60092),debugBreakpointUnverified:g("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:g("terminal-decoration-incomplete",60092),circleSlash:g("circle-slash",60093),circuitBoard:g("circuit-board",60094),clearAll:g("clear-all",60095),clippy:g("clippy",60096),closeAll:g("close-all",60097),cloudDownload:g("cloud-download",60098),cloudUpload:g("cloud-upload",60099),code:g("code",60100),collapseAll:g("collapse-all",60101),colorMode:g("color-mode",60102),commentDiscussion:g("comment-discussion",60103),creditCard:g("credit-card",60105),dash:g("dash",60108),dashboard:g("dashboard",60109),database:g("database",60110),debugContinue:g("debug-continue",60111),debugDisconnect:g("debug-disconnect",60112),debugPause:g("debug-pause",60113),debugRestart:g("debug-restart",60114),debugStart:g("debug-start",60115),debugStepInto:g("debug-step-into",60116),debugStepOut:g("debug-step-out",60117),debugStepOver:g("debug-step-over",60118),debugStop:g("debug-stop",60119),debug:g("debug",60120),deviceCameraVideo:g("device-camera-video",60121),deviceCamera:g("device-camera",60122),deviceMobile:g("device-mobile",60123),diffAdded:g("diff-added",60124),diffIgnored:g("diff-ignored",60125),diffModified:g("diff-modified",60126),diffRemoved:g("diff-removed",60127),diffRenamed:g("diff-renamed",60128),diff:g("diff",60129),diffSidebyside:g("diff-sidebyside",60129),discard:g("discard",60130),editorLayout:g("editor-layout",60131),emptyWindow:g("empty-window",60132),exclude:g("exclude",60133),extensions:g("extensions",60134),eyeClosed:g("eye-closed",60135),fileBinary:g("file-binary",60136),fileCode:g("file-code",60137),fileMedia:g("file-media",60138),filePdf:g("file-pdf",60139),fileSubmodule:g("file-submodule",60140),fileSymlinkDirectory:g("file-symlink-directory",60141),fileSymlinkFile:g("file-symlink-file",60142),fileZip:g("file-zip",60143),files:g("files",60144),filter:g("filter",60145),flame:g("flame",60146),foldDown:g("fold-down",60147),foldUp:g("fold-up",60148),fold:g("fold",60149),folderActive:g("folder-active",60150),folderOpened:g("folder-opened",60151),gear:g("gear",60152),gift:g("gift",60153),gistSecret:g("gist-secret",60154),gist:g("gist",60155),gitCommit:g("git-commit",60156),gitCompare:g("git-compare",60157),compareChanges:g("compare-changes",60157),gitMerge:g("git-merge",60158),githubAction:g("github-action",60159),githubAlt:g("github-alt",60160),globe:g("globe",60161),grabber:g("grabber",60162),graph:g("graph",60163),gripper:g("gripper",60164),heart:g("heart",60165),home:g("home",60166),horizontalRule:g("horizontal-rule",60167),hubot:g("hubot",60168),inbox:g("inbox",60169),issueReopened:g("issue-reopened",60171),issues:g("issues",60172),italic:g("italic",60173),jersey:g("jersey",60174),json:g("json",60175),kebabVertical:g("kebab-vertical",60176),key:g("key",60177),law:g("law",60178),lightbulbAutofix:g("lightbulb-autofix",60179),linkExternal:g("link-external",60180),link:g("link",60181),listOrdered:g("list-ordered",60182),listUnordered:g("list-unordered",60183),liveShare:g("live-share",60184),loading:g("loading",60185),location:g("location",60186),mailRead:g("mail-read",60187),mail:g("mail",60188),markdown:g("markdown",60189),megaphone:g("megaphone",60190),mention:g("mention",60191),milestone:g("milestone",60192),gitPullRequestMilestone:g("git-pull-request-milestone",60192),mortarBoard:g("mortar-board",60193),move:g("move",60194),multipleWindows:g("multiple-windows",60195),mute:g("mute",60196),noNewline:g("no-newline",60197),note:g("note",60198),octoface:g("octoface",60199),openPreview:g("open-preview",60200),package:g("package",60201),paintcan:g("paintcan",60202),pin:g("pin",60203),play:g("play",60204),run:g("run",60204),plug:g("plug",60205),preserveCase:g("preserve-case",60206),preview:g("preview",60207),project:g("project",60208),pulse:g("pulse",60209),question:g("question",60210),quote:g("quote",60211),radioTower:g("radio-tower",60212),reactions:g("reactions",60213),references:g("references",60214),refresh:g("refresh",60215),regex:g("regex",60216),remoteExplorer:g("remote-explorer",60217),remote:g("remote",60218),remove:g("remove",60219),replaceAll:g("replace-all",60220),replace:g("replace",60221),repoClone:g("repo-clone",60222),repoForcePush:g("repo-force-push",60223),repoPull:g("repo-pull",60224),repoPush:g("repo-push",60225),report:g("report",60226),requestChanges:g("request-changes",60227),rocket:g("rocket",60228),rootFolderOpened:g("root-folder-opened",60229),rootFolder:g("root-folder",60230),rss:g("rss",60231),ruby:g("ruby",60232),saveAll:g("save-all",60233),saveAs:g("save-as",60234),save:g("save",60235),screenFull:g("screen-full",60236),screenNormal:g("screen-normal",60237),searchStop:g("search-stop",60238),server:g("server",60240),settingsGear:g("settings-gear",60241),settings:g("settings",60242),shield:g("shield",60243),smiley:g("smiley",60244),sortPrecedence:g("sort-precedence",60245),splitHorizontal:g("split-horizontal",60246),splitVertical:g("split-vertical",60247),squirrel:g("squirrel",60248),starFull:g("star-full",60249),starHalf:g("star-half",60250),symbolClass:g("symbol-class",60251),symbolColor:g("symbol-color",60252),symbolConstant:g("symbol-constant",60253),symbolEnumMember:g("symbol-enum-member",60254),symbolField:g("symbol-field",60255),symbolFile:g("symbol-file",60256),symbolInterface:g("symbol-interface",60257),symbolKeyword:g("symbol-keyword",60258),symbolMisc:g("symbol-misc",60259),symbolOperator:g("symbol-operator",60260),symbolProperty:g("symbol-property",60261),wrench:g("wrench",60261),wrenchSubaction:g("wrench-subaction",60261),symbolSnippet:g("symbol-snippet",60262),tasklist:g("tasklist",60263),telescope:g("telescope",60264),textSize:g("text-size",60265),threeBars:g("three-bars",60266),thumbsdown:g("thumbsdown",60267),thumbsup:g("thumbsup",60268),tools:g("tools",60269),triangleDown:g("triangle-down",60270),triangleLeft:g("triangle-left",60271),triangleRight:g("triangle-right",60272),triangleUp:g("triangle-up",60273),twitter:g("twitter",60274),unfold:g("unfold",60275),unlock:g("unlock",60276),unmute:g("unmute",60277),unverified:g("unverified",60278),verified:g("verified",60279),versions:g("versions",60280),vmActive:g("vm-active",60281),vmOutline:g("vm-outline",60282),vmRunning:g("vm-running",60283),watch:g("watch",60284),whitespace:g("whitespace",60285),wholeWord:g("whole-word",60286),window:g("window",60287),wordWrap:g("word-wrap",60288),zoomIn:g("zoom-in",60289),zoomOut:g("zoom-out",60290),listFilter:g("list-filter",60291),listFlat:g("list-flat",60292),listSelection:g("list-selection",60293),selection:g("selection",60293),listTree:g("list-tree",60294),debugBreakpointFunctionUnverified:g("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:g("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:g("debug-breakpoint-function-disabled",60296),debugStackframeActive:g("debug-stackframe-active",60297),circleSmallFilled:g("circle-small-filled",60298),debugStackframeDot:g("debug-stackframe-dot",60298),terminalDecorationMark:g("terminal-decoration-mark",60298),debugStackframe:g("debug-stackframe",60299),debugStackframeFocused:g("debug-stackframe-focused",60299),debugBreakpointUnsupported:g("debug-breakpoint-unsupported",60300),symbolString:g("symbol-string",60301),debugReverseContinue:g("debug-reverse-continue",60302),debugStepBack:g("debug-step-back",60303),debugRestartFrame:g("debug-restart-frame",60304),debugAlt:g("debug-alt",60305),callIncoming:g("call-incoming",60306),callOutgoing:g("call-outgoing",60307),menu:g("menu",60308),expandAll:g("expand-all",60309),feedback:g("feedback",60310),gitPullRequestReviewer:g("git-pull-request-reviewer",60310),groupByRefType:g("group-by-ref-type",60311),ungroupByRefType:g("ungroup-by-ref-type",60312),account:g("account",60313),gitPullRequestAssignee:g("git-pull-request-assignee",60313),bellDot:g("bell-dot",60314),debugConsole:g("debug-console",60315),library:g("library",60316),output:g("output",60317),runAll:g("run-all",60318),syncIgnored:g("sync-ignored",60319),pinned:g("pinned",60320),githubInverted:g("github-inverted",60321),serverProcess:g("server-process",60322),serverEnvironment:g("server-environment",60323),pass:g("pass",60324),issueClosed:g("issue-closed",60324),stopCircle:g("stop-circle",60325),playCircle:g("play-circle",60326),record:g("record",60327),debugAltSmall:g("debug-alt-small",60328),vmConnect:g("vm-connect",60329),cloud:g("cloud",60330),merge:g("merge",60331),export:g("export",60332),graphLeft:g("graph-left",60333),magnet:g("magnet",60334),notebook:g("notebook",60335),redo:g("redo",60336),checkAll:g("check-all",60337),pinnedDirty:g("pinned-dirty",60338),passFilled:g("pass-filled",60339),circleLargeFilled:g("circle-large-filled",60340),circleLarge:g("circle-large",60341),circleLargeOutline:g("circle-large-outline",60341),combine:g("combine",60342),gather:g("gather",60342),table:g("table",60343),variableGroup:g("variable-group",60344),typeHierarchy:g("type-hierarchy",60345),typeHierarchySub:g("type-hierarchy-sub",60346),typeHierarchySuper:g("type-hierarchy-super",60347),gitPullRequestCreate:g("git-pull-request-create",60348),runAbove:g("run-above",60349),runBelow:g("run-below",60350),notebookTemplate:g("notebook-template",60351),debugRerun:g("debug-rerun",60352),workspaceTrusted:g("workspace-trusted",60353),workspaceUntrusted:g("workspace-untrusted",60354),workspaceUnknown:g("workspace-unknown",60355),terminalCmd:g("terminal-cmd",60356),terminalDebian:g("terminal-debian",60357),terminalLinux:g("terminal-linux",60358),terminalPowershell:g("terminal-powershell",60359),terminalTmux:g("terminal-tmux",60360),terminalUbuntu:g("terminal-ubuntu",60361),terminalBash:g("terminal-bash",60362),arrowSwap:g("arrow-swap",60363),copy:g("copy",60364),personAdd:g("person-add",60365),filterFilled:g("filter-filled",60366),wand:g("wand",60367),debugLineByLine:g("debug-line-by-line",60368),inspect:g("inspect",60369),layers:g("layers",60370),layersDot:g("layers-dot",60371),layersActive:g("layers-active",60372),compass:g("compass",60373),compassDot:g("compass-dot",60374),compassActive:g("compass-active",60375),azure:g("azure",60376),issueDraft:g("issue-draft",60377),gitPullRequestClosed:g("git-pull-request-closed",60378),gitPullRequestDraft:g("git-pull-request-draft",60379),debugAll:g("debug-all",60380),debugCoverage:g("debug-coverage",60381),runErrors:g("run-errors",60382),folderLibrary:g("folder-library",60383),debugContinueSmall:g("debug-continue-small",60384),beakerStop:g("beaker-stop",60385),graphLine:g("graph-line",60386),graphScatter:g("graph-scatter",60387),pieChart:g("pie-chart",60388),bracket:g("bracket",60175),bracketDot:g("bracket-dot",60389),bracketError:g("bracket-error",60390),lockSmall:g("lock-small",60391),azureDevops:g("azure-devops",60392),verifiedFilled:g("verified-filled",60393),newline:g("newline",60394),layout:g("layout",60395),layoutActivitybarLeft:g("layout-activitybar-left",60396),layoutActivitybarRight:g("layout-activitybar-right",60397),layoutPanelLeft:g("layout-panel-left",60398),layoutPanelCenter:g("layout-panel-center",60399),layoutPanelJustify:g("layout-panel-justify",60400),layoutPanelRight:g("layout-panel-right",60401),layoutPanel:g("layout-panel",60402),layoutSidebarLeft:g("layout-sidebar-left",60403),layoutSidebarRight:g("layout-sidebar-right",60404),layoutStatusbar:g("layout-statusbar",60405),layoutMenubar:g("layout-menubar",60406),layoutCentered:g("layout-centered",60407),target:g("target",60408),indent:g("indent",60409),recordSmall:g("record-small",60410),errorSmall:g("error-small",60411),terminalDecorationError:g("terminal-decoration-error",60411),arrowCircleDown:g("arrow-circle-down",60412),arrowCircleLeft:g("arrow-circle-left",60413),arrowCircleRight:g("arrow-circle-right",60414),arrowCircleUp:g("arrow-circle-up",60415),layoutSidebarRightOff:g("layout-sidebar-right-off",60416),layoutPanelOff:g("layout-panel-off",60417),layoutSidebarLeftOff:g("layout-sidebar-left-off",60418),blank:g("blank",60419),heartFilled:g("heart-filled",60420),map:g("map",60421),mapHorizontal:g("map-horizontal",60421),foldHorizontal:g("fold-horizontal",60421),mapFilled:g("map-filled",60422),mapHorizontalFilled:g("map-horizontal-filled",60422),foldHorizontalFilled:g("fold-horizontal-filled",60422),circleSmall:g("circle-small",60423),bellSlash:g("bell-slash",60424),bellSlashDot:g("bell-slash-dot",60425),commentUnresolved:g("comment-unresolved",60426),gitPullRequestGoToChanges:g("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:g("git-pull-request-new-changes",60428),searchFuzzy:g("search-fuzzy",60429),commentDraft:g("comment-draft",60430),send:g("send",60431),sparkle:g("sparkle",60432),insert:g("insert",60433),mic:g("mic",60434),thumbsdownFilled:g("thumbsdown-filled",60435),thumbsupFilled:g("thumbsup-filled",60436),coffee:g("coffee",60437),snake:g("snake",60438),game:g("game",60439),vr:g("vr",60440),chip:g("chip",60441),piano:g("piano",60442),music:g("music",60443),micFilled:g("mic-filled",60444),repoFetch:g("repo-fetch",60445),copilot:g("copilot",60446),lightbulbSparkle:g("lightbulb-sparkle",60447),robot:g("robot",60448),sparkleFilled:g("sparkle-filled",60449),diffSingle:g("diff-single",60450),diffMultiple:g("diff-multiple",60451),surroundWith:g("surround-with",60452),share:g("share",60453),gitStash:g("git-stash",60454),gitStashApply:g("git-stash-apply",60455),gitStashPop:g("git-stash-pop",60456),vscode:g("vscode",60457),vscodeInsiders:g("vscode-insiders",60458),codeOss:g("code-oss",60459),runCoverage:g("run-coverage",60460),runAllCoverage:g("run-all-coverage",60461),coverage:g("coverage",60462),githubProject:g("github-project",60463),mapVertical:g("map-vertical",60464),foldVertical:g("fold-vertical",60464),mapVerticalFilled:g("map-vertical-filled",60465),foldVerticalFilled:g("fold-vertical-filled",60465),goToSearch:g("go-to-search",60466),percentage:g("percentage",60467),sortPercentage:g("sort-percentage",60467),attach:g("attach",60468),goToEditingSession:g("go-to-editing-session",60469),editSession:g("edit-session",60470),codeReview:g("code-review",60471),copilotWarning:g("copilot-warning",60472),python:g("python",60473),copilotLarge:g("copilot-large",60474),copilotWarningLarge:g("copilot-warning-large",60475),keyboardTab:g("keyboard-tab",60476),copilotBlocked:g("copilot-blocked",60477),copilotNotConnected:g("copilot-not-connected",60478),flag:g("flag",60479),lightbulbEmpty:g("lightbulb-empty",60480),symbolMethodArrow:g("symbol-method-arrow",60481)},PT={dialogError:g("dialog-error","error"),dialogWarning:g("dialog-warning","warning"),dialogInfo:g("dialog-info","info"),dialogClose:g("dialog-close","close"),treeItemExpanded:g("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:g("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:g("tree-filter-on-type-off","list-selection"),treeFilterClear:g("tree-filter-clear","close"),treeItemLoading:g("tree-item-loading","loading"),menuSelection:g("menu-selection","check"),menuSubmenu:g("menu-submenu","chevron-right"),menuBarMore:g("menubar-more","more"),scrollbarButtonLeft:g("scrollbar-button-left","triangle-left"),scrollbarButtonRight:g("scrollbar-button-right","triangle-right"),scrollbarButtonUp:g("scrollbar-button-up","triangle-up"),scrollbarButtonDown:g("scrollbar-button-down","triangle-down"),toolBarMore:g("toolbar-more","more"),quickInputBack:g("quick-input-back","arrow-left"),dropDownButton:g("drop-down-button",60084),symbolCustomColor:g("symbol-customcolor",60252),exportIcon:g("export",60332),workspaceUnspecified:g("workspace-unspecified",60355),newLine:g("newline",60394),thumbsDownFilled:g("thumbsdown-filled",60435),thumbsUpFilled:g("thumbsup-filled",60436),gitFetch:g("git-fetch",60445),lightbulbSparkleAutofix:g("lightbulb-sparkle-autofix",60447),debugBreakpointPending:g("debug-breakpoint-pending",60377)},we={...CT,...PT};var mu;(function(n){function e(t){return t&&typeof t=="object"&&typeof t.id=="string"}n.isThemeColor=e})(mu||(mu={}));var On;(function(n){n.iconNameSegment="[A-Za-z0-9]+",n.iconNameExpression="[A-Za-z0-9-]+",n.iconModifierExpression="~[A-Za-z]+",n.iconNameCharacter="[A-Za-z0-9~-]";const e=new RegExp(`^(${n.iconNameExpression})(${n.iconModifierExpression})?$`);function t(f){const p=e.exec(f.id);if(!p)return t(we.error);const[,w,v]=p,m=["codicon","codicon-"+w];return v&&m.push("codicon-modifier-"+v.substring(1)),m}n.asClassNameArray=t;function i(f){return t(f).join(" ")}n.asClassName=i;function r(f){return"."+t(f).join(".")}n.asCSSSelector=r;function s(f){return f&&typeof f=="object"&&typeof f.id=="string"&&(typeof f.color>"u"||mu.isThemeColor(f.color))}n.isThemeIcon=s;const o=new RegExp(`^\\$\\((${n.iconNameExpression}(?:${n.iconModifierExpression})?)\\)$`);function a(f){const p=o.exec(f);if(!p)return;const[,w]=p;return{id:w}}n.fromString=a;function l(f){return{id:f}}n.fromId=l;function c(f,p){let w=f.id;const v=w.lastIndexOf("~");return v!==-1&&(w=w.substring(0,v)),p&&(w=`${w}~${p}`),{id:w}}n.modify=c;function u(f){const p=f.id.lastIndexOf("~");if(p!==-1)return f.id.substring(p+1)}n.getModifier=u;function d(f,p){var w,v;return f.id===p.id&&((w=f.color)==null?void 0:w.id)===((v=p.color)==null?void 0:v.id)}n.isEqual=d})(On||(On={}));const Sx=new RegExp(`\\$\\(${On.iconNameExpression}(?:${On.iconModifierExpression})?\\)`,"g"),TT=new RegExp(`(\\\\)?${Sx.source}`,"g");function AT(n){return n.replace(TT,(e,t)=>t?e:`\\${e}`)}new RegExp(`\\\\${Sx.source}`,"g");new RegExp(`(\\s)?(\\\\)?${Sx.source}(\\s)?`,"g");new RegExp(`\\$\\(${On.iconNameCharacter}+\\)`,"g");var dg;(function(n){n[n.Paragraph=0]="Paragraph",n[n.Break=1]="Break"})(dg||(dg={}));let hg=class sC{static lift(e){const t=new sC(e.value,e);return t.uris=e.uris,t.baseUri=e.baseUri?y.revive(e.baseUri):void 0,t}constructor(e="",t=!1){if(this.value=e,typeof this.value!="string")throw Be("value");typeof t=="boolean"?(this.isTrusted=t,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=t.isTrusted??void 0,this.supportThemeIcons=t.supportThemeIcons??!1,this.supportHtml=t.supportHtml??!1)}appendText(e,t=dg.Paragraph){return this.value+=RT(this.supportThemeIcons?AT(e):e).replace(/([ \t]+)/g,(i,r)=>"&nbsp;".repeat(r.length)).replace(/\>/gm,"\\>").replace(/\n/g,t===dg.Break?`\\
`:`

`),this}appendMarkdown(e){return this.value+=e,this}appendCodeblock(e,t){return this.value+=`
${LT(t,e)}
`,this}appendLink(e,t,i){return this.value+="[",this.value+=this._escape(t,"]"),this.value+="](",this.value+=this._escape(String(e),")"),i&&(this.value+=` "${this._escape(this._escape(i,'"'),")")}"`),this.value+=")",this}_escape(e,t){const i=new RegExp(hl(t),"g");return e.replace(i,(r,s)=>e.charAt(s-1)!=="\\"?`\\${r}`:r)}};function kl(n){return n instanceof hg?!0:n&&typeof n=="object"?typeof n.value=="string"&&(typeof n.isTrusted=="boolean"||typeof n.isTrusted=="object"||n.isTrusted===void 0)&&(typeof n.supportThemeIcons=="boolean"||n.supportThemeIcons===void 0):!1}function RT(n){return n.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function LT(n,e){var r;const t=((r=n.match(/^`+/gm))==null?void 0:r.reduce((s,o)=>s.length>o.length?s:o).length)??0,i=t>=3?t+1:3;return[`${"`".repeat(i)}${e}`,n,`${"`".repeat(i)}`].join(`
`)}function NT(n){const e=[],t=n.split("|").map(r=>r.trim());n=t[0];const i=t[1];if(i){const r=/height=(\d+)/.exec(i),s=/width=(\d+)/.exec(i),o=r?r[1]:"",a=s?s[1]:"",l=isFinite(parseInt(a)),c=isFinite(parseInt(o));l&&e.push(`width="${a}"`),c&&e.push(`height="${o}"`)}return{href:n,dimensions:e}}function Dx(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let Il=Dx();function oC(n){Il=n}const aC=/[&<>"']/,OT=new RegExp(aC.source,"g"),lC=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,FT=new RegExp(lC.source,"g"),MT={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},yE=n=>MT[n];function Si(n,e){if(e){if(aC.test(n))return n.replace(OT,yE)}else if(lC.test(n))return n.replace(FT,yE);return n}const $T=/(^|[^\[])\^/g;function kt(n,e){let t=typeof n=="string"?n:n.source;e=e||"";const i={replace:(r,s)=>{let o=typeof s=="string"?s:s.source;return o=o.replace($T,"$1"),t=t.replace(r,o),i},getRegex:()=>new RegExp(t,e)};return i}function xE(n){try{n=encodeURI(n).replace(/%25/g,"%")}catch{return null}return n}const Nd={exec:()=>null};function EE(n,e){const t=n.replace(/\|/g,(s,o,a)=>{let l=!1,c=o;for(;--c>=0&&a[c]==="\\";)l=!l;return l?"|":" |"}),i=t.split(/ \|/);let r=0;if(i[0].trim()||i.shift(),i.length>0&&!i[i.length-1].trim()&&i.pop(),e)if(i.length>e)i.splice(e);else for(;i.length<e;)i.push("");for(;r<i.length;r++)i[r]=i[r].trim().replace(/\\\|/g,"|");return i}function ud(n,e,t){const i=n.length;if(i===0)return"";let r=0;for(;r<i&&n.charAt(i-r-1)===e;)r++;return n.slice(0,i-r)}function UT(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let i=0;i<n.length;i++)if(n[i]==="\\")i++;else if(n[i]===e[0])t++;else if(n[i]===e[1]&&(t--,t<0))return i;return-1}function SE(n,e,t,i){const r=e.href,s=e.title?Si(e.title):null,o=n[1].replace(/\\([\[\]])/g,"$1");if(n[0].charAt(0)!=="!"){i.state.inLink=!0;const a={type:"link",raw:t,href:r,title:s,text:o,tokens:i.inlineTokens(o)};return i.state.inLink=!1,a}return{type:"image",raw:t,href:r,title:s,text:Si(o)}}function HT(n,e){const t=n.match(/^(\s+)(?:```)/);if(t===null)return e;const i=t[1];return e.split(`
`).map(r=>{const s=r.match(/^\s+/);if(s===null)return r;const[o]=s;return o.length>=i.length?r.slice(i.length):r}).join(`
`)}class fg{constructor(e){At(this,"options");At(this,"rules");At(this,"lexer");this.options=e||Il}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const i=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?i:ud(i,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const i=t[0],r=HT(i,t[3]||"");return{type:"code",raw:i,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let i=t[2].trim();if(/#$/.test(i)){const r=ud(i,"#");(this.options.pedantic||!r||/ $/.test(r))&&(i=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:i,tokens:this.lexer.inline(i)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:ud(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let i=ud(t[0],`
`).split(`
`),r="",s="";const o=[];for(;i.length>0;){let a=!1;const l=[];let c;for(c=0;c<i.length;c++)if(/^ {0,3}>/.test(i[c]))l.push(i[c]),a=!0;else if(!a)l.push(i[c]);else break;i=i.slice(c);const u=l.join(`
`),d=u.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");r=r?`${r}
${u}`:u,s=s?`${s}
${d}`:d;const f=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(d,o,!0),this.lexer.state.top=f,i.length===0)break;const p=o[o.length-1];if((p==null?void 0:p.type)==="code")break;if((p==null?void 0:p.type)==="blockquote"){const w=p,v=w.raw+`
`+i.join(`
`),m=this.blockquote(v);o[o.length-1]=m,r=r.substring(0,r.length-w.raw.length)+m.raw,s=s.substring(0,s.length-w.text.length)+m.text;break}else if((p==null?void 0:p.type)==="list"){const w=p,v=w.raw+`
`+i.join(`
`),m=this.list(v);o[o.length-1]=m,r=r.substring(0,r.length-p.raw.length)+m.raw,s=s.substring(0,s.length-w.raw.length)+m.raw,i=v.substring(o[o.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:o,text:s}}}list(e){let t=this.rules.block.list.exec(e);if(t){let i=t[1].trim();const r=i.length>1,s={type:"list",raw:"",ordered:r,start:r?+i.slice(0,-1):"",loose:!1,items:[]};i=r?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=r?i:"[*+-]");const o=new RegExp(`^( {0,3}${i})((?:[	 ][^\\n]*)?(?:\\n|$))`);let a=!1;for(;e;){let l=!1,c="",u="";if(!(t=o.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let d=t[2].split(`
`,1)[0].replace(/^\t+/,x=>" ".repeat(3*x.length)),f=e.split(`
`,1)[0],p=!d.trim(),w=0;if(this.options.pedantic?(w=2,u=d.trimStart()):p?w=t[1].length+1:(w=t[2].search(/[^ ]/),w=w>4?1:w,u=d.slice(w),w+=t[1].length),p&&/^ *$/.test(f)&&(c+=f+`
`,e=e.substring(f.length+1),l=!0),!l){const x=new RegExp(`^ {0,${Math.min(3,w-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),k=new RegExp(`^ {0,${Math.min(3,w-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),D=new RegExp(`^ {0,${Math.min(3,w-1)}}(?:\`\`\`|~~~)`),B=new RegExp(`^ {0,${Math.min(3,w-1)}}#`);for(;e;){const T=e.split(`
`,1)[0];if(f=T,this.options.pedantic&&(f=f.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),D.test(f)||B.test(f)||x.test(f)||k.test(e))break;if(f.search(/[^ ]/)>=w||!f.trim())u+=`
`+f.slice(w);else{if(p||d.search(/[^ ]/)>=4||D.test(d)||B.test(d)||k.test(d))break;u+=`
`+f}!p&&!f.trim()&&(p=!0),c+=T+`
`,e=e.substring(T.length+1),d=f.slice(w)}}s.loose||(a?s.loose=!0:/\n *\n *$/.test(c)&&(a=!0));let v=null,m;this.options.gfm&&(v=/^\[[ xX]\] /.exec(u),v&&(m=v[0]!=="[ ] ",u=u.replace(/^\[[ xX]\] +/,""))),s.items.push({type:"list_item",raw:c,task:!!v,checked:m,loose:!1,text:u,tokens:[]}),s.raw+=c}s.items[s.items.length-1].raw=s.items[s.items.length-1].raw.trimEnd(),s.items[s.items.length-1].text=s.items[s.items.length-1].text.trimEnd(),s.raw=s.raw.trimEnd();for(let l=0;l<s.items.length;l++)if(this.lexer.state.top=!1,s.items[l].tokens=this.lexer.blockTokens(s.items[l].text,[]),!s.loose){const c=s.items[l].tokens.filter(d=>d.type==="space"),u=c.length>0&&c.some(d=>/\n.*\n/.test(d.raw));s.loose=u}if(s.loose)for(let l=0;l<s.items.length;l++)s.items[l].loose=!0;return s}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const i=t[1].toLowerCase().replace(/\s+/g," "),r=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:i,raw:t[0],href:r,title:s}}}table(e){const t=this.rules.block.table.exec(e);if(!t||!/[:|]/.test(t[2]))return;const i=EE(t[1]),r=t[2].replace(/^\||\| *$/g,"").split("|"),s=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[],o={type:"table",raw:t[0],header:[],align:[],rows:[]};if(i.length===r.length){for(const a of r)/^ *-+: *$/.test(a)?o.align.push("right"):/^ *:-+: *$/.test(a)?o.align.push("center"):/^ *:-+ *$/.test(a)?o.align.push("left"):o.align.push(null);for(let a=0;a<i.length;a++)o.header.push({text:i[a],tokens:this.lexer.inline(i[a]),header:!0,align:o.align[a]});for(const a of s)o.rows.push(EE(a,o.header.length).map((l,c)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:o.align[c]})));return o}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const i=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:i,tokens:this.lexer.inline(i)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:Si(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const i=t[2].trim();if(!this.options.pedantic&&/^</.test(i)){if(!/>$/.test(i))return;const o=ud(i.slice(0,-1),"\\");if((i.length-o.length)%2===0)return}else{const o=UT(t[2],"()");if(o>-1){const l=(t[0].indexOf("!")===0?5:4)+t[1].length+o;t[2]=t[2].substring(0,o),t[0]=t[0].substring(0,l).trim(),t[3]=""}}let r=t[2],s="";if(this.options.pedantic){const o=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(r);o&&(r=o[1],s=o[3])}else s=t[3]?t[3].slice(1,-1):"";return r=r.trim(),/^</.test(r)&&(this.options.pedantic&&!/>$/.test(i)?r=r.slice(1):r=r.slice(1,-1)),SE(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer)}}reflink(e,t){let i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){const r=(i[2]||i[1]).replace(/\s+/g," "),s=t[r.toLowerCase()];if(!s){const o=i[0].charAt(0);return{type:"text",raw:o,text:o}}return SE(i,s,i[0],this.lexer)}}emStrong(e,t,i=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!r||r[3]&&i.match(/[\p{L}\p{N}]/u))return;if(!(r[1]||r[2]||"")||!i||this.rules.inline.punctuation.exec(i)){const o=[...r[0]].length-1;let a,l,c=o,u=0;const d=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(d.lastIndex=0,t=t.slice(-1*e.length+o);(r=d.exec(t))!=null;){if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!a)continue;if(l=[...a].length,r[3]||r[4]){c+=l;continue}else if((r[5]||r[6])&&o%3&&!((o+l)%3)){u+=l;continue}if(c-=l,c>0)continue;l=Math.min(l,l+c+u);const f=[...r[0]][0].length,p=e.slice(0,o+r.index+f+l);if(Math.min(o,l)%2){const v=p.slice(1,-1);return{type:"em",raw:p,text:v,tokens:this.lexer.inlineTokens(v)}}const w=p.slice(2,-2);return{type:"strong",raw:p,text:w,tokens:this.lexer.inlineTokens(w)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let i=t[2].replace(/\n/g," ");const r=/[^ ]/.test(i),s=/^ /.test(i)&&/ $/.test(i);return r&&s&&(i=i.substring(1,i.length-1)),i=Si(i,!0),{type:"codespan",raw:t[0],text:i}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let i,r;return t[2]==="@"?(i=Si(t[1]),r="mailto:"+i):(i=Si(t[1]),r=i),{type:"link",raw:t[0],text:i,href:r,tokens:[{type:"text",raw:i,text:i}]}}}url(e){var i;let t;if(t=this.rules.inline.url.exec(e)){let r,s;if(t[2]==="@")r=Si(t[0]),s="mailto:"+r;else{let o;do o=t[0],t[0]=((i=this.rules.inline._backpedal.exec(t[0]))==null?void 0:i[0])??"";while(o!==t[0]);r=Si(t[0]),t[1]==="www."?s="http://"+t[0]:s=t[0]}return{type:"link",raw:t[0],text:r,href:s,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let i;return this.lexer.state.inRawBlock?i=t[0]:i=Si(t[0]),{type:"text",raw:t[0],text:i}}}}const BT=/^(?: *(?:\n|$))+/,WT=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,VT=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,qf=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,zT=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,cC=/(?:[*+-]|\d{1,9}[.)])/,uC=kt(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,cC).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),kx=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,qT=/^[^\n]+/,Ix=/(?!\s*\])(?:\\.|[^\[\]\\])+/,jT=kt(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",Ix).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),GT=kt(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,cC).getRegex(),l_="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Cx=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,QT=kt("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",Cx).replace("tag",l_).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),dC=kt(kx).replace("hr",qf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",l_).getRegex(),JT=kt(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",dC).getRegex(),Px={blockquote:JT,code:WT,def:jT,fences:VT,heading:zT,hr:qf,html:QT,lheading:uC,list:GT,newline:BT,paragraph:dC,table:Nd,text:qT},DE=kt("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",qf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",l_).getRegex(),XT={...Px,table:DE,paragraph:kt(kx).replace("hr",qf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",DE).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",l_).getRegex()},YT={...Px,html:kt(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Cx).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Nd,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:kt(kx).replace("hr",qf).replace("heading",` *#{1,6} *[^
]`).replace("lheading",uC).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},hC=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,ZT=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,fC=/^( {2,}|\\)\n(?!\s*$)/,KT=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,jf="\\p{P}\\p{S}",e8=kt(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,jf).getRegex(),t8=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,n8=kt(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,jf).getRegex(),i8=kt("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,jf).getRegex(),r8=kt("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,jf).getRegex(),s8=kt(/\\([punct])/,"gu").replace(/punct/g,jf).getRegex(),o8=kt(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),a8=kt(Cx).replace("(?:-->|$)","-->").getRegex(),l8=kt("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",a8).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),pg=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,c8=kt(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",pg).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),pC=kt(/^!?\[(label)\]\[(ref)\]/).replace("label",pg).replace("ref",Ix).getRegex(),gC=kt(/^!?\[(ref)\](?:\[\])?/).replace("ref",Ix).getRegex(),u8=kt("reflink|nolink(?!\\()","g").replace("reflink",pC).replace("nolink",gC).getRegex(),Tx={_backpedal:Nd,anyPunctuation:s8,autolink:o8,blockSkip:t8,br:fC,code:ZT,del:Nd,emStrongLDelim:n8,emStrongRDelimAst:i8,emStrongRDelimUnd:r8,escape:hC,link:c8,nolink:gC,punctuation:e8,reflink:pC,reflinkSearch:u8,tag:l8,text:KT,url:Nd},d8={...Tx,link:kt(/^!?\[(label)\]\((.*?)\)/).replace("label",pg).getRegex(),reflink:kt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",pg).getRegex()},ow={...Tx,escape:kt(hC).replace("])","~|])").getRegex(),url:kt(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},h8={...ow,br:kt(fC).replace("{2,}","*").getRegex(),text:kt(ow.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},lp={normal:Px,gfm:XT,pedantic:YT},dd={normal:Tx,gfm:ow,breaks:h8,pedantic:d8};class Or{constructor(e){At(this,"tokens");At(this,"options");At(this,"state");At(this,"tokenizer");At(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Il,this.options.tokenizer=this.options.tokenizer||new fg,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:lp.normal,inline:dd.normal};this.options.pedantic?(t.block=lp.pedantic,t.inline=dd.pedantic):this.options.gfm&&(t.block=lp.gfm,this.options.breaks?t.inline=dd.breaks:t.inline=dd.gfm),this.tokenizer.rules=t}static get rules(){return{block:lp,inline:dd}}static lex(e,t){return new Or(t).lex(e)}static lexInline(e,t){return new Or(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const i=this.inlineQueue[t];this.inlineTokens(i.src,i.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],i=!1){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(a,l,c)=>l+"    ".repeat(c.length));let r,s,o;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(r=a.call({lexer:this},e,t))?(e=e.substring(r.raw.length),t.push(r),!0):!1))){if(r=this.tokenizer.space(e)){e=e.substring(r.raw.length),r.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(r);continue}if(r=this.tokenizer.code(e)){e=e.substring(r.raw.length),s=t[t.length-1],s&&(s.type==="paragraph"||s.type==="text")?(s.raw+=`
`+r.raw,s.text+=`
`+r.text,this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(r);continue}if(r=this.tokenizer.fences(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.heading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.hr(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.blockquote(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.list(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.html(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.def(e)){e=e.substring(r.raw.length),s=t[t.length-1],s&&(s.type==="paragraph"||s.type==="text")?(s.raw+=`
`+r.raw,s.text+=`
`+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=s.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.lheading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(o=e,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const l=e.slice(1);let c;this.options.extensions.startBlock.forEach(u=>{c=u.call({lexer:this},l),typeof c=="number"&&c>=0&&(a=Math.min(a,c))}),a<1/0&&a>=0&&(o=e.substring(0,a+1))}if(this.state.top&&(r=this.tokenizer.paragraph(o))){s=t[t.length-1],i&&(s==null?void 0:s.type)==="paragraph"?(s.raw+=`
`+r.raw,s.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(r),i=o.length!==e.length,e=e.substring(r.raw.length);continue}if(r=this.tokenizer.text(e)){e=e.substring(r.raw.length),s=t[t.length-1],s&&s.type==="text"?(s.raw+=`
`+r.raw,s.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(r);continue}if(e){const a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let i,r,s,o=e,a,l,c;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)u.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(o))!=null;)o=o.slice(0,a.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(l||(c=""),l=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(u=>(i=u.call({lexer:this},e,t))?(e=e.substring(i.raw.length),t.push(i),!0):!1))){if(i=this.tokenizer.escape(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.tag(e)){e=e.substring(i.raw.length),r=t[t.length-1],r&&i.type==="text"&&r.type==="text"?(r.raw+=i.raw,r.text+=i.text):t.push(i);continue}if(i=this.tokenizer.link(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(i.raw.length),r=t[t.length-1],r&&i.type==="text"&&r.type==="text"?(r.raw+=i.raw,r.text+=i.text):t.push(i);continue}if(i=this.tokenizer.emStrong(e,o,c)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.codespan(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.br(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.del(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.autolink(e)){e=e.substring(i.raw.length),t.push(i);continue}if(!this.state.inLink&&(i=this.tokenizer.url(e))){e=e.substring(i.raw.length),t.push(i);continue}if(s=e,this.options.extensions&&this.options.extensions.startInline){let u=1/0;const d=e.slice(1);let f;this.options.extensions.startInline.forEach(p=>{f=p.call({lexer:this},d),typeof f=="number"&&f>=0&&(u=Math.min(u,f))}),u<1/0&&u>=0&&(s=e.substring(0,u+1))}if(i=this.tokenizer.inlineText(s)){e=e.substring(i.raw.length),i.raw.slice(-1)!=="_"&&(c=i.raw.slice(-1)),l=!0,r=t[t.length-1],r&&r.type==="text"?(r.raw+=i.raw,r.text+=i.text):t.push(i);continue}if(e){const u="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return t}}class gg{constructor(e){At(this,"options");At(this,"parser");this.options=e||Il}space(e){return""}code({text:e,lang:t,escaped:i}){var o;const r=(o=(t||"").match(/^\S*/))==null?void 0:o[0],s=e.replace(/\n$/,"")+`
`;return r?'<pre><code class="language-'+Si(r)+'">'+(i?s:Si(s,!0))+`</code></pre>
`:"<pre><code>"+(i?s:Si(s,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,i=e.start;let r="";for(let a=0;a<e.items.length;a++){const l=e.items[a];r+=this.listitem(l)}const s=t?"ol":"ul",o=t&&i!==1?' start="'+i+'"':"";return"<"+s+o+`>
`+r+"</"+s+`>
`}listitem(e){let t="";if(e.task){const i=this.checkbox({checked:!!e.checked});e.loose?e.tokens.length>0&&e.tokens[0].type==="paragraph"?(e.tokens[0].text=i+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=i+" "+e.tokens[0].tokens[0].text)):e.tokens.unshift({type:"text",raw:i+" ",text:i+" "}):t+=i+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",i="";for(let s=0;s<e.header.length;s++)i+=this.tablecell(e.header[s]);t+=this.tablerow({text:i});let r="";for(let s=0;s<e.rows.length;s++){const o=e.rows[s];i="";for(let a=0;a<o.length;a++)i+=this.tablecell(o[a]);r+=this.tablerow({text:i})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),i=e.header?"th":"td";return(e.align?`<${i} align="${e.align}">`:`<${i}>`)+t+`</${i}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${e}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:i}){const r=this.parser.parseInline(i),s=xE(e);if(s===null)return r;e=s;let o='<a href="'+e+'"';return t&&(o+=' title="'+t+'"'),o+=">"+r+"</a>",o}image({href:e,title:t,text:i}){const r=xE(e);if(r===null)return i;e=r;let s=`<img src="${e}" alt="${i}"`;return t&&(s+=` title="${t}"`),s+=">",s}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):e.text}}class Ax{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class Fr{constructor(e){At(this,"options");At(this,"renderer");At(this,"textRenderer");this.options=e||Il,this.options.renderer=this.options.renderer||new gg,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Ax}static parse(e,t){return new Fr(t).parse(e)}static parseInline(e,t){return new Fr(t).parseInline(e)}parse(e,t=!0){let i="";for(let r=0;r<e.length;r++){const s=e[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){const a=s,l=this.options.extensions.renderers[a.type].call({parser:this},a);if(l!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(a.type)){i+=l||"";continue}}const o=s;switch(o.type){case"space":{i+=this.renderer.space(o);continue}case"hr":{i+=this.renderer.hr(o);continue}case"heading":{i+=this.renderer.heading(o);continue}case"code":{i+=this.renderer.code(o);continue}case"table":{i+=this.renderer.table(o);continue}case"blockquote":{i+=this.renderer.blockquote(o);continue}case"list":{i+=this.renderer.list(o);continue}case"html":{i+=this.renderer.html(o);continue}case"paragraph":{i+=this.renderer.paragraph(o);continue}case"text":{let a=o,l=this.renderer.text(a);for(;r+1<e.length&&e[r+1].type==="text";)a=e[++r],l+=`
`+this.renderer.text(a);t?i+=this.renderer.paragraph({type:"paragraph",raw:l,text:l,tokens:[{type:"text",raw:l,text:l}]}):i+=l;continue}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return i}parseInline(e,t){t=t||this.renderer;let i="";for(let r=0;r<e.length;r++){const s=e[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){const a=this.options.extensions.renderers[s.type].call({parser:this},s);if(a!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){i+=a||"";continue}}const o=s;switch(o.type){case"escape":{i+=t.text(o);break}case"html":{i+=t.html(o);break}case"link":{i+=t.link(o);break}case"image":{i+=t.image(o);break}case"strong":{i+=t.strong(o);break}case"em":{i+=t.em(o);break}case"codespan":{i+=t.codespan(o);break}case"br":{i+=t.br(o);break}case"del":{i+=t.del(o);break}case"text":{i+=t.text(o);break}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return i}}class Od{constructor(e){At(this,"options");this.options=e||Il}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}}At(Od,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));class f8{constructor(...e){At(this,"defaults",Dx());At(this,"options",this.setOptions);At(this,"parse",this.parseMarkdown(Or.lex,Fr.parse));At(this,"parseInline",this.parseMarkdown(Or.lexInline,Fr.parseInline));At(this,"Parser",Fr);At(this,"Renderer",gg);At(this,"TextRenderer",Ax);At(this,"Lexer",Or);At(this,"Tokenizer",fg);At(this,"Hooks",Od);this.use(...e)}walkTokens(e,t){var r,s;let i=[];for(const o of e)switch(i=i.concat(t.call(this,o)),o.type){case"table":{const a=o;for(const l of a.header)i=i.concat(this.walkTokens(l.tokens,t));for(const l of a.rows)for(const c of l)i=i.concat(this.walkTokens(c.tokens,t));break}case"list":{const a=o;i=i.concat(this.walkTokens(a.items,t));break}default:{const a=o;(s=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&s[a.type]?this.defaults.extensions.childTokens[a.type].forEach(l=>{const c=a[l].flat(1/0);i=i.concat(this.walkTokens(c,t))}):a.tokens&&(i=i.concat(this.walkTokens(a.tokens,t)))}}return i}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(i=>{const r={...i};if(r.async=this.defaults.async||r.async||!1,i.extensions&&(i.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const o=t.renderers[s.name];o?t.renderers[s.name]=function(...a){let l=s.renderer.apply(this,a);return l===!1&&(l=o.apply(this,a)),l}:t.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const o=t[s.level];o?o.unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(t.childTokens[s.name]=s.childTokens)}),r.extensions=t),i.renderer){const s=this.defaults.renderer||new gg(this.defaults);for(const o in i.renderer){if(!(o in s))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;const a=o,l=i.renderer[a],c=s[a];s[a]=(...u)=>{let d=l.apply(s,u);return d===!1&&(d=c.apply(s,u)),d||""}}r.renderer=s}if(i.tokenizer){const s=this.defaults.tokenizer||new fg(this.defaults);for(const o in i.tokenizer){if(!(o in s))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;const a=o,l=i.tokenizer[a],c=s[a];s[a]=(...u)=>{let d=l.apply(s,u);return d===!1&&(d=c.apply(s,u)),d}}r.tokenizer=s}if(i.hooks){const s=this.defaults.hooks||new Od;for(const o in i.hooks){if(!(o in s))throw new Error(`hook '${o}' does not exist`);if(o==="options")continue;const a=o,l=i.hooks[a],c=s[a];Od.passThroughHooks.has(o)?s[a]=u=>{if(this.defaults.async)return Promise.resolve(l.call(s,u)).then(f=>c.call(s,f));const d=l.call(s,u);return c.call(s,d)}:s[a]=(...u)=>{let d=l.apply(s,u);return d===!1&&(d=c.apply(s,u)),d}}r.hooks=s}if(i.walkTokens){const s=this.defaults.walkTokens,o=i.walkTokens;r.walkTokens=function(a){let l=[];return l.push(o.call(this,a)),s&&(l=l.concat(s.call(this,a))),l}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Or.lex(e,t??this.defaults)}parser(e,t){return Fr.parse(e,t??this.defaults)}parseMarkdown(e,t){return(r,s)=>{const o={...s},a={...this.defaults,...o},l=this.onError(!!a.silent,!!a.async);if(this.defaults.async===!0&&o.async===!1)return l(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof r>"u"||r===null)return l(new Error("marked(): input parameter is undefined or null"));if(typeof r!="string")return l(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected"));if(a.hooks&&(a.hooks.options=a),a.async)return Promise.resolve(a.hooks?a.hooks.preprocess(r):r).then(c=>e(c,a)).then(c=>a.hooks?a.hooks.processAllTokens(c):c).then(c=>a.walkTokens?Promise.all(this.walkTokens(c,a.walkTokens)).then(()=>c):c).then(c=>t(c,a)).then(c=>a.hooks?a.hooks.postprocess(c):c).catch(l);try{a.hooks&&(r=a.hooks.preprocess(r));let c=e(r,a);a.hooks&&(c=a.hooks.processAllTokens(c)),a.walkTokens&&this.walkTokens(c,a.walkTokens);let u=t(c,a);return a.hooks&&(u=a.hooks.postprocess(u)),u}catch(c){return l(c)}}}onError(e,t){return i=>{if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const r="<p>An error occurred:</p><pre>"+Si(i.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(i);throw i}}}const ml=new f8;function wt(n,e){return ml.parse(n,e)}wt.options=wt.setOptions=function(n){return ml.setOptions(n),wt.defaults=ml.defaults,oC(wt.defaults),wt};wt.getDefaults=Dx;wt.defaults=Il;wt.use=function(...n){return ml.use(...n),wt.defaults=ml.defaults,oC(wt.defaults),wt};wt.walkTokens=function(n,e){return ml.walkTokens(n,e)};wt.parseInline=ml.parseInline;wt.Parser=Fr;wt.parser=Fr.parse;wt.Renderer=gg;wt.TextRenderer=Ax;wt.Lexer=Or;wt.lexer=Or.lex;wt.Tokenizer=fg;wt.Hooks=Od;wt.parse=wt;wt.options;wt.setOptions;wt.use;wt.walkTokens;wt.parseInline;Fr.parse;Or.lex;function p8(n){return JSON.stringify(n,g8)}function mC(n){let e=JSON.parse(n);return e=jn(e),e}function g8(n,e){return e instanceof RegExp?{$mid:rt.Regexp,source:e.source,flags:e.flags}:e}function jn(n,e=0){if(!n||e>200)return n;if(typeof n=="object"){switch(n.$mid){case rt.Uri:return y.revive(n);case rt.Regexp:return new RegExp(n.source,n.flags);case rt.Date:return new Date(n.source)}if(n instanceof Pe||n instanceof Uint8Array)return n;if(Array.isArray(n))for(let t=0;t<n.length;++t)n[t]=jn(n[t],e+1);else for(const t in n)Object.hasOwnProperty.call(n,t)&&(n[t]=jn(n[t],e+1))}return n}const Ts=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list",html:"text/html"}),m8=/^(.+)\/(.+?)(;.+)?$/;function _C(n,e){const t=m8.exec(n);return t?`${t[1].toLowerCase()}/${t[2].toLowerCase()}${t[3]??""}`:e?void 0:n}const Hn=Symbol("unset");class _8{constructor(){this.root=new sv,this._size=0}get size(){return this._size}get nodes(){var e;return((e=this.root.children)==null?void 0:e.values())||zn.empty()}get entries(){var e;return((e=this.root.children)==null?void 0:e.entries())||zn.empty()}insert(e,t,i){this.opNode(e,r=>r._value=t,i)}mutate(e,t){this.opNode(e,i=>i._value=t(i._value===Hn?void 0:i._value))}mutatePath(e,t){this.opNode(e,()=>{},i=>t(i))}delete(e){var s;const t=this.getPathToKey(e);if(!t)return;let i=t.length-1;const r=t[i].node._value;if(r!==Hn){for(this._size--,t[i].node._value=Hn;i>0;i--){const{node:o,part:a}=t[i];if((s=o.children)!=null&&s.size||o._value!==Hn)break;t[i-1].node.children.delete(a)}return r}}*deleteRecursive(e){const t=this.getPathToKey(e);if(!t)return;const i=t[t.length-1].node;for(let r=t.length-1;r>0;r--){const s=t[r-1];if(s.node.children.delete(t[r].part),s.node.children.size>0||s.node._value!==Hn)break}for(const r of kE(i))r._value!==Hn&&(this._size--,yield r._value);i===this.root&&(this.root._value=Hn,this.root.children=void 0)}find(e){var i;let t=this.root;for(const r of e){const s=(i=t.children)==null?void 0:i.get(r);if(!s)return;t=s}return t._value===Hn?void 0:t._value}hasKeyOrParent(e){var i;let t=this.root;for(const r of e){const s=(i=t.children)==null?void 0:i.get(r);if(!s)return!1;if(s._value!==Hn)return!0;t=s}return!1}hasKeyOrChildren(e){var i;let t=this.root;for(const r of e){const s=(i=t.children)==null?void 0:i.get(r);if(!s)return!1;t=s}return!0}hasKey(e){var i;let t=this.root;for(const r of e){const s=(i=t.children)==null?void 0:i.get(r);if(!s)return!1;t=s}return t._value!==Hn}getPathToKey(e){var r;const t=[{part:"",node:this.root}];let i=0;for(const s of e){const o=(r=t[i].node.children)==null?void 0:r.get(s);if(!o)return;t.push({part:s,node:o}),i++}return t}opNode(e,t,i){let r=this.root;for(const a of e){if(r.children)if(r.children.has(a))r=r.children.get(a);else{const l=new sv;r.children.set(a,l),r=l}else{const l=new sv;r.children=new Map([[a,l]]),r=l}i==null||i(r)}const s=r._value===Hn?0:1;t(r);const o=r._value===Hn?0:1;this._size+=o-s}*values(){for(const{_value:e}of kE(this.root))e!==Hn&&(yield e)}}function*kE(n){const e=[n];for(;e.length>0;){const t=e.pop();if(yield t,t.children)for(const i of t.children.values())e.push(i)}}class sv{constructor(){this._value=Hn}get value(){return this._value===Hn?void 0:this._value}set value(e){this._value=e===void 0?Hn:e}}var Va;(function(n){n[n.Auto=1]="Auto",n[n.Hidden=2]="Hidden",n[n.Visible=3]="Visible"})(Va||(Va={}));const IE={bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}},vC="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function v8(n=""){let e="(-?\\d*\\.\\d\\w*)|([^";for(const t of vC)n.indexOf(t)>=0||(e+="\\"+t);return e+="\\s]+)",new RegExp(e,"g")}const w8=v8();function wC(n){let e=w8;if(n&&n instanceof RegExp)if(n.global)e=n;else{let t="g";n.ignoreCase&&(t+="i"),n.multiline&&(t+="m"),n.unicode&&(t+="u"),e=new RegExp(n.source,t)}return e.lastIndex=0,e}const bC=new Hf;bC.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function yC(n,e,t,i,r){if(e=wC(e),r||(r=zn.first(bC)),t.length>r.maxLen){let c=n-r.maxLen/2;return c<0?c=0:i+=c,t=t.substring(c,n+r.maxLen/2),yC(n,e,t,i,r)}const s=Date.now(),o=n-1-i;let a=-1,l=null;for(let c=1;!(Date.now()-s>=r.timeBudget);c++){const u=o-r.windowSize*c;e.lastIndex=Math.max(0,u);const d=b8(e,t,o,a);if(!d&&l||(l=d,u<=0))break;a=u}if(l){const c={word:l[0],startColumn:i+1+l.index,endColumn:i+1+l.index+l[0].length};return e.lastIndex=0,c}return null}function b8(n,e,t,i){let r;for(;r=n.exec(e);){const s=r.index||0;if(s<=t&&n.lastIndex>=t)return r;if(i>0&&s>i)return null}return null}var X;(function(n){n[n.LParen=0]="LParen",n[n.RParen=1]="RParen",n[n.Neg=2]="Neg",n[n.Eq=3]="Eq",n[n.NotEq=4]="NotEq",n[n.Lt=5]="Lt",n[n.LtEq=6]="LtEq",n[n.Gt=7]="Gt",n[n.GtEq=8]="GtEq",n[n.RegexOp=9]="RegexOp",n[n.RegexStr=10]="RegexStr",n[n.True=11]="True",n[n.False=12]="False",n[n.In=13]="In",n[n.Not=14]="Not",n[n.And=15]="And",n[n.Or=16]="Or",n[n.Str=17]="Str",n[n.QuotedStr=18]="QuotedStr",n[n.Error=19]="Error",n[n.EOF=20]="EOF"})(X||(X={}));function ov(...n){switch(n.length){case 1:return h(1738,"Did you mean {0}?",n[0]);case 2:return h(1739,"Did you mean {0} or {1}?",n[0],n[1]);case 3:return h(1740,"Did you mean {0}, {1} or {2}?",n[0],n[1],n[2]);default:return}}const y8=h(1741,"Did you forget to open or close the quote?"),x8=h(1742,"Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'."),mc=class mc{constructor(){this._input="",this._start=0,this._current=0,this._tokens=[],this._errors=[],this.stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy}static getLexeme(e){switch(e.type){case X.LParen:return"(";case X.RParen:return")";case X.Neg:return"!";case X.Eq:return e.isTripleEq?"===":"==";case X.NotEq:return e.isTripleEq?"!==":"!=";case X.Lt:return"<";case X.LtEq:return"<=";case X.Gt:return">=";case X.GtEq:return">=";case X.RegexOp:return"=~";case X.RegexStr:return e.lexeme;case X.True:return"true";case X.False:return"false";case X.In:return"in";case X.Not:return"not";case X.And:return"&&";case X.Or:return"||";case X.Str:return e.lexeme;case X.QuotedStr:return e.lexeme;case X.Error:return e.lexeme;case X.EOF:return"EOF";default:throw sx(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}get errors(){return this._errors}reset(e){return this._input=e,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case P.OpenParen:this._addToken(X.LParen);break;case P.CloseParen:this._addToken(X.RParen);break;case P.ExclamationMark:if(this._match(P.Equals)){const t=this._match(P.Equals);this._tokens.push({type:X.NotEq,offset:this._start,isTripleEq:t})}else this._addToken(X.Neg);break;case P.SingleQuote:this._quotedString();break;case P.Slash:this._regex();break;case P.Equals:if(this._match(P.Equals)){const t=this._match(P.Equals);this._tokens.push({type:X.Eq,offset:this._start,isTripleEq:t})}else this._match(P.Tilde)?this._addToken(X.RegexOp):this._error(ov("==","=~"));break;case P.LessThan:this._addToken(this._match(P.Equals)?X.LtEq:X.Lt);break;case P.GreaterThan:this._addToken(this._match(P.Equals)?X.GtEq:X.Gt);break;case P.Ampersand:this._match(P.Ampersand)?this._addToken(X.And):this._error(ov("&&"));break;case P.Pipe:this._match(P.Pipe)?this._addToken(X.Or):this._error(ov("||"));break;case P.Space:case P.CarriageReturn:case P.Tab:case P.LineFeed:case P.NoBreakSpace:break;default:this._string()}return this._start=this._current,this._addToken(X.EOF),Array.from(this._tokens)}_match(e){return this._isAtEnd()||this._input.charCodeAt(this._current)!==e?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?P.Null:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){const t=this._start,i=this._input.substring(this._start,this._current),r={type:X.Error,offset:this._start,lexeme:i};this._errors.push({offset:t,lexeme:i,additionalInfo:e}),this._tokens.push(r)}_string(){this.stringRe.lastIndex=this._start;const e=this.stringRe.exec(this._input);if(e){this._current=this._start+e[0].length;const t=this._input.substring(this._start,this._current),i=mc._keywords.get(t);i?this._addToken(i):this._tokens.push({type:X.Str,lexeme:t,offset:this._start})}}_quotedString(){for(;this._peek()!==P.SingleQuote&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(y8);return}this._advance(),this._tokens.push({type:X.QuotedStr,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let e=this._current,t=!1,i=!1;for(;;){if(e>=this._input.length){this._current=e,this._error(x8);return}const s=this._input.charCodeAt(e);if(t)t=!1;else if(s===P.Slash&&!i){e++;break}else s===P.OpenSquareBracket?i=!0:s===P.Backslash?t=!0:s===P.CloseSquareBracket&&(i=!1);e++}for(;e<this._input.length&&mc._regexFlags.has(this._input.charCodeAt(e));)e++;this._current=e;const r=this._input.substring(this._start,this._current);this._tokens.push({type:X.RegexStr,lexeme:r,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}};mc._regexFlags=new Set(["i","g","s","m","y","u"].map(e=>e.charCodeAt(0))),mc._keywords=new Map([["not",X.Not],["in",X.In],["false",X.False],["true",X.True]]);let Xo=mc;const mn=new Map;mn.set("false",!1);mn.set("true",!0);mn.set("isMac",Pi);mn.set("isLinux",Fs);mn.set("isWindows",ni);mn.set("isWeb",Bf);mn.set("isMacNative",Pi&&!Bf);mn.set("isEdge",xI);mn.set("isFirefox",LP);mn.set("isChrome",px);mn.set("isSafari",NP);const E8=Object.prototype.hasOwnProperty;var Lt;(function(n){n[n.False=0]="False",n[n.True=1]="True",n[n.Defined=2]="Defined",n[n.Not=3]="Not",n[n.Equals=4]="Equals",n[n.NotEquals=5]="NotEquals",n[n.And=6]="And",n[n.Regex=7]="Regex",n[n.NotRegex=8]="NotRegex",n[n.Or=9]="Or",n[n.In=10]="In",n[n.NotIn=11]="NotIn",n[n.Greater=12]="Greater",n[n.GreaterEquals=13]="GreaterEquals",n[n.Smaller=14]="Smaller",n[n.SmallerEquals=15]="SmallerEquals"})(Lt||(Lt={}));const S8={regexParsingWithErrorRecovery:!0},D8=h(1718,"Empty context key expression"),k8=h(1719,"Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),I8=h(1720,"'in' after 'not'."),CE=h(1721,"closing parenthesis ')'"),C8=h(1722,"Unexpected token"),P8=h(1723,"Did you forget to put && or || before the token?"),T8=h(1724,"Unexpected end of expression"),A8=h(1725,"Did you forget to put a context key?"),ra=class ra{get lexingErrors(){return this._scanner.errors}get parsingErrors(){return this._parsingErrors}constructor(e=S8){this._config=e,this._scanner=new Xo,this._tokens=[],this._current=0,this._parsingErrors=[],this._flagsGYRe=/g|y/g}parse(e){if(e===""){this._parsingErrors.push({message:D8,offset:0,lexeme:"",additionalInfo:k8});return}this._tokens=this._scanner.reset(e).scan(),this._current=0,this._parsingErrors=[];try{const t=this._expr();if(!this._isAtEnd()){const i=this._peek(),r=i.type===X.Str?P8:void 0;throw this._parsingErrors.push({message:C8,offset:i.offset,lexeme:Xo.getLexeme(i),additionalInfo:r}),ra._parseError}return t}catch(t){if(t!==ra._parseError)throw t;return}}_expr(){return this._or()}_or(){const e=[this._and()];for(;this._matchOne(X.Or);){const t=this._and();e.push(t)}return e.length===1?e[0]:mt.or(...e)}_and(){const e=[this._term()];for(;this._matchOne(X.And);){const t=this._term();e.push(t)}return e.length===1?e[0]:mt.and(...e)}_term(){if(this._matchOne(X.Neg)){const e=this._peek();switch(e.type){case X.True:return this._advance(),$n.INSTANCE;case X.False:return this._advance(),Gn.INSTANCE;case X.LParen:{this._advance();const t=this._expr();return this._consume(X.RParen,CE),t==null?void 0:t.negate()}case X.Str:return this._advance(),Pl.create(e.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",e)}}return this._primary()}_primary(){const e=this._peek();switch(e.type){case X.True:return this._advance(),mt.true();case X.False:return this._advance(),mt.false();case X.LParen:{this._advance();const t=this._expr();return this._consume(X.RParen,CE),t}case X.Str:{const t=e.lexeme;if(this._advance(),this._matchOne(X.RegexOp)){const r=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),r.type!==X.RegexStr)throw this._errExpectedButGot("REGEX",r);const s=r.lexeme,o=s.lastIndexOf("/"),a=o===s.length-1?void 0:this._removeFlagsGY(s.substring(o+1));let l;try{l=new RegExp(s.substring(1,o),a)}catch{throw this._errExpectedButGot("REGEX",r)}return vh.create(t,l)}switch(r.type){case X.RegexStr:case X.Error:{const s=[r.lexeme];this._advance();let o=this._peek(),a=0;for(let f=0;f<r.lexeme.length;f++)r.lexeme.charCodeAt(f)===P.OpenParen?a++:r.lexeme.charCodeAt(f)===P.CloseParen&&a--;for(;!this._isAtEnd()&&o.type!==X.And&&o.type!==X.Or;){switch(o.type){case X.LParen:a++;break;case X.RParen:a--;break;case X.RegexStr:case X.QuotedStr:for(let f=0;f<o.lexeme.length;f++)o.lexeme.charCodeAt(f)===P.OpenParen?a++:r.lexeme.charCodeAt(f)===P.CloseParen&&a--}if(a<0)break;s.push(Xo.getLexeme(o)),this._advance(),o=this._peek()}const l=s.join(""),c=l.lastIndexOf("/"),u=c===l.length-1?void 0:this._removeFlagsGY(l.substring(c+1));let d;try{d=new RegExp(l.substring(1,c),u)}catch{throw this._errExpectedButGot("REGEX",r)}return mt.regex(t,d)}case X.QuotedStr:{const s=r.lexeme;this._advance();let o=null;if(!mh(s)){const a=s.indexOf("/"),l=s.lastIndexOf("/");if(a!==l&&a>=0){const c=s.slice(a+1,l),u=s[l+1]==="i"?"i":"";try{o=new RegExp(c,u)}catch{throw this._errExpectedButGot("REGEX",r)}}}if(o===null)throw this._errExpectedButGot("REGEX",r);return vh.create(t,o)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(X.Not)){this._consume(X.In,I8);const r=this._value();return mt.notIn(t,r)}switch(this._peek().type){case X.Eq:{this._advance();const r=this._value();if(this._previous().type===X.QuotedStr)return mt.equals(t,r);switch(r){case"true":return mt.has(t);case"false":return mt.not(t);default:return mt.equals(t,r)}}case X.NotEq:{this._advance();const r=this._value();if(this._previous().type===X.QuotedStr)return mt.notEquals(t,r);switch(r){case"true":return mt.not(t);case"false":return mt.has(t);default:return mt.notEquals(t,r)}}case X.Lt:return this._advance(),Xf.create(t,this._value());case X.LtEq:return this._advance(),Yf.create(t,this._value());case X.Gt:return this._advance(),Xu.create(t,this._value());case X.GtEq:return this._advance(),Jf.create(t,this._value());case X.In:return this._advance(),mt.in(t,this._value());default:return mt.has(t)}}case X.EOF:throw this._parsingErrors.push({message:T8,offset:e.offset,lexeme:"",additionalInfo:A8}),ra._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){const e=this._peek();switch(e.type){case X.Str:case X.QuotedStr:return this._advance(),e.lexeme;case X.True:return this._advance(),"true";case X.False:return this._advance(),"false";case X.In:return this._advance(),"in";default:return""}}_removeFlagsGY(e){return e.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(e){return this._check(e)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(e,t){if(this._check(e))return this._advance();throw this._errExpectedButGot(t,this._peek())}_errExpectedButGot(e,t,i){const r=h(1726,`Expected: {0}
Received: '{1}'.`,e,Xo.getLexeme(t)),s=t.offset,o=Xo.getLexeme(t);return this._parsingErrors.push({message:r,offset:s,lexeme:o,additionalInfo:i}),ra._parseError}_check(e){return this._peek().type===e}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===X.EOF}};ra._parseError=new Error;let mg=ra;const m2=class m2{static false(){return $n.INSTANCE}static true(){return Gn.INSTANCE}static has(e){return Cl.create(e)}static equals(e,t){return Gf.create(e,t)}static notEquals(e,t){return Qf.create(e,t)}static regex(e,t){return vh.create(e,t)}static in(e,t){return c_.create(e,t)}static notIn(e,t){return u_.create(e,t)}static not(e){return Pl.create(e)}static and(...e){return to.create(e,null,!0)}static or(...e){return Ir.create(e,null,!0)}static greater(e,t){return Xu.create(e,t)}static greaterEquals(e,t){return Jf.create(e,t)}static smaller(e,t){return Xf.create(e,t)}static smallerEquals(e,t){return Yf.create(e,t)}static deserialize(e){return e==null?void 0:this._parser.parse(e)}};m2._parser=new mg({regexParsingWithErrorRecovery:!1});let mt=m2;function R8(n){const e=new mg({regexParsingWithErrorRecovery:!1});return n.map(t=>(e.parse(t),e.lexingErrors.length>0?e.lexingErrors.map(i=>({errorMessage:i.additionalInfo?h(1727,"Unexpected token. Hint: {0}",i.additionalInfo):h(1728,"Unexpected token."),offset:i.offset,length:i.lexeme.length})):e.parsingErrors.length>0?e.parsingErrors.map(i=>({errorMessage:i.additionalInfo?`${i.message}. ${i.additionalInfo}`:i.message,offset:i.offset,length:i.lexeme.length})):[]))}function Fd(n,e){return n.cmp(e)}const P1=class P1{constructor(){this.type=Lt.False}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!1}serialize(){return"false"}keys(){return[]}map(e){return this}negate(){return Gn.INSTANCE}};P1.INSTANCE=new P1;let $n=P1;const T1=class T1{constructor(){this.type=Lt.True}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!0}serialize(){return"true"}keys(){return[]}map(e){return this}negate(){return $n.INSTANCE}};T1.INSTANCE=new T1;let Gn=T1;class Cl{static create(e,t=null){const i=mn.get(e);return typeof i=="boolean"?i?Gn.INSTANCE:$n.INSTANCE:new Cl(e,t)}constructor(e,t){this.key=e,this.negated=t,this.type=Lt.Defined}cmp(e){return e.type!==this.type?this.type-e.type:EC(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=mn.get(this.key);return typeof e=="boolean"?e?Gn.INSTANCE:$n.INSTANCE:this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(e){return e.mapDefined(this.key)}negate(){return this.negated||(this.negated=Pl.create(this.key,this)),this.negated}}class Gf{static create(e,t,i=null){if(typeof t=="boolean")return t?Cl.create(e,i):Pl.create(e,i);const r=mn.get(e);return typeof r=="boolean"?t===(r?"true":"false")?Gn.INSTANCE:$n.INSTANCE:new Gf(e,t,i)}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=Lt.Equals}cmp(e){return e.type!==this.type?this.type-e.type:Tl(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=mn.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?Gn.INSTANCE:$n.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}map(e){return e.mapEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Qf.create(this.key,this.value,this)),this.negated}}class c_{static create(e,t){return new c_(e,t)}constructor(e,t){this.key=e,this.valueKey=t,this.type=Lt.In,this.negated=null}cmp(e){return e.type!==this.type?this.type-e.type:Tl(this.key,this.valueKey,e.key,e.valueKey)}equals(e){return e.type===this.type?this.key===e.key&&this.valueKey===e.valueKey:!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.valueKey),i=e.getValue(this.key);return Array.isArray(t)?t.includes(i):typeof i=="string"&&typeof t=="object"&&t!==null?E8.call(t,i):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}map(e){return e.mapIn(this.key,this.valueKey)}negate(){return this.negated||(this.negated=u_.create(this.key,this.valueKey)),this.negated}}class u_{static create(e,t){return new u_(e,t)}constructor(e,t){this.key=e,this.valueKey=t,this.type=Lt.NotIn,this._negated=c_.create(e,t)}cmp(e){return e.type!==this.type?this.type-e.type:this._negated.cmp(e._negated)}equals(e){return e.type===this.type?this._negated.equals(e._negated):!1}substituteConstants(){return this}evaluate(e){return!this._negated.evaluate(e)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}map(e){return e.mapNotIn(this.key,this.valueKey)}negate(){return this._negated}}class Qf{static create(e,t,i=null){if(typeof t=="boolean")return t?Pl.create(e,i):Cl.create(e,i);const r=mn.get(e);return typeof r=="boolean"?t===(r?"true":"false")?$n.INSTANCE:Gn.INSTANCE:new Qf(e,t,i)}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=Lt.NotEquals}cmp(e){return e.type!==this.type?this.type-e.type:Tl(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=mn.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?$n.INSTANCE:Gn.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}map(e){return e.mapNotEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Gf.create(this.key,this.value,this)),this.negated}}class Pl{static create(e,t=null){const i=mn.get(e);return typeof i=="boolean"?i?$n.INSTANCE:Gn.INSTANCE:new Pl(e,t)}constructor(e,t){this.key=e,this.negated=t,this.type=Lt.Not}cmp(e){return e.type!==this.type?this.type-e.type:EC(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=mn.get(this.key);return typeof e=="boolean"?e?$n.INSTANCE:Gn.INSTANCE:this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}map(e){return e.mapNot(this.key)}negate(){return this.negated||(this.negated=Cl.create(this.key,this)),this.negated}}function d_(n,e){if(typeof n=="string"){const t=parseFloat(n);isNaN(t)||(n=t)}return typeof n=="string"||typeof n=="number"?e(n):$n.INSTANCE}class Xu{static create(e,t,i=null){return d_(t,r=>new Xu(e,r,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=Lt.Greater}cmp(e){return e.type!==this.type?this.type-e.type:Tl(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreater(this.key,this.value)}negate(){return this.negated||(this.negated=Yf.create(this.key,this.value,this)),this.negated}}class Jf{static create(e,t,i=null){return d_(t,r=>new Jf(e,r,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=Lt.GreaterEquals}cmp(e){return e.type!==this.type?this.type-e.type:Tl(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreaterEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Xf.create(this.key,this.value,this)),this.negated}}class Xf{static create(e,t,i=null){return d_(t,r=>new Xf(e,r,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=Lt.Smaller}cmp(e){return e.type!==this.type?this.type-e.type:Tl(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmaller(this.key,this.value)}negate(){return this.negated||(this.negated=Jf.create(this.key,this.value,this)),this.negated}}class Yf{static create(e,t,i=null){return d_(t,r=>new Yf(e,r,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=Lt.SmallerEquals}cmp(e){return e.type!==this.type?this.type-e.type:Tl(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmallerEquals(this.key,this.value)}negate(){return this.negated||(this.negated=Xu.create(this.key,this.value,this)),this.negated}}class vh{static create(e,t){return new vh(e,t)}constructor(e,t){this.key=e,this.regexp=t,this.type=Lt.Regex,this.negated=null}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.key<e.key)return-1;if(this.key>e.key)return 1;const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return t<i?-1:t>i?1:0}equals(e){if(e.type===this.type){const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return this.key===e.key&&t===i}return!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.key);return this.regexp?this.regexp.test(t):!1}serialize(){const e=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}map(e){return e.mapRegex(this.key,this.regexp)}negate(){return this.negated||(this.negated=_g.create(this)),this.negated}}class _g{static create(e){return new _g(e)}constructor(e){this._actual=e,this.type=Lt.NotRegex}cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type?this._actual.equals(e._actual):!1}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}map(e){return new _g(this._actual.map(e))}negate(){return this._actual}}function xC(n){let e=null;for(let t=0,i=n.length;t<i;t++){const r=n[t].substituteConstants();if(n[t]!==r&&e===null){e=[];for(let s=0;s<t;s++)e[s]=n[s]}e!==null&&(e[t]=r)}return e===null?n:e}class to{static create(e,t,i){return to._normalizeArr(e,t,i)}constructor(e,t){this.expr=e,this.negated=t,this.type=Lt.And}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const r=Fd(this.expr[t],e.expr[t]);if(r!==0)return r}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=xC(this.expr);return e===this.expr?this:to.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].evaluate(e))return!1;return!0}static _normalizeArr(e,t,i){const r=[];let s=!1;for(const o of e)if(o){if(o.type===Lt.True){s=!0;continue}if(o.type===Lt.False)return $n.INSTANCE;if(o.type===Lt.And){r.push(...o.expr);continue}r.push(o)}if(r.length===0&&s)return Gn.INSTANCE;if(r.length!==0){if(r.length===1)return r[0];r.sort(Fd);for(let o=1;o<r.length;o++)r[o-1].equals(r[o])&&(r.splice(o,1),o--);if(r.length===1)return r[0];for(;r.length>1;){const o=r[r.length-1];if(o.type!==Lt.Or)break;r.pop();const a=r.pop(),l=r.length===0,c=Ir.create(o.expr.map(u=>to.create([u,a],null,i)),null,l);c&&(r.push(c),r.sort(Fd))}if(r.length===1)return r[0];if(i){for(let o=0;o<r.length;o++)for(let a=o+1;a<r.length;a++)if(r[o].negate().equals(r[a]))return $n.INSTANCE;if(r.length===1)return r[0]}return new to(r,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" && ")}keys(){const e=[];for(const t of this.expr)e.push(...t.keys());return e}map(e){return new to(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){const e=[];for(const t of this.expr)e.push(t.negate());this.negated=Ir.create(e,this,!0)}return this.negated}}class Ir{static create(e,t,i){return Ir._normalizeArr(e,t,i)}constructor(e,t){this.expr=e,this.negated=t,this.type=Lt.Or}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const r=Fd(this.expr[t],e.expr[t]);if(r!==0)return r}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=xC(this.expr);return e===this.expr?this:Ir.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(this.expr[t].evaluate(e))return!0;return!1}static _normalizeArr(e,t,i){let r=[],s=!1;if(e){for(let o=0,a=e.length;o<a;o++){const l=e[o];if(l){if(l.type===Lt.False){s=!0;continue}if(l.type===Lt.True)return Gn.INSTANCE;if(l.type===Lt.Or){r=r.concat(l.expr);continue}r.push(l)}}if(r.length===0&&s)return $n.INSTANCE;r.sort(Fd)}if(r.length!==0){if(r.length===1)return r[0];for(let o=1;o<r.length;o++)r[o-1].equals(r[o])&&(r.splice(o,1),o--);if(r.length===1)return r[0];if(i){for(let o=0;o<r.length;o++)for(let a=o+1;a<r.length;a++)if(r[o].negate().equals(r[a]))return Gn.INSTANCE;if(r.length===1)return r[0]}return new Ir(r,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" || ")}keys(){const e=[];for(const t of this.expr)e.push(...t.keys());return e}map(e){return new Ir(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){const e=[];for(const t of this.expr)e.push(t.negate());for(;e.length>1;){const t=e.shift(),i=e.shift(),r=[];for(const s of PE(t))for(const o of PE(i))r.push(to.create([s,o],null,!1));e.unshift(Ir.create(r,null,!1))}this.negated=Ir.create(e,this,!0)}return this.negated}}const _c=class _c extends Cl{static all(){return _c._info.values()}constructor(e,t,i){super(e,null),this._defaultValue=t,typeof i=="object"?_c._info.push({...i,key:e}):i!==!0&&_c._info.push({key:e,description:i,type:t!=null?typeof t:void 0})}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return Gf.create(this.key,e)}notEqualsTo(e){return Qf.create(this.key,e)}greater(e){return Xu.create(this.key,e)}};_c._info=[];let C=_c;function EC(n,e){return n<e?-1:n>e?1:0}function Tl(n,e,t,i){return n<t?-1:n>t?1:e<i?-1:e>i?1:0}function PE(n){return n.type===Lt.Or?n.expr:[n]}var ys;(function(n){n[n.Unknown=0]="Unknown",n[n.Disabled=1]="Disabled",n[n.Enabled=2]="Enabled"})(ys||(ys={}));new C("accessibilityModeEnabled",!1);let si;const av=globalThis.vscode;if(typeof av<"u"&&typeof av.context<"u"){const n=av.context.configuration();if(n)si=n.product;else throw new Error("Sandbox: unable to resolve product configuration from preload script.")}else if(globalThis._VSCODE_PRODUCT_JSON&&globalThis._VSCODE_PACKAGE_JSON){if(si=globalThis._VSCODE_PRODUCT_JSON,du.VSCODE_DEV&&Object.assign(si,{nameShort:`${si.nameShort} Dev`,nameLong:`${si.nameLong} Dev`,dataFolderName:`${si.dataFolderName}-dev`,serverDataFolderName:si.serverDataFolderName?`${si.serverDataFolderName}-dev`:void 0}),!si.version){const n=globalThis._VSCODE_PACKAGE_JSON;Object.assign(si,{version:n.version})}}else si={},Object.keys(si).length===0&&Object.assign(si,{version:"1.95.0-dev",nameShort:"Code - OSS Dev",nameLong:"Code - OSS Dev",applicationName:"code-oss",dataFolderName:".vscode-oss",urlProtocol:"code-oss",reportIssueUrl:"https://github.com/microsoft/vscode/issues/new",licenseName:"MIT",licenseUrl:"https://github.com/microsoft/vscode/blob/main/LICENSE.txt",serverLicenseUrl:"https://github.com/microsoft/vscode/blob/main/LICENSE.txt"});var L8=si,no;(function(n){n[n.None=0]="None",n[n.Keep=1]="Keep",n[n.Brackets=2]="Brackets",n[n.Advanced=3]="Advanced",n[n.Full=4]="Full"})(no||(no={}));const N8=8;class O8{constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}}class ut{constructor(e,t,i,r){this.id=e,this.name=t,this.defaultValue=i,this.schema=r}applyUpdate(e,t){return h_(e,t)}compute(e,t,i){return i}}class Pp{constructor(e,t){this.newValue=e,this.didChange=t}}function h_(n,e){if(typeof n!="object"||typeof e!="object"||!n||!e)return new Pp(e,n!==e);if(Array.isArray(n)||Array.isArray(e)){const i=Array.isArray(n)&&Array.isArray(e)&&$r(n,e);return new Pp(e,!i)}let t=!1;for(const i in e)if(e.hasOwnProperty(i)){const r=h_(n[i],e[i]);r.didChange&&(n[i]=r.newValue,t=!0)}return new Pp(n,t)}class Al{constructor(e){this.schema=void 0,this.id=e,this.name="_never_",this.defaultValue=void 0}applyUpdate(e,t){return h_(e,t)}validate(e){return this.defaultValue}}class Yu{constructor(e,t,i,r){this.id=e,this.name=t,this.defaultValue=i,this.schema=r}applyUpdate(e,t){return h_(e,t)}validate(e){return typeof e>"u"?this.defaultValue:e}compute(e,t,i){return i}}function te(n,e){return typeof n>"u"?e:n==="false"?!1:!!n}class Ae extends Yu{constructor(e,t,i,r=void 0){typeof r<"u"&&(r.type="boolean",r.default=i),super(e,t,i,r)}validate(e){return te(e,this.defaultValue)}}function F8(n,e,t,i){if(typeof n>"u")return e;let r=parseInt(n,10);return isNaN(r)?e:(r=Math.max(t,r),r=Math.min(i,r),r|0)}class Ge extends Yu{static clampedInt(e,t,i,r){return F8(e,t,i,r)}constructor(e,t,i,r,s,o=void 0){typeof o<"u"&&(o.type="integer",o.default=i,o.minimum=r,o.maximum=s),super(e,t,i,o),this.minimum=r,this.maximum=s}validate(e){return Ge.clampedInt(e,this.defaultValue,this.minimum,this.maximum)}}class Hi extends Yu{static clamp(e,t,i){return e<t?t:e>i?i:e}static float(e,t){if(typeof e=="number")return e;if(typeof e>"u")return t;const i=parseFloat(e);return isNaN(i)?t:i}constructor(e,t,i,r,s){typeof s<"u"&&(s.type="number",s.default=i),super(e,t,i,s),this.validationFn=r}validate(e){return this.validationFn(Hi.float(e,this.defaultValue))}}class Ln extends Yu{static string(e,t){return typeof e!="string"?t:e}constructor(e,t,i,r=void 0){typeof r<"u"&&(r.type="string",r.default=i),super(e,t,i,r)}validate(e){return Ln.string(e,this.defaultValue)}}function pt(n,e,t,i){return typeof n!="string"||t.indexOf(n)===-1?e:n}class dt extends Yu{constructor(e,t,i,r,s=void 0){typeof s<"u"&&(s.type="string",s.enum=r,s.default=i),super(e,t,i,s),this._allowedValues=r}validate(e){return pt(e,this.defaultValue,this._allowedValues)}}class hd extends ut{constructor(e,t,i,r,s,o,a=void 0){typeof a<"u"&&(a.type="string",a.enum=s,a.default=r),super(e,t,i,a),this._allowedValues=s,this._convert=o}validate(e){return typeof e!="string"?this.defaultValue:this._allowedValues.indexOf(e)===-1?this.defaultValue:this._convert(e)}}function M8(n){switch(n){case"none":return no.None;case"keep":return no.Keep;case"brackets":return no.Brackets;case"advanced":return no.Advanced;case"full":return no.Full}}class $8 extends ut{constructor(){super(R.accessibilitySupport,"accessibilitySupport",ys.Unknown,{type:"string",enum:["auto","on","off"],enumDescriptions:[h(262,"Use platform APIs to detect when a Screen Reader is attached."),h(263,"Optimize for usage with a Screen Reader."),h(264,"Assume a screen reader is not attached.")],default:"auto",tags:["accessibility"],description:h(265,"Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(e){switch(e){case"auto":return ys.Unknown;case"off":return ys.Disabled;case"on":return ys.Enabled}return this.defaultValue}compute(e,t,i){return i===ys.Unknown?e.accessibilitySupport:i}}class U8 extends ut{constructor(){const e={insertSpace:!0,ignoreEmptyLines:!0};super(R.comments,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:h(266,"Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:h(267,"Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertSpace:te(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:te(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}}var io;(function(n){n[n.Hidden=0]="Hidden",n[n.Blink=1]="Blink",n[n.Smooth=2]="Smooth",n[n.Phase=3]="Phase",n[n.Expand=4]="Expand",n[n.Solid=5]="Solid"})(io||(io={}));function H8(n){switch(n){case"blink":return io.Blink;case"smooth":return io.Smooth;case"phase":return io.Phase;case"expand":return io.Expand;case"solid":return io.Solid}}var or;(function(n){n[n.Line=1]="Line",n[n.Block=2]="Block",n[n.Underline=3]="Underline",n[n.LineThin=4]="LineThin",n[n.BlockOutline=5]="BlockOutline",n[n.UnderlineThin=6]="UnderlineThin"})(or||(or={}));function TE(n){switch(n){case"line":return or.Line;case"block":return or.Block;case"underline":return or.Underline;case"line-thin":return or.LineThin;case"block-outline":return or.BlockOutline;case"underline-thin":return or.UnderlineThin}}class B8 extends Al{constructor(){super(R.editorClassName)}compute(e,t,i){const r=["monaco-editor"];return t.get(R.extraEditorClassName)&&r.push(t.get(R.extraEditorClassName)),e.extraEditorClassName&&r.push(e.extraEditorClassName),t.get(R.mouseStyle)==="default"?r.push("mouse-default"):t.get(R.mouseStyle)==="copy"&&r.push("mouse-copy"),t.get(R.showUnused)&&r.push("showUnused"),t.get(R.showDeprecated)&&r.push("showDeprecated"),r.join(" ")}}class W8 extends Ae{constructor(){super(R.emptySelectionClipboard,"emptySelectionClipboard",!0,{description:h(268,"Controls whether copying without a selection copies the current line.")})}compute(e,t,i){return i&&e.emptySelectionClipboard}}class V8 extends ut{constructor(){const e={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0,history:"workspace",replaceHistory:"workspace"};super(R.find,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:h(269,"Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[h(270,"Never seed search string from the editor selection."),h(271,"Always seed search string from the editor selection, including word at cursor position."),h(272,"Only seed search string from the editor selection.")],description:h(273,"Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[h(274,"Never turn on Find in Selection automatically (default)."),h(275,"Always turn on Find in Selection automatically."),h(276,"Turn on Find in Selection automatically when multiple lines of content are selected.")],description:h(277,"Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:h(278,"Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:Pi},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:h(279,"Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:e.loop,description:h(280,"Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")},"editor.find.history":{type:"string",enum:["never","workspace"],default:"workspace",enumDescriptions:[h(281,"Do not store search history from the find widget."),h(282,"Store search history across the active workspace")],description:h(283,"Controls how the find widget history should be stored")},"editor.find.replaceHistory":{type:"string",enum:["never","workspace"],default:"workspace",enumDescriptions:[h(284,"Do not store history from the replace widget."),h(285,"Store replace history across the active workspace")],description:h(286,"Controls how the replace widget history should be stored")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{cursorMoveOnType:te(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:typeof e.seedSearchStringFromSelection=="boolean"?e.seedSearchStringFromSelection?"always":"never":pt(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof e.autoFindInSelection=="boolean"?e.autoFindInSelection?"always":"never":pt(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:te(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:te(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:te(t.loop,this.defaultValue.loop),history:pt(t.history,this.defaultValue.history,["never","workspace"]),replaceHistory:pt(t.replaceHistory,this.defaultValue.replaceHistory,["never","workspace"])}}}const cs=class cs extends ut{constructor(){super(R.fontLigatures,"fontLigatures",cs.OFF,{anyOf:[{type:"boolean",description:h(287,"Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:h(288,"Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:h(289,"Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"||e.length===0?cs.OFF:e==="true"?cs.ON:e:e?cs.ON:cs.OFF}};cs.OFF='"liga" off, "calt" off',cs.ON='"liga" on, "calt" on';let aw=cs;const us=class us extends ut{constructor(){super(R.fontVariations,"fontVariations",us.OFF,{anyOf:[{type:"boolean",description:h(290,"Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:h(291,"Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:h(292,"Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"?us.OFF:e==="true"?us.TRANSLATE:e:e?us.TRANSLATE:us.OFF}compute(e,t,i){return e.fontInfo.fontVariationSettings}};us.OFF="normal",us.TRANSLATE="translate";let lw=us;class z8 extends Al{constructor(){super(R.fontInfo)}compute(e,t,i){return e.fontInfo}}class q8 extends Al{constructor(){super(R.effectiveCursorStyle)}compute(e,t,i){return e.inputMode==="overtype"?t.get(R.overtypeCursorStyle):t.get(R.cursorStyle)}}class j8 extends Al{constructor(){super(R.effectiveExperimentalEditContextEnabled)}compute(e,t){return typeof globalThis.EditContext=="function"&&t.get(R.experimentalEditContextEnabled)}}class G8 extends Yu{constructor(){super(R.fontSize,"fontSize",As.fontSize,{type:"number",minimum:6,maximum:100,default:As.fontSize,description:h(293,"Controls the font size in pixels.")})}validate(e){const t=Hi.float(e,this.defaultValue);return t===0?As.fontSize:Hi.clamp(t,6,100)}compute(e,t,i){return e.fontInfo.fontSize}}const Sr=class Sr extends ut{constructor(){super(R.fontWeight,"fontWeight",As.fontWeight,{anyOf:[{type:"number",minimum:Sr.MINIMUM_VALUE,maximum:Sr.MAXIMUM_VALUE,errorMessage:h(294,'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:Sr.SUGGESTION_VALUES}],default:As.fontWeight,description:h(295,'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(e){return e==="normal"||e==="bold"?e:String(Ge.clampedInt(e,As.fontWeight,Sr.MINIMUM_VALUE,Sr.MAXIMUM_VALUE))}};Sr.SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"],Sr.MINIMUM_VALUE=1,Sr.MAXIMUM_VALUE=1e3;let cw=Sr;class Q8 extends ut{constructor(){const e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",multipleTests:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:"",alternativeTestsCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[h(296,"Show Peek view of the results (default)"),h(297,"Go to the primary result and show a Peek view"),h(298,"Go to the primary result and enable Peek-less navigation to others")]},i=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(R.gotoLocation,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:h(299,"This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":{description:h(300,"Controls the behavior the 'Go to Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleTypeDefinitions":{description:h(301,"Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleDeclarations":{description:h(302,"Controls the behavior the 'Go to Declaration'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleImplementations":{description:h(303,"Controls the behavior the 'Go to Implementations'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleReferences":{description:h(304,"Controls the behavior the 'Go to References'-command when multiple target locations exist."),...t},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:i,description:h(305,"Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:i,description:h(306,"Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:i,description:h(307,"Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:i,description:h(308,"Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:i,description:h(309,"Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{multiple:pt(t.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:t.multipleDefinitions??pt(t.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:t.multipleTypeDefinitions??pt(t.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:t.multipleDeclarations??pt(t.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:t.multipleImplementations??pt(t.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:t.multipleReferences??pt(t.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),multipleTests:t.multipleTests??pt(t.multipleTests,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:Ln.string(t.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:Ln.string(t.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:Ln.string(t.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:Ln.string(t.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:Ln.string(t.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand),alternativeTestsCommand:Ln.string(t.alternativeTestsCommand,this.defaultValue.alternativeTestsCommand)}}}class J8 extends ut{constructor(){const e={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(R.hover,"hover",e,{"editor.hover.enabled":{type:"boolean",default:e.enabled,description:h(310,"Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:h(311,"Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:h(312,"Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,description:h(313,"Controls the delay in milliseconds after which the hover is hidden. Requires `editor.hover.sticky` to be enabled.")},"editor.hover.above":{type:"boolean",default:e.above,description:h(314,"Prefer showing hovers above the line, if there's space.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:te(t.enabled,this.defaultValue.enabled),delay:Ge.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:te(t.sticky,this.defaultValue.sticky),hidingDelay:Ge.clampedInt(t.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:te(t.above,this.defaultValue.above)}}}var ec;(function(n){n[n.None=0]="None",n[n.Text=1]="Text",n[n.Blocks=2]="Blocks"})(ec||(ec={}));class Md extends Al{constructor(){super(R.layoutInfo)}compute(e,t,i){return Md.computeLayout(t,{memory:e.memory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,isDominatedByLongLines:e.isDominatedByLongLines,lineHeight:e.fontInfo.lineHeight,viewLineCount:e.viewLineCount,lineNumbersDigitCount:e.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,pixelRatio:e.pixelRatio,glyphMarginDecorationLaneCount:e.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(e){const t=e.height/e.lineHeight,i=Math.floor(e.paddingTop/e.lineHeight);let r=Math.floor(e.paddingBottom/e.lineHeight);e.scrollBeyondLastLine&&(r=Math.max(r,t-1));const s=(i+e.viewLineCount+r)/(e.pixelRatio*e.height),o=Math.floor(e.viewLineCount/s);return{typicalViewportLineCount:t,extraLinesBeforeFirstLine:i,extraLinesBeyondLastLine:r,desiredRatio:s,minimapLineCount:o}}static _computeMinimapLayout(e,t){const i=e.outerWidth,r=e.outerHeight,s=e.pixelRatio;if(!e.minimap.enabled)return{renderMinimap:ec.None,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(s*r),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:r};const o=t.stableMinimapLayoutInput,a=o&&e.outerHeight===o.outerHeight&&e.lineHeight===o.lineHeight&&e.typicalHalfwidthCharacterWidth===o.typicalHalfwidthCharacterWidth&&e.pixelRatio===o.pixelRatio&&e.scrollBeyondLastLine===o.scrollBeyondLastLine&&e.paddingTop===o.paddingTop&&e.paddingBottom===o.paddingBottom&&e.minimap.enabled===o.minimap.enabled&&e.minimap.side===o.minimap.side&&e.minimap.size===o.minimap.size&&e.minimap.showSlider===o.minimap.showSlider&&e.minimap.renderCharacters===o.minimap.renderCharacters&&e.minimap.maxColumn===o.minimap.maxColumn&&e.minimap.scale===o.minimap.scale&&e.verticalScrollbarWidth===o.verticalScrollbarWidth&&e.isViewportWrapping===o.isViewportWrapping,l=e.lineHeight,c=e.typicalHalfwidthCharacterWidth,u=e.scrollBeyondLastLine,d=e.minimap.renderCharacters;let f=s>=2?Math.round(e.minimap.scale*2):e.minimap.scale;const p=e.minimap.maxColumn,w=e.minimap.size,v=e.minimap.side,m=e.verticalScrollbarWidth,x=e.viewLineCount,k=e.remainingWidth,D=e.isViewportWrapping,B=d?2:3;let T=Math.floor(s*r);const z=T/s;let K=!1,Ee=!1,Q=B*f,le=f/s,Ye=1;if(w==="fill"||w==="fit"){const{typicalViewportLineCount:_e,extraLinesBeforeFirstLine:Ve,extraLinesBeyondLastLine:yt,desiredRatio:$e,minimapLineCount:Gt}=Md.computeContainedMinimapLineCount({viewLineCount:x,scrollBeyondLastLine:u,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:r,lineHeight:l,pixelRatio:s});if(x/Gt>1)K=!0,Ee=!0,f=1,Q=1,le=f/s;else{let xt=!1,mi=f+1;if(w==="fit"){const _n=Math.ceil((Ve+x+yt)*Q);D&&a&&k<=t.stableFitRemainingWidth?(xt=!0,mi=t.stableFitMaxMinimapScale):xt=_n>T}if(w==="fill"||xt){K=!0;const _n=f;Q=Math.min(l*s,Math.max(1,Math.floor(1/$e))),D&&a&&k<=t.stableFitRemainingWidth&&(mi=t.stableFitMaxMinimapScale),f=Math.min(mi,Math.max(1,Math.floor(Q/B))),f>_n&&(Ye=Math.min(2,f/_n)),le=f/s/Ye,T=Math.ceil(Math.max(_e,Ve+x+yt)*Q),D?(t.stableMinimapLayoutInput=e,t.stableFitRemainingWidth=k,t.stableFitMaxMinimapScale=f):(t.stableMinimapLayoutInput=null,t.stableFitRemainingWidth=0)}}}const Ce=Math.floor(p*le),Y=Math.min(Ce,Math.max(0,Math.floor((k-m-2)*le/(c+le)))+N8);let j=Math.floor(s*Y);const ae=j/s;j=Math.floor(j*Ye);const ne=d?ec.Text:ec.Blocks,he=v==="left"?0:i-Y-m;return{renderMinimap:ne,minimapLeft:he,minimapWidth:Y,minimapHeightIsEditorHeight:K,minimapIsSampling:Ee,minimapScale:f,minimapLineHeight:Q,minimapCanvasInnerWidth:j,minimapCanvasInnerHeight:T,minimapCanvasOuterWidth:ae,minimapCanvasOuterHeight:z}}static computeLayout(e,t){const i=t.outerWidth|0,r=t.outerHeight|0,s=t.lineHeight|0,o=t.lineNumbersDigitCount|0,a=t.typicalHalfwidthCharacterWidth,l=t.maxDigitWidth,c=t.pixelRatio,u=t.viewLineCount,d=e.get(R.wordWrapOverride2),f=d==="inherit"?e.get(R.wordWrapOverride1):d,p=f==="inherit"?e.get(R.wordWrap):f,w=e.get(R.wordWrapColumn),v=t.isDominatedByLongLines,m=e.get(R.glyphMargin),x=e.get(R.lineNumbers).renderType!==Rn.Off,k=e.get(R.lineNumbersMinChars),D=e.get(R.scrollBeyondLastLine),B=e.get(R.padding),T=e.get(R.minimap),z=e.get(R.scrollbar),K=z.verticalScrollbarSize,Ee=z.verticalHasArrows,Q=z.arrowSize,le=z.horizontalScrollbarSize,Ye=e.get(R.folding),Ce=e.get(R.showFoldingControls)!=="never";let Y=e.get(R.lineDecorationsWidth);Ye&&Ce&&(Y+=16);let j=0;if(x){const Ri=Math.max(o,k);j=Math.round(Ri*l)}let ae=0;m&&(ae=s*t.glyphMarginDecorationLaneCount);let ne=0,he=ne+ae,_e=he+j,Ve=_e+Y;const yt=i-ae-j-Y;let $e=!1,Gt=!1,Un=-1;f==="inherit"&&v?($e=!0,Gt=!0):p==="on"||p==="bounded"?Gt=!0:p==="wordWrapColumn"&&(Un=w);const xt=Md._computeMinimapLayout({outerWidth:i,outerHeight:r,lineHeight:s,typicalHalfwidthCharacterWidth:a,pixelRatio:c,scrollBeyondLastLine:D,paddingTop:B.top,paddingBottom:B.bottom,minimap:T,verticalScrollbarWidth:K,viewLineCount:u,remainingWidth:yt,isViewportWrapping:Gt},t.memory||new O8);xt.renderMinimap!==ec.None&&xt.minimapLeft===0&&(ne+=xt.minimapWidth,he+=xt.minimapWidth,_e+=xt.minimapWidth,Ve+=xt.minimapWidth);const mi=yt-xt.minimapWidth,_n=Math.max(1,Math.floor((mi-K-2)/a)),Wt=Ee?Q:0;return Gt&&(Un=Math.max(1,_n),p==="bounded"&&(Un=Math.min(Un,w))),{width:i,height:r,glyphMarginLeft:ne,glyphMarginWidth:ae,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount,lineNumbersLeft:he,lineNumbersWidth:j,decorationsLeft:_e,decorationsWidth:Y,contentLeft:Ve,contentWidth:mi,minimap:xt,viewportColumn:_n,isWordWrapMinified:$e,isViewportWrapping:Gt,wrappingColumn:Un,verticalScrollbarWidth:K,horizontalScrollbarHeight:le,overviewRuler:{top:Wt,width:K,height:r-2*Wt,right:0}}}}class X8 extends ut{constructor(){super(R.wrappingStrategy,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[h(315,"Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),h(316,"Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:h(317,"Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(e){return pt(e,"simple",["simple","advanced"])}compute(e,t,i){return t.get(R.accessibilitySupport)===ys.Enabled?"advanced":i}}var rs;(function(n){n.Off="off",n.OnCode="onCode",n.On="on"})(rs||(rs={}));class Y8 extends ut{constructor(){const e={enabled:rs.OnCode};super(R.lightbulb,"lightbulb",e,{"editor.lightbulb.enabled":{type:"string",enum:[rs.Off,rs.OnCode,rs.On],default:e.enabled,enumDescriptions:[h(318,"Disable the code action menu."),h(319,"Show the code action menu when the cursor is on lines with code."),h(320,"Show the code action menu when the cursor is on lines with code or on empty lines.")],description:h(321,"Enables the Code Action lightbulb in the editor.")}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:pt(e.enabled,this.defaultValue.enabled,[rs.Off,rs.OnCode,rs.On])}}}class Z8 extends ut{constructor(){const e={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(R.stickyScroll,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:h(322,"Shows the nested current scopes during the scroll at the top of the editor.")},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:20,description:h(323,"Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:h(324,"Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:h(325,"Enable scrolling of Sticky Scroll with the editor's horizontal scrollbar.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:te(t.enabled,this.defaultValue.enabled),maxLineCount:Ge.clampedInt(t.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:pt(t.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:te(t.scrollWithEditor,this.defaultValue.scrollWithEditor)}}}class K8 extends ut{constructor(){const e={enabled:"on",fontSize:0,fontFamily:"",padding:!1,maximumLength:43};super(R.inlayHints,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:h(326,"Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[h(327,"Inlay hints are enabled"),h(328,"Inlay hints are showing by default and hide when holding {0}",Pi?"Ctrl+Option":"Ctrl+Alt"),h(329,"Inlay hints are hidden by default and show when holding {0}",Pi?"Ctrl+Option":"Ctrl+Alt"),h(330,"Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:h(331,"Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:h(332,"Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:h(333,"Enables the padding around the inlay hints in the editor.")},"editor.inlayHints.maximumLength":{type:"number",default:e.maximumLength,markdownDescription:h(334,"Maximum overall length of inlay hints, for a single line, before they get truncated by the editor. Set to `0` to never truncate")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return typeof t.enabled=="boolean"&&(t.enabled=t.enabled?"on":"off"),{enabled:pt(t.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:Ge.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:Ln.string(t.fontFamily,this.defaultValue.fontFamily),padding:te(t.padding,this.defaultValue.padding),maximumLength:Ge.clampedInt(t.maximumLength,this.defaultValue.maximumLength,0,Number.MAX_SAFE_INTEGER)}}}class eA extends ut{constructor(){super(R.lineDecorationsWidth,"lineDecorationsWidth",10)}validate(e){return typeof e=="string"&&/^\d+(\.\d+)?ch$/.test(e)?-parseFloat(e.substring(0,e.length-2)):Ge.clampedInt(e,this.defaultValue,0,1e3)}compute(e,t,i){return i<0?Ge.clampedInt(-i*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):i}}class tA extends Hi{constructor(){super(R.lineHeight,"lineHeight",As.lineHeight,e=>Hi.clamp(e,0,150),{markdownDescription:h(335,`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)})}compute(e,t,i){return e.fontInfo.lineHeight}}class nA extends ut{constructor(){const e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:!1,renderCharacters:!0,maxColumn:120,scale:1,showRegionSectionHeaders:!0,showMarkSectionHeaders:!0,markSectionHeaderRegex:"\\bMARK:\\s*(?<separator>-?)\\s*(?<label>.*)$",sectionHeaderFontSize:9,sectionHeaderLetterSpacing:1};super(R.minimap,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:h(336,"Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"boolean",default:e.autohide,description:h(337,"Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[h(338,"The minimap has the same size as the editor contents (and might scroll)."),h(339,"The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),h(340,"The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:e.size,description:h(341,"Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:h(342,"Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:h(343,"Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:h(344,"Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:h(345,"Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:h(346,"Limit the width of the minimap to render at most a certain number of columns.")},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:e.showRegionSectionHeaders,description:h(347,"Controls whether named regions are shown as section headers in the minimap.")},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:e.showMarkSectionHeaders,description:h(348,"Controls whether MARK: comments are shown as section headers in the minimap.")},"editor.minimap.markSectionHeaderRegex":{type:"string",default:e.markSectionHeaderRegex,description:h(349,"Defines the regular expression used to find section headers in comments. The regex must contain a named match group `label` (written as `(?<label>.+)`) that encapsulates the section header, otherwise it will not work. Optionally you can include another match group named `separator`. Use \\n in the pattern to match multi-line headers.")},"editor.minimap.sectionHeaderFontSize":{type:"number",default:e.sectionHeaderFontSize,description:h(350,"Controls the font size of section headers in the minimap.")},"editor.minimap.sectionHeaderLetterSpacing":{type:"number",default:e.sectionHeaderLetterSpacing,description:h(351,"Controls the amount of space (in pixels) between characters of section header. This helps the readability of the header in small font sizes.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;let i=this.defaultValue.markSectionHeaderRegex;const r=e.markSectionHeaderRegex;if(typeof r=="string")try{new RegExp(r,"d"),i=r}catch{}return{enabled:te(t.enabled,this.defaultValue.enabled),autohide:te(t.autohide,this.defaultValue.autohide),size:pt(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:pt(t.side,this.defaultValue.side,["right","left"]),showSlider:pt(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:te(t.renderCharacters,this.defaultValue.renderCharacters),scale:Ge.clampedInt(t.scale,1,1,3),maxColumn:Ge.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:te(t.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:te(t.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),markSectionHeaderRegex:i,sectionHeaderFontSize:Hi.clamp(t.sectionHeaderFontSize??this.defaultValue.sectionHeaderFontSize,4,32),sectionHeaderLetterSpacing:Hi.clamp(t.sectionHeaderLetterSpacing??this.defaultValue.sectionHeaderLetterSpacing,0,5)}}}function iA(n){return n==="ctrlCmd"?Pi?"metaKey":"ctrlKey":"altKey"}class rA extends ut{constructor(){super(R.padding,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:h(352,"Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:h(353,"Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{top:Ge.clampedInt(t.top,0,0,1e3),bottom:Ge.clampedInt(t.bottom,0,0,1e3)}}}class sA extends ut{constructor(){const e={enabled:!0,cycle:!0};super(R.parameterHints,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:h(354,"Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:h(355,"Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:te(t.enabled,this.defaultValue.enabled),cycle:te(t.cycle,this.defaultValue.cycle)}}}class oA extends Al{constructor(){super(R.pixelRatio)}compute(e,t,i){return e.pixelRatio}}class aA extends ut{constructor(){super(R.placeholder,"placeholder",void 0)}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e:this.defaultValue}}class lA extends ut{constructor(){const e={other:"on",comments:"off",strings:"off"},t=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[h(356,"Quick suggestions show inside the suggest widget"),h(357,"Quick suggestions show as ghost text"),h(358,"Quick suggestions are disabled")]}];super(R.quickSuggestions,"quickSuggestions",e,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:t,default:e.strings,description:h(359,"Enable quick suggestions inside strings.")},comments:{anyOf:t,default:e.comments,description:h(360,"Enable quick suggestions inside comments.")},other:{anyOf:t,default:e.other,description:h(361,"Enable quick suggestions outside of strings and comments.")}},default:e,markdownDescription:h(362,"Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the {0}-setting which controls if suggestions are triggered by special characters.","`#editor.suggestOnTriggerCharacters#`")}),this.defaultValue=e}validate(e){if(typeof e=="boolean"){const c=e?"on":"off";return{comments:c,strings:c,other:c}}if(!e||typeof e!="object")return this.defaultValue;const{other:t,comments:i,strings:r}=e,s=["on","inline","off"];let o,a,l;return typeof t=="boolean"?o=t?"on":"off":o=pt(t,this.defaultValue.other,s),typeof i=="boolean"?a=i?"on":"off":a=pt(i,this.defaultValue.comments,s),typeof r=="boolean"?l=r?"on":"off":l=pt(r,this.defaultValue.strings,s),{other:o,comments:a,strings:l}}}var Rn;(function(n){n[n.Off=0]="Off",n[n.On=1]="On",n[n.Relative=2]="Relative",n[n.Interval=3]="Interval",n[n.Custom=4]="Custom"})(Rn||(Rn={}));class cA extends ut{constructor(){super(R.lineNumbers,"lineNumbers",{renderType:Rn.On,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[h(363,"Line numbers are not rendered."),h(364,"Line numbers are rendered as absolute number."),h(365,"Line numbers are rendered as distance in lines to cursor position."),h(366,"Line numbers are rendered every 10 lines.")],default:"on",description:h(367,"Controls the display of line numbers.")})}validate(e){let t=this.defaultValue.renderType,i=this.defaultValue.renderFn;return typeof e<"u"&&(typeof e=="function"?(t=Rn.Custom,i=e):e==="interval"?t=Rn.Interval:e==="relative"?t=Rn.Relative:e==="on"?t=Rn.On:t=Rn.Off),{renderType:t,renderFn:i}}}class uA extends ut{constructor(){const e=[],t={type:"number",description:h(368,"Number of monospace characters at which this editor ruler will render.")};super(R.rulers,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:h(369,"Color of this editor ruler."),format:"color-hex"}}}]},default:e,description:h(370,"Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(e){if(Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="number")t.push({column:Ge.clampedInt(i,0,0,1e4),color:null});else if(i&&typeof i=="object"){const r=i;t.push({column:Ge.clampedInt(r.column,0,0,1e4),color:r.color})}return t.sort((i,r)=>i.column-r.column),t}return this.defaultValue}}class dA extends ut{constructor(){super(R.readOnlyMessage,"readOnlyMessage",void 0)}validate(e){return!e||typeof e!="object"?this.defaultValue:e}}function AE(n,e){if(typeof n!="string")return e;switch(n){case"hidden":return Va.Hidden;case"visible":return Va.Visible;default:return Va.Auto}}class hA extends ut{constructor(){const e={vertical:Va.Auto,horizontal:Va.Auto,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(R.scrollbar,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[h(371,"The vertical scrollbar will be visible only when necessary."),h(372,"The vertical scrollbar will always be visible."),h(373,"The vertical scrollbar will always be hidden.")],default:"auto",description:h(374,"Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[h(375,"The horizontal scrollbar will be visible only when necessary."),h(376,"The horizontal scrollbar will always be visible."),h(377,"The horizontal scrollbar will always be hidden.")],default:"auto",description:h(378,"Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:h(379,"The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:h(380,"The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:h(381,"Controls whether clicks scroll by page or jump to click position.")},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:e.ignoreHorizontalScrollbarInContentHeight,description:h(382,"When set, the horizontal scrollbar will not increase the size of the editor's content.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e,i=Ge.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),r=Ge.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:Ge.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:AE(t.vertical,this.defaultValue.vertical),horizontal:AE(t.horizontal,this.defaultValue.horizontal),useShadows:te(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:te(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:te(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:te(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:te(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:i,horizontalSliderSize:Ge.clampedInt(t.horizontalSliderSize,i,0,1e3),verticalScrollbarSize:r,verticalSliderSize:Ge.clampedInt(t.verticalSliderSize,r,0,1e3),scrollByPage:te(t.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:te(t.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}}const Vi="inUntrustedWorkspace",Uo={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"};class fA extends ut{constructor(){const e={nonBasicASCII:Vi,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:Vi,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(R.unicodeHighlighting,"unicodeHighlight",e,{[Uo.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Vi],default:e.nonBasicASCII,description:h(383,"Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[Uo.invisibleCharacters]:{restricted:!0,type:"boolean",default:e.invisibleCharacters,description:h(384,"Controls whether characters that just reserve space or have no width at all are highlighted.")},[Uo.ambiguousCharacters]:{restricted:!0,type:"boolean",default:e.ambiguousCharacters,description:h(385,"Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[Uo.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Vi],default:e.includeComments,description:h(386,"Controls whether characters in comments should also be subject to Unicode highlighting.")},[Uo.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Vi],default:e.includeStrings,description:h(387,"Controls whether characters in strings should also be subject to Unicode highlighting.")},[Uo.allowedCharacters]:{restricted:!0,type:"object",default:e.allowedCharacters,description:h(388,"Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[Uo.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:h(389,"Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(e,t){let i=!1;t.allowedCharacters&&e&&(fi(e.allowedCharacters,t.allowedCharacters)||(e={...e,allowedCharacters:t.allowedCharacters},i=!0)),t.allowedLocales&&e&&(fi(e.allowedLocales,t.allowedLocales)||(e={...e,allowedLocales:t.allowedLocales},i=!0));const r=super.applyUpdate(e,t);return i?new Pp(r.newValue,!0):r}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{nonBasicASCII:kc(t.nonBasicASCII,Vi,[!0,!1,Vi]),invisibleCharacters:te(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:te(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:kc(t.includeComments,Vi,[!0,!1,Vi]),includeStrings:kc(t.includeStrings,Vi,[!0,!1,Vi]),allowedCharacters:this.validateBooleanMap(e.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(e.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(e,t){if(typeof e!="object"||!e)return t;const i={};for(const[r,s]of Object.entries(e))s===!0&&(i[r]=!0);return i}}class pA extends ut{constructor(){const e={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default",syntaxHighlightingEnabled:!0,edits:{enabled:!0,showCollapsed:!1,renderSideBySide:"auto",allowCodeShifting:"always",useMultiLineGhostText:!0}};super(R.inlineSuggest,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:h(390,"Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[h(391,"Show the inline suggestion toolbar whenever an inline suggestion is shown."),h(392,"Show the inline suggestion toolbar when hovering over an inline suggestion."),h(393,"Never show the inline suggestion toolbar.")],description:h(394,"Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.syntaxHighlightingEnabled":{type:"boolean",default:e.syntaxHighlightingEnabled,description:h(395,"Controls whether to show syntax highlighting for inline suggestions in the editor.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:h(396,"Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")},"editor.inlineSuggest.fontFamily":{type:"string",default:e.fontFamily,description:h(397,"Controls the font family of the inline suggestions.")},"editor.inlineSuggest.edits.allowCodeShifting":{type:"string",default:e.edits.allowCodeShifting,description:h(398,"Controls whether showing a suggestion will shift the code to make space for the suggestion inline."),enum:["always","horizontal","never"],tags:["nextEditSuggestions"]},"editor.inlineSuggest.edits.renderSideBySide":{type:"string",default:e.edits.renderSideBySide,description:h(399,"Controls whether larger suggestions can be shown side by side."),enum:["auto","never"],enumDescriptions:[h(400,"Larger suggestions will show side by side if there is enough space, otherwise they will be shown below."),h(401,"Larger suggestions are never shown side by side and will always be shown below.")],tags:["nextEditSuggestions"]},"editor.inlineSuggest.edits.showCollapsed":{type:"boolean",default:e.edits.showCollapsed,description:h(402,"Controls whether the suggestion will show as collapsed until jumping to it."),tags:["nextEditSuggestions"]}})}validate(e){var i,r,s,o,a;if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:te(t.enabled,this.defaultValue.enabled),mode:pt(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:pt(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:te(t.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:te(t.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:Ln.string(t.fontFamily,this.defaultValue.fontFamily),syntaxHighlightingEnabled:te(t.syntaxHighlightingEnabled,this.defaultValue.syntaxHighlightingEnabled),edits:{enabled:te((i=t.edits)==null?void 0:i.enabled,this.defaultValue.edits.enabled),showCollapsed:te((r=t.edits)==null?void 0:r.showCollapsed,this.defaultValue.edits.showCollapsed),allowCodeShifting:pt((s=t.edits)==null?void 0:s.allowCodeShifting,this.defaultValue.edits.allowCodeShifting,["always","horizontal","never"]),renderSideBySide:pt((o=t.edits)==null?void 0:o.renderSideBySide,this.defaultValue.edits.renderSideBySide,["never","auto"]),useMultiLineGhostText:te((a=t.edits)==null?void 0:a.useMultiLineGhostText,this.defaultValue.edits.useMultiLineGhostText)}}}}class gA extends ut{constructor(){const e={enabled:IE.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:IE.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(R.bracketPairColorization,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:h(403,"Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:h(404,"Controls whether each bracket type has its own independent color pool.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:te(t.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:te(t.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}}class mA extends ut{constructor(){const e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(R.guides,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[h(405,"Enables bracket pair guides."),h(406,"Enables bracket pair guides only for the active bracket pair."),h(407,"Disables bracket pair guides.")],default:e.bracketPairs,description:h(408,"Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[h(409,"Enables horizontal guides as addition to vertical bracket pair guides."),h(410,"Enables horizontal guides only for the active bracket pair."),h(411,"Disables horizontal bracket pair guides.")],default:e.bracketPairsHorizontal,description:h(412,"Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:h(413,"Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:h(414,"Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[h(415,"Highlights the active indent guide."),h(416,"Highlights the active indent guide even if bracket guides are highlighted."),h(417,"Do not highlight the active indent guide.")],default:e.highlightActiveIndentation,description:h(418,"Controls whether the editor should highlight the active indent guide.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{bracketPairs:kc(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:kc(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:te(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:te(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:kc(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}}function kc(n,e,t){const i=t.indexOf(n);return i===-1?e:t[i]}class _A extends ut{constructor(){const e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(R.suggest,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[h(419,"Insert suggestion without overwriting text right of the cursor."),h(420,"Insert suggestion and overwrite text right of the cursor.")],default:e.insertMode,description:h(421,"Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:h(422,"Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:h(423,"Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:h(424,"Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[h(425,"Always select a suggestion when automatically triggering IntelliSense."),h(426,"Never select a suggestion when automatically triggering IntelliSense."),h(427,"Select a suggestion only when triggering IntelliSense from a trigger character."),h(428,"Select a suggestion only when triggering IntelliSense as you type.")],default:e.selectionMode,markdownDescription:h(429,"Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions ({0} and {1}) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.","`#editor.quickSuggestions#`","`#editor.suggestOnTriggerCharacters#`")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:h(430,"Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:h(431,"Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:h(432,"Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:e.preview,description:h(433,"Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:h(434,"Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:h(435,"This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:h(436,"This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:h(437,"When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:h(438,"When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:h(439,"When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:h(440,"When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:h(441,"When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:h(442,"When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:h(443,"When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:h(444,"When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:h(445,"When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:h(446,"When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:h(447,"When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:h(448,"When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:h(449,"When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:h(450,"When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:h(451,"When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:h(452,"When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:h(453,"When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:h(454,"When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:h(455,"When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:h(456,"When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:h(457,"When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:h(458,"When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:h(459,"When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:h(460,"When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:h(461,"When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:h(462,"When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:h(463,"When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:h(464,"When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:h(465,"When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:h(466,"When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertMode:pt(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:te(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:te(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:te(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:te(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:pt(t.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:te(t.showIcons,this.defaultValue.showIcons),showStatusBar:te(t.showStatusBar,this.defaultValue.showStatusBar),preview:te(t.preview,this.defaultValue.preview),previewMode:pt(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:te(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:te(t.showMethods,this.defaultValue.showMethods),showFunctions:te(t.showFunctions,this.defaultValue.showFunctions),showConstructors:te(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:te(t.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:te(t.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:te(t.showFields,this.defaultValue.showFields),showVariables:te(t.showVariables,this.defaultValue.showVariables),showClasses:te(t.showClasses,this.defaultValue.showClasses),showStructs:te(t.showStructs,this.defaultValue.showStructs),showInterfaces:te(t.showInterfaces,this.defaultValue.showInterfaces),showModules:te(t.showModules,this.defaultValue.showModules),showProperties:te(t.showProperties,this.defaultValue.showProperties),showEvents:te(t.showEvents,this.defaultValue.showEvents),showOperators:te(t.showOperators,this.defaultValue.showOperators),showUnits:te(t.showUnits,this.defaultValue.showUnits),showValues:te(t.showValues,this.defaultValue.showValues),showConstants:te(t.showConstants,this.defaultValue.showConstants),showEnums:te(t.showEnums,this.defaultValue.showEnums),showEnumMembers:te(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:te(t.showKeywords,this.defaultValue.showKeywords),showWords:te(t.showWords,this.defaultValue.showWords),showColors:te(t.showColors,this.defaultValue.showColors),showFiles:te(t.showFiles,this.defaultValue.showFiles),showReferences:te(t.showReferences,this.defaultValue.showReferences),showFolders:te(t.showFolders,this.defaultValue.showFolders),showTypeParameters:te(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:te(t.showSnippets,this.defaultValue.showSnippets),showUsers:te(t.showUsers,this.defaultValue.showUsers),showIssues:te(t.showIssues,this.defaultValue.showIssues)}}}class vA extends ut{constructor(){super(R.smartSelect,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:h(467,"Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:h(468,"Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:!0,type:"boolean"}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:te(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:te(e.selectSubwords,this.defaultValue.selectSubwords)}}}class wA extends ut{constructor(){const e=[];super(R.wordSegmenterLocales,"wordSegmenterLocales",e,{anyOf:[{description:h(469,"Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"string"},{description:h(469,"Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"array",items:{type:"string"}}]})}validate(e){if(typeof e=="string"&&(e=[e]),Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="string")try{Intl.Segmenter.supportedLocalesOf(i).length>0&&t.push(i)}catch{}return t}return this.defaultValue}}var ss;(function(n){n[n.None=0]="None",n[n.Same=1]="Same",n[n.Indent=2]="Indent",n[n.DeepIndent=3]="DeepIndent"})(ss||(ss={}));class bA extends ut{constructor(){super(R.wrappingIndent,"wrappingIndent",ss.Same,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[h(470,"No indentation. Wrapped lines begin at column 1."),h(471,"Wrapped lines get the same indentation as the parent."),h(472,"Wrapped lines get +1 indentation toward the parent."),h(473,"Wrapped lines get +2 indentation toward the parent.")],description:h(474,"Controls the indentation of wrapped lines."),default:"same"}})}validate(e){switch(e){case"none":return ss.None;case"same":return ss.Same;case"indent":return ss.Indent;case"deepIndent":return ss.DeepIndent}return ss.Same}compute(e,t,i){return t.get(R.accessibilitySupport)===ys.Enabled?ss.None:i}}class yA extends Al{constructor(){super(R.wrappingInfo)}compute(e,t,i){const r=t.get(R.layoutInfo);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:r.isWordWrapMinified,isViewportWrapping:r.isViewportWrapping,wrappingColumn:r.wrappingColumn}}}class xA extends ut{constructor(){const e={enabled:!0,showDropSelector:"afterDrop"};super(R.dropIntoEditor,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:h(475,"Controls whether you can drag and drop a file into a text editor by holding down the `Shift` key (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:h(476,"Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[h(477,"Show the drop selector widget after a file is dropped into the editor."),h(478,"Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:te(t.enabled,this.defaultValue.enabled),showDropSelector:pt(t.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}}class EA extends ut{constructor(){const e={enabled:!0,showPasteSelector:"afterPaste"};super(R.pasteAs,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:h(479,"Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:h(480,"Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[h(481,"Show the paste selector widget after content is pasted into the editor."),h(482,"Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:te(t.enabled,this.defaultValue.enabled),showPasteSelector:pt(t.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}}const SA="Consolas, 'Courier New', monospace",DA="Menlo, Monaco, 'Courier New', monospace",kA="'Droid Sans Mono', 'monospace', monospace",As={fontFamily:Pi?DA:Fs?kA:SA,fontWeight:"normal",fontSize:Pi?12:14,lineHeight:0,letterSpacing:0},IA=[];function M(n){return IA[n.id]=n,n}var R;(function(n){n[n.acceptSuggestionOnCommitCharacter=0]="acceptSuggestionOnCommitCharacter",n[n.acceptSuggestionOnEnter=1]="acceptSuggestionOnEnter",n[n.accessibilitySupport=2]="accessibilitySupport",n[n.accessibilityPageSize=3]="accessibilityPageSize",n[n.ariaLabel=4]="ariaLabel",n[n.ariaRequired=5]="ariaRequired",n[n.autoClosingBrackets=6]="autoClosingBrackets",n[n.autoClosingComments=7]="autoClosingComments",n[n.screenReaderAnnounceInlineSuggestion=8]="screenReaderAnnounceInlineSuggestion",n[n.autoClosingDelete=9]="autoClosingDelete",n[n.autoClosingOvertype=10]="autoClosingOvertype",n[n.autoClosingQuotes=11]="autoClosingQuotes",n[n.autoIndent=12]="autoIndent",n[n.automaticLayout=13]="automaticLayout",n[n.autoSurround=14]="autoSurround",n[n.bracketPairColorization=15]="bracketPairColorization",n[n.guides=16]="guides",n[n.codeLens=17]="codeLens",n[n.codeLensFontFamily=18]="codeLensFontFamily",n[n.codeLensFontSize=19]="codeLensFontSize",n[n.colorDecorators=20]="colorDecorators",n[n.colorDecoratorsLimit=21]="colorDecoratorsLimit",n[n.columnSelection=22]="columnSelection",n[n.comments=23]="comments",n[n.contextmenu=24]="contextmenu",n[n.copyWithSyntaxHighlighting=25]="copyWithSyntaxHighlighting",n[n.cursorBlinking=26]="cursorBlinking",n[n.cursorSmoothCaretAnimation=27]="cursorSmoothCaretAnimation",n[n.cursorStyle=28]="cursorStyle",n[n.cursorSurroundingLines=29]="cursorSurroundingLines",n[n.cursorSurroundingLinesStyle=30]="cursorSurroundingLinesStyle",n[n.cursorWidth=31]="cursorWidth",n[n.disableLayerHinting=32]="disableLayerHinting",n[n.disableMonospaceOptimizations=33]="disableMonospaceOptimizations",n[n.domReadOnly=34]="domReadOnly",n[n.dragAndDrop=35]="dragAndDrop",n[n.dropIntoEditor=36]="dropIntoEditor",n[n.experimentalEditContextEnabled=37]="experimentalEditContextEnabled",n[n.emptySelectionClipboard=38]="emptySelectionClipboard",n[n.experimentalGpuAcceleration=39]="experimentalGpuAcceleration",n[n.experimentalWhitespaceRendering=40]="experimentalWhitespaceRendering",n[n.extraEditorClassName=41]="extraEditorClassName",n[n.fastScrollSensitivity=42]="fastScrollSensitivity",n[n.find=43]="find",n[n.fixedOverflowWidgets=44]="fixedOverflowWidgets",n[n.folding=45]="folding",n[n.foldingStrategy=46]="foldingStrategy",n[n.foldingHighlight=47]="foldingHighlight",n[n.foldingImportsByDefault=48]="foldingImportsByDefault",n[n.foldingMaximumRegions=49]="foldingMaximumRegions",n[n.unfoldOnClickAfterEndOfLine=50]="unfoldOnClickAfterEndOfLine",n[n.fontFamily=51]="fontFamily",n[n.fontInfo=52]="fontInfo",n[n.fontLigatures=53]="fontLigatures",n[n.fontSize=54]="fontSize",n[n.fontWeight=55]="fontWeight",n[n.fontVariations=56]="fontVariations",n[n.formatOnPaste=57]="formatOnPaste",n[n.formatOnType=58]="formatOnType",n[n.glyphMargin=59]="glyphMargin",n[n.gotoLocation=60]="gotoLocation",n[n.hideCursorInOverviewRuler=61]="hideCursorInOverviewRuler",n[n.hover=62]="hover",n[n.inDiffEditor=63]="inDiffEditor",n[n.inlineSuggest=64]="inlineSuggest",n[n.letterSpacing=65]="letterSpacing",n[n.lightbulb=66]="lightbulb",n[n.lineDecorationsWidth=67]="lineDecorationsWidth",n[n.lineHeight=68]="lineHeight",n[n.lineNumbers=69]="lineNumbers",n[n.lineNumbersMinChars=70]="lineNumbersMinChars",n[n.linkedEditing=71]="linkedEditing",n[n.links=72]="links",n[n.matchBrackets=73]="matchBrackets",n[n.minimap=74]="minimap",n[n.mouseStyle=75]="mouseStyle",n[n.mouseWheelScrollSensitivity=76]="mouseWheelScrollSensitivity",n[n.mouseWheelZoom=77]="mouseWheelZoom",n[n.multiCursorMergeOverlapping=78]="multiCursorMergeOverlapping",n[n.multiCursorModifier=79]="multiCursorModifier",n[n.multiCursorPaste=80]="multiCursorPaste",n[n.multiCursorLimit=81]="multiCursorLimit",n[n.occurrencesHighlight=82]="occurrencesHighlight",n[n.occurrencesHighlightDelay=83]="occurrencesHighlightDelay",n[n.overtypeCursorStyle=84]="overtypeCursorStyle",n[n.overtypeOnPaste=85]="overtypeOnPaste",n[n.overviewRulerBorder=86]="overviewRulerBorder",n[n.overviewRulerLanes=87]="overviewRulerLanes",n[n.padding=88]="padding",n[n.pasteAs=89]="pasteAs",n[n.parameterHints=90]="parameterHints",n[n.peekWidgetDefaultFocus=91]="peekWidgetDefaultFocus",n[n.placeholder=92]="placeholder",n[n.definitionLinkOpensInPeek=93]="definitionLinkOpensInPeek",n[n.quickSuggestions=94]="quickSuggestions",n[n.quickSuggestionsDelay=95]="quickSuggestionsDelay",n[n.readOnly=96]="readOnly",n[n.readOnlyMessage=97]="readOnlyMessage",n[n.renameOnType=98]="renameOnType",n[n.renderControlCharacters=99]="renderControlCharacters",n[n.renderFinalNewline=100]="renderFinalNewline",n[n.renderLineHighlight=101]="renderLineHighlight",n[n.renderLineHighlightOnlyWhenFocus=102]="renderLineHighlightOnlyWhenFocus",n[n.renderValidationDecorations=103]="renderValidationDecorations",n[n.renderWhitespace=104]="renderWhitespace",n[n.revealHorizontalRightPadding=105]="revealHorizontalRightPadding",n[n.roundedSelection=106]="roundedSelection",n[n.rulers=107]="rulers",n[n.scrollbar=108]="scrollbar",n[n.scrollBeyondLastColumn=109]="scrollBeyondLastColumn",n[n.scrollBeyondLastLine=110]="scrollBeyondLastLine",n[n.scrollPredominantAxis=111]="scrollPredominantAxis",n[n.selectionClipboard=112]="selectionClipboard",n[n.selectionHighlight=113]="selectionHighlight",n[n.selectOnLineNumbers=114]="selectOnLineNumbers",n[n.showFoldingControls=115]="showFoldingControls",n[n.showUnused=116]="showUnused",n[n.snippetSuggestions=117]="snippetSuggestions",n[n.smartSelect=118]="smartSelect",n[n.smoothScrolling=119]="smoothScrolling",n[n.stickyScroll=120]="stickyScroll",n[n.stickyTabStops=121]="stickyTabStops",n[n.stopRenderingLineAfter=122]="stopRenderingLineAfter",n[n.suggest=123]="suggest",n[n.suggestFontSize=124]="suggestFontSize",n[n.suggestLineHeight=125]="suggestLineHeight",n[n.suggestOnTriggerCharacters=126]="suggestOnTriggerCharacters",n[n.suggestSelection=127]="suggestSelection",n[n.tabCompletion=128]="tabCompletion",n[n.tabIndex=129]="tabIndex",n[n.unicodeHighlighting=130]="unicodeHighlighting",n[n.unusualLineTerminators=131]="unusualLineTerminators",n[n.useShadowDOM=132]="useShadowDOM",n[n.useTabStops=133]="useTabStops",n[n.wordBreak=134]="wordBreak",n[n.wordSegmenterLocales=135]="wordSegmenterLocales",n[n.wordSeparators=136]="wordSeparators",n[n.wordWrap=137]="wordWrap",n[n.wordWrapBreakAfterCharacters=138]="wordWrapBreakAfterCharacters",n[n.wordWrapBreakBeforeCharacters=139]="wordWrapBreakBeforeCharacters",n[n.wordWrapColumn=140]="wordWrapColumn",n[n.wordWrapOverride1=141]="wordWrapOverride1",n[n.wordWrapOverride2=142]="wordWrapOverride2",n[n.wrappingIndent=143]="wrappingIndent",n[n.wrappingStrategy=144]="wrappingStrategy",n[n.showDeprecated=145]="showDeprecated",n[n.inlayHints=146]="inlayHints",n[n.effectiveCursorStyle=147]="effectiveCursorStyle",n[n.editorClassName=148]="editorClassName",n[n.pixelRatio=149]="pixelRatio",n[n.tabFocusMode=150]="tabFocusMode",n[n.layoutInfo=151]="layoutInfo",n[n.wrappingInfo=152]="wrappingInfo",n[n.defaultColorDecorators=153]="defaultColorDecorators",n[n.colorDecoratorsActivatedOn=154]="colorDecoratorsActivatedOn",n[n.inlineCompletionsAccessibilityVerbose=155]="inlineCompletionsAccessibilityVerbose",n[n.effectiveExperimentalEditContextEnabled=156]="effectiveExperimentalEditContextEnabled"})(R||(R={}));M(new Ae(R.acceptSuggestionOnCommitCharacter,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:h(483,"Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),M(new dt(R.acceptSuggestionOnEnter,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",h(484,"Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:h(485,"Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),M(new $8),M(new Ge(R.accessibilityPageSize,"accessibilityPageSize",500,1,Wn.MAX_SAFE_SMALL_INTEGER,{description:h(486,"Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),M(new Ln(R.ariaLabel,"ariaLabel",h(487,"Editor content"))),M(new Ae(R.ariaRequired,"ariaRequired",!1,void 0)),M(new Ae(R.screenReaderAnnounceInlineSuggestion,"screenReaderAnnounceInlineSuggestion",!0,{description:h(488,"Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),M(new dt(R.autoClosingBrackets,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h(489,"Use language configurations to determine when to autoclose brackets."),h(490,"Autoclose brackets only when the cursor is to the left of whitespace."),""],description:h(491,"Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),M(new dt(R.autoClosingComments,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h(492,"Use language configurations to determine when to autoclose comments."),h(493,"Autoclose comments only when the cursor is to the left of whitespace."),""],description:h(494,"Controls whether the editor should automatically close comments after the user adds an opening comment.")})),M(new dt(R.autoClosingDelete,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",h(495,"Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:h(496,"Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),M(new dt(R.autoClosingOvertype,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",h(497,"Type over closing quotes or brackets only if they were automatically inserted."),""],description:h(498,"Controls whether the editor should type over closing quotes or brackets.")})),M(new dt(R.autoClosingQuotes,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h(499,"Use language configurations to determine when to autoclose quotes."),h(500,"Autoclose quotes only when the cursor is to the left of whitespace."),""],description:h(501,"Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),M(new hd(R.autoIndent,"autoIndent",no.Full,"full",["none","keep","brackets","advanced","full"],M8,{enumDescriptions:[h(502,"The editor will not insert indentation automatically."),h(503,"The editor will keep the current line's indentation."),h(504,"The editor will keep the current line's indentation and honor language defined brackets."),h(505,"The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),h(506,"The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:h(507,"Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),M(new Ae(R.automaticLayout,"automaticLayout",!1)),M(new dt(R.autoSurround,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[h(508,"Use language configurations to determine when to automatically surround selections."),h(509,"Surround with quotes but not brackets."),h(510,"Surround with brackets but not quotes."),""],description:h(511,"Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),M(new gA),M(new mA),M(new Ae(R.stickyTabStops,"stickyTabStops",!1,{description:h(512,"Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),M(new Ae(R.codeLens,"codeLens",!0,{description:h(513,"Controls whether the editor shows CodeLens.")})),M(new Ln(R.codeLensFontFamily,"codeLensFontFamily","",{description:h(514,"Controls the font family for CodeLens.")})),M(new Ge(R.codeLensFontSize,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:h(515,"Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),M(new Ae(R.colorDecorators,"colorDecorators",!0,{description:h(516,"Controls whether the editor should render the inline color decorators and color picker.")})),M(new dt(R.colorDecoratorsActivatedOn,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[h(517,"Make the color picker appear both on click and hover of the color decorator"),h(518,"Make the color picker appear on hover of the color decorator"),h(519,"Make the color picker appear on click of the color decorator")],description:h(520,"Controls the condition to make a color picker appear from a color decorator.")})),M(new Ge(R.colorDecoratorsLimit,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:h(521,"Controls the max number of color decorators that can be rendered in an editor at once.")})),M(new Ae(R.columnSelection,"columnSelection",!1,{description:h(522,"Enable that the selection with the mouse and keys is doing column selection.")})),M(new U8),M(new Ae(R.contextmenu,"contextmenu",!0)),M(new Ae(R.copyWithSyntaxHighlighting,"copyWithSyntaxHighlighting",!0,{description:h(523,"Controls whether syntax highlighting should be copied into the clipboard.")})),M(new hd(R.cursorBlinking,"cursorBlinking",io.Blink,"blink",["blink","smooth","phase","expand","solid"],H8,{description:h(524,"Control the cursor animation style.")})),M(new dt(R.cursorSmoothCaretAnimation,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[h(525,"Smooth caret animation is disabled."),h(526,"Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),h(527,"Smooth caret animation is always enabled.")],description:h(528,"Controls whether the smooth caret animation should be enabled.")})),M(new hd(R.cursorStyle,"cursorStyle",or.Line,"line",["line","block","underline","line-thin","block-outline","underline-thin"],TE,{description:h(529,"Controls the cursor style in insert input mode.")})),M(new hd(R.overtypeCursorStyle,"overtypeCursorStyle",or.Block,"block",["line","block","underline","line-thin","block-outline","underline-thin"],TE,{description:h(530,"Controls the cursor style in overtype input mode.")})),M(new Ge(R.cursorSurroundingLines,"cursorSurroundingLines",0,0,Wn.MAX_SAFE_SMALL_INTEGER,{description:h(531,"Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),M(new dt(R.cursorSurroundingLinesStyle,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[h(532,"`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),h(533,"`cursorSurroundingLines` is enforced always.")],markdownDescription:h(534,"Controls when `#editor.cursorSurroundingLines#` should be enforced.")})),M(new Ge(R.cursorWidth,"cursorWidth",0,0,Wn.MAX_SAFE_SMALL_INTEGER,{markdownDescription:h(535,"Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),M(new Ae(R.disableLayerHinting,"disableLayerHinting",!1)),M(new Ae(R.disableMonospaceOptimizations,"disableMonospaceOptimizations",!1)),M(new Ae(R.domReadOnly,"domReadOnly",!1)),M(new Ae(R.dragAndDrop,"dragAndDrop",!0,{description:h(536,"Controls whether the editor should allow moving selections via drag and drop.")})),M(new W8),M(new xA),M(new Ae(R.experimentalEditContextEnabled,"experimentalEditContextEnabled",L8.quality!=="stable",{description:h(537,"Sets whether the new experimental edit context should be used instead of the text area."),included:px||xI||wI})),M(new Z8),M(new dt(R.experimentalGpuAcceleration,"experimentalGpuAcceleration","off",["off","on"],{tags:["experimental"],enumDescriptions:[h(538,"Use regular DOM-based rendering."),h(539,"Use GPU acceleration.")],description:h(540,"Controls whether to use the experimental GPU acceleration to render the editor.")})),M(new dt(R.experimentalWhitespaceRendering,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[h(541,"Use a new rendering method with svgs."),h(542,"Use a new rendering method with font characters."),h(543,"Use the stable rendering method.")],description:h(544,"Controls whether whitespace is rendered with a new, experimental method.")})),M(new Ln(R.extraEditorClassName,"extraEditorClassName","")),M(new Hi(R.fastScrollSensitivity,"fastScrollSensitivity",5,n=>n<=0?5:n,{markdownDescription:h(545,"Scrolling speed multiplier when pressing `Alt`.")})),M(new V8),M(new Ae(R.fixedOverflowWidgets,"fixedOverflowWidgets",!1)),M(new Ae(R.folding,"folding",!0,{description:h(546,"Controls whether the editor has code folding enabled.")})),M(new dt(R.foldingStrategy,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[h(547,"Use a language-specific folding strategy if available, else the indentation-based one."),h(548,"Use the indentation-based folding strategy.")],description:h(549,"Controls the strategy for computing folding ranges.")})),M(new Ae(R.foldingHighlight,"foldingHighlight",!0,{description:h(550,"Controls whether the editor should highlight folded ranges.")})),M(new Ae(R.foldingImportsByDefault,"foldingImportsByDefault",!1,{description:h(551,"Controls whether the editor automatically collapses import ranges.")})),M(new Ge(R.foldingMaximumRegions,"foldingMaximumRegions",5e3,10,65e3,{description:h(552,"The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),M(new Ae(R.unfoldOnClickAfterEndOfLine,"unfoldOnClickAfterEndOfLine",!1,{description:h(553,"Controls whether clicking on the empty content after a folded line will unfold the line.")})),M(new Ln(R.fontFamily,"fontFamily",As.fontFamily,{description:h(554,"Controls the font family.")})),M(new z8),M(new aw),M(new G8),M(new cw),M(new lw),M(new Ae(R.formatOnPaste,"formatOnPaste",!1,{description:h(555,"Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),M(new Ae(R.formatOnType,"formatOnType",!1,{description:h(556,"Controls whether the editor should automatically format the line after typing.")})),M(new Ae(R.glyphMargin,"glyphMargin",!0,{description:h(557,"Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),M(new Q8),M(new Ae(R.hideCursorInOverviewRuler,"hideCursorInOverviewRuler",!1,{description:h(558,"Controls whether the cursor should be hidden in the overview ruler.")})),M(new J8),M(new Ae(R.inDiffEditor,"inDiffEditor",!1)),M(new Hi(R.letterSpacing,"letterSpacing",As.letterSpacing,n=>Hi.clamp(n,-5,20),{description:h(559,"Controls the letter spacing in pixels.")})),M(new Y8),M(new eA),M(new tA),M(new cA),M(new Ge(R.lineNumbersMinChars,"lineNumbersMinChars",5,1,300)),M(new Ae(R.linkedEditing,"linkedEditing",!1,{description:h(560,"Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),M(new Ae(R.links,"links",!0,{description:h(561,"Controls whether the editor should detect links and make them clickable.")})),M(new dt(R.matchBrackets,"matchBrackets","always",["always","near","never"],{description:h(562,"Highlight matching brackets.")})),M(new nA),M(new dt(R.mouseStyle,"mouseStyle","text",["text","default","copy"])),M(new Hi(R.mouseWheelScrollSensitivity,"mouseWheelScrollSensitivity",1,n=>n===0?1:n,{markdownDescription:h(563,"A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),M(new Ae(R.mouseWheelZoom,"mouseWheelZoom",!1,{markdownDescription:Pi?h(564,"Zoom the font of the editor when using mouse wheel and holding `Cmd`."):h(565,"Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),M(new Ae(R.multiCursorMergeOverlapping,"multiCursorMergeOverlapping",!0,{description:h(566,"Merge multiple cursors when they are overlapping.")})),M(new hd(R.multiCursorModifier,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],iA,{markdownEnumDescriptions:[h(567,"Maps to `Control` on Windows and Linux and to `Command` on macOS."),h(568,"Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:h(569,"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),M(new dt(R.multiCursorPaste,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[h(570,"Each cursor pastes a single line of the text."),h(571,"Each cursor pastes the full text.")],markdownDescription:h(572,"Controls pasting when the line count of the pasted text matches the cursor count.")})),M(new Ge(R.multiCursorLimit,"multiCursorLimit",1e4,1,1e5,{markdownDescription:h(573,"Controls the max number of cursors that can be in an active editor at once.")})),M(new dt(R.occurrencesHighlight,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[h(574,"Does not highlight occurrences."),h(575,"Highlights occurrences only in the current file."),h(576,"Experimental: Highlights occurrences across all valid open files.")],markdownDescription:h(577,"Controls whether occurrences should be highlighted across open files.")})),M(new Ge(R.occurrencesHighlightDelay,"occurrencesHighlightDelay",0,0,2e3,{description:h(578,"Controls the delay in milliseconds after which occurrences are highlighted."),tags:["preview"]})),M(new Ae(R.overtypeOnPaste,"overtypeOnPaste",!0,{description:h(579,"Controls whether pasting should overtype.")})),M(new Ae(R.overviewRulerBorder,"overviewRulerBorder",!0,{description:h(580,"Controls whether a border should be drawn around the overview ruler.")})),M(new Ge(R.overviewRulerLanes,"overviewRulerLanes",3,0,3)),M(new rA),M(new EA),M(new sA),M(new dt(R.peekWidgetDefaultFocus,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[h(581,"Focus the tree when opening peek"),h(582,"Focus the editor when opening peek")],description:h(583,"Controls whether to focus the inline editor or the tree in the peek widget.")})),M(new aA),M(new Ae(R.definitionLinkOpensInPeek,"definitionLinkOpensInPeek",!1,{description:h(584,"Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),M(new lA),M(new Ge(R.quickSuggestionsDelay,"quickSuggestionsDelay",10,0,Wn.MAX_SAFE_SMALL_INTEGER,{description:h(585,"Controls the delay in milliseconds after which quick suggestions will show up.")})),M(new Ae(R.readOnly,"readOnly",!1)),M(new dA),M(new Ae(R.renameOnType,"renameOnType",!1,{description:h(586,"Controls whether the editor auto renames on type."),markdownDeprecationMessage:h(587,"Deprecated, use `editor.linkedEditing` instead.")})),M(new Ae(R.renderControlCharacters,"renderControlCharacters",!0,{description:h(588,"Controls whether the editor should render control characters."),restricted:!0})),M(new dt(R.renderFinalNewline,"renderFinalNewline",Fs?"dimmed":"on",["off","on","dimmed"],{description:h(589,"Render last line number when the file ends with a newline.")})),M(new dt(R.renderLineHighlight,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",h(590,"Highlights both the gutter and the current line.")],description:h(591,"Controls how the editor should render the current line highlight.")})),M(new Ae(R.renderLineHighlightOnlyWhenFocus,"renderLineHighlightOnlyWhenFocus",!1,{description:h(592,"Controls if the editor should render the current line highlight only when the editor is focused.")})),M(new dt(R.renderValidationDecorations,"renderValidationDecorations","editable",["editable","on","off"])),M(new dt(R.renderWhitespace,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",h(593,"Render whitespace characters except for single spaces between words."),h(594,"Render whitespace characters only on selected text."),h(595,"Render only trailing whitespace characters."),""],description:h(596,"Controls how the editor should render whitespace characters.")})),M(new Ge(R.revealHorizontalRightPadding,"revealHorizontalRightPadding",15,0,1e3)),M(new Ae(R.roundedSelection,"roundedSelection",!0,{description:h(597,"Controls whether selections should have rounded corners.")})),M(new uA),M(new hA),M(new Ge(R.scrollBeyondLastColumn,"scrollBeyondLastColumn",4,0,Wn.MAX_SAFE_SMALL_INTEGER,{description:h(598,"Controls the number of extra characters beyond which the editor will scroll horizontally.")})),M(new Ae(R.scrollBeyondLastLine,"scrollBeyondLastLine",!0,{description:h(599,"Controls whether the editor will scroll beyond the last line.")})),M(new Ae(R.scrollPredominantAxis,"scrollPredominantAxis",!0,{description:h(600,"Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),M(new Ae(R.selectionClipboard,"selectionClipboard",!0,{description:h(601,"Controls whether the Linux primary clipboard should be supported."),included:Fs})),M(new Ae(R.selectionHighlight,"selectionHighlight",!0,{description:h(602,"Controls whether the editor should highlight matches similar to the selection.")})),M(new Ae(R.selectOnLineNumbers,"selectOnLineNumbers",!0)),M(new dt(R.showFoldingControls,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[h(603,"Always show the folding controls."),h(604,"Never show the folding controls and reduce the gutter size."),h(605,"Only show the folding controls when the mouse is over the gutter.")],description:h(606,"Controls when the folding controls on the gutter are shown.")})),M(new Ae(R.showUnused,"showUnused",!0,{description:h(607,"Controls fading out of unused code.")})),M(new Ae(R.showDeprecated,"showDeprecated",!0,{description:h(608,"Controls strikethrough deprecated variables.")})),M(new K8),M(new dt(R.snippetSuggestions,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[h(609,"Show snippet suggestions on top of other suggestions."),h(610,"Show snippet suggestions below other suggestions."),h(611,"Show snippets suggestions with other suggestions."),h(612,"Do not show snippet suggestions.")],description:h(613,"Controls whether snippets are shown with other suggestions and how they are sorted.")})),M(new vA),M(new Ae(R.smoothScrolling,"smoothScrolling",!1,{description:h(614,"Controls whether the editor will scroll using an animation.")})),M(new Ge(R.stopRenderingLineAfter,"stopRenderingLineAfter",1e4,-1,Wn.MAX_SAFE_SMALL_INTEGER)),M(new _A),M(new pA),M(new Ae(R.inlineCompletionsAccessibilityVerbose,"inlineCompletionsAccessibilityVerbose",!1,{description:h(615,"Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),M(new Ge(R.suggestFontSize,"suggestFontSize",0,0,1e3,{markdownDescription:h(616,"Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),M(new Ge(R.suggestLineHeight,"suggestLineHeight",0,0,1e3,{markdownDescription:h(617,"Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),M(new Ae(R.suggestOnTriggerCharacters,"suggestOnTriggerCharacters",!0,{description:h(618,"Controls whether suggestions should automatically show up when typing trigger characters.")})),M(new dt(R.suggestSelection,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[h(619,"Always select the first suggestion."),h(620,"Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),h(621,"Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:h(622,"Controls how suggestions are pre-selected when showing the suggest list.")})),M(new dt(R.tabCompletion,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[h(623,"Tab complete will insert the best matching suggestion when pressing tab."),h(624,"Disable tab completions."),h(625,"Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:h(626,"Enables tab completions.")})),M(new Ge(R.tabIndex,"tabIndex",0,-1,Wn.MAX_SAFE_SMALL_INTEGER)),M(new fA),M(new dt(R.unusualLineTerminators,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[h(627,"Unusual line terminators are automatically removed."),h(628,"Unusual line terminators are ignored."),h(629,"Unusual line terminators prompt to be removed.")],description:h(630,"Remove unusual line terminators that might cause problems.")})),M(new Ae(R.useShadowDOM,"useShadowDOM",!0)),M(new Ae(R.useTabStops,"useTabStops",!0,{description:h(631,"Spaces and tabs are inserted and deleted in alignment with tab stops.")})),M(new dt(R.wordBreak,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[h(632,"Use the default line break rule."),h(633,"Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:h(634,"Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),M(new wA),M(new Ln(R.wordSeparators,"wordSeparators",vC,{description:h(635,"Characters that will be used as word separators when doing word related navigations or operations.")})),M(new dt(R.wordWrap,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[h(636,"Lines will never wrap."),h(637,"Lines will wrap at the viewport width."),h(638,"Lines will wrap at `#editor.wordWrapColumn#`."),h(639,"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:h(640,"Controls how lines should wrap.")})),M(new Ln(R.wordWrapBreakAfterCharacters,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;")),M(new Ln(R.wordWrapBreakBeforeCharacters,"wordWrapBreakBeforeCharacters","([{+")),M(new Ge(R.wordWrapColumn,"wordWrapColumn",80,1,Wn.MAX_SAFE_SMALL_INTEGER,{markdownDescription:h(641,"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),M(new dt(R.wordWrapOverride1,"wordWrapOverride1","inherit",["off","on","inherit"])),M(new dt(R.wordWrapOverride2,"wordWrapOverride2","inherit",["off","on","inherit"])),M(new q8),M(new B8),M(new dt(R.defaultColorDecorators,"defaultColorDecorators","auto",["auto","always","never"],{enumDescriptions:[h(642,"Show default color decorators only when no extension provides colors decorators."),h(643,"Always show default color decorators."),h(644,"Never show default color decorators.")],description:h(645,"Controls whether inline color decorations should be shown using the default document color provider.")})),M(new oA),M(new Ae(R.tabFocusMode,"tabFocusMode",!1,{markdownDescription:h(646,"Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),M(new Md),M(new yA),M(new bA),M(new X8),M(new j8);let Ii=class Wo{constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new Wo(e,t)}delta(e=0,t=0){return this.with(Math.max(1,this.lineNumber+e),Math.max(1,this.column+t))}equals(e){return Wo.equals(this,e)}static equals(e,t){return!e&&!t?!0:!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return Wo.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<t.column}isBeforeOrEqual(e){return Wo.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<=t.column}static compare(e,t){const i=e.lineNumber|0,r=t.lineNumber|0;if(i===r){const s=e.column|0,o=t.column|0;return s-o}return i-r}clone(){return new Wo(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new Wo(e.lineNumber,e.column)}static isIPosition(e){return e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}},lt=class Kt{constructor(e,t,i,r){e>i||e===i&&t>r?(this.startLineNumber=i,this.startColumn=r,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=i,this.endColumn=r)}isEmpty(){return Kt.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return Kt.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<e.startColumn||t.lineNumber===e.endLineNumber&&t.column>e.endColumn)}static strictContainsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<=e.startColumn||t.lineNumber===e.endLineNumber&&t.column>=e.endColumn)}containsRange(e){return Kt.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)}strictContainsRange(e){return Kt.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)}plusRange(e){return Kt.plusRange(this,e)}static plusRange(e,t){let i,r,s,o;return t.startLineNumber<e.startLineNumber?(i=t.startLineNumber,r=t.startColumn):t.startLineNumber===e.startLineNumber?(i=t.startLineNumber,r=Math.min(t.startColumn,e.startColumn)):(i=e.startLineNumber,r=e.startColumn),t.endLineNumber>e.endLineNumber?(s=t.endLineNumber,o=t.endColumn):t.endLineNumber===e.endLineNumber?(s=t.endLineNumber,o=Math.max(t.endColumn,e.endColumn)):(s=e.endLineNumber,o=e.endColumn),new Kt(i,r,s,o)}intersectRanges(e){return Kt.intersectRanges(this,e)}static intersectRanges(e,t){let i=e.startLineNumber,r=e.startColumn,s=e.endLineNumber,o=e.endColumn;const a=t.startLineNumber,l=t.startColumn,c=t.endLineNumber,u=t.endColumn;return i<a?(i=a,r=l):i===a&&(r=Math.max(r,l)),s>c?(s=c,o=u):s===c&&(o=Math.min(o,u)),i>s||i===s&&r>o?null:new Kt(i,r,s,o)}equalsRange(e){return Kt.equalsRange(this,e)}static equalsRange(e,t){return!e&&!t?!0:!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return Kt.getEndPosition(this)}static getEndPosition(e){return new Ii(e.endLineNumber,e.endColumn)}getStartPosition(){return Kt.getStartPosition(this)}static getStartPosition(e){return new Ii(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new Kt(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new Kt(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return Kt.collapseToStart(this)}static collapseToStart(e){return new Kt(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return Kt.collapseToEnd(this)}static collapseToEnd(e){return new Kt(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new Kt(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}isSingleLine(){return this.startLineNumber===this.endLineNumber}static fromPositions(e,t=e){return new Kt(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new Kt(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static areOnlyIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber-1||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn-1||t.endLineNumber<e.startLineNumber-1||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn-1)}static compareRangesUsingStarts(e,t){if(e&&t){const s=e.startLineNumber|0,o=t.startLineNumber|0;if(s===o){const a=e.startColumn|0,l=t.startColumn|0;if(a===l){const c=e.endLineNumber|0,u=t.endLineNumber|0;if(c===u){const d=e.endColumn|0,f=t.endColumn|0;return d-f}return c-u}return a-l}return s-o}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}};var RE;(function(n){n[n.Null=0]="Null",n[n.PlainText=1]="PlainText"})(RE||(RE={}));var LE;(function(n){n[n.NotSet=-1]="NotSet",n[n.None=0]="None",n[n.Italic=1]="Italic",n[n.Bold=2]="Bold",n[n.Underline=4]="Underline",n[n.Strikethrough=8]="Strikethrough"})(LE||(LE={}));var vg;(function(n){n[n.None=0]="None",n[n.DefaultForeground=1]="DefaultForeground",n[n.DefaultBackground=2]="DefaultBackground"})(vg||(vg={}));var tc;(function(n){n[n.Other=0]="Other",n[n.Comment=1]="Comment",n[n.String=2]="String",n[n.RegEx=3]="RegEx"})(tc||(tc={}));var NE;(function(n){n[n.LANGUAGEID_MASK=255]="LANGUAGEID_MASK",n[n.TOKEN_TYPE_MASK=768]="TOKEN_TYPE_MASK",n[n.BALANCED_BRACKETS_MASK=1024]="BALANCED_BRACKETS_MASK",n[n.FONT_STYLE_MASK=30720]="FONT_STYLE_MASK",n[n.FOREGROUND_MASK=16744448]="FOREGROUND_MASK",n[n.BACKGROUND_MASK=4278190080]="BACKGROUND_MASK",n[n.ITALIC_MASK=2048]="ITALIC_MASK",n[n.BOLD_MASK=4096]="BOLD_MASK",n[n.UNDERLINE_MASK=8192]="UNDERLINE_MASK",n[n.STRIKETHROUGH_MASK=16384]="STRIKETHROUGH_MASK",n[n.SEMANTIC_USE_ITALIC=1]="SEMANTIC_USE_ITALIC",n[n.SEMANTIC_USE_BOLD=2]="SEMANTIC_USE_BOLD",n[n.SEMANTIC_USE_UNDERLINE=4]="SEMANTIC_USE_UNDERLINE",n[n.SEMANTIC_USE_STRIKETHROUGH=8]="SEMANTIC_USE_STRIKETHROUGH",n[n.SEMANTIC_USE_FOREGROUND=16]="SEMANTIC_USE_FOREGROUND",n[n.SEMANTIC_USE_BACKGROUND=32]="SEMANTIC_USE_BACKGROUND",n[n.LANGUAGEID_OFFSET=0]="LANGUAGEID_OFFSET",n[n.TOKEN_TYPE_OFFSET=8]="TOKEN_TYPE_OFFSET",n[n.BALANCED_BRACKETS_OFFSET=10]="BALANCED_BRACKETS_OFFSET",n[n.FONT_STYLE_OFFSET=11]="FONT_STYLE_OFFSET",n[n.FOREGROUND_OFFSET=15]="FOREGROUND_OFFSET",n[n.BACKGROUND_OFFSET=24]="BACKGROUND_OFFSET"})(NE||(NE={}));class SC{constructor(){this._tokenizationSupports=new Map,this._factories=new Map,this._onDidChange=new L,this.onDidChange=this._onDidChange.event,this._colorMap=null}handleChange(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._tokenizationSupports.set(e,t),this.handleChange([e]),Se(()=>{this._tokenizationSupports.get(e)===t&&(this._tokenizationSupports.delete(e),this.handleChange([e]))})}get(e){return this._tokenizationSupports.get(e)||null}registerFactory(e,t){var r;(r=this._factories.get(e))==null||r.dispose();const i=new CA(this,e,t);return this._factories.set(e,i),Se(()=>{const s=this._factories.get(e);!s||s!==i||(this._factories.delete(e),s.dispose())})}async getOrCreate(e){const t=this.get(e);if(t)return t;const i=this._factories.get(e);return!i||i.isResolved?null:(await i.resolve(),this.get(e))}isResolved(e){if(this.get(e))return!0;const i=this._factories.get(e);return!!(!i||i.isResolved)}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>vg.DefaultBackground?this._colorMap[vg.DefaultBackground]:null}}class CA extends Te{get isResolved(){return this._isResolved}constructor(e,t,i){super(),this._registry=e,this._languageId=t,this._factory=i,this._isDisposed=!1,this._resolvePromise=null,this._isResolved=!1}dispose(){this._isDisposed=!0,super.dispose()}async resolve(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}async _create(){const e=await this._factory.tokenizationSupport;this._isResolved=!0,e&&!this._isDisposed&&this._register(this._registry.register(this._languageId,e))}}var OE;(function(n){n[n.Increase=0]="Increase",n[n.Decrease=1]="Decrease"})(OE||(OE={}));var O;(function(n){n[n.Method=0]="Method",n[n.Function=1]="Function",n[n.Constructor=2]="Constructor",n[n.Field=3]="Field",n[n.Variable=4]="Variable",n[n.Class=5]="Class",n[n.Struct=6]="Struct",n[n.Interface=7]="Interface",n[n.Module=8]="Module",n[n.Property=9]="Property",n[n.Event=10]="Event",n[n.Operator=11]="Operator",n[n.Unit=12]="Unit",n[n.Value=13]="Value",n[n.Constant=14]="Constant",n[n.Enum=15]="Enum",n[n.EnumMember=16]="EnumMember",n[n.Keyword=17]="Keyword",n[n.Text=18]="Text",n[n.Color=19]="Color",n[n.File=20]="File",n[n.Reference=21]="Reference",n[n.Customcolor=22]="Customcolor",n[n.Folder=23]="Folder",n[n.TypeParameter=24]="TypeParameter",n[n.User=25]="User",n[n.Issue=26]="Issue",n[n.Snippet=27]="Snippet"})(O||(O={}));var FE;(function(n){const e=new Map;e.set(O.Method,we.symbolMethod),e.set(O.Function,we.symbolFunction),e.set(O.Constructor,we.symbolConstructor),e.set(O.Field,we.symbolField),e.set(O.Variable,we.symbolVariable),e.set(O.Class,we.symbolClass),e.set(O.Struct,we.symbolStruct),e.set(O.Interface,we.symbolInterface),e.set(O.Module,we.symbolModule),e.set(O.Property,we.symbolProperty),e.set(O.Event,we.symbolEvent),e.set(O.Operator,we.symbolOperator),e.set(O.Unit,we.symbolUnit),e.set(O.Value,we.symbolValue),e.set(O.Enum,we.symbolEnum),e.set(O.Constant,we.symbolConstant),e.set(O.Enum,we.symbolEnum),e.set(O.EnumMember,we.symbolEnumMember),e.set(O.Keyword,we.symbolKeyword),e.set(O.Snippet,we.symbolSnippet),e.set(O.Text,we.symbolText),e.set(O.Color,we.symbolColor),e.set(O.File,we.symbolFile),e.set(O.Reference,we.symbolReference),e.set(O.Customcolor,we.symbolCustomColor),e.set(O.Folder,we.symbolFolder),e.set(O.TypeParameter,we.symbolTypeParameter),e.set(O.User,we.account),e.set(O.Issue,we.issues);function t(o){let a=e.get(o);return a||(console.info("No codicon found for CompletionItemKind "+o),a=we.symbolProperty),a}n.toIcon=t;function i(o){switch(o){case O.Method:return h(763,"Method");case O.Function:return h(764,"Function");case O.Constructor:return h(765,"Constructor");case O.Field:return h(766,"Field");case O.Variable:return h(767,"Variable");case O.Class:return h(768,"Class");case O.Struct:return h(769,"Struct");case O.Interface:return h(770,"Interface");case O.Module:return h(771,"Module");case O.Property:return h(772,"Property");case O.Event:return h(773,"Event");case O.Operator:return h(774,"Operator");case O.Unit:return h(775,"Unit");case O.Value:return h(776,"Value");case O.Constant:return h(777,"Constant");case O.Enum:return h(778,"Enum");case O.EnumMember:return h(779,"Enum Member");case O.Keyword:return h(780,"Keyword");case O.Text:return h(781,"Text");case O.Color:return h(782,"Color");case O.File:return h(783,"File");case O.Reference:return h(784,"Reference");case O.Customcolor:return h(785,"Custom Color");case O.Folder:return h(786,"Folder");case O.TypeParameter:return h(787,"Type Parameter");case O.User:return h(788,"User");case O.Issue:return h(789,"Issue");case O.Snippet:return h(790,"Snippet");default:return""}}n.toLabel=i;const r=new Map;r.set("method",O.Method),r.set("function",O.Function),r.set("constructor",O.Constructor),r.set("field",O.Field),r.set("variable",O.Variable),r.set("class",O.Class),r.set("struct",O.Struct),r.set("interface",O.Interface),r.set("module",O.Module),r.set("property",O.Property),r.set("event",O.Event),r.set("operator",O.Operator),r.set("unit",O.Unit),r.set("value",O.Value),r.set("constant",O.Constant),r.set("enum",O.Enum),r.set("enum-member",O.EnumMember),r.set("enumMember",O.EnumMember),r.set("keyword",O.Keyword),r.set("snippet",O.Snippet),r.set("text",O.Text),r.set("color",O.Color),r.set("file",O.File),r.set("reference",O.Reference),r.set("customcolor",O.Customcolor),r.set("folder",O.Folder),r.set("type-parameter",O.TypeParameter),r.set("typeParameter",O.TypeParameter),r.set("account",O.User),r.set("issue",O.Issue);function s(o,a){let l=r.get(o);return typeof l>"u"&&!a&&(l=O.Property),l}n.fromString=s})(FE||(FE={}));var wg;(function(n){n[n.Deprecated=1]="Deprecated"})(wg||(wg={}));var za;(function(n){n[n.None=0]="None",n[n.KeepWhitespace=1]="KeepWhitespace",n[n.InsertAsSnippet=4]="InsertAsSnippet"})(za||(za={}));var $d;(function(n){n[n.Word=0]="Word",n[n.Line=1]="Line",n[n.Suggest=2]="Suggest"})($d||($d={}));var Ud;(function(n){n[n.Invoke=0]="Invoke",n[n.TriggerCharacter=1]="TriggerCharacter",n[n.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(Ud||(Ud={}));var bg;(function(n){n[n.Automatic=0]="Automatic",n[n.Explicit=1]="Explicit"})(bg||(bg={}));var yg;(function(n){n[n.Invoke=1]="Invoke",n[n.Auto=2]="Auto"})(yg||(yg={}));var ME;(function(n){n[n.Automatic=0]="Automatic",n[n.PasteAs=1]="PasteAs"})(ME||(ME={}));var $E;(function(n){n[n.Invoke=1]="Invoke",n[n.TriggerCharacter=2]="TriggerCharacter",n[n.ContentChange=3]="ContentChange"})($E||($E={}));var UE;(function(n){n[n.Text=0]="Text",n[n.Read=1]="Read",n[n.Write=2]="Write"})(UE||(UE={}));function PA(n){return n&&y.isUri(n.uri)&&lt.isIRange(n.range)&&(lt.isIRange(n.originSelectionRange)||lt.isIRange(n.targetSelectionRange))}var G;(function(n){n[n.File=0]="File",n[n.Module=1]="Module",n[n.Namespace=2]="Namespace",n[n.Package=3]="Package",n[n.Class=4]="Class",n[n.Method=5]="Method",n[n.Property=6]="Property",n[n.Field=7]="Field",n[n.Constructor=8]="Constructor",n[n.Enum=9]="Enum",n[n.Interface=10]="Interface",n[n.Function=11]="Function",n[n.Variable=12]="Variable",n[n.Constant=13]="Constant",n[n.String=14]="String",n[n.Number=15]="Number",n[n.Boolean=16]="Boolean",n[n.Array=17]="Array",n[n.Object=18]="Object",n[n.Key=19]="Key",n[n.Null=20]="Null",n[n.EnumMember=21]="EnumMember",n[n.Struct=22]="Struct",n[n.Event=23]="Event",n[n.Operator=24]="Operator",n[n.TypeParameter=25]="TypeParameter"})(G||(G={}));G.Array+"",h(791,"array"),G.Boolean+"",h(792,"boolean"),G.Class+"",h(793,"class"),G.Constant+"",h(794,"constant"),G.Constructor+"",h(795,"constructor"),G.Enum+"",h(796,"enumeration"),G.EnumMember+"",h(797,"enumeration member"),G.Event+"",h(798,"event"),G.Field+"",h(799,"field"),G.File+"",h(800,"file"),G.Function+"",h(801,"function"),G.Interface+"",h(802,"interface"),G.Key+"",h(803,"key"),G.Method+"",h(804,"method"),G.Module+"",h(805,"module"),G.Namespace+"",h(806,"namespace"),G.Null+"",h(807,"null"),G.Number+"",h(808,"number"),G.Object+"",h(809,"object"),G.Operator+"",h(810,"operator"),G.Package+"",h(811,"package"),G.Property+"",h(812,"property"),G.String+"",h(813,"string"),G.Struct+"",h(814,"struct"),G.TypeParameter+"",h(815,"type parameter"),G.Variable+"",h(816,"variable");var xg;(function(n){n[n.Deprecated=1]="Deprecated"})(xg||(xg={}));var HE;(function(n){const e=new Map;e.set(G.File,we.symbolFile),e.set(G.Module,we.symbolModule),e.set(G.Namespace,we.symbolNamespace),e.set(G.Package,we.symbolPackage),e.set(G.Class,we.symbolClass),e.set(G.Method,we.symbolMethod),e.set(G.Property,we.symbolProperty),e.set(G.Field,we.symbolField),e.set(G.Constructor,we.symbolConstructor),e.set(G.Enum,we.symbolEnum),e.set(G.Interface,we.symbolInterface),e.set(G.Function,we.symbolFunction),e.set(G.Variable,we.symbolVariable),e.set(G.Constant,we.symbolConstant),e.set(G.String,we.symbolString),e.set(G.Number,we.symbolNumber),e.set(G.Boolean,we.symbolBoolean),e.set(G.Array,we.symbolArray),e.set(G.Object,we.symbolObject),e.set(G.Key,we.symbolKey),e.set(G.Null,we.symbolNull),e.set(G.EnumMember,we.symbolEnumMember),e.set(G.Struct,we.symbolStruct),e.set(G.Event,we.symbolEvent),e.set(G.Operator,we.symbolOperator),e.set(G.TypeParameter,we.symbolTypeParameter);function t(s){let o=e.get(s);return o||(console.info("No codicon found for SymbolKind "+s),o=we.symbolProperty),o}n.toIcon=t;const i=new Map;i.set(G.File,O.File),i.set(G.Module,O.Module),i.set(G.Namespace,O.Module),i.set(G.Package,O.Module),i.set(G.Class,O.Class),i.set(G.Method,O.Method),i.set(G.Property,O.Property),i.set(G.Field,O.Field),i.set(G.Constructor,O.Constructor),i.set(G.Enum,O.Enum),i.set(G.Interface,O.Interface),i.set(G.Function,O.Function),i.set(G.Variable,O.Variable),i.set(G.Constant,O.Constant),i.set(G.String,O.Text),i.set(G.Number,O.Value),i.set(G.Boolean,O.Value),i.set(G.Array,O.Value),i.set(G.Object,O.Value),i.set(G.Key,O.Keyword),i.set(G.Null,O.Value),i.set(G.EnumMember,O.EnumMember),i.set(G.Struct,O.Struct),i.set(G.Event,O.Event),i.set(G.Operator,O.Operator),i.set(G.TypeParameter,O.TypeParameter);function r(s){let o=i.get(s);return o===void 0&&(console.info("No completion kind found for SymbolKind "+s),o=O.File),o}n.toCompletionKind=r})(HE||(HE={}));var Zn;let Bl=(Zn=class{static fromValue(e){switch(e){case"comment":return Zn.Comment;case"imports":return Zn.Imports;case"region":return Zn.Region}return new Zn(e)}constructor(e){this.value=e}},Zn.Comment=new Zn("comment"),Zn.Imports=new Zn("imports"),Zn.Region=new Zn("region"),Zn);var BE;(function(n){n[n.AIGenerated=1]="AIGenerated"})(BE||(BE={}));var Eg;(function(n){n[n.Invoke=0]="Invoke",n[n.Automatic=1]="Automatic"})(Eg||(Eg={}));var uw;(function(n){function e(t){return!t||typeof t!="object"?!1:typeof t.id=="string"&&typeof t.title=="string"}n.is=e})(uw||(uw={}));var nc;(function(n){n[n.Collapsed=0]="Collapsed",n[n.Expanded=1]="Expanded"})(nc||(nc={}));var Hd;(function(n){n[n.Unresolved=0]="Unresolved",n[n.Resolved=1]="Resolved"})(Hd||(Hd={}));var Bd;(function(n){n[n.Current=0]="Current",n[n.Outdated=1]="Outdated"})(Bd||(Bd={}));var WE;(function(n){n[n.Editing=0]="Editing",n[n.Preview=1]="Preview"})(WE||(WE={}));var VE;(function(n){n[n.Published=0]="Published",n[n.Draft=1]="Draft"})(VE||(VE={}));var zE;(function(n){n[n.Type=1]="Type",n[n.Parameter=2]="Parameter"})(zE||(zE={}));new SC;new SC;var qE;(function(n){n[n.None=0]="None",n[n.Option=1]="Option",n[n.Default=2]="Default",n[n.Preferred=3]="Preferred"})(qE||(qE={}));var Sg;(function(n){n[n.Invoke=0]="Invoke",n[n.Automatic=1]="Automatic"})(Sg||(Sg={}));var dw;(function(n){n[n.Left=1]="Left",n[n.Center=2]="Center",n[n.Right=4]="Right",n[n.Full=7]="Full"})(dw||(dw={}));var jE;(function(n){n[n.Left=1]="Left",n[n.Center=2]="Center",n[n.Right=3]="Right"})(jE||(jE={}));var GE;(function(n){n[n.Inline=1]="Inline",n[n.Gutter=2]="Gutter"})(GE||(GE={}));var QE;(function(n){n[n.Normal=1]="Normal",n[n.Underlined=2]="Underlined"})(QE||(QE={}));var JE;(function(n){n[n.Both=0]="Both",n[n.Right=1]="Right",n[n.Left=2]="Left",n[n.None=3]="None"})(JE||(JE={}));var os;(function(n){n[n.TextDefined=0]="TextDefined",n[n.LF=1]="LF",n[n.CRLF=2]="CRLF"})(os||(os={}));var wh;(function(n){n[n.LF=1]="LF",n[n.CRLF=2]="CRLF"})(wh||(wh={}));var ic;(function(n){n[n.LF=0]="LF",n[n.CRLF=1]="CRLF"})(ic||(ic={}));class hw{constructor(e,t){this._findMatchBrand=void 0,this.range=e,this.matches=t}}var rc;(function(n){n[n.AlwaysGrowsWhenTypingAtEdges=0]="AlwaysGrowsWhenTypingAtEdges",n[n.NeverGrowsWhenTypingAtEdges=1]="NeverGrowsWhenTypingAtEdges",n[n.GrowsOnlyWhenTypingBefore=2]="GrowsOnlyWhenTypingBefore",n[n.GrowsOnlyWhenTypingAfter=3]="GrowsOnlyWhenTypingAfter"})(rc||(rc={}));var XE;(function(n){n[n.Left=0]="Left",n[n.Right=1]="Right",n[n.None=2]="None",n[n.LeftOfInjectedText=3]="LeftOfInjectedText",n[n.RightOfInjectedText=4]="RightOfInjectedText"})(XE||(XE={}));var YE;(function(n){n[n.FIRST_LINE_DETECTION_LENGTH_LIMIT=1e3]="FIRST_LINE_DETECTION_LENGTH_LIMIT"})(YE||(YE={}));class TA{constructor(e,t,i){this.regex=e,this.wordSeparators=t,this.simpleSearch=i}}class AA{constructor(e,t,i){this.reverseEdits=e,this.changes=t,this.trimAutoWhitespaceLineNumbers=i}}var sc;(function(n){n[n.Unnecessary=1]="Unnecessary",n[n.Deprecated=2]="Deprecated"})(sc||(sc={}));var ei;(function(n){n[n.Hint=1]="Hint",n[n.Info=2]="Info",n[n.Warning=4]="Warning",n[n.Error=8]="Error"})(ei||(ei={}));(function(n){function e(l,c){return c-l}n.compare=e;const t=Object.create(null);t[n.Error]=h(1915,"Error"),t[n.Warning]=h(1916,"Warning"),t[n.Info]=h(1917,"Info");function i(l){return t[l]||""}n.toString=i;const r=Object.create(null);r[n.Error]=h(1918,"Errors"),r[n.Warning]=h(1919,"Warnings"),r[n.Info]=h(1920,"Infos");function s(l){return r[l]||""}n.toStringPlural=s;function o(l){switch(l){case qt.Error:return n.Error;case qt.Warning:return n.Warning;case qt.Info:return n.Info;case qt.Ignore:return n.Hint}}n.fromSeverity=o;function a(l){switch(l){case n.Error:return qt.Error;case n.Warning:return qt.Warning;case n.Info:return qt.Info;case n.Hint:return qt.Ignore}}n.toSeverity=a})(ei||(ei={}));var ZE;(function(n){const e="";function t(r){return i(r,!0)}n.makeKey=t;function i(r,s){const o=[e];return r.source?o.push(r.source.replace("","\\")):o.push(e),r.code?typeof r.code=="string"?o.push(r.code.replace("","\\")):o.push(r.code.value.replace("","\\")):o.push(e),r.severity!==void 0&&r.severity!==null?o.push(ei.toString(r.severity)):o.push(e),r.message&&s?o.push(r.message.replace("","\\")):o.push(e),r.startLineNumber!==void 0&&r.startLineNumber!==null?o.push(r.startLineNumber.toString()):o.push(e),r.startColumn!==void 0&&r.startColumn!==null?o.push(r.startColumn.toString()):o.push(e),r.endLineNumber!==void 0&&r.endLineNumber!==null?o.push(r.endLineNumber.toString()):o.push(e),r.endColumn!==void 0&&r.endColumn!==null?o.push(r.endColumn.toString()):o.push(e),o.push(e),o.join("")}n.makeKeyOptionalMessage=i})(ZE||(ZE={}));const RA=De("progressService");De("editorProgressService");var Wd;(function(n){n[n.Explorer=1]="Explorer",n[n.Scm=3]="Scm",n[n.Extensions=5]="Extensions",n[n.Window=10]="Window",n[n.Notification=15]="Notification",n[n.Dialog=20]="Dialog"})(Wd||(Wd={}));const _2=class _2{get value(){return this._value}constructor(e){this.callback=e}report(e){this._value=e,this.callback(this._value)}};_2.None=Object.freeze({report(){}});let Dg=_2,KE=class extends Te{constructor(e,t){super(),this.deferred=new Sl,t.withProgress(e,i=>(this.reporter=i,this.lastStep&&i.report(this.lastStep),this.deferred.p)),this._register(Se(()=>this.deferred.complete()))}report(e){this.reporter?this.reporter.report(e):this.lastStep=e}};KE=V([F(1,RA)],KE);class LA{constructor(){this.data=new Map}add(e,t){Vn(Ze(e)),Vn(Zt(t)),Vn(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}knows(e){return this.data.has(e)}as(e){return this.data.get(e)||null}}const Cn=new LA;function lv(n,e){return e&&(n.stack||n.stacktrace)?h(105,"{0}: {1}",tS(n),eS(n.stack)||eS(n.stacktrace)):tS(n)}function eS(n){return Array.isArray(n)?n.join(`
`):n}function tS(n){return n.code==="ERR_UNC_HOST_NOT_ALLOWED"?`${n.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof n.code=="string"&&typeof n.errno=="number"&&typeof n.syscall=="string"?h(106,"A system error occurred ({0})",n.message):n.message||h(107,"An unknown error occurred. Please consult the log for more details.")}function Zu(n=null,e=!1){if(!n)return h(107,"An unknown error occurred. Please consult the log for more details.");if(Array.isArray(n)){const t=sn(n),i=Zu(t[0],e);return t.length>1?h(108,"{0} ({1} errors in total)",i,t.length):i}if(Ze(n))return n;if(n.detail){const t=n.detail;if(t.error)return lv(t.error,e);if(t.exception)return lv(t.exception,e)}return n.stack?lv(n,e):n.message?n.message:h(107,"An unknown error occurred. Please consult the log for more details.")}class NA extends Te{constructor(e,t="",i="",r=!0,s){super(),this._onDidChange=this._register(new L),this.onDidChange=this._onDidChange.event,this._enabled=!0,this._id=e,this._label=t,this._cssClass=i,this._enabled=r,this._actionCallback=s}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){this._label!==e&&(this._label=e,this._onDidChange.fire({label:e}))}get tooltip(){return this._tooltip||""}set tooltip(e){this._setTooltip(e)}_setTooltip(e){this._tooltip!==e&&(this._tooltip=e,this._onDidChange.fire({tooltip:e}))}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){this._cssClass!==e&&(this._cssClass=e,this._onDidChange.fire({class:e}))}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){this._enabled!==e&&(this._enabled=e,this._onDidChange.fire({enabled:e}))}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){this._checked!==e&&(this._checked=e,this._onDidChange.fire({checked:e}))}async run(e,t){this._actionCallback&&await this._actionCallback(e)}}const A1=class A1 extends NA{constructor(){super(A1.ID,h(43,"(empty)"),void 0,!1)}};A1.ID="vs.actions.empty";let nS=A1;const OA={EditorFactory:"workbench.contributions.editor.inputFactories"},FA={id:"default",displayName:h(3827,"Text Editor"),providerDisplayName:h(3828,"Built-in")};var iS;(function(n){n[n.PROGRAMMATIC=1]="PROGRAMMATIC",n[n.USER=2]="USER",n[n.EDIT=3]="EDIT",n[n.NAVIGATION=4]="NAVIGATION",n[n.JUMP=5]="JUMP"})(iS||(iS={}));var rS;(function(n){n[n.IDENTICAL=1]="IDENTICAL",n[n.SIMILAR=2]="SIMILAR",n[n.DIFFERENT=3]="DIFFERENT"})(rS||(rS={}));var sS;(function(n){n[n.SHORT=0]="SHORT",n[n.MEDIUM=1]="MEDIUM",n[n.LONG=2]="LONG"})(sS||(sS={}));var ua;(function(n){n[n.EXPLICIT=1]="EXPLICIT",n[n.AUTO=2]="AUTO",n[n.FOCUS_CHANGE=3]="FOCUS_CHANGE",n[n.WINDOW_CHANGE=4]="WINDOW_CHANGE"})(ua||(ua={}));var oS;(function(n){n[n.None=0]="None",n[n.Readonly=2]="Readonly",n[n.Untitled=4]="Untitled",n[n.Singleton=8]="Singleton",n[n.RequiresTrust=16]="RequiresTrust",n[n.CanSplitInGroup=32]="CanSplitInGroup",n[n.ForceDescription=64]="ForceDescription",n[n.CanDropIntoEditor=128]="CanDropIntoEditor",n[n.MultipleEditors=256]="MultipleEditors",n[n.Scratchpad=512]="Scratchpad"})(oS||(oS={}));var aS;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.REPLACE=1]="REPLACE",n[n.MOVE=2]="MOVE",n[n.UNPIN=3]="UNPIN"})(aS||(aS={}));var lS;(function(n){n[n.GROUP_ACTIVE=0]="GROUP_ACTIVE",n[n.GROUP_INDEX=1]="GROUP_INDEX",n[n.GROUP_LABEL=2]="GROUP_LABEL",n[n.GROUP_LOCKED=3]="GROUP_LOCKED",n[n.EDITORS_SELECTION=4]="EDITORS_SELECTION",n[n.EDITOR_OPEN=5]="EDITOR_OPEN",n[n.EDITOR_CLOSE=6]="EDITOR_CLOSE",n[n.EDITOR_MOVE=7]="EDITOR_MOVE",n[n.EDITOR_ACTIVE=8]="EDITOR_ACTIVE",n[n.EDITOR_LABEL=9]="EDITOR_LABEL",n[n.EDITOR_CAPABILITIES=10]="EDITOR_CAPABILITIES",n[n.EDITOR_PIN=11]="EDITOR_PIN",n[n.EDITOR_TRANSIENT=12]="EDITOR_TRANSIENT",n[n.EDITOR_STICKY=13]="EDITOR_STICKY",n[n.EDITOR_DIRTY=14]="EDITOR_DIRTY",n[n.EDITOR_WILL_DISPOSE=15]="EDITOR_WILL_DISPOSE"})(lS||(lS={}));var cS;(function(n){n[n.PRIMARY=1]="PRIMARY",n[n.SECONDARY=2]="SECONDARY",n[n.BOTH=3]="BOTH",n[n.ANY=4]="ANY"})(cS||(cS={}));var uS;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.KEYBOARD=1]="KEYBOARD",n[n.MOUSE=2]="MOUSE"})(uS||(uS={}));var dS;(function(n){n[n.LEFT=0]="LEFT",n[n.RIGHT=1]="RIGHT"})(dS||(dS={}));class MA{constructor(){this.editorSerializerConstructors=new Map,this.editorSerializerInstances=new Map}start(e){const t=this.instantiationService=e.get(zf);for(const[i,r]of this.editorSerializerConstructors)this.createEditorSerializer(i,r,t);this.editorSerializerConstructors.clear()}createEditorSerializer(e,t,i){const r=i.createInstance(t);this.editorSerializerInstances.set(e,r)}registerFileEditorFactory(e){if(this.fileEditorFactory)throw new Error("Can only register one file editor factory.");this.fileEditorFactory=e}getFileEditorFactory(){return cu(this.fileEditorFactory)}registerEditorSerializer(e,t){if(this.editorSerializerConstructors.has(e)||this.editorSerializerInstances.has(e))throw new Error(`A editor serializer with type ID '${e}' was already registered.`);return this.instantiationService?this.createEditorSerializer(e,t,this.instantiationService):this.editorSerializerConstructors.set(e,t),Se(()=>{this.editorSerializerConstructors.delete(e),this.editorSerializerInstances.delete(e)})}getEditorSerializer(e){return this.editorSerializerInstances.get(typeof e=="string"?e:e.typeId)}}Cn.add(OA.EditorFactory,new MA);var hS;(function(n){n[n.MOST_RECENTLY_ACTIVE=0]="MOST_RECENTLY_ACTIVE",n[n.SEQUENTIAL=1]="SEQUENTIAL"})(hS||(hS={}));const DC=De("contextKeyService"),fS="^([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$";var pS;(function(n){n.COMMAND="command",n.SETTINGS_SYNC="settingsSync"})(pS||(pS={}));var gS;(function(n){n.NoneOrRelevance="NoneOrRelevance",n.LastUpdatedDate="LastUpdatedDate",n.Title="Title",n.PublisherName="PublisherName",n.InstallCount="InstallCount",n.PublishedDate="PublishedDate",n.AverageRating="AverageRating",n.WeightedRating="WeightedRating"})(gS||(gS={}));var mS;(function(n){n[n.Default=0]="Default",n[n.Ascending=1]="Ascending",n[n.Descending=2]="Descending"})(mS||(mS={}));var _S;(function(n){n.Category="Category",n.ExtensionId="ExtensionId",n.ExtensionName="ExtensionName",n.ExcludeWithFlags="ExcludeWithFlags",n.Featured="Featured",n.SearchText="SearchText",n.Tag="Tag",n.Target="Target"})(_S||(_S={}));var vS;(function(n){n.Install="install",n.Uninstall="uninstall"})(vS||(vS={}));var wS;(function(n){n[n.None=1]="None",n[n.Install=2]="Install",n[n.Update=3]="Update",n[n.Migrate=4]="Migrate"})(wS||(wS={}));var bS;(function(n){n.Timeout="Timeout",n.Cancelled="Cancelled",n.Failed="Failed",n.DownloadFailedWriting="DownloadFailedWriting",n.Offline="Offline"})(bS||(bS={}));var yS;(function(n){n.NotFound="NotFound",n.Unsupported="Unsupported",n.Deprecated="Deprecated",n.Malicious="Malicious",n.Incompatible="Incompatible",n.IncompatibleApi="IncompatibleApi",n.IncompatibleTargetPlatform="IncompatibleTargetPlatform",n.ReleaseVersionNotFound="ReleaseVersionNotFound",n.Invalid="Invalid",n.Download="Download",n.DownloadSignature="DownloadSignature",n.DownloadFailedWriting="DownloadFailedWriting",n.UpdateMetadata="UpdateMetadata",n.Extract="Extract",n.Scanning="Scanning",n.ScanningExtension="ScanningExtension",n.ReadRemoved="ReadRemoved",n.UnsetRemoved="UnsetRemoved",n.Delete="Delete",n.Rename="Rename",n.IntializeDefaultProfile="IntializeDefaultProfile",n.AddToProfile="AddToProfile",n.InstalledExtensionNotFound="InstalledExtensionNotFound",n.PostInstall="PostInstall",n.CorruptZip="CorruptZip",n.IncompleteZip="IncompleteZip",n.PackageNotSigned="PackageNotSigned",n.SignatureVerificationInternal="SignatureVerificationInternal",n.SignatureVerificationFailed="SignatureVerificationFailed",n.NotAllowed="NotAllowed",n.Gallery="Gallery",n.Cancelled="Cancelled",n.Unknown="Unknown",n.Internal="Internal"})(yS||(yS={}));var xS;(function(n){n.NotSigned="NotSigned",n.Success="Success",n.RequiredArgumentMissing="RequiredArgumentMissing",n.InvalidArgument="InvalidArgument",n.PackageIsUnreadable="PackageIsUnreadable",n.UnhandledException="UnhandledException",n.SignatureManifestIsMissing="SignatureManifestIsMissing",n.SignatureManifestIsUnreadable="SignatureManifestIsUnreadable",n.SignatureIsMissing="SignatureIsMissing",n.SignatureIsUnreadable="SignatureIsUnreadable",n.CertificateIsUnreadable="CertificateIsUnreadable",n.SignatureArchiveIsUnreadable="SignatureArchiveIsUnreadable",n.FileAlreadyExists="FileAlreadyExists",n.SignatureArchiveIsInvalidZip="SignatureArchiveIsInvalidZip",n.SignatureArchiveHasSameSignatureFile="SignatureArchiveHasSameSignatureFile",n.PackageIntegrityCheckFailed="PackageIntegrityCheckFailed",n.SignatureIsInvalid="SignatureIsInvalid",n.SignatureManifestIsInvalid="SignatureManifestIsInvalid",n.SignatureIntegrityCheckFailed="SignatureIntegrityCheckFailed",n.EntryIsMissing="EntryIsMissing",n.EntryIsTampered="EntryIsTampered",n.Untrusted="Untrusted",n.CertificateRevoked="CertificateRevoked",n.SignatureIsNotValid="SignatureIsNotValid",n.UnknownError="UnknownError",n.PackageIsInvalidZip="PackageIsInvalidZip",n.SignatureArchiveHasTooManyEntries="SignatureArchiveHasTooManyEntries"})(xS||(xS={}));dx(1769,"Extensions");dx(1770,"Preferences");var ro;(function(n){n[n.NONE=0]="NONE",n[n.CRASH=1]="CRASH",n[n.ERROR=2]="ERROR",n[n.USAGE=3]="USAGE"})(ro||(ro={}));var ES;(function(n){n.OFF="off",n.CRASH="crash",n.ERROR="error",n.ON="all"})(ES||(ES={}));class Rx{constructor(e){this.value=e,this.isTrustedTelemetryValue=!0}}class $A{constructor(){this.telemetryLevel=ro.NONE,this.sessionId="someValue.sessionId",this.machineId="someValue.machineId",this.sqmId="someValue.sqmId",this.devDeviceId="someValue.devDeviceId",this.firstSessionDate="someValue.firstSessionDate",this.sendErrorTelemetry=!1}publicLog(){}publicLog2(){}publicLogError(){}publicLogError2(){}setExperimentProperty(){}}new $A;const UA="telemetry",HA={id:UA,name:h(1989,"Telemetry")},BA=new Set(["ssh-remote","dev-container","attached-container","wsl","tunnel","codespaces","amlext"]);function WA(n){if(!n)return"none";const e=wx(n);return BA.has(e)?e:"other"}function VA(n,e){if(!n||!n.includes("/")&&!n.includes("\\"))return n;let t=n;const i=[];for(const a of e)for(;;){const l=a.exec(n);if(!l)break;i.push([l.index,a.lastIndex])}const r=/^[\\\/]?(node_modules|node_modules\.asar)[\\\/]/,s=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-\._]+(\\\\|\\|\/))+[\w-\._]*/g;let o=0;for(t="";;){const a=s.exec(n);if(!a)break;const l=i.some(([c,u])=>a.index<u&&c<s.lastIndex);!r.test(a[0])&&!l&&(t+=n.substring(o,a.index)+"<REDACTED: user-file-path>",o=s.lastIndex)}return o<n.length&&(t+=n.substr(o)),t}function zA(n){if(!n)return n;const e=[{label:"Google API Key",regex:/AIza[A-Za-z0-9_\\\-]{35}/},{label:"Slack Token",regex:/xox[pbar]\-[A-Za-z0-9]/},{label:"GitHub Token",regex:/(gh[psuro]_[a-zA-Z0-9]{36}|github_pat_[a-zA-Z0-9]{22}_[a-zA-Z0-9]{59})/},{label:"Generic Secret",regex:/(key|token|sig|secret|signature|password|passwd|pwd|android:value)[^a-zA-Z0-9]/i},{label:"CLI Credentials",regex:/((login|psexec|(certutil|psexec)\.exe).{1,50}(\s-u(ser(name)?)?\s+.{3,100})?\s-(admin|user|vm|root)?p(ass(word)?)?\s+["']?[^$\-\/\s]|(^|[\s\r\n\\])net(\.exe)?.{1,5}(user\s+|share\s+\/user:| user -? secrets ? set) \s + [^ $\s \/])/},{label:"Microsoft Entra ID",regex:/eyJ(?:0eXAiOiJKV1Qi|hbGci|[a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+\.)/},{label:"Email",regex:/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/}];for(const t of e)if(t.regex.test(n))return`<REDACTED: ${t.label}>`;return n}function SS(n,e){return pu(n,t=>{if(t instanceof Rx||Object.hasOwnProperty.call(t,"isTrustedTelemetryValue"))return t.value;if(typeof t=="string"){let i=t.replaceAll("%20"," ");i=VA(i,e);for(const r of e)i=i.replace(r,"");return i=zA(i),i}})}new Ke("pprice.better-merge");class qA{constructor(){this._generators=new Map,this._cache=new WeakMap}register(e,t){this._generators.set(e,t)}readActivationEvents(e){return this._cache.has(e)||this._cache.set(e,this._readActivationEvents(e)),this._cache.get(e)}createActivationEventsMap(e){const t=Object.create(null);for(const i of e){const r=this.readActivationEvents(i);r.length>0&&(t[Ke.toKey(i.identifier)]=r)}return t}_readActivationEvents(e){if(typeof e.main>"u"&&typeof e.browser>"u")return[];const t=Array.isArray(e.activationEvents)?e.activationEvents.slice(0):[];for(let i=0;i<t.length;i++)t[i]==="onUri"&&(t[i]=`onUri:${Ke.toKey(e.identifier)}`);if(!e.contributes)return t;for(const i in e.contributes){const r=this._generators.get(i);if(!r)continue;const s=e.contributes[i],o=Array.isArray(s)?s:[s];try{r(o,t)}catch(a){Fn(a)}}return t}}const jA=new qA,GA=Object.freeze({identifier:new Ke("nullExtensionDescription"),name:"Null Extension Description",version:"0.0.0",publisher:"vscode",engines:{vscode:""},extensionLocation:y.parse("void:location"),isBuiltin:!1,targetPlatform:Kv.UNDEFINED,isUserBuiltin:!1,isUnderDevelopment:!1,preRelease:!1});class DS{constructor(e){this.dependency=e}}var kS;(function(n){n[n.EagerAutoStart=1]="EagerAutoStart",n[n.EagerManualStart=2]="EagerManualStart",n[n.Lazy=3]="Lazy"})(kS||(kS={}));function vt(n,e){return n.enabledApiProposals?n.enabledApiProposals.includes(e):!1}function $(n,e){var t;if(!vt(n,e))throw new Error(`Extension '${n.identifier.value}' CANNOT use API proposal: ${e}.
Its package.json#enabledApiProposals-property declares: ${((t=n.enabledApiProposals)==null?void 0:t.join(", "))??"[]"} but NOT ${e}.
 The missing proposal MUST be added and you must start in extension development mode or use the following command line switch: --enable-proposed-api ${n.identifier.value}`)}var fw;(function(n){n[n.Normal=0]="Normal",n[n.Immediate=1]="Immediate"})(fw||(fw={}));const QA=De("extensionService");function JA(n){let e=!1;const t=new Map,i=new Map;if(XA(n,u=>{if(n===u)return!0;const d=JSON.stringify(u);if(d.length<30)return!0;const f=t.get(d);if(!f){const p={schemas:[u]};return t.set(d,p),i.set(u,p),!0}return f.schemas.push(u),i.set(u,f),e=!0,!1}),t.clear(),!e)return JSON.stringify(n);let s="$defs";for(;n.hasOwnProperty(s);)s+="_";const o=[];function a(u){return JSON.stringify(u,(d,f)=>{if(f!==u){const p=i.get(f);if(p&&p.schemas.length>1)return p.id||(p.id=`_${o.length}`,o.push(p.schemas[0])),{$ref:`#/${s}/${p.id}`}}return f})}const l=a(n),c=[];for(let u=0;u<o.length;u++)c.push(`"_${u}":${a(o[u])}`);return c.length?`${l.substring(0,l.length-1)},"${s}":{${c.join(",")}}}`:l}function Wl(n){return typeof n=="object"&&n!==null}function XA(n,e){if(!n||typeof n!="object")return;const t=(...l)=>{for(const c of l)Wl(c)&&o.push(c)},i=(...l)=>{for(const c of l)if(Wl(c))for(const u in c){const d=c[u];Wl(d)&&o.push(d)}},r=(...l)=>{for(const c of l)if(Array.isArray(c))for(const u of c)Wl(u)&&o.push(u)},s=l=>{if(Array.isArray(l))for(const c of l)Wl(c)&&o.push(c);else Wl(l)&&o.push(l)},o=[n];let a=o.pop();for(;a;)e(a)&&(t(a.additionalItems,a.additionalProperties,a.not,a.contains,a.propertyNames,a.if,a.then,a.else,a.unevaluatedItems,a.unevaluatedProperties),i(a.definitions,a.$defs,a.properties,a.patternProperties,a.dependencies,a.dependentSchemas),r(a.anyOf,a.allOf,a.oneOf,a.prefixItems),s(a.items)),a=o.pop()}const f_={JSONContribution:"base.contributions.json"};function IS(n){return n.length>0&&n.charAt(n.length-1)==="#"?n.substring(0,n.length-1):n}class YA{constructor(){this.schemasById={},this.schemaAssociations={},this._onDidChangeSchema=new L,this.onDidChangeSchema=this._onDidChangeSchema.event,this._onDidChangeSchemaAssociations=new L,this.onDidChangeSchemaAssociations=this._onDidChangeSchemaAssociations.event}registerSchema(e,t,i){const r=IS(e);this.schemasById[r]=t,this._onDidChangeSchema.fire(e),i&&i.add(Se(()=>{delete this.schemasById[r],this._onDidChangeSchema.fire(e)}))}registerSchemaAssociation(e,t){const i=IS(e);return this.schemaAssociations[i]||(this.schemaAssociations[i]=[]),this.schemaAssociations[i].includes(t)||(this.schemaAssociations[i].push(t),this._onDidChangeSchemaAssociations.fire()),Se(()=>{const r=this.schemaAssociations[i];if(r){const s=r.indexOf(t);s!==-1&&(r.splice(s,1),r.length===0&&delete this.schemaAssociations[i],this._onDidChangeSchemaAssociations.fire())}})}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}getSchemaContributions(){return{schemas:this.schemasById}}getSchemaContent(e){const t=this.schemasById[e];return t?JA(t):void 0}hasSchemaContent(e){return!!this.schemasById[e]}getSchemaAssociations(){return this.schemaAssociations}}const ZA=new YA;Cn.add(f_.JSONContribution,ZA);const KA="vscode://schemas/vscode-product",eR={activeComment:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.activeComment.d.ts"},aiRelatedInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiRelatedInformation.d.ts"},aiTextSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiTextSearchProvider.d.ts",version:2},authLearnMore:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authLearnMore.d.ts"},authSession:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authSession.d.ts"},canonicalUriProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.canonicalUriProvider.d.ts"},chatEditing:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatEditing.d.ts"},chatParticipantAdditions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantAdditions.d.ts"},chatParticipantPrivate:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantPrivate.d.ts",version:6},chatProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatProvider.d.ts"},chatReferenceBinaryData:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatReferenceBinaryData.d.ts"},chatReferenceDiagnostic:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatReferenceDiagnostic.d.ts"},chatStatusItem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatStatusItem.d.ts"},chatTab:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatTab.d.ts"},codeActionAI:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionAI.d.ts"},codeActionRanges:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionRanges.d.ts"},codiconDecoration:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codiconDecoration.d.ts"},commentReactor:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReactor.d.ts"},commentReveal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReveal.d.ts"},commentThreadApplicability:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentThreadApplicability.d.ts"},commentingRangeHint:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentingRangeHint.d.ts"},commentsDraftState:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentsDraftState.d.ts"},contribAccessibilityHelpContent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribAccessibilityHelpContent.d.ts"},contribCommentEditorActionsMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentEditorActionsMenu.d.ts"},contribCommentPeekContext:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentPeekContext.d.ts"},contribCommentThreadAdditionalMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentThreadAdditionalMenu.d.ts"},contribCommentsViewThreadMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentsViewThreadMenus.d.ts"},contribDebugCreateConfiguration:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDebugCreateConfiguration.d.ts"},contribDiffEditorGutterToolBarMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDiffEditorGutterToolBarMenus.d.ts"},contribEditSessions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditSessions.d.ts"},contribEditorContentMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditorContentMenu.d.ts"},contribLabelFormatterWorkspaceTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribLabelFormatterWorkspaceTooltip.d.ts"},contribMenuBarHome:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMenuBarHome.d.ts"},contribMergeEditorMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMergeEditorMenus.d.ts"},contribMultiDiffEditorMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMultiDiffEditorMenus.d.ts"},contribNotebookStaticPreloads:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribNotebookStaticPreloads.d.ts"},contribRemoteHelp:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribRemoteHelp.d.ts"},contribShareMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribShareMenu.d.ts"},contribSourceControlHistoryItemMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryItemMenu.d.ts"},contribSourceControlHistoryTitleMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryTitleMenu.d.ts"},contribSourceControlInputBoxMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlInputBoxMenu.d.ts"},contribSourceControlTitleMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlTitleMenu.d.ts"},contribStatusBarItems:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribStatusBarItems.d.ts"},contribViewContainerTitle:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewContainerTitle.d.ts"},contribViewsRemote:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsRemote.d.ts"},contribViewsWelcome:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsWelcome.d.ts"},customEditorMove:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.customEditorMove.d.ts"},debugVisualization:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.debugVisualization.d.ts"},defaultChatParticipant:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.defaultChatParticipant.d.ts",version:3},diffCommand:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffCommand.d.ts"},diffContentOptions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffContentOptions.d.ts"},documentFiltersExclusive:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.documentFiltersExclusive.d.ts"},editSessionIdentityProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editSessionIdentityProvider.d.ts"},editorHoverVerbosityLevel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorHoverVerbosityLevel.d.ts"},editorInsets:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorInsets.d.ts"},embeddings:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.embeddings.d.ts"},extensionRuntime:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionRuntime.d.ts"},extensionsAny:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionsAny.d.ts"},externalUriOpener:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.externalUriOpener.d.ts"},fileSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProvider.d.ts"},fileSearchProvider2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProvider2.d.ts"},findFiles2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findFiles2.d.ts",version:2},findTextInFiles:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFiles.d.ts"},findTextInFiles2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFiles2.d.ts"},fsChunks:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fsChunks.d.ts"},idToken:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.idToken.d.ts"},inlineCompletionsAdditions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineCompletionsAdditions.d.ts"},inlineEdit:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineEdit.d.ts"},interactive:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactive.d.ts"},interactiveWindow:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactiveWindow.d.ts"},ipc:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.ipc.d.ts"},languageModelCapabilities:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelCapabilities.d.ts"},languageModelDataPart:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelDataPart.d.ts"},languageModelSystem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelSystem.d.ts"},languageModelToolsForAgent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelToolsForAgent.d.ts"},languageStatusText:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageStatusText.d.ts"},mappedEditsProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.mappedEditsProvider.d.ts"},mcpConfigurationProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.mcpConfigurationProvider.d.ts"},multiDocumentHighlightProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.multiDocumentHighlightProvider.d.ts"},nativeWindowHandle:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.nativeWindowHandle.d.ts"},newSymbolNamesProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.newSymbolNamesProvider.d.ts"},notebookCellExecution:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecution.d.ts"},notebookCellExecutionState:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecutionState.d.ts"},notebookControllerAffinityHidden:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookControllerAffinityHidden.d.ts"},notebookDeprecated:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookDeprecated.d.ts"},notebookExecution:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookExecution.d.ts"},notebookKernelSource:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookKernelSource.d.ts"},notebookLiveShare:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookLiveShare.d.ts"},notebookMessaging:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMessaging.d.ts"},notebookMime:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMime.d.ts"},notebookReplDocument:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookReplDocument.d.ts"},notebookVariableProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookVariableProvider.d.ts"},portsAttributes:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.portsAttributes.d.ts"},profileContentHandlers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.profileContentHandlers.d.ts"},quickDiffProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickDiffProvider.d.ts"},quickInputButtonLocation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickInputButtonLocation.d.ts"},quickPickItemTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickItemTooltip.d.ts"},quickPickSortByLabel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickSortByLabel.d.ts"},resolvers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.resolvers.d.ts"},scmActionButton:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmActionButton.d.ts"},scmHistoryProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmHistoryProvider.d.ts"},scmMultiDiffEditor:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmMultiDiffEditor.d.ts"},scmSelectedProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmSelectedProvider.d.ts"},scmTextDocument:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmTextDocument.d.ts"},scmValidation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmValidation.d.ts"},shareProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.shareProvider.d.ts"},speech:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.speech.d.ts"},statusBarItemTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.statusBarItemTooltip.d.ts"},tabInputMultiDiff:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputMultiDiff.d.ts"},tabInputTextMerge:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputTextMerge.d.ts"},taskPresentationGroup:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskPresentationGroup.d.ts"},taskProblemMatcherStatus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskProblemMatcherStatus.d.ts"},telemetry:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.telemetry.d.ts"},terminalCompletionProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalCompletionProvider.d.ts"},terminalDataWriteEvent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDataWriteEvent.d.ts"},terminalDimensions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDimensions.d.ts"},terminalExecuteCommandEvent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalExecuteCommandEvent.d.ts"},terminalQuickFixProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalQuickFixProvider.d.ts"},terminalSelection:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalSelection.d.ts"},terminalShellEnv:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalShellEnv.d.ts"},testObserver:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testObserver.d.ts"},testRelatedCode:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testRelatedCode.d.ts"},textDocumentEncoding:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textDocumentEncoding.d.ts"},textEditorDiffInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textEditorDiffInformation.d.ts"},textSearchComplete2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchComplete2.d.ts"},textSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProvider.d.ts"},textSearchProvider2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProvider2.d.ts"},timeline:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.timeline.d.ts"},tokenInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tokenInformation.d.ts"},treeViewActiveItem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewActiveItem.d.ts"},treeViewMarkdownMessage:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewMarkdownMessage.d.ts"},treeViewReveal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewReveal.d.ts"},tunnelFactory:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnelFactory.d.ts"},tunnels:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnels.d.ts"},valueSelectionInQuickPick:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.valueSelectionInQuickPick.d.ts"},workspaceTrust:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.workspaceTrust.d.ts"}},kg=Object.freeze(eR),Lx=Cn.as(f_.JSONContribution);class Vd{static _toSet(e){const t=new Dl;for(let i=0,r=e.length;i<r;i++)t.add(e[i].description.identifier);return t}static compute(e,t){if(!e||!e.length)return new Vd(t,[]);if(!t||!t.length)return new Vd([],e);const i=this._toSet(e),r=this._toSet(t),s=t.filter(a=>!i.has(a.description.identifier)),o=e.filter(a=>!r.has(a.description.identifier));return new Vd(s,o)}constructor(e,t){this.added=e,this.removed=t}}class tR{constructor(e,t,i){this.name=e,this.defaultExtensionKind=t,this.canHandleResolver=i,this._handler=null,this._users=null,this._delta=null}setHandler(e){if(this._handler!==null)throw new Error("Handler already set!");return this._handler=e,this._handle(),{dispose:()=>{this._handler=null}}}acceptUsers(e){this._delta=Vd.compute(this._users,e),this._users=e,this._handle()}_handle(){if(!(this._handler===null||this._users===null||this._delta===null))try{this._handler(this._users,this._delta)}catch(e){Fn(e)}}}const nR={type:"string",enum:["ui","workspace"],enumDescriptions:[h(12178,"UI extension kind. In a remote window, such extensions are enabled only when available on the local machine."),h(12179,"Workspace extension kind. In a remote window, such extensions are enabled only when available on the remote.")]},kC="vscode://schemas/vscode-extensions",pw={properties:{engines:{type:"object",description:h(12180,"Engine compatibility."),properties:{vscode:{type:"string",description:h(12181,"For VS Code extensions, specifies the VS Code version that the extension is compatible with. Cannot be *. For example: ^0.10.5 indicates compatibility with a minimum VS Code version of 0.10.5."),default:"^1.22.0"}}},publisher:{description:h(12182,"The publisher of the VS Code extension."),type:"string"},displayName:{description:h(12183,"The display name for the extension used in the VS Code gallery."),type:"string"},categories:{description:h(12184,"The categories used by the VS Code gallery to categorize the extension."),type:"array",uniqueItems:!0,items:{oneOf:[{type:"string",enum:tT},{type:"string",const:"Languages",deprecationMessage:h(12185,"Use 'Programming  Languages' instead")}]}},galleryBanner:{type:"object",description:h(12186,"Banner used in the VS Code marketplace."),properties:{color:{description:h(12187,"The banner color on the VS Code marketplace page header."),type:"string"},theme:{description:h(12188,"The color theme for the font used in the banner."),type:"string",enum:["dark","light"]}}},contributes:{description:h(12189,"All contributions of the VS Code extension represented by this package."),type:"object",properties:{},default:{}},preview:{type:"boolean",description:h(12190,"Sets the extension to be flagged as a Preview in the Marketplace.")},enableProposedApi:{type:"boolean",deprecationMessage:h(12191,"Use `enabledApiProposals` instead.")},enabledApiProposals:{markdownDescription:h(12192,"Enable API proposals to try them out. Only valid **during development**. Extensions **cannot be published** with this property. For more details visit: https://code.visualstudio.com/api/advanced-topics/using-proposed-api"),type:"array",uniqueItems:!0,items:{type:"string",enum:Object.keys(kg).map(n=>n),markdownEnumDescriptions:Object.values(kg).map(n=>n.proposal)}},api:{markdownDescription:h(12193,"Describe the API provided by this extension. For more details visit: https://code.visualstudio.com/api/advanced-topics/remote-extensions#handling-dependencies-with-remote-extensions"),type:"string",enum:["none"],enumDescriptions:[h(12194,"Give up entirely the ability to export any APIs. This allows other extensions that depend on this extension to run in a separate extension host process or in a remote machine.")]},activationEvents:{description:h(12195,"Activation events for the VS Code extension."),type:"array",items:{type:"string",defaultSnippets:[{label:"onWebviewPanel",description:h(12196,"An activation event emmited when a webview is loaded of a certain viewType"),body:"onWebviewPanel:viewType"},{label:"onLanguage",description:h(12197,"An activation event emitted whenever a file that resolves to the specified language gets opened."),body:"onLanguage:${1:languageId}"},{label:"onCommand",description:h(12198,"An activation event emitted whenever the specified command gets invoked."),body:"onCommand:${2:commandId}"},{label:"onDebug",description:h(12199,"An activation event emitted whenever a user is about to start debugging or about to setup debug configurations."),body:"onDebug"},{label:"onDebugInitialConfigurations",description:h(12200,'An activation event emitted whenever a "launch.json" needs to be created (and all provideDebugConfigurations methods need to be called).'),body:"onDebugInitialConfigurations"},{label:"onDebugDynamicConfigurations",description:h(12201,'An activation event emitted whenever a list of all debug configurations needs to be created (and all provideDebugConfigurations methods for the "dynamic" scope need to be called).'),body:"onDebugDynamicConfigurations"},{label:"onDebugResolve",description:h(12202,"An activation event emitted whenever a debug session with the specific type is about to be launched (and a corresponding resolveDebugConfiguration method needs to be called)."),body:"onDebugResolve:${6:type}"},{label:"onDebugAdapterProtocolTracker",description:h(12203,"An activation event emitted whenever a debug session with the specific type is about to be launched and a debug protocol tracker might be needed."),body:"onDebugAdapterProtocolTracker:${6:type}"},{label:"workspaceContains",description:h(12204,"An activation event emitted whenever a folder is opened that contains at least a file matching the specified glob pattern."),body:"workspaceContains:${4:filePattern}"},{label:"onStartupFinished",description:h(12205,"An activation event emitted after the start-up finished (after all `*` activated extensions have finished activating)."),body:"onStartupFinished"},{label:"onTaskType",description:h(12206,"An activation event emitted whenever tasks of a certain type need to be listed or resolved."),body:"onTaskType:${1:taskType}"},{label:"onFileSystem",description:h(12207,"An activation event emitted whenever a file or folder is accessed with the given scheme."),body:"onFileSystem:${1:scheme}"},{label:"onEditSession",description:h(12208,"An activation event emitted whenever an edit session is accessed with the given scheme."),body:"onEditSession:${1:scheme}"},{label:"onSearch",description:h(12209,"An activation event emitted whenever a search is started in the folder with the given scheme."),body:"onSearch:${7:scheme}"},{label:"onView",body:"onView:${5:viewId}",description:h(12210,"An activation event emitted whenever the specified view is expanded.")},{label:"onUri",body:"onUri",description:h(12211,"An activation event emitted whenever a system-wide Uri directed towards this extension is open.")},{label:"onOpenExternalUri",body:"onOpenExternalUri",description:h(12212,"An activation event emitted whenever a external uri (such as an http or https link) is being opened.")},{label:"onCustomEditor",body:"onCustomEditor:${9:viewType}",description:h(12213,"An activation event emitted whenever the specified custom editor becomes visible.")},{label:"onNotebook",body:"onNotebook:${1:type}",description:h(12214,"An activation event emitted whenever the specified notebook document is opened.")},{label:"onAuthenticationRequest",body:"onAuthenticationRequest:${11:authenticationProviderId}",description:h(12215,"An activation event emitted whenever sessions are requested from the specified authentication provider.")},{label:"onRenderer",description:h(12216,"An activation event emitted whenever a notebook output renderer is used."),body:"onRenderer:${11:rendererId}"},{label:"onTerminalProfile",body:"onTerminalProfile:${1:terminalId}",description:h(12217,"An activation event emitted when a specific terminal profile is launched.")},{label:"onTerminalQuickFixRequest",body:"onTerminalQuickFixRequest:${1:quickFixId}",description:h(12218,"An activation event emitted when a command matches the selector associated with this ID")},{label:"onWalkthrough",body:"onWalkthrough:${1:walkthroughID}",description:h(12219,"An activation event emitted when a specified walkthrough is opened.")},{label:"onIssueReporterOpened",body:"onIssueReporterOpened",description:h(12220,"An activation event emitted when the issue reporter is opened.")},{label:"onChatParticipant",body:"onChatParticipant:${1:participantId}",description:h(12221,"An activation event emitted when the specified chat participant is invoked.")},{label:"onLanguageModelTool",body:"onLanguageModelTool:${1:toolId}",description:h(12222,"An activation event emitted when the specified language model tool is invoked.")},{label:"onTerminalCompletionsRequested",body:"onTerminalCompletionsRequested",description:h(12223,"An activation event emitted when terminal completions are requested.")},{label:"onMcpCollection",description:h(12224,"An activation event emitted whenver a tool from the MCP server is requested."),body:"onMcpCollection:${2:collectionId}"},{label:"*",description:h(12225,"An activation event emitted on VS Code startup. To ensure a great end user experience, please use this activation event in your extension only when no other activation events combination works in your use-case."),body:"*"}]}},badges:{type:"array",description:h(12226,"Array of badges to display in the sidebar of the Marketplace's extension page."),items:{type:"object",required:["url","href","description"],properties:{url:{type:"string",description:h(12227,"Badge image URL.")},href:{type:"string",description:h(12228,"Badge link.")},description:{type:"string",description:h(12229,"Badge description.")}}}},markdown:{type:"string",description:h(12230,"Controls the Markdown rendering engine used in the Marketplace. Either github (default) or standard."),enum:["github","standard"],default:"github"},qna:{default:"marketplace",description:h(12231,"Controls the Q&A link in the Marketplace. Set to marketplace to enable the default Marketplace Q & A site. Set to a string to provide the URL of a custom Q & A site. Set to false to disable Q & A altogether."),anyOf:[{type:["string","boolean"],enum:["marketplace",!1]},{type:"string"}]},extensionDependencies:{description:h(12232,"Dependencies to other extensions. The identifier of an extension is always ${publisher}.${name}. For example: vscode.csharp."),type:"array",uniqueItems:!0,items:{type:"string",pattern:fS}},extensionPack:{description:h(12233,"A set of extensions that can be installed together. The identifier of an extension is always ${publisher}.${name}. For example: vscode.csharp."),type:"array",uniqueItems:!0,items:{type:"string",pattern:fS}},extensionKind:{description:h(12234,"Define the kind of an extension. `ui` extensions are installed and run on the local machine while `workspace` extensions run on the remote."),type:"array",items:nR,default:["workspace"],defaultSnippets:[{body:["ui"],description:h(12235,"Define an extension which can run only on the local machine when connected to remote window.")},{body:["workspace"],description:h(12236,"Define an extension which can run only on the remote machine when connected remote window.")},{body:["ui","workspace"],description:h(12237,"Define an extension which can run on either side, with a preference towards running on the local machine.")},{body:["workspace","ui"],description:h(12238,"Define an extension which can run on either side, with a preference towards running on the remote machine.")},{body:[],description:h(12239,"Define an extension which cannot run in a remote context, neither on the local, nor on the remote machine.")}]},capabilities:{description:h(12240,"Declare the set of supported capabilities by the extension."),type:"object",properties:{virtualWorkspaces:{description:h(12241,"Declares whether the extension should be enabled in virtual workspaces. A virtual workspace is a workspace which is not backed by any on-disk resources. When false, this extension will be automatically disabled in virtual workspaces. Default is true."),type:["boolean","object"],defaultSnippets:[{label:"limited",body:{supported:"${1:limited}",description:"${2}"}},{label:"false",body:{supported:!1,description:"${2}"}}],default:(!0).valueOf,properties:{supported:{markdownDescription:h(12242,"Declares the level of support for virtual workspaces by the extension."),type:["string","boolean"],enum:["limited",!0,!1],enumDescriptions:[h(12243,"The extension will be enabled in virtual workspaces with some functionality disabled."),h(12244,"The extension will be enabled in virtual workspaces with all functionality enabled."),h(12245,"The extension will not be enabled in virtual workspaces.")]},description:{type:"string",markdownDescription:h(12246,"A description of how virtual workspaces affects the extensions behavior and why it is needed. This only applies when `supported` is not `true`.")}}},untrustedWorkspaces:{description:h(12247,"Declares how the extension should be handled in untrusted workspaces."),type:"object",required:["supported"],defaultSnippets:[{body:{supported:"${1:limited}",description:"${2}"}}],properties:{supported:{markdownDescription:h(12248,"Declares the level of support for untrusted workspaces by the extension."),type:["string","boolean"],enum:["limited",!0,!1],enumDescriptions:[h(12249,"The extension will be enabled in untrusted workspaces with some functionality disabled."),h(12250,"The extension will be enabled in untrusted workspaces with all functionality enabled."),h(12251,"The extension will not be enabled in untrusted workspaces.")]},restrictedConfigurations:{description:h(12252,"A list of configuration keys contributed by the extension that should not use workspace values in untrusted workspaces."),type:"array",items:{type:"string"}},description:{type:"string",markdownDescription:h(12253,"A description of how workspace trust affects the extensions behavior and why it is needed. This only applies when `supported` is not `true`.")}}}}},sponsor:{description:h(12254,"Specify the location from where users can sponsor your extension."),type:"object",defaultSnippets:[{body:{url:"${1:https:}"}}],properties:{url:{description:h(12255,"URL from where users can sponsor your extension. It must be a valid URL with a HTTP or HTTPS protocol. Example value: https://github.com/sponsors/nvaccess"),type:"string"}}},scripts:{type:"object",properties:{"vscode:prepublish":{description:h(12256,"Script executed before the package is published as a VS Code extension."),type:"string"},"vscode:uninstall":{description:h(12257,"Uninstall hook for VS Code extension. Script that gets executed when the extension is completely uninstalled from VS Code which is when VS Code is restarted (shutdown and start) after the extension is uninstalled. Only Node scripts are supported."),type:"string"}}},icon:{type:"string",description:h(12258,"The path to a 128x128 pixel icon.")},l10n:{type:"string",description:h(12259,"The relative path to a folder containing localization (bundle.l10n.*.json) files. Must be specified if you are using the vscode.l10n API.")},pricing:{type:"string",markdownDescription:h(12260,"The pricing information for the extension. Can be Free (default) or Trial. For more details visit: https://code.visualstudio.com/api/working-with-extensions/publishing-extension#extension-pricing-label"),enum:["Free","Trial"],default:"Free"}}};class iR{constructor(){this._extensionPoints=new Map}registerExtensionPoint(e){if(this._extensionPoints.has(e.extensionPoint))throw new Error("Duplicate extension point: "+e.extensionPoint);const t=new tR(e.extensionPoint,e.defaultExtensionKind,e.canHandleResolver);return this._extensionPoints.set(e.extensionPoint,t),e.activationEventsGenerator&&jA.register(e.extensionPoint,e.activationEventsGenerator),pw.properties.contributes.properties[e.extensionPoint]=e.jsonSchema,Lx.registerSchema(kC,pw),t}getExtensionPoints(){return Array.from(this._extensionPoints.values())}}const IC={ExtensionsRegistry:"ExtensionsRegistry"};Cn.add(IC.ExtensionsRegistry,new iR);const CC=Cn.as(IC.ExtensionsRegistry);Lx.registerSchema(kC,pw);Lx.registerSchema(KA,{properties:{extensionEnabledApiProposals:{description:h(12261,"API proposals that the respective extensions can freely use."),type:"object",properties:{},additionalProperties:{anyOf:[{type:"array",uniqueItems:!0,items:{type:"string",enum:Object.keys(kg),markdownEnumDescriptions:Object.values(kg).map(n=>n.proposal)}}]}}}});new C("isMac",Pi,h(1729,"Whether the operating system is macOS"));new C("isLinux",Fs,h(1730,"Whether the operating system is Linux"));new C("isWindows",ni,h(1731,"Whether the operating system is Windows"));const rR=new C("isWeb",Bf,h(1732,"Whether the platform is a web browser"));new C("isMacNative",Pi&&!Bf,h(1733,"Whether the operating system is macOS on a non-browser platform"));new C("isIOS",TP,h(1734,"Whether the operating system is iOS"));new C("isMobile",AP,h(1735,"Whether the platform is a mobile web browser"));new C("isDevelopment",!1,!0);new C("productQualityType","",h(1736,"Quality type of VS Code"));const sR="inputFocus";new C(sR,!1,h(1737,"Whether keyboard focus is inside an input box"));const oR=De("languageService"),PC=De("fileService"),aR=De("modelService");var ji;new C("workbenchState",void 0,{type:"string",description:h(3757,"The kind of workspace opened in the window, either 'empty' (no workspace), 'folder' (single folder) or 'workspace' (multi-root workspace)")});new C("workspaceFolderCount",0,h(3758,"The number of root folders in the workspace"));new C("openFolderWorkspaceSupport",!0,!0);new C("enterMultiRootWorkspaceSupport",!0,!0);new C("emptyWorkspaceSupport",!0,!0);new C("dirtyWorkingCopies",!1,h(3759,"Whether there are any working copies with unsaved changes"));const lR=new C("remoteName","",h(3760,"The name of the remote the window is connected to or an empty string if not connected to any remote"));new C("virtualWorkspace","",h(3761,"The scheme of the current workspace is from a virtual file system or an empty string."));new C("temporaryWorkspace",!1,h(3762,"The scheme of the current workspace is from a temporary file system."));new C("isFullscreen",!1,h(3763,"Whether the main window is in fullscreen mode"));new C("isAuxiliaryWindowFocusedContext",!1,h(3764,"Whether an auxiliary window is focused"));new C("hasWebFileSystemAccess",!1,!0);new C("embedderIdentifier",void 0,h(3765,"The identifier of the embedder according to the product service, if one is defined"));new C("activeEditorIsDirty",!1,h(3766,"Whether the active editor has unsaved changes"));new C("activeEditorIsNotPreview",!1,h(3767,"Whether the active editor is not in preview mode"));new C("activeEditorIsFirstInGroup",!1,h(3768,"Whether the active editor is the first one in its group"));new C("activeEditorIsLastInGroup",!1,h(3769,"Whether the active editor is the last one in its group"));new C("activeEditorIsPinned",!1,h(3770,"Whether the active editor is pinned"));new C("activeEditorIsReadonly",!1,h(3771,"Whether the active editor is read-only"));new C("activeCompareEditorCanSwap",!1,h(3772,"Whether the active compare editor can swap sides"));new C("activeEditorCanToggleReadonly",!0,h(3773,"Whether the active editor can toggle between being read-only or writeable"));new C("activeEditorCanRevert",!1,h(3774,"Whether the active editor can revert"));new C("activeEditorCanSplitInGroup",!0);new C("activeEditor",null,{type:"string",description:h(3775,"The identifier of the active editor")});new C("activeEditorAvailableEditorIds","",h(3776,"The available editor identifiers that are usable for the active editor"));new C("textCompareEditorVisible",!1,h(3777,"Whether a text compare editor is visible"));new C("textCompareEditorActive",!1,h(3778,"Whether a text compare editor is active"));new C("sideBySideEditorActive",!1,h(3779,"Whether a side by side editor is active"));new C("groupEditorsCount",0,h(3780,"The number of opened editor groups"));new C("activeEditorGroupEmpty",!1,h(3781,"Whether the active editor group is empty"));new C("activeEditorGroupIndex",0,h(3782,"The index of the active editor group"));new C("activeEditorGroupLast",!1,h(3783,"Whether the active editor group is the last group"));new C("activeEditorGroupLocked",!1,h(3784,"Whether the active editor group is locked"));new C("multipleEditorGroups",!1,h(3785,"Whether there are multiple editor groups opened"));new C("multipleEditorsSelectedInGroup",!1,h(3786,"Whether multiple editors have been selected in an editor group"));new C("twoEditorsSelectedInGroup",!1,h(3787,"Whether exactly two editors have been selected in an editor group"));new C("SelectedEditorsInGroupFileOrUntitledResourceContextKey",!0,h(3788,"Whether all selected editors in a group have a file or untitled resource associated"));new C("editorPartMultipleEditorGroups",!1,h(3789,"Whether there are multiple editor groups opened in an editor part"));new C("editorPartMaximizedEditorGroup",!1,h(3790,"Editor Part has a maximized group"));new C("isAuxiliaryEditorPart",!1,h(3791,"Editor Part is in an auxiliary window"));new C("editorIsOpen",!1,h(3792,"Whether an editor is open"));new C("inZenMode",!1,h(3793,"Whether Zen mode is enabled"));new C("isCenteredLayout",!1,h(3794,"Whether centered layout is enabled for the main editor"));new C("splitEditorsVertically",!1,h(3795,"Whether editors split vertically"));new C("mainEditorAreaVisible",!0,h(3796,"Whether the editor area in the main window is visible"));new C("editorTabsVisible",!0,h(3797,"Whether editor tabs are visible"));new C("sideBarVisible",!1,h(3798,"Whether the sidebar is visible"));new C("sideBarFocus",!1,h(3799,"Whether the sidebar has keyboard focus"));new C("activeViewlet","",h(3800,"The identifier of the active viewlet"));new C("statusBarFocused",!1,h(3801,"Whether the status bar has keyboard focus"));new C("titleBarStyle","custom",h(3802,"Style of the window title bar"));new C("titleBarVisible",!1,h(3803,"Whether the title bar is visible"));new C("bannerFocused",!1,h(3804,"Whether the banner has keyboard focus"));new C("notificationFocus",!0,h(3805,"Whether a notification has keyboard focus"));new C("notificationCenterVisible",!1,h(3806,"Whether the notifications center is visible"));new C("notificationToastsVisible",!1,h(3807,"Whether a notification toast is visible"));new C("activeAuxiliary","",h(3808,"The identifier of the active auxiliary panel"));new C("auxiliaryBarFocus",!1,h(3809,"Whether the auxiliary bar has keyboard focus"));new C("auxiliaryBarVisible",!1,h(3810,"Whether the auxiliary bar is visible"));new C("activePanel","",h(3811,"The identifier of the active panel"));new C("panelFocus",!1,h(3812,"Whether the panel has keyboard focus"));new C("panelPosition","bottom",h(3813,"The position of the panel, always 'bottom'"));new C("panelAlignment","center",h(3814,"The alignment of the panel, either 'center', 'left', 'right' or 'justify'"));new C("panelVisible",!1,h(3815,"Whether the panel is visible"));new C("panelMaximized",!1,h(3816,"Whether the panel is maximized"));new C("focusedView","",h(3817,"The identifier of the view that has keyboard focus"));var Kn;let CS=(Kn=class{constructor(e,t,i,r){this._contextKeyService=e,this._fileService=t,this._languageService=i,this._modelService=r,this._disposables=new Ie,this._schemeKey=ji.Scheme.bindTo(this._contextKeyService),this._filenameKey=ji.Filename.bindTo(this._contextKeyService),this._dirnameKey=ji.Dirname.bindTo(this._contextKeyService),this._pathKey=ji.Path.bindTo(this._contextKeyService),this._langIdKey=ji.LangId.bindTo(this._contextKeyService),this._resourceKey=ji.Resource.bindTo(this._contextKeyService),this._extensionKey=ji.Extension.bindTo(this._contextKeyService),this._hasResource=ji.HasResource.bindTo(this._contextKeyService),this._isFileSystemResource=ji.IsFileSystemResource.bindTo(this._contextKeyService),this._disposables.add(t.onDidChangeFileSystemProviderRegistrations(()=>{const s=this.get();this._isFileSystemResource.set(!!(s&&t.hasProvider(s)))})),this._disposables.add(r.onModelAdded(s=>{Dc(s.uri,this.get())&&this._setLangId()})),this._disposables.add(r.onModelLanguageChanged(s=>{Dc(s.model.uri,this.get())&&this._setLangId()}))}dispose(){this._disposables.dispose()}_setLangId(){var i;const e=this.get();if(!e){this._langIdKey.set(null);return}const t=((i=this._modelService.getModel(e))==null?void 0:i.getLanguageId())??this._languageService.guessLanguageIdByFilepathOrFirstLine(e);this._langIdKey.set(t)}set(e){e=e??void 0,!Dc(this._value,e)&&(this._value=e,this._contextKeyService.bufferChangeEvents(()=>{this._resourceKey.set(e?e.toString():null),this._schemeKey.set(e?e.scheme:null),this._filenameKey.set(e?Lo(e):null),this._dirnameKey.set(e?this.uriToPath(r_(e)):null),this._pathKey.set(e?this.uriToPath(e):null),this._setLangId(),this._extensionKey.set(e?P9(e):null),this._hasResource.set(!!e),this._isFileSystemResource.set(e?this._fileService.hasProvider(e):!1)}))}uriToPath(e){return e.scheme===oe.file?e.fsPath:e.path}reset(){this._value=void 0,this._contextKeyService.bufferChangeEvents(()=>{this._resourceKey.reset(),this._schemeKey.reset(),this._filenameKey.reset(),this._dirnameKey.reset(),this._pathKey.reset(),this._langIdKey.reset(),this._extensionKey.reset(),this._hasResource.reset(),this._isFileSystemResource.reset()})}get(){return this._value}},ji=Kn,Kn.Scheme=new C("resourceScheme",void 0,{type:"string",description:h(3818,"The scheme of the resource")}),Kn.Filename=new C("resourceFilename",void 0,{type:"string",description:h(3819,"The file name of the resource")}),Kn.Dirname=new C("resourceDirname",void 0,{type:"string",description:h(3820,"The folder name the resource is contained in")}),Kn.Path=new C("resourcePath",void 0,{type:"string",description:h(3821,"The full path of the resource")}),Kn.LangId=new C("resourceLangId",void 0,{type:"string",description:h(3822,"The language identifier of the resource")}),Kn.Resource=new C("resource",void 0,{type:"URI",description:h(3823,"The full value of the resource including scheme and path")}),Kn.Extension=new C("resourceExtname",void 0,{type:"string",description:h(3824,"The extension name of the resource")}),Kn.HasResource=new C("resourceSet",void 0,{type:"boolean",description:h(3825,"Whether a resource is present or not")}),Kn.IsFileSystemResource=new C("isFileSystemResource",void 0,{type:"boolean",description:h(3826,"Whether the resource is backed by a file system provider")}),Kn);CS=ji=V([F(0,DC),F(1,PC),F(2,oR),F(3,aR)],CS);var gw;(function(n){n.UnifiedChatView="chat.unifiedChatView",n.UseFileStorage="chat.useFileStorage",n.AgentEnabled="chat.agent.enabled",n.Edits2Enabled="chat.edits2.enabled",n.ExtensionToolsEnabled="chat.extensionTools.enabled"})(gw||(gw={}));var bh;(function(n){n.Ask="ask",n.Edit="edit",n.Agent="agent"})(bh||(bh={}));var En;(function(n){n.Panel="panel",n.Terminal="terminal",n.Notebook="notebook",n.Editor="editor",n.EditingSession="editing-session"})(En||(En={}));(function(n){function e(t){switch(t){case"panel":return n.Panel;case"terminal":return n.Terminal;case"notebook":return n.Notebook;case"editor":return n.Editor;case"editing-session":return n.EditingSession}return n.Panel}n.fromRaw=e})(En||(En={}));var hs;(function(n){n.responseVote=new C("chatSessionResponseVote","",{type:"string",description:h(4934,"When the response has been voted up, is set to 'up'. When voted down, is set to 'down'. Otherwise an empty string.")}),n.responseDetectedAgentCommand=new C("chatSessionResponseDetectedAgentOrCommand",!1,{type:"boolean",description:h(4935,"When the agent or command was automatically detected")}),n.responseSupportsIssueReporting=new C("chatResponseSupportsIssueReporting",!1,{type:"boolean",description:h(4936,"True when the current chat response supports issue reporting.")}),n.responseIsFiltered=new C("chatSessionResponseFiltered",!1,{type:"boolean",description:h(4937,"True when the chat response was filtered out by the server.")}),n.responseHasError=new C("chatSessionResponseError",!1,{type:"boolean",description:h(4938,"True when the chat response resulted in an error.")}),n.requestInProgress=new C("chatSessionRequestInProgress",!1,{type:"boolean",description:h(4939,"True when the current request is still in progress.")}),n.isRequestPaused=new C("chatRequestIsPaused",!1,{type:"boolean",description:h(4940,"True when the current request is paused.")}),n.canRequestBePaused=new C("chatCanRequestBePaused",!1,{type:"boolean",description:h(4941,"True when the current request can be paused.")}),n.isResponse=new C("chatResponse",!1,{type:"boolean",description:h(4942,"The chat item is a response.")}),n.isRequest=new C("chatRequest",!1,{type:"boolean",description:h(4943,"The chat item is a request")}),n.itemId=new C("chatItemId","",{type:"string",description:h(4944,"The id of the chat item.")}),n.lastItemId=new C("chatLastItemId",[],{type:"string",description:h(4945,"The id of the last chat item.")}),n.editApplied=new C("chatEditApplied",!1,{type:"boolean",description:h(4946,"True when the chat text edits have been applied.")}),n.inputHasText=new C("chatInputHasText",!1,{type:"boolean",description:h(4947,"True when the chat input has text.")}),n.inputHasFocus=new C("chatInputHasFocus",!1,{type:"boolean",description:h(4948,"True when the chat input has focus.")}),n.inChatInput=new C("inChatInput",!1,{type:"boolean",description:h(4949,"True when focus is in the chat input, false otherwise.")}),n.inChatSession=new C("inChat",!1,{type:"boolean",description:h(4950,"True when focus is in the chat widget, false otherwise.")}),n.inUnifiedChat=new C("inUnifiedChat",!1,{type:"boolean",description:h(4951,"True when focus is in the unified chat widget, false otherwise.")}),n.instructionsAttached=new C("chatInstructionsAttached",!1,{type:"boolean",description:h(4952,"True when the chat has a prompt instructions attached.")}),n.chatMode=new C("chatMode",bh.Ask,{type:"string",description:h(4953,"The current chat mode.")}),n.supported=mt.or(rR.toNegated(),lR.notEqualsTo("")),n.enabled=new C("chatIsEnabled",!1,{type:"boolean",description:h(4954,"True when chat is enabled because a default chat participant is activated with an implementation.")}),n.panelParticipantRegistered=new C("chatPanelParticipantRegistered",!1,{type:"boolean",description:h(4955,"True when a default chat participant is registered for the panel.")}),n.editingParticipantRegistered=new C("chatEditingParticipantRegistered",!1,{type:"boolean",description:h(4956,"True when a default chat participant is registered for editing.")}),n.chatEditingCanUndo=new C("chatEditingCanUndo",!1,{type:"boolean",description:h(4957,"True when it is possible to undo an interaction in the editing panel.")}),n.chatEditingCanRedo=new C("chatEditingCanRedo",!1,{type:"boolean",description:h(4958,"True when it is possible to redo an interaction in the editing panel.")}),n.extensionInvalid=new C("chatExtensionInvalid",!1,{type:"boolean",description:h(4959,"True when the installed chat extension is invalid and needs to be updated.")}),n.inputCursorAtTop=new C("chatCursorAtTop",!1),n.inputHasAgent=new C("chatInputHasAgent",!1),n.location=new C("chatLocation",void 0),n.inQuickChat=new C("quickChatHasFocus",!1,{type:"boolean",description:h(4960,"True when the quick chat UI has focus, false otherwise.")}),n.hasFileAttachments=new C("chatHasFileAttachments",!1,{type:"boolean",description:h(4961,"True when the chat has file attachments.")}),n.languageModelsAreUserSelectable=new C("chatModelsAreUserSelectable",!1,{type:"boolean",description:h(4962,"True when the chat model can be selected manually by the user.")}),n.Setup={hidden:new C("chatSetupHidden",!1,!0),installed:new C("chatSetupInstalled",!1,!0),fromDialog:mt.has("config.chat.setupFromDialog")},n.Entitlement={signedOut:new C("chatSetupSignedOut",!1,!0),canSignUp:new C("chatPlanCanSignUp",!1,!0),limited:new C("chatPlanLimited",!1,!0),pro:new C("chatPlanPro",!1,!0)},n.SetupViewKeys=new Set([n.Setup.hidden.key,n.Setup.installed.key,n.Entitlement.signedOut.key,n.Entitlement.canSignUp.key,...n.Setup.fromDialog.keys()]),n.SetupViewCondition=mt.and(n.Setup.fromDialog.negate(),mt.or(mt.and(n.Setup.hidden.negate(),n.Setup.installed.negate()),mt.and(n.Entitlement.canSignUp,n.Setup.installed),mt.and(n.Entitlement.signedOut,n.Setup.installed))),n.chatQuotaExceeded=new C("chatQuotaExceeded",!1,!0),n.completionsQuotaExceeded=new C("completionsQuotaExceeded",!1,!0),n.Editing={hasToolsAgent:new C("chatHasToolsAgent",!1,{type:"boolean",description:h(4963,"True when a tools agent is registered.")}),agentModeDisallowed:new C("chatAgentModeDisallowed",void 0,{type:"boolean",description:h(4964,"True when agent mode is not allowed.")}),hasToolConfirmation:new C("chatHasToolConfirmation",!1,{type:"boolean",description:h(4965,"True when a tool confirmation is present.")})},n.Tools={toolsCount:new C("toolsCount",0,{type:"number",description:h(4966,"The count of tools available in the chat.")})}})(hs||(hs={}));var PS;(function(n){n.unifiedChatEnabled=mt.has(`config.${gw.UnifiedChatView}`),n.inEditsOrUnified=mt.or(hs.location.isEqualTo(En.EditingSession),hs.inUnifiedChat),n.inNonUnifiedPanel=mt.and(hs.location.isEqualTo(En.Panel),hs.inUnifiedChat.negate()),n.inEditingMode=mt.or(hs.chatMode.isEqualTo(bh.Edit),hs.chatMode.isEqualTo(bh.Agent))})(PS||(PS={}));var as;(function(n){n[n.System=0]="System",n[n.User=1]="User",n[n.Assistant=2]="Assistant"})(as||(as={}));var TS;(function(n){n.PNG="image/png",n.JPEG="image/jpeg",n.GIF="image/gif",n.WEBP="image/webp",n.BMP="image/bmp"})(TS||(TS={}));var AS;(function(n){n.Low="low",n.High="high"})(AS||(AS={}));const RS={type:"object",properties:{vendor:{type:"string",description:h(4991,"A globally unique vendor of language models.")}}},cR=CC.registerExtensionPoint({extensionPoint:"languageModels",jsonSchema:{description:h(4992,"Contribute language models of a specific vendor."),oneOf:[RS,{type:"array",items:RS}]},activationEventsGenerator:(n,e)=>{for(const t of n)e.push(`onLanguageModelChat:${t.vendor}`)}});let LS=class{constructor(e,t,i){this._extensionService=e,this._logService=t,this._contextKeyService=i,this._store=new Ie,this._providers=new Map,this._vendors=new Set,this._onDidChangeProviders=this._store.add(new L),this.onDidChangeLanguageModels=this._onDidChangeProviders.event,this._hasUserSelectableModels=hs.languageModelsAreUserSelectable.bindTo(this._contextKeyService),this._store.add(cR.setHandler(r=>{this._vendors.clear();for(const o of r){if(!vt(o.description,"chatProvider")){o.collector.error(h(4993,"This contribution point requires the 'chatProvider' proposal."));continue}for(const a of zn.wrap(o.value)){if(this._vendors.has(a.vendor)){o.collector.error(h(4994,"The vendor '{0}' is already registered and cannot be registered twice",a.vendor));continue}if(mh(a.vendor)){o.collector.error(h(4995,"The vendor field cannot be empty."));continue}if(a.vendor.trim()!==a.vendor){o.collector.error(h(4996,"The vendor field cannot start or end with whitespace."));continue}this._vendors.add(a.vendor)}}const s=[];for(const[o,a]of this._providers)this._vendors.has(a.metadata.vendor)||(this._providers.delete(o),s.push(o));s.length>0&&this._onDidChangeProviders.fire({removed:s})}))}dispose(){this._store.dispose(),this._providers.clear()}getLanguageModelIds(){return Array.from(this._providers.keys())}lookupLanguageModel(e){var t;return(t=this._providers.get(e))==null?void 0:t.metadata}async selectLanguageModels(e){if(e.vendor)await this._extensionService.activateByEvent(`onLanguageModelChat:${e.vendor}}`);else{const i=Array.from(this._vendors).map(r=>this._extensionService.activateByEvent(`onLanguageModelChat:${r}`));await Promise.all(i)}const t=[];for(const[i,r]of this._providers)(e.vendor===void 0||r.metadata.vendor===e.vendor)&&(e.family===void 0||r.metadata.family===e.family)&&(e.version===void 0||r.metadata.version===e.version)&&(e.id===void 0||r.metadata.id===e.id)&&(!r.metadata.targetExtensions||r.metadata.targetExtensions.some(s=>Ke.equals(s,e.extension)))&&t.push(i);return this._logService.trace("[LM] selected language models",e,t),t}registerLanguageModelChat(e,t){if(this._logService.trace("[LM] registering language model chat",e,t.metadata),!this._vendors.has(t.metadata.vendor))throw new Error(`Chat response provider uses UNKNOWN vendor ${t.metadata.vendor}.`);if(this._providers.has(e))throw new Error(`Chat response provider with identifier ${e} is already registered.`);return this._providers.set(e,t),this._onDidChangeProviders.fire({added:[{identifier:e,metadata:t.metadata}]}),this.updateUserSelectableModelsContext(),Se(()=>{this.updateUserSelectableModelsContext(),this._providers.delete(e)&&(this._onDidChangeProviders.fire({removed:[e]}),this._logService.trace("[LM] UNregistered language model chat",e,t.metadata))})}updateUserSelectableModelsContext(){const e=Array.from(this._providers.values()).some(i=>i.metadata.isUserSelectable&&!i.metadata.isDefault),t=Array.from(this._providers.values()).some(i=>i.metadata.isDefault);this._hasUserSelectableModels.set(e&&t)}async sendChatRequest(e,t,i,r,s){const o=this._providers.get(e);if(!o)throw new Error(`Chat response provider with identifier ${e} is not registered.`);return o.sendChatRequest(i,t,r,s)}computeTokenLength(e,t,i){const r=this._providers.get(e);if(!r)throw new Error(`Chat response provider with identifier ${e} is not registered.`);return r.provideTokenCount(t,i)}};LS=V([F(0,QA),F(1,ct),F(2,DC)],LS);new C("debugType",void 0,{type:"string",description:h(5901,"Debug type of the active debug session. For example 'python'.")});new C("debugConfigurationType",void 0,{type:"string",description:h(5902,"Debug type of the selected launch configuration. For example 'python'.")});new C("debugState","inactive",{type:"string",description:h(5903,"State that the focused debug session is in. One of the following: 'inactive', 'initializing', 'stopped' or 'running'.")});const uR="debugUx";new C(uR,"default",{type:"string",description:h(5904,"Debug UX state. When there are no debug configurations it is 'simple', otherwise 'default'. Used to decide when to show welcome views in the debug viewlet.")});new C("hasDebugged",!1,{type:"boolean",description:h(5905,"True when a debug session has been started at least once, false otherwise.")});new C("inDebugMode",!1,{type:"boolean",description:h(5906,"True when debugging, false otherwise.")});new C("inDebugRepl",!1,{type:"boolean",description:h(5907,"True when focus is in the debug console, false otherwise.")});new C("breakpointWidgetVisible",!1,{type:"boolean",description:h(5908,"True when breakpoint editor zone widget is visible, false otherwise.")});new C("inBreakpointWidget",!1,{type:"boolean",description:h(5909,"True when focus is in the breakpoint editor zone widget, false otherwise.")});new C("breakpointsFocused",!0,{type:"boolean",description:h(5910,"True when the BREAKPOINTS view is focused, false otherwise.")});new C("watchExpressionsFocused",!0,{type:"boolean",description:h(5911,"True when the WATCH view is focused, false otherwise.")});new C("watchExpressionsExist",!1,{type:"boolean",description:h(5912,"True when at least one watch expression exists, false otherwise.")});new C("variablesFocused",!0,{type:"boolean",description:h(5913,"True when the VARIABLES views is focused, false otherwise")});new C("expressionSelected",!1,{type:"boolean",description:h(5914,"True when an expression input box is open in either the WATCH or the VARIABLES view, false otherwise.")});new C("breakpointInputFocused",!1,{type:"boolean",description:h(5915,"True when the input box has focus in the BREAKPOINTS view.")});new C("callStackItemType",void 0,{type:"string",description:h(5916,"Represents the item type of the focused element in the CALL STACK view. For example: 'session', 'thread', 'stackFrame'")});new C("callStackSessionIsAttach",!1,{type:"boolean",description:h(5917,"True when the session in the CALL STACK view is attach, false otherwise. Used internally for inline menus in the CALL STACK view.")});new C("callStackItemStopped",!1,{type:"boolean",description:h(5918,"True when the focused item in the CALL STACK is stopped. Used internaly for inline menus in the CALL STACK view.")});new C("callStackSessionHasOneThread",!1,{type:"boolean",description:h(5919,"True when the focused session in the CALL STACK view has exactly one thread. Used internally for inline menus in the CALL STACK view.")});new C("callStackFocused",!0,{type:"boolean",description:h(5920,"True when the CALLSTACK view is focused, false otherwise.")});new C("watchItemType",void 0,{type:"string",description:h(5921,"Represents the item type of the focused element in the WATCH view. For example: 'expression', 'variable'")});new C("canViewMemory",void 0,{type:"boolean",description:h(5922,"Indicates whether the item in the view has an associated memory refrence.")});new C("breakpointItemType",void 0,{type:"string",description:h(5923,"Represents the item type of the focused element in the BREAKPOINTS view. For example: 'breakpoint', 'exceptionBreakppint', 'functionBreakpoint', 'dataBreakpoint'")});new C("breakpointItemBytes",void 0,{type:"boolean",description:h(5924,"Whether the breakpoint item is a data breakpoint on a byte range.")});new C("breakpointHasModes",!1,{type:"boolean",description:h(5925,"Whether the breakpoint has multiple modes it can switch to.")});new C("breakpointSupportsCondition",!1,{type:"boolean",description:h(5926,"True when the focused breakpoint supports conditions.")});new C("loadedScriptsSupported",!1,{type:"boolean",description:h(5927,"True when the focused sessions supports the LOADED SCRIPTS view")});new C("loadedScriptsItemType",void 0,{type:"string",description:h(5928,"Represents the item type of the focused element in the LOADED SCRIPTS view.")});new C("focusedSessionIsAttach",!1,{type:"boolean",description:h(5929,"True when the focused session is 'attach'.")});new C("focusedSessionIsNoDebug",!1,{type:"boolean",description:h(5930,"True when the focused session is run without debugging.")});new C("stepBackSupported",!1,{type:"boolean",description:h(5931,"True when the focused session supports 'stepBack' requests.")});new C("restartFrameSupported",!1,{type:"boolean",description:h(5932,"True when the focused session supports 'restartFrame' requests.")});new C("stackFrameSupportsRestart",!1,{type:"boolean",description:h(5933,"True when the focused stack frame supports 'restartFrame'.")});new C("jumpToCursorSupported",!1,{type:"boolean",description:h(5934,"True when the focused session supports 'jumpToCursor' request.")});new C("stepIntoTargetsSupported",!1,{type:"boolean",description:h(5935,"True when the focused session supports 'stepIntoTargets' request.")});new C("breakpointsExist",!1,{type:"boolean",description:h(5936,"True when at least one breakpoint exists.")});new C("debuggersAvailable",!1,{type:"boolean",description:h(5937,"True when there is at least one debug extensions active.")});new C("debugExtensionAvailable",!0,{type:"boolean",description:h(5938,"True when there is at least one debug extension installed and enabled.")});new C("debugProtocolVariableMenuContext",void 0,{type:"string",description:h(5939,"Represents the context the debug adapter sets on the focused variable in the VARIABLES view.")});new C("debugSetVariableSupported",!1,{type:"boolean",description:h(5940,"True when the focused session supports 'setVariable' request.")});new C("debugSetDataBreakpointAddressSupported",!1,{type:"boolean",description:h(5941,"True when the focused session supports 'getBreakpointInfo' request on an address.")});new C("debugSetExpressionSupported",!1,{type:"boolean",description:h(5942,"True when the focused session supports 'setExpression' request.")});new C("breakWhenValueChangesSupported",!1,{type:"boolean",description:h(5943,"True when the focused session supports to break when value changes.")});new C("breakWhenValueIsAccessedSupported",!1,{type:"boolean",description:h(5944,"True when the focused breakpoint supports to break when value is accessed.")});new C("breakWhenValueIsReadSupported",!1,{type:"boolean",description:h(5945,"True when the focused breakpoint supports to break when value is read.")});new C("terminateDebuggeeSupported",!1,{type:"boolean",description:h(5946,"True when the focused session supports the terminate debuggee capability.")});new C("suspendDebuggeeSupported",!1,{type:"boolean",description:h(5947,"True when the focused session supports the suspend debuggee capability.")});new C("variableEvaluateNamePresent",!1,{type:"boolean",description:h(5948,"True when the focused variable has an 'evalauteName' field set.")});new C("variableIsReadonly",!1,{type:"boolean",description:h(5949,"True when the focused variable is read-only.")});new C("variableValue",!1,{type:"string",description:h(5950,"Value of the variable, present for debug visualization clauses.")});new C("variableType",!1,{type:"string",description:h(5951,"Type of the variable, present for debug visualization clauses.")});new C("variableInterfaces",!1,{type:"array",description:h(5952,"Any interfaces or contracts that the variable satisfies, present for debug visualization clauses.")});new C("variableName",!1,{type:"string",description:h(5953,"Name of the variable, present for debug visualization clauses.")});new C("variableLanguage",!1,{type:"string",description:h(5954,"Language of the variable source, present for debug visualization clauses.")});new C("variableExtensionId",!1,{type:"string",description:h(5955,"Extension ID of the variable source, present for debug visualization clauses.")});new C("exceptionWidgetVisible",!1,{type:"boolean",description:h(5956,"True when the exception widget is visible.")});new C("multiSessionRepl",!1,{type:"boolean",description:h(5957,"True when there is more than 1 debug console.")});new C("multiSessionDebug",!1,{type:"boolean",description:h(5958,"True when there is more than 1 active debug session.")});new C("disassembleRequestSupported",!1,{type:"boolean",description:h(5959,"True when the focused sessions supports disassemble request.")});new C("disassemblyViewFocus",!1,{type:"boolean",description:h(5960,"True when the Disassembly View is focused.")});new C("languageSupportsDisassembleRequest",!1,{type:"boolean",description:h(5961,"True when the language in the current editor supports disassemble request.")});new C("focusedStackFrameHasInstructionReference",!1,{type:"boolean",description:h(5962,"True when the focused stack frame has instruction pointer reference.")});h(5964,"Controls when the internal Debug Console should open.");var NS;(function(n){n[n.Inactive=0]="Inactive",n[n.Initializing=1]="Initializing",n[n.Stopped=2]="Stopped",n[n.Running=3]="Running"})(NS||(NS={}));var OS;(function(n){n[n.Valid=0]="Valid",n[n.Unreadable=1]="Unreadable",n[n.Error=2]="Error"})(OS||(OS={}));var FS;(function(n){n[n.Variable=0]="Variable",n[n.Address=1]="Address"})(FS||(FS={}));var Ig;(function(n){n[n.Initial=1]="Initial",n[n.Dynamic=2]="Dynamic"})(Ig||(Ig={}));var MS;(function(n){n.UnverifiedBreakpoints="unverifiedBreakpoints"})(MS||(MS={}));var $S;(function(n){n[n.CONDITION=0]="CONDITION",n[n.HIT_COUNT=1]="HIT_COUNT",n[n.LOG_MESSAGE=2]="LOG_MESSAGE",n[n.TRIGGER_POINT=3]="TRIGGER_POINT"})($S||($S={}));var Cg;(function(n){n[n.Command=0]="Command",n[n.Tree=1]="Tree"})(Cg||(Cg={}));var mw;(function(n){n[n.None=0]="None",n[n.Collapsed=1]="Collapsed",n[n.Expanded=2]="Expanded"})(mw||(mw={}));var US;(function(n){n.deserialize=e=>e,n.serialize=e=>e})(US||(US={}));var HS;(function(n){n.deserialize=e=>({id:e.id,name:e.name,iconPath:e.iconPath&&{light:y.revive(e.iconPath.light),dark:y.revive(e.iconPath.dark)},iconClass:e.iconClass,visualization:e.visualization}),n.serialize=e=>e})(HS||(HS={}));const da="**",_w="/",Tp="[/\\\\]",Ap="[^/\\\\]",dR=/\//g;function BS(n,e){switch(n){case 0:return"";case 1:return`${Ap}*?`;default:return`(?:${Tp}|${Ap}+${Tp}${e?`|${Tp}${Ap}+`:""})*?`}}function vw(n,e){if(!n)return[];const t=[];let i=!1,r=!1,s="";for(const o of n){switch(o){case e:if(!i&&!r){t.push(s),s="";continue}break;case"{":i=!0;break;case"}":i=!1;break;case"[":r=!0;break;case"]":r=!1;break}s+=o}return s&&t.push(s),t}function TC(n){if(!n)return"";let e="";const t=vw(n,_w);if(t.every(i=>i===da))e=".*";else{let i=!1;t.forEach((r,s)=>{if(r===da){if(i)return;e+=BS(2,s===t.length-1)}else{let o=!1,a="",l=!1,c="";for(const u of r){if(u!=="}"&&o){a+=u;continue}if(l&&(u!=="]"||!c)){let d;u==="-"?d=u:(u==="^"||u==="!")&&!c?d="^":u===_w?d="":d=hl(u),c+=d;continue}switch(u){case"{":o=!0;continue;case"[":l=!0;continue;case"}":{const f=`(?:${vw(a,",").map(p=>TC(p)).join("|")})`;e+=f,o=!1,a="";break}case"]":{e+="["+c+"]",l=!1,c="";break}case"?":e+=Ap;continue;case"*":e+=BS(1);continue;default:e+=hl(u)}}s<t.length-1&&(t[s+1]!==da||s+2<t.length)&&(e+=Tp)}i=r===da})}return e}const hR=/^\*\*\/\*\.[\w\.-]+$/,fR=/^\*\*\/([\w\.-]+)\/?$/,pR=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,gR=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,mR=/^\*\*((\/[\w\.-]+)+)\/?$/,_R=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,WS=new ax(1e4),VS=function(){return!1},Ur=function(){return null};function Nx(n,e){if(!n)return Ur;let t;typeof n!="string"?t=n.pattern:t=n,t=t.trim();const i=`${t}_${!!e.trimForExclusions}`;let r=WS.get(i);if(r)return zS(r,n);let s;return hR.test(t)?r=vR(t.substr(4),t):(s=fR.exec(cv(t,e)))?r=wR(s[1],t):(e.trimForExclusions?gR:pR).test(t)?r=bR(t,e):(s=mR.exec(cv(t,e)))?r=qS(s[1].substr(1),t,!0):(s=_R.exec(cv(t,e)))?r=qS(s[1],t,!1):r=yR(t),WS.set(i,r),zS(r,n)}function zS(n,e){if(typeof e=="string")return n;const t=function(i,r){return ag(i,e.base,!Fs)?n(i9(i.substr(e.base.length),hr),r):null};return t.allBasenames=n.allBasenames,t.allPaths=n.allPaths,t.basenames=n.basenames,t.patterns=n.patterns,t}function cv(n,e){return e.trimForExclusions&&n.endsWith("/**")?n.substr(0,n.length-2):n}function vR(n,e){return function(t,i){return typeof t=="string"&&t.endsWith(n)?e:null}}function wR(n,e){const t=`/${n}`,i=`\\${n}`,r=function(o,a){return typeof o!="string"?null:a?a===n?e:null:o===n||o.endsWith(t)||o.endsWith(i)?e:null},s=[n];return r.basenames=s,r.patterns=[e],r.allBasenames=s,r}function bR(n,e){const t=AC(n.slice(1,-1).split(",").map(a=>Nx(a,e)).filter(a=>a!==Ur),n),i=t.length;if(!i)return Ur;if(i===1)return t[0];const r=function(a,l){for(let c=0,u=t.length;c<u;c++)if(t[c](a,l))return n;return null},s=t.find(a=>!!a.allBasenames);s&&(r.allBasenames=s.allBasenames);const o=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return o.length&&(r.allPaths=o),r}function qS(n,e,t){const i=hr===ot.sep,r=i?n:n.replace(dR,hr),s=hr+r,o=ot.sep+n;let a;return t?a=function(l,c){return typeof l=="string"&&(l===r||l.endsWith(s)||!i&&(l===n||l.endsWith(o)))?e:null}:a=function(l,c){return typeof l=="string"&&(l===r||!i&&l===n)?e:null},a.allPaths=[(t?"*/":"./")+n],a}function yR(n){try{const e=new RegExp(`^${TC(n)}$`);return function(t){return e.lastIndex=0,typeof t=="string"&&e.test(t)?n:null}}catch{return Ur}}function zd(n,e,t){return!n||typeof e!="string"?!1:_u(n)(e,void 0,t)}function _u(n,e={}){if(!n)return VS;if(typeof n=="string"||xR(n)){const t=Nx(n,e);if(t===Ur)return VS;const i=function(r,s){return!!t(r,s)};return t.allBasenames&&(i.allBasenames=t.allBasenames),t.allPaths&&(i.allPaths=t.allPaths),i}return ER(n,e)}function xR(n){const e=n;return e?typeof e.base=="string"&&typeof e.pattern=="string":!1}function ER(n,e){const t=AC(Object.getOwnPropertyNames(n).map(a=>SR(a,n[a],e)).filter(a=>a!==Ur)),i=t.length;if(!i)return Ur;if(!t.some(a=>!!a.requiresSiblings)){if(i===1)return t[0];const a=function(u,d){let f;for(let p=0,w=t.length;p<w;p++){const v=t[p](u,d);if(typeof v=="string")return v;Io(v)&&(f||(f=[]),f.push(v))}return f?(async()=>{for(const p of f){const w=await p;if(typeof w=="string")return w}return null})():null},l=t.find(u=>!!u.allBasenames);l&&(a.allBasenames=l.allBasenames);const c=t.reduce((u,d)=>d.allPaths?u.concat(d.allPaths):u,[]);return c.length&&(a.allPaths=c),a}const r=function(a,l,c){let u,d;for(let f=0,p=t.length;f<p;f++){const w=t[f];w.requiresSiblings&&c&&(l||(l=ci(a)),u||(u=l.substr(0,l.length-Wv(a).length)));const v=w(a,l,u,c);if(typeof v=="string")return v;Io(v)&&(d||(d=[]),d.push(v))}return d?(async()=>{for(const f of d){const p=await f;if(typeof p=="string")return p}return null})():null},s=t.find(a=>!!a.allBasenames);s&&(r.allBasenames=s.allBasenames);const o=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return o.length&&(r.allPaths=o),r}function SR(n,e,t){if(e===!1)return Ur;const i=Nx(n,t);if(i===Ur)return Ur;if(typeof e=="boolean")return i;if(e){const r=e.when;if(typeof r=="string"){const s=(o,a,l,c)=>{if(!c||!i(o,a))return null;const u=r.replace("$(basename)",()=>l),d=c(u);return Io(d)?d.then(f=>f?n:null):d?n:null};return s.requiresSiblings=!0,s}}return i}function AC(n,e){const t=n.filter(a=>!!a.basenames);if(t.length<2)return n;const i=t.reduce((a,l)=>{const c=l.basenames;return c?a.concat(c):a},[]);let r;if(e){r=[];for(let a=0,l=i.length;a<l;a++)r.push(e)}else r=t.reduce((a,l)=>{const c=l.patterns;return c?a.concat(c):a},[]);const s=function(a,l){if(typeof a!="string")return null;if(!l){let u;for(u=a.length;u>0;u--){const d=a.charCodeAt(u-1);if(d===P.Slash||d===P.Backslash)break}l=a.substr(u)}const c=i.indexOf(l);return c!==-1?r[c]:null};s.basenames=i,s.patterns=r,s.allBasenames=i;const o=n.filter(a=>!a.basenames);return o.push(s),o}const ww=["W","X","Y","Z","a","b","c","d","e","f"],DR=new RegExp(`^[${ww.join("")}]+`),RC=7;function LC(n){if(n.scheme!==oe.vscodeNotebookCell)return;const e=n.fragment.indexOf("s");if(e<0)return;const t=parseInt(n.fragment.substring(0,e).replace(DR,""),RC),i=Zp(n.fragment.substring(e+1)).toString();if(!isNaN(t))return{handle:t,notebook:n.with({scheme:i,fragment:null})}}function kR(n,e){const t=e.toString(RC),r=`${t.length<ww.length?ww[t.length-1]:"z"}${t}s${cx(Pe.fromString(n.scheme),!0,!0)}`;return n.with({scheme:oe.vscodeNotebookCell,fragment:r})}function IR(n){if(n.scheme!==oe.vscodeNotebookMetadata)return;const e=Zp(n.fragment).toString();return n.with({scheme:e,fragment:null})}function CR(n){const e=`${cx(Pe.fromString(n.scheme),!0,!0)}`;return n.with({scheme:oe.vscodeNotebookMetadata,fragment:e})}function PR(n){if(n.scheme!==oe.vscodeNotebookCellOutput)return;const e=new URLSearchParams(n.query),t=e.get("openIn");if(!t)return;const i=e.get("outputId")??void 0,r=LC(n.with({scheme:oe.vscodeNotebookCell,query:null})),s=e.get("outputIndex")?parseInt(e.get("outputIndex")||"",10):void 0;return{notebook:r?r.notebook:n.with({scheme:e.get("notebookScheme")||oe.file,fragment:null,query:null}),openIn:t,outputId:i,outputIndex:s,cellHandle:r==null?void 0:r.handle,cellFragment:n.fragment}}var oc;(function(n){n[n.Markup=1]="Markup",n[n.Code=2]="Code"})(oc||(oc={}));Ts.latex,Ts.markdown,Ts.text;Ts.latex,Ts.markdown,Ts.text;var jS;(function(n){n[n.Running=1]="Running",n[n.Idle=2]="Idle"})(jS||(jS={}));var qd;(function(n){n[n.Unconfirmed=1]="Unconfirmed",n[n.Pending=2]="Pending",n[n.Executing=3]="Executing"})(qd||(qd={}));var GS;(function(n){n[n.Unconfirmed=1]="Unconfirmed",n[n.Pending=2]="Pending",n[n.Executing=3]="Executing"})(GS||(GS={}));var QS;(function(n){n[n.WithHardKernelDependency=0]="WithHardKernelDependency",n[n.WithOptionalKernelDependency=1]="WithOptionalKernelDependency",n[n.Pure=2]="Pure",n[n.Never=3]="Never"})(QS||(QS={}));var JS;(function(n){n.Always="always",n.Never="never",n.Optional="optional"})(JS||(JS={}));var Ji;(function(n){n[n.ModelChange=1]="ModelChange",n[n.Move=2]="Move",n[n.ChangeCellLanguage=5]="ChangeCellLanguage",n[n.Initialize=6]="Initialize",n[n.ChangeCellMetadata=7]="ChangeCellMetadata",n[n.Output=8]="Output",n[n.OutputItem=9]="OutputItem",n[n.ChangeCellContent=10]="ChangeCellContent",n[n.ChangeDocumentMetadata=11]="ChangeDocumentMetadata",n[n.ChangeCellInternalMetadata=12]="ChangeCellInternalMetadata",n[n.ChangeCellMime=13]="ChangeCellMime",n[n.Unknown=100]="Unknown"})(Ji||(Ji={}));var XS;(function(n){n[n.Handle=0]="Handle",n[n.Index=1]="Index"})(XS||(XS={}));var So;(function(n){n[n.Replace=1]="Replace",n[n.Output=2]="Output",n[n.Metadata=3]="Metadata",n[n.CellLanguage=4]="CellLanguage",n[n.DocumentMetadata=5]="DocumentMetadata",n[n.Move=6]="Move",n[n.OutputItems=7]="OutputItems",n[n.PartialMetadata=8]="PartialMetadata",n[n.PartialInternalMetadata=9]="PartialInternalMetadata"})(So||(So={}));var YS;(function(n){n.scheme=oe.vscodeNotebookMetadata;function e(i){return CR(i)}n.generate=e;function t(i){return IR(i)}n.parse=t})(YS||(YS={}));var bw;(function(n){n.scheme=oe.vscodeNotebookCell;function e(l,c){return kR(l,c)}n.generate=e;function t(l){return LC(l)}n.parse=t;function i(l,c){return l.with({scheme:oe.vscodeNotebookCellOutput,query:new URLSearchParams({openIn:"editor",outputId:c??"",notebookScheme:l.scheme!==oe.file?l.scheme:""}).toString()})}n.generateCellOutputUriWithId=i;function r(l,c,u){return l.with({scheme:oe.vscodeNotebookCellOutput,fragment:c.fragment,query:new URLSearchParams({openIn:"notebook",outputIndex:String(u)}).toString()})}n.generateCellOutputUriWithIndex=r;function s(l){return PR(l)}n.parseCellOutputUri=s;function o(l,c,u){return n.generate(l,c).with({scheme:u})}n.generateCellPropertyUri=o;function a(l,c){if(l.scheme===c)return n.parse(l.with({scheme:n.scheme}))}n.parseCellPropertyUri=a})(bw||(bw={}));new C("notebookEditorCursorAtBoundary","none");new C("notebookEditorCursorAtLineBoundary","none");var ZS;(function(n){n.default="default",n.option="option"})(ZS||(ZS={}));var KS;(function(n){n.Cells="cells",n.Text="text",n.None="none"})(KS||(KS={}));var Pg;(function(n){n[n.Left=1]="Left",n[n.Right=2]="Right"})(Pg||(Pg={}));const vc=class vc{static create(e,t){return`${vc._prefix}${e}/${t??e}`}static parse(e){if(e.startsWith(vc._prefix)){const t=e.substring(vc._prefix.length).split("/");if(t.length===2)return{notebookType:t[0],viewType:t[1]}}}};vc._prefix="notebook/";let e4=vc;function NC(n){return["application/vnd.code.notebook.stdout","application/vnd.code.notebook.stderr"].includes(n)}const TR=new TextDecoder;function AR(n){const e=[];let t=!1;for(const o of n)(e.length===0||t)&&(e.push(o),t=!0);let i=LR(e);const r=Pe.concat(e.map(o=>Pe.wrap(o))),s=$R(r);return i=i||s.byteLength!==r.byteLength,{data:s,didCompression:i}}const Rp="\x1B[A",uv=Rp.split("").map(n=>n.charCodeAt(0)),RR=10;function LR(n){let e=!1;return n.forEach((t,i)=>{if(i===0||t.length<Rp.length)return;const r=n[i-1],s=t.subarray(0,Rp.length);if(s[0]===uv[0]&&s[1]===uv[1]&&s[2]===uv[2]){const o=r.lastIndexOf(RR);if(o===-1)return;e=!0,n[i-1]=r.subarray(0,o),n[i]=t.subarray(Rp.length)}}),e}function NR(n){let e=n;do n=e,e=n.replace(/[^\n]\x08/gm,"");while(e.length<n.length);return n}function OR(n){for(n=n.replace(/\r+\n/gm,`
`);n.search(/\r[^$]/g)>-1;){const e=n.match(/^(.*)\r+/m)[1];let t=n.match(/\r+(.*)$/m)[1];t=t+e.slice(t.length,e.length),n=n.replace(/\r+.*$/m,"\r").replace(/^.*\r/m,t)}return n}const FR=8,MR=13;function $R(n){return!n.buffer.includes(FR)&&!n.buffer.includes(MR)?n:Pe.fromString(OR(NR(TR.decode(n.buffer))))}var bi;(function(n){n.Delimiter="\0"})(bi||(bi={}));var Zi;(function(n){n[n.IsSame=0]="IsSame",n[n.Disconnected=1]="Disconnected",n[n.IsChild=2]="IsChild",n[n.IsParent=3]="IsParent"})(Zi||(Zi={}));class Re{static fromExtHostTestItem(e,t,i=e.parent){if(e._isRoot)return new Re([t]);const r=[e.id];for(let s=i;s&&s.id!==t;s=s.parent)r.push(s.id);return r.push(t),new Re(r.reverse())}static isRoot(e){return!e.includes(bi.Delimiter)}static root(e){const t=e.indexOf(bi.Delimiter);return t===-1?e:e.slice(0,t)}static fromString(e){return new Re(e.split(bi.Delimiter))}static join(e,t){return new Re([...e.path,t])}static split(e){return e.split(bi.Delimiter)}static joinToString(e,t){return e.toString()+bi.Delimiter+t}static parentId(e){const t=e.lastIndexOf(bi.Delimiter);return t===-1?void 0:e.slice(0,t)}static localId(e){const t=e.lastIndexOf(bi.Delimiter);return t===-1?e:e.slice(t+bi.Delimiter.length)}static isChild(e,t){return t[e.length]===bi.Delimiter&&t.startsWith(e)}static compare(e,t){return e===t?Zi.IsSame:Re.isChild(e,t)?Zi.IsChild:Re.isChild(t,e)?Zi.IsParent:Zi.Disconnected}static getLengthOfCommonPrefix(e,t){if(e===0)return 0;let i=0;for(;i<e-1;){for(let r=1;r<e;r++){const s=t(r-1),o=t(r);if(s.path[i]!==o.path[i])return i}i++}return i}constructor(e,t=e.length){if(this.path=e,this.viewEnd=t,e.length===0||t<1)throw new Error("cannot create test with empty path")}get rootId(){return new Re(this.path,1)}get parentId(){return this.viewEnd>1?new Re(this.path,this.viewEnd-1):void 0}get localId(){return this.path[this.viewEnd-1]}get controllerId(){return this.path[0]}get isRoot(){return this.viewEnd===1}*idsFromRoot(){for(let e=1;e<=this.viewEnd;e++)yield new Re(this.path,e)}*idsToRoot(){for(let e=this.viewEnd;e>0;e--)yield new Re(this.path,e)}compare(e){if(typeof e=="string")return Re.compare(this.toString(),e);for(let t=0;t<e.viewEnd&&t<this.viewEnd;t++)if(e.path[t]!==this.path[t])return Zi.Disconnected;return e.viewEnd>this.viewEnd?Zi.IsChild:e.viewEnd<this.viewEnd?Zi.IsParent:Zi.IsSame}toJSON(){return this.toString()}toString(){if(!this.stringifed){this.stringifed=this.path[0];for(let e=1;e<this.viewEnd;e++)this.stringifed+=bi.Delimiter,this.stringifed+=this.path[e]}return this.stringifed}}var Xt;(function(n){n[n.Unset=0]="Unset",n[n.Queued=1]="Queued",n[n.Running=2]="Running",n[n.Passed=3]="Passed",n[n.Failed=4]="Failed",n[n.Skipped=5]="Skipped",n[n.Errored=6]="Errored"})(Xt||(Xt={}));Xt.Unset+"",Xt.Queued+"",Xt.Running+"",Xt.Passed+"",Xt.Failed+"",Xt.Skipped+"",Xt.Errored+"";var t4;(function(n){n[n.Run=1]="Run",n[n.Debug=2]="Debug",n[n.Coverage=3]="Coverage"})(t4||(t4={}));var jd;(function(n){n[n.Refresh=2]="Refresh",n[n.CodeRelatedToTest=4]="CodeRelatedToTest",n[n.TestRelatedToCode=8]="TestRelatedToCode"})(jd||(jd={}));var Dn;(function(n){n[n.Run=2]="Run",n[n.Debug=4]="Debug",n[n.Coverage=8]="Coverage",n[n.HasNonDefaultProfile=16]="HasNonDefaultProfile",n[n.HasConfigurable=32]="HasConfigurable",n[n.SupportsContinuousRun=64]="SupportsContinuousRun"})(Dn||(Dn={}));Dn.Run+"",h(10952,"Run"),Dn.Debug+"",h(10953,"Debug"),Dn.Coverage+"",h(10954,"Coverage");Dn.Run,Dn.Debug,Dn.Coverage,Dn.HasNonDefaultProfile,Dn.HasConfigurable,Dn.SupportsContinuousRun;const UR=n=>"runId"in n;var vu;(function(n){n.serialize=e=>({range:e.range.toJSON(),uri:e.uri.toJSON()}),n.deserialize=(e,t)=>({range:lt.lift(t.range),uri:e.asCanonicalUri(y.revive(t.uri))})})(vu||(vu={}));var fr;(function(n){n[n.Error=0]="Error",n[n.Output=1]="Output"})(fr||(fr={}));var Tg;(function(n){n.serialize=e=>{var t,i;return{label:e.label,uri:(t=e.uri)==null?void 0:t.toJSON(),position:(i=e.position)==null?void 0:i.toJSON()}},n.deserialize=(e,t)=>({label:t.label,uri:t.uri?e.asCanonicalUri(y.revive(t.uri)):void 0,position:t.position?Ii.lift(t.position):void 0})})(Tg||(Tg={}));var Ag;(function(n){n.serialize=e=>{var t;return{message:e.message,type:fr.Error,expected:e.expected,actual:e.actual,contextValue:e.contextValue,location:e.location&&vu.serialize(e.location),stackTrace:(t=e.stackTrace)==null?void 0:t.map(Tg.serialize)}},n.deserialize=(e,t)=>({message:t.message,type:fr.Error,expected:t.expected,actual:t.actual,contextValue:t.contextValue,location:t.location&&vu.deserialize(e,t.location),stackTrace:t.stackTrace&&t.stackTrace.map(i=>Tg.deserialize(e,i))})})(Ag||(Ag={}));var Rg;(function(n){n.serialize=e=>({message:e.message,type:fr.Output,offset:e.offset,length:e.length,location:e.location&&vu.serialize(e.location)}),n.deserialize=(e,t)=>({message:t.message,type:fr.Output,offset:t.offset,length:t.length,location:t.location&&vu.deserialize(e,t.location)})})(Rg||(Rg={}));var Lg;(function(n){n.serialize=e=>e.type===fr.Error?Ag.serialize(e):Rg.serialize(e),n.deserialize=(e,t)=>t.type===fr.Error?Ag.deserialize(e,t):Rg.deserialize(e,t),n.isDiffable=e=>e.type===fr.Error&&e.actual!==void 0&&e.expected!==void 0})(Lg||(Lg={}));var Gd;(function(n){n.serializeWithoutMessages=e=>({state:e.state,duration:e.duration,messages:[]}),n.serialize=e=>({state:e.state,duration:e.duration,messages:e.messages.map(Lg.serialize)}),n.deserialize=(e,t)=>({state:t.state,duration:t.duration,messages:t.messages.map(i=>Lg.deserialize(e,i))})})(Gd||(Gd={}));const OC="\0",Lp=(n,e)=>n+OC+e,FC=n=>{const e=n.indexOf(OC);return{ctrlId:n.slice(0,e),tagId:n.slice(e+1)}};var Ng;(function(n){n.serialize=e=>{var t,i;return{extId:e.extId,label:e.label,tags:e.tags,busy:e.busy,children:void 0,uri:(t=e.uri)==null?void 0:t.toJSON(),range:((i=e.range)==null?void 0:i.toJSON())||null,description:e.description,error:e.error,sortText:e.sortText}},n.deserialize=(e,t)=>({extId:t.extId,label:t.label,tags:t.tags,busy:t.busy,children:void 0,uri:t.uri?e.asCanonicalUri(y.revive(t.uri)):void 0,range:t.range?lt.lift(t.range):null,description:t.description,error:t.error,sortText:t.sortText})})(Ng||(Ng={}));var xn;(function(n){n[n.NotExpandable=0]="NotExpandable",n[n.Expandable=1]="Expandable",n[n.BusyExpanding=2]="BusyExpanding",n[n.Expanded=3]="Expanded"})(xn||(xn={}));var Do;(function(n){n.serialize=e=>({expand:e.expand,item:Ng.serialize(e.item)}),n.deserialize=(e,t)=>({controllerId:Re.root(t.item.extId),expand:t.expand,item:Ng.deserialize(e,t.item)})})(Do||(Do={}));var yh;(function(n){n.serialize=e=>{var i,r;let t;return e.item&&(t={},e.item.label!==void 0&&(t.label=e.item.label),e.item.tags!==void 0&&(t.tags=e.item.tags),e.item.busy!==void 0&&(t.busy=e.item.busy),e.item.uri!==void 0&&(t.uri=(i=e.item.uri)==null?void 0:i.toJSON()),e.item.range!==void 0&&(t.range=(r=e.item.range)==null?void 0:r.toJSON()),e.item.description!==void 0&&(t.description=e.item.description),e.item.error!==void 0&&(t.error=e.item.error),e.item.sortText!==void 0&&(t.sortText=e.item.sortText)),{extId:e.extId,expand:e.expand,item:t}},n.deserialize=e=>{let t;return e.item&&(t={},e.item.label!==void 0&&(t.label=e.item.label),e.item.tags!==void 0&&(t.tags=e.item.tags),e.item.busy!==void 0&&(t.busy=e.item.busy),e.item.range!==void 0&&(t.range=e.item.range?lt.lift(e.item.range):null),e.item.description!==void 0&&(t.description=e.item.description),e.item.error!==void 0&&(t.error=e.item.error),e.item.sortText!==void 0&&(t.sortText=e.item.sortText)),{extId:e.extId,expand:e.expand,item:t}}})(yh||(yh={}));const yw=(n,e)=>{e.expand!==void 0&&(n.expand=e.expand),e.item!==void 0&&(n.item=n.item?Object.assign(n.item,e.item):e.item)};var n4;(function(n){n.serializeWithoutMessages=e=>({...Do.serialize(e),ownComputedState:e.ownComputedState,computedState:e.computedState,tasks:e.tasks.map(Gd.serializeWithoutMessages)}),n.serialize=e=>({...Do.serialize(e),ownComputedState:e.ownComputedState,computedState:e.computedState,tasks:e.tasks.map(Gd.serialize)}),n.deserialize=(e,t)=>({...Do.deserialize(e,t),ownComputedState:t.ownComputedState,computedState:t.computedState,tasks:t.tasks.map(i=>Gd.deserialize(e,i)),retired:!0})})(n4||(n4={}));var xw;(function(n){n.empty=()=>({covered:0,total:0}),n.sum=(e,t)=>{e.covered+=t.covered,e.total+=t.total}})(xw||(xw={}));var i4;(function(n){n.serialize=e=>({id:e.id,statement:e.statement,branch:e.branch,declaration:e.declaration,testIds:e.testIds,uri:e.uri.toJSON()}),n.deserialize=(e,t)=>({id:t.id,statement:t.statement,branch:t.branch,declaration:t.declaration,testIds:t.testIds,uri:e.asCanonicalUri(y.revive(t.uri))}),n.empty=(e,t)=>({id:e,uri:t,statement:xw.empty()})})(i4||(i4={}));function Ox(n){var e;return{...n,location:(e=n.location)==null?void 0:e.toJSON()}}function Fx(n){return n.location=n.location?Ii.isIPosition(n.location)?Ii.lift(n.location):lt.lift(n.location):void 0,n}var qa;(function(n){n[n.Declaration=0]="Declaration",n[n.Statement=1]="Statement",n[n.Branch=2]="Branch"})(qa||(qa={}));var r4;(function(n){n.serialize=e=>e.type===qa.Declaration?Fg.serialize(e):Mg.serialize(e),n.deserialize=e=>e.type===qa.Declaration?Fg.deserialize(e):Mg.deserialize(e)})(r4||(r4={}));var Og;(function(n){n.serialize=Ox,n.deserialize=Fx})(Og||(Og={}));var Fg;(function(n){n.serialize=Ox,n.deserialize=Fx})(Fg||(Fg={}));var Mg;(function(n){n.serialize=e=>{var t;return{...Ox(e),branches:(t=e.branches)==null?void 0:t.map(Og.serialize)}},n.deserialize=e=>{var t;return{...Fx(e),branches:(t=e.branches)==null?void 0:t.map(Og.deserialize)}}})(Mg||(Mg={}));var Dt;(function(n){n[n.Add=0]="Add",n[n.Update=1]="Update",n[n.DocumentSynced=2]="DocumentSynced",n[n.Remove=3]="Remove",n[n.IncrementPendingExtHosts=4]="IncrementPendingExtHosts",n[n.Retire=5]="Retire",n[n.AddTag=6]="AddTag",n[n.RemoveTag=7]="RemoveTag"})(Dt||(Dt={}));var $g;(function(n){n.deserialize=(e,t)=>t.op===Dt.Add?{op:t.op,item:Do.deserialize(e,t.item)}:t.op===Dt.Update?{op:t.op,item:yh.deserialize(t.item)}:t.op===Dt.DocumentSynced?{op:t.op,uri:e.asCanonicalUri(y.revive(t.uri)),docv:t.docv}:t,n.serialize=e=>e.op===Dt.Add?{op:e.op,item:Do.serialize(e.item)}:e.op===Dt.Update?{op:e.op,item:yh.serialize(e.item)}:e})($g||($g={}));class HR{constructor(e){this.uriIdentity=e,this._tags=new Map,this.items=new Map,this.roots=new Set,this.busyControllerCount=0,this.pendingRootCount=0,this.tags=this._tags}apply(e){var i;const t=this.createChangeCollector();for(const r of e)switch(r.op){case Dt.Add:this.add(Do.deserialize(this.uriIdentity,r.item),t);break;case Dt.Update:this.update(yh.deserialize(r.item),t);break;case Dt.Remove:this.remove(r.itemId,t);break;case Dt.Retire:this.retireTest(r.itemId);break;case Dt.IncrementPendingExtHosts:this.updatePendingRoots(r.amount);break;case Dt.AddTag:this._tags.set(r.tag.id,r.tag);break;case Dt.RemoveTag:this._tags.delete(r.id);break}(i=t.complete)==null||i.call(t)}add(e,t){var s,o;const i=(s=Re.parentId(e.item.extId))==null?void 0:s.toString();let r;if(!i)r=this.createItem(e),this.roots.add(r),this.items.set(e.item.extId,r);else if(this.items.has(i)){const a=this.items.get(i);a.children.add(e.item.extId),r=this.createItem(e,a),this.items.set(e.item.extId,r)}else{console.error(`Test with unknown parent ID: ${JSON.stringify(e)}`);return}return(o=t.add)==null||o.call(t,r),e.expand===xn.BusyExpanding&&this.busyControllerCount++,r}update(e,t){var r;const i=this.items.get(e.extId);if(i)return e.expand!==void 0&&(i.expand===xn.BusyExpanding&&this.busyControllerCount--,e.expand===xn.BusyExpanding&&this.busyControllerCount++),yw(i,e),(r=t.update)==null||r.call(t,i),i}remove(e,t){var o,a;const i=this.items.get(e);if(!i)return;const r=(o=Re.parentId(i.item.extId))==null?void 0:o.toString();r?this.items.get(r).children.delete(i.item.extId):this.roots.delete(i);const s=[[e]];for(;s.length;)for(const l of s.pop()){const c=this.items.get(l);c&&(s.push(c.children),this.items.delete(l),(a=t.remove)==null||a.call(t,c,c!==i),c.expand===xn.BusyExpanding&&this.busyControllerCount--)}}retireTest(e){}updatePendingRoots(e){this.pendingRootCount+=e}createChangeCollector(){return{}}}var s4;(function(n){n[n.UP=0]="UP",n[n.DOWN=1]="DOWN",n[n.LEFT=2]="LEFT",n[n.RIGHT=3]="RIGHT"})(s4||(s4={}));var o4;(function(n){n[n.HORIZONTAL=0]="HORIZONTAL",n[n.VERTICAL=1]="VERTICAL"})(o4||(o4={}));var a4;(function(n){n[n.FIRST=0]="FIRST",n[n.LAST=1]="LAST",n[n.NEXT=2]="NEXT",n[n.PREVIOUS=3]="PREVIOUS"})(a4||(a4={}));var l4;(function(n){n[n.MAXIMIZE=0]="MAXIMIZE",n[n.EXPAND=1]="EXPAND",n[n.EVEN=2]="EVEN"})(l4||(l4={}));var c4;(function(n){n[n.COPY_EDITORS=0]="COPY_EDITORS",n[n.MOVE_EDITORS=1]="MOVE_EDITORS"})(c4||(c4={}));var Ew;(function(n){n[n.CREATION_TIME=0]="CREATION_TIME",n[n.MOST_RECENTLY_ACTIVE=1]="MOST_RECENTLY_ACTIVE",n[n.GRID_APPEARANCE=2]="GRID_APPEARANCE"})(Ew||(Ew={}));var u4;(function(n){n[n.NEW_EDITOR=1]="NEW_EDITOR",n[n.MOVE_EDITOR=2]="MOVE_EDITOR",n[n.COPY_EDITOR=3]="COPY_EDITOR"})(u4||(u4={}));const BR=-1,WR=-2;var pn;(function(n){n[n.Upsert=0]="Upsert",n[n.SetTags=1]="SetTags",n[n.UpdateCanResolveChildren=2]="UpdateCanResolveChildren",n[n.RemoveChild=3]="RemoveChild",n[n.SetProp=4]="SetProp",n[n.Bulk=5]="Bulk",n[n.DocumentSynced=6]="DocumentSynced"})(pn||(pn={}));const fd=(n,e)=>n===e,VR={range:(n,e)=>n===e?!0:!n||!e?!1:n.equalsRange(e),busy:fd,label:fd,description:fd,error:fd,sortText:fd,tags:(n,e)=>!(n.length!==e.length||n.some(t=>!e.includes(t)))},zR=Object.entries(VR),qR=(n,e)=>{let t;for(const[i,r]of zR)r(n[i],e[i])||(t?t[i]=e[i]:t={[i]:e[i]});return t};class jR extends Te{get root(){return this.options.root}constructor(e){super(),this.options=e,this.debounceSendDiff=this._register(new Gu(()=>this.flushDiff(),200)),this.diffOpEmitter=this._register(new L),this.tree=new Map,this.tags=new Map,this.diff=[],this.onDidGenerateDiff=this.diffOpEmitter.event,this.root.canResolveChildren=!0,this.upsertItem(this.root,void 0)}set resolveHandler(e){this._resolveHandler=e;for(const t of this.tree.values())this.updateExpandability(t)}get resolveHandler(){return this._resolveHandler}collectDiff(){const e=this.diff;return this.diff=[],e}pushDiff(e){switch(e.op){case Dt.DocumentSynced:{for(const t of this.diff)if(t.op===Dt.DocumentSynced&&t.uri===e.uri){t.docv=e.docv;return}break}case Dt.Update:{const t=this.diff[this.diff.length-1];if(t){if(t.op===Dt.Update&&t.item.extId===e.item.extId){yw(t.item,e.item);return}if(t.op===Dt.Add&&t.item.item.extId===e.item.extId){yw(t.item,e.item);return}}break}}this.diff.push(e),this.debounceSendDiff.isScheduled()||this.debounceSendDiff.schedule()}expand(e,t){var r;const i=this.tree.get(e);if(i){if((i.expandLevels===void 0||t>i.expandLevels)&&(i.expandLevels=t),i.expand===xn.Expandable){const s=this.resolveChildren(i);return s.isOpen()?this.expandChildren(i,t-1):s.wait().then(()=>this.expandChildren(i,t-1))}else if(i.expand===xn.Expanded)return((r=i.resolveBarrier)==null?void 0:r.isOpen())===!1?i.resolveBarrier.wait().then(()=>this.expandChildren(i,t-1)):this.expandChildren(i,t-1)}}dispose(){for(const e of this.tree.values())this.options.getApiFor(e.actual).listener=void 0;this.tree.clear(),this.diff=[],super.dispose()}onTestItemEvent(e,t){switch(t.op){case pn.RemoveChild:this.removeItem(Re.joinToString(e.fullId,t.id));break;case pn.Upsert:this.upsertItem(t.item,e);break;case pn.Bulk:for(const i of t.ops)this.onTestItemEvent(e,i);break;case pn.SetTags:this.diffTagRefs(t.new,t.old,e.fullId.toString());break;case pn.UpdateCanResolveChildren:this.updateExpandability(e);break;case pn.SetProp:this.pushDiff({op:Dt.Update,item:{extId:e.fullId.toString(),item:t.update}});break;case pn.DocumentSynced:this.documentSynced(e.actual.uri);break;default:Mv()}}documentSynced(e){e&&this.pushDiff({op:Dt.DocumentSynced,uri:e,docv:this.options.getDocumentVersion(e)})}upsertItem(e,t){var u,d;const i=Re.fromExtHostTestItem(e,this.root.id,t==null?void 0:t.actual),r=this.options.getApiFor(e);r.parent&&r.parent!==(t==null?void 0:t.actual)&&this.options.getChildren(r.parent).delete(e.id);let s=this.tree.get(i.toString());if(!s){s={fullId:i,actual:e,expandLevels:t!=null&&t.expandLevels?t.expandLevels-1:void 0,expand:xn.NotExpandable},e.tags.forEach(this.incrementTagRefs,this),this.tree.set(s.fullId.toString(),s),this.setItemParent(e,t),this.pushDiff({op:Dt.Add,item:{controllerId:this.options.controllerId,expand:s.expand,item:this.options.toITestItem(e)}}),this.connectItemAndChildren(e,s,t);return}if(s.actual===e){this.connectItem(e,s,t);return}if(((u=s.actual.uri)==null?void 0:u.toString())!==((d=e.uri)==null?void 0:d.toString()))return this.removeItem(i.toString()),this.upsertItem(e,t);const o=this.options.getChildren(s.actual),a=s.actual,l=qR(this.options.toITestItem(a),this.options.toITestItem(e));this.options.getApiFor(a).listener=void 0,s.actual=e,s.resolveBarrier=void 0,s.expand=xn.NotExpandable,l&&(l.hasOwnProperty("tags")&&(this.diffTagRefs(e.tags,a.tags,i.toString()),delete l.tags),this.onTestItemEvent(s,{op:pn.SetProp,update:l})),this.connectItemAndChildren(e,s,t);for(const[f,p]of o)this.options.getChildren(e).get(p.id)||this.removeItem(Re.joinToString(i,p.id));const c=s.expandLevels;c!==void 0&&queueMicrotask(()=>{s.expand===xn.Expandable&&(s.expandLevels=void 0,this.expand(i.toString(),c))}),this.documentSynced(s.actual.uri)}diffTagRefs(e,t,i){const r=new Set(t.map(s=>s.id));for(const s of e)r.delete(s.id)||this.incrementTagRefs(s);this.pushDiff({op:Dt.Update,item:{extId:i,item:{tags:e.map(s=>Lp(this.options.controllerId,s.id))}}}),r.forEach(this.decrementTagRefs,this)}incrementTagRefs(e){const t=this.tags.get(e.id);t?t.refCount++:(this.tags.set(e.id,{refCount:1}),this.pushDiff({op:Dt.AddTag,tag:{id:Lp(this.options.controllerId,e.id)}}))}decrementTagRefs(e){const t=this.tags.get(e);t&&!--t.refCount&&(this.tags.delete(e),this.pushDiff({op:Dt.RemoveTag,id:Lp(this.options.controllerId,e)}))}setItemParent(e,t){this.options.getApiFor(e).parent=t&&t.actual!==this.root?t.actual:void 0}connectItem(e,t,i){this.setItemParent(e,i);const r=this.options.getApiFor(e);r.parent=i==null?void 0:i.actual,r.listener=s=>this.onTestItemEvent(t,s),this.updateExpandability(t)}connectItemAndChildren(e,t,i){this.connectItem(e,t,i);for(const[r,s]of this.options.getChildren(e))this.upsertItem(s,t)}updateExpandability(e){let t;this._resolveHandler?e.resolveBarrier?t=e.resolveBarrier.isOpen()?xn.Expanded:xn.BusyExpanding:t=e.actual.canResolveChildren?xn.Expandable:xn.NotExpandable:t=xn.NotExpandable,t!==e.expand&&(e.expand=t,this.pushDiff({op:Dt.Update,item:{extId:e.fullId.toString(),expand:t}}),t===xn.Expandable&&e.expandLevels!==void 0&&this.resolveChildren(e))}expandChildren(e,t){if(t<0)return;const i=[];for(const[r,s]of this.options.getChildren(e.actual)){const o=this.expand(Re.joinToString(e.fullId,s.id),t);Io(o)&&i.push(o)}if(i.length)return Promise.all(i).then(()=>{})}resolveChildren(e){if(e.resolveBarrier)return e.resolveBarrier;if(!this._resolveHandler){const s=new Nr;return s.open(),s}e.expand=xn.BusyExpanding,this.pushExpandStateUpdate(e);const t=e.resolveBarrier=new Nr,i=s=>{console.error(`Unhandled error in resolveHandler of test controller "${this.options.controllerId}"`,s)};let r;try{r=this._resolveHandler(e.actual===this.root?void 0:e.actual)}catch(s){i(s)}return Io(r)?r.catch(i).then(()=>{t.open(),this.updateExpandability(e)}):(t.open(),this.updateExpandability(e)),e.resolveBarrier}pushExpandStateUpdate(e){this.pushDiff({op:Dt.Update,item:{extId:e.fullId.toString(),expand:e.expand}})}removeItem(e){const t=this.tree.get(e);if(!t)throw new Error("attempting to remove non-existent child");this.pushDiff({op:Dt.Remove,itemId:e});const i=[t];for(;i.length;){const r=i.pop();if(r){this.options.getApiFor(r.actual).listener=void 0;for(const s of r.actual.tags)this.decrementTagRefs(s.id);this.tree.delete(r.fullId.toString());for(const[s,o]of this.options.getChildren(r.actual))i.push(this.tree.get(Re.joinToString(r.fullId,o.id)))}}}flushDiff(){const e=this.collectDiff();e.length&&this.diffOpEmitter.fire(e)}}class GR extends Error{constructor(e){super(`Attempted to insert a duplicate test item ID ${e}`)}}class Ug extends Error{constructor(e){super(`TestItem with ID "${e}" is invalid. Make sure to create it from the createTestItem method.`)}}class QR extends Error{constructor(e,t,i){super(`TestItem with ID "${e}" is from controller "${t}" and cannot be added as a child of an item from controller "${i}".`)}}const JR=(n,e,t)=>{let i=new Map;return{get size(){return i.size},forEach(r,s){for(const o of i.values())r.call(s,o,this)},[Symbol.iterator](){return i.entries()},replace(r){var l;const s=new Map,o=new Set(i.keys()),a={op:pn.Bulk,ops:[]};for(const c of r){if(!(c instanceof t))throw new Ug(c.id);const u=e(c).controllerId;if(u!==n.controllerId)throw new QR(c.id,u,n.controllerId);if(s.has(c.id))throw new GR(c.id);s.set(c.id,c),o.delete(c.id),a.ops.push({op:pn.Upsert,item:c})}for(const c of o.keys())a.ops.push({op:pn.RemoveChild,id:c});(l=n.listener)==null||l.call(n,a),i=s},add(r){var s;if(!(r instanceof t))throw new Ug(r.id);i.set(r.id,r),(s=n.listener)==null||s.call(n,{op:pn.Upsert,item:r})},delete(r){var s;i.delete(r)&&((s=n.listener)==null||s.call(n,{op:pn.RemoveChild,id:r}))},get(r){return i.get(r)},toJSON(){return Array.from(i.values())}}},MC=new WeakMap,XR=(n,e)=>{const t={controllerId:e};return MC.set(n,t),t},p_=n=>{const e=MC.get(n);if(!e)throw new Ug((n==null?void 0:n.id)||"<unknown>");return e};var d4;(function(n){n[n.ACTIVATE=1]="ACTIVATE",n[n.RESTORE=2]="RESTORE",n[n.PRESERVE=3]="PRESERVE"})(d4||(d4={}));var h4;(function(n){n[n.PICK=0]="PICK",n[n.EXCLUSIVE_ONLY=1]="EXCLUSIVE_ONLY"})(h4||(h4={}));var f4;(function(n){n[n.API=0]="API",n[n.USER=1]="USER"})(f4||(f4={}));var p4;(function(n){n[n.Center=0]="Center",n[n.CenterIfOutsideViewport=1]="CenterIfOutsideViewport",n[n.NearTop=2]="NearTop",n[n.NearTopIfOutsideViewport=3]="NearTopIfOutsideViewport"})(p4||(p4={}));var Qd;(function(n){n.PROGRAMMATIC="api",n.NAVIGATION="code.navigation",n.JUMP="code.jump"})(Qd||(Qd={}));var Hg;(function(n){n[n.WebSocket=0]="WebSocket",n[n.Managed=1]="Managed"})(Hg||(Hg={}));class YR{constructor(e){this.id=e,this.type=Hg.Managed}toString(){return`Managed(${this.id})`}}class ZR{constructor(e,t){this.host=e,this.port=t,this.type=Hg.WebSocket}toString(){return`WebSocket(${this.host}:${this.port})`}}var Es;(function(n){n.Unknown="Unknown",n.NotAvailable="NotAvailable",n.TemporarilyNotAvailable="TemporarilyNotAvailable",n.NoResolverFound="NoResolverFound",n.InvalidAuthority="InvalidAuthority"})(Es||(Es={}));function g4(n){const e=n.indexOf("+");return e===-1?n:n.substring(0,e)}var Sw,Vo,ts,Dw,zo,Js,qo,kw,Iw,Np,Sd,Cw,wr,br,Pw,Xn,Tw;function pe(n){return Object.assign(n,{apply:function(...t){if(t.length===0)return Reflect.construct(n,[]);{const i=t.length===1?[]:t[1];return Reflect.construct(n,i,t[0].constructor)}},call:function(...t){if(t.length===0)return Reflect.construct(n,[]);{const[i,...r]=t;return Reflect.construct(n,r,i.constructor)}}})}var Aw;(function(n){n[n.Top=0]="Top",n[n.Bottom=1]="Bottom"})(Aw||(Aw={}));var m4;(function(n){n[n.TerminalCommand=0]="TerminalCommand",n[n.Opener=1]="Opener",n[n.Command=3]="Command"})(m4||(m4={}));var Ea,Kk;let je=Sw=(Kk=class{constructor(e){ge(this,Ea);ie(this,Ea,e)}static from(...e){let t=e;return new Sw(function(){if(t){for(const i of t)i&&typeof i.dispose=="function"&&i.dispose();t=void 0}})}dispose(){typeof A(this,Ea)=="function"&&(A(this,Ea).call(this),ie(this,Ea,void 0))}},Ea=new WeakMap,Kk);je=Sw=V([pe],je);let We=Vo=class{static Min(...e){if(e.length===0)throw new TypeError;let t=e[0];for(let i=1;i<e.length;i++){const r=e[i];r.isBefore(t)&&(t=r)}return t}static Max(...e){if(e.length===0)throw new TypeError;let t=e[0];for(let i=1;i<e.length;i++){const r=e[i];r.isAfter(t)&&(t=r)}return t}static isPosition(e){if(!e)return!1;if(e instanceof Vo)return!0;const{line:t,character:i}=e;return typeof t=="number"&&typeof i=="number"}static of(e){if(e instanceof Vo)return e;if(this.isPosition(e))return new Vo(e.line,e.character);throw new Error("Invalid argument, is NOT a position-like object")}get line(){return this._line}get character(){return this._character}constructor(e,t){if(e<0)throw Be("line must be non-negative");if(t<0)throw Be("character must be non-negative");this._line=e,this._character=t}isBefore(e){return this._line<e._line?!0:e._line<this._line?!1:this._character<e._character}isBeforeOrEqual(e){return this._line<e._line?!0:e._line<this._line?!1:this._character<=e._character}isAfter(e){return!this.isBeforeOrEqual(e)}isAfterOrEqual(e){return!this.isBefore(e)}isEqual(e){return this._line===e._line&&this._character===e._character}compareTo(e){return this._line<e._line?-1:this._line>e.line?1:this._character<e._character?-1:this._character>e._character?1:0}translate(e,t=0){if(e===null||t===null)throw Be();let i;return typeof e>"u"?i=0:typeof e=="number"?i=e:(i=typeof e.lineDelta=="number"?e.lineDelta:0,t=typeof e.characterDelta=="number"?e.characterDelta:0),i===0&&t===0?this:new Vo(this.line+i,this.character+t)}with(e,t=this.character){if(e===null||t===null)throw Be();let i;return typeof e>"u"?i=this.line:typeof e=="number"?i=e:(i=typeof e.line=="number"?e.line:this.line,t=typeof e.character=="number"?e.character:this.character),i===this.line&&t===this.character?this:new Vo(i,t)}toJSON(){return{line:this.line,character:this.character}}[Symbol.for("debug.description")](){return`(${this.line}:${this.character})`}};We=Vo=V([pe],We);let Oe=ts=class{static isRange(e){return e instanceof ts?!0:e?We.isPosition(e.start)&&We.isPosition(e.end):!1}static of(e){if(e instanceof ts)return e;if(this.isRange(e))return new ts(e.start,e.end);throw new Error("Invalid argument, is NOT a range-like object")}get start(){return this._start}get end(){return this._end}constructor(e,t,i,r){let s,o;if(typeof e=="number"&&typeof t=="number"&&typeof i=="number"&&typeof r=="number"?(s=new We(e,t),o=new We(i,r)):We.isPosition(e)&&We.isPosition(t)&&(s=We.of(e),o=We.of(t)),!s||!o)throw new Error("Invalid arguments");s.isBefore(o)?(this._start=s,this._end=o):(this._start=o,this._end=s)}contains(e){return ts.isRange(e)?this.contains(e.start)&&this.contains(e.end):We.isPosition(e)?!(We.of(e).isBefore(this._start)||this._end.isBefore(e)):!1}isEqual(e){return this._start.isEqual(e._start)&&this._end.isEqual(e._end)}intersection(e){const t=We.Max(e.start,this._start),i=We.Min(e.end,this._end);if(!t.isAfter(i))return new ts(t,i)}union(e){if(this.contains(e))return this;if(e.contains(this))return e;const t=We.Min(e.start,this._start),i=We.Max(e.end,this.end);return new ts(t,i)}get isEmpty(){return this._start.isEqual(this._end)}get isSingleLine(){return this._start.line===this._end.line}with(e,t=this.end){if(e===null||t===null)throw Be();let i;return e?We.isPosition(e)?i=e:(i=e.start||this.start,t=e.end||this.end):i=this.start,i.isEqual(this._start)&&t.isEqual(this.end)?this:new ts(i,t)}toJSON(){return[this.start,this.end]}[Symbol.for("debug.description")](){return $C(this)}};Oe=ts=V([pe],Oe);let $s=Dw=class extends Oe{static isSelection(e){return e instanceof Dw?!0:e?Oe.isRange(e)&&We.isPosition(e.anchor)&&We.isPosition(e.active)&&typeof e.isReversed=="boolean":!1}get anchor(){return this._anchor}get active(){return this._active}constructor(e,t,i,r){let s,o;if(typeof e=="number"&&typeof t=="number"&&typeof i=="number"&&typeof r=="number"?(s=new We(e,t),o=new We(i,r)):We.isPosition(e)&&We.isPosition(t)&&(s=We.of(e),o=We.of(t)),!s||!o)throw new Error("Invalid arguments");super(s,o),this._anchor=s,this._active=o}get isReversed(){return this._anchor===this._end}toJSON(){return{start:this.start,end:this.end,active:this.active,anchor:this.anchor}}[Symbol.for("debug.description")](){return KR(this)}};$s=Dw=V([pe],$s);function $C(n){return n.isEmpty?`[${n.start.line}:${n.start.character})`:`[${n.start.line}:${n.start.character} -> ${n.end.line}:${n.end.character})`}function KR(n){let e=$C(n);return n.isEmpty||(n.active.isEqual(n.start)?e=`|${e}`:e=`${e}|`),e}const UC=n=>{if(typeof n!="string"||n.length===0||!/^[0-9A-Za-z_\-]+$/.test(n))throw Be("connectionToken")};class e3{static isResolvedAuthority(e){return e&&typeof e=="object"&&typeof e.host=="string"&&typeof e.port=="number"&&(e.connectionToken===void 0||typeof e.connectionToken=="string")}constructor(e,t,i){if(typeof e!="string"||e.length===0)throw Be("host");if(typeof t!="number"||t===0||Math.round(t)!==t)throw Be("port");typeof i<"u"&&UC(i),this.host=e,this.port=Math.round(t),this.connectionToken=i}}class Op{static isManagedResolvedAuthority(e){return e&&typeof e=="object"&&typeof e.makeConnection=="function"&&(e.connectionToken===void 0||typeof e.connectionToken=="string")}constructor(e,t){this.makeConnection=e,this.connectionToken=t,typeof t<"u"&&UC(t)}}class Pr extends Error{static NotAvailable(e,t){return new Pr(e,Es.NotAvailable,t)}static TemporarilyNotAvailable(e){return new Pr(e,Es.TemporarilyNotAvailable)}constructor(e,t=Es.Unknown,i){super(e),this._message=e,this._code=t,this._detail=i,Object.setPrototypeOf(this,Pr.prototype)}}var cr;(function(n){n[n.LF=1]="LF",n[n.CRLF=2]="CRLF"})(cr||(cr={}));var Ic;(function(n){n[n.Replace=1]="Replace",n[n.Append=2]="Append",n[n.Prepend=3]="Prepend"})(Ic||(Ic={}));let Co=zo=class{static isTextEdit(e){return e instanceof zo?!0:e?Oe.isRange(e)&&typeof e.newText=="string":!1}static replace(e,t){return new zo(e,t)}static insert(e,t){return zo.replace(new Oe(e,e),t)}static delete(e){return zo.replace(e,"")}static setEndOfLine(e){const t=new zo(new Oe(new We(0,0),new We(0,0)),"");return t.newEol=e,t}get range(){return this._range}set range(e){if(e&&!Oe.isRange(e))throw Be("range");this._range=e}get newText(){return this._newText||""}set newText(e){if(e&&typeof e!="string")throw Be("newText");this._newText=e}get newEol(){return this._newEol}set newEol(e){if(e&&typeof e!="number")throw Be("newEol");this._newEol=e}constructor(e,t){this._range=e,this._newText=t}toJSON(){return{range:this.range,newText:this.newText,newEol:this._newEol}}};Co=zo=V([pe],Co);let Bg=Js=class{static isNotebookCellEdit(e){return e instanceof Js?!0:e?Ss.isNotebookRange(e)&&Array.isArray(e.newCells):!1}static replaceCells(e,t){return new Js(e,t)}static insertCells(e,t){return new Js(new Ss(e,e),t)}static deleteCells(e){return new Js(e,[])}static updateCellMetadata(e,t){const i=new Js(new Ss(e,e),[]);return i.newCellMetadata=t,i}static updateNotebookMetadata(e){const t=new Js(new Ss(0,0),[]);return t.newNotebookMetadata=e,t}constructor(e,t){this.range=e,this.newCells=t}};Bg=Js=V([pe],Bg);class ja{static isSnippetTextEdit(e){return e instanceof ja?!0:e?Oe.isRange(e.range)&&vl.isSnippetString(e.snippet):!1}static replace(e,t){return new ja(e,t)}static insert(e,t){return ja.replace(new Oe(e,e),t)}constructor(e,t){this.range=e,this.snippet=t}}var $t;(function(n){n[n.File=1]="File",n[n.Text=2]="Text",n[n.Cell=3]="Cell",n[n.CellReplace=5]="CellReplace",n[n.Snippet=6]="Snippet"})($t||($t={}));let _l=class{constructor(){this._edits=[]}_allEntries(){return this._edits}renameFile(e,t,i,r){this._edits.push({_type:$t.File,from:e,to:t,options:i,metadata:r})}createFile(e,t,i){this._edits.push({_type:$t.File,from:void 0,to:e,options:t,metadata:i})}deleteFile(e,t,i){this._edits.push({_type:$t.File,from:e,to:void 0,options:t,metadata:i})}replaceNotebookMetadata(e,t,i){this._edits.push({_type:$t.Cell,metadata:i,uri:e,edit:{editType:So.DocumentMetadata,metadata:t}})}replaceNotebookCells(e,t,i,r){const s=t.start,o=t.end;(s!==o||i.length>0)&&this._edits.push({_type:$t.CellReplace,uri:e,index:s,count:o-s,cells:i,metadata:r})}replaceNotebookCellMetadata(e,t,i,r){this._edits.push({_type:$t.Cell,metadata:r,uri:e,edit:{editType:So.Metadata,index:t,metadata:i}})}replace(e,t,i,r){this._edits.push({_type:$t.Text,uri:e,edit:new Co(t,i),metadata:r})}insert(e,t,i,r){this.replace(e,new Oe(t,t),i,r)}delete(e,t,i){this.replace(e,t,"",i)}has(e){return this._edits.some(t=>t._type===$t.Text&&t.uri.toString()===e.toString())}set(e,t){if(t)for(const i of t){if(!i)continue;let r,s;Array.isArray(i)?(r=i[0],s=i[1]):r=i,Bg.isNotebookCellEdit(r)?r.newCellMetadata?this.replaceNotebookCellMetadata(e,r.range.start,r.newCellMetadata,s):r.newNotebookMetadata?this.replaceNotebookMetadata(e,r.newNotebookMetadata,s):this.replaceNotebookCells(e,r.range,r.newCells,s):ja.isSnippetTextEdit(r)?this._edits.push({_type:$t.Snippet,uri:e,range:r.range,edit:r.snippet,metadata:s,keepWhitespace:r.keepWhitespace}):this._edits.push({_type:$t.Text,uri:e,edit:r,metadata:s})}else{for(let i=0;i<this._edits.length;i++){const r=this._edits[i];switch(r._type){case $t.Text:case $t.Snippet:case $t.Cell:case $t.CellReplace:r.uri.toString()===e.toString()&&(this._edits[i]=void 0);break}}M7(this._edits)}}get(e){const t=[];for(const i of this._edits)i._type===$t.Text&&i.uri.toString()===e.toString()&&t.push(i.edit);return t}entries(){const e=new on;for(const t of this._edits)if(t._type===$t.Text){let i=e.get(t.uri);i||(i=[t.uri,[]],e.set(t.uri,i)),i[1].push(t.edit)}return[...e.values()]}get size(){return this.entries().length}toJSON(){return this.entries()}};_l=V([pe],_l);let vl=qo=class{static isSnippetString(e){return e instanceof qo?!0:e?typeof e.value=="string":!1}static _escape(e){return e.replace(/\$|}|\\/g,"\\$&")}constructor(e){this._tabstop=1,this.value=e||""}appendText(e){return this.value+=qo._escape(e),this}appendTabstop(e=this._tabstop++){return this.value+="$",this.value+=e,this}appendPlaceholder(e,t=this._tabstop++){if(typeof e=="function"){const i=new qo;i._tabstop=this._tabstop,e(i),this._tabstop=i._tabstop,e=i.value}else e=qo._escape(e);return this.value+="${",this.value+=t,this.value+=":",this.value+=e,this.value+="}",this}appendChoice(e,t=this._tabstop++){const i=e.map(r=>r.replaceAll(/[|\\,]/g,"\\$&")).join(",");return this.value+="${",this.value+=t,this.value+="|",this.value+=i,this.value+="|}",this}appendVariable(e,t){if(typeof t=="function"){const i=new qo;i._tabstop=this._tabstop,t(i),this._tabstop=i._tabstop,t=i.value}else typeof t=="string"&&(t=t.replace(/\$|}/g,"\\$&"));return this.value+="${",this.value+=e,t&&(this.value+=":",this.value+=t),this.value+="}",this}};vl=qo=V([pe],vl);var ha;(function(n){n[n.Unnecessary=1]="Unnecessary",n[n.Deprecated=2]="Deprecated"})(ha||(ha={}));var Sn;(function(n){n[n.Hint=3]="Hint",n[n.Information=2]="Information",n[n.Warning=1]="Warning",n[n.Error=0]="Error"})(Sn||(Sn={}));let Ti=kw=class{static isLocation(e){return e instanceof kw?!0:e?Oe.isRange(e.range)&&y.isUri(e.uri):!1}constructor(e,t){if(this.uri=e,t)if(Oe.isRange(t))this.range=Oe.of(t);else if(We.isPosition(t))this.range=new Oe(t,t);else throw new Error("Illegal argument")}toJSON(){return{uri:this.uri,range:this.range}}};Ti=kw=V([pe],Ti);let xh=class{static is(e){return e?typeof e.message=="string"&&e.location&&Oe.isRange(e.location.range)&&y.isUri(e.location.uri):!1}constructor(e,t){this.location=e,this.message=t}static isEqual(e,t){return e===t?!0:!e||!t?!1:e.message===t.message&&e.location.range.isEqual(t.location.range)&&e.location.uri.toString()===t.location.uri.toString()}};xh=V([pe],xh);let Wg=class{constructor(e,t,i=Sn.Error){if(!Oe.isRange(e))throw new TypeError("range must be set");if(!t)throw new TypeError("message must be set");this.range=e,this.message=t,this.severity=i}toJSON(){return{severity:Sn[this.severity],message:this.message,range:this.range,source:this.source,code:this.code}}static isEqual(e,t){return e===t?!0:!e||!t?!1:e.message===t.message&&e.severity===t.severity&&e.code===t.code&&e.severity===t.severity&&e.source===t.source&&e.range.isEqual(t.range)&&$r(e.tags,t.tags)&&$r(e.relatedInformation,t.relatedInformation,xh.isEqual)}};Wg=V([pe],Wg);let Vg=class{constructor(e,t){if(!e)throw new Error("Illegal argument, contents must be defined");Array.isArray(e)?this.contents=e:this.contents=[e],this.range=t}};Vg=V([pe],Vg);let zg=class extends Vg{constructor(e,t,i,r){super(e,t),this.canIncreaseVerbosity=i,this.canDecreaseVerbosity=r}};zg=V([pe],zg);var Rw;(function(n){n[n.Increase=0]="Increase",n[n.Decrease=1]="Decrease"})(Rw||(Rw={}));var Eh;(function(n){n[n.Text=0]="Text",n[n.Read=1]="Read",n[n.Write=2]="Write"})(Eh||(Eh={}));let qg=class{constructor(e,t=Eh.Text){this.range=e,this.kind=t}toJSON(){return{range:this.range,kind:Eh[this.kind]}}};qg=V([pe],qg);let jg=class{constructor(e,t){this.uri=e,this.highlights=t}toJSON(){return{uri:this.uri,highlights:this.highlights.map(e=>e.toJSON())}}};jg=V([pe],jg);var ft;(function(n){n[n.File=0]="File",n[n.Module=1]="Module",n[n.Namespace=2]="Namespace",n[n.Package=3]="Package",n[n.Class=4]="Class",n[n.Method=5]="Method",n[n.Property=6]="Property",n[n.Field=7]="Field",n[n.Constructor=8]="Constructor",n[n.Enum=9]="Enum",n[n.Interface=10]="Interface",n[n.Function=11]="Function",n[n.Variable=12]="Variable",n[n.Constant=13]="Constant",n[n.String=14]="String",n[n.Number=15]="Number",n[n.Boolean=16]="Boolean",n[n.Array=17]="Array",n[n.Object=18]="Object",n[n.Key=19]="Key",n[n.Null=20]="Null",n[n.EnumMember=21]="EnumMember",n[n.Struct=22]="Struct",n[n.Event=23]="Event",n[n.Operator=24]="Operator",n[n.TypeParameter=25]="TypeParameter"})(ft||(ft={}));var Sh;(function(n){n[n.Deprecated=1]="Deprecated"})(Sh||(Sh={}));let Dh=Iw=class{static validate(e){if(!e.name)throw new Error("name must not be falsy")}constructor(e,t,i,r,s){this.name=e,this.kind=t,this.containerName=s,typeof i=="string"&&(this.containerName=i),r instanceof Ti?this.location=r:i instanceof Oe&&(this.location=new Ti(r,i)),Iw.validate(this)}toJSON(){return{name:this.name,kind:ft[this.kind],location:this.location,containerName:this.containerName}}};Dh=Iw=V([pe],Dh);let kh=Np=class{static validate(e){var t;if(!e.name)throw new Error("name must not be falsy");if(!e.range.contains(e.selectionRange))throw new Error("selectionRange must be contained in fullRange");(t=e.children)==null||t.forEach(Np.validate)}constructor(e,t,i,r,s){this.name=e,this.detail=t,this.kind=i,this.range=r,this.selectionRange=s,this.children=[],Np.validate(this)}};kh=Np=V([pe],kh);var Ih;(function(n){n[n.Invoke=1]="Invoke",n[n.Automatic=2]="Automatic"})(Ih||(Ih={}));let Ch=class{constructor(e,t){this.title=e,this.kind=t}};Ch=V([pe],Ch);var sl;let Tt=(sl=class{constructor(e){this.value=e}append(e){return new Sd(this.value?this.value+Sd.sep+e:e)}intersects(e){return this.contains(e)||e.contains(this)}contains(e){return this.value===e.value||e.value.startsWith(this.value+Sd.sep)}},Sd=sl,sl.sep=".",sl);Tt=Sd=V([pe],Tt);Tt.Empty=new Tt("");Tt.QuickFix=Tt.Empty.append("quickfix");Tt.Refactor=Tt.Empty.append("refactor");Tt.RefactorExtract=Tt.Refactor.append("extract");Tt.RefactorInline=Tt.Refactor.append("inline");Tt.RefactorMove=Tt.Refactor.append("move");Tt.RefactorRewrite=Tt.Refactor.append("rewrite");Tt.Source=Tt.Empty.append("source");Tt.SourceOrganizeImports=Tt.Source.append("organizeImports");Tt.SourceFixAll=Tt.Source.append("fixAll");Tt.Notebook=Tt.Empty.append("notebook");let Ph=class{constructor(e,t){if(this.range=e,this.parent=t,t&&!t.range.contains(this.range))throw new Error("Invalid argument: parent must contain this range")}};Ph=V([pe],Ph);let Mx=class{constructor(e,t,i,r,s,o){this.kind=e,this.name=t,this.detail=i,this.uri=r,this.range=s,this.selectionRange=o}},HC=class{constructor(e,t){this.fromRanges=t,this.from=e}},BC=class{constructor(e,t){this.fromRanges=t,this.to=e}};var Cc;(function(n){n[n.Information=0]="Information",n[n.Warning=1]="Warning",n[n.Error=2]="Error"})(Cc||(Cc={}));let Gg=class{constructor(e,t){this.range=e,this.command=t}get isResolved(){return!!this.command}};Gg=V([pe],Gg);var Pn,eI;let pi=Cw=(eI=class{constructor(e,t=!1){ge(this,Pn);ie(this,Pn,new hg(e,{supportThemeIcons:t}))}static isMarkdownString(e){return e instanceof Cw?!0:e&&e.appendCodeblock&&e.appendMarkdown&&e.appendText&&e.value!==void 0}get value(){return A(this,Pn).value}set value(e){A(this,Pn).value=e}get isTrusted(){return A(this,Pn).isTrusted}set isTrusted(e){A(this,Pn).isTrusted=e}get supportThemeIcons(){return A(this,Pn).supportThemeIcons}set supportThemeIcons(e){A(this,Pn).supportThemeIcons=e}get supportHtml(){return A(this,Pn).supportHtml}set supportHtml(e){A(this,Pn).supportHtml=e}get baseUri(){return A(this,Pn).baseUri}set baseUri(e){A(this,Pn).baseUri=e}appendText(e){return A(this,Pn).appendText(e),this}appendMarkdown(e){return A(this,Pn).appendMarkdown(e),this}appendCodeblock(e,t){return A(this,Pn).appendCodeblock(t??"",e),this}},Pn=new WeakMap,eI);pi=Cw=V([pe],pi);let Lw=class{constructor(e,t){this.label=e,this.documentation=t}};Lw=V([pe],Lw);let Nw=class{constructor(e,t){this.label=e,this.documentation=t,this.parameters=[]}};Nw=V([pe],Nw);let Ow=class{constructor(){this.activeSignature=0,this.activeParameter=0,this.signatures=[]}};Ow=V([pe],Ow);var Fw;(function(n){n[n.Invoke=1]="Invoke",n[n.TriggerCharacter=2]="TriggerCharacter",n[n.ContentChange=3]="ContentChange"})(Fw||(Fw={}));var Mw;(function(n){n[n.Type=1]="Type",n[n.Parameter=2]="Parameter"})(Mw||(Mw={}));let Qg=class{constructor(e){this.value=e}};Qg=V([pe],Qg);let Jg=class{constructor(e,t,i){this.position=e,this.label=t,this.kind=i}};Jg=V([pe],Jg);var Pc;(function(n){n[n.Invoke=0]="Invoke",n[n.TriggerCharacter=1]="TriggerCharacter",n[n.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(Pc||(Pc={}));var xe;(function(n){n[n.Text=0]="Text",n[n.Method=1]="Method",n[n.Function=2]="Function",n[n.Constructor=3]="Constructor",n[n.Field=4]="Field",n[n.Variable=5]="Variable",n[n.Class=6]="Class",n[n.Interface=7]="Interface",n[n.Module=8]="Module",n[n.Property=9]="Property",n[n.Unit=10]="Unit",n[n.Value=11]="Value",n[n.Enum=12]="Enum",n[n.Keyword=13]="Keyword",n[n.Snippet=14]="Snippet",n[n.Color=15]="Color",n[n.File=16]="File",n[n.Reference=17]="Reference",n[n.Folder=18]="Folder",n[n.EnumMember=19]="EnumMember",n[n.Constant=20]="Constant",n[n.Struct=21]="Struct",n[n.Event=22]="Event",n[n.Operator=23]="Operator",n[n.TypeParameter=24]="TypeParameter",n[n.User=25]="User",n[n.Issue=26]="Issue"})(xe||(xe={}));var Th;(function(n){n[n.Deprecated=1]="Deprecated"})(Th||(Th={}));let Xg=class{constructor(e,t){this.label=e,this.kind=t}toJSON(){return{label:this.label,kind:this.kind&&xe[this.kind],detail:this.detail,documentation:this.documentation,sortText:this.sortText,filterText:this.filterText,preselect:this.preselect,insertText:this.insertText,textEdit:this.textEdit}}};Xg=V([pe],Xg);let wu=class{constructor(e=[],t=!1){this.items=e,this.isIncomplete=t}};wu=V([pe],wu);let $w=class{constructor(e,t,i){this.insertText=e,this.range=t,this.command=i}};$w=V([pe],$w);let Uw=class{constructor(e){this.commands=void 0,this.suppressSuggestions=void 0,this.items=e}};Uw=V([pe],Uw);var fa;(function(n){n[n.Unknown=0]="Unknown",n[n.Word=1]="Word",n[n.Line=2]="Line",n[n.Suggest=3]="Suggest"})(fa||(fa={}));var Ah;(function(n){n[n.Active=-1]="Active",n[n.Beside=-2]="Beside",n[n.One=1]="One",n[n.Two=2]="Two",n[n.Three=3]="Three",n[n.Four=4]="Four",n[n.Five=5]="Five",n[n.Six=6]="Six",n[n.Seven=7]="Seven",n[n.Eight=8]="Eight",n[n.Nine=9]="Nine"})(Ah||(Ah={}));var _o;(function(n){n[n.Left=1]="Left",n[n.Right=2]="Right"})(_o||(_o={}));function t3(n,e){return`${Ke.toKey(n)}.${e}`}var Ki;(function(n){n[n.Off=0]="Off",n[n.On=1]="On",n[n.Relative=2]="Relative",n[n.Interval=3]="Interval"})(Ki||(Ki={}));var Tc;(function(n){n[n.Manual=1]="Manual",n[n.AfterDelay=2]="AfterDelay",n[n.FocusOut=3]="FocusOut"})(Tc||(Tc={}));var Yg;(function(n){n[n.Default=0]="Default",n[n.InCenter=1]="InCenter",n[n.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",n[n.AtTop=3]="AtTop"})(Yg||(Yg={}));var bu;(function(n){n[n.Keyboard=1]="Keyboard",n[n.Mouse=2]="Mouse",n[n.Command=3]="Command"})(bu||(bu={}));var Ac;(function(n){n[n.Addition=1]="Addition",n[n.Deletion=2]="Deletion",n[n.Modification=3]="Modification"})(Ac||(Ac={}));var Rh;(function(n){n[n.Undo=1]="Undo",n[n.Redo=2]="Redo"})(Rh||(Rh={}));var pa;(function(n){n[n.OpenOpen=0]="OpenOpen",n[n.ClosedClosed=1]="ClosedClosed",n[n.OpenClosed=2]="OpenClosed",n[n.ClosedOpen=3]="ClosedOpen"})(pa||(pa={}));(function(n){function e(t){switch(t){case"keyboard":return n.Keyboard;case"mouse":return n.Mouse;case Qd.PROGRAMMATIC:case Qd.JUMP:case Qd.NAVIGATION:return n.Command}}n.fromValue=e})(bu||(bu={}));var yu;(function(n){n[n.Other=0]="Other",n[n.Comment=1]="Comment",n[n.String=2]="String",n[n.RegEx=3]="RegEx"})(yu||(yu={}));(function(n){function e(t){switch(t){case n.Other:return"other";case n.Comment:return"comment";case n.String:return"string";case n.RegEx:return"regex"}return"other"}n.toString=e})(yu||(yu={}));let Zg=class{constructor(e,t){if(t&&!y.isUri(t))throw Be("target");if(!Oe.isRange(e)||e.isEmpty)throw Be("range");this.range=e,this.target=t}};Zg=V([pe],Zg);let xu=class{constructor(e,t,i,r){this.red=e,this.green=t,this.blue=i,this.alpha=r}};xu=V([pe],xu);let Kg=class{constructor(e,t){if(t&&!(t instanceof xu))throw Be("color");if(!Oe.isRange(e)||e.isEmpty)throw Be("range");this.range=e,this.color=t}};Kg=V([pe],Kg);let em=class{constructor(e){if(!e||typeof e!="string")throw Be("label");this.label=e}};em=V([pe],em);var _4;(function(n){n[n.RGB=0]="RGB",n[n.HEX=1]="HEX",n[n.HSL=2]="HSL"})(_4||(_4={}));var Hw;(function(n){n[n.Error=0]="Error",n[n.Warning=1]="Warning",n[n.Information=2]="Information"})(Hw||(Hw={}));var Bw;(function(n){n[n.Unknown=0]="Unknown",n[n.Shutdown=1]="Shutdown",n[n.Process=2]="Process",n[n.User=3]="User",n[n.Extension=4]="Extension"})(Bw||(Bw={}));var Lh;(function(n){n[n.Low=0]="Low",n[n.Medium=1]="Medium",n[n.High=2]="High"})(Lh||(Lh={}));var Ww;(function(n){n[n.Sh=1]="Sh",n[n.Bash=2]="Bash",n[n.Fish=3]="Fish",n[n.Csh=4]="Csh",n[n.Ksh=5]="Ksh",n[n.Zsh=6]="Zsh",n[n.CommandPrompt=7]="CommandPrompt",n[n.GitBash=8]="GitBash",n[n.PowerShell=9]="PowerShell",n[n.Python=10]="Python",n[n.Julia=11]="Julia",n[n.NuShell=12]="NuShell",n[n.Node=13]="Node"})(Ww||(Ww={}));class n3{constructor(e,t,i){if(this.startIndex=e,this.length=t,this.tooltip=i,typeof e!="number"||e<0)throw Be("startIndex");if(typeof t!="number"||t<1)throw Be("length");if(i!==void 0&&typeof i!="string")throw Be("tooltip")}}class i3{constructor(e){this.uri=e}}class r3{constructor(e){this.terminalCommand=e}}var Vw;(function(n){n[n.Panel=1]="Panel",n[n.Editor=2]="Editor"})(Vw||(Vw={}));class s3{constructor(e){if(this.options=e,typeof e!="object")throw Be("options")}}var zw;(function(n){n[n.File=0]="File",n[n.Folder=1]="Folder",n[n.Method=2]="Method",n[n.Alias=3]="Alias",n[n.Argument=4]="Argument",n[n.Option=5]="Option",n[n.OptionValue=6]="OptionValue",n[n.Flag=7]="Flag"})(zw||(zw={}));class o3{constructor(e,t,i,r,s,o,a,l,c){this.label=e,this.icon=t,this.detail=i,this.documentation=r,this.isFile=s,this.isDirectory=o,this.isKeyword=a,this.replacementIndex=l??0,this.replacementLength=c??0}}let a3=class{constructor(e,t){this.items=e??[],this.resourceRequestConfig=t}};var qw;(function(n){n[n.Always=1]="Always",n[n.Silent=2]="Silent",n[n.Never=3]="Never"})(qw||(qw={}));var jw;(function(n){n.Changed="changed",n.ProcessStarted="processStarted",n.ProcessEnded="processEnded",n.Terminated="terminated",n.Start="start",n.AcquiredInput="acquiredInput",n.DependsOnStarted="dependsOnStarted",n.Active="active",n.Inactive="inactive",n.End="end",n.ProblemMatcherStarted="problemMatcherStarted",n.ProblemMatcherEnded="problemMatcherEnded",n.ProblemMatcherFoundErrors="problemMatcherFoundErrors"})(jw||(jw={}));var Gw;(function(n){n[n.Shared=1]="Shared",n[n.Dedicated=2]="Dedicated",n[n.New=3]="New"})(Gw||(Gw={}));var Ar;let Nh=(Ar=class{static from(e){switch(e){case"clean":return wr.Clean;case"build":return wr.Build;case"rebuild":return wr.Rebuild;case"test":return wr.Test;default:return}}constructor(e,t){if(this.label=t,typeof e!="string"||typeof t!="string")throw Be("name");this._id=e}get id(){return this._id}},wr=Ar,Ar.Clean=new wr("clean","Clean"),Ar.Build=new wr("build","Build"),Ar.Rebuild=new wr("rebuild","Rebuild"),Ar.Test=new wr("test","Test"),Ar);Nh=wr=V([pe],Nh);function WC(n){let e="";for(let t=0;t<n.length;t++)e+=n[t].replace(/,/g,",,")+",";return e}let Eu=class{constructor(e,t,i){if(typeof e!="string")throw Be("process");this._args=[],this._process=e,t!==void 0&&(Array.isArray(t)?(this._args=t,this._options=i):this._options=t)}get process(){return this._process}set process(e){if(typeof e!="string")throw Be("process");this._process=e}get args(){return this._args}set args(e){Array.isArray(e)||(e=[]),this._args=e}get options(){return this._options}set options(e){this._options=e}computeId(){const e=[];if(e.push("process"),this._process!==void 0&&e.push(this._process),this._args&&this._args.length>0)for(const t of this._args)e.push(t);return WC(e)}};Eu=V([pe],Eu);let wl=class{constructor(e,t,i){if(this._args=[],Array.isArray(t)){if(!e)throw Be("command can't be undefined or null");if(typeof e!="string"&&typeof e.value!="string")throw Be("command");this._command=e,t&&(this._args=t),this._options=i}else{if(typeof e!="string")throw Be("commandLine");this._commandLine=e,this._options=t}}get commandLine(){return this._commandLine}set commandLine(e){if(typeof e!="string")throw Be("commandLine");this._commandLine=e}get command(){return this._command?this._command:""}set command(e){if(typeof e!="string"&&typeof e.value!="string")throw Be("command");this._command=e}get args(){return this._args}set args(e){this._args=e||[]}get options(){return this._options}set options(e){this._options=e}computeId(){const e=[];if(e.push("shell"),this._commandLine!==void 0&&e.push(this._commandLine),this._command!==void 0&&e.push(typeof this._command=="string"?this._command:this._command.value),this._args&&this._args.length>0)for(const t of this._args)e.push(typeof t=="string"?t:t.value);return WC(e)}};wl=V([pe],wl);var Qw;(function(n){n[n.Escape=1]="Escape",n[n.Strong=2]="Strong",n[n.Weak=3]="Weak"})(Qw||(Qw={}));var Po;(function(n){n[n.Global=1]="Global",n[n.Workspace=2]="Workspace"})(Po||(Po={}));class $x{constructor(e){this._callback=e}computeId(){return"customExecution"+Mn()}set callback(e){this._callback=e}get callback(){return this._callback}}var Rr;let tm=(Rr=class{constructor(e,t,i,r,s,o){this.__deprecated=!1,this._definition=this.definition=e;let a;typeof t=="string"?(this._name=this.name=t,this._source=this.source=i,this.execution=r,a=s,this.__deprecated=!0):t===Po.Global||t===Po.Workspace?(this.target=t,this._name=this.name=i,this._source=this.source=r,this.execution=s,a=o):(this.target=t,this._name=this.name=i,this._source=this.source=r,this.execution=s,a=o),typeof a=="string"?(this._problemMatchers=[a],this._hasDefinedMatchers=!0):Array.isArray(a)?(this._problemMatchers=a,this._hasDefinedMatchers=!0):(this._problemMatchers=[],this._hasDefinedMatchers=!1),this._isBackground=!1,this._presentationOptions=Object.create(null),this._runOptions=Object.create(null)}get _id(){return this.__id}set _id(e){this.__id=e}get _deprecated(){return this.__deprecated}clear(){this.__id!==void 0&&(this.__id=void 0,this._scope=void 0,this.computeDefinitionBasedOnExecution())}computeDefinitionBasedOnExecution(){this._execution instanceof Eu?this._definition={type:br.ProcessType,id:this._execution.computeId()}:this._execution instanceof wl?this._definition={type:br.ShellType,id:this._execution.computeId()}:this._execution instanceof $x?this._definition={type:br.ExtensionCallbackType,id:this._execution.computeId()}:this._definition={type:br.EmptyType,id:Mn()}}get definition(){return this._definition}set definition(e){if(e==null)throw Be("Kind can't be undefined or null");this.clear(),this._definition=e}get scope(){return this._scope}set target(e){this.clear(),this._scope=e}get name(){return this._name}set name(e){if(typeof e!="string")throw Be("name");this.clear(),this._name=e}get execution(){return this._execution}set execution(e){e===null&&(e=void 0),this.clear(),this._execution=e;const t=this._definition.type;(br.EmptyType===t||br.ProcessType===t||br.ShellType===t||br.ExtensionCallbackType===t)&&this.computeDefinitionBasedOnExecution()}get problemMatchers(){return this._problemMatchers}set problemMatchers(e){if(Array.isArray(e))this.clear(),this._problemMatchers=e,this._hasDefinedMatchers=!0;else{this.clear(),this._problemMatchers=[],this._hasDefinedMatchers=!1;return}}get hasDefinedMatchers(){return this._hasDefinedMatchers}get isBackground(){return this._isBackground}set isBackground(e){e!==!0&&e!==!1&&(e=!1),this.clear(),this._isBackground=e}get source(){return this._source}set source(e){if(typeof e!="string"||e.length===0)throw Be("source must be a string of length > 0");this.clear(),this._source=e}get group(){return this._group}set group(e){e===null&&(e=void 0),this.clear(),this._group=e}get detail(){return this._detail}set detail(e){e===null&&(e=void 0),this._detail=e}get presentationOptions(){return this._presentationOptions}set presentationOptions(e){e==null&&(e=Object.create(null)),this.clear(),this._presentationOptions=e}get runOptions(){return this._runOptions}set runOptions(e){e==null&&(e=Object.create(null)),this.clear(),this._runOptions=e}},br=Rr,Rr.ExtensionCallbackType="customExecution",Rr.ProcessType="process",Rr.ShellType="shell",Rr.EmptyType="$empty",Rr);tm=br=V([pe],tm);var Ga;(function(n){n[n.SourceControl=1]="SourceControl",n[n.Window=10]="Window",n[n.Notification=15]="Notification"})(Ga||(Ga={}));var Jw;(function(n){function e(t){const i=t;return Ua(i.value)?i.tooltip&&!Ze(i.tooltip)?(console.log("INVALID view badge, invalid tooltip",i.tooltip),!1):!0:(console.log("INVALID view badge, invalid value",i.value),!1)}n.isViewBadge=e})(Jw||(Jw={}));let nm=Pw=class{static isTreeItem(e,t){var r,s;const i=e;if(i.checkboxState!==void 0){const o=Ua(i.checkboxState)?i.checkboxState:Zt(i.checkboxState)&&Ua(i.checkboxState.state)?i.checkboxState.state:void 0,a=!Ua(i.checkboxState)&&Zt(i.checkboxState)?i.checkboxState.tooltip:void 0;if(o===void 0||o!==Tr.Checked&&o!==Tr.Unchecked||a!==void 0&&!Ze(a))return console.log("INVALID tree item, invalid checkboxState",i.checkboxState),!1}if(e instanceof Pw)return!0;if(i.label!==void 0&&!Ze(i.label)&&!((r=i.label)!=null&&r.label))return console.log("INVALID tree item, invalid label",i.label),!1;if(i.id!==void 0&&!Ze(i.id))return console.log("INVALID tree item, invalid id",i.id),!1;if(i.iconPath!==void 0&&!Ze(i.iconPath)&&!y.isUri(i.iconPath)&&(!i.iconPath||!Ze(i.iconPath.id))){const o=i.iconPath;if(!o||!Ze(o.light)&&!y.isUri(o.light)&&!Ze(o.dark)&&!y.isUri(o.dark))return console.log("INVALID tree item, invalid iconPath",i.iconPath),!1}return i.description!==void 0&&!Ze(i.description)&&typeof i.description!="boolean"?(console.log("INVALID tree item, invalid description",i.description),!1):i.resourceUri!==void 0&&!y.isUri(i.resourceUri)?(console.log("INVALID tree item, invalid resourceUri",i.resourceUri),!1):i.tooltip!==void 0&&!Ze(i.tooltip)&&!(i.tooltip instanceof pi)?(console.log("INVALID tree item, invalid tooltip",i.tooltip),!1):i.command!==void 0&&!i.command.command?(console.log("INVALID tree item, invalid command",i.command),!1):i.collapsibleState!==void 0&&i.collapsibleState<Qa.None&&i.collapsibleState>Qa.Expanded?(console.log("INVALID tree item, invalid collapsibleState",i.collapsibleState),!1):i.contextValue!==void 0&&!Ze(i.contextValue)?(console.log("INVALID tree item, invalid contextValue",i.contextValue),!1):i.accessibilityInformation!==void 0&&!((s=i.accessibilityInformation)!=null&&s.label)?(console.log("INVALID tree item, invalid accessibilityInformation",i.accessibilityInformation),!1):!0}constructor(e,t=Qa.None){this.collapsibleState=t,y.isUri(e)?this.resourceUri=e:this.label=e}};nm=Pw=V([pe],nm);var Qa;(function(n){n[n.None=0]="None",n[n.Collapsed=1]="Collapsed",n[n.Expanded=2]="Expanded"})(Qa||(Qa={}));var Tr;(function(n){n[n.Unchecked=0]="Unchecked",n[n.Checked=1]="Checked"})(Tr||(Tr={}));let im=class{async asString(){return typeof this.value=="string"?this.value:JSON.stringify(this.value)}asFile(){}constructor(e){this.value=e}};im=V([pe],im);class rm extends im{}var Sf;class l3 extends rm{constructor(t){super("");ge(this,Sf);ie(this,Sf,t)}asFile(){return A(this,Sf)}}Sf=new WeakMap;class c3{constructor(e,t,i,r){this.name=e,this.uri=t,this._itemId=i,this._getData=r}data(){return this._getData()}}var _s,Sa,Dd,tI;let Su=(tI=class{constructor(e){ge(this,Sa);ge(this,_s,new Map);for(const[t,i]of e??[]){const r=A(this,_s).get(ld(this,Sa,Dd).call(this,t));r?r.push(i):A(this,_s).set(ld(this,Sa,Dd).call(this,t),[i])}}get(e){var t;return(t=A(this,_s).get(ld(this,Sa,Dd).call(this,e)))==null?void 0:t[0]}set(e,t){A(this,_s).set(ld(this,Sa,Dd).call(this,e),[t])}forEach(e,t){for(const[i,r]of A(this,_s))for(const s of r)e.call(t,s,i,this)}*[Symbol.iterator](){for(const[e,t]of A(this,_s))for(const i of t)yield[e,i]}},_s=new WeakMap,Sa=new WeakSet,Dd=function(e){return e.toLowerCase()},tI);Su=V([pe],Su);let Xw=class{constructor(e,t,i){this.insertText=e,this.title=t,this.kind=i}};Xw=V([pe],Xw);var Yw;(function(n){n[n.Automatic=0]="Automatic",n[n.PasteAs=1]="PasteAs"})(Yw||(Yw={}));const wc=class wc{constructor(e){this.value=e}append(...e){return new wc((this.value?[this.value,...e]:e).join(wc.sep))}intersects(e){return this.contains(e)||e.contains(this)}contains(e){return this.value===e.value||e.value.startsWith(this.value+wc.sep)}};wc.sep=".";let zr=wc;zr.Empty=new zr("");zr.Text=new zr("text");zr.TextUpdateImports=zr.Text.append("updateImports");class u3{constructor(e,t,i){this.title=t,this.insertText=e,this.kind=i}}let qn=class{constructor(e,t){this.id=e,this.color=t}static isThemeIcon(e){return typeof e.id!="string"?(console.log("INVALID ThemeIcon, invalid id",e.id),!1):!0}};qn=V([pe],qn);qn.File=new qn("file");qn.Folder=new qn("folder");let Oh=class{constructor(e){this.id=e}};Oh=V([pe],Oh);var Rc;(function(n){n[n.Global=1]="Global",n[n.Workspace=2]="Workspace",n[n.WorkspaceFolder=3]="WorkspaceFolder"})(Rc||(Rc={}));let Lc=class{get base(){return this._base}set base(e){this._base=e,this._baseUri=y.file(e)}get baseUri(){return this._baseUri}set baseUri(e){this._baseUri=e,this._base=e.fsPath}constructor(e,t){if(typeof e!="string"&&(!e||!y.isUri(e)&&!y.isUri(e.uri)))throw Be("base");if(typeof t!="string")throw Be("pattern");typeof e=="string"?this.baseUri=y.file(e):y.isUri(e)?this.baseUri=e:this.baseUri=e.uri,this.pattern=t}toJSON(){return{pattern:this.pattern,base:this.base,baseUri:this.baseUri.toJSON()}}};Lc=V([pe],Lc);const VC=new WeakMap;function d3(n,e){VC.set(n,e)}let Du=class{constructor(e,t,i,r,s){this.enabled=typeof e=="boolean"?e:!0,typeof t=="string"&&(this.condition=t),typeof i=="string"&&(this.hitCondition=i),typeof r=="string"&&(this.logMessage=r),typeof s=="string"&&(this.mode=s)}get id(){return this._id||(this._id=VC.get(this)??Mn()),this._id}};Du=V([pe],Du);let ga=class extends Du{constructor(e,t,i,r,s,o){if(super(t,i,r,s,o),e===null)throw Be("location");this.location=e}};ga=V([pe],ga);let ma=class extends Du{constructor(e,t,i,r,s,o){super(t,i,r,s,o),this.functionName=e}};ma=V([pe],ma);let sm=class extends Du{constructor(e,t,i,r,s,o,a,l){if(super(r,s,o,a,l),!t)throw Be("dataId");this.label=e,this.dataId=t,this.canPersist=i}};sm=V([pe],sm);let om=class{constructor(e,t,i){this.command=e,this.args=t||[],this.options=i}};om=V([pe],om);let Fh=class{constructor(e,t){this.port=e,this.host=t}};Fh=V([pe],Fh);let am=class{constructor(e){this.path=e}};am=V([pe],am);let Mh=class{constructor(e){this.implementation=e}};Mh=V([pe],Mh);class zC{constructor(e,t,i){this.session=e,this.threadId=t,this.frameId=i}}class qC{constructor(e,t){this.session=e,this.threadId=t}}let lm=class{constructor(e,t){this.range=e,this.expression=t}};lm=V([pe],lm);var $h;(function(n){n[n.Invoke=0]="Invoke",n[n.Automatic=1]="Automatic"})($h||($h={}));let cm=class{constructor(e,t){this.range=e,this.text=t}};cm=V([pe],cm);let um=class{constructor(e,t,i=!0){this.range=e,this.variableName=t,this.caseSensitiveLookup=i}};um=V([pe],um);let dm=class{constructor(e,t){this.range=e,this.expression=t}};dm=V([pe],dm);let Zw=class{constructor(e,t){this.frameId=e,this.stoppedLocation=t}};Zw=V([pe],Zw);var Kw;(function(n){n[n.AIGenerated=1]="AIGenerated"})(Kw||(Kw={}));var Uh;(function(n){n[n.Invoke=0]="Invoke",n[n.Automatic=1]="Automatic"})(Uh||(Uh={}));class h3{constructor(e,t){this.newSymbolName=e,this.tags=t}}var Nc;(function(n){n[n.Changed=1]="Changed",n[n.Created=2]="Created",n[n.Deleted=3]="Deleted"})(Nc||(Nc={}));let en=Xn=class extends Error{static FileExists(e){return new Xn(e,Ne.FileExists,Xn.FileExists)}static FileNotFound(e){return new Xn(e,Ne.FileNotFound,Xn.FileNotFound)}static FileNotADirectory(e){return new Xn(e,Ne.FileNotADirectory,Xn.FileNotADirectory)}static FileIsADirectory(e){return new Xn(e,Ne.FileIsADirectory,Xn.FileIsADirectory)}static NoPermissions(e){return new Xn(e,Ne.NoPermissions,Xn.NoPermissions)}static Unavailable(e){return new Xn(e,Ne.Unavailable,Xn.Unavailable)}constructor(e,t=Ne.Unknown,i){super(y.isUri(e)?e.toString(!0):e),this.code=(i==null?void 0:i.name)??"Unknown",XI(this,t),Object.setPrototypeOf(this,Xn.prototype),typeof Error.captureStackTrace=="function"&&typeof i=="function"&&Error.captureStackTrace(this,i)}};en=Xn=V([pe],en);let eb=class{constructor(e,t,i){this.start=e,this.end=t,this.kind=i}};eb=V([pe],eb);var fs;(function(n){n[n.Comment=1]="Comment",n[n.Imports=2]="Imports",n[n.Region=3]="Region"})(fs||(fs={}));var Hh;(function(n){n[n.Collapsed=0]="Collapsed",n[n.Expanded=1]="Expanded"})(Hh||(Hh={}));var tb;(function(n){n[n.Editing=0]="Editing",n[n.Preview=1]="Preview"})(tb||(tb={}));var nb;(function(n){n[n.Published=0]="Published",n[n.Draft=1]="Draft"})(nb||(nb={}));var Bh;(function(n){n[n.Unresolved=0]="Unresolved",n[n.Resolved=1]="Resolved"})(Bh||(Bh={}));var Wh;(function(n){n[n.Current=0]="Current",n[n.Outdated=1]="Outdated"})(Wh||(Wh={}));var Vh;(function(n){n[n.Reply=1]="Reply",n[n.Comment=2]="Comment"})(Vh||(Vh={}));class ib{constructor(e,t=[]){this.tokenTypes=e,this.tokenModifiers=t}}function f3(n){return typeof n>"u"||G7(n)}class Ux{constructor(e){if(this._prevLine=0,this._prevChar=0,this._dataIsSortedAndDeltaEncoded=!0,this._data=[],this._dataLen=0,this._tokenTypeStrToInt=new Map,this._tokenModifierStrToInt=new Map,this._hasLegend=!1,e){this._hasLegend=!0;for(let t=0,i=e.tokenTypes.length;t<i;t++)this._tokenTypeStrToInt.set(e.tokenTypes[t],t);for(let t=0,i=e.tokenModifiers.length;t<i;t++)this._tokenModifierStrToInt.set(e.tokenModifiers[t],t)}}push(e,t,i,r,s){if(typeof e=="number"&&typeof t=="number"&&typeof i=="number"&&typeof r=="number"&&(typeof s=="number"||typeof s>"u"))return typeof s>"u"&&(s=0),this._pushEncoded(e,t,i,r,s);if(Oe.isRange(e)&&typeof t=="string"&&f3(i))return this._push(e,t,i);throw Be()}_push(e,t,i){if(!this._hasLegend)throw new Error("Legend must be provided in constructor");if(e.start.line!==e.end.line)throw new Error("`range` cannot span multiple lines");if(!this._tokenTypeStrToInt.has(t))throw new Error("`tokenType` is not in the provided legend");const r=e.start.line,s=e.start.character,o=e.end.character-e.start.character,a=this._tokenTypeStrToInt.get(t);let l=0;if(i)for(const c of i){if(!this._tokenModifierStrToInt.has(c))throw new Error("`tokenModifier` is not in the provided legend");const u=this._tokenModifierStrToInt.get(c);l|=1<<u>>>0}this._pushEncoded(r,s,o,a,l)}_pushEncoded(e,t,i,r,s){if(this._dataIsSortedAndDeltaEncoded&&(e<this._prevLine||e===this._prevLine&&t<this._prevChar)){this._dataIsSortedAndDeltaEncoded=!1;const l=this._data.length/5|0;let c=0,u=0;for(let d=0;d<l;d++){let f=this._data[5*d],p=this._data[5*d+1];f===0?(f=c,p+=u):f+=c,this._data[5*d]=f,this._data[5*d+1]=p,c=f,u=p}}let o=e,a=t;this._dataIsSortedAndDeltaEncoded&&this._dataLen>0&&(o-=this._prevLine,o===0&&(a-=this._prevChar)),this._data[this._dataLen++]=o,this._data[this._dataLen++]=a,this._data[this._dataLen++]=i,this._data[this._dataLen++]=r,this._data[this._dataLen++]=s,this._prevLine=e,this._prevChar=t}static _sortAndDeltaEncode(e){const t=[],i=e.length/5|0;for(let a=0;a<i;a++)t[a]=a;t.sort((a,l)=>{const c=e[5*a],u=e[5*l];if(c===u){const d=e[5*a+1],f=e[5*l+1];return d-f}return c-u});const r=new Uint32Array(e.length);let s=0,o=0;for(let a=0;a<i;a++){const l=5*t[a],c=e[l+0],u=e[l+1],d=e[l+2],f=e[l+3],p=e[l+4],w=c-s,v=w===0?u-o:u,m=5*a;r[m+0]=w,r[m+1]=v,r[m+2]=d,r[m+3]=f,r[m+4]=p,s=c,o=u}return r}build(e){return this._dataIsSortedAndDeltaEncoded?new ku(new Uint32Array(this._data),e):new ku(Ux._sortAndDeltaEncode(this._data),e)}}class ku{constructor(e,t){this.resultId=t,this.data=e}}class jC{constructor(e,t,i){this.start=e,this.deleteCount=t,this.data=i}}class Fp{constructor(e,t){this.resultId=t,this.edits=e}}var hm;(function(n){n[n.Separate=0]="Separate",n[n.MergeWithParent=1]="MergeWithParent"})(hm||(hm={}));class p3{constructor(e){this.name=e}}var rb;(function(n){n[n.Title=1]="Title",n[n.Inline=2]="Inline"})(rb||(rb={}));var Vc;let zh=(Vc=class{constructor(){}},Vc.Back={iconPath:new qn("arrow-left")},Vc);zh=V([pe],zh);var qh;(function(n){n[n.Separator=-1]="Separator",n[n.Default=0]="Default"})(qh||(qh={}));var Oc;(function(n){n[n.Info=1]="Info",n[n.Warning=2]="Warning",n[n.Error=3]="Error"})(Oc||(Oc={}));var Ja;(function(n){n[n.UI=1]="UI",n[n.Workspace=2]="Workspace"})(Ja||(Ja={}));class sb{static validate(e){if(typeof e.badge=="string"){let t=G2(e.badge,0);if(t<e.badge.length&&(t+=G2(e.badge,t)),e.badge.length>t)throw new Error("The 'badge'-property must be undefined or a short character")}else if(e.badge&&!qn.isThemeIcon(e.badge))throw new Error("The 'badge'-property is not a valid ThemeIcon");if(!e.color&&!e.badge&&!e.tooltip)throw new Error("The decoration is empty");return!0}constructor(e,t,i){this.badge=e,this.tooltip=t,this.color=i}}let fm=class{constructor(e){this.kind=e}};fm=V([pe],fm);var so;(function(n){n[n.Light=1]="Light",n[n.Dark=2]="Dark",n[n.HighContrast=3]="HighContrast",n[n.HighContrastLight=4]="HighContrastLight"})(so||(so={}));let Ss=class ob{static isNotebookRange(e){return e instanceof ob?!0:e?typeof e.start=="number"&&typeof e.end=="number":!1}get start(){return this._start}get end(){return this._end}get isEmpty(){return this._start===this._end}constructor(e,t){if(e<0)throw Be("start must be positive");if(t<0)throw Be("end must be positive");e<=t?(this._start=e,this._end=t):(this._start=t,this._end=e)}with(e){let t=this._start,i=this._end;return e.start!==void 0&&(t=e.start),e.end!==void 0&&(i=e.end),t===this._start&&i===this._end?this:new ob(t,i)}},g_=class ab{static validate(e){if(typeof e.kind!="number")throw new Error("NotebookCellData MUST have 'kind' property");if(typeof e.value!="string")throw new Error("NotebookCellData MUST have 'value' property");if(typeof e.languageId!="string")throw new Error("NotebookCellData MUST have 'languageId' property")}static isNotebookCellDataArray(e){return Array.isArray(e)&&e.every(t=>ab.isNotebookCellData(t))}static isNotebookCellData(e){return!0}constructor(e,t,i,r,s,o,a){this.kind=e,this.value=t,this.languageId=i,this.mime=r,this.outputs=s??[],this.metadata=o,this.executionSummary=a,ab.validate(this)}},GC=class{constructor(e){this.cells=e}};var li,R1;let QC=(li=class{static isNotebookCellOutputItem(e){return e instanceof li?!0:e?typeof e.mime=="string"&&e.data instanceof Uint8Array:!1}static error(e){const t={name:e.name,message:e.message,stack:e.stack};return li.json(t,"application/vnd.code.notebook.error")}static stdout(e){return li.text(e,"application/vnd.code.notebook.stdout")}static stderr(e){return li.text(e,"application/vnd.code.notebook.stderr")}static bytes(e,t="application/octet-stream"){return new li(e,t)}static text(e,t=Ts.text){const i=A(li,R1).encode(String(e));return new li(i,t)}static json(e,t="text/x-json"){const i=JSON.stringify(e,void 0,"	");return li.text(i,t)}constructor(e,t){this.data=e,this.mime=t;const i=_C(t,!0);if(!i)throw new Error(`INVALID mime type: ${t}. Must be in the format "type/subtype[;optionalparameter]"`);this.mime=i}},R1=new WeakMap,ge(li,R1,new TextEncoder),li),pm=class lb{static isNotebookCellOutput(e){return e instanceof lb?!0:!e||typeof e!="object"?!1:typeof e.id=="string"&&Array.isArray(e.items)}static ensureUniqueMimeTypes(e,t=!1){const i=new Set,r=new Set;for(let s=0;s<e.length;s++){const o=e[s],a=_C(o.mime);if(!i.has(a)||NC(a)){i.add(a);continue}r.add(s),t&&console.warn(`DUPLICATED mime type '${o.mime}' will be dropped`)}return r.size===0?e:e.filter((s,o)=>!r.has(o))}constructor(e,t,i){this.items=lb.ensureUniqueMimeTypes(e,!0),typeof t=="string"?(this.id=t,this.metadata=i):(this.id=Mn(),this.metadata=t??i)}};class g3{constructor(e,t,i){this.label=e,this.uri=t,this.position=i}}var _a;(function(n){n[n.Markup=1]="Markup",n[n.Code=2]="Code"})(_a||(_a={}));var Iu;(function(n){n[n.Idle=1]="Idle",n[n.Pending=2]="Pending",n[n.Executing=3]="Executing"})(Iu||(Iu={}));var gm;(function(n){n[n.Left=1]="Left",n[n.Right=2]="Right"})(gm||(gm={}));var mm;(function(n){n[n.Default=0]="Default",n[n.InCenter=1]="InCenter",n[n.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",n[n.AtTop=3]="AtTop"})(mm||(mm={}));class m3{constructor(e,t){this.text=e,this.alignment=t}}var cb;(function(n){n[n.Default=1]="Default",n[n.Preferred=2]="Preferred"})(cb||(cb={}));var _m;(function(n){n[n.Default=1]="Default",n[n.Preferred=2]="Preferred",n[n.Hidden=-1]="Hidden"})(_m||(_m={}));let JC=class{constructor(e,t=[]){this.uri=e,this.provides=Bi(t)}},_3=class{constructor(e){this.label=e}};var jh;(function(n){n[n.Named=1]="Named",n[n.Indexed=2]="Indexed"})(jh||(jh={}));let ub=class{constructor(e,t){this.label=e,this.timestamp=t}};ub=V([pe],ub);var Fc;(function(n){n[n.Production=1]="Production",n[n.Development=2]="Development",n[n.Test=3]="Test"})(Fc||(Fc={}));var vm;(function(n){n[n.Node=1]="Node",n[n.Webworker=2]="Webworker"})(vm||(vm={}));var vo;(function(n){n[n.Other=0]="Other",n[n.Comment=1]="Comment",n[n.String=2]="String",n[n.RegEx=3]="RegEx"})(vo||(vo={}));class v3{constructor(e,t){this.ranges=e,this.wordPattern=t}}class w3{constructor(e){this._autoForwardAction=e}get autoForwardAction(){return this._autoForwardAction}}var db;(function(n){n[n.Queued=1]="Queued",n[n.Running=2]="Running",n[n.Passed=3]="Passed",n[n.Failed=4]="Failed",n[n.Skipped=5]="Skipped",n[n.Errored=6]="Errored"})(db||(db={}));var Mc;(function(n){n[n.Run=1]="Run",n[n.Debug=2]="Debug",n[n.Coverage=3]="Coverage"})(Mc||(Mc={}));class XC{constructor(e,t,i){this.controllerId=e,this.profileId=t,this.kind=i}}let wm=class{constructor(e=void 0,t=void 0,i=void 0,r=!1,s=!0){this.include=e,this.exclude=t,this.profile=i,this.continuous=r,this.preserveFocus=s}};wm=V([pe],wm);let bm=Tw=class{static diff(e,t,i){const r=new Tw(e);return r.expectedOutput=t,r.actualOutput=i,r}constructor(e){this.message=e}};bm=Tw=V([pe],bm);let Gh=class{constructor(e){this.id=e}};Gh=V([pe],Gh);class b3{constructor(e,t,i){this.label=e,this.uri=t,this.position=i}}class Mp{constructor(e,t){this.covered=e,this.total=t,$p(this)}}function $p(n){if(n){if(n.covered>n.total)throw new Error(`The total number of covered items (${n.covered}) cannot be greater than the total (${n.total})`);if(n.total<0)throw new Error(`The number of covered items (${n.total}) cannot be negative`)}}class Cu{static fromDetails(e,t){const i=new Mp(0,0),r=new Mp(0,0),s=new Mp(0,0);for(const a of t)if("branches"in a){i.total+=1,i.covered+=a.executed?1:0;for(const l of a.branches)r.total+=1,r.covered+=l.executed?1:0}else s.total+=1,s.covered+=a.executed?1:0;const o=new Cu(e,i,r.total>0?r:void 0,s.total>0?s:void 0);return o.detailedCoverage=t,o}constructor(e,t,i,r,s=[]){this.uri=e,this.statementCoverage=t,this.branchCoverage=i,this.declarationCoverage=r,this.includesTests=s}}class YC{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i=[]){this.executed=e,this.location=t,this.branches=i}}class ZC{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i){this.executed=e,this.location=t,this.label=i}}class KC{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i){this.name=e,this.executed=t,this.location=i}}var hb;(function(n){n[n.None=0]="None",n[n.Option=1]="Option",n[n.Default=2]="Default",n[n.Preferred=3]="Preferred"})(hb||(hb={}));var fb;(function(n){n[n.Untrusted=0]="Untrusted",n[n.Trusted=1]="Trusted",n[n.Unspecified=2]="Unspecified"})(fb||(fb={}));var pb;(function(n){n[n.Notify=1]="Notify",n[n.OpenBrowser=2]="OpenBrowser",n[n.OpenPreview=3]="OpenPreview",n[n.Silent=4]="Silent",n[n.Ignore=5]="Ignore",n[n.OpenBrowserOnce=6]="OpenBrowserOnce"})(pb||(pb={}));let Hx=class{constructor(e,t,i,r,s,o){this.kind=e,this.name=t,this.detail=i,this.uri=r,this.range=s,this.selectionRange=o}};class Bx{constructor(e){this.uri=e}}class ym{constructor(e,t){this.original=e,this.modified=t}}class e5{constructor(e,t,i,r){this.base=e,this.input1=t,this.input2=i,this.result=r}}class Wx{constructor(e,t){this.uri=e,this.viewType=t}}class t5{constructor(e){this.viewType=e}}class Vx{constructor(e,t){this.uri=e,this.notebookType=t}}class zx{constructor(e,t,i){this.original=e,this.modified=t,this.notebookType=i}}class n5{constructor(){}}class i5{constructor(e,t){this.uri=e,this.inputBoxUri=t}}class r5{constructor(){}}class s5{constructor(e){this.textDiffs=e}}var gb;(function(n){n[n.Down=0]="Down",n[n.Up=1]="Up"})(gb||(gb={}));var mb;(function(n){n[n.Action=1]="Action",n[n.Toolbar=2]="Toolbar"})(mb||(mb={}));var _b;(function(n){n[n.Short=1]="Short",n[n.Medium=2]="Medium",n[n.Full=3]="Full"})(_b||(_b={}));class y3{constructor(e,t,i){this.id=e,this.label=t,this.values=i}}var va;(function(n){n[n.Accepted=1]="Accepted",n[n.Rejected=2]="Rejected",n[n.Saved=3]="Saved"})(va||(va={}));var vb;(function(n){n[n.Unhelpful=0]="Unhelpful",n[n.Helpful=1]="Helpful",n[n.Undone=2]="Undone",n[n.Accepted=3]="Accepted",n[n.Bug=4]="Bug"})(vb||(vb={}));var Qh;(function(n){n[n.Unhelpful=0]="Unhelpful",n[n.Helpful=1]="Helpful"})(Qh||(Qh={}));let m_=class{constructor(e){if(typeof e!="string"&&e.isTrusted===!0)throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.");this.value=typeof e=="string"?new pi(e):e}},Jh=class{constructor(e,t){if(typeof e!="string"&&e.isTrusted===!0)throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.");this.value=typeof e=="string"?new pi(e):e,this.vulnerabilities=t}},xm=class{constructor(e,t,i,r){this.title=e,this.message=t,this.data=i,this.buttons=r}};class __{constructor(e,t){this.value=e,this.baseUri=t}}let Xh=class{constructor(e,t){this.value=e,this.value2=e,this.title=t}},qx=class{constructor(e){this.value=e}};class Up{constructor(e,t){this.value=e,this.task=t}}let Yh=class{constructor(e){if(typeof e!="string"&&e.isTrusted===!0)throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.");this.value=typeof e=="string"?new pi(e):e}},v_=class{constructor(e){this.value=e}},Xa=class{constructor(e,t,i){this.value=e,this.iconPath=t,this.options=i}},w_=class{constructor(e,t){this.value=e,this.isEdit=t}},Em=class{constructor(e,t,i){this.value=e,this.license=t,this.snippet=i}},b_=class{constructor(e,t){this.uri=e,this.range=t}},Zh=class{constructor(e,t){this.uri=e,t===!0?(this.isDone=!0,this.edits=[]):this.edits=Array.isArray(t)?t:[t]}},Sm=class{constructor(e,t){this.uri=e,t===!0?(this.isDone=!0,this.edits=[]):this.edits=Array.isArray(t)?t:[t]}};class o5{constructor(e,t,i,r,s){this.prompt=e,this.command=t,this.references=i,this.participant=r,this.toolReferences=s}}class a5{constructor(e,t,i,r){this.response=e,this.result=t,this.participant=i,this.command=r}}var yi;(function(n){n[n.Panel=1]="Panel",n[n.Terminal=2]="Terminal",n[n.Notebook=3]="Notebook",n[n.Editor=4]="Editor",n[n.EditingSession=5]="EditingSession"})(yi||(yi={}));var wb;(function(n){n[n.Complete=1]="Complete",n[n.Partial=2]="Partial",n[n.Omitted=3]="Omitted"})(wb||(wb={}));class l5{constructor(e,t,i){this.document=e,this.selection=t,this.wholeRange=i}}class c5{constructor(e){this.cell=e}}class u5{constructor(e,t,i){this.mimeType=e,this.data=t,this.reference=i}}class d5{constructor(e){this.diagnostics=e}}var ui;(function(n){n[n.User=1]="User",n[n.Assistant=2]="Assistant",n[n.System=3]="System"})(ui||(ui={}));class Kh{constructor(e,t,i){this.callId=e,this.content=t,this.isError=i??!1}}class x3{constructor(e,t,i){this.command=e,this.language=t,this.confirmationMessages=i}}var bb;(function(n){n[n.Info=0]="Info",n[n.Warning=1]="Warning",n[n.Error=2]="Error"})(bb||(bb={}));let h5=class yb{static User(e,t){return new yb(ui.User,e,t)}static Assistant(e,t){return new yb(ui.Assistant,e,t)}set content(e){typeof e=="string"?this._content=[new jt(e)]:this._content=e}get content(){return this._content}set content2(e){e&&(this.content=e.map(t=>typeof t=="string"?new jt(t):t))}get content2(){return this.content.map(e=>e instanceof jt?e.value:e)}constructor(e,t,i){this._content=[],this.role=e,this.content=t,this.name=i}},f5=class xb{static User(e,t){return new xb(ui.User,e,t)}static Assistant(e,t){return new xb(ui.Assistant,e,t)}set content(e){typeof e=="string"?this._content=[new jt(e)]:this._content=e}get content(){return this._content}set content2(e){e&&(this.content=e.map(t=>typeof t=="string"?new jt(t):t))}get content2(){return this.content.map(e=>e instanceof jt?e.value:e)}constructor(e,t,i){this._content=[],this.role=e,this.content=t,this.name=i}};class bl{constructor(e,t,i){this.callId=e,this.name=t,this.input=i}}class jt{constructor(e){this.value=e}toJSON(){return{$mid:rt.LanguageModelTextPart,value:this.value}}}class Eb{constructor(e){this.value=e}toJSON(){return{$mid:rt.LanguageModelDataPart,value:this.value}}}var Sb;(function(n){n.PNG="image/png",n.JPEG="image/jpeg",n.GIF="image/gif",n.WEBP="image/webp",n.BMP="image/bmp"})(Sb||(Sb={}));class To{constructor(e){this.value=e}toJSON(){return{$mid:rt.LanguageModelPromptTsxPart,value:this.value}}}var Df;const $i=class $i extends Error{static NotFound(e){return new $i(e,$i.NotFound.name)}static NoPermissions(e){return new $i(e,$i.NoPermissions.name)}static Blocked(e){return new $i(e,$i.Blocked.name)}static tryDeserialize(e){if(e.name===A($i,Df))return new $i(e.message,e.code,e.cause)}constructor(e,t,i){super(e,{cause:i}),this.name=A($i,Df),this.code=t??""}};Df=new WeakMap,ge($i,Df,"LanguageModelError");let nr=$i,y_=class{constructor(e){this.content=e}toJSON(){return{$mid:rt.LanguageModelToolResult,content:this.content}}};class E3 extends y_{}var Db;(function(n){n[n.Auto=1]="Auto",n[n.Required=2]="Required"})(Db||(Db={}));var kb;(function(n){n[n.SymbolInformation=1]="SymbolInformation",n[n.CommandInformation=2]="CommandInformation",n[n.SearchInformation=3]="SearchInformation",n[n.SettingInformation=4]="SettingInformation"})(kb||(kb={}));var Ib;(function(n){n[n.Started=1]="Started",n[n.Recognizing=2]="Recognizing",n[n.Recognized=3]="Recognized",n[n.Stopped=4]="Stopped",n[n.Error=5]="Error"})(Ib||(Ib={}));var Cb;(function(n){n[n.Started=1]="Started",n[n.Stopped=2]="Stopped",n[n.Error=3]="Error"})(Cb||(Cb={}));var Pb;(function(n){n[n.Recognized=1]="Recognized",n[n.Stopped=2]="Stopped"})(Pb||(Pb={}));class S3{constructor(e,t){this.text=e,this.range=t}}var ef;(function(n){n[n.Invoke=0]="Invoke",n[n.Automatic=1]="Automatic"})(ef||(ef={}));class D3{constructor(e,t,i,r){this.label=e,this.command=t,this.args=i,this.env=r}}class k3{constructor(e,t){this.label=e,this.uri=t,this.headers=[]}}var pr;(function(n){function e(i){const{selectionStartLineNumber:r,selectionStartColumn:s,positionLineNumber:o,positionColumn:a}=i,l=new We(r-1,s-1),c=new We(o-1,a-1);return new $s(l,c)}n.to=e;function t(i){const{anchor:r,active:s}=i;return{selectionStartLineNumber:r.line+1,selectionStartColumn:r.character+1,positionLineNumber:s.line+1,positionColumn:s.character+1}}n.from=t})(pr||(pr={}));var W;(function(n){function e(i){if(!i)return;const{start:r,end:s}=i;return{startLineNumber:r.line+1,startColumn:r.character+1,endLineNumber:s.line+1,endColumn:s.character+1}}n.from=e;function t(i){if(!i)return;const{startLineNumber:r,startColumn:s,endLineNumber:o,endColumn:a}=i;return new Oe(r-1,s-1,o-1,a-1)}n.to=t})(W||(W={}));var Rs;(function(n){function e(i){return{uri:i.uri,range:W.from(i.range)}}n.from=e;function t(i){return new Ti(y.revive(i.uri),W.to(i.range))}n.to=t})(Rs||(Rs={}));var Tb;(function(n){function e(t){switch(t){case tc.Comment:return vo.Comment;case tc.Other:return vo.Other;case tc.RegEx:return vo.RegEx;case tc.String:return vo.String}}n.to=e})(Tb||(Tb={}));var nt;(function(n){function e(i){return new We(i.lineNumber-1,i.column-1)}n.to=e;function t(i){return{lineNumber:i.line+1,column:i.character+1}}n.from=t})(nt||(nt={}));var Pu;(function(n){function e(r,s,o){return sn(Bi(r).map(a=>t(a,s,o)))}n.from=e;function t(r,s,o){if(typeof r=="string")return{$serialized:!0,language:r,isBuiltin:o==null?void 0:o.isBuiltin};if(r)return{$serialized:!0,language:r.language,scheme:i(r.scheme,s),pattern:di.from(r.pattern)??void 0,exclusive:r.exclusive,notebookType:r.notebookType,isBuiltin:o==null?void 0:o.isBuiltin}}function i(r,s){return s&&typeof r=="string"?s.transformOutgoingScheme(r):r}})(Pu||(Pu={}));var Dm;(function(n){function e(i){switch(i){case ha.Unnecessary:return sc.Unnecessary;case ha.Deprecated:return sc.Deprecated}}n.from=e;function t(i){switch(i){case sc.Unnecessary:return ha.Unnecessary;case sc.Deprecated:return ha.Deprecated;default:return}}n.to=t})(Dm||(Dm={}));var Tu;(function(n){function e(i){let r;return i.code&&(Ze(i.code)||Ua(i.code)?r=String(i.code):r={value:String(i.code.value),target:i.code.target}),{...W.from(i.range),message:i.message,source:i.source,code:r,severity:tf.from(i.severity),relatedInformation:i.relatedInformation&&i.relatedInformation.map(km.from),tags:Array.isArray(i.tags)?sn(i.tags.map(Dm.from)):void 0}}n.from=e;function t(i){var s;const r=new Wg(W.to(i),i.message,tf.to(i.severity));return r.source=i.source,r.code=Ze(i.code)?i.code:(s=i.code)==null?void 0:s.value,r.relatedInformation=i.relatedInformation&&i.relatedInformation.map(km.to),r.tags=i.tags&&sn(i.tags.map(Dm.to)),r}n.to=t})(Tu||(Tu={}));var km;(function(n){function e(i){return{...W.from(i.location.range),message:i.message,resource:i.location.uri}}n.from=e;function t(i){return new xh(new Ti(i.resource,W.to(i)),i.message)}n.to=t})(km||(km={}));var tf;(function(n){function e(i){switch(i){case Sn.Error:return ei.Error;case Sn.Warning:return ei.Warning;case Sn.Information:return ei.Info;case Sn.Hint:return ei.Hint}return ei.Error}n.from=e;function t(i){switch(i){case ei.Info:return Sn.Information;case ei.Warning:return Sn.Warning;case ei.Error:return Sn.Error;case ei.Hint:return Sn.Hint;default:return Sn.Error}}n.to=t})(tf||(tf={}));var nn;(function(n){function e(i){return typeof i=="number"&&i>=Ah.One?i-1:i===Ah.Beside?WR:BR}n.from=e;function t(i){if(typeof i=="number"&&i>=0)return i+1;throw new Error("invalid 'EditorGroupColumn'")}n.to=t})(nn||(nn={}));function I3(n){return typeof n.range<"u"}function p5(n){return n.length===0?!0:!!I3(n[0])}var Le;(function(n){function e(a){return a.map(n.from)}n.fromMany=e;function t(a){return a&&typeof a=="object"&&typeof a.language=="string"&&typeof a.value=="string"}function i(a){let l;if(t(a)){const{language:d,value:f}=a;l={value:"```"+d+`
`+f+"\n```\n"}}else pi.isMarkdownString(a)?l={value:a.value,isTrusted:a.isTrusted,supportThemeIcons:a.supportThemeIcons,supportHtml:a.supportHtml,baseUri:a.baseUri}:typeof a=="string"?l={value:a}:l={value:""};const c=Object.create(null);l.uris=c;const u=({href:d})=>{try{let f=y.parse(d,!0);f=f.with({query:r(f.query,c)}),c[d]=f}catch{}return""};return wt.walkTokens(wt.lexer(l.value),d=>{d.type==="link"?u({href:d.href}):d.type==="image"&&typeof d.href=="string"&&u(NT(d.href))}),l}n.from=i;function r(a,l){if(!a)return a;let c;try{c=mC(a)}catch{}if(!c)return a;let u=!1;return c=pu(c,d=>{if(y.isUri(d)){const f=`__uri_${Math.random().toString(16).slice(2,8)}`;return l[f]=d,u=!0,f}else return}),u?JSON.stringify(c):a}function s(a){const l=new pi(a.value,a.supportThemeIcons);return l.isTrusted=a.isTrusted,l.supportHtml=a.supportHtml,l.baseUri=a.baseUri?y.from(a.baseUri):void 0,l}n.to=s;function o(a){if(a)return typeof a=="string"?a:n.from(a)}n.fromStrict=o})(Le||(Le={}));function C3(n){return p5(n)?n.map(e=>({range:W.from(e.range),hoverMessage:Array.isArray(e.hoverMessage)?Le.fromMany(e.hoverMessage):e.hoverMessage?Le.from(e.hoverMessage):void 0,renderOptions:e.renderOptions})):n.map(e=>({range:W.from(e)}))}function x_(n){return typeof n>"u"?n:typeof n=="string"?y.file(n):n}var Au;(function(n){function e(t){return typeof t>"u"?t:{contentText:t.contentText,contentIconPath:t.contentIconPath?x_(t.contentIconPath):void 0,border:t.border,borderColor:t.borderColor,fontStyle:t.fontStyle,fontWeight:t.fontWeight,textDecoration:t.textDecoration,color:t.color,backgroundColor:t.backgroundColor,margin:t.margin,width:t.width,height:t.height}}n.from=e})(Au||(Au={}));var Im;(function(n){function e(t){return typeof t>"u"?t:{backgroundColor:t.backgroundColor,outline:t.outline,outlineColor:t.outlineColor,outlineStyle:t.outlineStyle,outlineWidth:t.outlineWidth,border:t.border,borderColor:t.borderColor,borderRadius:t.borderRadius,borderSpacing:t.borderSpacing,borderStyle:t.borderStyle,borderWidth:t.borderWidth,fontStyle:t.fontStyle,fontWeight:t.fontWeight,textDecoration:t.textDecoration,cursor:t.cursor,color:t.color,opacity:t.opacity,letterSpacing:t.letterSpacing,gutterIconPath:t.gutterIconPath?x_(t.gutterIconPath):void 0,gutterIconSize:t.gutterIconSize,overviewRulerColor:t.overviewRulerColor,before:t.before?Au.from(t.before):void 0,after:t.after?Au.from(t.after):void 0}}n.from=e})(Im||(Im={}));var Ab;(function(n){function e(t){if(typeof t>"u")return t;switch(t){case pa.OpenOpen:return rc.AlwaysGrowsWhenTypingAtEdges;case pa.ClosedClosed:return rc.NeverGrowsWhenTypingAtEdges;case pa.OpenClosed:return rc.GrowsOnlyWhenTypingBefore;case pa.ClosedOpen:return rc.GrowsOnlyWhenTypingAfter}}n.from=e})(Ab||(Ab={}));var Rb;(function(n){function e(t){return{isWholeLine:t.isWholeLine,rangeBehavior:t.rangeBehavior?Ab.from(t.rangeBehavior):void 0,overviewRulerLane:t.overviewRulerLane,light:t.light?Im.from(t.light):void 0,dark:t.dark?Im.from(t.dark):void 0,backgroundColor:t.backgroundColor,outline:t.outline,outlineColor:t.outlineColor,outlineStyle:t.outlineStyle,outlineWidth:t.outlineWidth,border:t.border,borderColor:t.borderColor,borderRadius:t.borderRadius,borderSpacing:t.borderSpacing,borderStyle:t.borderStyle,borderWidth:t.borderWidth,fontStyle:t.fontStyle,fontWeight:t.fontWeight,textDecoration:t.textDecoration,cursor:t.cursor,color:t.color,opacity:t.opacity,letterSpacing:t.letterSpacing,gutterIconPath:t.gutterIconPath?x_(t.gutterIconPath):void 0,gutterIconSize:t.gutterIconSize,overviewRulerColor:t.overviewRulerColor,before:t.before?Au.from(t.before):void 0,after:t.after?Au.from(t.after):void 0}}n.from=e})(Rb||(Rb={}));var rn;(function(n){function e(i){return{text:i.newText,eol:i.newEol&&Nu.from(i.newEol),range:W.from(i.range)}}n.from=e;function t(i){const r=new Co(W.to(i.range),i.text);return r.newEol=typeof i.eol>"u"?void 0:Nu.to(i.eol),r}n.to=t})(rn||(rn={}));var gi;(function(n){function e(i,r){var o;const s={edits:[]};if(i instanceof _l){const a=new aI;for(const l of i._allEntries())l._type===$t.File&&y.isUri(l.to)&&l.from===void 0&&a.add(l.to);for(const l of i._allEntries())if(l._type===$t.File){let c;(o=l.options)!=null&&o.contents&&(ArrayBuffer.isView(l.options.contents)?c={type:"base64",value:cx(Pe.wrap(l.options.contents))}:c={type:"dataTransferItem",id:l.options.contents._itemId}),s.edits.push({oldResource:l.from,newResource:l.to,options:{...l.options,contents:c},metadata:l.metadata})}else l._type===$t.Text?s.edits.push({resource:l.uri,textEdit:rn.from(l.edit),versionId:a.has(l.uri)||r==null?void 0:r.getTextDocumentVersion(l.uri),metadata:l.metadata}):l._type===$t.Snippet?s.edits.push({resource:l.uri,textEdit:{range:W.from(l.range),text:l.edit.value,insertAsSnippet:!0,keepWhitespace:l.keepWhitespace},versionId:a.has(l.uri)||r==null?void 0:r.getTextDocumentVersion(l.uri),metadata:l.metadata}):l._type===$t.Cell?s.edits.push({metadata:l.metadata,resource:l.uri,cellEdit:l.edit,notebookVersionId:r==null?void 0:r.getNotebookDocumentVersion(l.uri)}):l._type===$t.CellReplace&&s.edits.push({metadata:l.metadata,resource:l.uri,notebookVersionId:r==null?void 0:r.getNotebookDocumentVersion(l.uri),cellEdit:{editType:So.Replace,index:l.index,count:l.count,cells:l.cells.map(Fu.from)}})}return s}n.from=e;function t(i){const r=new _l,s=new on;for(const o of i.edits)if(o.textEdit){const a=o,l=y.revive(a.resource),c=W.to(a.textEdit.range),u=a.textEdit.text,d=a.textEdit.insertAsSnippet;let f;d?f=ja.replace(c,new vl(u)):f=Co.replace(c,u);const p=s.get(l);p?p.push(f):s.set(l,[f])}else r.renameFile(y.revive(o.oldResource),y.revive(o.newResource),o.options);for(const[o,a]of s)r.set(o,a);return r}n.to=t})(gi||(gi={}));var Wi;(function(n){const e=Object.create(null);e[ft.File]=G.File,e[ft.Module]=G.Module,e[ft.Namespace]=G.Namespace,e[ft.Package]=G.Package,e[ft.Class]=G.Class,e[ft.Method]=G.Method,e[ft.Property]=G.Property,e[ft.Field]=G.Field,e[ft.Constructor]=G.Constructor,e[ft.Enum]=G.Enum,e[ft.Interface]=G.Interface,e[ft.Function]=G.Function,e[ft.Variable]=G.Variable,e[ft.Constant]=G.Constant,e[ft.String]=G.String,e[ft.Number]=G.Number,e[ft.Boolean]=G.Boolean,e[ft.Array]=G.Array,e[ft.Object]=G.Object,e[ft.Key]=G.Key,e[ft.Null]=G.Null,e[ft.EnumMember]=G.EnumMember,e[ft.Struct]=G.Struct,e[ft.Event]=G.Event,e[ft.Operator]=G.Operator,e[ft.TypeParameter]=G.TypeParameter;function t(r){return typeof e[r]=="number"?e[r]:G.Property}n.from=t;function i(r){for(const s in e)if(e[s]===r)return Number(s);return ft.Property}n.to=i})(Wi||(Wi={}));var Us;(function(n){function e(i){switch(i){case Sh.Deprecated:return xg.Deprecated}}n.from=e;function t(i){switch(i){case xg.Deprecated:return Sh.Deprecated}}n.to=t})(Us||(Us={}));var yl;(function(n){function e(i){return{name:i.name,kind:Wi.from(i.kind),tags:i.tags&&i.tags.map(Us.from),containerName:i.containerName,location:ii.from(i.location)}}n.from=e;function t(i){const r=new Dh(i.name,Wi.to(i.kind),i.containerName,ii.to(i.location));return r.tags=i.tags&&i.tags.map(Us.to),r}n.to=t})(yl||(yl={}));var Lb;(function(n){function e(i){var s;const r={name:i.name||"!!MISSING: name!!",detail:i.detail,range:W.from(i.range),selectionRange:W.from(i.selectionRange),kind:Wi.from(i.kind),tags:((s=i.tags)==null?void 0:s.map(Us.from))??[]};return i.children&&(r.children=i.children.map(e)),r}n.from=e;function t(i){const r=new kh(i.name,i.detail,Wi.to(i.kind),W.to(i.range),W.to(i.selectionRange));return ju(i.tags)&&(r.tags=i.tags.map(Us.to)),i.children&&(r.children=i.children.map(t)),r}n.to=t})(Lb||(Lb={}));var xl;(function(n){function e(i){const r=new Mx(Wi.to(i.kind),i.name,i.detail||"",y.revive(i.uri),W.to(i.range),W.to(i.selectionRange));return r._sessionId=i._sessionId,r._itemId=i._itemId,r}n.to=e;function t(i,r,s){var o;if(r=r??i._sessionId,s=s??i._itemId,r===void 0||s===void 0)throw new Error("invalid item");return{_sessionId:r,_itemId:s,name:i.name,detail:i.detail,kind:Wi.from(i.kind),uri:i.uri,range:W.from(i.range),selectionRange:W.from(i.selectionRange),tags:(o=i.tags)==null?void 0:o.map(Us.from)}}n.from=t})(xl||(xl={}));var Nb;(function(n){function e(t){return new HC(xl.to(t.from),t.fromRanges.map(i=>W.to(i)))}n.to=e})(Nb||(Nb={}));var Ob;(function(n){function e(t){return new BC(xl.to(t.to),t.fromRanges.map(i=>W.to(i)))}n.to=e})(Ob||(Ob={}));var ii;(function(n){function e(i){return{range:i.range&&W.from(i.range),uri:i.uri}}n.from=e;function t(i){return new Ti(y.revive(i.uri),W.to(i.range))}n.to=t})(ii||(ii={}));var nf;(function(n){function e(i){const r=i,s=i;return{originSelectionRange:r.originSelectionRange?W.from(r.originSelectionRange):void 0,uri:r.targetUri?r.targetUri:s.uri,range:W.from(r.targetRange?r.targetRange:s.range),targetSelectionRange:r.targetSelectionRange?W.from(r.targetSelectionRange):void 0}}n.from=e;function t(i){return{targetUri:y.revive(i.uri),targetRange:W.to(i.range),targetSelectionRange:i.targetSelectionRange?W.to(i.targetSelectionRange):void 0,originSelectionRange:i.originSelectionRange?W.to(i.originSelectionRange):void 0}}n.to=t})(nf||(nf={}));var rf;(function(n){function e(i){return{range:W.from(i.range),contents:Le.fromMany(i.contents),canIncreaseVerbosity:i.canIncreaseVerbosity,canDecreaseVerbosity:i.canDecreaseVerbosity}}n.from=e;function t(i){const r=i.contents.map(Le.to),s=W.to(i.range),o=i.canIncreaseVerbosity,a=i.canDecreaseVerbosity;return new zg(r,s,o,a)}n.to=t})(rf||(rf={}));var Fb;(function(n){function e(i){return{range:W.from(i.range),expression:i.expression}}n.from=e;function t(i){return new lm(W.to(i.range),i.expression)}n.to=t})(Fb||(Fb={}));var Cm;(function(n){function e(i){if(i instanceof cm)return{type:"text",range:W.from(i.range),text:i.text};if(i instanceof um)return{type:"variable",range:W.from(i.range),variableName:i.variableName,caseSensitiveLookup:i.caseSensitiveLookup};if(i instanceof dm)return{type:"expression",range:W.from(i.range),expression:i.expression};throw new Error("Unknown 'InlineValue' type")}n.from=e;function t(i){switch(i.type){case"text":return{range:W.to(i.range),text:i.text};case"variable":return{range:W.to(i.range),variableName:i.variableName,caseSensitiveLookup:i.caseSensitiveLookup};case"expression":return{range:W.to(i.range),expression:i.expression}}}n.to=t})(Cm||(Cm={}));var Pm;(function(n){function e(i){return{frameId:i.frameId,stoppedLocation:W.from(i.stoppedLocation)}}n.from=e;function t(i){return new Zw(i.frameId,W.to(i.stoppedLocation))}n.to=t})(Pm||(Pm={}));var Ru;(function(n){function e(i){return{range:W.from(i.range),kind:i.kind}}n.from=e;function t(i){return new qg(W.to(i.range),i.kind)}n.to=t})(Ru||(Ru={}));var Mb;(function(n){function e(i){return{uri:i.uri,highlights:i.highlights.map(Ru.from)}}n.from=e;function t(i){return new jg(y.revive(i.uri),i.highlights.map(Ru.to))}n.to=t})(Mb||(Mb={}));var $b;(function(n){function e(t){switch(t){case Ud.TriggerCharacter:return Pc.TriggerCharacter;case Ud.TriggerForIncompleteCompletions:return Pc.TriggerForIncompleteCompletions;case Ud.Invoke:default:return Pc.Invoke}}n.to=e})($b||($b={}));var Ub;(function(n){function e(t){return{triggerKind:$b.to(t.triggerKind),triggerCharacter:t.triggerCharacter}}n.to=e})(Ub||(Ub={}));var Tm;(function(n){function e(i){switch(i){case Th.Deprecated:return wg.Deprecated}}n.from=e;function t(i){switch(i){case wg.Deprecated:return Th.Deprecated}}n.to=t})(Tm||(Tm={}));var Am;(function(n){const e=new Map([[xe.Method,O.Method],[xe.Function,O.Function],[xe.Constructor,O.Constructor],[xe.Field,O.Field],[xe.Variable,O.Variable],[xe.Class,O.Class],[xe.Interface,O.Interface],[xe.Struct,O.Struct],[xe.Module,O.Module],[xe.Property,O.Property],[xe.Unit,O.Unit],[xe.Value,O.Value],[xe.Constant,O.Constant],[xe.Enum,O.Enum],[xe.EnumMember,O.EnumMember],[xe.Keyword,O.Keyword],[xe.Snippet,O.Snippet],[xe.Text,O.Text],[xe.Color,O.Color],[xe.File,O.File],[xe.Reference,O.Reference],[xe.Folder,O.Folder],[xe.Event,O.Event],[xe.Operator,O.Operator],[xe.TypeParameter,O.TypeParameter],[xe.Issue,O.Issue],[xe.User,O.User]]);function t(s){return e.get(s)??O.Property}n.from=t;const i=new Map([[O.Method,xe.Method],[O.Function,xe.Function],[O.Constructor,xe.Constructor],[O.Field,xe.Field],[O.Variable,xe.Variable],[O.Class,xe.Class],[O.Interface,xe.Interface],[O.Struct,xe.Struct],[O.Module,xe.Module],[O.Property,xe.Property],[O.Unit,xe.Unit],[O.Value,xe.Value],[O.Constant,xe.Constant],[O.Enum,xe.Enum],[O.EnumMember,xe.EnumMember],[O.Keyword,xe.Keyword],[O.Snippet,xe.Snippet],[O.Text,xe.Text],[O.Color,xe.Color],[O.File,xe.File],[O.Reference,xe.Reference],[O.Folder,xe.Folder],[O.Event,xe.Event],[O.Operator,xe.Operator],[O.TypeParameter,xe.TypeParameter],[O.User,xe.User],[O.Issue,xe.Issue]]);function r(s){return i.get(s)??xe.Property}n.to=r})(Am||(Am={}));var Hb;(function(n){function e(t,i){var s;const r=new Xg(t.label);return r.insertText=t.insertText,r.kind=Am.to(t.kind),r.tags=(s=t.tags)==null?void 0:s.map(Tm.to),r.detail=t.detail,r.documentation=kl(t.documentation)?Le.to(t.documentation):t.documentation,r.sortText=t.sortText,r.filterText=t.filterText,r.preselect=t.preselect,r.commitCharacters=t.commitCharacters,lt.isIRange(t.range)?r.range=W.to(t.range):typeof t.range=="object"&&(r.range={inserting:W.to(t.range.insert),replacing:W.to(t.range.replace)}),r.keepWhitespace=typeof t.insertTextRules>"u"?!1:!!(t.insertTextRules&za.KeepWhitespace),typeof t.insertTextRules<"u"&&t.insertTextRules&za.InsertAsSnippet?r.insertText=new vl(t.insertText):(r.insertText=t.insertText,r.textEdit=r.range instanceof Oe?new Co(r.range,r.insertText):void 0),t.additionalTextEdits&&t.additionalTextEdits.length>0&&(r.additionalTextEdits=t.additionalTextEdits.map(o=>rn.to(o))),r.command=i&&t.command?i.fromInternal(t.command):void 0,r}n.to=e})(Hb||(Hb={}));var Rm;(function(n){function e(i){if(typeof i.label!="string"&&!Array.isArray(i.label))throw new TypeError("Invalid label");return{label:i.label,documentation:Le.fromStrict(i.documentation)}}n.from=e;function t(i){return{label:i.label,documentation:kl(i.documentation)?Le.to(i.documentation):i.documentation}}n.to=t})(Rm||(Rm={}));var Lm;(function(n){function e(i){return{label:i.label,documentation:Le.fromStrict(i.documentation),parameters:Array.isArray(i.parameters)?i.parameters.map(Rm.from):[],activeParameter:i.activeParameter}}n.from=e;function t(i){return{label:i.label,documentation:kl(i.documentation)?Le.to(i.documentation):i.documentation,parameters:Array.isArray(i.parameters)?i.parameters.map(Rm.to):[],activeParameter:i.activeParameter}}n.to=t})(Lm||(Lm={}));var sf;(function(n){function e(i){return{activeSignature:i.activeSignature,activeParameter:i.activeParameter,signatures:Array.isArray(i.signatures)?i.signatures.map(Lm.from):[]}}n.from=e;function t(i){return{activeSignature:i.activeSignature,activeParameter:i.activeParameter,signatures:Array.isArray(i.signatures)?i.signatures.map(Lm.to):[]}}n.to=t})(sf||(sf={}));var Bb;(function(n){function e(t,i){const r=new Jg(nt.to(i.position),typeof i.label=="string"?i.label:i.label.map(Wb.to.bind(void 0,t)),i.kind&&Nm.to(i.kind));return r.textEdits=i.textEdits&&i.textEdits.map(rn.to),r.tooltip=kl(i.tooltip)?Le.to(i.tooltip):i.tooltip,r.paddingLeft=i.paddingLeft,r.paddingRight=i.paddingRight,r}n.to=e})(Bb||(Bb={}));var Wb;(function(n){function e(t,i){const r=new Qg(i.label);return r.tooltip=kl(i.tooltip)?Le.to(i.tooltip):i.tooltip,uw.is(i.command)&&(r.command=t.fromInternal(i.command)),i.location&&(r.location=ii.to(i.location)),r}n.to=e})(Wb||(Wb={}));var Nm;(function(n){function e(i){return i}n.from=e;function t(i){return i}n.to=t})(Nm||(Nm={}));var Ya;(function(n){function e(i){return{range:W.from(i.range),url:i.target,tooltip:i.tooltip}}n.from=e;function t(i){let r;if(i.url)try{r=typeof i.url=="string"?y.parse(i.url,!0):y.revive(i.url)}catch{}const s=new Zg(W.to(i.range),r);return s.tooltip=i.tooltip,s}n.to=t})(Ya||(Ya={}));var Om;(function(n){function e(i){const r=new em(i.label);return i.textEdit&&(r.textEdit=rn.to(i.textEdit)),i.additionalTextEdits&&(r.additionalTextEdits=i.additionalTextEdits.map(s=>rn.to(s))),r}n.to=e;function t(i){return{label:i.label,textEdit:i.textEdit?rn.from(i.textEdit):void 0,additionalTextEdits:i.additionalTextEdits?i.additionalTextEdits.map(r=>rn.from(r)):void 0}}n.from=t})(Om||(Om={}));var Lu;(function(n){function e(i){return new xu(i[0],i[1],i[2],i[3])}n.to=e;function t(i){return[i.red,i.green,i.blue,i.alpha]}n.from=t})(Lu||(Lu={}));var Vb;(function(n){function e(i){return{range:W.from(i.range)}}n.from=e;function t(i){return new Ph(W.to(i.range))}n.to=t})(Vb||(Vb={}));var Fm;(function(n){function e(t){switch(t){case ua.AUTO:return Tc.AfterDelay;case ua.EXPLICIT:return Tc.Manual;case ua.FOCUS_CHANGE:case ua.WINDOW_CHANGE:return Tc.FocusOut}}n.to=e})(Fm||(Fm={}));var $c;(function(n){function e(i){switch(i){case Ki.Off:return Rn.Off;case Ki.Relative:return Rn.Relative;case Ki.Interval:return Rn.Interval;case Ki.On:default:return Rn.On}}n.from=e;function t(i){switch(i){case Rn.Off:return Ki.Off;case Rn.Relative:return Ki.Relative;case Rn.Interval:return Ki.Interval;case Rn.On:default:return Ki.On}}n.to=t})($c||($c={}));var Nu;(function(n){function e(i){if(i===cr.CRLF)return ic.CRLF;if(i===cr.LF)return ic.LF}n.from=e;function t(i){if(i===ic.CRLF)return cr.CRLF;if(i===ic.LF)return cr.LF}n.to=t})(Nu||(Nu={}));var zb;(function(n){function e(t){if(typeof t=="object")return t.viewId;switch(t){case Ga.SourceControl:return Wd.Scm;case Ga.Window:return Wd.Window;case Ga.Notification:return Wd.Notification}throw new Error("Unknown 'ProgressLocation'")}n.from=e})(zb||(zb={}));var Mm;(function(n){function e(i){const r={start:i.start+1,end:i.end+1};return i.kind&&(r.kind=$m.from(i.kind)),r}n.from=e;function t(i){const r={start:i.start-1,end:i.end-1};return i.kind&&(r.kind=$m.to(i.kind)),r}n.to=t})(Mm||(Mm={}));var $m;(function(n){function e(i){if(i)switch(i){case fs.Comment:return Bl.Comment;case fs.Imports:return Bl.Imports;case fs.Region:return Bl.Region}}n.from=e;function t(i){if(i)switch(i.value){case Bl.Comment.value:return fs.Comment;case Bl.Imports.value:return fs.Imports;case Bl.Region.value:return fs.Region}}n.to=t})($m||($m={}));var Jd;(function(n){function e(t){if(t)return{pinned:typeof t.preview=="boolean"?!t.preview:void 0,inactive:t.background,preserveFocus:t.preserveFocus,selection:typeof t.selection=="object"?W.from(t.selection):void 0,override:typeof t.override=="boolean"?FA.id:void 0}}n.from=e})(Jd||(Jd={}));var di;(function(n){function e(s){return s instanceof Lc?s.toJSON():typeof s=="string"?s:t(s)||i(s)?new Lc(s.baseUri??s.base,s.pattern).toJSON():s}n.from=e;function t(s){const o=s;return o?y.isUri(o.baseUri)&&typeof o.pattern=="string":!1}function i(s){const o=s;return o?typeof o.base=="string"&&typeof o.pattern=="string":!1}function r(s){return typeof s=="string"?s:new Lc(y.revive(s.baseUri),s.pattern)}n.to=r})(di||(di={}));var qb;(function(n){function e(t){if(t){if(Array.isArray(t))return t.map(e);if(typeof t=="string")return t;{const i=t;return{language:i.language,scheme:i.scheme,pattern:di.from(i.pattern)??void 0,exclusive:i.exclusive,notebookType:i.notebookType}}}else return}n.from=e})(qb||(qb={}));var Hr;(function(n){function e(i){return{start:i.start,end:i.end}}n.from=e;function t(i){return new Ss(i.start,i.end)}n.to=t})(Hr||(Hr={}));var Ou;(function(n){function e(i){return{timing:typeof i.runStartTime=="number"&&typeof i.runEndTime=="number"?{startTime:i.runStartTime,endTime:i.runEndTime}:void 0,executionOrder:i.executionOrder,success:i.lastRunSuccess}}n.to=e;function t(i){var r,s;return{lastRunSuccess:i.success,runStartTime:(r=i.timing)==null?void 0:r.startTime,runEndTime:(s=i.timing)==null?void 0:s.endTime,executionOrder:i.executionOrder}}n.from=t})(Ou||(Ou={}));var jb;(function(n){function e(t){if(t===qd.Unconfirmed)return Iu.Pending;if(t===qd.Pending)return;if(t===qd.Executing)return Iu.Executing;throw new Error(`Unknown state: ${t}`)}n.to=e})(jb||(jb={}));var of;(function(n){function e(i){switch(i){case _a.Markup:return oc.Markup;case _a.Code:default:return oc.Code}}n.from=e;function t(i){switch(i){case oc.Markup:return _a.Markup;case oc.Code:default:return _a.Code}}n.to=t})(of||(of={}));var Ys;(function(n){function e(i){const r={metadata:i.metadata??Object.create(null),cells:[]};for(const s of i.cells)g_.validate(s),r.cells.push(Fu.from(s));return r}n.from=e;function t(i){const r=new GC(i.cells.map(Fu.to));return dI(i.metadata)||(r.metadata=i.metadata),r}n.to=t})(Ys||(Ys={}));var Fu;(function(n){function e(i){return{cellKind:of.from(i.kind),language:i.languageId,mime:i.mime,source:i.value,metadata:i.metadata,internalMetadata:Ou.from(i.executionSummary??{}),outputs:i.outputs?i.outputs.map(Ao.from):[]}}n.from=e;function t(i){return new g_(of.to(i.cellKind),i.source,i.language,i.mime,i.outputs?i.outputs.map(Ao.to):void 0,i.metadata,i.internalMetadata?Ou.to(i.internalMetadata):void 0)}n.to=t})(Fu||(Fu={}));var Mu;(function(n){function e(i){return{mime:i.mime,valueBytes:Pe.wrap(i.data)}}n.from=e;function t(i){return new QC(i.valueBytes.buffer,i.mime)}n.to=t})(Mu||(Mu={}));var Ao;(function(n){function e(i){return{outputId:i.id,items:i.items.map(Mu.from),metadata:i.metadata}}n.from=e;function t(i){const r=i.items.map(Mu.to);return new pm(r,i.outputId,i.metadata)}n.to=t})(Ao||(Ao={}));var Um;(function(n){function e(r){return i(r)?{include:di.from(r.include)??void 0,exclude:di.from(r.exclude)??void 0}:di.from(r)??void 0}n.from=e;function t(r){return i(r)?{include:di.to(r.include),exclude:di.to(r.exclude)}:di.to(r)}n.to=t;function i(r){const s=r;return s?!Yt(s.include)&&!Yt(s.exclude):!1}})(Um||(Um={}));var Gb;(function(n){function e(t,i,r){const s=typeof t.command=="string"?{title:"",command:t.command}:t.command;return{alignment:t.alignment===gm.Left?Pg.Left:Pg.Right,command:i.toInternal(s,r),text:t.text,tooltip:t.tooltip,accessibilityInformation:t.accessibilityInformation,priority:t.priority}}n.from=e})(Gb||(Gb={}));var Qb;(function(n){function e(t,i,r){const s=typeof t.command=="string"?{title:"",command:t.command}:t.command;return{command:i.toInternal(s,r),label:t.label,description:t.description,detail:t.detail,documentation:t.documentation}}n.from=e})(Qb||(Qb={}));var Jb;(function(n){function e(t){return{transientOutputs:(t==null?void 0:t.transientOutputs)??!1,transientCellMetadata:(t==null?void 0:t.transientCellMetadata)??{},transientDocumentMetadata:(t==null?void 0:t.transientDocumentMetadata)??{},cellContentMetadata:(t==null?void 0:t.cellContentMetadata)??{}}}n.from=e})(Jb||(Jb={}));var Hm;(function(n){function e(i){return{uri:i.uri,provides:i.provides}}n.from=e;function t(i){return new JC(y.revive(i.uri),i.provides)}n.to=t})(Hm||(Hm={}));var $u;(function(n){function e(i){var r;return{message:Le.fromStrict(i.message)||"",type:fr.Error,expected:i.expectedOutput,actual:i.actualOutput,contextValue:i.contextValue,location:i.location&&{range:W.from(i.location.range),uri:i.location.uri},stackTrace:(r=i.stackTrace)==null?void 0:r.map(s=>({label:s.label,position:s.position&&nt.from(s.position),uri:s.uri&&y.revive(s.uri).toJSON()}))}}n.from=e;function t(i){const r=new bm(typeof i.message=="string"?i.message:Le.to(i.message));return r.actualOutput=i.actual,r.expectedOutput=i.expected,r.contextValue=i.contextValue,r.location=i.location?ii.to(i.location):void 0,r}n.to=t})($u||($u={}));var gr;(function(n){n.namespace=Lp,n.denamespace=FC})(gr||(gr={}));var Xb;(function(n){function e(t){return{controllerId:t.controllerId,profileId:t.profileId,group:Uu.from(t.kind)}}n.from=e})(Xb||(Xb={}));var Uu;(function(n){const e={[Mc.Coverage]:Dn.Coverage,[Mc.Debug]:Dn.Debug,[Mc.Run]:Dn.Run};function t(i){return e.hasOwnProperty(i)?e[i]:Dn.Run}n.from=t})(Uu||(Uu={}));var Ro;(function(n){function e(i){const r=p_(i).controllerId;return{extId:Re.fromExtHostTestItem(i,r).toString(),label:i.label,uri:y.revive(i.uri),busy:i.busy,tags:i.tags.map(s=>gr.namespace(r,s.id)),range:lt.lift(W.from(i.range)),description:i.description||null,sortText:i.sortText||null,error:i.error&&Le.fromStrict(i.error)||null}}n.from=e;function t(i){return{parent:void 0,error:void 0,id:Re.fromString(i.extId).localId,label:i.label,uri:y.revive(i.uri),tags:(i.tags||[]).map(r=>{const{tagId:s}=gr.denamespace(r);return new Gh(s)}),children:{add:()=>{},delete:()=>{},forEach:()=>{},*[Symbol.iterator](){},get:()=>{},replace:()=>{},size:0},range:W.to(i.range||void 0),canResolveChildren:!1,busy:i.busy,description:i.description||void 0,sortText:i.sortText||void 0}}n.toPlain=t})(Ro||(Ro={}));(function(n){function e(i){return{id:i.id}}n.from=e;function t(i){return new Gh(i.id)}n.to=t})(gr||(gr={}));var Yb;(function(n){const e=(i,r)=>{const s=i.value;if(!s)return;const o={...Ro.toPlain(s.item),parent:r,taskStates:s.tasks.map(a=>({state:a.state,duration:a.duration,messages:a.messages.filter(l=>l.type===fr.Error).map($u.to)})),children:[]};if(i.children)for(const a of i.children.values()){const l=e(a,o);l&&o.children.push(l)}return o};function t(i){const r=new _8;for(const a of i.items)r.insert(Re.fromString(a.item.extId).path,a);const s=[r.nodes],o=[];for(;s.length;)for(const a of s.pop())a.value?o.push(a):a.children&&s.push(a.children.values());return{completedAt:i.completedAt,results:o.map(a=>e(a)).filter(Ui)}}n.to=t})(Yb||(Yb={}));var af;(function(n){function e(a){return{covered:a.covered,total:a.total}}function t(a){return"line"in a?nt.from(a):W.from(a)}function i(a){if(a)return"endLineNumber"in a?W.to(a):nt.to(a)}function r(a){var l;if(a.type===qa.Statement){const c=[];if(a.branches)for(const u of a.branches)c.push({executed:u.count,location:i(u.location),label:u.label});return new YC(a.count,i(a.location),(l=a.branches)==null?void 0:l.map(u=>new ZC(u.count,i(u.location),u.label)))}else return new KC(a.name,a.count,i(a.location))}n.to=r;function s(a){if(typeof a.executed=="number"&&a.executed<0)throw new Error(`Invalid coverage count ${a.executed}`);return"branches"in a?{count:a.executed,location:t(a.location),type:qa.Statement,branches:a.branches.length?a.branches.map(l=>({count:l.executed,location:l.location&&t(l.location),label:l.label})):void 0}:{type:qa.Declaration,name:a.name,count:a.executed,location:t(a.location)}}n.fromDetails=s;function o(a,l,c){return $p(c.statementCoverage),$p(c.branchCoverage),$p(c.declarationCoverage),{id:l,uri:c.uri,statement:e(c.statementCoverage),branch:c.branchCoverage&&e(c.branchCoverage),declaration:c.declarationCoverage&&e(c.declarationCoverage),testIds:c instanceof Cu&&c.includesTests.length?c.includesTests.map(u=>Re.fromExtHostTestItem(u,a).toString()):void 0}}n.fromFile=o})(af||(af={}));var Zb;(function(n){function e(t){switch(t){case yg.Invoke:return Ih.Invoke;case yg.Auto:return Ih.Automatic}}n.to=e})(Zb||(Zb={}));var Za;(function(n){function e(i){const r=new Hx(Wi.to(i.kind),i.name,i.detail||"",y.revive(i.uri),W.to(i.range),W.to(i.selectionRange));return r._sessionId=i._sessionId,r._itemId=i._itemId,r}n.to=e;function t(i,r,s){var o;if(r=r??i._sessionId,s=s??i._itemId,r===void 0||s===void 0)throw new Error("invalid item");return{_sessionId:r,_itemId:s,kind:Wi.from(i.kind),name:i.name,detail:i.detail??"",uri:i.uri,range:W.from(i.range),selectionRange:W.from(i.selectionRange),tags:(o=i.tags)==null?void 0:o.map(Us.from)}}n.from=t})(Za||(Za={}));var Bm;(function(n){function e(t){if(t)return{value:t.value,tooltip:t.tooltip}}n.from=e})(Bm||(Bm={}));var Ka;(function(n){function e(s,o,a){const l=o.fileData;return l?new l3(new c3(l.name,y.revive(l.uri),l.id,lx(()=>a(l.id)))):s===Ts.uriList&&o.uriListData?new rm(r(o.uriListData)):new rm(o.asString)}n.to=e;async function t(s,o,a=Mn()){const l=await o.asString();if(s===Ts.uriList)return{id:a,asString:l,fileData:void 0,uriListData:i(l)};const c=o.asFile();return{id:a,asString:l,fileData:c?{name:c.name,uri:c.uri,id:c._itemId??c.id}:void 0}}n.from=t;function i(s){return nw.split(s).map(o=>{if(o.startsWith("#"))return o;try{return y.parse(o)}catch{}return o})}function r(s){return nw.create(s.map(o=>typeof o=="string"?o:y.revive(o)))}})(Ka||(Ka={}));var Hu;(function(n){function e(r,s){const o=r.items.map(([a,l])=>[a,Ka.to(a,l,s)]);return new Su(o)}n.toDataTransfer=e;async function t(r){return{items:await Promise.all(Array.from(r,async([o,a])=>[o,await Ka.from(o,a)]))}}n.from=t;async function i(r){return{items:await Promise.all(Array.from(r,async([o,a])=>[o,await Ka.from(o,a,a.id)]))}}n.fromList=i})(Hu||(Hu={}));var lf;(function(n){function e(i,r){return{kind:"reply",agentId:i.participant??(r==null?void 0:r.agentId)??"",subCommand:i.command??(r==null?void 0:r.command),message:i.prompt,title:i.label}}n.from=e;function t(i){return{prompt:i.message,label:i.title,participant:i.agentId,command:i.subCommand}}n.to=t})(lf||(lf={}));var Bu;(function(n){function e(i){switch(i){case as.System:return ui.System;case as.User:return ui.User;case as.Assistant:return ui.Assistant}}n.to=e;function t(i){switch(i){case ui.System:return as.System;case ui.User:return as.User;case ui.Assistant:return as.Assistant}return as.User}n.from=t})(Bu||(Bu={}));var v4;(function(n){function e(i){const r=i.content.map(a=>{if(a.type==="text")return new jt(a.value);if(a.type==="tool_result"){const l=a.value.map(c=>c.type==="text"?new jt(c.value):new To(c.value));return new Kh(a.toolCallId,l,a.isError)}else return a.type==="image_url"?void 0:new bl(a.toolCallId,a.name,a.parameters)}).filter(a=>a!==void 0),s=Bu.to(i.role);return new h5(s,r,i.name)}n.to=e;function t(i){const r=Bu.from(i.role),s=i.name;let o=i.content;typeof o=="string"&&(o=[new jt(o)]);const a=o.map(l=>{if(l instanceof Kh)return{type:"tool_result",toolCallId:l.callId,value:sn(l.content.map(c=>c instanceof jt?{type:"text",value:c.value}:c instanceof To?{type:"prompt_tsx",value:c.value}:void 0)),isError:l.isError};if(l instanceof bl)return{type:"tool_use",toolCallId:l.callId,name:l.name,parameters:l.input};if(l instanceof jt)return{type:"text",value:l.value};if(typeof l!="string")throw new Error("Unexpected chat message content type");return{type:"text",value:l}});return{role:r,name:s,content:a}}n.from=t})(v4||(v4={}));var ac;(function(n){function e(i){const r=i.content.map(a=>{if(a.type==="text")return new jt(a.value);if(a.type==="tool_result"){const l=a.value.map(c=>c.type==="text"?new jt(c.value):new To(c.value));return new Kh(a.toolCallId,l,a.isError)}else if(a.type==="image_url"){const l={mimeType:a.value.mimeType,data:a.value.data.buffer};return new Eb(l)}else return new bl(a.toolCallId,a.name,a.parameters)}),s=Bu.to(i.role);return new f5(s,r,i.name)}n.to=e;function t(i){const r=Bu.from(i.role),s=i.name;let o=i.content;typeof o=="string"&&(o=[new jt(o)]);const a=o.map(l=>{if(l instanceof Kh)return{type:"tool_result",toolCallId:l.callId,value:sn(l.content.map(c=>c instanceof jt?{type:"text",value:c.value}:c instanceof To?{type:"prompt_tsx",value:c.value}:void 0)),isError:l.isError};if(l instanceof Eb)return{type:"image_url",value:{mimeType:l.value.mimeType,data:Pe.wrap(l.value.data)}};if(l instanceof bl)return{type:"tool_use",toolCallId:l.callId,name:l.name,parameters:l.input};if(l instanceof jt)return{type:"text",value:l.value};if(typeof l!="string")throw new Error("Unexpected chat message content type");return{type:"text",value:l}});return{role:r,name:s,content:a}}n.from=t})(ac||(ac={}));var cf;(function(n){function e(i){return{kind:"markdownContent",content:Le.from(i.value)}}n.from=e;function t(i){return new m_(Le.to(i.content))}n.to=t})(cf||(cf={}));var Wm;(function(n){function e(i){return{kind:"codeblockUri",uri:i.value,isEdit:i.isEdit}}n.from=e;function t(i){return new w_(y.revive(i.uri),i.isEdit)}n.to=t})(Wm||(Wm={}));var Vm;(function(n){function e(i){return{kind:"markdownVuln",content:Le.from(i.value),vulnerabilities:i.vulnerabilities}}n.from=e;function t(i){return new Jh(Le.to(i.content),i.vulnerabilities)}n.to=t})(Vm||(Vm={}));var zm;(function(n){function e(t){return{kind:"confirmation",title:t.title,message:t.message,data:t.data,buttons:t.buttons}}n.from=e})(zm||(zm={}));var uf;(function(n){function e(i){const{value:r,baseUri:s}=i;function o(a,l){return a.map(c=>{const u=y.joinPath(l,c.name);return{label:c.name,uri:u,children:c.children&&o(c.children,u)}})}return{kind:"treeData",treeData:{label:Lo(s),uri:s,children:o(r,s)}}}n.from=e;function t(i){const r=jn(i.treeData);function s(l){return l.map(c=>({name:c.label,children:c.children&&s(c.children)}))}const o=r.uri,a=r.children?s(r.children):[];return new __(a,o)}n.to=t})(uf||(uf={}));var Wu;(function(n){function e(i){const r=o=>y.isUri(o),s=o=>"name"in o;return{kind:"inlineReference",name:i.title,inlineReference:r(i.value)?i.value:s(i.value)?yl.from(i.value):Rs.from(i.value)}}n.from=e;function t(i){const r=jn(i);return new Xh(y.isUri(r.inlineReference)?r.inlineReference:"location"in r.inlineReference?yl.to(r.inlineReference):Rs.to(r.inlineReference),i.name)}n.to=t})(Wu||(Wu={}));var df;(function(n){function e(i){return{kind:"progressMessage",content:Le.from(i.value)}}n.from=e;function t(i){return new qx(i.content.value)}n.to=t})(df||(df={}));var hf;(function(n){function e(i){return{kind:"warning",content:Le.from(i.value)}}n.from=e;function t(i){return new Yh(i.content.value)}n.to=t})(hf||(hf={}));var Kb;(function(n){function e(i){return{kind:"move",uri:i.uri,range:W.from(i.range)}}n.from=e;function t(i){return new b_(y.revive(i.uri),W.to(i.range))}n.to=t})(Kb||(Kb={}));var qm;(function(n){function e(t){return{kind:"progressTask",content:Le.from(t.value)}}n.from=e})(qm||(qm={}));var e0;(function(n){function e(t){return{kind:"progressTaskResult",content:typeof t=="string"?Le.from(t):void 0}}n.from=e})(e0||(e0={}));var ff;(function(n){function e(i,r,s){return{kind:"command",command:r.toInternal(i.value,s)??{command:i.value.command,title:i.value.title}}}n.from=e;function t(i,r){return new v_(r.fromInternal(i.command)??{command:i.command.id,title:i.command.title})}n.to=t})(ff||(ff={}));var jm;(function(n){function e(i){return{kind:"textEdit",uri:i.uri,edits:i.edits.map(r=>rn.from(r)),done:i.isDone}}n.from=e;function t(i){const r=new Zh(y.revive(i.uri),i.edits.map(s=>rn.to(s)));return r.isDone=i.done,r}n.to=t})(jm||(jm={}));var Gm;(function(n){function e(t){return t.newCellMetadata?{editType:So.Metadata,index:t.range.start,metadata:t.newCellMetadata}:t.newNotebookMetadata?{editType:So.DocumentMetadata,metadata:t.newNotebookMetadata}:{editType:So.Replace,index:t.range.start,count:t.range.end-t.range.start,cells:t.newCells.map(Fu.from)}}n.from=e})(Gm||(Gm={}));var Qm;(function(n){function e(t){return{kind:"notebookEdit",uri:t.uri,edits:t.edits.map(Gm.from),done:t.isDone}}n.from=e})(Qm||(Qm={}));var el;(function(n){function e(i){const r=On.isThemeIcon(i.iconPath)?i.iconPath:y.isUri(i.iconPath)?{light:y.revive(i.iconPath)}:i.iconPath&&"light"in i.iconPath&&"dark"in i.iconPath&&y.isUri(i.iconPath.light)&&y.isUri(i.iconPath.dark)?{light:y.revive(i.iconPath.light),dark:y.revive(i.iconPath.dark)}:void 0;return typeof i.value=="object"&&"variableName"in i.value?{kind:"reference",reference:{variableName:i.value.variableName,value:y.isUri(i.value.value)||!i.value.value?i.value.value:Rs.from(i.value.value)},iconPath:r,options:i.options}:{kind:"reference",reference:y.isUri(i.value)||typeof i.value=="string"?i.value:Rs.from(i.value),iconPath:r,options:i.options}}n.from=e;function t(i){const r=jn(i),s=o=>y.isUri(o)?o:Rs.to(o);return new Xa(typeof r.reference=="string"?r.reference:"variableName"in r.reference?{variableName:r.reference.variableName,value:r.reference.value&&s(r.reference.value)}:s(r.reference))}n.to=t})(el||(el={}));var Jm;(function(n){function e(t){return{kind:"codeCitation",value:t.value,license:t.license,snippet:t.snippet}}n.from=e})(Jm||(Jm={}));var Xm;(function(n){function e(r,s,o){return r instanceof m_?cf.from(r):r instanceof Xh?Wu.from(r):r instanceof Xa?el.from(r):r instanceof qx?df.from(r):r instanceof __?uf.from(r):r instanceof v_?ff.from(r,s,o):r instanceof Zh?jm.from(r):r instanceof Sm?Qm.from(r):r instanceof Jh?Vm.from(r):r instanceof w_?Wm.from(r):r instanceof Yh?hf.from(r):r instanceof xm?zm.from(r):r instanceof Em?Jm.from(r):r instanceof b_?Kb.from(r):{kind:"markdownContent",content:Le.from("")}}n.from=e;function t(r,s){switch(r.kind){case"reference":return el.to(r);case"markdownContent":case"inlineReference":case"progressMessage":case"treeData":case"command":return i(r,s)}}n.to=t;function i(r,s){switch(r.kind){case"markdownContent":return cf.to(r);case"inlineReference":return Wu.to(r);case"progressMessage":return;case"treeData":return uf.to(r);case"command":return ff.to(r,s)}}n.toContent=i})(Xm||(Xm={}));var Ym;(function(n){function e(t,i,r,s,o){const a=t.variables.variables.filter(u=>u.isTool),l=t.variables.variables.filter(u=>!u.isTool),c={prompt:t.message,command:t.command,attempt:t.attempt??0,enableCommandDetection:t.enableCommandDetection??!0,isParticipantDetected:t.isParticipantDetected??!1,references:l.map(u=>Zm.to(u,s)),toolReferences:a.map(Km.to),location:pf.to(t.location),acceptedConfirmationData:t.acceptedConfirmationData,rejectedConfirmationData:t.rejectedConfirmationData,location2:i,toolInvocationToken:Object.freeze({sessionId:t.sessionId}),tools:o,model:r};return t.requestId?{...c,id:t.requestId}:c}n.to=e})(Ym||(Ym={}));var t0;(function(n){function e(t){return{prompt:t.prompt,files:t.files.map(i=>y.revive(i))}}n.to=e})(t0||(t0={}));var pf;(function(n){function e(i){switch(i){case En.Notebook:return yi.Notebook;case En.Terminal:return yi.Terminal;case En.Panel:return yi.Panel;case En.Editor:return yi.Editor;case En.EditingSession:return yi.EditingSession}}n.to=e;function t(i){switch(i){case yi.Notebook:return En.Notebook;case yi.Terminal:return En.Terminal;case yi.Panel:return En.Panel;case yi.Editor:return En.Editor;case yi.EditingSession:return En.EditingSession}}n.from=t})(pf||(pf={}));var Zm;(function(n){function e(t,i){var s,o;let r=t.value;if(!r)throw new Error("Invalid value reference");if(O2(r))r=y.revive(r);else if(r&&typeof r=="object"&&"uri"in r&&"range"in r&&O2(r.uri))r=Rs.to(jn(r));else if(t.isImage){const a=(o=(s=t.references)==null?void 0:s[0])==null?void 0:o.reference;r=new u5(t.mimeType??"image/png",()=>Promise.resolve(new Uint8Array(Object.values(t.value))),a&&y.isUri(a)?a:void 0)}else if(t.kind==="diagnostic"){const a=t.filterSeverity&&tf.to(t.filterSeverity),l=t.filterUri&&y.revive(t.filterUri).toString();r=new d5(i.map(([c,u])=>t.filterUri&&c.toString()!==l?[c,[]]:[c,u.filter(d=>!(a&&d.severity>a||t.filterRange&&!lt.areIntersectingOrTouching(t.filterRange,W.from(d.range))))]).filter(([,c])=>c.length>0))}return{id:t.id,name:t.name,range:t.range&&[t.range.start,t.range.endExclusive],value:r,modelDescription:t.modelDescription}}n.to=e})(Zm||(Zm={}));var Km;(function(n){function e(t){if(t.value)throw new Error("Invalid tool reference");return{name:t.id,range:t.range&&[t.range.start,t.range.endExclusive]}}n.to=e})(Km||(Km={}));var n0;(function(n){function e(t,i,r){var s;return{id:t.id,label:t.label,fullName:t.fullName,icon:(s=t.icon)==null?void 0:s.id,value:t.values[0].value,insertText:t.insertText,detail:t.detail,documentation:t.documentation,command:i.toInternal(t.command,r)}}n.from=e})(n0||(n0={}));var Uc;(function(n){function e(r){return{errorDetails:r.errorDetails,metadata:i(r.metadata),nextQuestion:r.nextQuestion}}n.to=e;function t(r){return{errorDetails:r.errorDetails,metadata:r.metadata,nextQuestion:r.nextQuestion}}n.from=t;function i(r){return pu(r,s=>{if(s.$mid===rt.LanguageModelToolResult)return new y_(pu(s.content,i));if(s.$mid===rt.LanguageModelTextPart)return new jt(s.value);if(s.$mid===rt.LanguageModelPromptTsxPart)return new To(s.value)})}})(Uc||(Uc={}));var i0;(function(n){function e(t,i,r){if(i.action.kind==="vote")return;const s=Uc.to(t);if(i.action.kind==="command"){const o=i.action.commandButton.command;return{action:{kind:"command",commandButton:{command:r.fromInternal(o)??{command:o.id,title:o.title}}},result:s}}else return i.action.kind==="followUp"?{action:{kind:"followUp",followup:lf.to(i.action.followup)},result:s}:i.action.kind==="inlineChat"?{action:{kind:"editor",accepted:i.action.action==="accepted"},result:s}:i.action.kind==="chatEditingSessionAction"?{action:{kind:"chatEditingSessionAction",outcome:new Map([["accepted",va.Accepted],["rejected",va.Rejected],["saved",va.Saved]]).get(i.action.outcome)??va.Rejected,uri:y.revive(i.action.uri),hasRemainingEdits:i.action.hasRemainingEdits},result:s}:{action:i.action,result:s}}n.to=e})(i0||(i0={}));var e1;(function(n){function e(t,i,r){return"terminalCommand"in t?{terminalCommand:t.terminalCommand,shouldExecute:t.shouldExecute}:"uri"in t?{uri:t.uri}:i.toInternal(t,r)}n.from=e})(e1||(e1={}));var t1;(function(n){function e(t){return{...t,documentation:Le.fromStrict(t.documentation)}}n.from=e})(t1||(t1={}));var r0;(function(n){function e(t){return Array.isArray(t)?{items:t.map(i=>t1.from(i))}:{items:t.items.map(i=>t1.from(i)),resourceRequestConfig:t.resourceRequestConfig?s0.from(t.resourceRequestConfig):void 0}}n.from=e})(r0||(r0={}));var s0;(function(n){function e(t){return{...t,pathSeparator:ni?"\\":"/",cwd:t.cwd?y.revive(t.cwd):void 0}}n.from=e})(s0||(s0={}));var o0;(function(n){function e(t){return{kind:a0.to(t.kind),acceptedLength:t.acceptedLength}}n.to=e})(o0||(o0={}));var a0;(function(n){function e(t){switch(t){case $d.Word:return fa.Word;case $d.Line:return fa.Line;case $d.Suggest:return fa.Suggest;default:return fa.Unknown}}n.to=e})(a0||(a0={}));var l0;(function(n){function e(t,i){return{id:i,label:t.label,description:t.description,canEdit:t.canEdit,collapsibleState:t.collapsibleState||mw.None,contextValue:t.contextValue}}n.from=e})(l0||(l0={}));var c0;(function(n){function e(t){return{name:t.id,description:t.modelDescription,inputSchema:t.inputSchema,tags:t.tags??[]}}n.to=e})(c0||(c0={}));var n1;(function(n){function e(i){return new y_(i.content.map(r=>r.kind==="text"?new jt(r.value):new To(r.value)))}n.to=e;function t(i,r){var s;return i.toolResultMessage&&$(r,"chatParticipantPrivate"),{content:i.content.map(o=>{if(o instanceof jt)return{kind:"text",value:o.value};if(o instanceof To)return{kind:"promptTsx",value:o.value};throw new Error("Unknown LanguageModelToolResult part type")}),toolResultMessage:Le.fromStrict(i.toolResultMessage),toolResultDetails:(s=i.toolResultDetails)==null?void 0:s.map(o=>y.isUri(o)?o:Rs.from(o))}}n.from=t})(n1||(n1={}));var u0;(function(n){function e(t){return t}n.fromThemeIcon=e})(u0||(u0={}));class wo{constructor(e,t,i){this.uri=e,this.ranges=t,this.previewText=i}}class jx{constructor(e,t,i){this.uri=e,this.text=t,this.lineNumber=i}}var ps;(function(n){n[n.None=1]="None",n[n.FilesExclude=2]="FilesExclude",n[n.SearchAndFilesExclude=3]="SearchAndFilesExclude"})(ps||(ps={}));var i1;(function(n){n[n.Information=1]="Information",n[n.Warning=2]="Warning"})(i1||(i1={}));const g5=2e4,m5=" ",_5=" characters skipped ",P3=(m5.length+_5.length+5)*2;var w4;(function(n){n[n.file=0]="file",n[n.text=1]="text",n[n.aiText=2]="aiText"})(w4||(w4={}));var tl;(function(n){n[n.File=1]="File",n[n.Text=2]="Text",n[n.aiText=3]="aiText"})(tl||(tl={}));function b4(n){return!!n.rangeLocations&&!!n.previewText}var y4;(function(n){n[n.Normal=0]="Normal",n[n.NewSearchStarted=1]="NewSearchStarted"})(y4||(y4={}));class T3{constructor(e,t,i,r){this.rangeLocations=[],this.webviewIndex=r;const s=Array.isArray(t)?t:[t];if(i&&i.matchLines===1&&A3(s)){e=m9(e,i.matchLines);let o="",a=0,l=0;const c=Math.floor(i.charsPerLine/5);for(const u of s){const d=Math.max(u.startColumn-c,0),f=u.startColumn+i.charsPerLine;if(d>l+c+P3){const p=m5+(d-l)+_5;o+=p+e.slice(d,f),a+=d-(l+p.length)}else o+=e.slice(l,f);l=f,this.rangeLocations.push({source:u,preview:new R3(0,u.startColumn-a,u.endColumn-a)})}this.previewText=o}else{const o=Array.isArray(t)?t[0].startLineNumber:t.startLineNumber,a=Ov(t,l=>({preview:new v5(l.startLineNumber-o,l.startColumn,l.endLineNumber-o,l.endColumn),source:l}));this.rangeLocations=Array.isArray(a)?a:[a],this.previewText=e}}}function A3(n){const e=n[0].startLineNumber;for(const t of n)if(t.startLineNumber!==e||t.endLineNumber!==e)return!1;return!0}class v5{constructor(e,t,i,r){this.startLineNumber=e,this.startColumn=t,this.endLineNumber=i,this.endColumn=r}}class R3 extends v5{constructor(e,t,i){super(e,t,e,i)}}var x4;(function(n){n.List="list",n.Tree="tree"})(x4||(x4={}));var E4;(function(n){n.Default="default",n.FileNames="fileNames",n.Type="type",n.Modified="modified",n.CountDescending="countDescending",n.CountAscending="countAscending"})(E4||(E4={}));function L3(n,e=!0){const t=n&&n.files&&n.files.exclude,i=e&&n&&n.search&&n.search.exclude;if(!t&&!i)return;if(!t||!i)return t||i||void 0;let r=Object.create(null);return r=gl(r,_t(t)),r=gl(r,_t(i),!0),r}function S4(n,e){return n.excludePattern&&zd(n.excludePattern,e)?!1:n.includePattern||n.usingSearchPaths?n.includePattern&&zd(n.includePattern,e)?!0:n.usingSearchPaths?!!n.folderQueries&&n.folderQueries.some(t=>{const i=t.folder.fsPath;if(ag(e,i)){const r=gh(i,e);return!t.includePattern||!!zd(t.includePattern,r)}else return!1}):!1:!0}var D4;(function(n){n[n.unknownEncoding=1]="unknownEncoding",n[n.regexParseError=2]="regexParseError",n[n.globParseError=3]="globParseError",n[n.invalidLiteral=4]="invalidLiteral",n[n.rgProcessError=5]="rgProcessError",n[n.other=6]="other",n[n.canceled=7]="canceled"})(D4||(D4={}));function Hc(n,e){const t={...n||{},...e||{}};return Object.keys(t).filter(i=>{const r=t[i];return typeof r=="boolean"&&r})}class w5{constructor(e,t){var r;this._parsedIncludeExpression=null,this._excludeExpression=((r=t.excludePattern)==null?void 0:r.map(s=>({...e.excludePattern||{},...s.pattern||{}})))??[],this._excludeExpression.length===0&&(this._excludeExpression=[e.excludePattern||{}]),this._parsedExcludeExpression=this._excludeExpression.map(s=>_u(s));let i=e.includePattern;t.includePattern&&(i?i={...i,...t.includePattern}:i=t.includePattern),i&&(this._parsedIncludeExpression=_u(i))}_evalParsedExcludeExpression(e,t,i){let r=null;for(const s of this._parsedExcludeExpression){const o=s(e,t,i);if(typeof o=="string"){r=o;break}}return r}matchesExcludesSync(e,t,i){return!!(this._parsedExcludeExpression&&this._evalParsedExcludeExpression(e,t,i))}includedInQuerySync(e,t,i){return!(this._parsedExcludeExpression&&this._evalParsedExcludeExpression(e,t,i)||this._parsedIncludeExpression&&!this._parsedIncludeExpression(e,t,i))}includedInQuery(e,t,i){const r=()=>this._parsedIncludeExpression?!!this._parsedIncludeExpression(e,t,i):!0;return Promise.all(this._parsedExcludeExpression.map(s=>{const o=s(e,t,i);return Io(o)?o.then(a=>a?!1:r()):r()})).then(s=>s.some(o=>!!o))}hasSiblingExcludeClauses(){return this._excludeExpression.reduce((e,t)=>N3(t)||e,!1)}}function N3(n){for(const e in n)if(typeof n[e]!="boolean")return!0;return!1}function O3(n){if(!n)return;let e;return t=>(e||(e=(n()||Promise.resolve([])).then(i=>i?b5(i):{})),e.then(i=>!!i[t]))}function F3(n){if(!n)return;let e;return t=>{if(!e){const i=n();e=i?b5(i):{}}return!!e[t]}}function b5(n){const e={};for(const t of n)e[t]=!0;return e}function y5(n){return n.flatMap(e=>e.patterns.map(t=>e.baseUri?{baseUri:e.baseUri,pattern:t}:t))}const d0={matchLines:100,charsPerLine:1e4};function gf(n,e,t){return new Vf(i=>Gx(i,t)).isEqual(n,e)}function M3(n,e,t){return gf(n.uri,e.uri,t)?0:fl(n.uri.toString(),e.uri.toString())}function $3(n,e,t){return n.index!==e.index?n.index<e.index?-1:1:gf(n.uri,e.uri,t)?fl(n.name,e.name):fl(n.uri.toString(),e.uri.toString())}function x5(n,e,t,i){const r=n.slice(0).sort((o,a)=>t(o,a,i)),s=e.slice(0).sort((o,a)=>t(o,a,i));return F7(r,s,(o,a)=>t(o,a,i))}function Gx(n,e){const t=e.getCapabilities(n.scheme);return!(t&&t&Cr.PathCaseSensitive)}class Bc extends mT{static toExtHostWorkspace(e,t,i,r){if(!e)return{workspace:null,added:[],removed:[]};const{id:s,name:o,folders:a,configuration:l,transient:c,isUntitled:u}=e,d=[],f=t;t?a.forEach((m,x)=>{const k=y.revive(m.uri),D=Bc._findFolder(i||t,k,r);D?(D.name=m.name,D.index=m.index,d.push(D)):d.push({uri:k,name:m.name,index:x})}):d.push(...a.map(({uri:m,name:x,index:k})=>({uri:y.revive(m),name:x,index:k}))),d.sort((m,x)=>m.index<x.index?-1:1);const p=new Bc(s,o,d,!!c,l?y.revive(l):null,!!u,m=>Gx(m,r)),{added:w,removed:v}=x5(f?f.workspaceFolders:[],p.workspaceFolders,M3,r);return{workspace:p,added:w,removed:v}}static _findFolder(e,t,i){for(let r=0;r<e.folders.length;r++){const s=e.workspaceFolders[r];if(gf(s.uri,t,i))return s}}constructor(e,t,i,r,s,o,a){super(e,i.map(l=>new YI(l)),r,s,a),this._name=t,this._isUntitled=o,this._workspaceFolders=[],this._structure=ki.forUris(a,()=>!0),i.forEach(l=>{this._workspaceFolders.push(l),this._structure.set(l.uri,l)})}get name(){return this._name}get isUntitled(){return this._isUntitled}get workspaceFolders(){return this._workspaceFolders.slice(0)}getWorkspaceFolder(e,t){return t&&this._structure.get(e)&&(e=r_(e)),this._structure.findSubstr(e)}resolveWorkspaceFolder(e){return this._structure.get(e)}}let h0=class{constructor(e,t,i,r,s){this._onDidChangeWorkspace=new L,this.onDidChangeWorkspace=this._onDidChangeWorkspace.event,this._onDidGrantWorkspaceTrust=new L,this.onDidGrantWorkspaceTrust=this._onDidGrantWorkspaceTrust.event,this._activeSearchCallbacks=[],this._trusted=!1,this._editSessionIdentityProviders=new Map,this._providerHandlePool=0,this._onWillCreateEditSessionIdentityEvent=new Td,this._canonicalUriProviders=new Map,this._logService=r,this._extHostFileSystemInfo=i,this._uriTransformerService=s,this._requestIdProvider=new dT,this._barrier=new Nr,this._proxy=e.getProxy(Z.MainThreadWorkspace),this._messageService=e.getProxy(Z.MainThreadMessageService);const o=t.workspace;this._confirmedWorkspace=o?new Bc(o.id,o.name,[],!!o.transient,o.configuration?y.revive(o.configuration):null,!!o.isUntitled,a=>Gx(a,i)):void 0}$initializeWorkspace(e,t){this._trusted=t,this.$acceptWorkspaceData(e),this._barrier.open()}waitForInitializeCall(){return this._barrier.wait()}get workspace(){return this._actualWorkspace}get name(){return this._actualWorkspace?this._actualWorkspace.name:void 0}get workspaceFile(){if(this._actualWorkspace&&this._actualWorkspace.configuration)return this._actualWorkspace.isUntitled?y.from({scheme:oe.untitled,path:Lo(r_(this._actualWorkspace.configuration))}):this._actualWorkspace.configuration}get _actualWorkspace(){return this._unconfirmedWorkspace||this._confirmedWorkspace}getWorkspaceFolders(){if(this._actualWorkspace)return this._actualWorkspace.workspaceFolders.slice(0)}async getWorkspaceFolders2(){if(await this._barrier.wait(),!!this._actualWorkspace)return this._actualWorkspace.workspaceFolders.slice(0)}updateWorkspaceFolders(e,t,i,...r){const s=[];if(Array.isArray(r)&&r.forEach(u=>{y.isUri(u.uri)&&!s.some(d=>gf(d.uri,u.uri,this._extHostFileSystemInfo))&&s.push({uri:u.uri,name:u.name||Jv(u.uri)})}),this._unconfirmedWorkspace||[t,i].some(u=>typeof u!="number"||u<0)||i===0&&s.length===0)return!1;const o=this._actualWorkspace?this._actualWorkspace.workspaceFolders:[];if(t+i>o.length)return!1;const a=o.slice(0);a.splice(t,i,...s.map(u=>({uri:u.uri,name:u.name||Jv(u.uri),index:void 0})));for(let u=0;u<a.length;u++){const d=a[u];if(a.some((f,p)=>p!==u&&gf(d.uri,f.uri,this._extHostFileSystemInfo)))return!1}a.forEach((u,d)=>u.index=d);const{added:l,removed:c}=x5(o,a,$3,this._extHostFileSystemInfo);if(l.length===0&&c.length===0)return!1;if(this._proxy){const u=e.displayName||e.name;this._proxy.$updateWorkspaceFolders(u,t,i,s).then(void 0,d=>{this._unconfirmedWorkspace=void 0;const f={source:{identifier:e.identifier,label:e.displayName||e.name}};this._messageService.$showMessage(qt.Error,h(2555,"Extension '{0}' failed to update workspace folders: {1}",u,d.toString()),f,[])})}return this.trySetWorkspaceFolders(a),!0}getWorkspaceFolder(e,t){if(this._actualWorkspace)return this._actualWorkspace.getWorkspaceFolder(e,t)}async getWorkspaceFolder2(e,t){if(await this._barrier.wait(),!!this._actualWorkspace)return this._actualWorkspace.getWorkspaceFolder(e,t)}async resolveWorkspaceFolder(e){if(await this._barrier.wait(),!!this._actualWorkspace)return this._actualWorkspace.resolveWorkspaceFolder(e)}getPath(){if(!this._actualWorkspace)return;const{folders:e}=this._actualWorkspace;if(e.length!==0)return e[0].uri.fsPath}getRelativePath(e,t){let i,r="";if(typeof e=="string"?(i=y.file(e),r=e):typeof e<"u"&&(i=e,r=e.fsPath),!i)return r;const s=this.getWorkspaceFolder(i,!0);if(!s)return r;typeof t>"u"&&this._actualWorkspace&&(t=this._actualWorkspace.folders.length>1);let o=$I(s.uri,i);return t&&s.name&&(o=`${s.name}/${o}`),o}trySetWorkspaceFolders(e){this._actualWorkspace&&(this._unconfirmedWorkspace=Bc.toExtHostWorkspace({id:this._actualWorkspace.id,name:this._actualWorkspace.name,configuration:this._actualWorkspace.configuration,folders:e,isUntitled:this._actualWorkspace.isUntitled},this._actualWorkspace,void 0,this._extHostFileSystemInfo).workspace||void 0)}$acceptWorkspaceData(e){const{workspace:t,added:i,removed:r}=Bc.toExtHostWorkspace(e,this._confirmedWorkspace,this._unconfirmedWorkspace,this._extHostFileSystemInfo);this._confirmedWorkspace=t||void 0,this._unconfirmedWorkspace=void 0,this._onDidChangeWorkspace.fire(Object.freeze({added:i,removed:r}))}findFiles(e,t,i,r,s=Pt.None){this._logService.trace(`extHostWorkspace#findFiles: fileSearch, extension: ${r.value}, entryPoint: findFiles`);let o="",a=!0;return t===null?a=!1:t!==void 0&&(typeof t=="string"?o=t:o=t.pattern),this._findFilesImpl({type:"include",value:e},{exclude:[o],maxResults:i,useExcludeSettings:a?ps.FilesExclude:ps.None,useIgnoreFiles:{local:!1}},s)}findFiles2(e,t={},i,r=Pt.None){return this._logService.trace(`extHostWorkspace#findFiles2New: fileSearch, extension: ${i.value}, entryPoint: findFiles2New`),this._findFilesImpl({type:"filePatterns",value:e},t,r)}async _findFilesImpl(e,t,i){if(i.isCancellationRequested)return Promise.resolve([]);const r=e.type==="include"?[e.value]:e.value??[];if(!Array.isArray(r))throw console.error("Invalid file pattern provided",r),new Error(`Invalid file pattern provided ${JSON.stringify(r)}`);const s=r.map(o=>{var d,f,p;const a=k4(t.exclude),l={ignoreSymlinks:typeof t.followSymlinks=="boolean"?!t.followSymlinks:void 0,disregardIgnoreFiles:typeof((d=t.useIgnoreFiles)==null?void 0:d.local)=="boolean"?!t.useIgnoreFiles.local:void 0,disregardGlobalIgnoreFiles:typeof((f=t.useIgnoreFiles)==null?void 0:f.global)=="boolean"?!t.useIgnoreFiles.global:void 0,disregardParentIgnoreFiles:typeof((p=t.useIgnoreFiles)==null?void 0:p.parent)=="boolean"?!t.useIgnoreFiles.parent:void 0,disregardExcludeSettings:t.useExcludeSettings!==void 0&&t.useExcludeSettings===ps.None,disregardSearchExcludeSettings:t.useExcludeSettings!==void 0&&t.useExcludeSettings!==ps.SearchAndFilesExclude,maxResults:t.maxResults,excludePattern:a.length>0?a:void 0,_reason:"startFileSearch",shouldGlobSearch:e.type==="include"?void 0:!0},c=Hp(di.from(o)),u=c==null?void 0:c.folder;return e.type==="include"?l.includePattern=c==null?void 0:c.pattern:l.filePattern=c==null?void 0:c.pattern,{folder:u,options:l}});return this._findFilesBase(s,i)}async _findFilesBase(e,t){return(await Promise.all((e==null?void 0:e.map(r=>this._proxy.$startFileSearch(r.folder??null,r.options,t).then(s=>Array.isArray(s)?s.map(o=>y.revive(o)):[])))??[])).flat()}findTextInFiles2(e,t,i,r=Pt.None){var f;this._logService.trace(`extHostWorkspace#findTextInFiles2: textSearch, extension: ${i.value}, entryPoint: findTextInFiles2`);const s=p=>{var m,x,k,D,B,T;if(!t)return{folder:void 0,options:{}};const w=p?Hp(di.from(p)):void 0,v=t.exclude?k4(t.exclude):void 0;return{options:{ignoreSymlinks:typeof t.followSymlinks=="boolean"?!t.followSymlinks:void 0,disregardIgnoreFiles:typeof t.useIgnoreFiles=="boolean"?!t.useIgnoreFiles:void 0,disregardGlobalIgnoreFiles:typeof((m=t.useIgnoreFiles)==null?void 0:m.global)=="boolean"?!((x=t.useIgnoreFiles)!=null&&x.global):void 0,disregardParentIgnoreFiles:typeof((k=t.useIgnoreFiles)==null?void 0:k.parent)=="boolean"?!((D=t.useIgnoreFiles)!=null&&D.parent):void 0,disregardExcludeSettings:t.useExcludeSettings!==void 0&&t.useExcludeSettings===ps.None,disregardSearchExcludeSettings:t.useExcludeSettings!==void 0&&t.useExcludeSettings!==ps.SearchAndFilesExclude,fileEncoding:t.encoding,maxResults:t.maxResults,previewOptions:t.previewOptions?{matchLines:((B=t.previewOptions)==null?void 0:B.numMatchLines)??100,charsPerLine:((T=t.previewOptions)==null?void 0:T.charsPerLine)??1e4}:void 0,surroundingContext:t.surroundingContext,includePattern:w==null?void 0:w.pattern,excludePattern:v},folder:w==null?void 0:w.folder}},a=(((f=t==null?void 0:t.include)==null?void 0:f.map(p=>s(p)))??[s(void 0)]).filter(p=>!!p),l=new Ie,c=l.add(new L),u=this.findTextInFilesBase(e,a,(p,w)=>c.fire({result:p,uri:w}),r);return{results:new pl(async p=>{l.add(c.event(w=>{const v=w.result,m=w.uri;b4(v)?p.emitOne(new wo(m,v.rangeLocations.map(x=>({previewRange:new Oe(x.preview.startLineNumber,x.preview.startColumn,x.preview.endLineNumber,x.preview.endColumn),sourceRange:new Oe(x.source.startLineNumber,x.source.startColumn,x.source.endLineNumber,x.source.endColumn)})),v.previewText)):p.emitOne(new jx(m,v.text,v.lineNumber))})),await u}),complete:u.then(p=>(l.dispose(),{limitHit:(p==null?void 0:p.limitHit)??!1}))}}async findTextInFilesBase(e,t,i,r=Pt.None){const s=this._requestIdProvider.getNext();let o=!1;if(r.onCancellationRequested(a=>{o=!0}),this._activeSearchCallbacks[s]=a=>{if(o)return;const l=y.revive(a.resource);a.results.forEach(c=>{const u=jn(c);i(u,l)})},r.isCancellationRequested)return{};try{const a=await Promise.all((t==null?void 0:t.map(l=>this._proxy.$startTextSearch(e,l.folder??null,l.options,s,r)||{}))??[]);return delete this._activeSearchCallbacks[s],a.reduce((l,c)=>({limitHit:(l==null?void 0:l.limitHit)||((c==null?void 0:c.limitHit)??!1),message:[(l==null?void 0:l.message)??[],(c==null?void 0:c.message)??[]].flat()}),{})??{limitHit:!1}}catch(a){throw delete this._activeSearchCallbacks[s],a}}async findTextInFiles(e,t,i,r,s=Pt.None){this._logService.trace(`extHostWorkspace#findTextInFiles: textSearch, extension: ${r.value}, entryPoint: findTextInFiles`);const o=typeof t.previewOptions>"u"?{matchLines:100,charsPerLine:1e4}:t.previewOptions,a=Hp(di.from(t.include)),l=typeof t.exclude=="string"?t.exclude:t.exclude?t.exclude.pattern:void 0,c={ignoreSymlinks:typeof t.followSymlinks=="boolean"?!t.followSymlinks:void 0,disregardIgnoreFiles:typeof t.useIgnoreFiles=="boolean"?!t.useIgnoreFiles:void 0,disregardGlobalIgnoreFiles:typeof t.useGlobalIgnoreFiles=="boolean"?!t.useGlobalIgnoreFiles:void 0,disregardParentIgnoreFiles:typeof t.useParentIgnoreFiles=="boolean"?!t.useParentIgnoreFiles:void 0,disregardExcludeSettings:typeof t.useDefaultExcludes=="boolean"?!t.useDefaultExcludes:!0,disregardSearchExcludeSettings:typeof t.useSearchExclude=="boolean"?!t.useSearchExclude:!0,fileEncoding:t.encoding,maxResults:t.maxResults,previewOptions:o,surroundingContext:t.afterContext,includePattern:a==null?void 0:a.pattern,excludePattern:l?[{pattern:l}]:void 0},u=(d,f)=>{b4(d)?i({uri:f,preview:{text:d.previewText,matches:Ov(d.rangeLocations,p=>new Oe(p.preview.startLineNumber,p.preview.startColumn,p.preview.endLineNumber,p.preview.endColumn))},ranges:Ov(d.rangeLocations,p=>new Oe(p.source.startLineNumber,p.source.startColumn,p.source.endLineNumber,p.source.endColumn))}):i({uri:f,text:d.text,lineNumber:d.lineNumber})};return this.findTextInFilesBase(e,[{options:c,folder:a==null?void 0:a.folder}],u,s)}$handleTextSearchResult(e,t){var i,r;(r=(i=this._activeSearchCallbacks)[t])==null||r.call(i,e)}async save(e){const t=await this._proxy.$save(e,{saveAs:!1});return y.revive(t)}async saveAs(e){const t=await this._proxy.$save(e,{saveAs:!0});return y.revive(t)}saveAll(e){return this._proxy.$saveAll(e)}resolveProxy(e){return this._proxy.$resolveProxy(e)}lookupAuthorization(e){return this._proxy.$lookupAuthorization(e)}lookupKerberosAuthorization(e){return this._proxy.$lookupKerberosAuthorization(e)}loadCertificates(){return this._proxy.$loadCertificates()}get trusted(){return this._trusted}requestWorkspaceTrust(e){return this._proxy.$requestWorkspaceTrust(e)}$onDidGrantWorkspaceTrust(){this._trusted||(this._trusted=!0,this._onDidGrantWorkspaceTrust.fire())}registerEditSessionIdentityProvider(e,t){if(this._editSessionIdentityProviders.has(e))throw new Error(`A provider has already been registered for scheme ${e}`);this._editSessionIdentityProviders.set(e,t);const i=this._uriTransformerService.transformOutgoingScheme(e),r=this._providerHandlePool++;return this._proxy.$registerEditSessionIdentityProvider(r,i),Se(()=>{this._editSessionIdentityProviders.delete(e),this._proxy.$unregisterEditSessionIdentityProvider(r)})}async $getEditSessionIdentifier(e,t){this._logService.info("Getting edit session identifier for workspaceFolder",e);const i=await this.resolveWorkspaceFolder(y.revive(e));if(!i){this._logService.warn("Unable to resolve workspace folder");return}this._logService.info("Invoking #provideEditSessionIdentity for workspaceFolder",i);const r=this._editSessionIdentityProviders.get(i.uri.scheme);if(this._logService.info(`Provider for scheme ${i.uri.scheme} is defined: `,!!r),!r)return;const s=await r.provideEditSessionIdentity(i,t);if(this._logService.info("Provider returned edit session identifier: ",s),!!s)return s}async $provideEditSessionIdentityMatch(e,t,i,r){var l;this._logService.info("Getting edit session identifier for workspaceFolder",e);const s=await this.resolveWorkspaceFolder(y.revive(e));if(!s){this._logService.warn("Unable to resolve workspace folder");return}this._logService.info("Invoking #provideEditSessionIdentity for workspaceFolder",s);const o=this._editSessionIdentityProviders.get(s.uri.scheme);if(this._logService.info(`Provider for scheme ${s.uri.scheme} is defined: `,!!o),!o)return;const a=await((l=o.provideEditSessionIdentityMatch)==null?void 0:l.call(o,t,i,r));if(this._logService.info("Provider returned edit session identifier match result: ",a),!!a)return a}getOnWillCreateEditSessionIdentityEvent(e){return(t,i,r)=>{const s=function(a){t.call(i,a)};return s.extension=e,this._onWillCreateEditSessionIdentityEvent.event(s,void 0,r)}}async $onWillCreateEditSessionIdentity(e,t,i){const r=await this.resolveWorkspaceFolder(y.revive(e));if(r===void 0)throw new Error("Unable to resolve workspace folder");await this._onWillCreateEditSessionIdentityEvent.fireAsync({workspaceFolder:r},t,async(s,o)=>{const a=Date.now();await Promise.resolve(s),Date.now()-a>i&&this._logService.warn("SLOW edit session create-participant",o.extension.identifier)}),t.isCancellationRequested}registerCanonicalUriProvider(e,t){if(this._canonicalUriProviders.has(e))throw new Error(`A provider has already been registered for scheme ${e}`);this._canonicalUriProviders.set(e,t);const i=this._uriTransformerService.transformOutgoingScheme(e),r=this._providerHandlePool++;return this._proxy.$registerCanonicalUriProvider(r,i),Se(()=>{this._canonicalUriProviders.delete(e),this._proxy.$unregisterCanonicalUriProvider(r)})}async provideCanonicalUri(e,t,i){var o;const r=this._canonicalUriProviders.get(e.scheme);if(!r)return;const s=await((o=r.provideCanonicalUri)==null?void 0:o.call(r,y.revive(e),t,i));if(s)return s}async $provideCanonicalUri(e,t,i){return this.provideCanonicalUri(y.revive(e),{targetScheme:t},i)}decode(e,t,i){return this._proxy.$decode(Pe.wrap(e),t,i)}async encode(e,t,i){return(await this._proxy.$encode(e,t,i)).buffer}};h0=V([F(0,tt),F(1,In),F(2,Ju),F(3,ct),F(4,s_)],h0);const Hs=De("IExtHostWorkspace");function Hp(n){let e,t;if(n)return typeof n=="string"?e=n:(e=n.pattern,t=y.revive(n.baseUri)),{pattern:e,folder:t}}function k4(n){return((n==null?void 0:n.map(e=>{if(typeof e=="string")return e===""?void 0:{pattern:e,uri:void 0};{const t=Hp(e);return t?{pattern:t.pattern,uri:t.folder}:void 0}}))??[]).filter(e=>!!e)}var dn;(function(n){n[n.APPLICATION=1]="APPLICATION",n[n.USER=2]="USER",n[n.USER_LOCAL=3]="USER_LOCAL",n[n.USER_REMOTE=4]="USER_REMOTE",n[n.WORKSPACE=5]="WORKSPACE",n[n.WORKSPACE_FOLDER=6]="WORKSPACE_FOLDER",n[n.DEFAULT=7]="DEFAULT",n[n.MEMORY=8]="MEMORY"})(dn||(dn={}));function f0(n,e){const t=Object.create(null);for(const i in n)E5(t,i,n[i],e);return t}function E5(n,e,t,i){const r=e.split("."),s=r.pop();let o=n;for(let a=0;a<r.length;a++){const l=r[a];let c=o[l];switch(typeof c){case"undefined":c=o[l]=Object.create(null);break;case"object":if(c===null){i(`Ignoring ${e} as ${r.slice(0,a+1).join(".")} is null`);return}break;default:i(`Ignoring ${e} as ${r.slice(0,a+1).join(".")} is ${JSON.stringify(c)}`);return}o=c}if(typeof o=="object"&&o!==null)try{o[s]=t}catch{i(`Ignoring ${e} as ${r.join(".")} is ${JSON.stringify(o)}`)}else i(`Ignoring ${e} as ${r.join(".")} is ${JSON.stringify(o)}`)}function U3(n,e){const t=e.split(".");S5(n,t)}function S5(n,e){if(!n)return;const t=e.shift();if(e.length===0){delete n[t];return}if(Object.keys(n).indexOf(t)!==-1){const i=n[t];typeof i=="object"&&!Array.isArray(i)&&(S5(i,e),Object.keys(i).length===0&&delete n[t])}}function r1(n,e,t){function i(o,a){let l=o;for(const c of a){if(typeof l!="object"||l===null)return;l=l[c]}return l}const r=e.split("."),s=i(n,r);return typeof s>"u"?t:s}function H3(n){return n.replace(/[\[\]]/g,"")}var un;(function(n){n[n.None=0]="None",n[n.UnexpectedEndOfComment=1]="UnexpectedEndOfComment",n[n.UnexpectedEndOfString=2]="UnexpectedEndOfString",n[n.UnexpectedEndOfNumber=3]="UnexpectedEndOfNumber",n[n.InvalidUnicode=4]="InvalidUnicode",n[n.InvalidEscapeCharacter=5]="InvalidEscapeCharacter",n[n.InvalidCharacter=6]="InvalidCharacter"})(un||(un={}));var me;(function(n){n[n.OpenBraceToken=1]="OpenBraceToken",n[n.CloseBraceToken=2]="CloseBraceToken",n[n.OpenBracketToken=3]="OpenBracketToken",n[n.CloseBracketToken=4]="CloseBracketToken",n[n.CommaToken=5]="CommaToken",n[n.ColonToken=6]="ColonToken",n[n.NullKeyword=7]="NullKeyword",n[n.TrueKeyword=8]="TrueKeyword",n[n.FalseKeyword=9]="FalseKeyword",n[n.StringLiteral=10]="StringLiteral",n[n.NumericLiteral=11]="NumericLiteral",n[n.LineCommentTrivia=12]="LineCommentTrivia",n[n.BlockCommentTrivia=13]="BlockCommentTrivia",n[n.LineBreakTrivia=14]="LineBreakTrivia",n[n.Trivia=15]="Trivia",n[n.Unknown=16]="Unknown",n[n.EOF=17]="EOF"})(me||(me={}));var Rt;(function(n){n[n.InvalidSymbol=1]="InvalidSymbol",n[n.InvalidNumberFormat=2]="InvalidNumberFormat",n[n.PropertyNameExpected=3]="PropertyNameExpected",n[n.ValueExpected=4]="ValueExpected",n[n.ColonExpected=5]="ColonExpected",n[n.CommaExpected=6]="CommaExpected",n[n.CloseBraceExpected=7]="CloseBraceExpected",n[n.CloseBracketExpected=8]="CloseBracketExpected",n[n.EndOfFileExpected=9]="EndOfFileExpected",n[n.InvalidCommentToken=10]="InvalidCommentToken",n[n.UnexpectedEndOfComment=11]="UnexpectedEndOfComment",n[n.UnexpectedEndOfString=12]="UnexpectedEndOfString",n[n.UnexpectedEndOfNumber=13]="UnexpectedEndOfNumber",n[n.InvalidUnicode=14]="InvalidUnicode",n[n.InvalidEscapeCharacter=15]="InvalidEscapeCharacter",n[n.InvalidCharacter=16]="InvalidCharacter"})(Rt||(Rt={}));var p0;(function(n){n.DEFAULT={allowTrailingComma:!0}})(p0||(p0={}));function B3(n,e=!1){let t=0;const i=n.length;let r="",s=0,o=me.Unknown,a=un.None;function l(v){let m=0,x=0;for(;m<v;){const k=n.charCodeAt(t);if(k>=se._0&&k<=se._9)x=x*16+k-se._0;else if(k>=se.A&&k<=se.F)x=x*16+k-se.A+10;else if(k>=se.a&&k<=se.f)x=x*16+k-se.a+10;else break;t++,m++}return m<v&&(x=-1),x}function c(v){t=v,r="",s=0,o=me.Unknown,a=un.None}function u(){const v=t;if(n.charCodeAt(t)===se._0)t++;else for(t++;t<n.length&&Vl(n.charCodeAt(t));)t++;if(t<n.length&&n.charCodeAt(t)===se.dot)if(t++,t<n.length&&Vl(n.charCodeAt(t)))for(t++;t<n.length&&Vl(n.charCodeAt(t));)t++;else return a=un.UnexpectedEndOfNumber,n.substring(v,t);let m=t;if(t<n.length&&(n.charCodeAt(t)===se.E||n.charCodeAt(t)===se.e))if(t++,(t<n.length&&n.charCodeAt(t)===se.plus||n.charCodeAt(t)===se.minus)&&t++,t<n.length&&Vl(n.charCodeAt(t))){for(t++;t<n.length&&Vl(n.charCodeAt(t));)t++;m=t}else a=un.UnexpectedEndOfNumber;return n.substring(v,m)}function d(){let v="",m=t;for(;;){if(t>=i){v+=n.substring(m,t),a=un.UnexpectedEndOfString;break}const x=n.charCodeAt(t);if(x===se.doubleQuote){v+=n.substring(m,t),t++;break}if(x===se.backslash){if(v+=n.substring(m,t),t++,t>=i){a=un.UnexpectedEndOfString;break}switch(n.charCodeAt(t++)){case se.doubleQuote:v+='"';break;case se.backslash:v+="\\";break;case se.slash:v+="/";break;case se.b:v+="\b";break;case se.f:v+="\f";break;case se.n:v+=`
`;break;case se.r:v+="\r";break;case se.t:v+="	";break;case se.u:{const D=l(4);D>=0?v+=String.fromCharCode(D):a=un.InvalidUnicode;break}default:a=un.InvalidEscapeCharacter}m=t;continue}if(x>=0&&x<=31)if(cp(x)){v+=n.substring(m,t),a=un.UnexpectedEndOfString;break}else a=un.InvalidCharacter;t++}return v}function f(){if(r="",a=un.None,s=t,t>=i)return s=i,o=me.EOF;let v=n.charCodeAt(t);if(dv(v)){do t++,r+=String.fromCharCode(v),v=n.charCodeAt(t);while(dv(v));return o=me.Trivia}if(cp(v))return t++,r+=String.fromCharCode(v),v===se.carriageReturn&&n.charCodeAt(t)===se.lineFeed&&(t++,r+=`
`),o=me.LineBreakTrivia;switch(v){case se.openBrace:return t++,o=me.OpenBraceToken;case se.closeBrace:return t++,o=me.CloseBraceToken;case se.openBracket:return t++,o=me.OpenBracketToken;case se.closeBracket:return t++,o=me.CloseBracketToken;case se.colon:return t++,o=me.ColonToken;case se.comma:return t++,o=me.CommaToken;case se.doubleQuote:return t++,r=d(),o=me.StringLiteral;case se.slash:{const m=t-1;if(n.charCodeAt(t+1)===se.slash){for(t+=2;t<i&&!cp(n.charCodeAt(t));)t++;return r=n.substring(m,t),o=me.LineCommentTrivia}if(n.charCodeAt(t+1)===se.asterisk){t+=2;const x=i-1;let k=!1;for(;t<x;){if(n.charCodeAt(t)===se.asterisk&&n.charCodeAt(t+1)===se.slash){t+=2,k=!0;break}t++}return k||(t++,a=un.UnexpectedEndOfComment),r=n.substring(m,t),o=me.BlockCommentTrivia}return r+=String.fromCharCode(v),t++,o=me.Unknown}case se.minus:if(r+=String.fromCharCode(v),t++,t===i||!Vl(n.charCodeAt(t)))return o=me.Unknown;case se._0:case se._1:case se._2:case se._3:case se._4:case se._5:case se._6:case se._7:case se._8:case se._9:return r+=u(),o=me.NumericLiteral;default:for(;t<i&&p(v);)t++,v=n.charCodeAt(t);if(s!==t){switch(r=n.substring(s,t),r){case"true":return o=me.TrueKeyword;case"false":return o=me.FalseKeyword;case"null":return o=me.NullKeyword}return o=me.Unknown}return r+=String.fromCharCode(v),t++,o=me.Unknown}}function p(v){if(dv(v)||cp(v))return!1;switch(v){case se.closeBrace:case se.closeBracket:case se.openBrace:case se.openBracket:case se.doubleQuote:case se.colon:case se.comma:case se.slash:return!1}return!0}function w(){let v;do v=f();while(v>=me.LineCommentTrivia&&v<=me.Trivia);return v}return{setPosition:c,getPosition:()=>t,scan:e?w:f,getToken:()=>o,getTokenValue:()=>r,getTokenOffset:()=>s,getTokenLength:()=>t-s,getTokenError:()=>a}}function dv(n){return n===se.space||n===se.tab||n===se.verticalTab||n===se.formFeed||n===se.nonBreakingSpace||n===se.ogham||n>=se.enQuad&&n<=se.zeroWidthSpace||n===se.narrowNoBreakSpace||n===se.mathematicalSpace||n===se.ideographicSpace||n===se.byteOrderMark}function cp(n){return n===se.lineFeed||n===se.carriageReturn||n===se.lineSeparator||n===se.paragraphSeparator}function Vl(n){return n>=se._0&&n<=se._9}var se;(function(n){n[n.nullCharacter=0]="nullCharacter",n[n.maxAsciiCharacter=127]="maxAsciiCharacter",n[n.lineFeed=10]="lineFeed",n[n.carriageReturn=13]="carriageReturn",n[n.lineSeparator=8232]="lineSeparator",n[n.paragraphSeparator=8233]="paragraphSeparator",n[n.nextLine=133]="nextLine",n[n.space=32]="space",n[n.nonBreakingSpace=160]="nonBreakingSpace",n[n.enQuad=8192]="enQuad",n[n.emQuad=8193]="emQuad",n[n.enSpace=8194]="enSpace",n[n.emSpace=8195]="emSpace",n[n.threePerEmSpace=8196]="threePerEmSpace",n[n.fourPerEmSpace=8197]="fourPerEmSpace",n[n.sixPerEmSpace=8198]="sixPerEmSpace",n[n.figureSpace=8199]="figureSpace",n[n.punctuationSpace=8200]="punctuationSpace",n[n.thinSpace=8201]="thinSpace",n[n.hairSpace=8202]="hairSpace",n[n.zeroWidthSpace=8203]="zeroWidthSpace",n[n.narrowNoBreakSpace=8239]="narrowNoBreakSpace",n[n.ideographicSpace=12288]="ideographicSpace",n[n.mathematicalSpace=8287]="mathematicalSpace",n[n.ogham=5760]="ogham",n[n._=95]="_",n[n.$=36]="$",n[n._0=48]="_0",n[n._1=49]="_1",n[n._2=50]="_2",n[n._3=51]="_3",n[n._4=52]="_4",n[n._5=53]="_5",n[n._6=54]="_6",n[n._7=55]="_7",n[n._8=56]="_8",n[n._9=57]="_9",n[n.a=97]="a",n[n.b=98]="b",n[n.c=99]="c",n[n.d=100]="d",n[n.e=101]="e",n[n.f=102]="f",n[n.g=103]="g",n[n.h=104]="h",n[n.i=105]="i",n[n.j=106]="j",n[n.k=107]="k",n[n.l=108]="l",n[n.m=109]="m",n[n.n=110]="n",n[n.o=111]="o",n[n.p=112]="p",n[n.q=113]="q",n[n.r=114]="r",n[n.s=115]="s",n[n.t=116]="t",n[n.u=117]="u",n[n.v=118]="v",n[n.w=119]="w",n[n.x=120]="x",n[n.y=121]="y",n[n.z=122]="z",n[n.A=65]="A",n[n.B=66]="B",n[n.C=67]="C",n[n.D=68]="D",n[n.E=69]="E",n[n.F=70]="F",n[n.G=71]="G",n[n.H=72]="H",n[n.I=73]="I",n[n.J=74]="J",n[n.K=75]="K",n[n.L=76]="L",n[n.M=77]="M",n[n.N=78]="N",n[n.O=79]="O",n[n.P=80]="P",n[n.Q=81]="Q",n[n.R=82]="R",n[n.S=83]="S",n[n.T=84]="T",n[n.U=85]="U",n[n.V=86]="V",n[n.W=87]="W",n[n.X=88]="X",n[n.Y=89]="Y",n[n.Z=90]="Z",n[n.ampersand=38]="ampersand",n[n.asterisk=42]="asterisk",n[n.at=64]="at",n[n.backslash=92]="backslash",n[n.bar=124]="bar",n[n.caret=94]="caret",n[n.closeBrace=125]="closeBrace",n[n.closeBracket=93]="closeBracket",n[n.closeParen=41]="closeParen",n[n.colon=58]="colon",n[n.comma=44]="comma",n[n.dot=46]="dot",n[n.doubleQuote=34]="doubleQuote",n[n.equals=61]="equals",n[n.exclamation=33]="exclamation",n[n.greaterThan=62]="greaterThan",n[n.lessThan=60]="lessThan",n[n.minus=45]="minus",n[n.openBrace=123]="openBrace",n[n.openBracket=91]="openBracket",n[n.openParen=40]="openParen",n[n.percent=37]="percent",n[n.plus=43]="plus",n[n.question=63]="question",n[n.semicolon=59]="semicolon",n[n.singleQuote=39]="singleQuote",n[n.slash=47]="slash",n[n.tilde=126]="tilde",n[n.backspace=8]="backspace",n[n.formFeed=12]="formFeed",n[n.byteOrderMark=65279]="byteOrderMark",n[n.tab=9]="tab",n[n.verticalTab=11]="verticalTab"})(se||(se={}));function W3(n,e,t=p0.DEFAULT){const i=B3(n,!1);function r(Q){return Q?()=>Q(i.getTokenOffset(),i.getTokenLength()):()=>!0}function s(Q){return Q?le=>Q(le,i.getTokenOffset(),i.getTokenLength()):()=>!0}const o=r(e.onObjectBegin),a=s(e.onObjectProperty),l=r(e.onObjectEnd),c=r(e.onArrayBegin),u=r(e.onArrayEnd),d=s(e.onLiteralValue),f=s(e.onSeparator),p=r(e.onComment),w=s(e.onError),v=t&&t.disallowComments,m=t&&t.allowTrailingComma;function x(){for(;;){const Q=i.scan();switch(i.getTokenError()){case un.InvalidUnicode:k(Rt.InvalidUnicode);break;case un.InvalidEscapeCharacter:k(Rt.InvalidEscapeCharacter);break;case un.UnexpectedEndOfNumber:k(Rt.UnexpectedEndOfNumber);break;case un.UnexpectedEndOfComment:v||k(Rt.UnexpectedEndOfComment);break;case un.UnexpectedEndOfString:k(Rt.UnexpectedEndOfString);break;case un.InvalidCharacter:k(Rt.InvalidCharacter);break}switch(Q){case me.LineCommentTrivia:case me.BlockCommentTrivia:v?k(Rt.InvalidCommentToken):p();break;case me.Unknown:k(Rt.InvalidSymbol);break;case me.Trivia:case me.LineBreakTrivia:break;default:return Q}}}function k(Q,le=[],Ye=[]){if(w(Q),le.length+Ye.length>0){let Ce=i.getToken();for(;Ce!==me.EOF;){if(le.indexOf(Ce)!==-1){x();break}else if(Ye.indexOf(Ce)!==-1)break;Ce=x()}}}function D(Q){const le=i.getTokenValue();return Q?d(le):a(le),x(),!0}function B(){switch(i.getToken()){case me.NumericLiteral:{let Q=0;try{Q=JSON.parse(i.getTokenValue()),typeof Q!="number"&&(k(Rt.InvalidNumberFormat),Q=0)}catch{k(Rt.InvalidNumberFormat)}d(Q);break}case me.NullKeyword:d(null);break;case me.TrueKeyword:d(!0);break;case me.FalseKeyword:d(!1);break;default:return!1}return x(),!0}function T(){return i.getToken()!==me.StringLiteral?(k(Rt.PropertyNameExpected,[],[me.CloseBraceToken,me.CommaToken]),!1):(D(!1),i.getToken()===me.ColonToken?(f(":"),x(),Ee()||k(Rt.ValueExpected,[],[me.CloseBraceToken,me.CommaToken])):k(Rt.ColonExpected,[],[me.CloseBraceToken,me.CommaToken]),!0)}function z(){o(),x();let Q=!1;for(;i.getToken()!==me.CloseBraceToken&&i.getToken()!==me.EOF;){if(i.getToken()===me.CommaToken){if(Q||k(Rt.ValueExpected,[],[]),f(","),x(),i.getToken()===me.CloseBraceToken&&m)break}else Q&&k(Rt.CommaExpected,[],[]);T()||k(Rt.ValueExpected,[],[me.CloseBraceToken,me.CommaToken]),Q=!0}return l(),i.getToken()!==me.CloseBraceToken?k(Rt.CloseBraceExpected,[me.CloseBraceToken],[]):x(),!0}function K(){c(),x();let Q=!1;for(;i.getToken()!==me.CloseBracketToken&&i.getToken()!==me.EOF;){if(i.getToken()===me.CommaToken){if(Q||k(Rt.ValueExpected,[],[]),f(","),x(),i.getToken()===me.CloseBracketToken&&m)break}else Q&&k(Rt.CommaExpected,[],[]);Ee()||k(Rt.ValueExpected,[],[me.CloseBracketToken,me.CommaToken]),Q=!0}return u(),i.getToken()!==me.CloseBracketToken?k(Rt.CloseBracketExpected,[me.CloseBracketToken],[]):x(),!0}function Ee(){switch(i.getToken()){case me.OpenBracketToken:return K();case me.OpenBraceToken:return z();case me.StringLiteral:return D(!0);default:return B()}}return x(),i.getToken()===me.EOF?t.allowEmptyContent?!0:(k(Rt.ValueExpected,[],[]),!1):Ee()?(i.getToken()!==me.EOF&&k(Rt.EndOfFileExpected,[],[]),!0):(k(Rt.ValueExpected,[],[]),!1)}var I4;(function(n){n.Multiline="multilineText",n.Singleline="singlelineText"})(I4||(I4={}));const Zf={Configuration:"base.contributions.configuration"};var Ft;(function(n){n[n.APPLICATION=1]="APPLICATION",n[n.MACHINE=2]="MACHINE",n[n.APPLICATION_MACHINE=3]="APPLICATION_MACHINE",n[n.WINDOW=4]="WINDOW",n[n.RESOURCE=5]="RESOURCE",n[n.LANGUAGE_OVERRIDABLE=6]="LANGUAGE_OVERRIDABLE",n[n.MACHINE_OVERRIDABLE=7]="MACHINE_OVERRIDABLE"})(Ft||(Ft={}));const zl="vscode://schemas/settings/resourceLanguage",up=Cn.as(f_.JSONContribution);class V3{constructor(){this.registeredConfigurationDefaults=[],this.overrideIdentifiers=new Set,this._onDidSchemaChange=new L,this.onDidSchemaChange=this._onDidSchemaChange.event,this._onDidUpdateConfiguration=new L,this.onDidUpdateConfiguration=this._onDidUpdateConfiguration.event,this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:h(1709,"Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},up.registerSchema(zl,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(e,t=!0){return this.registerConfigurations([e],t),e}registerConfigurations(e,t=!0){const i=new Set;this.doRegisterConfigurations(e,t,i),up.registerSchema(zl,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i})}deregisterConfigurations(e){const t=new Set;this.doDeregisterConfigurations(e,t),up.registerSchema(zl,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t})}updateConfigurations({add:e,remove:t}){const i=new Set;this.doDeregisterConfigurations(t,i),this.doRegisterConfigurations(e,!1,i),up.registerSchema(zl,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i})}registerDefaultConfigurations(e){const t=new Set;this.doRegisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doRegisterDefaultConfigurations(e,t){this.registeredConfigurationDefaults.push(...e);const i=[];for(const{overrides:r,source:s}of e)for(const o in r){t.add(o);const a=this.configurationDefaultsOverrides.get(o)??this.configurationDefaultsOverrides.set(o,{configurationDefaultOverrides:[]}).get(o),l=r[o];if(a.configurationDefaultOverrides.push({value:l,source:s}),Br.test(o)){const c=this.mergeDefaultConfigurationsForOverrideIdentifier(o,l,s,a.configurationDefaultOverrideValue);if(!c)continue;a.configurationDefaultOverrideValue=c,this.updateDefaultOverrideProperty(o,c,s),i.push(...mf(o))}else{const c=this.mergeDefaultConfigurationsForConfigurationProperty(o,l,s,a.configurationDefaultOverrideValue);if(!c)continue;a.configurationDefaultOverrideValue=c;const u=this.configurationProperties[o];u&&(this.updatePropertyDefaultValue(o,u),this.updateSchema(o,u))}}this.doRegisterOverrideIdentifiers(i)}deregisterDefaultConfigurations(e){const t=new Set;this.doDeregisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doDeregisterDefaultConfigurations(e,t){for(const i of e){const r=this.registeredConfigurationDefaults.indexOf(i);r!==-1&&this.registeredConfigurationDefaults.splice(r,1)}for(const{overrides:i,source:r}of e)for(const s in i){const o=this.configurationDefaultsOverrides.get(s);if(!o)continue;const a=o.configurationDefaultOverrides.findIndex(l=>{var c;return r?((c=l.source)==null?void 0:c.id)===r.id:l.value===i[s]});if(a!==-1){if(o.configurationDefaultOverrides.splice(a,1),o.configurationDefaultOverrides.length===0&&this.configurationDefaultsOverrides.delete(s),Br.test(s)){let l;for(const c of o.configurationDefaultOverrides)l=this.mergeDefaultConfigurationsForOverrideIdentifier(s,c.value,c.source,l);l&&!dI(l.value)?(o.configurationDefaultOverrideValue=l,this.updateDefaultOverrideProperty(s,l,r)):(this.configurationDefaultsOverrides.delete(s),delete this.configurationProperties[s],delete this.defaultLanguageConfigurationOverridesNode.properties[s])}else{let l;for(const u of o.configurationDefaultOverrides)l=this.mergeDefaultConfigurationsForConfigurationProperty(s,u.value,u.source,l);o.configurationDefaultOverrideValue=l;const c=this.configurationProperties[s];c&&(this.updatePropertyDefaultValue(s,c),this.updateSchema(s,c))}t.add(s)}}this.updateOverridePropertyPatternKey()}updateDefaultOverrideProperty(e,t,i){const r={type:"object",default:t.value,description:h(1710,"Configure settings to be overridden for the {0} language.",H3(e)),$ref:zl,defaultDefaultValue:t.value,source:i,defaultValueSource:i};this.configurationProperties[e]=r,this.defaultLanguageConfigurationOverridesNode.properties[e]=r}mergeDefaultConfigurationsForOverrideIdentifier(e,t,i,r){const s=(r==null?void 0:r.value)||{},o=(r==null?void 0:r.source)??new Map;if(!(o instanceof Map)){console.error("objectConfigurationSources is not a Map");return}for(const a of Object.keys(t)){const l=t[a];if(Zt(l)&&(Ed(s[a])||Zt(s[a]))){if(s[a]={...s[a]??{},...l},i)for(const u in l)o.set(`${a}.${u}`,i)}else s[a]=l,i?o.set(a,i):o.delete(a)}return{value:s,source:o}}mergeDefaultConfigurationsForConfigurationProperty(e,t,i,r){const s=this.configurationProperties[e],o=(r==null?void 0:r.value)??(s==null?void 0:s.defaultDefaultValue);let a=i;if(Zt(t)&&(s!==void 0&&s.type==="object"||s===void 0&&(Ed(o)||Zt(o)))){if(a=(r==null?void 0:r.source)??new Map,!(a instanceof Map)){console.error("defaultValueSource is not a Map");return}for(const c in t)i&&a.set(`${e}.${c}`,i);t={...Zt(o)?o:{},...t}}return{value:t,source:a}}deltaConfiguration(e){let t=!1;const i=new Set;e.removedDefaults&&(this.doDeregisterDefaultConfigurations(e.removedDefaults,i),t=!0),e.addedDefaults&&(this.doRegisterDefaultConfigurations(e.addedDefaults,i),t=!0),e.removedConfigurations&&this.doDeregisterConfigurations(e.removedConfigurations,i),e.addedConfigurations&&this.doRegisterConfigurations(e.addedConfigurations,!1,i),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i,defaultsOverrides:t})}notifyConfigurationSchemaUpdated(...e){this._onDidSchemaChange.fire()}registerOverrideIdentifiers(e){this.doRegisterOverrideIdentifiers(e),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(e){for(const t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,t,i){e.forEach(r=>{this.validateAndRegisterProperties(r,t,r.extensionInfo,r.restrictedProperties,void 0,i),this.configurationContributors.push(r),this.registerJSONConfiguration(r)})}doDeregisterConfigurations(e,t){const i=r=>{var s,o;if(r.properties)for(const a in r.properties){t.add(a);const l=this.configurationProperties[a];(s=l==null?void 0:l.policy)!=null&&s.name&&this.policyConfigurations.delete(l.policy.name),delete this.configurationProperties[a],this.removeFromSchema(a,r.properties[a])}(o=r.allOf)==null||o.forEach(a=>i(a))};for(const r of e){i(r);const s=this.configurationContributors.indexOf(r);s!==-1&&this.configurationContributors.splice(s,1)}}validateAndRegisterProperties(e,t=!0,i,r,s=Ft.WINDOW,o){var c;s=Yt(e.scope)?s:e.scope;const a=e.properties;if(a)for(const u in a){const d=a[u];if(t&&j3(u,d)){delete a[u];continue}d.source=i,d.defaultDefaultValue=a[u].default,this.updatePropertyDefaultValue(u,d),Br.test(u)?d.scope=void 0:(d.scope=Yt(d.scope)?s:d.scope,d.restricted=Yt(d.restricted)?!!(r!=null&&r.includes(u)):d.restricted);const f=a[u].hasOwnProperty("included")&&!a[u].included,p=(c=a[u].policy)==null?void 0:c.name;f?(this.excludedConfigurationProperties[u]=a[u],p&&(this.policyConfigurations.set(p,u),o.add(u)),delete a[u]):(o.add(u),p&&this.policyConfigurations.set(p,u),this.configurationProperties[u]=a[u],!a[u].deprecationMessage&&a[u].markdownDeprecationMessage&&(a[u].deprecationMessage=a[u].markdownDeprecationMessage))}const l=e.allOf;if(l)for(const u of l)this.validateAndRegisterProperties(u,t,i,r,s,o)}getConfigurations(){return this.configurationContributors}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}getExcludedConfigurationProperties(){return this.excludedConfigurationProperties}getRegisteredDefaultConfigurations(){return[...this.registeredConfigurationDefaults]}getConfigurationDefaultsOverrides(){const e=new Map;for(const[t,i]of this.configurationDefaultsOverrides)i.configurationDefaultOverrideValue&&e.set(t,i.configurationDefaultOverrideValue);return e}registerJSONConfiguration(e){const t=i=>{const r=i.properties;if(r)for(const o in r)this.updateSchema(o,r[o]);const s=i.allOf;s==null||s.forEach(t)};t(e)}updateSchema(e,t){switch(t.scope){case Ft.APPLICATION:break;case Ft.MACHINE:break;case Ft.APPLICATION_MACHINE:break;case Ft.MACHINE_OVERRIDABLE:break;case Ft.WINDOW:break;case Ft.RESOURCE:break;case Ft.LANGUAGE_OVERRIDABLE:this.resourceLanguageSettingsSchema.properties[e]=t;break}}removeFromSchema(e,t){switch(t.scope){case Ft.APPLICATION:break;case Ft.MACHINE:break;case Ft.APPLICATION_MACHINE:break;case Ft.MACHINE_OVERRIDABLE:break;case Ft.WINDOW:break;case Ft.RESOURCE:case Ft.LANGUAGE_OVERRIDABLE:delete this.resourceLanguageSettingsSchema.properties[e];break}}updateOverridePropertyPatternKey(){for(const e of this.overrideIdentifiers.values()){const t=`[${e}]`,i={type:"object",description:h(1711,"Configure editor settings to be overridden for a language."),errorMessage:h(1712,"This setting does not support per-language configuration."),$ref:zl};this.updatePropertyDefaultValue(t,i)}}registerOverridePropertyPatternKey(){h(1711,"Configure editor settings to be overridden for a language."),h(1712,"This setting does not support per-language configuration."),this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){var o;const i=(o=this.configurationDefaultsOverrides.get(e))==null?void 0:o.configurationDefaultOverrideValue;let r,s;i&&(!t.disallowConfigurationDefault||!i.source)&&(r=i.value,s=i.source),Ed(r)&&(r=t.defaultDefaultValue,s=void 0),Ed(r)&&(r=q3(t.type)),t.default=r,t.defaultValueSource=s}}const D5="\\[([^\\]]+)\\]",C4=new RegExp(D5,"g"),z3=`^(${D5})+$`,Br=new RegExp(z3);function mf(n){const e=[];if(Br.test(n)){let t=C4.exec(n);for(;t!=null&&t.length;){const i=t[1].trim();i&&e.push(i),t=C4.exec(n)}}return Yl(e)}function q3(n){switch(Array.isArray(n)?n[0]:n){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}const Bp=new V3;Cn.add(Zf.Configuration,Bp);function j3(n,e){var t,i,r,s;return n.trim()?Br.test(n)?h(1714,"Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",n):Bp.getConfigurationProperties()[n]!==void 0?h(1715,"Cannot register '{0}'. This property is already registered.",n):(t=e.policy)!=null&&t.name&&Bp.getPolicyConfigurations().get((i=e.policy)==null?void 0:i.name)!==void 0?h(1716,"Cannot register '{0}'. The associated policy {1} is already registered with {2}.",n,(r=e.policy)==null?void 0:r.name,Bp.getPolicyConfigurations().get((s=e.policy)==null?void 0:s.name)):null:h(1713,"Cannot register an empty property")}function kd(n){return Object.isFrozen(n)?n:QI(n)}class Di{static createEmptyModel(e){return new Di({},[],[],void 0,e)}constructor(e,t,i,r,s){this._contents=e,this._keys=t,this._overrides=i,this.raw=r,this.logService=s,this.overrideConfigurations=new Map}get rawConfiguration(){if(!this._rawConfiguration)if(this.raw){const e=(Array.isArray(this.raw)?this.raw:[this.raw]).map(t=>{if(t instanceof Di)return t;const i=new G3("",this.logService);return i.parseRaw(t),i.configurationModel});this._rawConfiguration=e.reduce((t,i)=>i===t?i:t.merge(i),e[0])}else this._rawConfiguration=this;return this._rawConfiguration}get contents(){return this._contents}get overrides(){return this._overrides}get keys(){return this._keys}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(e){return e?r1(this.contents,e):this.contents}inspect(e,t){const i=this;return{get value(){return kd(i.rawConfiguration.getValue(e))},get override(){return t?kd(i.rawConfiguration.getOverrideValue(e,t)):void 0},get merged(){return kd(t?i.rawConfiguration.override(t).getValue(e):i.rawConfiguration.getValue(e))},get overrides(){const r=[];for(const{contents:s,identifiers:o,keys:a}of i.rawConfiguration.overrides){const l=new Di(s,a,[],void 0,i.logService).getValue(e);l!==void 0&&r.push({identifiers:o,value:l})}return r.length?kd(r):void 0}}}getOverrideValue(e,t){const i=this.getContentsForOverrideIdentifer(t);return i?e?r1(i,e):i:void 0}getKeysForOverrideIdentifier(e){const t=[];for(const i of this.overrides)i.identifiers.includes(e)&&t.push(...i.keys);return Yl(t)}getAllOverrideIdentifiers(){const e=[];for(const t of this.overrides)e.push(...t.identifiers);return Yl(e)}override(e){let t=this.overrideConfigurations.get(e);return t||(t=this.createOverrideConfigurationModel(e),this.overrideConfigurations.set(e,t)),t}merge(...e){const t=_t(this.contents),i=_t(this.overrides),r=[...this.keys],s=this.raw?Array.isArray(this.raw)?[...this.raw]:[this.raw]:[this];for(const o of e)if(s.push(...o.raw?Array.isArray(o.raw)?o.raw:[o.raw]:[o]),!o.isEmpty()){this.mergeContents(t,o.contents);for(const a of o.overrides){const[l]=i.filter(c=>$r(c.identifiers,a.identifiers));l?(this.mergeContents(l.contents,a.contents),l.keys.push(...a.keys),l.keys=Yl(l.keys)):i.push(_t(a))}for(const a of o.keys)r.indexOf(a)===-1&&r.push(a)}return new Di(t,r,i,!s.length||s.every(o=>o instanceof Di)?void 0:s,this.logService)}createOverrideConfigurationModel(e){const t=this.getContentsForOverrideIdentifer(e);if(!t||typeof t!="object"||!Object.keys(t).length)return this;const i={};for(const r of Yl([...Object.keys(this.contents),...Object.keys(t)])){let s=this.contents[r];const o=t[r];o&&(typeof s=="object"&&typeof o=="object"?(s=_t(s),this.mergeContents(s,o)):s=o),i[r]=s}return new Di(i,this.keys,this.overrides,void 0,this.logService)}mergeContents(e,t){for(const i of Object.keys(t)){if(i in e&&Zt(e[i])&&Zt(t[i])){this.mergeContents(e[i],t[i]);continue}e[i]=_t(t[i])}}getContentsForOverrideIdentifer(e){let t=null,i=null;const r=s=>{s&&(i?this.mergeContents(i,s):i=_t(s))};for(const s of this.overrides)s.identifiers.length===1&&s.identifiers[0]===e?t=s.contents:s.identifiers.includes(e)&&r(s.contents);return r(t),i}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}addValue(e,t){this.updateValue(e,t,!0)}setValue(e,t){this.updateValue(e,t,!1)}removeValue(e){const t=this.keys.indexOf(e);t!==-1&&(this.keys.splice(t,1),U3(this.contents,e),Br.test(e)&&this.overrides.splice(this.overrides.findIndex(i=>$r(i.identifiers,mf(e))),1))}updateValue(e,t,i){if(E5(this.contents,e,t,r=>this.logService.error(r)),i=i||this.keys.indexOf(e)===-1,i&&this.keys.push(e),Br.test(e)){const r=mf(e),s={identifiers:r,keys:Object.keys(this.contents[e]),contents:f0(this.contents[e],a=>this.logService.error(a))},o=this.overrides.findIndex(a=>$r(a.identifiers,r));o!==-1?this.overrides[o]=s:this.overrides.push(s)}}}class G3{constructor(e,t){this._name=e,this.logService=t,this._raw=null,this._configurationModel=null,this._restrictedConfigurations=[],this._parseErrors=[]}get configurationModel(){return this._configurationModel||Di.createEmptyModel(this.logService)}get restrictedConfigurations(){return this._restrictedConfigurations}get errors(){return this._parseErrors}parse(e,t){if(!Yt(e)){const i=this.doParseContent(e);this.parseRaw(i,t)}}reparse(e){this._raw&&this.parseRaw(this._raw,e)}parseRaw(e,t){this._raw=e;const{contents:i,keys:r,overrides:s,restricted:o,hasExcludedProperties:a}=this.doParseRaw(e,t);this._configurationModel=new Di(i,r,s,a?[e]:void 0,this.logService),this._restrictedConfigurations=o||[]}doParseContent(e){let t={},i=null,r=[];const s=[];function o(l){Array.isArray(r)?r.push(l):i!==null&&(r[i]=l)}const a={onObjectBegin:()=>{const l={};o(l),s.push(r),r=l,i=null},onObjectProperty:l=>{i=l},onObjectEnd:()=>{r=s.pop()},onArrayBegin:()=>{const l=[];o(l),s.push(r),r=l,i=null},onArrayEnd:()=>{r=s.pop()},onLiteralValue:o,onError:(l,c,u)=>{}};if(e)try{W3(e,a),t=r[0]||{}}catch(l){this.logService.error(`Error while parsing settings file ${this._name}: ${l}`),this._parseErrors=[l]}return t}doParseRaw(e,t){const i=Cn.as(Zf.Configuration).getConfigurationProperties(),r=this.filter(e,i,!0,t);e=r.raw;const s=f0(e,l=>this.logService.error(`Conflict in settings file ${this._name}: ${l}`)),o=Object.keys(e),a=this.toOverrides(e,l=>this.logService.error(`Conflict in settings file ${this._name}: ${l}`));return{contents:s,keys:o,overrides:a,restricted:r.restricted,hasExcludedProperties:r.hasExcludedProperties}}filter(e,t,i,r){var l;let s=!1;if(!(r!=null&&r.scopes)&&!(r!=null&&r.skipRestricted)&&!((l=r==null?void 0:r.exclude)!=null&&l.length))return{raw:e,restricted:[],hasExcludedProperties:s};const o={},a=[];for(const c in e)if(Br.test(c)&&i){const u=this.filter(e[c],t,!1,r);o[c]=u.raw,s=s||u.hasExcludedProperties,a.push(...u.restricted)}else{const u=t[c];u!=null&&u.restricted&&a.push(c),this.shouldInclude(c,u,r)?o[c]=e[c]:s=!0}return{raw:o,restricted:a,hasExcludedProperties:s}}shouldInclude(e,t,i){var s,o;if((s=i.exclude)!=null&&s.includes(e))return!1;if((o=i.include)!=null&&o.includes(e))return!0;if(i.skipRestricted&&(t!=null&&t.restricted)||i.skipUnregistered&&!t)return!1;const r=t?typeof t.scope<"u"?t.scope:Ft.WINDOW:void 0;return r===void 0||i.scopes===void 0?!0:i.scopes.includes(r)}toOverrides(e,t){const i=[];for(const r of Object.keys(e))if(Br.test(r)){const s={};for(const o in e[r])s[o]=e[r][o];i.push({identifiers:mf(r),keys:Object.keys(s),contents:f0(s,t)})}return i}}class Q3{constructor(e,t,i,r,s,o,a,l,c,u,d,f,p){this.key=e,this.overrides=t,this._value=i,this.overrideIdentifiers=r,this.defaultConfiguration=s,this.policyConfiguration=o,this.applicationConfiguration=a,this.userConfiguration=l,this.localUserConfiguration=c,this.remoteUserConfiguration=u,this.workspaceConfiguration=d,this.folderConfigurationModel=f,this.memoryConfigurationModel=p}get value(){return kd(this._value)}toInspectValue(e){return(e==null?void 0:e.value)!==void 0||(e==null?void 0:e.override)!==void 0||(e==null?void 0:e.overrides)!==void 0?e:void 0}get defaultInspectValue(){return this._defaultInspectValue||(this._defaultInspectValue=this.defaultConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._defaultInspectValue}get defaultValue(){return this.defaultInspectValue.merged}get default(){return this.toInspectValue(this.defaultInspectValue)}get policyInspectValue(){return this._policyInspectValue===void 0&&(this._policyInspectValue=this.policyConfiguration?this.policyConfiguration.inspect(this.key):null),this._policyInspectValue}get policyValue(){var e;return(e=this.policyInspectValue)==null?void 0:e.merged}get policy(){var e;return((e=this.policyInspectValue)==null?void 0:e.value)!==void 0?{value:this.policyInspectValue.value}:void 0}get applicationInspectValue(){return this._applicationInspectValue===void 0&&(this._applicationInspectValue=this.applicationConfiguration?this.applicationConfiguration.inspect(this.key):null),this._applicationInspectValue}get applicationValue(){var e;return(e=this.applicationInspectValue)==null?void 0:e.merged}get application(){return this.toInspectValue(this.applicationInspectValue)}get userInspectValue(){return this._userInspectValue||(this._userInspectValue=this.userConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userInspectValue}get userValue(){return this.userInspectValue.merged}get user(){return this.toInspectValue(this.userInspectValue)}get userLocalInspectValue(){return this._userLocalInspectValue||(this._userLocalInspectValue=this.localUserConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userLocalInspectValue}get userLocalValue(){return this.userLocalInspectValue.merged}get userLocal(){return this.toInspectValue(this.userLocalInspectValue)}get userRemoteInspectValue(){return this._userRemoteInspectValue||(this._userRemoteInspectValue=this.remoteUserConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userRemoteInspectValue}get userRemoteValue(){return this.userRemoteInspectValue.merged}get userRemote(){return this.toInspectValue(this.userRemoteInspectValue)}get workspaceInspectValue(){return this._workspaceInspectValue===void 0&&(this._workspaceInspectValue=this.workspaceConfiguration?this.workspaceConfiguration.inspect(this.key,this.overrides.overrideIdentifier):null),this._workspaceInspectValue}get workspaceValue(){var e;return(e=this.workspaceInspectValue)==null?void 0:e.merged}get workspace(){return this.toInspectValue(this.workspaceInspectValue)}get workspaceFolderInspectValue(){return this._workspaceFolderInspectValue===void 0&&(this._workspaceFolderInspectValue=this.folderConfigurationModel?this.folderConfigurationModel.inspect(this.key,this.overrides.overrideIdentifier):null),this._workspaceFolderInspectValue}get workspaceFolderValue(){var e;return(e=this.workspaceFolderInspectValue)==null?void 0:e.merged}get workspaceFolder(){return this.toInspectValue(this.workspaceFolderInspectValue)}get memoryInspectValue(){return this._memoryInspectValue===void 0&&(this._memoryInspectValue=this.memoryConfigurationModel.inspect(this.key,this.overrides.overrideIdentifier)),this._memoryInspectValue}get memoryValue(){return this.memoryInspectValue.merged}get memory(){return this.toInspectValue(this.memoryInspectValue)}}let g0=class k5{constructor(e,t,i,r,s,o,a,l,c,u){this._defaultConfiguration=e,this._policyConfiguration=t,this._applicationConfiguration=i,this._localUserConfiguration=r,this._remoteUserConfiguration=s,this._workspaceConfiguration=o,this._folderConfigurations=a,this._memoryConfiguration=l,this._memoryConfigurationByResource=c,this.logService=u,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new on,this._userConfiguration=null}getValue(e,t,i){return this.getConsolidatedConfigurationModel(e,t,i).getValue(e)}updateValue(e,t,i={}){let r;i.resource?(r=this._memoryConfigurationByResource.get(i.resource),r||(r=Di.createEmptyModel(this.logService),this._memoryConfigurationByResource.set(i.resource,r))):r=this._memoryConfiguration,t===void 0?r.removeValue(e):r.setValue(e,t),i.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(e,t,i){const r=this.getConsolidatedConfigurationModel(e,t,i),s=this.getFolderConfigurationModelForResource(t.resource,i),o=t.resource?this._memoryConfigurationByResource.get(t.resource)||this._memoryConfiguration:this._memoryConfiguration,a=new Set;for(const l of r.overrides)for(const c of l.identifiers)r.getOverrideValue(e,c)!==void 0&&a.add(c);return new Q3(e,t,r.getValue(e),a.size?[...a]:void 0,this._defaultConfiguration,this._policyConfiguration.isEmpty()?void 0:this._policyConfiguration,this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration,this.userConfiguration,this.localUserConfiguration,this.remoteUserConfiguration,i?this._workspaceConfiguration:void 0,s||void 0,o)}keys(e){const t=this.getFolderConfigurationModelForResource(void 0,e);return{default:this._defaultConfiguration.keys.slice(0),user:this.userConfiguration.keys.slice(0),workspace:this._workspaceConfiguration.keys.slice(0),workspaceFolder:t?t.keys.slice(0):[]}}updateDefaultConfiguration(e){this._defaultConfiguration=e,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updatePolicyConfiguration(e){this._policyConfiguration=e}updateApplicationConfiguration(e){this._applicationConfiguration=e,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateLocalUserConfiguration(e){this._localUserConfiguration=e,this._userConfiguration=null,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateRemoteUserConfiguration(e){this._remoteUserConfiguration=e,this._userConfiguration=null,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateWorkspaceConfiguration(e){this._workspaceConfiguration=e,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateFolderConfiguration(e,t){this._folderConfigurations.set(e,t),this._foldersConsolidatedConfigurations.delete(e)}deleteFolderConfiguration(e){this.folderConfigurations.delete(e),this._foldersConsolidatedConfigurations.delete(e)}compareAndUpdateDefaultConfiguration(e,t){const i=[];if(!t){const{added:r,updated:s,removed:o}=js(this._defaultConfiguration,e);t=[...r,...s,...o]}for(const r of t)for(const s of mf(r)){const o=this._defaultConfiguration.getKeysForOverrideIdentifier(s),a=e.getKeysForOverrideIdentifier(s),l=[...a.filter(c=>o.indexOf(c)===-1),...o.filter(c=>a.indexOf(c)===-1),...o.filter(c=>!fi(this._defaultConfiguration.override(s).getValue(c),e.override(s).getValue(c)))];i.push([s,l])}return this.updateDefaultConfiguration(e),{keys:t,overrides:i}}compareAndUpdatePolicyConfiguration(e){const{added:t,updated:i,removed:r}=js(this._policyConfiguration,e),s=[...t,...i,...r];return s.length&&this.updatePolicyConfiguration(e),{keys:s,overrides:[]}}compareAndUpdateApplicationConfiguration(e){const{added:t,updated:i,removed:r,overrides:s}=js(this.applicationConfiguration,e),o=[...t,...i,...r];return o.length&&this.updateApplicationConfiguration(e),{keys:o,overrides:s}}compareAndUpdateLocalUserConfiguration(e){const{added:t,updated:i,removed:r,overrides:s}=js(this.localUserConfiguration,e),o=[...t,...i,...r];return o.length&&this.updateLocalUserConfiguration(e),{keys:o,overrides:s}}compareAndUpdateRemoteUserConfiguration(e){const{added:t,updated:i,removed:r,overrides:s}=js(this.remoteUserConfiguration,e),o=[...t,...i,...r];return o.length&&this.updateRemoteUserConfiguration(e),{keys:o,overrides:s}}compareAndUpdateWorkspaceConfiguration(e){const{added:t,updated:i,removed:r,overrides:s}=js(this.workspaceConfiguration,e),o=[...t,...i,...r];return o.length&&this.updateWorkspaceConfiguration(e),{keys:o,overrides:s}}compareAndUpdateFolderConfiguration(e,t){const i=this.folderConfigurations.get(e),{added:r,updated:s,removed:o,overrides:a}=js(i,t),l=[...r,...s,...o];return(l.length||!i)&&this.updateFolderConfiguration(e,t),{keys:l,overrides:a}}compareAndDeleteFolderConfiguration(e){const t=this.folderConfigurations.get(e);if(!t)throw new Error("Unknown folder");this.deleteFolderConfiguration(e);const{added:i,updated:r,removed:s,overrides:o}=js(t,void 0);return{keys:[...i,...r,...s],overrides:o}}get defaults(){return this._defaultConfiguration}get applicationConfiguration(){return this._applicationConfiguration}get userConfiguration(){if(!this._userConfiguration)if(this._remoteUserConfiguration.isEmpty())this._userConfiguration=this._localUserConfiguration;else{const e=this._localUserConfiguration.merge(this._remoteUserConfiguration);this._userConfiguration=new Di(e.contents,e.keys,e.overrides,void 0,this.logService)}return this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}get workspaceConfiguration(){return this._workspaceConfiguration}get folderConfigurations(){return this._folderConfigurations}getConsolidatedConfigurationModel(e,t,i){let r=this.getConsolidatedConfigurationModelForResource(t,i);if(t.overrideIdentifier&&(r=r.override(t.overrideIdentifier)),!this._policyConfiguration.isEmpty()&&this._policyConfiguration.getValue(e)!==void 0){r=r.merge();for(const s of this._policyConfiguration.keys)r.setValue(s,this._policyConfiguration.getValue(s))}return r}getConsolidatedConfigurationModelForResource({resource:e},t){let i=this.getWorkspaceConsolidatedConfiguration();if(t&&e){const r=t.getFolder(e);r&&(i=this.getFolderConsolidatedConfiguration(r.uri)||i);const s=this._memoryConfigurationByResource.get(e);s&&(i=i.merge(s))}return i}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.applicationConfiguration,this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration)),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(e){let t=this._foldersConsolidatedConfigurations.get(e);if(!t){const i=this.getWorkspaceConsolidatedConfiguration(),r=this._folderConfigurations.get(e);r?(t=i.merge(r),this._foldersConsolidatedConfigurations.set(e,t)):t=i}return t}getFolderConfigurationModelForResource(e,t){if(t&&e){const i=t.getFolder(e);if(i)return this._folderConfigurations.get(i.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},policy:{contents:this._policyConfiguration.contents,overrides:this._policyConfiguration.overrides,keys:this._policyConfiguration.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys,raw:Array.isArray(this.applicationConfiguration.raw)?void 0:this.applicationConfiguration.raw},userLocal:{contents:this.localUserConfiguration.contents,overrides:this.localUserConfiguration.overrides,keys:this.localUserConfiguration.keys,raw:Array.isArray(this.localUserConfiguration.raw)?void 0:this.localUserConfiguration.raw},userRemote:{contents:this.remoteUserConfiguration.contents,overrides:this.remoteUserConfiguration.overrides,keys:this.remoteUserConfiguration.keys,raw:Array.isArray(this.remoteUserConfiguration.raw)?void 0:this.remoteUserConfiguration.raw},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((e,t)=>{const{contents:i,overrides:r,keys:s}=this._folderConfigurations.get(t);return e.push([t,{contents:i,overrides:r,keys:s}]),e},[])}}allKeys(){const e=new Set;return this._defaultConfiguration.keys.forEach(t=>e.add(t)),this.userConfiguration.keys.forEach(t=>e.add(t)),this._workspaceConfiguration.keys.forEach(t=>e.add(t)),this._folderConfigurations.forEach(t=>t.keys.forEach(i=>e.add(i))),[...e.values()]}allOverrideIdentifiers(){const e=new Set;return this._defaultConfiguration.getAllOverrideIdentifiers().forEach(t=>e.add(t)),this.userConfiguration.getAllOverrideIdentifiers().forEach(t=>e.add(t)),this._workspaceConfiguration.getAllOverrideIdentifiers().forEach(t=>e.add(t)),this._folderConfigurations.forEach(t=>t.getAllOverrideIdentifiers().forEach(i=>e.add(i))),[...e.values()]}getAllKeysForOverrideIdentifier(e){const t=new Set;return this._defaultConfiguration.getKeysForOverrideIdentifier(e).forEach(i=>t.add(i)),this.userConfiguration.getKeysForOverrideIdentifier(e).forEach(i=>t.add(i)),this._workspaceConfiguration.getKeysForOverrideIdentifier(e).forEach(i=>t.add(i)),this._folderConfigurations.forEach(i=>i.getKeysForOverrideIdentifier(e).forEach(r=>t.add(r))),[...t.values()]}static parse(e,t){const i=this.parseConfigurationModel(e.defaults,t),r=this.parseConfigurationModel(e.policy,t),s=this.parseConfigurationModel(e.application,t),o=this.parseConfigurationModel(e.userLocal,t),a=this.parseConfigurationModel(e.userRemote,t),l=this.parseConfigurationModel(e.workspace,t),c=e.folders.reduce((u,d)=>(u.set(y.revive(d[0]),this.parseConfigurationModel(d[1],t)),u),new on);return new k5(i,r,s,o,a,l,c,Di.createEmptyModel(t),new on,t)}static parseConfigurationModel(e,t){return new Di(e.contents,e.keys,e.overrides,e.raw,t)}};class J3{constructor(e,t,i,r,s){this.change=e,this.previous=t,this.currentConfiguraiton=i,this.currentWorkspace=r,this.logService=s,this._marker=`
`,this._markerCode1=this._marker.charCodeAt(0),this._markerCode2=46,this.affectedKeys=new Set,this._previousConfiguration=void 0;for(const o of e.keys)this.affectedKeys.add(o);for(const[,o]of e.overrides)for(const a of o)this.affectedKeys.add(a);this._affectsConfigStr=this._marker;for(const o of this.affectedKeys)this._affectsConfigStr+=o+this._marker}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=g0.parse(this.previous.data,this.logService)),this._previousConfiguration}affectsConfiguration(e,t){var a;const i=this._marker+e,r=this._affectsConfigStr.indexOf(i);if(r<0)return!1;const s=r+i.length;if(s>=this._affectsConfigStr.length)return!1;const o=this._affectsConfigStr.charCodeAt(s);if(o!==this._markerCode1&&o!==this._markerCode2)return!1;if(t){const l=this.previousConfiguration?this.previousConfiguration.getValue(e,t,(a=this.previous)==null?void 0:a.workspace):void 0,c=this.currentConfiguraiton.getValue(e,t,this.currentWorkspace);return!fi(l,c)}return!0}}function js(n,e){const{added:t,removed:i,updated:r}=P4(e==null?void 0:e.rawConfiguration,n==null?void 0:n.rawConfiguration),s=[],o=(n==null?void 0:n.getAllOverrideIdentifiers())||[],a=(e==null?void 0:e.getAllOverrideIdentifiers())||[];if(e){const l=a.filter(c=>!o.includes(c));for(const c of l)s.push([c,e.getKeysForOverrideIdentifier(c)])}if(n){const l=o.filter(c=>!a.includes(c));for(const c of l)s.push([c,n.getKeysForOverrideIdentifier(c)])}if(e&&n){for(const l of o)if(a.includes(l)){const c=P4({contents:n.getOverrideValue(void 0,l)||{},keys:n.getKeysForOverrideIdentifier(l)},{contents:e.getOverrideValue(void 0,l)||{},keys:e.getKeysForOverrideIdentifier(l)});s.push([l,[...c.added,...c.removed,...c.updated]])}}return{added:t,removed:i,updated:r,overrides:s}}function P4(n,e){const t=n?e?n.keys.filter(s=>e.keys.indexOf(s)===-1):[...n.keys]:[],i=e?n?e.keys.filter(s=>n.keys.indexOf(s)===-1):[...e.keys]:[],r=[];if(n&&e){for(const s of e.keys)if(n.keys.indexOf(s)!==-1){const o=r1(e.contents,s),a=r1(n.contents,s);fi(o,a)||r.push(s)}}return{added:t,removed:i,updated:r}}function dp(n,e){if(e){const t=e.split(".");let i=n;for(let r=0;i&&r<t.length;r++)i=i[t[r]];return i}}function X3(n){return n instanceof y}function Y3(n){return n&&n.uri instanceof y&&n.languageId&&typeof n.languageId=="string"}function Z3(n){return n&&!n.uri&&n.languageId&&typeof n.languageId=="string"}function K3(n){return n&&n.uri instanceof y&&(!n.name||typeof n.name=="string")&&(!n.index||typeof n.index=="number")}function T4(n){if(X3(n))return{resource:n};if(Y3(n))return{resource:n.uri,overrideIdentifier:n.languageId};if(Z3(n))return{overrideIdentifier:n.languageId};if(K3(n))return{resource:n.uri};if(n===null)return{resource:null}}let m0=class{constructor(e,t,i){this._proxy=e.getProxy(Z.MainThreadConfiguration),this._extHostWorkspace=t,this._logService=i,this._barrier=new Nr,this._actual=null}getConfigProvider(){return this._barrier.wait().then(e=>this._actual)}$initializeConfiguration(e){this._actual=new e6(this._proxy,this._extHostWorkspace,e,this._logService),this._barrier.open()}$acceptConfigurationChanged(e,t){this.getConfigProvider().then(i=>i.$acceptConfigurationChanged(e,t))}};m0=V([F(0,tt),F(1,Hs),F(2,ct)],m0);class e6{constructor(e,t,i,r){this._onDidChangeConfiguration=new L,this._proxy=e,this._logService=r,this._extHostWorkspace=t,this._configuration=g0.parse(i,r),this._configurationScopes=this._toMap(i.configurationScopes)}get onDidChangeConfiguration(){return this._onDidChangeConfiguration&&this._onDidChangeConfiguration.event}$acceptConfigurationChanged(e,t){const i={data:this._configuration.toData(),workspace:this._extHostWorkspace.workspace};this._configuration=g0.parse(e,this._logService),this._configurationScopes=this._toMap(e.configurationScopes),this._onDidChangeConfiguration.fire(this._toConfigurationChangeEvent(t,i))}getConfiguration(e,t,i){const r=T4(t)||{},s=this._toReadonlyValue(this._configuration.getValue(e,r,this._extHostWorkspace.workspace));e&&this._validateConfigurationAccess(e,r,i==null?void 0:i.identifier);function o(l){if(l==null)return null;if(typeof l=="boolean")return l?dn.USER:dn.WORKSPACE;switch(l){case Rc.Global:return dn.USER;case Rc.Workspace:return dn.WORKSPACE;case Rc.WorkspaceFolder:return dn.WORKSPACE_FOLDER}}const a={has(l){return typeof dp(s,l)<"u"},get:(l,c)=>{this._validateConfigurationAccess(e?`${e}.${l}`:l,r,i==null?void 0:i.identifier);let u=dp(s,l);if(typeof u>"u")u=c;else{let d;const f=(p,w)=>{if(Zt(p)){let v;const m=()=>{d=d||_t(s),v=v||dp(d,w)};return new Proxy(p,{get:(x,k)=>{if(typeof k=="string"&&k.toLowerCase()==="tojson")return m(),()=>v;if(d)return v=v||dp(d,w),v[k];const D=x[k];return typeof k=="string"?f(D,`${w}.${k}`):D},set:(x,k,D)=>(m(),v&&(v[k]=D),!0),deleteProperty:(x,k)=>(m(),v&&delete v[k],!0),defineProperty:(x,k,D)=>(m(),v&&Object.defineProperty(v,k,D),!0)})}return Array.isArray(p)?_t(p):p};u=f(u,l)}return u},update:(l,c,u,d)=>{l=e?`${e}.${l}`:l;const f=o(u);return c!==void 0?this._proxy.$updateConfigurationOption(f,l,c,r,d):this._proxy.$removeConfigurationOption(f,l,r,d)},inspect:l=>{var u,d,f,p,w,v,m,x,k,D,B,T,z,K,Ee;l=e?`${e}.${l}`:l;const c=this._configuration.inspect(l,r,this._extHostWorkspace.workspace);if(c)return{key:l,defaultValue:_t(((u=c.policy)==null?void 0:u.value)??((d=c.default)==null?void 0:d.value)),globalLocalValue:_t((f=c.userLocal)==null?void 0:f.value),globalRemoteValue:_t((p=c.userRemote)==null?void 0:p.value),globalValue:_t(((w=c.user)==null?void 0:w.value)??((v=c.application)==null?void 0:v.value)),workspaceValue:_t((m=c.workspace)==null?void 0:m.value),workspaceFolderValue:_t((x=c.workspaceFolder)==null?void 0:x.value),defaultLanguageValue:_t((k=c.default)==null?void 0:k.override),globalLocalLanguageValue:_t((D=c.userLocal)==null?void 0:D.override),globalRemoteLanguageValue:_t((B=c.userRemote)==null?void 0:B.override),globalLanguageValue:_t(((T=c.user)==null?void 0:T.override)??((z=c.application)==null?void 0:z.override)),workspaceLanguageValue:_t((K=c.workspace)==null?void 0:K.override),workspaceFolderLanguageValue:_t((Ee=c.workspaceFolder)==null?void 0:Ee.override),languageIds:_t(c.overrideIdentifiers)}}};return typeof s=="object"&&gl(a,s,!1),Object.freeze(a)}_toReadonlyValue(e){const t=i=>Zt(i)?new Proxy(i,{get:(r,s)=>t(r[s]),set:(r,s,o)=>{throw new Error(`TypeError: Cannot assign to read only property '${String(s)}' of object`)},deleteProperty:(r,s)=>{throw new Error(`TypeError: Cannot delete read only property '${String(s)}' of object`)},defineProperty:(r,s)=>{throw new Error(`TypeError: Cannot define property '${String(s)}' for a readonly object`)},setPrototypeOf:r=>{throw new Error("TypeError: Cannot set prototype for a readonly object")},isExtensible:()=>!1,preventExtensions:()=>!0}):i;return t(e)}_validateConfigurationAccess(e,t,i){const r=Br.test(e)?Ft.RESOURCE:this._configurationScopes.get(e),s=i?`[${i.value}] `:"";if(Ft.RESOURCE===r){typeof(t==null?void 0:t.resource)>"u"&&this._logService.warn(`${s}Accessing a resource scoped configuration without providing a resource is not expected. To get the effective value for '${e}', provide the URI of a resource or 'null' for any resource.`);return}if(Ft.WINDOW===r){t!=null&&t.resource&&this._logService.warn(`${s}Accessing a window scoped configuration for a resource is not expected. To associate '${e}' to a resource, define its scope to 'resource' in configuration contributions in 'package.json'.`);return}}_toConfigurationChangeEvent(e,t){const i=new J3(e,t,this._configuration,this._extHostWorkspace.workspace,this._logService);return Object.freeze({affectsConfiguration:(r,s)=>i.affectsConfiguration(r,T4(s))})}_toMap(e){return e.reduce((t,i)=>(t.set(i[0],i[1]),t),new Map)}}const Bs=De("IExtHostConfiguration");class t6{constructor(e,t){this.versionId=e,this.removedDueToLooping=t}}class nl{static isHostExtension(e,t,i){if(t.getExtensionDescription(e))return!1;const r=i.getExtensionDescription(e);return r?!!((r.main||r.browser)&&r.api==="none"):!1}constructor(e,t){this._activationEventsReader=e,this._onDidChange=new L,this.onDidChange=this._onDidChange.event,this._versionId=0,this._extensionDescriptions=t,this._initialize()}_initialize(){this._extensionDescriptions.sort(i6),this._extensionsMap=new Ms,this._extensionsArr=[],this._activationMap=new Map;for(const e of this._extensionDescriptions){if(this._extensionsMap.has(e.identifier)){console.error("Extension `"+e.identifier.value+"` is already registered");continue}this._extensionsMap.set(e.identifier,e),this._extensionsArr.push(e);const t=this._activationEventsReader.readActivationEvents(e);for(const i of t)this._activationMap.has(i)||this._activationMap.set(i,[]),this._activationMap.get(i).push(e)}}set(e){return this._extensionDescriptions=e,this._initialize(),this._versionId++,this._onDidChange.fire(void 0),{versionId:this._versionId}}deltaExtensions(e,t){this._extensionDescriptions=A4(this._extensionDescriptions,t),this._extensionDescriptions=this._extensionDescriptions.concat(e);const i=nl._findLoopingExtensions(this._extensionDescriptions);return this._extensionDescriptions=A4(this._extensionDescriptions,i.map(r=>r.identifier)),this._initialize(),this._versionId++,this._onDidChange.fire(void 0),new t6(this._versionId,i)}static _findLoopingExtensions(e){const t=new class{constructor(){this._arcs=new Map,this._nodesSet=new Set,this._nodesArr=[]}addNode(a){this._nodesSet.has(a)||(this._nodesSet.add(a),this._nodesArr.push(a))}addArc(a,l){this.addNode(a),this.addNode(l),this._arcs.has(a)?this._arcs.get(a).push(l):this._arcs.set(a,[l])}getArcs(a){return this._arcs.has(a)?this._arcs.get(a):[]}hasOnlyGoodArcs(a,l){const c=t.getArcs(a);for(let u=0;u<c.length;u++)if(!l.has(c[u]))return!1;return!0}getNodes(){return this._nodesArr}},i=new Ms;for(const a of e)if(i.set(a.identifier,a),a.extensionDependencies)for(const l of a.extensionDependencies)t.addArc(Ke.toKey(a.identifier),Ke.toKey(l));const r=new Set;t.getNodes().filter(a=>t.getArcs(a).length===0).forEach(a=>r.add(a));const s=t.getNodes().filter(a=>!r.has(a));let o;do{o=!1;for(let a=0;a<s.length;a++){const l=s[a];t.hasOnlyGoodArcs(l,r)&&(s.splice(a,1),a--,r.add(l),o=!0)}}while(o);return s.map(a=>i.get(a))}containsActivationEvent(e){return this._activationMap.has(e)}containsExtension(e){return this._extensionsMap.has(e)}getExtensionDescriptionsForActivationEvent(e){const t=this._activationMap.get(e);return t?t.slice(0):[]}getAllExtensionDescriptions(){return this._extensionsArr.slice(0)}getSnapshot(){return new n6(this._versionId,this.getAllExtensionDescriptions())}getExtensionDescription(e){const t=this._extensionsMap.get(e);return t||void 0}getExtensionDescriptionByUUID(e){for(const t of this._extensionsArr)if(t.uuid===e)return t}getExtensionDescriptionByIdOrUUID(e,t){return this.getExtensionDescription(e)??(t?this.getExtensionDescriptionByUUID(t):void 0)}}class n6{constructor(e,t){this.versionId=e,this.extensions=t}}var Zs;(function(n){n[n.Builtin=0]="Builtin",n[n.User=1]="User",n[n.Dev=2]="Dev"})(Zs||(Zs={}));function i6(n,e){const t=n.isBuiltin?Zs.Builtin:n.isUnderDevelopment?Zs.Dev:Zs.User,i=e.isBuiltin?Zs.Builtin:e.isUnderDevelopment?Zs.Dev:Zs.User;if(t!==i)return t-i;const r=ot.basename(n.extensionLocation.path),s=ot.basename(e.extensionLocation.path);return r<s?-1:r>s?1:0}function A4(n,e){const t=new Dl(e);return n.filter(i=>!t.has(i.identifier))}const L1=class L1{constructor(e,t,i,r){this.startup=e,this.codeLoadingTime=t,this.activateCallTime=i,this.activateResolvedTime=r}};L1.NONE=new L1(!1,-1,-1,-1);let Vu=L1;class R4{constructor(e){this._startup=e,this._codeLoadingStart=-1,this._codeLoadingStop=-1,this._activateCallStart=-1,this._activateCallStop=-1,this._activateResolveStart=-1,this._activateResolveStop=-1}_delta(e,t){return e===-1||t===-1?-1:t-e}build(){return new Vu(this._startup,this._delta(this._codeLoadingStart,this._codeLoadingStop),this._delta(this._activateCallStart,this._activateCallStop),this._delta(this._activateResolveStart,this._activateResolveStop))}codeLoadingStart(){this._codeLoadingStart=Date.now()}codeLoadingStop(){this._codeLoadingStop=Date.now()}activateCallStart(){this._activateCallStart=Date.now()}activateCallStop(){this._activateCallStop=Date.now()}activateResolveStart(){this._activateResolveStart=Date.now()}activateResolveStop(){this._activateResolveStop=Date.now()}}class E_{constructor(e,t,i,r,s,o){this.activationFailed=e,this.activationFailedError=t,this.activationTimes=i,this.module=r,this.exports=s,this.disposable=o}}class r6 extends E_{constructor(e){super(!1,null,e,{activate:void 0,deactivate:void 0},void 0,Te.None)}}class s6 extends E_{constructor(){super(!1,null,Vu.NONE,{activate:void 0,deactivate:void 0},void 0,Te.None)}}class s1 extends E_{constructor(e){super(!0,e,Vu.NONE,{activate:void 0,deactivate:void 0},void 0,Te.None)}}let _0=class{constructor(e,t,i,r){this._logService=r,this._registry=e,this._globalRegistry=t,this._host=i,this._operations=new Ms,this._alreadyActivatedEvents=Object.create(null)}dispose(){for(const[e,t]of this._operations)t.dispose()}async waitForActivatingExtensions(){const e=[];for(const[t,i]of this._operations)e.push(i.wait());await Promise.all(e)}isActivated(e){const t=this._operations.get(e);return!!(t&&t.value)}getActivatedExtension(e){const t=this._operations.get(e);if(!t||!t.value)throw new Error(`Extension '${e.value}' is not known or not activated`);return t.value}async activateByEvent(e,t){if(this._alreadyActivatedEvents[e])return;const i=this._registry.getExtensionDescriptionsForActivationEvent(e);await this._activateExtensions(i.map(r=>({id:r.identifier,reason:{startup:t,extensionId:r.identifier,activationEvent:e}}))),this._alreadyActivatedEvents[e]=!0}activateById(e,t){const i=this._registry.getExtensionDescription(e);if(!i)throw new Error(`Extension '${e.value}' is not known`);return this._activateExtensions([{id:i.identifier,reason:t}])}async _activateExtensions(e){const t=e.filter(i=>!this.isActivated(i.id)).map(i=>this._handleActivationRequest(i));await Promise.all(t.map(i=>i.wait()))}_handleActivationRequest(e){if(this._operations.has(e.id))return this._operations.get(e.id);if(this._isHostExtension(e.id))return this._createAndSaveOperation(e,null,[],null);const t=this._registry.getExtensionDescription(e.id);if(!t){const s=new Error(`Cannot activate unknown extension '${e.id.value}'`),o=this._createAndSaveOperation(e,null,[],new s1(s));return this._host.onExtensionActivationError(e.id,s,new DS(e.id.value)),o}const i=[],r=typeof t.extensionDependencies>"u"?[]:t.extensionDependencies;for(const s of r){if(this._isResolvedExtension(s))continue;const o=this._operations.get(s);if(o){i.push(o);continue}if(this._isHostExtension(s)){i.push(this._handleActivationRequest({id:this._globalRegistry.getExtensionDescription(s).identifier,reason:e.reason}));continue}const a=this._registry.getExtensionDescription(s);if(a){if(!a.main&&!a.browser)continue;i.push(this._handleActivationRequest({id:a.identifier,reason:e.reason}));continue}const l=t.displayName||t.identifier.value,c=new Error(`Cannot activate the '${l}' extension because it depends on unknown extension '${s}'`),u=this._createAndSaveOperation(e,t.displayName,[],new s1(c));return this._host.onExtensionActivationError(t.identifier,c,new DS(s)),u}return this._createAndSaveOperation(e,t.displayName,i,null)}_createAndSaveOperation(e,t,i,r){const s=new v0(e.id,t,e.reason,i,r,this._host,this._logService);return this._operations.set(e.id,s),s}_isHostExtension(e){return nl.isHostExtension(e,this._registry,this._globalRegistry)}_isResolvedExtension(e){const t=this._globalRegistry.getExtensionDescription(e);return t?!t.main&&!t.browser:!1}};_0=V([F(3,ct)],_0);let v0=class{get value(){return this._value}get friendlyName(){return this._displayName||this._id.value}constructor(e,t,i,r,s,o,a){this._id=e,this._displayName=t,this._reason=i,this._deps=r,this._value=s,this._host=o,this._logService=a,this._barrier=new Nr,this._isDisposed=!1,this._initialize()}dispose(){this._isDisposed=!0}wait(){return this._barrier.wait()}async _initialize(){await this._waitForDepsThenActivate(),this._barrier.open()}async _waitForDepsThenActivate(){if(!this._value){for(;this._deps.length>0;){for(let e=0;e<this._deps.length;e++){const t=this._deps[e];if(t.value&&!t.value.activationFailed){this._deps.splice(e,1),e--;continue}if(t.value&&t.value.activationFailed){const i=new Error(`Cannot activate the '${this.friendlyName}' extension because its dependency '${t.friendlyName}' failed to activate`);i.detail=t.value.activationFailedError,this._value=new s1(i),this._host.onExtensionActivationError(this._id,i,null);return}}this._deps.length>0&&await Promise.race(this._deps.map(e=>e.wait()))}await this._activate()}}async _activate(){try{this._value=await this._host.actualActivateExtension(this._id,this._reason)}catch(e){const t=new Error;if(e&&e.name&&(t.name=e.name),e&&e.message?t.message=`Activating extension '${this._id.value}' failed: ${e.message}.`:t.message=`Activating extension '${this._id.value}' failed: ${e}.`,e&&e.stack&&(t.stack=e.stack),this._value=new s1(t),this._isDisposed&&dl(e))return;this._host.onExtensionActivationError(this._id,t,null),this._logService.error(`Activating extension ${this._id.value} failed due to an error:`),this._logService.error(e)}}};v0=V([F(6,ct)],v0);class I5{constructor(e,t){this._logService=t,this._onDidChangeStorage=new L,this.onDidChangeStorage=this._onDidChangeStorage.event,this._proxy=e.getProxy(Z.MainThreadStorage)}registerExtensionStorageKeysToSync(e,t){this._proxy.$registerExtensionStorageKeysToSync(e,t)}async initializeExtensionStorage(e,t,i){const r=await this._proxy.$initializeExtensionStorage(e,t);let s;return r&&(s=this.safeParseValue(e,t,r)),s||i}setValue(e,t,i){return this._proxy.$setValue(e,t,i)}$acceptValue(e,t,i){const r=this.safeParseValue(e,t,i);r&&this._onDidChangeStorage.fire({shared:e,key:t,value:r})}safeParseValue(e,t,i){try{return JSON.parse(i)}catch(r){this._logService.error(`[extHostStorage] unexpected error parsing storage contents (extensionId: ${t}, global: ${e}): ${r}`)}}}const Qx=De("IExtHostStorage");class C5{constructor(e,t,i){this._deferredPromises=new Map,this._id=e,this._shared=t,this._storage=i,this._init=this._storage.initializeExtensionStorage(this._shared,this._id,Object.create(null)).then(r=>(this._value=r,this)),this._storageListener=this._storage.onDidChangeStorage(r=>{r.shared===this._shared&&r.key===this._id&&(this._value=r.value)}),this._scheduler=new Gu(()=>{const r=this._deferredPromises;this._deferredPromises=new Map,(async()=>{try{await this._storage.setValue(this._shared,this._id,this._value);for(const s of r.values())s.complete()}catch(s){for(const o of r.values())o.error(s)}})()},0)}keys(){return Object.entries(this._value??{}).filter(([,e])=>e!==void 0).map(([e])=>e)}get whenReady(){return this._init}get(e,t){let i=this._value[e];return typeof i>"u"&&(i=t),i}update(e,t){t!==null&&typeof t=="object"?this._value[e]=JSON.parse(JSON.stringify(t)):this._value[e]=t;const i=this._deferredPromises.get(e);if(i!==void 0)return i.p;const r=new Sl;return this._deferredPromises.set(e,r),this._scheduler.isScheduled()||this._scheduler.schedule(),r.p}dispose(){this._storageListener.dispose()}}class o6 extends C5{setKeysForSync(e){this._storage.registerExtensionStorageKeysToSync({id:this._id,version:this._extension.version},e)}constructor(e,t){super(e.identifier.value,!0,t),this._extension=e}}var yr;let w0=yr=class{constructor(e,t){this._fileSystemProvider=new Map,this._writeQueue=new z9,this._proxy=e.getProxy(Z.MainThreadFileSystem);const i=this;this.value=Object.freeze({async stat(r){try{let s;const o=i._fileSystemProvider.get(r.scheme);return o?(await i._proxy.$ensureActivation(r.scheme),s=await o.impl.stat(r)):s=await i._proxy.$stat(r),{type:s.type,ctime:s.ctime,mtime:s.mtime,size:s.size,permissions:s.permissions===gu.Readonly?1:void 0}}catch(s){yr._handleError(s)}},async readDirectory(r){try{const s=i._fileSystemProvider.get(r.scheme);return s?(await i._proxy.$ensureActivation(r.scheme),(await s.impl.readDirectory(r)).slice()):await i._proxy.$readdir(r)}catch(s){return yr._handleError(s)}},async createDirectory(r){try{const s=i._fileSystemProvider.get(r.scheme);return s&&!s.isReadonly?(await i._proxy.$ensureActivation(r.scheme),await i.mkdirp(s.impl,s.extUri,r)):await i._proxy.$mkdir(r)}catch(s){return yr._handleError(s)}},async readFile(r){try{const s=i._fileSystemProvider.get(r.scheme);return s?(await i._proxy.$ensureActivation(r.scheme),(await s.impl.readFile(r)).slice()):(await i._proxy.$readFile(r)).buffer}catch(s){return yr._handleError(s)}},async writeFile(r,s){try{const o=i._fileSystemProvider.get(r.scheme);return o&&!o.isReadonly?(await i._proxy.$ensureActivation(r.scheme),await i.mkdirp(o.impl,o.extUri,o.extUri.dirname(r)),await i._writeQueue.queueFor(r,()=>Promise.resolve(o.impl.writeFile(r,s,{create:!0,overwrite:!0})))):await i._proxy.$writeFile(r,Pe.wrap(s))}catch(o){return yr._handleError(o)}},async delete(r,s){try{const o=i._fileSystemProvider.get(r.scheme);return o&&!o.isReadonly&&!(s!=null&&s.useTrash)?(await i._proxy.$ensureActivation(r.scheme),await o.impl.delete(r,{recursive:!1,...s})):await i._proxy.$delete(r,{recursive:!1,useTrash:!1,atomic:!1,...s})}catch(o){return yr._handleError(o)}},async rename(r,s,o){try{return await i._proxy.$rename(r,s,{overwrite:!1,...o})}catch(a){return yr._handleError(a)}},async copy(r,s,o){try{return await i._proxy.$copy(r,s,{overwrite:!1,...o})}catch(a){return yr._handleError(a)}},isWritableFileSystem(r){const s=t.getCapabilities(r);if(typeof s=="number")return!(s&Cr.Readonly)}})}async mkdirp(e,t,i){const r=[];for(;!t.isEqual(i,t.dirname(i));)try{if(((await e.stat(i)).type&Wa.Directory)===0)throw en.FileExists(`Unable to create folder '${i.scheme===oe.file?i.fsPath:i.toString(!0)}' that already exists but is not a directory`);break}catch(s){if(cg(s)!==Ne.FileNotFound)throw s;r.push(t.basename(i)),i=t.dirname(i)}for(let s=r.length-1;s>=0;s--){i=t.joinPath(i,r[s]);try{await e.createDirectory(i)}catch(o){if(cg(o)!==Ne.FileExists)throw o}}}static _handleError(e){if(e instanceof en)throw e;if(e instanceof o_)switch(e.code){case Ne.FileExists:throw en.FileExists(e.message);case Ne.FileNotFound:throw en.FileNotFound(e.message);case Ne.FileNotADirectory:throw en.FileNotADirectory(e.message);case Ne.FileIsADirectory:throw en.FileIsADirectory(e.message);case Ne.NoPermissions:throw en.NoPermissions(e.message);case Ne.Unavailable:throw en.Unavailable(e.message);default:throw new en(e.message,e.name)}if(!(e instanceof Error))throw new en(String(e));if(e.name==="ENOPRO"||e.message.includes("ENOPRO"))throw en.Unavailable(e.message);switch(e.name){case Ne.FileExists:throw en.FileExists(e.message);case Ne.FileNotFound:throw en.FileNotFound(e.message);case Ne.FileNotADirectory:throw en.FileNotADirectory(e.message);case Ne.FileIsADirectory:throw en.FileIsADirectory(e.message);case Ne.NoPermissions:throw en.NoPermissions(e.message);case Ne.Unavailable:throw en.Unavailable(e.message);default:throw new en(e.message,e.name)}}addFileSystemProvider(e,t,i){return this._fileSystemProvider.set(e,{impl:t,extUri:i!=null&&i.isCaseSensitive?et:C9,isReadonly:!!(i!=null&&i.isReadonly)}),Se(()=>this._fileSystemProvider.delete(e))}getFileSystemProviderExtUri(e){var t;return((t=this._fileSystemProvider.get(e))==null?void 0:t.extUri)??et}};w0=yr=V([F(0,tt),F(1,Ju)],w0);const S_=De("IExtHostConsumerFileSystem"),Jx=De("IExtensionStoragePaths");let b0=class{constructor(e,t,i){this._logService=t,this._extHostFileSystem=i,this._workspace=e.workspace??void 0,this._environment=e.environment,this.whenReady=this._getOrCreateWorkspaceStoragePath().then(r=>this._value=r)}async _getWorkspaceStorageURI(e){return y.joinPath(this._environment.workspaceStorageHome,e)}async _getOrCreateWorkspaceStoragePath(){var i;if(!this._workspace)return Promise.resolve(void 0);const e=this._workspace.id,t=await this._getWorkspaceStorageURI(e);try{return await this._extHostFileSystem.value.stat(t),this._logService.trace("[ExtHostStorage] storage dir already exists",t),t}catch{}try{return this._logService.trace("[ExtHostStorage] creating dir and metadata-file",t),await this._extHostFileSystem.value.createDirectory(t),await this._extHostFileSystem.value.writeFile(y.joinPath(t,"meta.json"),new TextEncoder().encode(JSON.stringify({id:this._workspace.id,configuration:(i=y.revive(this._workspace.configuration))==null?void 0:i.toString(),name:this._workspace.name},void 0,2))),t}catch(r){this._logService.error("[ExtHostStorage]",r);return}}workspaceValue(e){if(this._value)return y.joinPath(this._value,e.identifier.value)}globalValue(e){return y.joinPath(this._environment.globalStorageHome,e.identifier.value.toLowerCase())}onWillDeactivateAll(){}};b0=V([F(0,In),F(1,ct),F(2,S_)],b0);const D_=De("configurationService");var L4;(function(n){n.Http="http",n.Https="https"})(L4||(L4={}));var wa;(function(n){n.ConstantPrivate="constantPrivate",n.Private="private",n.Public="public"})(wa||(wa={}));var N4;(function(n){n[n.Notify=1]="Notify",n[n.OpenBrowser=2]="OpenBrowser",n[n.OpenPreview=3]="OpenPreview",n[n.Silent=4]="Silent",n[n.Ignore=5]="Ignore",n[n.OpenBrowserOnce=6]="OpenBrowserOnce"})(N4||(N4={}));function a6(n){if(n.scheme!=="http"&&n.scheme!=="https")return;const e=/^(localhost|127\.0\.0\.1|0\.0\.0\.0):(\d+)$/.exec(n.authority);if(e)return{address:e[1],port:+e[2]}}const y0=["localhost","127.0.0.1","0:0:0:0:0:0:0:1","::1"];function O4(n){return y0.indexOf(n)>=0}const x0=["0.0.0.0","0:0:0:0:0:0:0:0","::"];function F4(n){return x0.indexOf(n)>=0}class l6{constructor(e,t,i){this.remoteAddress=e,this.localAddress=t,this._dispose=i,this._onDispose=new L,this.onDidDispose=this._onDispose.event}dispose(){return this._onDispose.fire(),this._dispose()}}let M4=class extends Te{constructor(e,t){super(),this.logService=e,this.configurationService=t,this._onTunnelOpened=new L,this.onTunnelOpened=this._onTunnelOpened.event,this._onTunnelClosed=new L,this.onTunnelClosed=this._onTunnelClosed.event,this._onAddedTunnelProvider=new L,this.onAddedTunnelProvider=this._onAddedTunnelProvider.event,this._tunnels=new Map,this._canElevate=!1,this._canChangeProtocol=!0,this._privacyOptions=[],this._factoryInProgress=new Set}get hasTunnelProvider(){return!!this._tunnelProvider}get defaultTunnelHost(){const e=this.configurationService.getValue("remote.localPortHost");return!e||e==="localhost"?"127.0.0.1":"0.0.0.0"}setTunnelProvider(e){return this._tunnelProvider=e,e?(this._onAddedTunnelProvider.fire(),{dispose:()=>{this._tunnelProvider=void 0,this._canElevate=!1,this._privacyOptions=[]}}):(this._canElevate=!1,this._privacyOptions=[],this._onAddedTunnelProvider.fire(),{dispose:()=>{}})}setTunnelFeatures(e){this._canElevate=e.elevation,this._privacyOptions=e.privacyOptions,this._canChangeProtocol=e.protocol}get canChangeProtocol(){return this._canChangeProtocol}get canElevate(){return this._canElevate}get canChangePrivacy(){return this._privacyOptions.length>0}get privacyOptions(){return this._privacyOptions}get tunnels(){return this.getTunnels()}async getTunnels(){const e=[],t=Array.from(this._tunnels.values());for(const i of t){const r=Array.from(i.values());for(const s of r){const o=await s.value;o&&typeof o!="string"&&e.push(o)}}return e}async dispose(){super.dispose();for(const e of this._tunnels.values()){for(const{value:t}of e.values())await t.then(i=>typeof i!="string"?i==null?void 0:i.dispose():void 0);e.clear()}this._tunnels.clear()}setEnvironmentTunnel(e,t,i,r,s){this.addTunnelToMap(e,t,Promise.resolve({tunnelRemoteHost:e,tunnelRemotePort:t,localAddress:i,privacy:r,protocol:s,dispose:()=>Promise.resolve()}))}async getExistingTunnel(e,t){(F4(e)||O4(e))&&(e=y0[0]);const i=this.getTunnelFromMap(e,t);if(i)return++i.refcount,i.value}openTunnel(e,t,i,r,s,o=!1,a,l){this.logService.trace(`ForwardedPorts: (TunnelService) openTunnel request for ${t}:${i} on local port ${s}.`);const c=this._tunnelProvider??e;if(!c)return;if(t||(t="localhost"),r||(r=this.defaultTunnelHost),this._tunnelProvider&&this._factoryInProgress.has(i)){this.logService.debug("ForwardedPorts: (TunnelService) Another call to create a tunnel with the same address has occurred before the last one completed. This call will be ignored.");return}const u=this.retainOrCreateTunnel(c,t,i,r,s,o,a,l);return u?u.then(d=>{if(d){if(typeof d=="string")return this.logService.trace("ForwardedPorts: (TunnelService) The tunnel provider returned an error when creating the tunnel."),this.removeEmptyOrErrorTunnelFromMap(t,i),d}else{this.logService.trace("ForwardedPorts: (TunnelService) New tunnel is undefined."),this.removeEmptyOrErrorTunnelFromMap(t,i);return}this.logService.trace("ForwardedPorts: (TunnelService) New tunnel established.");const f=this.makeTunnel(d);return(d.tunnelRemoteHost!==t||d.tunnelRemotePort!==i)&&this.logService.warn("ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Host or port mismatch."),a&&d.privacy!==a&&this.logService.warn("ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Privacy mismatch."),this._onTunnelOpened.fire(f),f}):(this.logService.trace("ForwardedPorts: (TunnelService) Tunnel was not created."),u)}makeTunnel(e){return{tunnelRemotePort:e.tunnelRemotePort,tunnelRemoteHost:e.tunnelRemoteHost,tunnelLocalPort:e.tunnelLocalPort,localAddress:e.localAddress,privacy:e.privacy,protocol:e.protocol,dispose:async()=>{this.logService.trace(`ForwardedPorts: (TunnelService) dispose request for ${e.tunnelRemoteHost}:${e.tunnelRemotePort} `);const t=this._tunnels.get(e.tunnelRemoteHost);if(t){const i=t.get(e.tunnelRemotePort);i&&(i.refcount--,await this.tryDisposeTunnel(e.tunnelRemoteHost,e.tunnelRemotePort,i))}}}}async tryDisposeTunnel(e,t,i){if(i.refcount<=0){this.logService.trace(`ForwardedPorts: (TunnelService) Tunnel is being disposed ${e}:${t}.`);const r=i.value.then(async s=>{s&&typeof s!="string"&&(await s.dispose(!0),this._onTunnelClosed.fire({host:s.tunnelRemoteHost,port:s.tunnelRemotePort}))});return this._tunnels.has(e)&&this._tunnels.get(e).delete(t),r}}async closeTunnel(e,t){this.logService.trace(`ForwardedPorts: (TunnelService) close request for ${e}:${t} `);const i=this._tunnels.get(e);if(i&&i.has(t)){const r=i.get(t);r.refcount=0,await this.tryDisposeTunnel(e,t,r)}}addTunnelToMap(e,t,i){this._tunnels.has(e)||this._tunnels.set(e,new Map),this._tunnels.get(e).set(t,{refcount:1,value:i})}async removeEmptyOrErrorTunnelFromMap(e,t){const i=this._tunnels.get(e);if(i){const r=i.get(t),s=r?await r.value:void 0;(!s||typeof s=="string")&&i.delete(t),i.size===0&&this._tunnels.delete(e)}}getTunnelFromMap(e,t){const i=[e];O4(e)?(i.push(...y0),i.push(...x0)):F4(e)&&i.push(...x0);const r=i.map(s=>this._tunnels.get(s));for(const s of r){const o=s==null?void 0:s.get(t);if(o)return o}}canTunnel(e){return!!a6(e)}createWithProvider(e,t,i,r,s,o,a){this.logService.trace(`ForwardedPorts: (TunnelService) Creating tunnel with provider ${t}:${i} on local port ${r}.`);const l=i;this._factoryInProgress.add(l);const c=r===void 0?i:r,u={elevationRequired:s?this.isPortPrivileged(c):!1},d={remoteAddress:{host:t,port:i},localAddressPort:r,privacy:o,public:o?o!==wa.Private:void 0,protocol:a},f=e.forwardPort(d,u);return f?(this.addTunnelToMap(t,i,f),f.finally(()=>{this.logService.trace("ForwardedPorts: (TunnelService) Tunnel created by provider."),this._factoryInProgress.delete(l)})):this._factoryInProgress.delete(l),f}};M4=V([F(0,ct),F(1,D_)],M4);class c6 extends l6{}var E0;(function(n){function e(i){return{remoteAddress:i.remoteAddress,localAddress:i.localAddress,public:!!i.public,privacy:i.privacy??(i.public?wa.Public:wa.Private),protocol:i.protocol}}n.fromApiTunnel=e;function t(i){return{remoteAddress:{host:i.tunnelRemoteHost,port:i.tunnelRemotePort},localAddress:i.localAddress,public:i.privacy!==wa.ConstantPrivate&&i.privacy!==wa.ConstantPrivate,privacy:i.privacy,protocol:i.protocol}}n.fromServiceTunnel=t})(E0||(E0={}));const Xx=De("IExtHostTunnelService");let S0=class extends Te{constructor(e,t,i){super(),this.logService=i,this._showCandidatePort=()=>Promise.resolve(!0),this._extensionTunnels=new Map,this._onDidChangeTunnels=new L,this.onDidChangeTunnels=this._onDidChangeTunnels.event,this._providerHandleCounter=0,this._portAttributesProviders=new Map,this._proxy=e.getProxy(Z.MainThreadTunnelService)}async openTunnel(e,t){this.logService.trace(`ForwardedPorts: (ExtHostTunnelService) ${e.identifier.value} called openTunnel API for ${t.remoteAddress.host}:${t.remoteAddress.port}.`);const i=await this._proxy.$openTunnel(t,e.displayName);if(i){const r=new c6(i.remoteAddress,i.localAddress,()=>this._proxy.$closeTunnel(i.remoteAddress));return this._register(r),r}}async getTunnels(){return this._proxy.$getTunnels()}nextPortAttributesProviderHandle(){return this._providerHandleCounter++}registerPortsAttributesProvider(e,t){e.portRange===void 0&&e.commandPattern===void 0&&this.logService.error("PortAttributesProvider must specify either a portRange or a commandPattern");const i=this.nextPortAttributesProviderHandle();return this._portAttributesProviders.set(i,{selector:e,provider:t}),this._proxy.$registerPortsAttributesProvider(e,i),new je(()=>{this._portAttributesProviders.delete(i),this._proxy.$unregisterPortsAttributesProvider(i)})}async $providePortAttributes(e,t,i,r,s){const o=[];for(const l of e){const c=this._portAttributesProviders.get(l);if(!c)return[];o.push(...await Promise.all(t.map(async u=>{let d;try{d=await c.provider.providePortAttributes({port:u,pid:i,commandLine:r},s)}catch{d=await c.provider.providePortAttributes(u,i,r,s)}return{providedAttributes:d,port:u}})))}const a=o.filter(l=>!!l.providedAttributes);return a.length>0?a.map(l=>({autoForwardAction:l.providedAttributes.autoForwardAction,port:l.port})):[]}async $registerCandidateFinder(e){}registerTunnelProvider(e,t){var r,s;if(this._forwardPortProvider)throw new Error("A tunnel provider has already been registered. Only the first tunnel provider to be registered will be used.");this._forwardPortProvider=async(o,a)=>await e.provideTunnel(o,a,Pt.None)??void 0;const i=t.tunnelFeatures?{elevation:!!((r=t.tunnelFeatures)!=null&&r.elevation),privacyOptions:(s=t.tunnelFeatures)==null?void 0:s.privacyOptions,protocol:t.tunnelFeatures.protocol===void 0?!0:t.tunnelFeatures.protocol}:void 0;return this._proxy.$setTunnelProvider(i,!0),Promise.resolve(Se(()=>{this._forwardPortProvider=void 0,this._proxy.$setTunnelProvider(void 0,!1)}))}async setTunnelFactory(e,t){var i,r,s,o;if(e){e.candidatePortSource!==void 0&&this._proxy.$setCandidatePortSource(e.candidatePortSource),e.showCandidatePort&&(this._showCandidatePort=e.showCandidatePort,this._proxy.$setCandidateFilter());const a=e.tunnelFactory??(t?this.makeManagedTunnelFactory(t):void 0);if(a){this._forwardPortProvider=a;let l=((i=e.tunnelFeatures)==null?void 0:i.privacyOptions)??[];(r=e.tunnelFeatures)!=null&&r.public&&l.length===0&&(l=[{id:"private",label:h(2553,"Private"),themeIcon:"lock"},{id:"public",label:h(2554,"Public"),themeIcon:"eye"}]);const c=e.tunnelFeatures?{elevation:!!((s=e.tunnelFeatures)!=null&&s.elevation),public:!!((o=e.tunnelFeatures)!=null&&o.public),privacyOptions:l,protocol:!0}:void 0;this._proxy.$setTunnelProvider(c,!!e.tunnelFactory)}}else this._forwardPortProvider=void 0;return Se(()=>{this._forwardPortProvider=void 0})}makeManagedTunnelFactory(e){}async $closeTunnel(e,t){if(this._extensionTunnels.has(e.host)){const i=this._extensionTunnels.get(e.host);i.has(e.port)&&(t&&i.get(e.port).disposeListener.dispose(),await i.get(e.port).tunnel.dispose(),i.delete(e.port))}}async $onDidTunnelsChange(){this._onDidChangeTunnels.fire()}async $forwardPort(e,t){if(this._forwardPortProvider)try{this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Getting tunnel from provider.");const i=this._forwardPortProvider(e,t);if(this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Got tunnel promise from provider."),i!==void 0){const r=await i;if(this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Successfully awaited tunnel from provider."),r===void 0){this.logService.error("ForwardedPorts: (ExtHostTunnelService) Resolved tunnel is undefined");return}this._extensionTunnels.has(e.remoteAddress.host)||this._extensionTunnels.set(e.remoteAddress.host,new Map);const s=this._register(r.onDidDispose(()=>(this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Extension fired tunnel's onDidDispose."),this._proxy.$closeTunnel(r.remoteAddress))));return this._extensionTunnels.get(e.remoteAddress.host).set(e.remoteAddress.port,{tunnel:r,disposeListener:s}),E0.fromApiTunnel(r)}else this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Tunnel is undefined")}catch(i){if(this.logService.trace("ForwardedPorts: (ExtHostTunnelService) tunnel provider error"),i instanceof Error)return i.message}}async $applyCandidateFilter(e){const t=await Promise.all(e.map(r=>this._showCandidatePort(r.host,r.port,r.detail??""))),i=e.filter((r,s)=>t[s]);return this.logService.trace(`ForwardedPorts: (ExtHostTunnelService) filtered from ${e.map(r=>r.port).join(", ")} to ${i.map(r=>r.port).join(", ")}`),i}};S0=V([F(0,tt),F(1,In),F(2,ct)],S0);function u6(n){return[...n.entries()]}function d6(n){return n?[...n.entries()]:[]}var $4;(function(n){n.AutomationProfile="terminal.integrated.automationProfile.",n.DefaultProfile="terminal.integrated.defaultProfile.",n.Profiles="terminal.integrated.profiles."})($4||($4={}));var U4;(function(n){n.SendKeybindingsToShell="terminal.integrated.sendKeybindingsToShell",n.AutomationProfileLinux="terminal.integrated.automationProfile.linux",n.AutomationProfileMacOs="terminal.integrated.automationProfile.osx",n.AutomationProfileWindows="terminal.integrated.automationProfile.windows",n.ProfilesWindows="terminal.integrated.profiles.windows",n.ProfilesMacOs="terminal.integrated.profiles.osx",n.ProfilesLinux="terminal.integrated.profiles.linux",n.DefaultProfileLinux="terminal.integrated.defaultProfile.linux",n.DefaultProfileMacOs="terminal.integrated.defaultProfile.osx",n.DefaultProfileWindows="terminal.integrated.defaultProfile.windows",n.UseWslProfiles="terminal.integrated.useWslProfiles",n.TabsDefaultColor="terminal.integrated.tabs.defaultColor",n.TabsDefaultIcon="terminal.integrated.tabs.defaultIcon",n.TabsEnabled="terminal.integrated.tabs.enabled",n.TabsEnableAnimation="terminal.integrated.tabs.enableAnimation",n.TabsHideCondition="terminal.integrated.tabs.hideCondition",n.TabsShowActiveTerminal="terminal.integrated.tabs.showActiveTerminal",n.TabsShowActions="terminal.integrated.tabs.showActions",n.TabsLocation="terminal.integrated.tabs.location",n.TabsFocusMode="terminal.integrated.tabs.focusMode",n.MacOptionIsMeta="terminal.integrated.macOptionIsMeta",n.MacOptionClickForcesSelection="terminal.integrated.macOptionClickForcesSelection",n.AltClickMovesCursor="terminal.integrated.altClickMovesCursor",n.CopyOnSelection="terminal.integrated.copyOnSelection",n.EnableMultiLinePasteWarning="terminal.integrated.enableMultiLinePasteWarning",n.DrawBoldTextInBrightColors="terminal.integrated.drawBoldTextInBrightColors",n.FontFamily="terminal.integrated.fontFamily",n.FontSize="terminal.integrated.fontSize",n.LetterSpacing="terminal.integrated.letterSpacing",n.LineHeight="terminal.integrated.lineHeight",n.MinimumContrastRatio="terminal.integrated.minimumContrastRatio",n.TabStopWidth="terminal.integrated.tabStopWidth",n.FastScrollSensitivity="terminal.integrated.fastScrollSensitivity",n.MouseWheelScrollSensitivity="terminal.integrated.mouseWheelScrollSensitivity",n.BellDuration="terminal.integrated.bellDuration",n.FontWeight="terminal.integrated.fontWeight",n.FontWeightBold="terminal.integrated.fontWeightBold",n.CursorBlinking="terminal.integrated.cursorBlinking",n.CursorStyle="terminal.integrated.cursorStyle",n.CursorStyleInactive="terminal.integrated.cursorStyleInactive",n.CursorWidth="terminal.integrated.cursorWidth",n.Scrollback="terminal.integrated.scrollback",n.DetectLocale="terminal.integrated.detectLocale",n.DefaultLocation="terminal.integrated.defaultLocation",n.GpuAcceleration="terminal.integrated.gpuAcceleration",n.TerminalTitleSeparator="terminal.integrated.tabs.separator",n.TerminalTitle="terminal.integrated.tabs.title",n.TerminalDescription="terminal.integrated.tabs.description",n.RightClickBehavior="terminal.integrated.rightClickBehavior",n.MiddleClickBehavior="terminal.integrated.middleClickBehavior",n.Cwd="terminal.integrated.cwd",n.ConfirmOnExit="terminal.integrated.confirmOnExit",n.ConfirmOnKill="terminal.integrated.confirmOnKill",n.EnableBell="terminal.integrated.enableBell",n.EnableVisualBell="terminal.integrated.enableVisualBell",n.CommandsToSkipShell="terminal.integrated.commandsToSkipShell",n.AllowChords="terminal.integrated.allowChords",n.AllowMnemonics="terminal.integrated.allowMnemonics",n.TabFocusMode="terminal.integrated.tabFocusMode",n.EnvMacOs="terminal.integrated.env.osx",n.EnvLinux="terminal.integrated.env.linux",n.EnvWindows="terminal.integrated.env.windows",n.EnvironmentChangesIndicator="terminal.integrated.environmentChangesIndicator",n.EnvironmentChangesRelaunch="terminal.integrated.environmentChangesRelaunch",n.ShowExitAlert="terminal.integrated.showExitAlert",n.SplitCwd="terminal.integrated.splitCwd",n.WindowsEnableConpty="terminal.integrated.windowsEnableConpty",n.WindowsUseConptyDll="terminal.integrated.windowsUseConptyDll",n.WordSeparators="terminal.integrated.wordSeparators",n.EnableFileLinks="terminal.integrated.enableFileLinks",n.AllowedLinkSchemes="terminal.integrated.allowedLinkSchemes",n.UnicodeVersion="terminal.integrated.unicodeVersion",n.EnablePersistentSessions="terminal.integrated.enablePersistentSessions",n.PersistentSessionReviveProcess="terminal.integrated.persistentSessionReviveProcess",n.HideOnStartup="terminal.integrated.hideOnStartup",n.HideOnLastClosed="terminal.integrated.hideOnLastClosed",n.CustomGlyphs="terminal.integrated.customGlyphs",n.RescaleOverlappingGlyphs="terminal.integrated.rescaleOverlappingGlyphs",n.PersistentSessionScrollback="terminal.integrated.persistentSessionScrollback",n.InheritEnv="terminal.integrated.inheritEnv",n.ShowLinkHover="terminal.integrated.showLinkHover",n.IgnoreProcessNames="terminal.integrated.ignoreProcessNames",n.ShellIntegrationEnabled="terminal.integrated.shellIntegration.enabled",n.ShellIntegrationShowWelcome="terminal.integrated.shellIntegration.showWelcome",n.ShellIntegrationDecorationsEnabled="terminal.integrated.shellIntegration.decorationsEnabled",n.ShellIntegrationEnvironmentReporting="terminal.integrated.shellIntegration.environmentReporting",n.EnableImages="terminal.integrated.enableImages",n.SmoothScrolling="terminal.integrated.smoothScrolling",n.IgnoreBracketedPasteMode="terminal.integrated.ignoreBracketedPasteMode",n.FocusAfterRun="terminal.integrated.focusAfterRun",n.FontLigaturesEnabled="terminal.integrated.fontLigatures.enabled",n.FontLigaturesFeatureSettings="terminal.integrated.fontLigatures.featureSettings",n.FontLigaturesFallbackLigatures="terminal.integrated.fontLigatures.fallbackLigatures",n.DeveloperPtyHostLatency="terminal.integrated.developer.ptyHost.latency",n.DeveloperPtyHostStartupDelay="terminal.integrated.developer.ptyHost.startupDelay",n.DevMode="terminal.integrated.developer.devMode"})(U4||(U4={}));var H4;(function(n){n.Bash="bash",n.Fish="fish",n.Sh="sh",n.Csh="csh",n.Ksh="ksh",n.Zsh="zsh"})(H4||(H4={}));var B4;(function(n){n.CommandPrompt="cmd",n.Wsl="wsl",n.GitBash="gitbash"})(B4||(B4={}));var W4;(function(n){n.PowerShell="pwsh",n.Python="python",n.Julia="julia",n.NuShell="nu",n.Node="node"})(W4||(W4={}));var V4;(function(n){n[n.Api=0]="Api",n[n.Process=1]="Process",n[n.Sequence=2]="Sequence",n[n.Config=3]="Config"})(V4||(V4={}));var z4;(function(n){n.LocalPty="localPty",n.PtyHost="ptyHost",n.PtyHostWindow="ptyHostWindow",n.Logger="logger",n.Heartbeat="heartbeat"})(z4||(z4={}));var zu;(function(n){n.Cwd="cwd",n.InitialCwd="initialCwd",n.FixedDimensions="fixedDimensions",n.Title="title",n.ShellType="shellType",n.HasChildProcesses="hasChildProcesses",n.ResolvedShellLaunchConfig="resolvedShellLaunchConfig",n.OverrideDimensions="overrideDimensions",n.FailedShellIntegrationActivation="failedShellIntegrationActivation",n.UsedShellIntegrationInjection="usedShellIntegrationInjection"})(zu||(zu={}));var q4;(function(n){n[n.BeatInterval=5e3]="BeatInterval",n[n.ConnectingBeatInterval=2e4]="ConnectingBeatInterval",n[n.FirstWaitMultiplier=1.2]="FirstWaitMultiplier",n[n.SecondWaitMultiplier=1]="SecondWaitMultiplier",n[n.CreateProcessTimeout=5e3]="CreateProcessTimeout"})(q4||(q4={}));var j4;(function(n){n[n.Panel=1]="Panel",n[n.Editor=2]="Editor"})(j4||(j4={}));var G4;(function(n){n.TerminalView="view",n.Editor="editor"})(G4||(G4={}));var Q4;(function(n){n[n.GraceTime=6e4]="GraceTime",n[n.ShortGraceTime=6e3]="ShortGraceTime"})(Q4||(Q4={}));var J4;(function(n){n[n.HighWatermarkChars=1e5]="HighWatermarkChars",n[n.LowWatermarkChars=5e3]="LowWatermarkChars",n[n.CharCountAckSize=5e3]="CharCountAckSize"})(J4||(J4={}));var X4;(function(n){n.GitBash="Git Bash",n.Pwsh="PowerShell"})(X4||(X4={}));var Y4;(function(n){n[n.Off=0]="Off",n[n.FinalTerm=1]="FinalTerm",n[n.VSCode=2]="VSCode"})(Y4||(Y4={}));var Z4;(function(n){n[n.Unknown=0]="Unknown",n[n.Shutdown=1]="Shutdown",n[n.Process=2]="Process",n[n.User=3]="User",n[n.Extension=4]="Extension"})(Z4||(Z4={}));const h6={Backend:"workbench.contributions.terminal.processBackend"};function D0(n){return(n==null?void 0:n.toLowerCase())??""}class f6{constructor(e){this.remoteAuthority=e}affects(e){return D0(e)===this.remoteAuthority}}class p6{constructor(){this._backends=new Map,this._onDidChangeBackends=new L,this.onDidChangeBackends=this._onDidChangeBackends.event}get backends(){return this._backends}registerTerminalBackend(e){const t=D0(e.remoteAuthority);if(this._backends.has(t))throw new Error(`A terminal backend with remote authority '${t}' was already registered.`);this._backends.set(t,e),this._onDidChangeBackends.fire(new f6(t))}getTerminalBackend(e){return this._backends.get(D0(e))}}Cn.add(h6.Backend,new p6);class g6{constructor(e){this._callback=e,this._terminalBufferMap=new Map}dispose(){for(const e of this._terminalBufferMap.values())e.dispose()}startBuffering(e,t,i=5){const r=t(s=>{const o=typeof s=="string"?s:s.data;let a=this._terminalBufferMap.get(e);if(a){a.data.push(o);return}const l=setTimeout(()=>this.flushBuffer(e),i);a={data:[o],timeoutId:l,dispose:()=>{clearTimeout(l),this.flushBuffer(e),r.dispose()}},this._terminalBufferMap.set(e,a)});return r}stopBuffering(e){const t=this._terminalBufferMap.get(e);t==null||t.dispose()}flushBuffer(e){const t=this._terminalBufferMap.get(e);t&&(this._terminalBufferMap.delete(e),this._callback(e,t.data.join("")))}}const Ho=(n,e,t,i)=>{let r=e;return{enumerable:!0,configurable:!1,get(){return r},set(s){var o;if(!t(r,s)){const a=r;r=s,(o=n.listener)==null||o.call(n,i(s,a))}}}},ql=(n,e)=>n===e,Gs={range:(n,e)=>n===e?!0:!n||!e?!1:n.isEqual(e),label:ql,description:ql,sortText:ql,busy:ql,error:ql,canResolveChildren:ql,tags:(n,e)=>!(n.length!==e.length||n.some(t=>!e.find(i=>t.id===i.id)))},jl=n=>e=>({op:pn.SetProp,update:n(e)}),m6=(n,e)=>({range:(()=>{let t;const i=jl(r=>({range:lt.lift(W.from(r))}));return{enumerable:!0,configurable:!1,get(){return t},set(r){var s,o;(s=n.listener)==null||s.call(n,{op:pn.DocumentSynced}),Gs.range(t,r)||(t=r,(o=n.listener)==null||o.call(n,i(r)))}}})(),label:Ho(n,e,Gs.label,jl(t=>({label:t}))),description:Ho(n,void 0,Gs.description,jl(t=>({description:t}))),sortText:Ho(n,void 0,Gs.sortText,jl(t=>({sortText:t}))),canResolveChildren:Ho(n,!1,Gs.canResolveChildren,t=>({op:pn.UpdateCanResolveChildren,state:t})),busy:Ho(n,!1,Gs.busy,jl(t=>({busy:t}))),error:Ho(n,void 0,Gs.error,jl(t=>({error:Le.fromStrict(t)||null}))),tags:Ho(n,[],Gs.tags,(t,i)=>({op:pn.SetTags,new:t.map(gr.from),old:i.map(gr.from)}))}),_6=n=>{const e=Re.fromString(n.extId),t=new Rl(e.controllerId,e.localId,n.label,y.revive(n.uri)||void 0);return t.range=W.to(n.range||void 0),t.description=n.description||void 0,t.sortText=n.sortText||void 0,t.tags=n.tags.map(i=>gr.to({id:FC(i).tagId})),t},K4=n=>{let e;for(const t of n.tests){const i=_6(t.item);p_(i).parent=e,e=i}return e};class Rl{constructor(e,t,i,r){if(t.includes(bi.Delimiter))throw new Error(`Test IDs may not include the ${JSON.stringify(t)} symbol`);const s=XR(this,e);Object.defineProperties(this,{id:{value:t,enumerable:!0,writable:!1},uri:{value:r,enumerable:!0,writable:!1},parent:{enumerable:!1,get(){return s.parent instanceof Yx?void 0:s.parent}},children:{value:JR(s,p_,Rl),enumerable:!0,writable:!1},...m6(s,i)})}}class Yx extends Rl{constructor(e,t){super(e,e,t,void 0),this._isRoot=!0}}class v6 extends jR{constructor(e,t,i){super({controllerId:e,getDocumentVersion:r=>{var s;return r&&((s=i.getDocument(r))==null?void 0:s.version)},getApiFor:p_,getChildren:r=>r.children,root:new Yx(e,t),toITestItem:Ro.from})}}let k0=class extends Te{constructor(e,t,i){super(),this.initData=t,this._onDidChangeTelemetryEnabled=this._register(new L),this.onDidChangeTelemetryEnabled=this._onDidChangeTelemetryEnabled.event,this._onDidChangeTelemetryConfiguration=this._register(new L),this.onDidChangeTelemetryConfiguration=this._onDidChangeTelemetryConfiguration.event,this._productConfig={usage:!0,error:!0},this._level=ro.NONE,this._inLoggingOnlyMode=!1,this._telemetryLoggers=new Map,this._inLoggingOnlyMode=this.initData.environment.isExtensionTelemetryLoggingOnly;const r=t.remote.isRemote?"remoteExtHostTelemetry":e?"workerExtHostTelemetry":"extHostTelemetry";this._outputLogger=this._register(i.createLogger(r,{name:h(2550,"Extension Telemetry{0}",this._inLoggingOnlyMode?" (Not Sent)":""),hidden:!0,group:HA}))}getTelemetryConfiguration(){return this._level===ro.USAGE}getTelemetryDetails(){return{isCrashEnabled:this._level>=ro.CRASH,isErrorsEnabled:this._productConfig.error?this._level>=ro.ERROR:!1,isUsageEnabled:this._productConfig.usage?this._level>=ro.USAGE:!1}}instantiateLogger(e,t,i){const r=this.getTelemetryDetails(),s=new P5(t,i,e,this._outputLogger,this._inLoggingOnlyMode,this.getBuiltInCommonProperties(e),{isUsageEnabled:r.isUsageEnabled,isErrorsEnabled:r.isErrorsEnabled}),o=this._telemetryLoggers.get(e.identifier.value)??[];return this._telemetryLoggers.set(e.identifier.value,[...o,s]),s.apiTelemetryLogger}$initializeTelemetryLevel(e,t,i){this._level=e,this._productConfig=i??{usage:!0,error:!0}}getBuiltInCommonProperties(e){const t=Object.create(null);switch(t["common.extname"]=`${e.publisher}.${e.name}`,t["common.extversion"]=e.version,t["common.vscodemachineid"]=this.initData.telemetryInfo.machineId,t["common.vscodesessionid"]=this.initData.telemetryInfo.sessionId,t["common.vscodecommithash"]=this.initData.commit,t["common.sqmid"]=this.initData.telemetryInfo.sqmId,t["common.devDeviceId"]=this.initData.telemetryInfo.devDeviceId,t["common.vscodeversion"]=this.initData.version,t["common.isnewappinstall"]=T5(this.initData.telemetryInfo.firstSessionDate),t["common.product"]=this.initData.environment.appHost,this.initData.uiKind){case dh.Web:t["common.uikind"]="web";break;case dh.Desktop:t["common.uikind"]="desktop";break;default:t["common.uikind"]="unknown"}return t["common.remotename"]=wx(WA(this.initData.remote.authority)),t}$onDidChangeTelemetryLevel(e){this._oldTelemetryEnablement=this.getTelemetryConfiguration(),this._level=e;const t=this.getTelemetryDetails();this._telemetryLoggers.forEach((i,r)=>{const s=i.filter(o=>!o.isDisposed);s.length===0?this._telemetryLoggers.delete(r):this._telemetryLoggers.set(r,s)}),this._telemetryLoggers.forEach(i=>{for(const r of i)r.updateTelemetryEnablements(t.isUsageEnabled,t.isErrorsEnabled)}),this._oldTelemetryEnablement!==this.getTelemetryConfiguration()&&this._onDidChangeTelemetryEnabled.fire(this.getTelemetryConfiguration()),this._onDidChangeTelemetryConfiguration.fire(this.getTelemetryDetails())}onExtensionError(e,t){const i=this._telemetryLoggers.get(e.value),r=i==null?void 0:i.filter(o=>!o.isDisposed);if(!r)return this._telemetryLoggers.delete(e.value),!1;let s=!1;for(const o of r)o.ignoreUnhandledExtHostErrors||(o.logError(t),s=!0);return s}};k0=V([F(1,In),F(2,Qu)],k0);class P5{static validateSender(e){if(typeof e!="object")throw new TypeError("TelemetrySender argument is invalid");if(typeof e.sendEventData!="function")throw new TypeError("TelemetrySender.sendEventData must be a function");if(typeof e.sendErrorData!="function")throw new TypeError("TelemetrySender.sendErrorData must be a function");if(typeof e.flush<"u"&&typeof e.flush!="function")throw new TypeError("TelemetrySender.flush must be a function or undefined")}constructor(e,t,i,r,s,o,a){this._extension=i,this._logger=r,this._inLoggingOnlyMode=s,this._commonProperties=o,this._onDidChangeEnableStates=new L,this.ignoreUnhandledExtHostErrors=(t==null?void 0:t.ignoreUnhandledErrors)??!1,this._ignoreBuiltinCommonProperties=(t==null?void 0:t.ignoreBuiltInCommonProperties)??!1,this._additionalCommonProperties=t==null?void 0:t.additionalCommonProperties,this._sender=e,this._telemetryEnablements={isUsageEnabled:a.isUsageEnabled,isErrorsEnabled:a.isErrorsEnabled}}updateTelemetryEnablements(e,t){this._apiObject&&(this._telemetryEnablements={isUsageEnabled:e,isErrorsEnabled:t},this._onDidChangeEnableStates.fire(this._apiObject))}mixInCommonPropsAndCleanData(e){let t="properties"in e?e.properties??{}:e;return t=SS(t,[]),this._additionalCommonProperties&&(t=gl(t,this._additionalCommonProperties)),this._ignoreBuiltinCommonProperties||(t=gl(t,this._commonProperties)),"properties"in e?e.properties=t:e=t,e}logEvent(e,t){var i;this._sender&&(this._extension.publisher==="vscode"?e=this._extension.name+"/"+e:e=this._extension.identifier.value+"/"+e,t=this.mixInCommonPropsAndCleanData(t||{}),this._inLoggingOnlyMode||(i=this._sender)==null||i.sendEventData(e,t),this._logger.trace(e,t))}logUsage(e,t){this._telemetryEnablements.isUsageEnabled&&this.logEvent(e,t)}logError(e,t){if(!(!this._telemetryEnablements.isErrorsEnabled||!this._sender))if(typeof e=="string")this.logEvent(e,t);else{const i={name:e.name,message:e.message,stack:e.stack,cause:e.cause},r=SS(i,[]),s=new Error(r.message,{cause:r.cause});s.stack=r.stack,s.name=r.name,t=this.mixInCommonPropsAndCleanData(t||{}),this._inLoggingOnlyMode||this._sender.sendErrorData(s,t),this._logger.trace("exception",t)}}get apiTelemetryLogger(){if(!this._apiObject){const e=this,t={logUsage:e.logUsage.bind(e),get isUsageEnabled(){return e._telemetryEnablements.isUsageEnabled},get isErrorsEnabled(){return e._telemetryEnablements.isErrorsEnabled},logError:e.logError.bind(e),dispose:e.dispose.bind(e),onDidChangeEnableStates:e._onDidChangeEnableStates.event.bind(e)};this._apiObject=Object.freeze(t)}return this._apiObject}get isDisposed(){return!this._sender}dispose(){var e;if((e=this._sender)!=null&&e.flush){let t=this._sender;this._sender=void 0,Promise.resolve(t.flush()).then(t=void 0),this._apiObject=void 0}else this._sender=void 0}}function T5(n){const e=Date.now()-new Date(n).getTime();return isNaN(e)?!1:e<1e3*60*60*24}const k_=De("IExtHostTelemetry");var vs,kf,If,nI;let I0=(nI=class{constructor(e,t,i){ge(this,vs);ge(this,kf);ge(this,If);this._commands=new Map,this._apiCommands=new Map,ie(this,vs,e.getProxy(Z.MainThreadCommands)),this._logService=t,ie(this,If,i),ie(this,kf,e.getProxy(Z.MainThreadTelemetry)),this.converter=new w6(this,r=>{const s=this._apiCommands.get(r);return(s==null?void 0:s.result)===be.Void?s:void 0},t),this._argumentProcessors=[{processArgument(r){return jn(r)}},{processArgument(r){return pu(r,function(s){if(lt.isIRange(s))return W.to(s);if(Ii.isIPosition(s))return nt.to(s);if(lt.isIRange(s.range)&&y.isUri(s.uri))return ii.to(s);if(s instanceof Pe)return s.buffer.buffer;if(!Array.isArray(s))return s})}}]}registerArgumentProcessor(e){this._argumentProcessors.push(e)}registerApiCommand(e){const t=this.registerCommand(!1,e.id,async(...i)=>{const r=e.args.map((o,a)=>{if(!o.validate(i[a]))throw new Error(`Invalid argument '${o.name}' when running '${e.id}', received: ${typeof i[a]=="object"?JSON.stringify(i[a],null,"	"):i[a]} `);return o.convert(i[a])}),s=await this.executeCommand(e.internalId,...r);return e.result.convert(s,i,this.converter)},void 0,{description:e.description,args:e.args,returns:e.result.description});return this._apiCommands.set(e.id,e),new je(()=>{t.dispose(),this._apiCommands.delete(e.id)})}registerCommand(e,t,i,r,s,o){if(this._logService.trace("ExtHostCommands#registerCommand",t),!t.trim().length)throw new Error("invalid id");if(this._commands.has(t))throw new Error(`command '${t}' already exists`);return this._commands.set(t,{callback:i,thisArg:r,metadata:s,extension:o}),e&&A(this,vs).$registerCommand(t),new je(()=>{this._commands.delete(t)&&e&&A(this,vs).$unregisterCommand(t)})}executeCommand(e,...t){return this._logService.trace("ExtHostCommands#executeCommand",e),this._doExecuteCommand(e,t,!0)}async _doExecuteCommand(e,t,i){if(this._commands.has(e))return A(this,vs).$fireCommandActivationEvent(e),this._executeContributedCommand(e,t,!1);{let r=!1;const s=pu(t,function(o){if(o instanceof We)return nt.from(o);if(o instanceof Oe)return W.from(o);if(o instanceof Ti)return ii.from(o);if(Ss.isNotebookRange(o))return Hr.from(o);if(o instanceof ArrayBuffer)return r=!0,Pe.wrap(new Uint8Array(o));if(o instanceof Uint8Array)return r=!0,Pe.wrap(o);if(o instanceof Pe)return r=!0,o;if(!Array.isArray(o))return o});try{const o=await A(this,vs).$executeCommand(e,r?new hi(s):s,i);return jn(o)}catch(o){if(o instanceof Error&&o.message==="$executeCommand:retry")return this._doExecuteCommand(e,t,!1);throw o}}}async _executeContributedCommand(e,t,i){var c,u,d;const r=this._commands.get(e);if(!r)throw new Error("Unknown command");const{callback:s,thisArg:o,metadata:a}=r;if(a!=null&&a.args)for(let f=0;f<a.args.length;f++)try{Z7(t[f],a.args[f].constraint)}catch{throw new Error(`Running the contributed command: '${e}' failed. Illegal argument '${a.args[f].name}' - ${a.args[f].description}`)}const l=Os.create();try{return await s.apply(o,t)}catch(f){if(e===this.converter.delegatingCommandId){const p=this.converter.getActualCommand(...t);p&&(e=p.command)}if(this._logService.error(f,e,(c=r.extension)==null?void 0:c.identifier),!i)throw f;if((u=r.extension)!=null&&u.identifier){const p=A(this,If).onExtensionError(r.extension.identifier,f);this._logService.trace("forwarded error to extension?",p,(d=r.extension)==null?void 0:d.identifier)}throw new class extends Error{constructor(){var w,v;super(Zu(f)),this.id=e,this.source=((w=r.extension)==null?void 0:w.displayName)??((v=r.extension)==null?void 0:v.name)}}}finally{this._reportTelemetry(r,e,l.elapsed())}}_reportTelemetry(e,t,i){e.extension&&A(this,kf).$publicLog2("Extension:ActionExecuted",{extensionId:e.extension.identifier.value,id:new Rx(t),duration:i})}$executeContributedCommand(e,...t){this._logService.trace("ExtHostCommands#$executeContributedCommand",e);const i=this._commands.get(e);return i?(t=t.map(r=>this._argumentProcessors.reduce((s,o)=>o.processArgument(s,i.extension),r)),this._executeContributedCommand(e,t,!0)):Promise.reject(new Error(`Contributed command '${e}' does not exist.`))}getCommands(e=!1){return this._logService.trace("ExtHostCommands#getCommands",e),A(this,vs).$getCommands().then(t=>(e&&(t=t.filter(i=>i[0]!=="_")),t))}$getContributedCommandMetadata(){const e=Object.create(null);for(const[t,i]of this._commands){const{metadata:r}=i;r&&(e[t]=r)}return Promise.resolve(e)}},vs=new WeakMap,kf=new WeakMap,If=new WeakMap,nI);I0=V([F(0,tt),F(1,ct),F(2,k_)],I0);const Ll=De("IExtHostCommands");class w6{constructor(e,t,i){this._commands=e,this._lookupApiCommand=t,this._logService=i,this.delegatingCommandId=`__vsc${Mn()}`,this._cache=new Map,this._cachIdPool=0,this._commands.registerCommand(!0,this.delegatingCommandId,this._executeConvertedCommand,this)}toInternal(e,t){if(!e)return;const i={$ident:void 0,id:e.command,title:e.title,tooltip:e.tooltip};if(!e.command)return i;const r=this._lookupApiCommand(e.command);if(r)i.id=r.internalId,i.arguments=r.args.map((s,o)=>s.convert(e.arguments&&e.arguments[o]));else if(ju(e.arguments)){const s=`${e.command} /${++this._cachIdPool}`;this._cache.set(s,e),t.add(Se(()=>{this._cache.delete(s),this._logService.trace("CommandsConverter#DISPOSE",s)})),i.$ident=s,i.id=this.delegatingCommandId,i.arguments=[s],this._logService.trace("CommandsConverter#CREATE",e.command,s)}return i}fromInternal(e){return typeof e.$ident=="string"?this._cache.get(e.$ident):{command:e.id,title:e.title,arguments:e.arguments}}getActualCommand(...e){return this._cache.get(e[0])}_executeConvertedCommand(...e){const t=this.getActualCommand(...e);return this._logService.trace("CommandsConverter#EXECUTE",e[0],t?t.command:"MISSING"),t?this._commands.executeCommand(t.command,...t.arguments||[]):Promise.reject(`Actual command not found, wanted to execute ${e[0]}`)}}const Et=class Et{static Arr(e){return new Et(`${e.name}_array`,`Array of ${e.name}, ${e.description}`,t=>Array.isArray(t)&&t.every(i=>e.validate(i)),t=>t.map(i=>e.convert(i)))}constructor(e,t,i,r){this.name=e,this.description=t,this.validate=i,this.convert=r}optional(){return new Et(this.name,`(optional) ${this.description}`,e=>e==null||this.validate(e),e=>e===void 0?void 0:e===null?null:this.convert(e))}with(e,t){return new Et(e??this.name,t??this.description,this.validate,this.convert)}};Et.Uri=new Et("uri","Uri of a text document",e=>y.isUri(e),e=>e),Et.Position=new Et("position","A position in a text document",e=>We.isPosition(e),nt.from),Et.Range=new Et("range","A range in a text document",e=>Oe.isRange(e),W.from),Et.Selection=new Et("selection","A selection in a text document",e=>$s.isSelection(e),pr.from),Et.Number=new Et("number","",e=>typeof e=="number",e=>e),Et.String=new Et("string","",e=>typeof e=="string",e=>e),Et.StringArray=Et.Arr(Et.String),Et.CallHierarchyItem=new Et("item","A call hierarchy item",e=>e instanceof Mx,xl.from),Et.TypeHierarchyItem=new Et("item","A type hierarchy item",e=>e instanceof Hx,Za.from),Et.TestItem=new Et("testItem","A VS Code TestItem",e=>e instanceof Rl,Ro.from),Et.TestProfile=new Et("testProfile","A VS Code test profile",e=>e instanceof XC,Xb.from);let q=Et;const N1=class N1{constructor(e,t){this.description=e,this.convert=t}};N1.Void=new N1("no result",e=>e);let be=N1;class ke{constructor(e,t,i,r,s){this.id=e,this.internalId=t,this.description=i,this.args=r,this.result=s}}const Ku=De("IExtHostTerminalService");class eD extends Te{constructor(e,t,i,r){super(),this._proxy=e,this._id=t,this._creationOptions=i,this._name=r,this._disposed=!1,this._state={isInteractedWith:!1,shell:void 0},this.isOpen=!1,this._onWillDispose=this._register(new L),this.onWillDispose=this._onWillDispose.event,this._creationOptions=Object.freeze(this._creationOptions),this._pidPromise=new Promise(o=>this._pidPromiseComplete=o);const s=this;this.value={get name(){return s._name||""},get processId(){return s._pidPromise},get creationOptions(){return s._creationOptions},get exitStatus(){return s._exitStatus},get state(){return s._state},get selection(){return s._selection},get shellIntegration(){return s.shellIntegration},sendText(o,a=!0){s._checkDisposed(),s._proxy.$sendText(s._id,o,a)},show(o){s._checkDisposed(),s._proxy.$show(s._id,o)},hide(){s._checkDisposed(),s._proxy.$hide(s._id)},dispose(){s._disposed||(s._disposed=!0,s._proxy.$dispose(s._id))},get dimensions(){if(!(s._cols===void 0||s._rows===void 0))return{columns:s._cols,rows:s._rows}}}}dispose(){this._onWillDispose.fire(),super.dispose()}async create(e,t){if(typeof this._id!="string")throw new Error("Terminal has already been created");await this._proxy.$createTerminal(this._id,{name:e.name,shellPath:e.shellPath??void 0,shellArgs:e.shellArgs??void 0,cwd:e.cwd??(t==null?void 0:t.cwd)??void 0,env:e.env??void 0,icon:A5(e.iconPath)??void 0,color:mu.isThemeColor(e.color)?e.color.id:void 0,initialText:e.message??void 0,strictEnv:e.strictEnv??void 0,hideFromUser:e.hideFromUser??void 0,forceShellIntegration:(t==null?void 0:t.forceShellIntegration)??void 0,isFeatureTerminal:(t==null?void 0:t.isFeatureTerminal)??void 0,isExtensionOwnedTerminal:!0,useShellEnvironment:(t==null?void 0:t.useShellEnvironment)??void 0,location:(t==null?void 0:t.location)||this._serializeParentTerminal(e.location,t==null?void 0:t.resolvedExtHostIdentifier),isTransient:e.isTransient??void 0})}async createExtensionTerminal(e,t,i,r,s){if(typeof this._id!="string")throw new Error("Terminal has already been created");if(await this._proxy.$createTerminal(this._id,{name:this._name,isExtensionCustomPtyTerminal:!0,icon:r,color:mu.isThemeColor(s)?s.id:void 0,location:(t==null?void 0:t.location)||this._serializeParentTerminal(e,i),isTransient:!0}),typeof this._id=="string")throw new Error("Terminal creation failed");return this._id}_serializeParentTerminal(e,t){return typeof e=="object"?"parentTerminal"in e&&e.parentTerminal&&t?{parentTerminal:t}:"viewColumn"in e?{viewColumn:nn.from(e.viewColumn),preserveFocus:e.preserveFocus}:void 0:e}_checkDisposed(){if(this._disposed)throw new Error("Terminal has already been disposed")}set name(e){this._name=e}setExitStatus(e,t){this._exitStatus=Object.freeze({code:e,reason:t})}setDimensions(e,t){return e===this._cols&&t===this._rows||e===0||t===0?!1:(this._cols=e,this._rows=t,!0)}setInteractedWith(){return this._state.isInteractedWith?!1:(this._state={...this._state,isInteractedWith:!0},!0)}setShellType(e){return this._state.shell!==e?(this._state={...this._state,shell:e},!0):!1}setSelection(e){this._selection=e}_setProcessId(e){this._pidPromiseComplete?(this._pidPromiseComplete(e),this._pidPromiseComplete=void 0):this._pidPromise.then(t=>{t!==e&&(this._pidPromise=Promise.resolve(e))})}}class hv{get onProcessReady(){return this._onProcessReady.event}constructor(e){this._pty=e,this.id=0,this.shouldPersist=!1,this._onProcessData=new L,this.onProcessData=this._onProcessData.event,this._onProcessReady=new L,this._onDidChangeProperty=new L,this.onDidChangeProperty=this._onDidChangeProperty.event,this._onProcessExit=new L,this.onProcessExit=this._onProcessExit.event}refreshProperty(e){throw new Error(`refreshProperty is not suppported in extension owned terminals. property: ${e}`)}updateProperty(e,t){throw new Error(`updateProperty is not suppported in extension owned terminals. property: ${e}, value: ${t}`)}async start(){}shutdown(){this._pty.close()}input(e){var t,i;(i=(t=this._pty).handleInput)==null||i.call(t,e)}resize(e,t){var i,r;(r=(i=this._pty).setDimensions)==null||r.call(i,{columns:e,rows:t})}clearBuffer(){}async processBinary(e){}acknowledgeDataEvent(e){}async setUnicodeVersion(e){}getInitialCwd(){return Promise.resolve("")}getCwd(){return Promise.resolve("")}startSendingEvents(e){var t,i,r,s,o,a,l,c;this._pty.onDidWrite(u=>this._onProcessData.fire(u)),(i=(t=this._pty).onDidClose)==null||i.call(t,(u=void 0)=>{this._onProcessExit.fire(u===void 0?void 0:u)}),(s=(r=this._pty).onDidOverrideDimensions)==null||s.call(r,u=>{u&&this._onDidChangeProperty.fire({type:zu.OverrideDimensions,value:{cols:u.columns,rows:u.rows}})}),(a=(o=this._pty).onDidChangeName)==null||a.call(o,u=>{this._onDidChangeProperty.fire({type:zu.Title,value:u})}),this._pty.open(e||void 0),e&&((c=(l=this._pty).setDimensions)==null||c.call(l,e)),this._onProcessReady.fire({pid:-1,cwd:"",windowsPty:void 0})}}let b6=1,C0=class extends Te{get activeTerminal(){var e;return(e=this._activeTerminal)==null?void 0:e.value}get terminals(){return this._terminals.map(e=>e.value)}constructor(e,t,i){super(),this._extHostCommands=t,this._terminals=[],this._terminalProcesses=new Map,this._terminalProcessDisposables={},this._extensionTerminalAwaitingStart={},this._getTerminalPromises={},this._environmentVariableCollections=new Map,this._lastQuickFixCommands=this._register(new go),this._linkProviders=new Set,this._completionProviders=new Map,this._profileProviders=new Map,this._quickFixProviders=new Map,this._terminalLinkCache=new Map,this._terminalLinkCancellationSource=new Map,this._onDidCloseTerminal=new L,this.onDidCloseTerminal=this._onDidCloseTerminal.event,this._onDidOpenTerminal=new L,this.onDidOpenTerminal=this._onDidOpenTerminal.event,this._onDidChangeActiveTerminal=new L,this.onDidChangeActiveTerminal=this._onDidChangeActiveTerminal.event,this._onDidChangeTerminalDimensions=new L,this.onDidChangeTerminalDimensions=this._onDidChangeTerminalDimensions.event,this._onDidChangeTerminalState=new L,this.onDidChangeTerminalState=this._onDidChangeTerminalState.event,this._onDidChangeShell=new L,this.onDidChangeShell=this._onDidChangeShell.event,this._onDidWriteTerminalData=new L({onWillAddFirstListener:()=>this._proxy.$startSendingDataEvents(),onDidRemoveLastListener:()=>this._proxy.$stopSendingDataEvents()}),this.onDidWriteTerminalData=this._onDidWriteTerminalData.event,this._onDidExecuteCommand=new L({onWillAddFirstListener:()=>this._proxy.$startSendingCommandEvents(),onDidRemoveLastListener:()=>this._proxy.$stopSendingCommandEvents()}),this.onDidExecuteTerminalCommand=this._onDidExecuteCommand.event,this._proxy=i.getProxy(Z.MainThreadTerminalService),this._bufferer=new g6(this._proxy.$sendProcessData),this._proxy.$registerProcessSupport(e),this._extHostCommands.registerArgumentProcessor({processArgument:r=>{const s=o=>{var l;const a=o;return(l=this.getTerminalById(a.instanceId))==null?void 0:l.value};switch(r==null?void 0:r.$mid){case rt.TerminalContext:return s(r);default:{if(Array.isArray(r))for(let o=0;o<r.length&&r[o].$mid===rt.TerminalContext;o++)r[o]=s(r[o]);return r}}}}),this._register({dispose:()=>{for(const[r,s]of this._terminalProcesses)s.shutdown(!0)}})}getDefaultShell(e){const t=e?this._defaultAutomationProfile:this._defaultProfile;return(t==null?void 0:t.path)||""}getDefaultShellArgs(e){const t=e?this._defaultAutomationProfile:this._defaultProfile;return(t==null?void 0:t.args)||[]}createExtensionTerminal(e,t){const i=new eD(this._proxy,Mn(),e,e.name),r=new hv(e.pty);return i.createExtensionTerminal(e.location,t,this._serializeParentTerminal(e,t).resolvedExtHostIdentifier,A5(e.iconPath),x6(e.color)).then(s=>{const o=this._setupExtHostProcessListeners(s,r);this._terminalProcessDisposables[s]=o}),this._terminals.push(i),i.value}_serializeParentTerminal(e,t){if(t=t||{},e.location&&typeof e.location=="object"&&"parentTerminal"in e.location){const i=e.location.parentTerminal;if(i){const r=this._terminals.find(s=>s.value===i);r&&(t.resolvedExtHostIdentifier=r._id)}}else e.location&&typeof e.location!="object"?t.location=e.location:t.location&&typeof t.location=="object"&&"splitActiveTerminal"in t.location&&(t.location={splitActiveTerminal:!0});return t}attachPtyToTerminal(e,t){if(!this.getTerminalById(e))throw new Error(`Cannot resolve terminal with id ${e} for virtual process`);const r=new hv(t),s=this._setupExtHostProcessListeners(e,r);this._terminalProcessDisposables[e]=s}async $acceptActiveTerminalChanged(e){const t=this._activeTerminal;if(e===null){this._activeTerminal=void 0,t!==this._activeTerminal&&this._onDidChangeActiveTerminal.fire(this._activeTerminal);return}const i=this.getTerminalById(e);i&&(this._activeTerminal=i,t!==this._activeTerminal&&this._onDidChangeActiveTerminal.fire(this._activeTerminal.value))}async $acceptTerminalProcessData(e,t){const i=this.getTerminalById(e);i&&this._onDidWriteTerminalData.fire({terminal:i.value,data:t})}async $acceptTerminalDimensions(e,t,i){const r=this.getTerminalById(e);r&&r.setDimensions(t,i)&&this._onDidChangeTerminalDimensions.fire({terminal:r.value,dimensions:r.value.dimensions})}async $acceptDidExecuteCommand(e,t){const i=this.getTerminalById(e);i&&this._onDidExecuteCommand.fire({terminal:i.value,...t})}async $acceptTerminalMaximumDimensions(e,t,i){var r;(r=this._terminalProcesses.get(e))==null||r.resize(t,i)}async $acceptTerminalTitleChange(e,t){const i=this.getTerminalById(e);i&&(i.name=t)}async $acceptTerminalClosed(e,t,i){const r=this._getTerminalObjectIndexById(this._terminals,e);if(r!==null){const s=this._terminals.splice(r,1)[0];s.setExitStatus(t,i),this._onDidCloseTerminal.fire(s.value)}}$acceptTerminalOpened(e,t,i,r){if(t){const a=this._getTerminalObjectIndexById(this._terminals,t);if(a!==null){this._terminals[a]._id=e,this._onDidOpenTerminal.fire(this.terminals[a]),this._terminals[a].isOpen=!0;return}}const s={name:r.name,shellPath:r.executable,shellArgs:r.args,cwd:typeof r.cwd=="string"?r.cwd:y.revive(r.cwd),env:r.env,hideFromUser:r.hideFromUser},o=new eD(this._proxy,e,s,i);this._terminals.push(o),this._onDidOpenTerminal.fire(o.value),o.isOpen=!0}async $acceptTerminalProcessId(e,t){const i=this.getTerminalById(e);i==null||i._setProcessId(t)}async $startExtensionTerminal(e,t){const i=this.getTerminalById(e);if(!i)return{message:h(2551,"Could not find the terminal with id {0} on the extension host",e)};i.isOpen||await new Promise(s=>{const o=this.onDidOpenTerminal(async a=>{a===i.value&&(o.dispose(),s())})});const r=this._terminalProcesses.get(e);r?r.startSendingEvents(t):this._extensionTerminalAwaitingStart[e]={initialDimensions:t}}_setupExtHostProcessListeners(e,t){const i=new Ie;i.add(t.onProcessReady(s=>this._proxy.$sendProcessReady(e,s.pid,s.cwd,s.windowsPty))),i.add(t.onDidChangeProperty(s=>this._proxy.$sendProcessProperty(e,s))),this._bufferer.startBuffering(e,t.onProcessData),i.add(t.onProcessExit(s=>this._onProcessExit(e,s))),this._terminalProcesses.set(e,t);const r=this._extensionTerminalAwaitingStart[e];return r&&t instanceof hv&&(t.startSendingEvents(r.initialDimensions),delete this._extensionTerminalAwaitingStart[e]),i}$acceptProcessAckDataEvent(e,t){var i;(i=this._terminalProcesses.get(e))==null||i.acknowledgeDataEvent(t)}$acceptProcessInput(e,t){var i;(i=this._terminalProcesses.get(e))==null||i.input(t)}$acceptTerminalInteraction(e){const t=this.getTerminalById(e);t!=null&&t.setInteractedWith()&&this._onDidChangeTerminalState.fire(t.value)}$acceptTerminalSelection(e,t){var i;(i=this.getTerminalById(e))==null||i.setSelection(t)}$acceptProcessResize(e,t,i){var r;try{(r=this._terminalProcesses.get(e))==null||r.resize(t,i)}catch(s){if(s.code!=="EPIPE"&&s.code!=="ERR_IPC_CHANNEL_CLOSED")throw s}}$acceptProcessShutdown(e,t){var i;(i=this._terminalProcesses.get(e))==null||i.shutdown(t)}$acceptProcessRequestInitialCwd(e){var t;(t=this._terminalProcesses.get(e))==null||t.getInitialCwd().then(i=>this._proxy.$sendProcessProperty(e,{type:zu.InitialCwd,value:i}))}$acceptProcessRequestCwd(e){var t;(t=this._terminalProcesses.get(e))==null||t.getCwd().then(i=>this._proxy.$sendProcessProperty(e,{type:zu.Cwd,value:i}))}$acceptProcessRequestLatency(e){return Promise.resolve(e)}registerProfileProvider(e,t,i){if(this._profileProviders.has(t))throw new Error(`Terminal profile provider "${t}" already registered`);return this._profileProviders.set(t,i),this._proxy.$registerProfileProvider(t,e.identifier.value),new je(()=>{this._profileProviders.delete(t),this._proxy.$unregisterProfileProvider(t)})}registerTerminalCompletionProvider(e,t,...i){if(this._completionProviders.has(t.id))throw new Error(`Terminal completion provider "${t.id}" already registered`);return this._completionProviders.set(t.id,t),this._proxy.$registerCompletionProvider(t.id,e.identifier.value,...i),new je(()=>{this._completionProviders.delete(t.id),this._proxy.$unregisterCompletionProvider(t.id)})}async $provideTerminalCompletions(e,t){const i=new Bt().token;if(i.isCancellationRequested||!this.activeTerminal)return;const r=this._completionProviders.get(e);if(!r)return;const s=await r.provideTerminalCompletions(this.activeTerminal,t,i);if(s!=null)return r0.from(s)}$acceptTerminalShellType(e,t){const i=this.getTerminalById(e);i!=null&&i.setShellType(t)&&this._onDidChangeTerminalState.fire(i.value)}registerTerminalQuickFixProvider(e,t,i){if(this._quickFixProviders.has(e))throw new Error(`Terminal quick fix provider "${e}" is already registered`);return this._quickFixProviders.set(e,i),this._proxy.$registerQuickFixProvider(e,t),new je(()=>{this._quickFixProviders.delete(e),this._proxy.$unregisterQuickFixProvider(e)})}async $provideTerminalQuickFixes(e,t){const i=new Bt().token;if(i.isCancellationRequested)return;const r=this._quickFixProviders.get(e);if(!r)return;const s=await r.provideTerminalQuickFixes(t,i);if(s===null||Array.isArray(s)&&s.length===0)return;const o=new Ie;if(this._lastQuickFixCommands.value=o,!Array.isArray(s))return s?e1.from(s,this._extHostCommands.converter,o):void 0;const a=[];for(const l of s){const c=e1.from(l,this._extHostCommands.converter,o);c&&a.push(c)}return a}async $createContributedProfileTerminal(e,t){var s;const i=new Bt().token;let r=await((s=this._profileProviders.get(e))==null?void 0:s.provideTerminalProfile(i));if(!i.isCancellationRequested){if(r&&!("options"in r)&&(r={options:r}),!r||!("options"in r))throw new Error(`No terminal profile options provided for id "${e}"`);if("pty"in r.options){this.createExtensionTerminal(r.options,t);return}this.createTerminalFromOptions(r.options,t)}}registerLinkProvider(e){return this._linkProviders.add(e),this._linkProviders.size===1&&this._proxy.$startLinkProvider(),new je(()=>{this._linkProviders.delete(e),this._linkProviders.size===0&&this._proxy.$stopLinkProvider()})}async $provideLinks(e,t){const i=this.getTerminalById(e);if(!i)return[];this._terminalLinkCache.delete(e);const r=this._terminalLinkCancellationSource.get(e);r==null||r.dispose(!0);const s=new Bt;this._terminalLinkCancellationSource.set(e,s);const o=[],a={terminal:i.value,line:t},l=[];for(const d of this._linkProviders)l.push(fu.withAsyncBody(async f=>{s.token.onCancellationRequested(()=>f({provider:d,links:[]}));const p=await d.provideTerminalLinks(a,s.token)||[];s.token.isCancellationRequested||f({provider:d,links:p})}));const c=await Promise.all(l);if(s.token.isCancellationRequested)return[];const u=new Map;for(const d of c)d&&d.links.length>0&&o.push(...d.links.map(f=>{const p={id:b6++,startIndex:f.startIndex,length:f.length,label:f.tooltip};return u.set(p.id,{provider:d.provider,link:f}),p}));return this._terminalLinkCache.set(e,u),o}$activateLink(e,t){var r;const i=(r=this._terminalLinkCache.get(e))==null?void 0:r.get(t);i&&i.provider.handleTerminalLink(i.link)}_onProcessExit(e,t){this._bufferer.stopBuffering(e),this._terminalProcesses.delete(e),delete this._extensionTerminalAwaitingStart[e];const i=this._terminalProcessDisposables[e];i&&(i.dispose(),delete this._terminalProcessDisposables[e]),this._proxy.$sendProcessExit(e,t)}getTerminalById(e){return this._getTerminalObjectById(this._terminals,e)}getTerminalIdByApiObject(e){const t=this._terminals.findIndex(i=>i.value===e);return t>=0?t:null}_getTerminalObjectById(e,t){const i=this._getTerminalObjectIndexById(e,t);return i!==null?e[i]:null}_getTerminalObjectIndexById(e,t){const i=e.findIndex(r=>r._id===t);return i>=0?i:null}getEnvironmentVariableCollection(e){let t=this._environmentVariableCollections.get(e.identifier.value);return t||(t=this._register(new tD),this._setEnvironmentVariableCollection(e.identifier.value,t)),t.getScopedEnvironmentVariableCollection(void 0)}_syncEnvironmentVariableCollection(e,t){const i=u6(t.map),r=d6(t.descriptionMap);this._proxy.$setEnvironmentVariableCollection(e,t.persistent,i.length===0?void 0:i,r)}$initEnvironmentVariableCollections(e){e.forEach(t=>{const i=t[0],r=this._register(new tD(t[1]));this._setEnvironmentVariableCollection(i,r)})}$acceptDefaultProfile(e,t){const i=this._defaultProfile;this._defaultProfile=e,this._defaultAutomationProfile=t,(i==null?void 0:i.path)!==e.path&&this._onDidChangeShell.fire(e.path)}_setEnvironmentVariableCollection(e,t){this._environmentVariableCollections.set(e,t),this._register(t.onDidChangeCollection(()=>{this._syncEnvironmentVariableCollection(e,t)}))}};C0=V([F(1,Ll),F(2,tt)],C0);class tD extends Te{get persistent(){return this._persistent}set persistent(e){this._persistent=e,this._onDidChangeCollection.fire()}get onDidChangeCollection(){return this._onDidChangeCollection&&this._onDidChangeCollection.event}constructor(e){super(),this.map=new Map,this.scopedCollections=new Map,this.descriptionMap=new Map,this._persistent=!0,this._onDidChangeCollection=new L,this.map=new Map(e)}getScopedEnvironmentVariableCollection(e){const t=this.getScopeKey(e);let i=this.scopedCollections.get(t);return i||(i=new y6(this,e),this.scopedCollections.set(t,i),this._register(i.onDidChangeCollection(()=>this._onDidChangeCollection.fire()))),i}replace(e,t,i,r){this._setIfDiffers(e,{value:t,type:Ic.Replace,options:i??{applyAtProcessCreation:!0},scope:r})}append(e,t,i,r){this._setIfDiffers(e,{value:t,type:Ic.Append,options:i??{applyAtProcessCreation:!0},scope:r})}prepend(e,t,i,r){this._setIfDiffers(e,{value:t,type:Ic.Prepend,options:i??{applyAtProcessCreation:!0},scope:r})}_setIfDiffers(e,t){var o,a,l,c,u,d;if(t.options&&t.options.applyAtProcessCreation===!1&&!t.options.applyAtShellIntegration)throw new Error("EnvironmentVariableMutatorOptions must apply at either process creation or shell integration");const i=this.getKey(e,t.scope),r=this.map.get(i),s=t.options?{applyAtProcessCreation:t.options.applyAtProcessCreation??!1,applyAtShellIntegration:t.options.applyAtShellIntegration??!1}:{applyAtProcessCreation:!0};if(!r||r.value!==t.value||r.type!==t.type||((o=r.options)==null?void 0:o.applyAtProcessCreation)!==s.applyAtProcessCreation||((a=r.options)==null?void 0:a.applyAtShellIntegration)!==s.applyAtShellIntegration||((c=(l=r.scope)==null?void 0:l.workspaceFolder)==null?void 0:c.index)!==((d=(u=t.scope)==null?void 0:u.workspaceFolder)==null?void 0:d.index)){const f=this.getKey(e,t.scope),p={variable:e,...t,options:s};this.map.set(f,p),this._onDidChangeCollection.fire()}}get(e,t){const i=this.getKey(e,t),r=this.map.get(i);return r?nD(r):void 0}getKey(e,t){const i=this.getScopeKey(t);return i.length?`${e}:::${i}`:e}getScopeKey(e){return this.getWorkspaceKey(e==null?void 0:e.workspaceFolder)??""}getWorkspaceKey(e){return e?e.uri.toString():void 0}getVariableMap(e){const t=new Map;for(const[i,r]of this.map)this.getScopeKey(r.scope)===this.getScopeKey(e)&&t.set(r.variable,nD(r));return t}delete(e,t){const i=this.getKey(e,t);this.map.delete(i),this._onDidChangeCollection.fire()}clear(e){var t,i;if(e!=null&&e.workspaceFolder){for(const[r,s]of this.map)((i=(t=s.scope)==null?void 0:t.workspaceFolder)==null?void 0:i.index)===e.workspaceFolder.index&&this.map.delete(r);this.clearDescription(e)}else this.map.clear(),this.descriptionMap.clear();this._onDidChangeCollection.fire()}setDescription(e,t){const i=this.getScopeKey(t),r=this.descriptionMap.get(i);if(!r||r.description!==e){let s;typeof e=="string"?s=e:s=e==null?void 0:e.value.split(`

`)[0];const o={description:s,scope:t};this.descriptionMap.set(i,o),this._onDidChangeCollection.fire()}}getDescription(e){var i;const t=this.getScopeKey(e);return(i=this.descriptionMap.get(t))==null?void 0:i.description}clearDescription(e){const t=this.getScopeKey(e);this.descriptionMap.delete(t)}}class y6{get persistent(){return this.collection.persistent}set persistent(e){this.collection.persistent=e}get onDidChangeCollection(){return this._onDidChangeCollection&&this._onDidChangeCollection.event}constructor(e,t){this.collection=e,this.scope=t,this._onDidChangeCollection=new L}getScoped(e){return this.collection.getScopedEnvironmentVariableCollection(e)}replace(e,t,i){this.collection.replace(e,t,i,this.scope)}append(e,t,i){this.collection.append(e,t,i,this.scope)}prepend(e,t,i){this.collection.prepend(e,t,i,this.scope)}get(e){return this.collection.get(e,this.scope)}forEach(e,t){this.collection.getVariableMap(this.scope).forEach((i,r)=>e.call(t,r,i,this),this.scope)}[Symbol.iterator](){return this.collection.getVariableMap(this.scope).entries()}delete(e){this.collection.delete(e,this.scope),this._onDidChangeCollection.fire(void 0)}clear(){this.collection.clear(this.scope)}set description(e){this.collection.setDescription(e,this.scope)}get description(){return this.collection.getDescription(this.scope)}}let P0=class extends C0{constructor(e,t){super(!1,e,t)}createTerminal(e,t,i){throw new Nv}createTerminalFromOptions(e,t){throw new Nv}};P0=V([F(0,Ll),F(1,tt)],P0);function A5(n){if(!(!n||typeof n=="string"))return"id"in n?{id:n.id,color:n.color}:n}function x6(n){return mu.isThemeColor(n)?n:void 0}function nD(n){const e={...n};return delete e.scope,e.options=e.options??void 0,delete e.variable,e}const R5="__",Zx=De("IExtHostAuthentication");let T0=class{constructor(e){this._authenticationProviders=new Map,this._onDidChangeSessions=new L,this._getSessionTaskSingler=new E6,this._proxy=e.getProxy(Z.MainThreadAuthentication)}getExtensionScopedSessionsEvent(e){const t=e.toLowerCase();return Ht.chain(this._onDidChangeSessions.event,i=>i.filter(r=>!r.extensionIdFilter||r.extensionIdFilter.includes(t)).map(r=>({provider:r.provider})))}async getSession(e,t,i,r={}){const s=Ke.toKey(e.identifier),o=[...i].sort().join(" "),l=Object.keys(r).sort().map(c=>`${c}:${!!r[c]}`).join(", ");return await this._getSessionTaskSingler.getOrCreate(`${s} ${t} ${o} ${l}`,async()=>{await this._proxy.$ensureProvider(t);const c=e.displayName||e.name;return this._proxy.$getSession(t,i,s,c,r)})}async getAccounts(e){return await this._proxy.$ensureProvider(e),await this._proxy.$getAccounts(e)}async removeSession(e,t){const i=this._authenticationProviders.get(e);return i?i.provider.removeSession(t):this._proxy.$removeSession(e,t)}registerAuthenticationProvider(e,t,i,r){if(this._authenticationProviders.get(e))throw new Error(`An authentication provider with id '${e}' is already registered.`);this._authenticationProviders.set(e,{label:t,provider:i,options:r??{supportsMultipleAccounts:!1}});const s=i.onDidChangeSessions(o=>this._proxy.$sendDidChangeSessions(e,o));return this._proxy.$registerAuthenticationProvider(e,t,(r==null?void 0:r.supportsMultipleAccounts)??!1),new je(()=>{s.dispose(),this._authenticationProviders.delete(e),this._proxy.$unregisterAuthenticationProvider(e)})}async $createSession(e,t,i){const r=this._authenticationProviders.get(e);if(r)return await r.provider.createSession(t,i);throw new Error(`Unable to find authentication provider with handle: ${e}`)}async $removeSession(e,t){const i=this._authenticationProviders.get(e);if(i)return await i.provider.removeSession(t);throw new Error(`Unable to find authentication provider with handle: ${e}`)}async $getSessions(e,t,i){const r=this._authenticationProviders.get(e);if(r)return await r.provider.getSessions(t,i);throw new Error(`Unable to find authentication provider with handle: ${e}`)}$onDidChangeAuthenticationSessions(e,t,i){return e.startsWith(R5)||this._onDidChangeSessions.fire({provider:{id:e,label:t},extensionIdFilter:i}),Promise.resolve()}};T0=V([F(0,tt)],T0);class E6{constructor(){this._inFlightPromises=new Map}getOrCreate(e,t){const i=this._inFlightPromises.get(e);if(i)return i;const r=t().finally(()=>this._inFlightPromises.delete(e));return this._inFlightPromises.set(e,r),r}}var Wp;const Kx=De("IExtHostLanguageModels");class iD{constructor(e,t){this.option=e,this.stream=new Xv,this.stream=t??new Xv}}class S6{constructor(){this._responseStreams=new Map,this._defaultStream=new Xv,this._isDone=!1;const e=this;this.apiObject={get stream(){return e._defaultStream.asyncIterable},get text(){return pl.map(e._defaultStream.asyncIterable,t=>{if(t instanceof jt)return t.value}).coalesce()}}}*_streams(){if(this._responseStreams.size>0)for(const[,e]of this._responseStreams)yield e.stream;else yield this._defaultStream}handleFragment(e){if(this._isDone)return;let t=this._responseStreams.get(e.index);t||(this._responseStreams.size===0?t=new iD(e.index,this._defaultStream):t=new iD(e.index),this._responseStreams.set(e.index,t));let i;e.part.type==="text"?i=new jt(e.part.value):i=new bl(e.part.toolCallId,e.part.name,e.part.parameters),t.stream.emitOne(i)}reject(e){this._isDone=!0;for(const t of this._streams())t.reject(e)}resolve(){this._isDone=!0;for(const e of this._streams())e.resolve()}}var ol;let A0=(ol=class{constructor(e,t,i){this._logService=t,this._extHostAuthentication=i,this._onDidChangeModelAccess=new L,this._onDidChangeProviders=new L,this.onDidChangeProviders=this._onDidChangeProviders.event,this._languageModels=new Map,this._allLanguageModelData=new Map,this._modelAccessList=new Ms,this._pendingRequest=new Map,this._ignoredFileProviders=new Map,this._languageAccessInformationExtensions=new Set,this._proxy=e.getProxy(Z.MainThreadLanguageModels)}dispose(){this._onDidChangeModelAccess.dispose(),this._onDidChangeProviders.dispose()}registerLanguageModel(e,t,i,r){var l;const s=Wp._idPool++;this._languageModels.set(s,{extension:e.identifier,provider:i,languageModelId:t});let o;r.auth&&(o={providerLabel:e.displayName||e.name,accountLabel:typeof r.auth=="object"?r.auth.label:void 0}),this._proxy.$registerLanguageModelProvider(s,`${Ke.toKey(e.identifier)}/${t}`,{extension:e.identifier,id:t,vendor:r.vendor??Ke.toKey(e.identifier),name:r.name??"",family:r.family??"",version:r.version,maxInputTokens:r.maxInputTokens,maxOutputTokens:r.maxOutputTokens,auth:o,targetExtensions:r.extensions,isDefault:r.isDefault,isUserSelectable:r.isUserSelectable,capabilities:r.capabilities});const a=(l=i.onDidReceiveLanguageModelResponse2)==null?void 0:l.call(i,({extensionId:c,participant:u,tokenCount:d})=>{this._proxy.$whenLanguageModelChatRequestMade(t,new Ke(c),u,d)});return Se(()=>{this._languageModels.delete(s),this._proxy.$unregisterProvider(s),a==null||a.dispose()})}async $startChatRequest(e,t,i,r,s,o){const a=this._languageModels.get(e);if(!a)throw new Error("Provider not found");const l=new Dg(async u=>{if(o.isCancellationRequested){this._logService.warn(`[CHAT](${a.extension.value}) CANNOT send progress because the REQUEST IS CANCELLED`);return}let d;if(u.part instanceof bl?d={type:"tool_use",name:u.part.name,parameters:u.part.input,toolCallId:u.part.callId}:u.part instanceof jt&&(d={type:"text",value:u.part.value}),!d){this._logService.warn(`[CHAT](${a.extension.value}) UNKNOWN part ${JSON.stringify(u)}`);return}this._proxy.$reportResponsePart(t,{index:u.index,part:d})});let c;try{a.provider.provideLanguageModelResponse2?c=a.provider.provideLanguageModelResponse2(r.value.map(ac.to),s,Ke.toKey(i),l,o):c=a.provider.provideLanguageModelResponse(r.value.map(ac.to),s,Ke.toKey(i),l,o)}catch(u){throw u}Promise.resolve(c).then(()=>{this._proxy.$reportResponseDone(t,void 0)},u=>{this._proxy.$reportResponseDone(t,lu(u))})}$provideTokenLength(e,t,i){const r=this._languageModels.get(e);return r?Promise.resolve(r.provider.provideTokenCount(t,i)):Promise.resolve(0)}$acceptChatModelMetadata(e){var t;if(e.added)for(const{identifier:i,metadata:r}of e.added)this._allLanguageModelData.set(i,{metadata:r,apiObjects:new Ms});if(e.removed)for(const i of e.removed){this._allLanguageModelData.delete(i);for(const[r,s]of this._pendingRequest)s.languageModelId===i&&(s.res.reject(new qr),this._pendingRequest.delete(r))}(t=e.added)==null||t.forEach(i=>this._fakeAuthPopulate(i.metadata)),this._onDidChangeProviders.fire(void 0)}async getDefaultLanguageModel(e){var i;const t=(i=zn.find(this._allLanguageModelData.entries(),([,r])=>!!r.metadata.isDefault))==null?void 0:i[0];if(t)return this.getLanguageModelByIdentifier(e,t)}async getLanguageModelByIdentifier(e,t){var s,o;const i=this._allLanguageModelData.get(t);if(!i)return;this._isUsingAuth(e.identifier,i.metadata)&&await this._fakeAuthPopulate(i.metadata);let r=i.apiObjects.get(e.identifier);if(!r){const a=this;r={id:i.metadata.id,vendor:i.metadata.vendor,family:i.metadata.family,version:i.metadata.version,name:i.metadata.name,capabilities:{supportsImageToText:((s=i.metadata.capabilities)==null?void 0:s.vision)??!1,supportsToolCalling:((o=i.metadata.capabilities)==null?void 0:o.toolCalling)??!1},maxInputTokens:i.metadata.maxInputTokens,countTokens(l,c){if(!a._allLanguageModelData.has(t))throw nr.NotFound(t);return a._computeTokenLength(t,l,c??Pt.None)},sendRequest(l,c,u){if(!a._allLanguageModelData.has(t))throw nr.NotFound(t);return a._sendChatRequest(e,t,l,c??{},u??Pt.None)}},i.apiObjects.set(e.identifier,r)}return r}async selectLanguageModels(e,t){const i=await this._proxy.$selectChatModels({...t,extension:e.identifier}),r=[];for(const s of i){const o=await this.getLanguageModelByIdentifier(e,s);o&&r.push(o)}return r}async _sendChatRequest(e,t,i,r,s){var d,f;const o=this._convertMessages(e,i),a=e.identifier,l=(d=this._allLanguageModelData.get(t))==null?void 0:d.metadata;if(!l||!this._allLanguageModelData.has(t))throw nr.NotFound(`Language model '${t}' is unknown.`);if(this._isUsingAuth(a,l)&&(!await this._getAuthAccess(e,{identifier:l.extension,displayName:l.auth.providerLabel},r.justification,!1)||!((f=this._modelAccessList.get(a))!=null&&f.has(l.extension))))throw nr.NoPermissions(`Language model '${t}' cannot be used by '${a.value}'.`);const c=Math.random()*1e6|0,u=new S6;this._pendingRequest.set(c,{languageModelId:t,res:u});try{await this._proxy.$tryStartChatRequest(a,t,c,new hi(o),r,s)}catch(p){throw this._pendingRequest.delete(c),nr.tryDeserialize(p)??p}return u.apiObject}_convertMessages(e,t){const i=[];for(const r of t)r.role===ui.System&&$(e,"languageModelSystem"),i.push(ac.from(r));return i}async $acceptResponsePart(e,t){const i=this._pendingRequest.get(e);i&&i.res.handleFragment(t)}async $acceptResponseDone(e,t){const i=this._pendingRequest.get(e);i&&(this._pendingRequest.delete(e),t?i.res.reject(nr.tryDeserialize(t)??rI(t)):i.res.resolve())}async _getAuthAccess(e,t,i,r){const s=R5+t.identifier.value;if(await this._extHostAuthentication.getSession(e,s,[],{silent:!0}))return this.$updateModelAccesslist([{from:e.identifier,to:t.identifier,enabled:!0}]),!0;if(r)return!1;try{const a=i?h(2542,"Justification: {1}",t.displayName,i):void 0;return await this._extHostAuthentication.getSession(e,s,[],{forceNewSession:{detail:a}}),this.$updateModelAccesslist([{from:e.identifier,to:t.identifier,enabled:!0}]),!0}catch{return!1}}_isUsingAuth(e,t){return!!t.auth&&!Ke.equals(t.extension,e)}async _fakeAuthPopulate(e){if(e.auth)for(const t of this._languageAccessInformationExtensions)try{await this._getAuthAccess(t,{identifier:e.extension,displayName:""},void 0,!0)}catch(i){this._logService.error("Fake Auth request failed"),this._logService.error(i)}}async _computeTokenLength(e,t,i){if(!this._allLanguageModelData.get(e))throw nr.NotFound(`Language model '${e}' is unknown.`);const s=zn.find(this._languageModels.values(),o=>o.languageModelId===e);return s?s.provider.provideTokenCount(t,i):this._proxy.$countTokens(e,typeof t=="string"?t:ac.from(t),i)}$updateModelAccesslist(e){const t=new Array;for(const{from:i,to:r,enabled:s}of e){const o=this._modelAccessList.get(i)??new Dl;if(o.has(r)!==s){s?o.add(r):o.delete(r),this._modelAccessList.set(i,o);const l={from:i,to:r};t.push(l),this._onDidChangeModelAccess.fire(l)}}}createLanguageModelAccessInformation(e){this._languageAccessInformationExtensions.add(e);const t=this,i=Ht.signal(Ht.filter(this._onDidChangeModelAccess.event,s=>Ke.equals(s.from,e.identifier))),r=Ht.signal(this._onDidChangeProviders.event);return{get onDidChange(){return Ht.any(i,r)},canSendRequest(s){let o;e:for(const[l,c]of t._allLanguageModelData)for(const u of c.apiObjects.values())if(u===s){o=c.metadata;break e}if(!o)return;if(!t._isUsingAuth(e.identifier,o))return!0;const a=t._modelAccessList.get(e.identifier);if(a)return a.has(o.extension)}}}fileIsIgnored(e,t,i){return $(e,"chatParticipantAdditions"),this._proxy.$fileIsIgnored(t,i)}async $isFileIgnored(e,t,i){const r=this._ignoredFileProviders.get(e);if(!r)throw new Error("Unknown LanguageModelIgnoredFileProvider");return await r.provideFileIgnored(y.revive(t),i)??!1}registerIgnoredFileProvider(e,t){$(e,"chatParticipantPrivate");const i=Wp._idPool++;return this._proxy.$registerFileIgnoreProvider(i),this._ignoredFileProviders.set(i,t),Se(()=>{this._proxy.$unregisterFileIgnoreProvider(i),this._ignoredFileProviders.delete(i)})}},Wp=ol,ol._idPool=1,ol);A0=Wp=V([F(0,tt),F(1,ct),F(2,Zx)],A0);function pd(n,e=ni){return w9(n,e)?n.charAt(0).toUpperCase()+n.slice(1):n}function D6(n,e){return n.replace(/^~($|\/|\\)/,`${e}$1`)}var rD;(function(n){n[n.TEXT=0]="TEXT",n[n.VARIABLE=1]="VARIABLE",n[n.SEPARATOR=2]="SEPARATOR"})(rD||(rD={}));function k6(n){return n.getFullYear()+"-"+String(n.getMonth()+1).padStart(2,"0")+"-"+String(n.getDate()).padStart(2,"0")+"T"+String(n.getHours()).padStart(2,"0")+":"+String(n.getMinutes()).padStart(2,"0")+":"+String(n.getSeconds()).padStart(2,"0")+"."+(n.getMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}const I6={DateTimeFormat(n,e){try{return new Intl.DateTimeFormat(n,e)}catch{return new Intl.DateTimeFormat(void 0,e)}},Collator(n,e){try{return new Intl.Collator(n,e)}catch{return new Intl.Collator(void 0,e)}},Segmenter(n,e){try{return new Intl.Segmenter(n,e)}catch{return new Intl.Segmenter(void 0,e)}},Locale(n,e){try{return new Intl.Locale(n,e)}catch{return new Intl.Locale(mo,e)}}};class I_{constructor(e){const t=V2(e);this._defaultValue=t,this._asciiMap=I_._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){const t=new Uint8Array(256);return t.fill(e),t}set(e,t){const i=V2(t);e>=0&&e<256?this._asciiMap[e]=i:this._map.set(e,i)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}}var sD;(function(n){n[n.False=0]="False",n[n.True=1]="True"})(sD||(sD={}));var Mr;(function(n){n[n.Regular=0]="Regular",n[n.Whitespace=1]="Whitespace",n[n.WordSeparator=2]="WordSeparator"})(Mr||(Mr={}));class C6 extends I_{constructor(e,t){super(Mr.Regular),this._segmenter=null,this._cachedLine=null,this._cachedSegments=[],this.intlSegmenterLocales=t,this.intlSegmenterLocales.length>0?this._segmenter=I6.Segmenter(this.intlSegmenterLocales,{granularity:"word"}):this._segmenter=null;for(let i=0,r=e.length;i<r;i++)this.set(e.charCodeAt(i),Mr.WordSeparator);this.set(P.Space,Mr.Whitespace),this.set(P.Tab,Mr.Whitespace)}findPrevIntlWordBeforeOrAtOffset(e,t){let i=null;for(const r of this._getIntlSegmenterWordsOnLine(e)){if(r.index>t)break;i=r}return i}findNextIntlWordAtOrAfterOffset(e,t){for(const i of this._getIntlSegmenterWordsOnLine(e))if(!(i.index<t))return i;return null}_getIntlSegmenterWordsOnLine(e){return this._segmenter?this._cachedLine===e?this._cachedSegments:(this._cachedLine=e,this._cachedSegments=this._filterWordSegments(this._segmenter.segment(e)),this._cachedSegments):[]}_filterWordSegments(e){const t=[];for(const i of e)this._isWordLike(i)&&t.push(i);return t}_isWordLike(e){return!!e.isWordLike}}const oD=new ax(10);function P6(n,e){const t=`${n}/${e.join(",")}`;let i=oD.get(t);return i||(i=new C6(n,e),oD.set(t,i)),i}class aD{constructor(e,t,i,r){this.searchString=e,this.isRegex=t,this.matchCase=i,this.wordSeparators=r}parseSearchRequest(){if(this.searchString==="")return null;let e;this.isRegex?e=L5(this.searchString):e=this.searchString.indexOf(`
`)>=0;let t=null;try{t=r9(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch{return null}if(!t)return null;let i=!this.isRegex&&!e;return i&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(i=this.matchCase),new TA(t,this.wordSeparators?P6(this.wordSeparators,[]):null,i?this.searchString:null)}}function L5(n){if(!n||n.length===0)return!1;for(let e=0,t=n.length;e<t;e++){const i=n.charCodeAt(e);if(i===P.LineFeed)return!0;if(i===P.Backslash){if(e++,e>=t)break;const r=n.charCodeAt(e);if(r===P.n||r===P.r||r===P.W)return!0}}return!1}function lD(n,e,t){if(!t)return new hw(n,null);const i=[];for(let r=0,s=e.length;r<s;r++)i[r]=e[r];return new hw(n,i)}function T6(n,e,t,i,r){if(i===0)return!0;const s=e.charCodeAt(i-1);if(n.get(s)!==Mr.Regular||s===P.CarriageReturn||s===P.LineFeed)return!0;if(r>0){const o=e.charCodeAt(i);if(n.get(o)!==Mr.Regular)return!0}return!1}function A6(n,e,t,i,r){if(i+r===t)return!0;const s=e.charCodeAt(i+r);if(n.get(s)!==Mr.Regular||s===P.CarriageReturn||s===P.LineFeed)return!0;if(r>0){const o=e.charCodeAt(i+r-1);if(n.get(o)!==Mr.Regular)return!0}return!1}function N5(n,e,t,i,r){return T6(n,e,t,i,r)&&A6(n,e,t,i,r)}class R6{constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){const t=e.length;let i;do{if(this._prevMatchStartIndex+this._prevMatchLength===t||(i=this._searchRegex.exec(e),!i))return null;const r=i.index,s=i[0].length;if(r===this._prevMatchStartIndex&&s===this._prevMatchLength){if(s===0){RI(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=r,this._prevMatchLength=s,!this._wordSeparators||N5(this._wordSeparators,e,t,r,s))return i}while(i);return null}}const O5=De("IUriIdentityService"),e2=De("contextService"),F5=De("editorGroupsService"),L6=De("pathService");function N6(n){return typeof n=="object"&&"uri"in n&&"pattern"in n}let cD=class{constructor(e,t,i,r,s,o){this.configurationService=e,this.workspaceContextService=t,this.editorGroupsService=i,this.logService=r,this.pathService=s,this.uriIdentityService=o}aiText(e,t,i={}){return{...this.commonQuery(t==null?void 0:t.map(rv),i),type:tl.aiText,contentPattern:e}}text(e,t,i={}){e=this.getContentPattern(e,i);const r=this.configurationService.getValue(),s=t&&t.some(a=>!this.configurationService.getValue({resource:a}).search.useRipgrep);return{...this.commonQuery(t==null?void 0:t.map(rv),i),type:tl.Text,contentPattern:e,previewOptions:i.previewOptions,maxFileSize:i.maxFileSize,usePCRE2:r.search.usePCRE2||s||!1,surroundingContext:i.surroundingContext,userDisabledExcludesAndIgnoreFiles:i.disregardExcludeSettings&&i.disregardIgnoreFiles}}getContentPattern(e,t){var s,o,a,l;const i=this.configurationService.getValue();e.isRegExp&&(e.pattern=e.pattern.replace(/\r?\n/g,"\\n"));const r={...e,wordSeparators:i.editor.wordSeparators};return this.isCaseSensitive(e,t)&&(r.isCaseSensitive=!0),this.isMultiline(e)&&(r.isMultiline=!0),(s=t.notebookSearchConfig)!=null&&s.includeMarkupInput&&(r.notebookInfo||(r.notebookInfo={}),r.notebookInfo.isInNotebookMarkdownInput=t.notebookSearchConfig.includeMarkupInput),(o=t.notebookSearchConfig)!=null&&o.includeMarkupPreview&&(r.notebookInfo||(r.notebookInfo={}),r.notebookInfo.isInNotebookMarkdownPreview=t.notebookSearchConfig.includeMarkupPreview),(a=t.notebookSearchConfig)!=null&&a.includeCodeInput&&(r.notebookInfo||(r.notebookInfo={}),r.notebookInfo.isInNotebookCellInput=t.notebookSearchConfig.includeCodeInput),(l=t.notebookSearchConfig)!=null&&l.includeOutput&&(r.notebookInfo||(r.notebookInfo={}),r.notebookInfo.isInNotebookCellOutput=t.notebookSearchConfig.includeOutput),r}file(e,t={}){return{...this.commonQuery(e,t),type:tl.File,filePattern:t.filePattern?t.filePattern.trim():t.filePattern,exists:t.exists,sortByScore:t.sortByScore,cacheKey:t.cacheKey,shouldGlobMatchFilePattern:t.shouldGlobSearch}}handleIncludeExclude(e,t){if(!e)return{};if(Array.isArray(e)){if(e=e.filter(i=>i.length>0).map(Vp),!e.length)return{}}else e=Vp(e);return t?this.parseSearchPaths(e):{pattern:fv(...Array.isArray(e)?e:[e])}}commonQuery(e=[],t={}){let i=Array.isArray(t.excludePattern)?t.excludePattern.map(u=>u.pattern).flat():t.excludePattern;i=(i==null?void 0:i.length)===1?i[0]:i;const r=this.handleIncludeExclude(t.includePattern,t.expandPatterns),s=this.handleIncludeExclude(i,t.expandPatterns),o=e.length>1,a=(r.searchPaths&&r.searchPaths.length?r.searchPaths.map(u=>this.getFolderQueryForSearchPath(u,t,s)):e.map(u=>this.getFolderQueryForRoot(u,t,s,o))).filter(u=>!!u),l={_reason:t._reason,folderQueries:a,usingSearchPaths:!!(r.searchPaths&&r.searchPaths.length),extraFileResources:t.extraFileResources,excludePattern:s.pattern,includePattern:r.pattern,onlyOpenEditors:t.onlyOpenEditors,maxResults:t.maxResults,onlyFileScheme:t.onlyFileScheme};if(t.onlyOpenEditors){const u=sn(this.editorGroupsService.groups.flatMap(p=>p.editors.map(w=>w.resource)));this.logService.trace("QueryBuilder#commonQuery - openEditor URIs",JSON.stringify(u));const d=u.filter(p=>S4(l,p.fsPath)),f=this.commonQueryFromFileList(d);return this.logService.trace("QueryBuilder#commonQuery - openEditor Query",JSON.stringify(f)),{...l,...f}}const c=t.extraFileResources&&t.extraFileResources.filter(u=>S4(l,u.fsPath));return l.extraFileResources=c&&c.length?c:void 0,l}commonQueryFromFileList(e){const t=[],i=new on,r={};let s=!1;return e.forEach(o=>{var l;if(o.scheme===oe.walkThrough)return;if(T9(o)){const c=((l=this.workspaceContextService.getWorkspaceFolder(o))==null?void 0:l.uri)??this.uriIdentityService.extUri.dirname(o);let u=i.get(c);u||(s=!0,u={folder:c,includePattern:{}},t.push(u),i.set(c,u));const d=gh(c.fsPath,o.fsPath);cu(u.includePattern)[d.replace(/\\/g,"/")]=!0}else o.fsPath&&(s=!0,r[o.fsPath]=!0)}),{folderQueries:t,includePattern:r,usingSearchPaths:!0,excludePattern:s?void 0:{"**/*":!0}}}isCaseSensitive(e,t){if(t.isSmartCase){if(e.isRegExp){if(Q2(e.pattern,!0))return!0}else if(Q2(e.pattern))return!0}return!!e.isCaseSensitive}isMultiline(e){return e.isMultiline||e.isRegExp&&L5(e.pattern)||e.pattern.indexOf(`
`)>=0?!0:!!e.isMultiline}parseSearchPaths(e){const t=d=>ng(d)||/^\.\.?([\/\\]|$)/.test(d),r=(Array.isArray(e)?e:F6(e)).map(d=>{const f=this.pathService.resolvedUserHome;return f?D6(d,f.scheme===oe.file?f.fsPath:f.path):d}),s=oI(r,d=>t(d)?"searchPaths":"exprSegments"),o=(s.exprSegments||[]).map(d=>qv(d,"/")).map(d=>qv(d,"\\")).map(d=>(d[0]==="."&&(d="*"+d),M6(d))),a={},l=this.expandSearchPathPatterns(s.searchPaths||[]);l&&l.length&&(a.searchPaths=l);const c=o.flat(),u=fv(...c);return u&&(a.pattern=u),a}getExcludesForFolder(e,t){return t.disregardExcludeSettings?void 0:L3(e,!t.disregardSearchExcludeSettings)}expandSearchPathPatterns(e){if(!e||!e.length)return[];const t=e.flatMap(r=>{let{pathPortion:s,globPortion:o}=O6(r);return o&&(o=pv(o)),this.expandOneSearchPath(s).flatMap(l=>this.resolveOneSearchPathPattern(l,o))}),i=new Map;return t.forEach(r=>{const s=r.searchPath.toString(),o=i.get(s);o?r.pattern&&(o.pattern=o.pattern||{},o.pattern[r.pattern]=!0):i.set(s,{searchPath:r.searchPath,pattern:r.pattern?fv(r.pattern):void 0})}),Array.from(i.values())}expandOneSearchPath(e){if(ng(e)){const t=this.workspaceContextService.getWorkspace().folders;return t[0]&&t[0].uri.scheme!==oe.file?[{searchPath:t[0].uri.with({path:e})}]:[{searchPath:y.file(hu(e))}]}if(this.workspaceContextService.getWorkbenchState()===ug.FOLDER){const t=this.workspaceContextService.getWorkspace().folders[0].uri;if(e=Vp(e),e.startsWith("../")||e===".."){const r=ot.resolve(t.path,e);return[{searchPath:t.with({path:r})}]}const i=pv(e);return[{searchPath:t,pattern:i}]}else{if(e==="./"||e===".\\")return[];{const t=e.replace(/^\.[\/\\]/,""),r=this.workspaceContextService.getWorkspace().folders.map(s=>{const o=t.match(new RegExp(`^${hl(s.name)}(?:/(.*)|$)`));return o?{match:o,folder:s}:null}).filter(Ui);if(r.length)return r.map(s=>{const o=s.match[1];return{searchPath:s.folder.uri,pattern:o&&pv(o)}});{const s=e.match(/\.[\/\\](.+)[\/\\]?/),o=s?s[1]:e,a=h(12426,"Workspace folder does not exist: {0}",o);throw new Error(a)}}}}resolveOneSearchPathPattern(e,t){const i=e.pattern&&t?`${e.pattern}/${t}`:e.pattern||t,r=[{searchPath:e.searchPath,pattern:i}];return i&&!i.endsWith("**")&&r.push({searchPath:e.searchPath,pattern:i+"/**"}),r}getFolderQueryForSearchPath(e,t,i){const r=this.getFolderQueryForRoot(rv(e.searchPath),t,i,!1);return r?{...r,includePattern:e.pattern}:null}getFolderQueryForRoot(e,t,i,r){var p,w,v,m,x;let s;const o=y.isUri(e)?e:e.uri;let a=(p=t.excludePattern)==null?void 0:p.map(k=>{const D=t.excludePattern&&N6(k)?k.uri:void 0;return!D||!(y.isUri(e)&&this.uriIdentityService.extUri.isEqual(e,D))?D:void 0});if(a!=null&&a.length||(a=[void 0]),i.searchPaths){const k=i.searchPaths.filter(D=>Dc(D.searchPath,o))[0];if(k&&!k.pattern)return null;k&&(s=k.pattern)}const l=this.configurationService.getValue({resource:o}),u={...this.getExcludesForFolder(l,t)||{},...s||{}},d=y.isUri(e)?Lo(e):e.name,f=a.map(k=>Object.keys(u).length>0?{folder:k,pattern:u}:void 0).filter(k=>k);return{folder:o,folderName:r?d:void 0,excludePattern:f,fileEncoding:l.files&&l.files.encoding,disregardIgnoreFiles:typeof t.disregardIgnoreFiles=="boolean"?t.disregardIgnoreFiles:!((w=l.search)!=null&&w.useIgnoreFiles),disregardGlobalIgnoreFiles:typeof t.disregardGlobalIgnoreFiles=="boolean"?t.disregardGlobalIgnoreFiles:!((v=l.search)!=null&&v.useGlobalIgnoreFiles),disregardParentIgnoreFiles:typeof t.disregardParentIgnoreFiles=="boolean"?t.disregardParentIgnoreFiles:!((m=l.search)!=null&&m.useParentIgnoreFiles),ignoreSymlinks:typeof t.ignoreSymlinks=="boolean"?t.ignoreSymlinks:!((x=l.search)!=null&&x.followSymlinks)}}};cD=V([F(0,D_),F(1,e2),F(2,F5),F(3,ct),F(4,L6),F(5,O5)],cD);function O6(n){const e=n.match(/[\*\{\}\(\)\[\]\?]/);if(e){const t=e.index,i=n.substr(0,t).match(/[/|\\][^/\\]*$/);if(i){let r=n.substr(0,i.index);return r.match(/[/\\]/)||(r+="/"),{pathPortion:r,globPortion:n.substr((i.index||0)+1)}}}return{pathPortion:n}}function fv(...n){return n.length?n.reduce((e,t)=>(e[t]=!0,e),Object.create(null)):void 0}function F6(n){return vw(n,",").map(e=>e.trim()).filter(e=>!!e.length)}function M6(n){return[`**/${n}/**`,`**/${n}`].map(t=>t.replace(/\*\*\/\*\*/g,"**"))}function Vp(n){return n.replace(/\\/g,"/")}function pv(n){return Vp(n).replace(/^\.\//,"").replace(/\/+$/g,"")}De("searchService");const $6=7e3;function U6(n,e){const t=e.activationEvents;if(!t)return Promise.resolve(void 0);const i=[],r=[];for(const u of t)if(/^workspaceContains:/.test(u)){const d=u.substr(18);d.indexOf("*")>=0||d.indexOf("?")>=0||n.forceUsingSearch?r.push(d):i.push(d)}if(i.length===0&&r.length===0)return Promise.resolve(void 0);const{promise:s,resolve:o}=N9(),a=u=>o({activationEvent:u}),l=Promise.all(i.map(u=>H6(n,u,a))).then(()=>{}),c=B6(n,e.identifier,r,a);return Promise.all([l,c]).then(()=>{o(void 0)}),s}async function H6(n,e,t){for(const i of n.folders)if(await n.exists(An(y.revive(i),e))){t(`workspaceContains:${e}`);return}}async function B6(n,e,t,i){if(t.length===0)return Promise.resolve(void 0);const r=new Bt,s=n.checkExists(n.folders,t,r.token),o=setTimeout(async()=>{r.cancel(),n.logService.info(`Not activating extension '${e.value}': Timed out while searching for 'workspaceContains' pattern ${t.join(",")}`)},$6);let a=!1;try{a=await s}catch(l){dl(l)||Fn(l)}r.dispose(),clearTimeout(o),a&&i(`workspaceContains:${t.join(",")}`)}class M5{constructor(e){this._onDidChangePassword=new L,this.onDidChangePassword=this._onDidChangePassword.event,this._proxy=e.getProxy(Z.MainThreadSecretState)}async $onDidChangePassword(e){this._onDidChangePassword.fire(e)}get(e,t){return this._proxy.$getPassword(e,t)}store(e,t,i){return this._proxy.$setPassword(e,t,i)}delete(e,t){return this._proxy.$deletePassword(e,t)}}const t2=De("IExtHostSecretState");var oo;class W6{constructor(e,t){ge(this,oo);this.disposables=new Ie,this._id=Ke.toKey(e.identifier),ie(this,oo,t),this.onDidChange=Ht.map(Ht.filter(A(this,oo).onDidChangePassword,i=>i.extensionId===this._id),i=>({key:i.key}),this.disposables)}dispose(){this.disposables.dispose()}get(e){return A(this,oo).get(this._id,e)}store(e,t){return A(this,oo).store(this._id,e,t)}delete(e){return A(this,oo).delete(this._id,e)}}oo=new WeakMap;let R0=class{constructor(e,t,i){this.logService=i,this.bundleCache=new Map,this._proxy=t.getProxy(Z.MainThreadLocalization),this.currentLanguage=e.environment.appLanguage,this.isDefaultLanguage=this.currentLanguage===mo}getMessage(e,t){var l;const{message:i,args:r,comment:s}=t;if(this.isDefaultLanguage)return z2(i,r??{});let o=i;s&&s.length>0&&(o+=`/${Array.isArray(s)?s.join(""):s}`);const a=(l=this.bundleCache.get(e))==null?void 0:l.contents[o];return a||this.logService.warn(`Using default string since no string found in i18n bundle that has the key: ${o}`),z2(a??i,r??{})}getBundle(e){var t;return(t=this.bundleCache.get(e))==null?void 0:t.contents}getBundleUri(e){var t;return(t=this.bundleCache.get(e))==null?void 0:t.uri}async initializeLocalizedMessages(e){var r;if(this.isDefaultLanguage||!e.l10n&&!e.isBuiltin||this.bundleCache.has(e.identifier.value))return;let t;const i=await this.getBundleLocation(e);if(!i){this.logService.error(`No bundle location found for extension ${e.identifier.value}`);return}try{const s=await this._proxy.$fetchBundleContents(i),o=JSON.parse(s);t=e.isBuiltin?(r=o.contents)==null?void 0:r.bundle:o}catch(s){this.logService.error(`Failed to load translations for ${e.identifier.value} from ${i}: ${s.message}`);return}t&&this.bundleCache.set(e.identifier.value,{contents:t,uri:i})}async getBundleLocation(e){if(e.isBuiltin){const t=await this._proxy.$fetchBuiltInBundleUri(e.identifier.value,this.currentLanguage);return y.revive(t)}return e.l10n?y.joinPath(e.extensionLocation,e.l10n,`bundle.l10n.${this.currentLanguage}.json`):void 0}};R0=V([F(0,In),F(1,tt),F(2,ct)],R0);const n2=De("IExtHostLocalizationService"),i2=De("IExtHostManagedSockets");let L0=class{constructor(e){this._remoteSocketIdCounter=0,this._factory=null,this._managedRemoteSockets=new Map,this._proxy=e.getProxy(Z.MainThreadManagedSockets)}setFactory(e,t){for(const i of this._managedRemoteSockets.values())i.dispose();this._factory&&this._proxy.$unregisterSocketFactory(this._factory.socketFactoryId),this._factory=new V6(e,t),this._proxy.$registerSocketFactory(this._factory.socketFactoryId)}async $openRemoteSocket(e){if(!this._factory||this._factory.socketFactoryId!==e)throw new Error(`No socket factory with id ${e}`);const t=++this._remoteSocketIdCounter,i=await this._factory.makeConnection(),r=new Ie;return this._managedRemoteSockets.set(t,new z6(t,i,r)),r.add(Se(()=>this._managedRemoteSockets.delete(t))),r.add(i.onDidEnd(()=>{this._proxy.$onDidManagedSocketEnd(t),r.dispose()})),r.add(i.onDidClose(s=>{this._proxy.$onDidManagedSocketClose(t,(s==null?void 0:s.stack)??(s==null?void 0:s.message)),r.dispose()})),r.add(i.onDidReceiveMessage(s=>this._proxy.$onDidManagedSocketHaveData(t,Pe.wrap(s)))),t}$remoteSocketWrite(e,t){var i;(i=this._managedRemoteSockets.get(e))==null||i.actual.send(t.buffer)}$remoteSocketEnd(e){const t=this._managedRemoteSockets.get(e);t&&(t.actual.end(),t.dispose())}async $remoteSocketDrain(e){var t,i,r;await((r=(t=this._managedRemoteSockets.get(e))==null?void 0:(i=t.actual).drain)==null?void 0:r.call(i))}};L0=V([F(0,tt)],L0);class V6{constructor(e,t){this.socketFactoryId=e,this.makeConnection=t}}class z6 extends Te{constructor(e,t,i){super(),this.socketId=e,this.actual=t,this._register(i)}}var N0;const $5=De("IHostUtils");let O0=N0=class extends Te{constructor(e,t,i,r,s,o,a,l,c,u,d,f,p){super(),this._extHostManagedSockets=f,this._extHostLanguageModels=p,this._onDidChangeRemoteConnectionData=this._register(new L),this.onDidChangeRemoteConnectionData=this._onDidChangeRemoteConnectionData.event,this._realPathCache=new Map,this._isTerminating=!1,this._hostUtils=t,this._extHostContext=i,this._initData=a,this._extHostWorkspace=r,this._extHostConfiguration=s,this._logService=o,this._extHostTunnelService=c,this._extHostTerminalService=u,this._extHostLocalizationService=d,this._mainThreadWorkspaceProxy=this._extHostContext.getProxy(Z.MainThreadWorkspace),this._mainThreadTelemetryProxy=this._extHostContext.getProxy(Z.MainThreadTelemetry),this._mainThreadExtensionsProxy=this._extHostContext.getProxy(Z.MainThreadExtensionService),this._almostReadyToRunExtensions=new Nr,this._readyToStartExtensionHost=new Nr,this._readyToRunExtensions=new Nr,this._eagerExtensionsActivated=new Nr,this._activationEventsReader=new j6(this._initData.extensions.activationEvents),this._globalRegistry=new nl(this._activationEventsReader,this._initData.extensions.allExtensions);const w=new Dl(this._initData.extensions.myExtensions);this._myRegistry=new nl(this._activationEventsReader,U5(this._globalRegistry,w)),$o&&(this._logService.info(`Creating extension host with the following global extensions: ${Gl(this._globalRegistry)}`),this._logService.info(`Creating extension host with the following local extensions: ${Gl(this._myRegistry)}`)),this._storage=new I5(this._extHostContext,this._logService),this._secretState=new M5(this._extHostContext),this._storagePath=l,this._instaService=this._store.add(e.createChild(new bx([Qx,this._storage],[t2,this._secretState]))),this._activator=this._register(new _0(this._myRegistry,this._globalRegistry,{onExtensionActivationError:(v,m,x)=>{this._mainThreadExtensionsProxy.$onExtensionActivationError(v,lu(m),x)},actualActivateExtension:async(v,m)=>{if(nl.isHostExtension(v,this._myRegistry,this._globalRegistry))return await this._mainThreadExtensionsProxy.$activateExtension(v,m),new s6;const x=this._myRegistry.getExtensionDescription(v);return this._activateExtension(x,m)}},this._logService)),this._extensionPathIndex=null,this._resolvers=Object.create(null),this._started=!1,this._remoteConnectionData=this._initData.remote.connectionData}getRemoteConnectionData(){return this._remoteConnectionData}async initialize(){try{await this._beforeAlmostReadyToRunExtensions(),this._almostReadyToRunExtensions.open(),await this._extHostWorkspace.waitForInitializeCall(),ti("code/extHost/ready"),this._readyToStartExtensionHost.open(),this._initData.autoStart&&this._startExtensionHost()}catch(e){Fn(e)}}async _deactivateAll(){this._storagePath.onWillDeactivateAll();let e=[];try{e=this._myRegistry.getAllExtensionDescriptions().map(s=>s.identifier).filter(s=>this.isActivated(s)).map(s=>this._deactivate(s))}catch{}await Promise.all(e)}terminate(e,t=0){if(this._isTerminating)return;this._isTerminating=!0,this._logService.info(`Extension host terminating: ${e}`),this._logService.flush(),this._extHostTerminalService.dispose(),this._activator.dispose(),ph&&Lv(r=>{this._logService.error(r)}),this._extHostContext.dispose();const i=this._deactivateAll();Promise.race([Eo(5e3),i]).finally(()=>{this._hostUtils.pid?this._logService.info(`Extension host with pid ${this._hostUtils.pid} exiting with code ${t}`):this._logService.info(`Extension host exiting with code ${t}`),this._logService.flush(),this._logService.dispose(),this._hostUtils.exit(t)})}isActivated(e){return this._readyToRunExtensions.isOpen()?this._activator.isActivated(e):!1}async getExtension(e){const t=await this._mainThreadExtensionsProxy.$getExtension(e);return t&&{...t,identifier:new Ke(t.identifier.value),extensionLocation:y.revive(t.extensionLocation)}}_activateByEvent(e,t){return this._activator.activateByEvent(e,t)}_activateById(e,t){return this._activator.activateById(e,t)}activateByIdWithErrors(e,t){return this._activateById(e,t).then(()=>{const i=this._activator.getActivatedExtension(e);if(i.activationFailed)return Promise.reject(i.activationFailedError)})}getExtensionRegistry(){return this._readyToRunExtensions.wait().then(e=>this._myRegistry)}getExtensionExports(e){if(this._readyToRunExtensions.isOpen())return this._activator.getActivatedExtension(e).exports;try{return this._activator.getActivatedExtension(e).exports}catch{return null}}async _realPathExtensionUri(e){if(e.scheme===oe.file&&this._hostUtils.fsRealpath){const t=e.fsPath;this._realPathCache.has(t)||this._realPathCache.set(t,this._hostUtils.fsRealpath(t));const i=await this._realPathCache.get(t);return y.file(i)}return e}async getExtensionPathIndex(){return this._extensionPathIndex||(this._extensionPathIndex=this._createExtensionPathIndex(this._myRegistry.getAllExtensionDescriptions()).then(e=>new q6(e))),this._extensionPathIndex}async _createExtensionPathIndex(e){const t=ki.forUris(i=>I9.ignorePathCasing(i));return await Promise.all(e.map(async i=>{if(this._getEntryPoint(i)){const r=await this._realPathExtensionUri(i.extensionLocation);t.set(r,i)}})),t}_deactivate(e){let t=Promise.resolve(void 0);if(!this._readyToRunExtensions.isOpen()||!this._activator.isActivated(e))return t;const i=this._activator.getActivatedExtension(e);if(!i)return t;try{typeof i.module.deactivate=="function"&&(t=Promise.resolve(i.module.deactivate()).then(void 0,r=>(this._logService.error(r),Promise.resolve(void 0))))}catch(r){this._logService.error(`An error occurred when deactivating the extension '${e.value}':`),this._logService.error(r)}try{i.disposable.dispose()}catch(r){this._logService.error(`An error occurred when disposing the subscriptions for extension '${e.value}':`),this._logService.error(r)}return t}async _activateExtension(e,t){return this._initData.remote.isRemote?this._mainThreadExtensionsProxy.$onWillActivateExtension(e.identifier):await this._mainThreadExtensionsProxy.$onWillActivateExtension(e.identifier),this._doActivateExtension(e,t).then(i=>{const r=i.activationTimes;return this._mainThreadExtensionsProxy.$onDidActivateExtension(e.identifier,r.codeLoadingTime,r.activateCallTime,r.activateResolvedTime,t),this._logExtensionActivationTimes(e,t,"success",r),i},i=>{throw this._logExtensionActivationTimes(e,t,"failure"),i})}_logExtensionActivationTimes(e,t,i,r){const s=dD(e,t);this._mainThreadTelemetryProxy.$publicLog2("extensionActivationTimes",{...s,...r||{},outcome:i})}_doActivateExtension(e,t){const i=dD(e,t);this._mainThreadTelemetryProxy.$publicLog2("activatePlugin",i);const r=this._getEntryPoint(e);if(!r)return Promise.resolve(new r6(Vu.NONE));this._logService.info(`ExtensionService#_doActivateExtension ${e.identifier.value}, startup: ${t.startup}, activationEvent: '${t.activationEvent}'${e.identifier.value!==t.extensionId.value?`, root cause: ${t.extensionId.value}`:""}`),this._logService.flush();const s=new Ie,o=new R4(t.startup);return Promise.all([this._loadCommonJSModule(e,An(e.extensionLocation,r),o),this._loadExtensionContext(e,s)]).then(a=>(ti(`code/extHost/willActivateExtension/${e.identifier.value}`),N0._callActivate(this._logService,e.identifier,a[0],a[1],s,o))).then(a=>(ti(`code/extHost/didActivateExtension/${e.identifier.value}`),a))}_loadExtensionContext(e,t){const i=this._extHostLanguageModels.createLanguageModelAccessInformation(e),r=t.add(new o6(e,this._storage)),s=t.add(new C5(e.identifier.value,!1,this._storage)),o=t.add(new W6(e,this._secretState)),a=e.isUnderDevelopment?this._initData.environment.extensionTestsLocationURI?Fc.Test:Fc.Development:Fc.Production,l=this._initData.remote.isRemote?Ja.Workspace:Ja.UI;return this._logService.trace(`ExtensionService#loadExtensionContext ${e.identifier.value}`),Promise.all([r.whenReady,s.whenReady,this._storagePath.whenReady]).then(()=>{var p;const c=this;let u,d;const f=vt(e,"ipc")?(p=this._initData.messagePorts)==null?void 0:p.get(Ke.toKey(e.identifier)):void 0;return Object.freeze({globalState:r,workspaceState:s,secrets:o,subscriptions:[],get languageModelAccessInformation(){return i},get extensionUri(){return e.extensionLocation},get extensionPath(){return e.extensionLocation.fsPath},asAbsolutePath(w){return Bv(e.extensionLocation.fsPath,w)},get storagePath(){var w;return(w=c._storagePath.workspaceValue(e))==null?void 0:w.fsPath},get globalStoragePath(){return c._storagePath.globalValue(e).fsPath},get logPath(){return Bv(c._initData.logsLocation.fsPath,e.identifier.value)},get logUri(){return y.joinPath(c._initData.logsLocation,e.identifier.value)},get storageUri(){return c._storagePath.workspaceValue(e)},get globalStorageUri(){return c._storagePath.globalValue(e)},get extensionMode(){return a},get extension(){return u===void 0&&(u=new Id(c,e.identifier,e,l,!1)),u},get extensionRuntime(){return $(e,"extensionRuntime"),c.extensionRuntime},get environmentVariableCollection(){return c._extHostTerminalService.getEnvironmentVariableCollection(e)},get messagePassingProtocol(){if(!d){if(!f)return;const w=Ht.buffer(Ht.fromDOMEventEmitter(f,"message",v=>v.data));f.start(),d={onDidReceiveMessage:w,postMessage:f.postMessage.bind(f)}}return d}})})}static _callActivate(e,t,i,r,s,o){return i=i||{activate:void 0,deactivate:void 0},this._callActivateOptional(e,t,i,r,o).then(a=>new E_(!1,null,o.build(),i,a,Se(()=>{s.dispose(),Ns(r.subscriptions)})))}static _callActivateOptional(e,t,i,r,s){if(typeof i.activate=="function")try{s.activateCallStart(),e.trace(`ExtensionService#_callActivateOptional ${t.value}`);const o=typeof global=="object"?global:self,a=i.activate.apply(o,[r]);return s.activateCallStop(),s.activateResolveStart(),Promise.resolve(a).then(l=>(s.activateResolveStop(),l))}catch(o){return Promise.reject(o)}else return Promise.resolve(i)}_activateOneStartupFinished(e,t){this._activateById(e.identifier,{startup:!1,extensionId:e.identifier,activationEvent:t}).then(void 0,i=>{this._logService.error(i)})}_activateAllStartupFinishedDeferred(e,t=0){const r=Date.now();bI(()=>{for(let s=t;s<e.length;s+=1){const o=e[s];for(const a of o.activationEvents??[])if(a==="onStartupFinished")if(Date.now()-r>50){this._activateAllStartupFinishedDeferred(e,s);break}else this._activateOneStartupFinished(o,a)}})}_activateAllStartupFinished(){this._mainThreadExtensionsProxy.$setPerformanceMarks(xP()),this._extHostConfiguration.getConfigProvider().then(e=>{const t=e.getConfiguration("extensions.experimental").get("deferredStartupFinishedActivation"),i=this._myRegistry.getAllExtensionDescriptions();if(t)this._activateAllStartupFinishedDeferred(i);else for(const r of i)if(r.activationEvents)for(const s of r.activationEvents)s==="onStartupFinished"&&this._activateOneStartupFinished(r,s)})}_handleEagerExtensions(){const e=this._activateByEvent("*",!0).then(void 0,o=>{this._logService.error(o)});this._register(this._extHostWorkspace.onDidChangeWorkspace(o=>this._handleWorkspaceContainsEagerExtensions(o.added)));const t=this._extHostWorkspace.workspace?this._extHostWorkspace.workspace.folders:[],i=this._handleWorkspaceContainsEagerExtensions(t),r=this._handleRemoteResolverEagerExtensions(),s=Promise.all([r,e,i]).then(()=>{});return Promise.race([s,Eo(1e4)]).then(()=>{this._activateAllStartupFinished()}),s}_handleWorkspaceContainsEagerExtensions(e){return e.length===0?Promise.resolve(void 0):Promise.all(this._myRegistry.getAllExtensionDescriptions().map(t=>this._handleWorkspaceContainsEagerExtension(e,t))).then(()=>{})}async _handleWorkspaceContainsEagerExtension(e,t){if(this.isActivated(t.identifier))return;const i=!this._initData.remote.isRemote&&!!this._initData.remote.authority,r={logService:this._logService,folders:e.map(o=>o.uri),forceUsingSearch:i||!this._hostUtils.fsExists,exists:o=>this._hostUtils.fsExists(o.fsPath),checkExists:(o,a,l)=>this._mainThreadWorkspaceProxy.$checkExists(o,a,l)},s=await U6(r,t);if(s)return this._activateById(t.identifier,{startup:!0,extensionId:t.identifier,activationEvent:s.activationEvent}).then(void 0,o=>this._logService.error(o))}async _handleRemoteResolverEagerExtensions(){if(this._initData.remote.authority)return this._activateByEvent(`onResolveRemoteAuthority:${this._initData.remote.authority}`,!1)}async $extensionTestsExecute(){await this._eagerExtensionsActivated.wait();try{return await this._doHandleExtensionTests()}catch(e){throw console.error(e),e}}async _doHandleExtensionTests(){const{extensionDevelopmentLocationURI:e,extensionTestsLocationURI:t}=this._initData.environment;if(!e||!t)throw new Error(h(2538,"Cannot load test runner."));const i=await this._loadCommonJSModule(null,t,new R4(!1));if(!i||typeof i.run!="function")throw new Error(h(2539,"Path {0} does not point to a valid extension test runner.",t.toString()));return new Promise((r,s)=>{const o=(c,u)=>{c?($o&&this._logService.error("Test runner called back with error",c),s(c)):($o&&(u?this._logService.info(`Test runner called back with ${u} failures.`):this._logService.info("Test runner called back with successful outcome.")),r(typeof u=="number"&&u>0?1:0))},a=Gi(t),l=i.run(a,o);l&&l.then&&l.then(()=>{$o&&this._logService.info("Test runner finished successfully."),r(0)}).catch(c=>{$o&&this._logService.error("Test runner finished with error",c),s(c instanceof Error&&c.stack?c.stack:String(c))})})}_startExtensionHost(){if(this._started)throw new Error("Extension host is already started!");return this._started=!0,this._readyToStartExtensionHost.wait().then(()=>this._readyToRunExtensions.open()).then(()=>Promise.race([this._activator.waitForActivatingExtensions(),Eo(1e3)])).then(()=>this._handleEagerExtensions()).then(()=>{this._eagerExtensionsActivated.open(),this._logService.info("Eager extensions activated")})}registerRemoteAuthorityResolver(e,t){return this._resolvers[e]=t,Se(()=>{delete this._resolvers[e]})}async getRemoteExecServer(e){var i;const{resolver:t}=await this._activateAndGetResolver(e);return(i=t==null?void 0:t.resolveExecServer)==null?void 0:i.call(t,e,{resolveAttempt:0})}async _activateAndGetResolver(e){const t=e.indexOf("+");if(t===-1)throw new Pr("Not an authority that can be resolved!",Es.InvalidAuthority);const i=e.substr(0,t);return await this._almostReadyToRunExtensions.wait(),await this._activateByEvent(`onResolveRemoteAuthority:${i}`,!1),{authorityPrefix:i,resolver:this._resolvers[i]}}async $resolveAuthority(e,t){var k;const i=Os.create(!1),r=()=>`[resolveAuthority(${g4(e)},${t})][${i.elapsed()}ms] `,s=D=>this._logService.info(`${r()}${D}`),o=D=>this._logService.warn(`${r()}${D}`),a=(D,B=void 0)=>this._logService.error(`${r()}${D}`,B),l=D=>{if(D instanceof Pr)return{type:"error",error:{code:D._code,message:D._message,detail:D._detail}};throw D},c=async D=>{s(`activating resolver for ${D}...`);const{resolver:B,authorityPrefix:T}=await this._activateAndGetResolver(D);if(!B)throw a(`no resolver for ${T}`),new Pr(`No remote extension installed to resolve ${T}.`,Es.NoResolverFound);return{resolver:B,authorityPrefix:T,remoteAuthority:D}},u=e.split(/@|%40/g).reverse();s(`activating remote resolvers ${u.join(" -> ")}`);let d;try{d=await Promise.all(u.map(c)).catch(async D=>{if(!(D instanceof Pr)||D._code!==Es.InvalidAuthority)throw D;return o(`resolving nested authorities failed: ${D.message}`),[await c(e)]})}catch(D){return l(D)}const f=new q9;f.cancelAndSet(()=>s("waiting..."),1e3);let p,w;for(const[D,{authorityPrefix:B,resolver:T,remoteAuthority:z}]of d.entries())try{if(D===d.length-1)s("invoking final resolve()..."),ti(`code/extHost/willResolveAuthority/${B}`),p=await T.resolve(z,{resolveAttempt:t,execServer:w}),ti(`code/extHost/didResolveAuthorityOK/${B}`),s("setting tunnel factory..."),this._register(await this._extHostTunnelService.setTunnelFactory(T,Op.isManagedResolvedAuthority(p)?p:void 0));else{if(s(`invoking resolveExecServer() for ${z}`),ti(`code/extHost/willResolveExecServer/${B}`),w=await((k=T.resolveExecServer)==null?void 0:k.call(T,z,{resolveAttempt:t,execServer:w})),!w)throw new Pr(`Exec server was not available for ${z}`,Es.NoResolverFound);ti(`code/extHost/didResolveExecServerOK/${B}`)}}catch(K){return ti(`code/extHost/didResolveAuthorityError/${B}`),a("returned an error",K),f.dispose(),l(K)}f.dispose();const v={environmentTunnels:p.environmentTunnels,features:p.tunnelFeatures?{elevation:p.tunnelFeatures.elevation,privacyOptions:p.tunnelFeatures.privacyOptions,protocol:p.tunnelFeatures.protocol===void 0?!0:p.tunnelFeatures.protocol}:void 0},m={extensionHostEnv:p.extensionHostEnv,isTrusted:p.isTrusted,authenticationSession:p.authenticationSessionForInitializingExtensions?{id:p.authenticationSessionForInitializingExtensions.id,providerId:p.authenticationSessionForInitializingExtensions.providerId}:void 0};s(`returned ${Op.isManagedResolvedAuthority(p)?"managed authority":`${p.host}:${p.port}`}`);let x;if(Op.isManagedResolvedAuthority(p)){const D=t;this._extHostManagedSockets.setFactory(D,p.makeConnection),x={authority:e,connectTo:new YR(D),connectionToken:p.connectionToken}}else x={authority:e,connectTo:new ZR(p.host,p.port),connectionToken:p.connectionToken};return{type:"ok",value:{authority:x,options:m,tunnelInformation:v}}}async $getCanonicalURI(e,t){this._logService.info(`$getCanonicalURI invoked for authority (${g4(e)})`);const{resolver:i}=await this._activateAndGetResolver(e);if(!i)return null;const r=y.revive(t);if(typeof i.getCanonicalURI>"u")return r;const s=await Nn(()=>i.getCanonicalURI(r));return s||r}async $startExtensionHost(e){e.toAdd.forEach(o=>o.extensionLocation=y.revive(o.extensionLocation));const{globalRegistry:t,myExtensions:i}=uD(this._activationEventsReader,this._globalRegistry,this._myRegistry,e),r=await this._createExtensionPathIndex(i);return(await this.getExtensionPathIndex()).setSearchTree(r),this._globalRegistry.set(t.getAllExtensionDescriptions()),this._myRegistry.set(i),$o&&(this._logService.info(`$startExtensionHost: global extensions: ${Gl(this._globalRegistry)}`),this._logService.info(`$startExtensionHost: local extensions: ${Gl(this._myRegistry)}`)),this._startExtensionHost()}$activateByEvent(e,t){return t===fw.Immediate?this._almostReadyToRunExtensions.wait().then(i=>this._activateByEvent(e,!1)):this._readyToRunExtensions.wait().then(i=>this._activateByEvent(e,!1))}async $activate(e,t){return await this._readyToRunExtensions.wait(),this._myRegistry.getExtensionDescription(e)?(await this._activateById(e,t),!0):!1}async $deltaExtensions(e){e.toAdd.forEach(o=>o.extensionLocation=y.revive(o.extensionLocation));const{globalRegistry:t,myExtensions:i}=uD(this._activationEventsReader,this._globalRegistry,this._myRegistry,e),r=await this._createExtensionPathIndex(i);return(await this.getExtensionPathIndex()).setSearchTree(r),this._globalRegistry.set(t.getAllExtensionDescriptions()),this._myRegistry.set(i),$o&&(this._logService.info(`$deltaExtensions: global extensions: ${Gl(this._globalRegistry)}`),this._logService.info(`$deltaExtensions: local extensions: ${Gl(this._myRegistry)}`)),Promise.resolve(void 0)}async $test_latency(e){return e}async $test_up(e){return e.byteLength}async $test_down(e){const t=Pe.alloc(e),i=Math.random()%256;for(let r=0;r<e;r++)t.writeUInt8(i,r);return t}async $updateRemoteConnectionData(e){this._remoteConnectionData=e,this._onDidChangeRemoteConnectionData.fire()}};O0=N0=V([F(0,zf),F(1,$5),F(2,tt),F(3,Hs),F(4,Bs),F(5,ct),F(6,In),F(7,Jx),F(8,Xx),F(9,Ku),F(10,n2),F(11,i2),F(12,Kx)],O0);function uD(n,e,t,i){n.addActivationEvents(i.addActivationEvents);const r=new nl(n,e.getAllExtensionDescriptions());r.deltaExtensions(i.toAdd,i.toRemove);const s=new Dl(t.getAllExtensionDescriptions().map(a=>a.identifier));for(const a of i.myToRemove)s.delete(a);for(const a of i.myToAdd)s.add(a);const o=U5(r,s);return{globalRegistry:r,myExtensions:o}}function dD(n,e){return{id:n.identifier.value,name:n.name,extensionVersion:n.version,publisherDisplayName:n.publisher,activationEvents:n.activationEvents?n.activationEvents.join(","):null,isBuiltin:n.isBuiltin,reason:e.activationEvent,reasonId:e.extensionId.value}}function Gl(n){return n.getAllExtensionDescriptions().map(e=>e.identifier.value).join(",")}const No=De("IExtHostExtensionService");var Da,Cf,ka;class Id{constructor(e,t,i,r,s){ge(this,Da);ge(this,Cf);ge(this,ka);ie(this,Da,e),ie(this,Cf,t),ie(this,ka,i.identifier),this.id=i.identifier.value,this.extensionUri=i.extensionLocation,this.extensionPath=hu(Gi(i.extensionLocation)),this.packageJSON=i,this.extensionKind=r,this.isFromDifferentExtensionHost=s}get isActive(){return A(this,Da).isActivated(A(this,ka))}get exports(){if(!(this.packageJSON.api==="none"||this.isFromDifferentExtensionHost))return A(this,Da).getExtensionExports(A(this,ka))}async activate(){if(this.isFromDifferentExtensionHost)throw new Error("Cannot activate foreign extension");return await A(this,Da).activateByIdWithErrors(A(this,ka),{startup:!1,extensionId:A(this,Cf),activationEvent:"api"}),this.exports}}Da=new WeakMap,Cf=new WeakMap,ka=new WeakMap;function U5(n,e){return n.getAllExtensionDescriptions().filter(t=>e.has(t.identifier))}class q6{constructor(e){this._searchTree=e}setSearchTree(e){this._searchTree=e}findSubstr(e){return this._searchTree.findSubstr(e)}forEach(e){return this._searchTree.forEach(e)}}class j6{constructor(e){this._map=new Ms,this.addActivationEvents(e)}readActivationEvents(e){return this._map.get(e.identifier)??[]}addActivationEvents(e){for(const t of Object.keys(e))this._map.set(t,e[t])}}function _f(n){return r2(n,0)}function r2(n,e){switch(typeof n){case"object":return n===null?Ds(349,e):Array.isArray(n)?Q6(n,e):J6(n,e);case"string":return H5(n,e);case"boolean":return G6(n,e);case"number":return Ds(n,e);case"undefined":return Ds(937,e);default:return Ds(617,e)}}function Ds(n,e){return(e<<5)-e+n|0}function G6(n,e){return Ds(n?433:863,e)}function H5(n,e){e=Ds(149417,e);for(let t=0,i=n.length;t<i;t++)e=Ds(n.charCodeAt(t),e);return e}function Q6(n,e){return e=Ds(104579,e),n.reduce((t,i)=>r2(i,t),e)}function J6(n,e){return e=Ds(181387,e),Object.keys(n).sort().reduce((t,i)=>(t=H5(i,t),r2(n[i],t)),e)}var Fi;(function(n){n[n.BLOCK_SIZE=64]="BLOCK_SIZE",n[n.UNICODE_REPLACEMENT=65533]="UNICODE_REPLACEMENT"})(Fi||(Fi={}));function gv(n,e,t=32){const i=t-e,r=~((1<<i)-1);return(n<<e|(r&n)>>>i)>>>0}function gd(n,e=32){return n instanceof ArrayBuffer?Array.from(new Uint8Array(n)).map(t=>t.toString(16).padStart(2,"0")).join(""):(n>>>0).toString(16).padStart(e/4,"0")}const O1=class O1{constructor(){this._h0=1732584193,this._h1=4023233417,this._h2=2562383102,this._h3=271733878,this._h4=3285377520,this._buff=new Uint8Array(Fi.BLOCK_SIZE+3),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(e){const t=e.length;if(t===0)return;const i=this._buff;let r=this._buffLen,s=this._leftoverHighSurrogate,o,a;for(s!==0?(o=s,a=-1,s=0):(o=e.charCodeAt(0),a=0);;){let l=o;if(i_(o))if(a+1<t){const c=e.charCodeAt(a+1);sg(c)?(a++,l=_x(o,c)):l=Fi.UNICODE_REPLACEMENT}else{s=o;break}else sg(o)&&(l=Fi.UNICODE_REPLACEMENT);if(r=this._push(i,r,l),a++,a<t)o=e.charCodeAt(a);else break}this._buffLen=r,this._leftoverHighSurrogate=s}_push(e,t,i){return i<128?e[t++]=i:i<2048?(e[t++]=192|(i&1984)>>>6,e[t++]=128|(i&63)>>>0):i<65536?(e[t++]=224|(i&61440)>>>12,e[t++]=128|(i&4032)>>>6,e[t++]=128|(i&63)>>>0):(e[t++]=240|(i&1835008)>>>18,e[t++]=128|(i&258048)>>>12,e[t++]=128|(i&4032)>>>6,e[t++]=128|(i&63)>>>0),t>=Fi.BLOCK_SIZE&&(this._step(),t-=Fi.BLOCK_SIZE,this._totalLen+=Fi.BLOCK_SIZE,e[0]=e[Fi.BLOCK_SIZE+0],e[1]=e[Fi.BLOCK_SIZE+1],e[2]=e[Fi.BLOCK_SIZE+2]),t}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,Fi.UNICODE_REPLACEMENT)),this._totalLen+=this._buffLen,this._wrapUp()),gd(this._h0)+gd(this._h1)+gd(this._h2)+gd(this._h3)+gd(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,this._buff.subarray(this._buffLen).fill(0),this._buffLen>56&&(this._step(),this._buff.fill(0));const e=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(e/4294967296),!1),this._buffDV.setUint32(60,e%4294967296,!1),this._step()}_step(){const e=O1._bigBlock32,t=this._buffDV;for(let d=0;d<64;d+=4)e.setUint32(d,t.getUint32(d,!1),!1);for(let d=64;d<320;d+=4)e.setUint32(d,gv(e.getUint32(d-12,!1)^e.getUint32(d-32,!1)^e.getUint32(d-56,!1)^e.getUint32(d-64,!1),1),!1);let i=this._h0,r=this._h1,s=this._h2,o=this._h3,a=this._h4,l,c,u;for(let d=0;d<80;d++)d<20?(l=r&s|~r&o,c=1518500249):d<40?(l=r^s^o,c=1859775393):d<60?(l=r&s|r&o|s&o,c=2400959708):(l=r^s^o,c=3395469782),u=gv(i,5)+l+a+c+e.getUint32(d*4,!1)&4294967295,a=o,o=s,s=gv(r,30),r=i,i=u;this._h0=this._h0+i&4294967295,this._h1=this._h1+r&4294967295,this._h2=this._h2+s&4294967295,this._h3=this._h3+o&4294967295,this._h4=this._h4+a&4294967295}};O1._bigBlock32=new DataView(new ArrayBuffer(320));let hD=O1;var Xe;(function(n){n[n.Off=0]="Off",n[n.Trace=1]="Trace",n[n.Debug=2]="Debug",n[n.Info=3]="Info",n[n.Warning=4]="Warning",n[n.Error=5]="Error"})(Xe||(Xe={}));const X6=Xe.Info;function Y6(n,e){return n!==Xe.Off&&n<=e}function Z6(n,e,t){switch(e){case Xe.Trace:n.trace(t);break;case Xe.Debug:n.debug(t);break;case Xe.Info:n.info(t);break;case Xe.Warning:n.warn(t);break;case Xe.Error:n.error(t);break;case Xe.Off:break;default:throw new Error(`Invalid log level ${e}`)}}function Ql(n,e=!1){let t="";for(let i=0;i<n.length;i++){let r=n[i];if(r instanceof Error&&(r=Zu(r,e)),typeof r=="object")try{r=JSON.stringify(r)}catch{}t+=(i>0?" ":"")+r}return t}class B5 extends Te{constructor(){super(...arguments),this.level=X6,this._onDidChangeLogLevel=this._register(new L),this.onDidChangeLogLevel=this._onDidChangeLogLevel.event}setLevel(e){this.level!==e&&(this.level=e,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}checkLogLevel(e){return Y6(this.level,e)}canLog(e){return this._store.isDisposed?!1:this.checkLogLevel(e)}}class W5 extends B5{constructor(e){super(),this.logAlways=e}checkLogLevel(e){return this.logAlways||super.checkLogLevel(e)}trace(e,...t){this.canLog(Xe.Trace)&&this.log(Xe.Trace,Ql([e,...t],!0))}debug(e,...t){this.canLog(Xe.Debug)&&this.log(Xe.Debug,Ql([e,...t]))}info(e,...t){this.canLog(Xe.Info)&&this.log(Xe.Info,Ql([e,...t]))}warn(e,...t){this.canLog(Xe.Warning)&&this.log(Xe.Warning,Ql([e,...t]))}error(e,...t){if(this.canLog(Xe.Error))if(e instanceof Error){const i=Array.prototype.slice.call(arguments);i[0]=e.stack,this.log(Xe.Error,Ql(i))}else this.log(Xe.Error,Ql([e,...t]))}flush(){}}class K6 extends B5{constructor(e){super(),this.loggers=e,e.length&&this.setLevel(e[0].getLevel())}setLevel(e){for(const t of this.loggers)t.setLevel(e);super.setLevel(e)}trace(e,...t){for(const i of this.loggers)i.trace(e,...t)}debug(e,...t){for(const i of this.loggers)i.debug(e,...t)}info(e,...t){for(const i of this.loggers)i.info(e,...t)}warn(e,...t){for(const i of this.loggers)i.warn(e,...t)}error(e,...t){for(const i of this.loggers)i.error(e,...t)}flush(){for(const e of this.loggers)e.flush()}dispose(){for(const e of this.loggers)e.dispose();super.dispose()}}class eL extends Te{constructor(e,t,i){if(super(),this.logLevel=e,this.logsHome=t,this._loggers=new on,this._onDidChangeLoggers=this._register(new L),this.onDidChangeLoggers=this._onDidChangeLoggers.event,this._onDidChangeLogLevel=this._register(new L),this.onDidChangeLogLevel=this._onDidChangeLogLevel.event,this._onDidChangeVisibility=this._register(new L),this.onDidChangeVisibility=this._onDidChangeVisibility.event,i)for(const r of i)this._loggers.set(r.resource,{logger:void 0,info:r})}getLoggerEntry(e){return Ze(e)?[...this._loggers.values()].find(t=>t.info.id===e):this._loggers.get(e)}getLogger(e){var t;return(t=this.getLoggerEntry(e))==null?void 0:t.logger}createLogger(e,t){var l;const i=this.toResource(e),r=Ze(e)?e:(t==null?void 0:t.id)??_f(i.toString()).toString(16);let s=(l=this._loggers.get(i))==null?void 0:l.logger;const o=(t==null?void 0:t.logLevel)==="always"?Xe.Trace:t==null?void 0:t.logLevel;s||(s=this.doCreateLogger(i,o??this.getLogLevel(i)??this.logLevel,{...t,id:r}));const a={logger:s,info:{resource:i,id:r,logLevel:o,name:t==null?void 0:t.name,hidden:t==null?void 0:t.hidden,group:t==null?void 0:t.group,extensionId:t==null?void 0:t.extensionId,when:t==null?void 0:t.when}};return this.registerLogger(a.info),this._loggers.set(i,a),s}toResource(e){return Ze(e)?An(this.logsHome,`${e}.log`):e}setLogLevel(e,t){var i,r,s;if(y.isUri(e)){const o=e,a=t,l=this._loggers.get(o);l&&a!==l.info.logLevel&&(l.info.logLevel=a===this.logLevel?void 0:a,(i=l.logger)==null||i.setLevel(a),this._loggers.set(l.info.resource,l),this._onDidChangeLogLevel.fire([o,a]))}else{this.logLevel=e;for(const[o,a]of this._loggers.entries())((r=this._loggers.get(o))==null?void 0:r.info.logLevel)===void 0&&((s=a.logger)==null||s.setLevel(this.logLevel));this._onDidChangeLogLevel.fire(this.logLevel)}}setVisibility(e,t){const i=this.getLoggerEntry(e);i&&t!==!i.info.hidden&&(i.info.hidden=!t,this._loggers.set(i.info.resource,i),this._onDidChangeVisibility.fire([i.info.resource,t]))}getLogLevel(e){var i;let t;return e&&(t=(i=this._loggers.get(e))==null?void 0:i.info.logLevel),t??this.logLevel}registerLogger(e){const t=this._loggers.get(e.resource);t?t.info.hidden!==e.hidden&&this.setVisibility(e.resource,!e.hidden):(this._loggers.set(e.resource,{info:e,logger:void 0}),this._onDidChangeLoggers.fire({added:[e],removed:[]}))}deregisterLogger(e){const t=this.toResource(e),i=this._loggers.get(t);i&&(i.logger&&i.logger.dispose(),this._loggers.delete(t),this._onDidChangeLoggers.fire({added:[],removed:[i.info]}))}*getRegisteredLoggers(){for(const e of this._loggers.values())yield e.info}getRegisteredLogger(e){var t;return(t=this._loggers.get(e))==null?void 0:t.info}dispose(){this._loggers.forEach(e=>{var t;return(t=e.logger)==null?void 0:t.dispose()}),this._loggers.clear(),super.dispose()}}function tL(n){switch(n){case Xe.Trace:return"trace";case Xe.Debug:return"debug";case Xe.Info:return"info";case Xe.Warning:return"warn";case Xe.Error:return"error";case Xe.Off:return"off"}}function nL(n){switch(n){case"trace":return Xe.Trace;case"debug":return Xe.Debug;case"info":return Xe.Info;case"warn":return Xe.Warning;case"error":return Xe.Error;case"critical":return Xe.Error;case"off":return Xe.Off}}new C("logLevel",tL(Xe.Info));let o1=class extends eL{constructor(e,t){super(t.logLevel,t.logsLocation,t.loggers.map(i=>jn(i))),this._proxy=e.getProxy(Z.MainThreadLogger)}$setLogLevel(e,t){t?this.setLogLevel(y.revive(t),e):this.setLogLevel(e)}setVisibility(e,t){super.setVisibility(e,t),this._proxy.$setVisibility(e,t)}doCreateLogger(e,t,i){return new iL(this._proxy,e,t,i)}};o1=V([F(0,tt),F(1,In)],o1);class iL extends W5{constructor(e,t,i,r){super((r==null?void 0:r.logLevel)==="always"),this.proxy=e,this.file=t,this.isLoggerCreated=!1,this.buffer=[],this.setLevel(i),this.proxy.$createLogger(t,r).then(()=>{this.doLog(this.buffer),this.isLoggerCreated=!0})}log(e,t){const i=[[e,t]];this.isLoggerCreated?this.doLog(i):this.buffer.push(...i)}doLog(e){this.proxy.$log(this.file,e)}flush(){this.proxy.$flush(this.file)}}class rL extends Te{constructor(e,t=[]){super(),this.logger=new K6([e,...t]),this._register(e.onDidChangeLogLevel(i=>this.setLevel(i)))}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(e){this.logger.setLevel(e)}getLevel(){return this.logger.getLevel()}trace(e,...t){this.logger.trace(e,...t)}debug(e,...t){this.logger.debug(e,...t)}info(e,...t){this.logger.info(e,...t)}warn(e,...t){this.logger.warn(e,...t)}error(e,...t){this.logger.error(e,...t)}flush(){this.logger.flush()}}let F0=class extends rL{constructor(e,t,i){const r=i.remote.isRemote?"remoteexthost":e?"workerexthost":"exthost",s=i.remote.isRemote?h(2543,"Extension Host (Remote)"):e?h(2544,"Extension Host (Worker)"):h(2545,"Extension Host");super(t.createLogger(r,{name:s}))}};F0=V([F(1,Qu),F(2,In)],F0);class fD{static async installEarlyHandler(e){Error.stackTraceLimit=100;const t=e.get(ct),r=e.get(tt).getProxy(Z.MainThreadErrors);Lv(s=>{t.error(s);const o=lu(s);r.$onUnexpectedError(o)})}static async installFullHandler(e){const t=e.get(ct),i=e.get(tt),r=e.get(No),s=e.get(k_),o=i.getProxy(Z.MainThreadExtensionService),a=i.getProxy(Z.MainThreadErrors),l=await r.getExtensionPathIndex(),c=new WeakMap;function u(p,w){if(c.has(p))return c.get(p).stack;let v="",m,x;for(const D of w)v+=`
	at ${D.toString()}`,x=D.getFileName(),!m&&x&&(m=l.findSubstr(y.file(x)));const k=`${p.name||"Error"}: ${p.message||""}${v}`;return c.set(p,{extensionIdentifier:m==null?void 0:m.identifier,stack:k}),k}const d=Symbol("prepareStackTrace wrapped");let f=u;Object.defineProperty(Error,"prepareStackTrace",{configurable:!1,get(){return f},set(p){if(p===u||!p||p[d]){f=p||u;return}f=function(w,v){return u(w,v),p.call(Error,w,v)},Object.assign(f,{[d]:!0})}}),Lv(p=>{t.error(p);const w=lu(p);let v;if(p instanceof zI)v=p.extension;else{const m=c.get(p);v=m==null?void 0:m.extensionIdentifier}if(v){o.$onExtensionRuntimeError(v,w);const m=s.onExtensionError(v,p);t.trace("forwarded error to extension?",m,v)}}),Uf.addListener(p=>{a.$onUnexpectedError(p)})}}class s2{constructor(e,t,i,r,s){this._hostUtils=i,this._rpcProtocol=new Zv(e,null,r),t=s2._transform(t,this._rpcProtocol);const o=new bx(...iT());o.set(In,{_serviceBrand:void 0,...t,messagePorts:s}),o.set(tt,new oT(this._rpcProtocol)),o.set(s_,new aT(r)),o.set($5,i),o.set(ct,new rr(F0,[!0],!0)),o.set(Qu,new rr(o1,[],!0));const a=new lg(o,!0);ph&&a.invokeFunction(fD.installEarlyHandler),this._logService=a.invokeFunction(l=>l.get(ct)),ti("code/extHost/didCreateServices"),this._hostUtils.pid?this._logService.info(`Extension host with pid ${this._hostUtils.pid} started`):this._logService.info("Extension host started"),this._logService.trace("initData",t),this._extensionService=a.invokeFunction(l=>l.get(No)),this._extensionService.initialize(),ph&&a.invokeFunction(fD.installFullHandler)}async asBrowserUri(e){const t=this._rpcProtocol.getProxy(Z.MainThreadExtensionService);return y.revive(await t.$asBrowserUri(e))}async getAllStaticBrowserUris(){return(await this._rpcProtocol.getProxy(Z.MainThreadExtensionService).$getAllStaticBrowserUris()).map(([t,i])=>[y.revive(t),y.revive(i)])}terminate(e){this._extensionService.terminate(e)}getExtHostExtensionService(){return this._extensionService}static _transform(e,t){e.extensions.allExtensions.forEach(r=>{r.extensionLocation=y.revive(t.transformIncomingURIs(r.extensionLocation))}),e.environment.appRoot=y.revive(t.transformIncomingURIs(e.environment.appRoot));const i=e.environment.extensionDevelopmentLocationURI;return i&&(e.environment.extensionDevelopmentLocationURI=i.map(r=>y.revive(t.transformIncomingURIs(r)))),e.environment.extensionTestsLocationURI=y.revive(t.transformIncomingURIs(e.environment.extensionTestsLocationURI)),e.environment.globalStorageHome=y.revive(t.transformIncomingURIs(e.environment.globalStorageHome)),e.environment.workspaceStorageHome=y.revive(t.transformIncomingURIs(e.environment.workspaceStorageHome)),e.nlsBaseUrl=y.revive(t.transformIncomingURIs(e.nlsBaseUrl)),e.logsLocation=y.revive(t.transformIncomingURIs(e.logsLocation)),e.workspace=t.transformIncomingURIs(e.workspace),e}}const sL=(function(e){const t=i=>{globalThis.removeEventListener("message",t);const r=i.data;Object.defineProperties(globalThis,{postMessage:{value(s,o){r.postMessage(s,o)}},onmessage:{get(){return r.onmessage},set(s){r.onmessage=s}}}),r.addEventListener("message",s=>{globalThis.dispatchEvent(new MessageEvent("message",{data:s.data,ports:s.ports?[...s.ports]:void 0}))}),r.start(),globalThis.Worker=class{constructor(){throw new TypeError("Nested workers from within nested worker are NOT supported.")}},importScripts(e)};globalThis.addEventListener("message",t)}).toString();class oL extends EventTarget{constructor(e,t,i){super(),this.onmessage=null,this.onmessageerror=null,this.onerror=null;const r=`((${sL})('${t}'))`,s=new Blob([r],{type:"application/javascript"}),o=URL.createObjectURL(s),a=new MessageChannel,l=o,c={type:"_newWorker",id:l,port:a.port2,url:o,options:i};e(c,[a.port2]),this.postMessage=a.port1.postMessage.bind(a.port1),this.terminate=()=>{e({type:"_terminateWorker",id:l}),URL.revokeObjectURL(o),a.port1.close(),a.port2.close()},Object.defineProperties(this,{onmessage:{get(){return a.port1.onmessage},set(u){a.port1.onmessage=u}},onmessageerror:{get(){return a.port1.onmessageerror},set(u){a.port1.onmessageerror=u}}}),a.port1.addEventListener("messageerror",u=>{const d=new MessageEvent("messageerror",{data:u.data});this.dispatchEvent(d)}),a.port1.addEventListener("message",u=>{const d=new MessageEvent("message",{data:u.data});this.dispatchEvent(d)}),a.port1.start()}}new C("inOutput",!1);new C("activeLogOutput",!1);new C("activeLogOutput.isLog",!1);new C("activeLogOutput.levelSettable",!1);new C("activeLogOutput.level","");new C("activeLogOutput.levelIsDefault",!1);new C("outputView.scrollLock",!1);new C("activeOutputChannel","");new C("output.filter.trace",!0);new C("output.filter.debug",!0);new C("output.filter.info",!0);new C("output.filter.warning",!0);new C("output.filter.error",!0);new C("outputFilterFocus",!1);new C("output.filter.categories","");var Xd;(function(n){n[n.Append=1]="Append",n[n.Replace=2]="Replace",n[n.Clear=3]="Clear"})(Xd||(Xd={}));const aL={OutputChannels:"workbench.contributions.outputChannels"};function lL(n){return Array.isArray(n.source)}class cL{constructor(){this.channels=new Map,this._onDidRegisterChannel=new L,this.onDidRegisterChannel=this._onDidRegisterChannel.event,this._onDidRemoveChannel=new L,this.onDidRemoveChannel=this._onDidRemoveChannel.event,this._onDidUpdateChannelFiles=new L,this.onDidUpdateChannelSources=this._onDidUpdateChannelFiles.event}registerChannel(e){this.channels.has(e.id)||(this.channels.set(e.id,e),this._onDidRegisterChannel.fire(e.id))}getChannels(){const e=[];return this.channels.forEach(t=>e.push(t)),e}getChannel(e){return this.channels.get(e)}updateChannelSources(e,t){const i=this.channels.get(e);i&&lL(i)&&(i.source=t,this._onDidUpdateChannelFiles.fire(i))}removeChannel(e){const t=this.channels.get(e);t&&(this.channels.delete(e),this._onDidRemoveChannel.fire(t))}}Cn.add(aL.OutputChannels,new cL);class V5 extends W5{constructor(e,t,i,r,s){super(),this.id=e,this.name=t,this.logger=i,this.proxy=r,this.extension=s,this.offset=0,this.visible=!1,this.setLevel(i.getLevel()),this._register(i.onDidChangeLogLevel(o=>this.setLevel(o))),this._register(Se(()=>this.proxy.$dispose(this.id)))}get logLevel(){return this.getLevel()}appendLine(e){this.append(e+`
`)}append(e){this.info(e)}clear(){const e=this.offset;this.logger.flush(),this.proxy.$update(this.id,Xd.Clear,e)}replace(e){const t=this.offset;this.info(e),this.proxy.$update(this.id,Xd.Replace,t),this.visible&&this.logger.flush()}show(e,t){this.logger.flush(),this.proxy.$reveal(this.id,!!(typeof e=="boolean"?e:t))}hide(){this.proxy.$close(this.id)}log(e,t){this.offset+=Pe.fromString(t).byteLength,Z6(this.logger,e,t),this.visible&&(this.logger.flush(),this.proxy.$update(this.id,Xd.Append))}}class uL extends V5{appendLine(e){this.append(e)}}let M0=class{constructor(e,t,i,r,s,o){this.initData=t,this.extHostFileSystem=i,this.extHostFileSystemInfo=r,this.loggerService=s,this.logService=o,this.extensionLogDirectoryPromise=new Map,this.namePool=1,this.channels=new Map,this.visibleChannelId=null,this.proxy=e.getProxy(Z.MainThreadOutputService),this.outputsLocation=this.extHostFileSystemInfo.extUri.joinPath(t.logsLocation,`output_logging_${k6(new Date).replace(/-|:|\.\d+Z$/g,"")}`)}$setVisibleChannel(e){this.visibleChannelId=e;for(const[t,i]of this.channels)i.visible=t===this.visibleChannelId}createOutputChannel(e,t,i){var u,d;if(e=e.trim(),!e)throw new Error("illegal argument `name`. must not be falsy");const r=typeof t=="object"&&t.log,s=Ze(t)?t:void 0;if(Ze(s)&&!s.trim())throw new Error("illegal argument `languageId`. must not be empty");let o;const a=(d=(u=this.initData.environment.extensionLogLevel)==null?void 0:u.find(([f])=>Ke.equals(i.identifier,f)))==null?void 0:d[1];a&&(o=nL(a));const l=new Ie,c=r?this.doCreateLogOutputChannel(e,o,i,l):this.doCreateOutputChannel(e,s,i,l);return c.then(f=>{this.channels.set(f.id,f),f.visible=f.id===this.visibleChannelId,l.add(Se(()=>this.channels.delete(f.id)))}),r?this.createExtHostLogOutputChannel(e,o??this.logService.getLevel(),c,l):this.createExtHostOutputChannel(e,c,l)}async doCreateOutputChannel(e,t,i,r){this.outputDirectoryPromise||(this.outputDirectoryPromise=this.extHostFileSystem.value.createDirectory(this.outputsLocation).then(()=>this.outputsLocation));const s=await this.outputDirectoryPromise,o=this.extHostFileSystemInfo.extUri.joinPath(s,`${this.namePool++}-${e.replace(/[\\/:\*\?"<>\|]/g,"")}.log`),a=r.add(this.loggerService.createLogger(o,{logLevel:"always",donotRotate:!0,donotUseFormatters:!0,hidden:!0})),l=await this.proxy.$register(e,o,t,i.identifier.value);return r.add(Se(()=>this.loggerService.deregisterLogger(o))),new V5(l,e,a,this.proxy,i)}async doCreateLogOutputChannel(e,t,i,r){const s=await this.createExtensionLogDirectory(i),o=e.replace(/[\\/:\*\?"<>\|]/g,""),a=this.extHostFileSystemInfo.extUri.joinPath(s,`${o}.log`),l=`${i.identifier.value}.${o}`,c=r.add(this.loggerService.createLogger(a,{id:l,name:e,logLevel:t,extensionId:i.identifier.value}));return r.add(Se(()=>this.loggerService.deregisterLogger(a))),new uL(l,e,c,this.proxy,i)}createExtensionLogDirectory(e){let t=this.extensionLogDirectoryPromise.get(e.identifier.value);if(!t){const i=this.extHostFileSystemInfo.extUri.joinPath(this.initData.logsLocation,e.identifier.value);this.extensionLogDirectoryPromise.set(e.identifier.value,t=(async()=>{try{await this.extHostFileSystem.value.createDirectory(i)}catch(r){if(cg(r)!==Ne.FileExists)throw r}return i})())}return t}createExtHostOutputChannel(e,t,i){const r=()=>{if(i.isDisposed)throw new Error("Channel has been closed")};return t.then(s=>i.add(s)),{get name(){return e},append(s){r(),t.then(o=>o.append(s))},appendLine(s){r(),t.then(o=>o.appendLine(s))},clear(){r(),t.then(s=>s.clear())},replace(s){r(),t.then(o=>o.replace(s))},show(s,o){r(),t.then(a=>a.show(s,o))},hide(){r(),t.then(s=>s.hide())},dispose(){i.dispose()}}}createExtHostLogOutputChannel(e,t,i,r){const s=()=>{if(r.isDisposed)throw new Error("Channel has been closed")},o=r.add(new L);function a(l){t=l,o.fire(l)}return i.then(l=>{l.logLevel!==t&&a(l.logLevel),r.add(l.onDidChangeLogLevel(c=>a(c)))}),{...this.createExtHostOutputChannel(e,i,r),get logLevel(){return t},onDidChangeLogLevel:o.event,trace(l,...c){s(),i.then(u=>u.trace(l,...c))},debug(l,...c){s(),i.then(u=>u.debug(l,...c))},info(l,...c){s(),i.then(u=>u.info(l,...c))},warn(l,...c){s(),i.then(u=>u.warn(l,...c))},error(l,...c){s(),i.then(u=>u.error(l,...c))}}}};M0=V([F(0,tt),F(1,In),F(2,S_),F(3,Ju),F(4,Qu),F(5,ct)],M0);const z5=De("IExtHostOutputService");var Cd,ko;let $0=(ko=class{constructor(e,t){this._logService=t,this._provider=new Map,this._proxy=e.getProxy(Z.MainThreadDecorations)}registerFileDecorationProvider(e,t){const i=Cd._handlePool++;this._provider.set(i,{provider:e,extensionDescription:t}),this._proxy.$registerDecorationProvider(i,t.identifier.value);const r=e.onDidChangeFileDecorations&&e.onDidChangeFileDecorations(s=>{if(!s){this._proxy.$onDidChange(i,null);return}const o=Bi(s);if(o.length<=Cd._maxEventSize){this._proxy.$onDidChange(i,o);return}this._logService.warn("[Decorations] CAPPING events from decorations provider",t.identifier.value,o.length);const a=o.map(u=>({uri:u,rank:n9(u.path,"/")})),l=O7(a,(u,d)=>u.rank-d.rank||fl(u.uri.path,d.uri.path)),c=[];e:for(const u of l){let d;for(const f of u){const p=Sc(f.uri.path);if(d!==p&&(d=p,c.push(f.uri)>=Cd._maxEventSize))break e}}this._proxy.$onDidChange(i,c)});return new je(()=>{r==null||r.dispose(),this._proxy.$unregisterDecorationProvider(i),this._provider.delete(i)})}async $provideDecorations(e,t,i){if(!this._provider.has(e))return Object.create(null);const r=Object.create(null),{provider:s,extensionDescription:o}=this._provider.get(e);return await Promise.all(t.map(async a=>{try{const{uri:l,id:c}=a,u=await Promise.resolve(s.provideFileDecoration(y.revive(l),i));if(!u)return;try{sb.validate(u),u.badge&&typeof u.badge!="string"&&$(o,"codiconDecoration"),r[c]=[u.propagate,u.tooltip,u.badge,u.color]}catch(d){this._logService.warn(`INVALID decoration from extension '${o.identifier.value}': ${d}`)}}catch(l){this._logService.error(l)}})),r}},Cd=ko,ko._handlePool=0,ko._maxEventSize=250,ko);$0=Cd=V([F(0,tt),F(1,ct)],$0);const q5=De("IExtHostDecorations");class dL{constructor(e){this.values=e,this.prefixSum=new Uint32Array(e.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}getCount(){return this.values.length}insertValues(e,t){e=Hl(e);const i=this.values,r=this.prefixSum,s=t.length;return s===0?!1:(this.values=new Uint32Array(i.length+s),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e),e+s),this.values.set(t,e),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(r.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}setValue(e,t){return e=Hl(e),t=Hl(t),this.values[e]===t?!1:(this.values[e]=t,e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),!0)}removeValues(e,t){e=Hl(e),t=Hl(t);const i=this.values,r=this.prefixSum;if(e>=i.length)return!1;const s=i.length-e;return t>=s&&(t=s),t===0?!1:(this.values=new Uint32Array(i.length-t),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e+t),e),this.prefixSum=new Uint32Array(this.values.length),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(r.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalSum(){return this.values.length===0?0:this._getPrefixSum(this.values.length-1)}getPrefixSum(e){return e<0?0:(e=Hl(e),this._getPrefixSum(e))}_getPrefixSum(e){if(e<=this.prefixSumValidIndex[0])return this.prefixSum[e];let t=this.prefixSumValidIndex[0]+1;t===0&&(this.prefixSum[0]=this.values[0],t++),e>=this.values.length&&(e=this.values.length-1);for(let i=t;i<=e;i++)this.prefixSum[i]=this.prefixSum[i-1]+this.values[i];return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],e),this.prefixSum[e]}getIndexOf(e){e=Math.floor(e),this.getTotalSum();let t=0,i=this.values.length-1,r=0,s=0,o=0;for(;t<=i;)if(r=t+(i-t)/2|0,s=this.prefixSum[r],o=s-this.values[r],e<o)i=r-1;else if(e>=s)t=r+1;else break;return new hL(r,e-o)}}class hL{constructor(e,t){this.index=e,this.remainder=t,this._prefixSumIndexOfResultBrand=void 0,this.index=e,this.remainder=t}}class fL{constructor(e,t,i,r){this._uri=e,this._lines=t,this._eol=i,this._versionId=r,this._lineStarts=null,this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return this._cachedTextValue===null&&(this._cachedTextValue=this._lines.join(this._eol)),this._cachedTextValue}onEvents(e){e.eol&&e.eol!==this._eol&&(this._eol=e.eol,this._lineStarts=null);const t=e.changes;for(const i of t)this._acceptDeleteRange(i.range),this._acceptInsertText(new Ii(i.range.startLineNumber,i.range.startColumn),i.text);this._versionId=e.versionId,this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const e=this._eol.length,t=this._lines.length,i=new Uint32Array(t);for(let r=0;r<t;r++)i[r]=this._lines[r].length+e;this._lineStarts=new dL(i)}}_setLineText(e,t){this._lines[e]=t,this._lineStarts&&this._lineStarts.setValue(e,this._lines[e].length+this._eol.length)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.startLineNumber-1].substring(e.endColumn-1));return}this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.endLineNumber-1].substring(e.endColumn-1)),this._lines.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t){if(t.length===0)return;const i=AI(t);if(i.length===1){this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]+this._lines[e.lineNumber-1].substring(e.column-1));return}i[i.length-1]+=this._lines[e.lineNumber-1].substring(e.column-1),this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]);const r=new Uint32Array(i.length-1);for(let s=1;s<i.length;s++)this._lines.splice(e.lineNumber+s-1,0,i[s]),r[s-1]=i[s].length+this._eol.length;this._lineStarts&&this._lineStarts.insertValues(e.lineNumber,r)}}const U0=new Map;function pL(n,e){e?U0.set(n,e):U0.delete(n)}function gL(n){return U0.get(n)}class mL extends fL{constructor(e,t,i,r,s,o,a,l){super(t,i,r,s),this._proxy=e,this._languageId=o,this._isDirty=a,this._encoding=l,this._isDisposed=!1}dispose(){Vn(!this._isDisposed),this._isDisposed=!0,this._isDirty=!1}equalLines(e){return $r(this._lines,e)}get document(){if(!this._document){const e=this;this._document={get uri(){return e._uri},get fileName(){return e._uri.fsPath},get isUntitled(){return e._uri.scheme===oe.untitled},get languageId(){return e._languageId},get version(){return e._versionId},get isClosed(){return e._isDisposed},get isDirty(){return e._isDirty},get encoding(){return e._encoding},save(){return e._save()},getText(t){return t?e._getTextInRange(t):e.getText()},get eol(){return e._eol===`
`?cr.LF:cr.CRLF},get lineCount(){return e._lines.length},lineAt(t){return e._lineAt(t)},offsetAt(t){return e._offsetAt(t)},positionAt(t){return e._positionAt(t)},validateRange(t){return e._validateRange(t)},validatePosition(t){return e._validatePosition(t)},getWordRangeAtPosition(t,i){return e._getWordRangeAtPosition(t,i)},[Symbol.for("debug.description")](){return`TextDocument(${e._uri.toString()})`}}}return Object.freeze(this._document)}_acceptLanguageId(e){Vn(!this._isDisposed),this._languageId=e}_acceptIsDirty(e){Vn(!this._isDisposed),this._isDirty=e}_acceptEncoding(e){Vn(!this._isDisposed),this._encoding=e}_save(){return this._isDisposed?Promise.reject(new Error("Document has been closed")):this._proxy.$trySaveDocument(this._uri)}_getTextInRange(e){const t=this._validateRange(e);if(t.isEmpty)return"";if(t.isSingleLine)return this._lines[t.start.line].substring(t.start.character,t.end.character);const i=this._eol,r=t.start.line,s=t.end.line,o=[];o.push(this._lines[r].substring(t.start.character));for(let a=r+1;a<s;a++)o.push(this._lines[a]);return o.push(this._lines[s].substring(0,t.end.character)),o.join(i)}_lineAt(e){let t;if(e instanceof We?t=e.line:typeof e=="number"&&(t=e),typeof t!="number"||t<0||t>=this._lines.length||Math.floor(t)!==t)throw new Error("Illegal value for `line`");return new _L(t,this._lines[t],t===this._lines.length-1)}_offsetAt(e){return e=this._validatePosition(e),this._ensureLineStarts(),this._lineStarts.getPrefixSum(e.line-1)+e.character}_positionAt(e){e=Math.floor(e),e=Math.max(0,e),this._ensureLineStarts();const t=this._lineStarts.getIndexOf(e),i=this._lines[t.index].length;return new We(t.index,Math.min(t.remainder,i))}_validateRange(e){if(!(e instanceof Oe))throw new Error("Invalid argument");const t=this._validatePosition(e.start),i=this._validatePosition(e.end);return t===e.start&&i===e.end?e:new Oe(t.line,t.character,i.line,i.character)}_validatePosition(e){if(!(e instanceof We))throw new Error("Invalid argument");if(this._lines.length===0)return e.with(0,0);let{line:t,character:i}=e,r=!1;if(t<0)t=0,i=0,r=!0;else if(t>=this._lines.length)t=this._lines.length-1,i=this._lines[t].length,r=!0;else{const s=this._lines[t].length;i<0?(i=0,r=!0):i>s&&(i=s,r=!0)}return r?new We(t,i):e}_getWordRangeAtPosition(e,t){const i=this._validatePosition(e);if(!t)t=gL(this._languageId);else if(TI(t))throw new Error(`[getWordRangeAtPosition]: ignoring custom regexp '${t.source}' because it matches the empty string.`);const r=yC(i.character+1,wC(t),this._lines[i.line],0);if(r)return new Oe(i.line,r.startColumn-1,i.line,r.endColumn-1)}}class _L{constructor(e,t,i){this._line=e,this._text=t,this._isLastLine=i}get lineNumber(){return this._line}get text(){return this._text}get range(){return new Oe(this._line,0,this._line,this._text.length)}get rangeIncludingLineBreak(){return this._isLastLine?this.range:new Oe(this._line,0,this._line+1,0)}get firstNonWhitespaceCharacterIndex(){return/^(\s*)/.exec(this._text)[1].length}get isEmptyOrWhitespace(){return this.firstNonWhitespaceCharacterIndex===this._text.length}}class o2{constructor(e){this._prefix=e,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}}const F1=class F1{constructor(e,t,i){const r=F1._Keys.nextId();e.$registerTextEditorDecorationType(t.identifier,r,Rb.from(i)),this.value=Object.freeze({key:r,dispose(){e.$removeTextEditorDecorationType(r)}})}};F1._Keys=new o2("TextEditorDecorationType");let H0=F1;class vL{constructor(e,t){this._collectedEdits=[],this._setEndOfLine=void 0,this._finalized=!1,this._document=e,this._documentVersionId=e.version,this._undoStopBefore=t.undoStopBefore,this._undoStopAfter=t.undoStopAfter}finalize(){return this._finalized=!0,{documentVersionId:this._documentVersionId,edits:this._collectedEdits,setEndOfLine:this._setEndOfLine,undoStopBefore:this._undoStopBefore,undoStopAfter:this._undoStopAfter}}_throwIfFinalized(){if(this._finalized)throw new Error("Edit is only valid while callback runs")}replace(e,t){this._throwIfFinalized();let i=null;if(e instanceof We)i=new Oe(e,e);else if(e instanceof Oe)i=e;else throw new Error("Unrecognized location");this._pushEdit(i,t,!1)}insert(e,t){this._throwIfFinalized(),this._pushEdit(new Oe(e,e),t,!0)}delete(e){this._throwIfFinalized();let t=null;if(e instanceof Oe)t=e;else throw new Error("Unrecognized location");this._pushEdit(t,null,!0)}_pushEdit(e,t,i){const r=this._document.validateRange(e);this._collectedEdits.push({range:r,text:t,forceMoveMarkers:i})}setEndOfLine(e){if(this._throwIfFinalized(),e!==cr.LF&&e!==cr.CRLF)throw Be("endOfLine");this._setEndOfLine=e}}class wL{constructor(e,t,i,r){this._proxy=e,this._id=t,this._accept(i),this._logService=r;const s=this;this.value={get tabSize(){return s._tabSize},set tabSize(o){s._setTabSize(o)},get indentSize(){return s._indentSize},set indentSize(o){s._setIndentSize(o)},get insertSpaces(){return s._insertSpaces},set insertSpaces(o){s._setInsertSpaces(o)},get cursorStyle(){return s._cursorStyle},set cursorStyle(o){s._setCursorStyle(o)},get lineNumbers(){return s._lineNumbers},set lineNumbers(o){s._setLineNumbers(o)}}}_accept(e){this._tabSize=e.tabSize,this._indentSize=e.indentSize,this._originalIndentSize=e.originalIndentSize,this._insertSpaces=e.insertSpaces,this._cursorStyle=e.cursorStyle,this._lineNumbers=$c.to(e.lineNumbers)}_validateTabSize(e){if(e==="auto")return"auto";if(typeof e=="number"){const t=Math.floor(e);return t>0?t:null}if(typeof e=="string"){const t=parseInt(e,10);return isNaN(t)?null:t>0?t:null}return null}_setTabSize(e){const t=this._validateTabSize(e);if(t!==null){if(typeof t=="number"){if(this._tabSize===t)return;this._tabSize=t}this._warnOnError("setTabSize",this._proxy.$trySetOptions(this._id,{tabSize:t}))}}_validateIndentSize(e){if(e==="tabSize")return"tabSize";if(typeof e=="number"){const t=Math.floor(e);return t>0?t:null}if(typeof e=="string"){const t=parseInt(e,10);return isNaN(t)?null:t>0?t:null}return null}_setIndentSize(e){const t=this._validateIndentSize(e);if(t!==null){if(typeof t=="number"){if(this._originalIndentSize===t)return;this._indentSize=t,this._originalIndentSize=t}this._warnOnError("setIndentSize",this._proxy.$trySetOptions(this._id,{indentSize:t}))}}_validateInsertSpaces(e){return e==="auto"?"auto":e==="false"?!1:!!e}_setInsertSpaces(e){const t=this._validateInsertSpaces(e);if(typeof t=="boolean"){if(this._insertSpaces===t)return;this._insertSpaces=t}this._warnOnError("setInsertSpaces",this._proxy.$trySetOptions(this._id,{insertSpaces:t}))}_setCursorStyle(e){this._cursorStyle!==e&&(this._cursorStyle=e,this._warnOnError("setCursorStyle",this._proxy.$trySetOptions(this._id,{cursorStyle:e})))}_setLineNumbers(e){this._lineNumbers!==e&&(this._lineNumbers=e,this._warnOnError("setLineNumbers",this._proxy.$trySetOptions(this._id,{lineNumbers:$c.from(e)})))}assign(e){const t={};let i=!1;if(typeof e.tabSize<"u"){const r=this._validateTabSize(e.tabSize);r==="auto"?(i=!0,t.tabSize=r):typeof r=="number"&&this._tabSize!==r&&(this._tabSize=r,i=!0,t.tabSize=r)}if(typeof e.indentSize<"u"){const r=this._validateIndentSize(e.indentSize);r==="tabSize"?(i=!0,t.indentSize=r):typeof r=="number"&&this._originalIndentSize!==r&&(this._indentSize=r,this._originalIndentSize=r,i=!0,t.indentSize=r)}if(typeof e.insertSpaces<"u"){const r=this._validateInsertSpaces(e.insertSpaces);r==="auto"?(i=!0,t.insertSpaces=r):this._insertSpaces!==r&&(this._insertSpaces=r,i=!0,t.insertSpaces=r)}typeof e.cursorStyle<"u"&&this._cursorStyle!==e.cursorStyle&&(this._cursorStyle=e.cursorStyle,i=!0,t.cursorStyle=e.cursorStyle),typeof e.lineNumbers<"u"&&this._lineNumbers!==e.lineNumbers&&(this._lineNumbers=e.lineNumbers,i=!0,t.lineNumbers=$c.from(e.lineNumbers)),i&&this._warnOnError("setOptions",this._proxy.$trySetOptions(this._id,t))}_warnOnError(e,t){t.catch(i=>{this._logService.warn(`ExtHostTextEditorOptions '${e}' failed:'`),this._logService.warn(i)})}}class bL{constructor(e,t,i,r,s,o,a,l){this.id=e,this._proxy=t,this._logService=i,this._disposed=!1,this._hasDecorationsForKey=new Set,this._selections=s,this._options=new wL(this._proxy,this.id,o,i),this._visibleRanges=a,this._viewColumn=l;const c=this;this.value=Object.freeze({get document(){return r.value},set document(u){throw new la("document")},get selection(){return c._selections&&c._selections[0]},set selection(u){if(!(u instanceof $s))throw Be("selection");c._selections=[u],c._trySetSelection()},get selections(){return c._selections},set selections(u){if(!Array.isArray(u)||u.some(d=>!(d instanceof $s)))throw Be("selections");c._selections=u,c._trySetSelection()},get visibleRanges(){return c._visibleRanges},set visibleRanges(u){throw new la("visibleRanges")},get diffInformation(){return c._diffInformation},get options(){return c._options.value},set options(u){c._disposed||c._options.assign(u)},get viewColumn(){return c._viewColumn},set viewColumn(u){throw new la("viewColumn")},edit(u,d={undoStopBefore:!0,undoStopAfter:!0}){if(c._disposed)return Promise.reject(new Error("TextEditor#edit not possible on closed editors"));const f=new vL(r.value,d);return u(f),c._applyEdit(f)},insertSnippet(u,d,f={undoStopBefore:!0,undoStopAfter:!0}){if(c._disposed)return Promise.reject(new Error("TextEditor#insertSnippet not possible on closed editors"));let p;if(!d||Array.isArray(d)&&d.length===0)p=c._selections.map(w=>W.from(w));else if(d instanceof We){const{lineNumber:w,column:v}=nt.from(d);p=[{startLineNumber:w,startColumn:v,endLineNumber:w,endColumn:v}]}else if(d instanceof Oe)p=[W.from(d)];else{p=[];for(const w of d)if(w instanceof Oe)p.push(W.from(w));else{const{lineNumber:v,column:m}=nt.from(w);p.push({startLineNumber:v,startColumn:m,endLineNumber:v,endColumn:m})}}return f.keepWhitespace===void 0&&(f.keepWhitespace=!1),t.$tryInsertSnippet(e,r.value.version,u.value,p,f)},setDecorations(u,d){const f=d.length===0;f&&!c._hasDecorationsForKey.has(u.key)||(f?c._hasDecorationsForKey.delete(u.key):c._hasDecorationsForKey.add(u.key),c._runOnProxy(()=>{if(p5(d))return t.$trySetDecorations(e,u.key,C3(d));{const p=new Array(4*d.length);for(let w=0,v=d.length;w<v;w++){const m=d[w];p[4*w]=m.start.line+1,p[4*w+1]=m.start.character+1,p[4*w+2]=m.end.line+1,p[4*w+3]=m.end.character+1}return t.$trySetDecorationsFast(e,u.key,p)}}))},revealRange(u,d){c._runOnProxy(()=>t.$tryRevealRange(e,W.from(u),d||Yg.Default))},show(u){t.$tryShowEditor(e,nn.from(u))},hide(){t.$tryHideEditor(e)},[Symbol.for("debug.description")](){return`TextEditor(${this.document.uri.toString()})`}})}dispose(){Vn(!this._disposed),this._disposed=!0}_acceptOptions(e){Vn(!this._disposed),this._options._accept(e)}_acceptVisibleRanges(e){Vn(!this._disposed),this._visibleRanges=e}_acceptViewColumn(e){Vn(!this._disposed),this._viewColumn=e}_acceptSelections(e){Vn(!this._disposed),this._selections=e}_acceptDiffInformation(e){Vn(!this._disposed),this._diffInformation=e}async _trySetSelection(){const e=this._selections.map(pr.from);return await this._runOnProxy(()=>this._proxy.$trySetSelections(this.id,e)),this.value}_applyEdit(e){const t=e.finalize();if(t.edits.length===0&&!t.setEndOfLine)return Promise.resolve(!0);const i=t.edits.map(s=>s.range);i.sort((s,o)=>s.end.line===o.end.line?s.end.character===o.end.character?s.start.line===o.start.line?s.start.character-o.start.character:s.start.line-o.start.line:s.end.character-o.end.character:s.end.line-o.end.line);for(let s=0,o=i.length-1;s<o;s++){const a=i[s].end;if(i[s+1].start.isBefore(a))return Promise.reject(new Error("Overlapping ranges are not allowed!"))}const r=t.edits.map(s=>({range:W.from(s.range),text:s.text,forceMoveMarkers:s.forceMoveMarkers}));return this._proxy.$tryApplyEdits(this.id,t.documentVersionId,r,{setEndOfLine:typeof t.setEndOfLine=="number"?Nu.from(t.setEndOfLine):void 0,undoStopBefore:t.undoStopBefore,undoStopAfter:t.undoStopAfter})}_runOnProxy(e){return this._disposed?(this._logService.warn("TextEditor is closed/disposed"),Promise.resolve(void 0)):e().then(()=>this,t=>(t instanceof Error&&t.name==="DISPOSED"||this._logService.warn(t),null))}}class yL{constructor(e){this.value=e,this._count=0}ref(){this._count++}unref(){return--this._count===0}}let B0=class{constructor(e,t){this._extHostRpc=e,this._logService=t,this._activeEditorId=null,this._editors=new Map,this._documents=new on,this._onDidAddDocuments=new L,this._onDidRemoveDocuments=new L,this._onDidChangeVisibleTextEditors=new L,this._onDidChangeActiveTextEditor=new L,this.onDidAddDocuments=this._onDidAddDocuments.event,this.onDidRemoveDocuments=this._onDidRemoveDocuments.event,this.onDidChangeVisibleTextEditors=this._onDidChangeVisibleTextEditors.event,this.onDidChangeActiveTextEditor=this._onDidChangeActiveTextEditor.event}$acceptDocumentsAndEditorsDelta(e){this.acceptDocumentsAndEditorsDelta(e)}acceptDocumentsAndEditorsDelta(e){const t=[],i=[],r=[];if(e.removedDocuments)for(const s of e.removedDocuments){const o=y.revive(s),a=this._documents.get(o);a!=null&&a.unref()&&(this._documents.delete(o),t.push(a.value))}if(e.addedDocuments)for(const s of e.addedDocuments){const o=y.revive(s.uri);let a=this._documents.get(o);if(a&&o.scheme!==oe.vscodeNotebookCell&&o.scheme!==oe.vscodeInteractiveInput)throw new Error(`document '${o} already exists!'`);a||(a=new yL(new mL(this._extHostRpc.getProxy(Z.MainThreadDocuments),o,s.lines,s.EOL,s.versionId,s.languageId,s.isDirty,s.encoding)),this._documents.set(o,a),i.push(a.value)),a.ref()}if(e.removedEditors)for(const s of e.removedEditors){const o=this._editors.get(s);this._editors.delete(s),o&&r.push(o)}if(e.addedEditors)for(const s of e.addedEditors){const o=y.revive(s.documentUri);Vn(this._documents.has(o),`document '${o}' does not exist`),Vn(!this._editors.has(s.id),`editor '${s.id}' already exists!`);const a=this._documents.get(o).value,l=new bL(s.id,this._extHostRpc.getProxy(Z.MainThreadTextEditors),this._logService,new Ci(()=>a.document),s.selections.map(pr.to),s.options,s.visibleRanges.map(c=>W.to(c)),typeof s.editorPosition=="number"?nn.to(s.editorPosition):void 0);this._editors.set(s.id,l)}e.newActiveEditor!==void 0&&(Vn(e.newActiveEditor===null||this._editors.has(e.newActiveEditor),`active editor '${e.newActiveEditor}' does not exist`),this._activeEditorId=e.newActiveEditor),Ns(t),Ns(r),e.removedDocuments&&this._onDidRemoveDocuments.fire(t),e.addedDocuments&&this._onDidAddDocuments.fire(i),(e.removedEditors||e.addedEditors)&&this._onDidChangeVisibleTextEditors.fire(this.allEditors().map(s=>s.value)),e.newActiveEditor!==void 0&&this._onDidChangeActiveTextEditor.fire(this.activeEditor())}getDocument(e){var t;return(t=this._documents.get(e))==null?void 0:t.value}allDocuments(){return zn.map(this._documents.values(),e=>e.value)}getEditor(e){return this._editors.get(e)}activeEditor(e){if(!this._activeEditorId)return;const t=this._editors.get(this._activeEditorId);return e?t:t==null?void 0:t.value}allEditors(){return[...this._editors.values()]}};B0=V([F(0,tt),F(1,ct)],B0);const ed=De("IExtHostDocumentsAndEditors"),C_=De("IExtHostApiDeprecationService");let W0=class{constructor(e,t){this._extHostLogService=t,this._reportedUsages=new Set,this._telemetryShape=e.getProxy(Z.MainThreadTelemetry)}report(e,t,i){const r=this.getUsageKey(e,t);this._reportedUsages.has(r)||(this._reportedUsages.add(r),t.isUnderDevelopment&&this._extHostLogService.warn(`[Deprecation Warning] '${e}' is deprecated. ${i}`),this._telemetryShape.$publicLog2("extHostDeprecatedApiUsage",{extensionId:t.identifier.value,apiId:e}))}getUsageKey(e,t){return`${e}-${t.identifier.value}`}};W0=V([F(0,tt),F(1,ct)],W0);const xL={type:"object",additionalProperties:!1,properties:{type:{type:"string",description:h(9949,"The actual task type. Please note that types starting with a '$' are reserved for internal usage.")},required:{type:"array",items:{type:"string"}},properties:{type:"object",description:h(9950,"Additional properties of the task type"),additionalProperties:{$ref:"http://json-schema.org/draft-07/schema#"}},when:{type:"string",markdownDescription:h(9951,"Condition which must be true to enable this type of task. Consider using `shellExecutionSupported`, `processExecutionSupported`, and `customExecutionSupported` as appropriate for this task definition. See the [API documentation](https://code.visualstudio.com/api/extension-guides/task-provider#when-clause) for more information."),default:""}}};var V0;(function(n){function e(t,i,r){if(!t)return;const s=Ze(t.type)?t.type:void 0;if(!s||s.length===0){r.error(h(9952,"The task type configuration is missing the required 'taskType' property"));return}const o=[];if(Array.isArray(t.required))for(const a of t.required)Ze(a)&&o.push(a);return{extensionId:i.value,taskType:s,required:o,properties:t.properties?_t(t.properties):{},when:t.when?mt.deserialize(t.when):void 0}}n.from=e})(V0||(V0={}));const EL=CC.registerExtensionPoint({extensionPoint:"taskDefinitions",activationEventsGenerator:(n,e)=>{for(const t of n)t.type&&e.push(`onTaskType:${t.type}`)},jsonSchema:{description:h(9953,"Contributes task kinds"),type:"array",items:xL}});class SL{constructor(){this._onDefinitionsChanged=new L,this.onDefinitionsChanged=this._onDefinitionsChanged.event,this.taskTypes=Object.create(null),this.readyPromise=new Promise((e,t)=>{EL.setHandler((i,r)=>{this._schema=void 0;try{for(const s of r.removed){const o=s.value;for(const a of o)this.taskTypes&&a.type&&this.taskTypes[a.type]&&delete this.taskTypes[a.type]}for(const s of r.added){const o=s.value;for(const a of o){const l=V0.from(a,s.description.identifier,s.collector);l&&(this.taskTypes[l.taskType]=l)}}(r.removed.length>0||r.added.length>0)&&this._onDefinitionsChanged.fire()}catch{}e(void 0)})})}onReady(){return this.readyPromise}get(e){return this.taskTypes[e]}all(){return Object.keys(this.taskTypes).map(e=>this.taskTypes[e])}getJsonSchema(){if(this._schema===void 0){const e=[];for(const t of this.all()){const i={type:"object",additionalProperties:!1};t.required.length>0&&(i.required=t.required.slice(0)),t.properties!==void 0?i.properties=_t(t.properties):i.properties=Object.create(null),i.properties.type={type:"string",enum:[t.taskType]},e.push(i)}this._schema={oneOf:e}}return this._schema}}const DL=new SL,kL="settings";new C("taskRunning",!1,h(9963,"Whether a task is currently running."));new C("taskTerminalActive",!1,h(9964,"Whether the active terminal is a task terminal."));dx(9965,"Tasks");var a1;(function(n){n[n.Escape=1]="Escape",n[n.Strong=2]="Strong",n[n.Weak=3]="Weak"})(a1||(a1={}));(function(n){function e(t){if(!t)return n.Strong;switch(t.toLowerCase()){case"escape":return n.Escape;case"strong":return n.Strong;case"weak":return n.Weak;default:return n.Strong}}n.from=e})(a1||(a1={}));var pD;(function(n){n.defaults={cwd:"${workspaceFolder}"}})(pD||(pD={}));var vf;(function(n){n[n.Always=1]="Always",n[n.Silent=2]="Silent",n[n.Never=3]="Never"})(vf||(vf={}));(function(n){function e(t){switch(t.toLowerCase()){case"always":return n.Always;case"silent":return n.Silent;case"never":return n.Never;default:return n.Always}}n.fromString=e})(vf||(vf={}));var wf;(function(n){n[n.Never=1]="Never",n[n.OnProblem=2]="OnProblem",n[n.Always=3]="Always"})(wf||(wf={}));(function(n){function e(t){switch(t.toLowerCase()){case"always":return n.Always;case"never":return n.Never;case"onproblem":return n.OnProblem;default:return n.OnProblem}}n.fromString=e})(wf||(wf={}));var bf;(function(n){n[n.Shared=1]="Shared",n[n.Dedicated=2]="Dedicated",n[n.New=3]="New"})(bf||(bf={}));(function(n){function e(t){switch(t.toLowerCase()){case"shared":return n.Shared;case"dedicated":return n.Dedicated;case"new":return n.New;default:return n.Shared}}n.fromString=e})(bf||(bf={}));var gD;(function(n){n.defaults={echo:!0,reveal:vf.Always,revealProblems:wf.Never,focus:!1,panel:bf.Shared,showReuseMessage:!0,clear:!1}})(gD||(gD={}));var l1;(function(n){n[n.Shell=1]="Shell",n[n.Process=2]="Process",n[n.CustomExecution=3]="CustomExecution"})(l1||(l1={}));(function(n){function e(i){switch(i.toLowerCase()){case"shell":return n.Shell;case"process":return n.Process;case"customExecution":return n.CustomExecution;default:return n.Process}}n.fromString=e;function t(i){switch(i){case n.Shell:return"shell";case n.Process:return"process";case n.CustomExecution:return"customExecution";default:return"process"}}n.toString=t})(l1||(l1={}));var mD;(function(n){function e(t){return Ze(t)?t:t.value}n.value=e})(mD||(mD={}));var _D;(function(n){n.Clean={_id:"clean",isDefault:!1},n.Build={_id:"build",isDefault:!1},n.Rebuild={_id:"rebuild",isDefault:!1},n.Test={_id:"test",isDefault:!1};function e(i){return i===n.Clean._id||i===n.Build._id||i===n.Rebuild._id||i===n.Test._id}n.is=e;function t(i){if(i!==void 0)return Ze(i)?e(i)?{_id:i,isDefault:!1}:void 0:i}n.from=t})(_D||(_D={}));var vD;(function(n){n[n.Global=1]="Global",n[n.Workspace=2]="Workspace",n[n.Folder=3]="Folder"})(vD||(vD={}));var wD;(function(n){n.Workspace="workspace",n.Extension="extension",n.InMemory="inMemory",n.WorkspaceFile="workspaceFile",n.User="user";function e(t){switch(t){case n.User:return dn.USER;case n.WorkspaceFile:return dn.WORKSPACE;default:return dn.WORKSPACE_FOLDER}}n.toConfigurationTarget=e})(wD||(wD={}));var bD;(function(n){n.parallel="parallel",n.sequence="sequence"})(bD||(bD={}));var z0;(function(n){n[n.default=1]="default",n[n.folderOpen=2]="folderOpen"})(z0||(z0={}));var yD;(function(n){n.defaults={reevaluateOnRerun:!0,runOn:z0.default,instanceLimit:1}})(yD||(yD={}));var c1;(function(n){n[n.Process=1]="Process",n[n.Terminal=2]="Terminal"})(c1||(c1={}));(function(n){n._default=n.Terminal})(c1||(c1={}));var xD;(function(n){n[n.V0_1_0=1]="V0_1_0",n[n.V2_0_0=2]="V2_0_0"})(xD||(xD={}));var u1;(function(n){n.SingleRun="singleRun",n.Background="background"})(u1||(u1={}));var Yo;(function(n){n.Changed="changed",n.ProcessStarted="processStarted",n.ProcessEnded="processEnded",n.Terminated="terminated",n.Start="start",n.AcquiredInput="acquiredInput",n.DependsOnStarted="dependsOnStarted",n.Active="active",n.Inactive="inactive",n.End="end",n.ProblemMatcherStarted="problemMatcherStarted",n.ProblemMatcherEnded="problemMatcherEnded",n.ProblemMatcherFoundErrors="problemMatcherFoundErrors"})(Yo||(Yo={}));var ED;(function(n){n[n.System=0]="System",n[n.User=1]="User",n[n.FolderOpen=2]="FolderOpen",n[n.ConfigurationChange=3]="ConfigurationChange",n[n.Reconnect=4]="Reconnect"})(ED||(ED={}));var SD;(function(n){function e(l){return{taskId:l._id,taskName:l.configurationProperties.name,runType:l.configurationProperties.isBackground?u1.Background:u1.SingleRun,group:l.configurationProperties.group,__task:l}}function t(l,c,u){return{...e(l),kind:Yo.Start,terminalId:c,resolvedVariables:u}}n.start=t;function i(l,c,u){return{...e(l),kind:Yo.ProcessStarted,terminalId:c,processId:u}}n.processStarted=i;function r(l,c,u){return{...e(l),kind:Yo.ProcessEnded,terminalId:c,exitCode:u}}n.processEnded=r;function s(l,c,u){return{...e(l),kind:Yo.Terminated,exitReason:u,terminalId:c}}n.terminated=s;function o(l,c,u){return{...e(c),kind:l,terminalId:u}}n.general=o;function a(){return{kind:Yo.Changed}}n.changed=a})(SD||(SD={}));var d1;(function(n){function e(i){const r=Object.keys(i).sort();let s="";for(const o of r){let a=i[o];a instanceof Object?a=e(a):typeof a=="string"&&(a=a.replace(/,/g,",,")),s+=o+","+a+","}return s}function t(i){const s={_key:e(i),type:i.taskType};return Object.assign(s,i),s}n.create=t})(d1||(d1={}));var DD;(function(n){n.AutoDetect="task.autoDetect",n.SaveBeforeRun="task.saveBeforeRun",n.ShowDecorations="task.showDecorations",n.ProblemMatchersNeverPrompt="task.problemMatchers.neverPrompt",n.SlowProviderWarning="task.slowProviderWarning",n.QuickOpenHistory="task.quickOpen.history",n.QuickOpenDetail="task.quickOpen.detail",n.QuickOpenSkip="task.quickOpen.skip",n.QuickOpenShowAll="task.quickOpen.showAll",n.AllowAutomaticTasks="task.allowAutomaticTasks",n.Reconnection="task.reconnection",n.VerboseLogging="task.verboseLogging"})(DD||(DD={}));var kD;(function(n){n.Tasks="tasks",n.SuppressTaskName="tasks.suppressTaskName",n.Windows="tasks.windows",n.Osx="tasks.osx",n.Linux="tasks.linux",n.ShowOutput="tasks.showOutput",n.IsShellCommand="tasks.isShellCommand",n.ServiceTestSetting="tasks.service.testSetting"})(kD||(kD={}));var ID;(function(n){function e(t,i){const r=DL.get(t.type);if(r===void 0){const l=_t(t);return delete l._key,d1.create(l)}const s=Object.create(null);s.type=r.taskType;const o=new Set;r.required.forEach(l=>o.add(l));const a=r.properties;for(const l of Object.keys(a)){const c=t[l];if(c!=null)s[l]=c;else if(o.has(l)){const u=a[l];if(u.default!==void 0)s[l]=_t(u.default);else switch(u.type){case"boolean":s[l]=!1;break;case"number":case"integer":s[l]=0;break;case"string":s[l]="";break;default:i.error(h(9966,"Error: the task identifier '{0}' is missing the required property '{1}'. The task identifier will be ignored.",JSON.stringify(t,void 0,0),l));return}}}return d1.create(s)}n.createTaskIdentifier=e})(ID||(ID={}));var h1;(function(n){function e(i){if(i!=null)return i}n.from=e;function t(i){if(i!=null)return i}n.to=t})(h1||(h1={}));var f1;(function(n){function e(i){if(i!=null)return i}n.from=e;function t(i){if(i!=null)return i}n.to=t})(f1||(f1={}));var q0;(function(n){function e(i){if(i!=null)return i}n.from=e;function t(i){if(i!=null)return i}n.to=t})(q0||(q0={}));var Yd;(function(n){function e(r){if(r){const s=r;return s&&!!s.process}else return!1}n.is=e;function t(r){if(r==null)return;const s={process:r.process,args:r.args};return r.options&&(s.options=q0.from(r.options)),s}n.from=t;function i(r){if(r!=null)return new Eu(r.process,r.args,r.options)}n.to=i})(Yd||(Yd={}));var j0;(function(n){function e(i){if(i!=null)return i}n.from=e;function t(i){if(i!=null)return i}n.to=t})(j0||(j0={}));var Zd;(function(n){function e(r){if(r){const s=r;return s&&(!!s.commandLine||!!s.command)}else return!1}n.is=e;function t(r){if(r==null)return;const s={};return r.commandLine!==void 0?s.commandLine=r.commandLine:(s.command=r.command,s.args=r.args),r.options&&(s.options=j0.from(r.options)),s}n.from=t;function i(r){if(!(r==null||r.command===void 0&&r.commandLine===void 0))return r.commandLine?new wl(r.commandLine,r.options):new wl(r.command,r.args?r.args:[],r.options)}n.to=i})(Zd||(Zd={}));var Ls;(function(n){function e(r){if(r){const s=r;return s&&s.customExecution==="customExecution"}else return!1}n.is=e;function t(r){return{customExecution:"customExecution"}}n.from=t;function i(r,s){return s.get(r)}n.to=i})(Ls||(Ls={}));var CD;(function(n){function e(t,i){let r;return t.scope!==void 0&&typeof t.scope!="number"?r=t.scope.uri:t.scope!==void 0&&typeof t.scope=="number"&&(t.scope===Po.Workspace&&i&&i.workspaceFile?r=i.workspaceFile:r=kL),{id:t._id,workspaceFolder:r}}n.from=e})(CD||(CD={}));var G0;(function(n){function e(t){if(t!=null)return{_id:t.id,isDefault:t.isDefault}}n.from=e})(G0||(G0={}));var bo;(function(n){function e(r,s){if(r==null)return[];const o=[];for(const a of r){const l=t(a,s);l&&o.push(l)}return o}n.fromMany=e;function t(r,s){if(r==null)return;let o;r.execution instanceof Eu?o=Yd.from(r.execution):r.execution instanceof wl?o=Zd.from(r.execution):r.execution&&r.execution instanceof $x&&(o=Ls.from(r.execution));const a=h1.from(r.definition);let l;return r.scope?typeof r.scope=="number"?l=r.scope:l=r.scope.uri:l=Po.Workspace,!a||!l?void 0:{_id:r._id,definition:a,name:r.name,source:{extensionId:s.identifier.value,label:r.source,scope:l},execution:o,isBackground:r.isBackground,group:G0.from(r.group),presentationOptions:f1.from(r.presentationOptions),problemMatchers:Bi(r.problemMatchers),hasDefinedMatchers:r.hasDefinedMatchers,runOptions:r.runOptions?r.runOptions:{reevaluateOnRerun:!0},detail:r.detail}}n.from=t;async function i(r,s,o){if(r==null)return;let a;Yd.is(r.execution)?a=Yd.to(r.execution):Zd.is(r.execution)?a=Zd.to(r.execution):Ls.is(r.execution)&&(a=Ls.to(r._id,o));const l=h1.to(r.definition);let c;if(r.source&&(r.source.scope!==void 0?typeof r.source.scope=="number"?c=r.source.scope:c=await s.resolveWorkspaceFolder(y.revive(r.source.scope)):c=Po.Workspace),!l||!c)return;const u=new tm(l,c,r.name,r.source.label,a,r.problemMatchers);return r.isBackground!==void 0&&(u.isBackground=r.isBackground),r.group!==void 0&&(u.group=Nh.from(r.group._id),u.group&&r.group.isDefault&&(u.group=new Nh(u.group.id,u.group.label),r.group.isDefault===!0&&(u.group.isDefault=r.group.isDefault))),r.presentationOptions&&(u.presentationOptions=f1.to(r.presentationOptions)),r._id&&(u._id=r._id),r.detail&&(u.detail=r.detail),u}n.to=i})(bo||(bo={}));var Q0;(function(n){function e(i){return i}n.from=e;function t(i){if(i)return Object.assign(Object.create(null),i)}n.to=t})(Q0||(Q0={}));var Pf;class mv{constructor(e,t,i){ge(this,Pf);this._id=t,this._task=i,ie(this,Pf,e)}get task(){return this._task}terminate(){A(this,Pf).terminateTask(this)}fireDidStartProcess(e){}fireDidEndProcess(e){}}Pf=new WeakMap;let J0=class{constructor(e,t,i,r,s,o,a,l){this._onDidExecuteTask=new L,this._onDidTerminateTask=new L,this._onDidTaskProcessStarted=new L,this._onDidTaskProcessEnded=new L,this._onDidStartTaskProblemMatchers=new L,this._onDidEndTaskProblemMatchers=new L,this._proxy=e.getProxy(Z.MainThreadTask),this._workspaceProvider=i,this._editorService=r,this._configurationService=s,this._terminalService=o,this._handleCounter=0,this._handlers=new Map,this._taskExecutions=new Map,this._taskExecutionPromises=new Map,this._providedCustomExecutions2=new Map,this._notProvidedCustomExecutions=new Set,this._activeCustomExecutions2=new Map,this._logService=a,this._deprecationService=l,this._proxy.$registerSupportedExecutions(!0)}registerTaskProvider(e,t,i){if(!i)return new je(()=>{});const r=this.nextHandle();return this._handlers.set(r,{type:t,provider:i,extension:e}),this._proxy.$registerTaskProvider(r,t),new je(()=>{this._handlers.delete(r),this._proxy.$unregisterTaskProvider(r)})}registerTaskSystem(e,t){this._proxy.$registerTaskSystem(e,t)}fetchTasks(e){return this._proxy.$fetchTasks(Q0.from(e)).then(async t=>{const i=[];for(const r of t){const s=await bo.to(r,this._workspaceProvider,this._providedCustomExecutions2);s&&i.push(s)}return i})}get taskExecutions(){const e=[];return this._taskExecutions.forEach(t=>e.push(t)),e}terminateTask(e){if(!(e instanceof mv))throw new Error("No valid task execution provided");return this._proxy.$terminateTask(e._id)}get onDidStartTask(){return this._onDidExecuteTask.event}async $onDidStartTask(e,t,i){const r=this._providedCustomExecutions2.get(e.id);r&&(this._activeCustomExecutions2.set(e.id,r),this._terminalService.attachPtyToTerminal(t,await r.callback(i))),this._lastStartedTask=e.id,this._onDidExecuteTask.fire({execution:await this.getTaskExecution(e)})}get onDidEndTask(){return this._onDidTerminateTask.event}async $OnDidEndTask(e){if(!this._taskExecutionPromises.has(e.id))return;const t=await this.getTaskExecution(e);this._taskExecutionPromises.delete(e.id),this._taskExecutions.delete(e.id),this.customExecutionComplete(e),this._onDidTerminateTask.fire({execution:t})}get onDidStartTaskProcess(){return this._onDidTaskProcessStarted.event}async $onDidStartTaskProcess(e){const t=await this.getTaskExecution(e.id);this._onDidTaskProcessStarted.fire({execution:t,processId:e.processId})}get onDidEndTaskProcess(){return this._onDidTaskProcessEnded.event}async $onDidEndTaskProcess(e){const t=await this.getTaskExecution(e.id);this._onDidTaskProcessEnded.fire({execution:t,exitCode:e.exitCode})}get onDidStartTaskProblemMatchers(){return this._onDidStartTaskProblemMatchers.event}async $onDidStartTaskProblemMatchers(e){let t;try{t=await this.getTaskExecution(e.execution.id)}catch{return}this._onDidStartTaskProblemMatchers.fire({execution:t})}get onDidEndTaskProblemMatchers(){return this._onDidEndTaskProblemMatchers.event}async $onDidEndTaskProblemMatchers(e){let t;try{t=await this.getTaskExecution(e.execution.id)}catch{return}this._onDidEndTaskProblemMatchers.fire({execution:t,hasErrors:e.hasErrors})}$provideTasks(e,t){const i=this._handlers.get(e);if(!i)return Promise.reject(new Error("no handler found"));const r=[],s=Nn(()=>i.provider.provideTasks(Pt.None)).then(o=>this.provideTasksInternal(t,r,i,o));return new Promise(o=>{s.then(a=>{Promise.all(r).then(()=>{o(a)})})})}async $resolveTask(e,t){const i=this._handlers.get(e);if(!i)return Promise.reject(new Error("no handler found"));if(t.definition.type!==i.type)throw new Error(`Unexpected: Task of type [${t.definition.type}] cannot be resolved by provider of type [${i.type}].`);const r=await bo.to(t,this._workspaceProvider,this._providedCustomExecutions2);if(!r)throw new Error("Unexpected: Task cannot be resolved.");const s=await i.provider.resolveTask(r,Pt.None);if(!s)return;this.checkDeprecation(s,i);const o=bo.from(s,i.extension);if(!o)throw new Error("Unexpected: Task cannot be resolved.");if(s.definition!==r.definition)throw new Error("Unexpected: The resolved task definition must be the same object as the original task definition. The task definition cannot be changed.");return Ls.is(o.execution)&&await this.addCustomExecution(o,s,!0),await this.resolveTaskInternal(o)}nextHandle(){return this._handleCounter++}async addCustomExecution(e,t,i){const r=await this._proxy.$createTaskId(e);!i&&!this._providedCustomExecutions2.has(r)&&(this._notProvidedCustomExecutions.add(r),this._activeCustomExecutions2.set(r,t.execution)),this._providedCustomExecutions2.set(r,t.execution)}async getTaskExecution(e,t){if(typeof e=="string"){const s=this._taskExecutionPromises.get(e);if(!s)throw new Wr("Unexpected: The specified task is missing an execution");return s}const i=this._taskExecutionPromises.get(e.id);if(i)return i;let r;return t?r=Promise.resolve(new mv(this,e.id,t)):r=bo.to(e.task,this._workspaceProvider,this._providedCustomExecutions2).then(s=>{if(!s)throw new Wr("Unexpected: Task does not exist.");return new mv(this,e.id,s)}),this._taskExecutionPromises.set(e.id,r),r.then(s=>(this._taskExecutions.set(e.id,s),s))}checkDeprecation(e,t){e._deprecated&&this._deprecationService.report("Task.constructor",t.extension,"Use the Task constructor that takes a `scope` instead.")}customExecutionComplete(e){this._activeCustomExecutions2.get(e.id)&&this._activeCustomExecutions2.delete(e.id),this._notProvidedCustomExecutions.has(e.id)&&this._lastStartedTask!==e.id&&(this._providedCustomExecutions2.delete(e.id),this._notProvidedCustomExecutions.delete(e.id));const i=this._notProvidedCustomExecutions.values();let r=i.next();for(;!r.done;)!this._activeCustomExecutions2.has(r.value)&&this._lastStartedTask!==r.value&&(this._providedCustomExecutions2.delete(r.value),this._notProvidedCustomExecutions.delete(r.value)),r=i.next()}};J0=V([F(0,tt),F(1,In),F(2,Hs),F(3,ed),F(4,Bs),F(5,Ku),F(6,ct),F(7,C_)],J0);let X0=class extends J0{constructor(e,t,i,r,s,o,a,l){super(e,t,i,r,s,o,a,l),this.registerTaskSystem(oe.vscodeRemote,{scheme:oe.vscodeRemote,authority:"",platform:CP(ar.Web)})}async executeTask(e,t){if(!t.execution)throw new Error("Tasks to execute must include an execution");const i=bo.from(t,e);if(i===void 0)throw new Error("Task is not valid");if(Ls.is(i.execution))await this.addCustomExecution(i,t,!1);else throw new Nv;const r=await this.getTaskExecution(await this._proxy.$getTaskExecution(i),t);return this._proxy.$executeTask(i).catch(s=>{throw new Error(s)}),r}provideTasksInternal(e,t,i,r){const s=[];if(r)for(const o of r){if(this.checkDeprecation(o,i),!o.definition||!e[o.definition.type]){const l=o.source?o.source:"No task source";this._logService.warn(`The task [${l}, ${o.name}] uses an undefined task type. The task will be ignored in the future.`)}const a=bo.from(o,i.extension);a&&Ls.is(a.execution)?(s.push(a),t.push(this.addCustomExecution(a,o,!0))):this._logService.warn("Only custom execution tasks supported.")}return{tasks:s,extension:i.extension}}async resolveTaskInternal(e){if(Ls.is(e.execution))return e;this._logService.warn("Only custom execution tasks supported.")}async $resolveVariables(e,t){return{process:void 0,variables:Object.create(null)}}async $jsonTasksSupported(){return!1}async $findExecutable(e,t,i){}};X0=V([F(0,tt),F(1,In),F(2,Hs),F(3,ed),F(4,Bs),F(5,Ku),F(6,ct),F(7,C_)],X0);const j5=De("IExtHostTask");class IL{constructor(){this.pendingRequests=new Map,this.queue=[],this._onError=new L,this._onExit=new L,this.sequence=1}get onError(){return this._onError.event}get onExit(){return this._onExit.event}onMessage(e){this.messageCallback&&this._onError.fire(new Error("attempt to set more than one 'Message' callback")),this.messageCallback=e}onEvent(e){this.eventCallback&&this._onError.fire(new Error("attempt to set more than one 'Event' callback")),this.eventCallback=e}onRequest(e){this.requestCallback&&this._onError.fire(new Error("attempt to set more than one 'Request' callback")),this.requestCallback=e}sendResponse(e){e.seq>0?this._onError.fire(new Error(`attempt to send more than one response for command ${e.command}`)):this.internalSend("response",e)}sendRequest(e,t,i,r){const s={command:e};if(t&&Object.keys(t).length>0&&(s.arguments=t),this.internalSend("request",s),typeof r=="number"){const o=setTimeout(()=>{clearTimeout(o);const a=this.pendingRequests.get(s.seq);if(a){this.pendingRequests.delete(s.seq);const l={type:"response",seq:0,request_seq:s.seq,success:!1,command:e,message:h(5900,"Timeout after {0} ms for '{1}'",r,e)};a(l)}},r)}return i&&this.pendingRequests.set(s.seq,i),s.seq}acceptMessage(e){this.messageCallback?this.messageCallback(e):(this.queue.push(e),this.queue.length===1&&this.processQueue())}needsTaskBoundaryBetween(e,t){return e.type!=="event"||t.type!=="event"}async processQueue(){var t,i;let e;for(;this.queue.length;){if((!e||this.needsTaskBoundaryBetween(this.queue[0],e))&&await Eo(0),e=this.queue.shift(),!e)return;switch(e.type){case"event":(t=this.eventCallback)==null||t.call(this,e);break;case"request":(i=this.requestCallback)==null||i.call(this,e);break;case"response":{const r=e,s=this.pendingRequests.get(r.request_seq);s&&(this.pendingRequests.delete(r.request_seq),s(r));break}}}}internalSend(e,t){t.type=e,t.seq=this.sequence++,this.sendMessage(t)}async cancelPendingRequests(){if(this.pendingRequests.size===0)return Promise.resolve();const e=new Map;this.pendingRequests.forEach((t,i)=>e.set(i,t)),await Eo(500),e.forEach((t,i)=>{t({type:"response",seq:0,request_seq:i,success:!1,command:"canceled",message:"canceled"}),this.pendingRequests.delete(i)})}getPendingRequestIds(){return Array.from(this.pendingRequests.keys())}dispose(){this.queue=[]}}function CL(n){return n.type&&(n.label||n.program||n.runtime)}const PL=/^[a-zA-Z][a-zA-Z0-9\+\-\.]+:/;function TL(n){return!!(n&&n.match(PL))}function AL(n){if(typeof n.path=="string"&&!(typeof n.sourceReference=="number"&&n.sourceReference>0)){if(TL(n.path))return y.parse(n.path);if(ng(n.path))return y.file(n.path)}return n.path}function RL(n){if(typeof n.path=="object"){const e=y.revive(n.path);if(e)return e.scheme===oe.file?e.fsPath:e.toString()}return n.path}function LL(n,e){const t=RL,i=_t(n);return G5(i,(r,s)=>{r&&s&&(s.path=t(s))}),i}function NL(n,e){const t=AL,i=_t(n);return G5(i,(r,s)=>{!r&&s&&(s.path=t(s))}),i}function G5(n,e){var t,i;switch(n.type){case"event":{const r=n;switch(r.event){case"output":e(!1,r.body.source);break;case"loadedSource":e(!1,r.body.source);break;case"breakpoint":e(!1,r.body.breakpoint.source);break}break}case"request":{const r=n;switch(r.command){case"setBreakpoints":e(!0,r.arguments.source);break;case"breakpointLocations":e(!0,r.arguments.source);break;case"source":e(!0,r.arguments.source);break;case"gotoTargets":e(!0,r.arguments.source);break;case"launchVSCode":r.arguments.args.forEach(s=>e(!1,s));break}break}case"response":{const r=n;if(r.success&&r.body)switch(r.command){case"stackTrace":r.body.stackFrames.forEach(s=>e(!1,s.source));break;case"loadedSources":r.body.sources.forEach(s=>e(!1,s));break;case"scopes":r.body.scopes.forEach(s=>e(!1,s.source));break;case"setFunctionBreakpoints":r.body.breakpoints.forEach(s=>e(!1,s.source));break;case"setBreakpoints":r.body.breakpoints.forEach(s=>e(!1,s.source));break;case"disassemble":(t=r.body)==null||t.instructions.forEach(o=>e(!1,o.location));break;case"locations":e(!1,(i=r.body)==null?void 0:i.source);break}break}}}const Kf=De("IExtHostEditorTabs");class PD{constructor(e,t,i){this._activeTabIdGetter=i,this._parentGroup=t,this.acceptDtoUpdate(e)}get apiObject(){if(!this._apiObject){const e=this,t={get isActive(){return e._dto.id===e._activeTabIdGetter()},get label(){return e._dto.label},get input(){return e._input},get isDirty(){return e._dto.isDirty},get isPinned(){return e._dto.isPinned},get isPreview(){return e._dto.isPreview},get group(){return e._parentGroup.apiObject}};this._apiObject=Object.freeze(t)}return this._apiObject}get tabId(){return this._dto.id}acceptDtoUpdate(e){this._dto=e,this._input=this._initInput()}_initInput(){switch(this._dto.input.kind){case vi.TextInput:return new Bx(y.revive(this._dto.input.uri));case vi.TextDiffInput:return new ym(y.revive(this._dto.input.original),y.revive(this._dto.input.modified));case vi.TextMergeInput:return new e5(y.revive(this._dto.input.base),y.revive(this._dto.input.input1),y.revive(this._dto.input.input2),y.revive(this._dto.input.result));case vi.CustomEditorInput:return new Wx(y.revive(this._dto.input.uri),this._dto.input.viewType);case vi.WebviewEditorInput:return new t5(this._dto.input.viewType);case vi.NotebookInput:return new Vx(y.revive(this._dto.input.uri),this._dto.input.notebookType);case vi.NotebookDiffInput:return new zx(y.revive(this._dto.input.original),y.revive(this._dto.input.modified),this._dto.input.notebookType);case vi.TerminalEditorInput:return new n5;case vi.InteractiveEditorInput:return new i5(y.revive(this._dto.input.uri),y.revive(this._dto.input.inputBoxUri));case vi.ChatEditorInput:return new r5;case vi.MultiDiffEditorInput:return new s5(this._dto.input.diffEditors.map(e=>new ym(y.revive(e.original),y.revive(e.modified))));default:return}}}class OL{constructor(e,t){this._tabs=[],this._activeTabId="",this._dto=e,this._activeGroupIdGetter=t;for(const i of e.tabs)i.isActive&&(this._activeTabId=i.id),this._tabs.push(new PD(i,this,()=>this.activeTabId()))}get apiObject(){if(!this._apiObject){const e=this,t={get isActive(){return e._dto.groupId===e._activeGroupIdGetter()},get viewColumn(){return nn.to(e._dto.viewColumn)},get activeTab(){var i;return(i=e._tabs.find(r=>r.tabId===e._activeTabId))==null?void 0:i.apiObject},get tabs(){return Object.freeze(e._tabs.map(i=>i.apiObject))}};this._apiObject=Object.freeze(t)}return this._apiObject}get groupId(){return this._dto.groupId}get tabs(){return this._tabs}acceptGroupDtoUpdate(e){this._dto=e}acceptTabOperation(e){if(e.kind===xs.TAB_OPEN){const i=new PD(e.tabDto,this,()=>this.activeTabId());return this._tabs.splice(e.index,0,i),e.tabDto.isActive&&(this._activeTabId=i.tabId),i}else if(e.kind===xs.TAB_CLOSE){const i=this._tabs.splice(e.index,1)[0];if(!i)throw new Error(`Tab close updated received for index ${e.index} which does not exist`);return i.tabId===this._activeTabId&&(this._activeTabId=""),i}else if(e.kind===xs.TAB_MOVE){if(e.oldIndex===void 0)throw new Error("Invalid old index on move IPC");const i=this._tabs.splice(e.oldIndex,1)[0];if(!i)throw new Error(`Tab move updated received for index ${e.oldIndex} which does not exist`);return this._tabs.splice(e.index,0,i),i}const t=this._tabs.find(i=>i.tabId===e.tabDto.id);if(!t)throw new Error("INVALID tab");return e.tabDto.isActive?this._activeTabId=e.tabDto.id:this._activeTabId===e.tabDto.id&&!e.tabDto.isActive&&(this._activeTabId=""),t.acceptDtoUpdate(e.tabDto),t}activeTabId(){return this._activeTabId}}let Y0=class{constructor(e){this._onDidChangeTabs=new L,this._onDidChangeTabGroups=new L,this._extHostTabGroups=[],this._proxy=e.getProxy(Z.MainThreadEditorTabs)}get tabGroups(){if(!this._apiObject){const e=this,t={onDidChangeTabGroups:e._onDidChangeTabGroups.event,onDidChangeTabs:e._onDidChangeTabs.event,get all(){return Object.freeze(e._extHostTabGroups.map(i=>i.apiObject))},get activeTabGroup(){var s;const i=e._activeGroupId;return cu((s=e._extHostTabGroups.find(o=>o.groupId===i))==null?void 0:s.apiObject)},close:async(i,r)=>{const s=Array.isArray(i)?i:[i];return s.length?FL(s[0])?this._closeGroups(s,r):this._closeTabs(s,r):!0}};this._apiObject=Object.freeze(t)}return this._apiObject}$acceptEditorTabModel(e){var c;const t=new Set(this._extHostTabGroups.map(u=>u.groupId)),i=new Set(e.map(u=>u.groupId)),r=H7(t,i),s=this._extHostTabGroups.filter(u=>r.removed.includes(u.groupId)).map(u=>u.apiObject),o=[],a=[];this._extHostTabGroups=e.map(u=>{const d=new OL(u,()=>this._activeGroupId);return r.added.includes(d.groupId)?o.push(d.apiObject):a.push(d.apiObject),d});const l=cu((c=e.find(u=>u.isActive===!0))==null?void 0:c.groupId);l!==void 0&&this._activeGroupId!==l&&(this._activeGroupId=l),this._onDidChangeTabGroups.fire(Object.freeze({opened:o,closed:s,changed:a}))}$acceptTabGroupUpdate(e){const t=this._extHostTabGroups.find(i=>i.groupId===e.groupId);if(!t)throw new Error("Update Group IPC call received before group creation.");t.acceptGroupDtoUpdate(e),e.isActive&&(this._activeGroupId=e.groupId),this._onDidChangeTabGroups.fire(Object.freeze({changed:[t.apiObject],opened:[],closed:[]}))}$acceptTabOperation(e){const t=this._extHostTabGroups.find(r=>r.groupId===e.groupId);if(!t)throw new Error("Update Tabs IPC call received before group creation.");const i=t.acceptTabOperation(e);switch(e.kind){case xs.TAB_OPEN:this._onDidChangeTabs.fire(Object.freeze({opened:[i.apiObject],closed:[],changed:[]}));return;case xs.TAB_CLOSE:this._onDidChangeTabs.fire(Object.freeze({opened:[],closed:[i.apiObject],changed:[]}));return;case xs.TAB_MOVE:case xs.TAB_UPDATE:this._onDidChangeTabs.fire(Object.freeze({opened:[],closed:[],changed:[i.apiObject]}));return}}_findExtHostTabFromApi(e){for(const t of this._extHostTabGroups)for(const i of t.tabs)if(i.apiObject===e)return i}_findExtHostTabGroupFromApi(e){return this._extHostTabGroups.find(t=>t.apiObject===e)}async _closeTabs(e,t){const i=[];for(const r of e){const s=this._findExtHostTabFromApi(r);if(!s)throw new Error("Tab close: Invalid tab not found!");i.push(s.tabId)}return this._proxy.$closeTab(i,t)}async _closeGroups(e,t){const i=[];for(const r of e){const s=this._findExtHostTabGroupFromApi(r);if(!s)throw new Error("Group close: Invalid group not found!");i.push(s.groupId)}return this._proxy.$closeGroup(i,t)}};Y0=V([F(0,tt)],Y0);function FL(n){return n.tabs!==void 0}var TD;(function(n){n.ViewletId="workbench.view.extension.test",n.ExplorerViewId="workbench.view.testing",n.OutputPeekContributionId="editor.contrib.testingOutputPeek",n.DecorationsContributionId="editor.contrib.testingDecorations",n.CoverageDecorationsContributionId="editor.contrib.coverageDecorations",n.CoverageViewId="workbench.view.testCoverage",n.ResultsPanelId="workbench.panel.testResults",n.ResultsViewId="workbench.panel.testResults.view",n.MessageLanguageId="vscodeInternalTestMessage"})(TD||(TD={}));var AD;(function(n){n.List="list",n.Tree="true"})(AD||(AD={}));var RD;(function(n){n.ByLocation="location",n.ByStatus="status",n.ByDuration="duration"})(RD||(RD={}));Xt.Errored+"",h(10937,"Errored"),Xt.Failed+"",h(10938,"Failed"),Xt.Passed+"",h(10939,"Passed"),Xt.Queued+"",h(10940,"Queued"),Xt.Running+"",h(10941,"Running"),Xt.Skipped+"",h(10942,"Skipped"),Xt.Unset+"",h(10943,"Not yet run");Dn.Debug+"",h(10945,"Debug"),Dn.Run+"",h(10946,"Run"),Dn.Coverage+"",h(10947,"Coverage");var Z0;(function(n){n.CancelTestRefreshAction="testing.cancelTestRefresh",n.CancelTestRunAction="testing.cancelRun",n.ClearTestResultsAction="testing.clearTestResults",n.CollapseAllAction="testing.collapseAll",n.ConfigureTestProfilesAction="testing.configureProfile",n.ContinousRunUsingForTest="testing.continuousRunUsingForTest",n.CoverageAtCursor="testing.coverageAtCursor",n.CoverageByUri="testing.coverage.uri",n.CoverageClear="testing.coverage.close",n.CoverageCurrentFile="testing.coverageCurrentFile",n.CoverageFilterToTest="testing.coverageFilterToTest",n.CoverageFilterToTestInEditor="testing.coverageFilterToTestInEditor",n.CoverageLastRun="testing.coverageLastRun",n.CoverageSelectedAction="testing.coverageSelected",n.CoverageToggleToolbar="testing.coverageToggleToolbar",n.CoverageViewChangeSorting="testing.coverageViewChangeSorting",n.DebugAction="testing.debug",n.DebugAllAction="testing.debugAll",n.DebugAtCursor="testing.debugAtCursor",n.DebugByUri="testing.debug.uri",n.DebugCurrentFile="testing.debugCurrentFile",n.DebugFailedTests="testing.debugFailTests",n.DebugLastRun="testing.debugLastRun",n.DebugSelectedAction="testing.debugSelected",n.FilterAction="workbench.actions.treeView.testExplorer.filter",n.GetExplorerSelection="_testing.getExplorerSelection",n.GetSelectedProfiles="testing.getSelectedProfiles",n.GoToTest="testing.editFocusedTest",n.GoToRelatedTest="testing.goToRelatedTest",n.PeekRelatedTest="testing.peekRelatedTest",n.GoToRelatedCode="testing.goToRelatedCode",n.PeekRelatedCode="testing.peekRelatedCode",n.HideTestAction="testing.hideTest",n.OpenCoverage="testing.openCoverage",n.OpenOutputPeek="testing.openOutputPeek",n.RefreshTestsAction="testing.refreshTests",n.ReRunFailedTests="testing.reRunFailTests",n.ReRunLastRun="testing.reRunLastRun",n.RunAction="testing.run",n.RunAllAction="testing.runAll",n.RunAllWithCoverageAction="testing.coverageAll",n.RunAtCursor="testing.runAtCursor",n.RunByUri="testing.run.uri",n.RunCurrentFile="testing.runCurrentFile",n.RunSelectedAction="testing.runSelected",n.RunUsingProfileAction="testing.runUsing",n.RunWithCoverageAction="testing.coverage",n.SearchForTestExtension="testing.searchForTestExtension",n.SelectDefaultTestProfiles="testing.selectDefaultTestProfiles",n.ShowMostRecentOutputAction="testing.showMostRecentOutput",n.StartContinousRun="testing.startContinuousRun",n.StartContinousRunFromExtension="testing.startContinuousRunFromExtension",n.StopContinousRunFromExtension="testing.stopContinuousRunFromExtension",n.StopContinousRun="testing.stopContinuousRun",n.TestingSortByDurationAction="testing.sortByDuration",n.TestingSortByLocationAction="testing.sortByLocation",n.TestingSortByStatusAction="testing.sortByStatus",n.TestingViewAsListAction="testing.viewAsList",n.TestingViewAsTreeAction="testing.viewAsTree",n.ToggleContinousRunForTest="testing.toggleContinuousRunForTest",n.ToggleInlineTestOutput="testing.toggleInlineTestOutput",n.UnhideAllTestsAction="testing.unhideAllTests",n.UnhideTestAction="testing.unhideTest"})(Z0||(Z0={}));let ML=0;const LD=new WeakMap,P_=De("IExtHostTesting");let K0=class extends Te{constructor(e,t,i,r){super(),this.logService=t,this.commands=i,this.editors=r,this.resultsChangedEmitter=this._register(new L),this.controllers=new Map,this.defaultProfilesChangedEmitter=this._register(new L),this.followupProviders=new Set,this.testFollowups=new Map,this.onResultsChanged=this.resultsChangedEmitter.event,this.results=[],this.proxy=e.getProxy(Z.MainThreadTesting),this.observer=new VL(this.proxy),this.runTracker=new HL(this.proxy,t),i.registerArgumentProcessor({processArgument:s=>{var o,a,l;switch(s==null?void 0:s.$mid){case rt.TestItemContext:{const c=s,u=c.tests[c.tests.length-1].item.extId,d=this.controllers.get(Re.root(u));return((o=d==null?void 0:d.collection.tree.get(u))==null?void 0:o.actual)??K4(s)}case rt.TestMessageMenuArgs:{const{test:c,message:u}=s,d=c.item.extId;return{test:((l=(a=this.controllers.get(Re.root(d)))==null?void 0:a.collection.tree.get(d))==null?void 0:l.actual)??K4({tests:[c]}),message:$u.to(u)}}default:return s}}}),i.registerCommand(!1,"testing.getExplorerSelection",async()=>{const s=await i.executeCommand(Z0.GetExplorerSelection),o=a=>{var c;const l=this.controllers.get(Re.root(a));if(l)return Re.isRoot(a)?l.controller:(c=l.collection.tree.get(a))==null?void 0:c.actual};return{include:(s==null?void 0:s.include.map(o).filter(Ui))||[],exclude:(s==null?void 0:s.exclude.map(o).filter(Ui))||[]}})}createTestController(e,t,i,r){if(this.controllers.has(t))throw new Error(`Attempt to insert a duplicate controller with ID "${t}"`);const s=new Ie,o=s.add(new v6(t,i,this.editors));o.root.label=i;const a=new Map,l=new Set,c=this.proxy,u=()=>{let p=0;r&&(p|=jd.Refresh);const w=f.relatedCodeProvider;return w&&(w!=null&&w.provideRelatedTests&&(p|=jd.TestRelatedToCode),w!=null&&w.provideRelatedCode&&(p|=jd.CodeRelatedToTest)),p},d={items:o.root.children,get label(){return i},set label(p){i=p,o.root.label=p,c.$updateController(t,{label:i})},get refreshHandler(){return r},set refreshHandler(p){r=p,c.$updateController(t,{capabilities:u()})},get id(){return t},get relatedCodeProvider(){return f.relatedCodeProvider},set relatedCodeProvider(p){$(e,"testRelatedCode"),f.relatedCodeProvider=p,c.$updateController(t,{capabilities:u()})},createRunProfile:(p,w,v,m,x,k)=>{let D=_f(p);for(;a.has(D);)D++;return new J5(this.proxy,a,l,this.defaultProfilesChangedEmitter.event,t,D,p,w,v,m,x,k)},createTestItem(p,w,v){return new Rl(t,p,w,v)},createTestRun:(p,w,v=!0)=>this.runTracker.createTestRun(e,t,o,p,w,v),invalidateTestResults:p=>{if(p===void 0)this.proxy.$markTestRetired(void 0);else{const w=p instanceof Array?p:[p];this.proxy.$markTestRetired(w.map(v=>Re.fromExtHostTestItem(v,t).toString()))}},set resolveHandler(p){o.resolveHandler=p},get resolveHandler(){return o.resolveHandler},dispose:()=>{s.dispose()}},f={controller:d,collection:o,profiles:a,extension:e,activeProfiles:l};return c.$registerTestController(t,i,u()),s.add(Se(()=>c.$unregisterTestController(t))),this.controllers.set(t,f),s.add(Se(()=>this.controllers.delete(t))),s.add(o.onDidGenerateDiff(p=>c.$publishDiff(t,p.map($g.serialize)))),d}createTestObserver(){return this.observer.checkout()}async runTests(e,t=Pt.None){var s,o;const i=Q5(e);if(!i)throw new Error("The request passed to `vscode.test.runTests` must include a profile");const r=this.controllers.get(i.controllerId);if(!r)throw new Error("Controller not found");await this.proxy.$runTests({preserveFocus:e.preserveFocus??!0,group:Uu.from(i.kind),targets:[{testIds:((s=e.include)==null?void 0:s.map(a=>Re.fromExtHostTestItem(a,r.collection.root.id).toString()))??[r.collection.root.id],profileId:i.profileId,controllerId:i.controllerId}],exclude:(o=e.exclude)==null?void 0:o.map(a=>a.id)},t)}registerTestFollowupProvider(e){return this.followupProviders.add(e),{dispose:()=>{this.followupProviders.delete(e)}}}async $getTestsRelatedToCode(e,t,i){const r=this.editors.getDocument(y.revive(e));if(!r)return[];const s=nt.to(t),o=[];return await Promise.all([...this.controllers.values()].map(async a=>{var c,u;let l;try{l=await((u=(c=a.relatedCodeProvider)==null?void 0:c.provideRelatedTests)==null?void 0:u.call(c,r.document,s,i))}catch(d){i.isCancellationRequested||this.logService.warn(`Error thrown while providing related tests for ${a.controller.label}`,d)}if(l){for(const d of l)o.push(Re.fromExtHostTestItem(d,a.controller.id).toString());a.collection.flushDiff()}})),o}async $getCodeRelatedToTest(e,t){var o,a;const i=this.controllers.get(Re.root(e));if(!i)return[];const r=i.collection.tree.get(e);if(!r)return[];const s=await((a=(o=i.relatedCodeProvider)==null?void 0:o.provideRelatedCode)==null?void 0:a.call(o,r.actual,t));return(s==null?void 0:s.map(ii.from))??[]}$syncTests(){for(const{collection:e}of this.controllers.values())e.flushDiff();return Promise.resolve()}async $getCoverageDetails(e,t,i){const r=await this.runTracker.getCoverageDetails(e,t,i);return r==null?void 0:r.map(af.fromDetails)}async $disposeRun(e){this.runTracker.disposeTestRun(e)}$configureRunProfile(e,t){var i,r,s;(s=(r=(i=this.controllers.get(e))==null?void 0:i.profiles.get(t))==null?void 0:r.configureHandler)==null||s.call(r)}$setDefaultRunProfiles(e){const t=new Map;for(const[i,r]of Object.entries(e)){const s=this.controllers.get(i);if(!s)continue;const o=new Map,a=r.filter(c=>!s.activeProfiles.has(c)),l=[...s.activeProfiles].filter(c=>!r.includes(c));for(const c of a)o.set(c,!0),s.activeProfiles.add(c);for(const c of l)o.set(c,!1),s.activeProfiles.delete(c);o.size&&t.set(i,o)}this.defaultProfilesChangedEmitter.fire(t)}async $refreshTests(e,t){var i,r,s;await((s=(i=this.controllers.get(e))==null?void 0:(r=i.controller).refreshHandler)==null?void 0:s.call(r,t))}$publishTestResults(e){this.results=Object.freeze(e.map(t=>{const i=Yb.to(t),r=t.tasks.findIndex(s=>s.hasCoverage);return r!==-1&&(i.getDetailedCoverage=(s,o=Pt.None)=>this.proxy.$getCoverageDetails(t.id,r,s,o).then(a=>a.map(af.to))),LD.set(i,t.id),i}).concat(this.results).sort((t,i)=>i.completedAt-t.completedAt).slice(0,32)),this.resultsChangedEmitter.fire()}async $expandTest(e,t){var r;const i=(r=this.controllers.get(Re.fromString(e).controllerId))==null?void 0:r.collection;i&&(await i.expand(e,t<0?1/0:t),i.flushDiff())}$acceptDiff(e){this.observer.applyDiff(e.map(t=>$g.deserialize({asCanonicalUri:i=>i},t)))}async $runControllerTests(e,t){return Promise.all(e.map(i=>this.runControllerTestRequest(i,!1,t)))}async $startContinuousRun(e,t){const i=new Bt(t),r=await Promise.all(e.map(s=>this.runControllerTestRequest(s,!0,i.token)));return!t.isCancellationRequested&&!r.some(s=>s.error)&&await new Promise(s=>t.onCancellationRequested(s)),i.dispose(!0),r}async $provideTestFollowups(e,t){const i=this.results.find(o=>LD.get(o)===e.resultId),r=i&&zL(Re.fromString(e.extId),i==null?void 0:i.results);if(!r)return[];let s=[];return await Promise.all([...this.followupProviders].map(async o=>{try{const a=await o.provideFollowup(i,r,e.taskIndex,e.messageIndex,t);a&&(s=s.concat(a))}catch(a){this.logService.error("Error thrown while providing followup for test message",a)}})),t.isCancellationRequested?[]:s.map(o=>{const a=ML++;return this.testFollowups.set(a,o),{title:o.title,id:a}})}$disposeTestFollowups(e){for(const t of e)this.testFollowups.delete(t)}$executeTestFollowup(e){const t=this.testFollowups.get(e);return t?this.commands.executeCommand(t.command,...t.arguments||[]):Promise.resolve()}$cancelExtensionTestRun(e,t){e===void 0?this.runTracker.cancelAllRuns():this.runTracker.cancelRunById(e,t)}getMetadataForRun(e){for(const t of this.runTracker.trackers){const i=t.getTaskIdForRun(e);if(i)return{taskId:i,runId:t.id}}}async runControllerTestRequest(e,t,i){const r=this.controllers.get(e.controllerId);if(!r)return{};const{collection:s,profiles:o,extension:a}=r,l=o.get(e.profileId);if(!l)return{};const c=e.testIds.map(p=>s.tree.get(p)).filter(Ui),u=e.excludeExtIds.map(p=>r.collection.tree.get(p)).filter(Ui).filter(p=>c.some(w=>w.fullId.compare(p.fullId)===Zi.IsChild));if(!c.length)return{};const d=new wm(c.some(p=>p.actual instanceof Yx)?void 0:c.map(p=>p.actual),u.map(p=>p.actual),l,t),f=UR(e)&&this.runTracker.prepareForMainThreadTestRun(a,d,yf.fromInternal(e,r.collection),l,i);try{return await l.runHandler(d,i),{}}catch(p){return{error:String(p)}}finally{f&&f.hasRunningTasks&&!i.isCancellationRequested&&await Ht.toPromise(f.onEnd)}}};K0=V([F(0,tt),F(1,ct),F(2,Ll),F(3,ed)],K0);const $L=1e4;var Ks;(function(n){n[n.Running=0]="Running",n[n.Cancelling=1]="Cancelling",n[n.Ended=2]="Ended"})(Ks||(Ks={}));class UL extends Te{get hasRunningTasks(){return this.running>0}get id(){return this.dto.id}constructor(e,t,i,r,s,o){super(),this.dto=e,this.proxy=t,this.logService=i,this.profile=r,this.extension=s,this.state=Ks.Running,this.running=0,this.tasks=new Map,this.sharedTestIds=new Set,this.endEmitter=this._register(new L),this.publishedCoverage=new Map,this.onEnd=this.endEmitter.event,this.cts=this._register(new Bt(o));const a=this._register(new Gu(()=>this.forciblyEndTasks(),$L));this._register(this.cts.token.onCancellationRequested(()=>a.schedule()));const l=new L;this.onDidDispose=l.event,this._register(Se(()=>{l.fire(),l.dispose()}))}getTaskIdForRun(e){for(const[t,{run:i}]of this.tasks)if(i===e)return t}cancel(e){var t;e?(t=this.tasks.get(e))==null||t.cts.cancel():this.state===Ks.Running?(this.cts.cancel(),this.state=Ks.Cancelling):this.state===Ks.Cancelling&&this.forciblyEndTasks()}async getCoverageDetails(e,t,i){var d,f,p,w;const[,r]=Re.fromString(e).path,s=this.publishedCoverage.get(e);if(!s)return[];const{report:o,extIds:a}=s,l=this.tasks.get(r);if(!l)throw new Error("unreachable: run task was not found");let c;if(t&&o instanceof Cu){const v=a.indexOf(t);if(v===-1)return[];c=o.includesTests[v]}return await(c?(f=(d=this.profile)==null?void 0:d.loadDetailedCoverageForTest)==null?void 0:f.call(d,l.run,o,c,i):(w=(p=this.profile)==null?void 0:p.loadDetailedCoverage)==null?void 0:w.call(p,l.run,o,i))??[]}createRun(e){const t=this.dto.id,i=this.dto.controllerId,r=Mn(),s=u=>(d,...f)=>{if(a){this.logService.warn(`Setting the state of test "${d.id}" is a no-op after the run ends.`);return}this.ensureTestIsKnown(d),u(d,...f)},o=(u,d)=>{const f=d instanceof Array?d.map($u.from):[$u.from(d)];if(u.uri&&u.range){const p={range:W.from(u.range),uri:u.uri};for(const w of f)w.location=w.location||p}this.proxy.$appendTestMessagesInRun(t,r,Re.fromExtHostTestItem(u,i).toString(),f)};let a=!1;const l=this._register(new Bt(this.cts.token)),c={isPersisted:this.dto.isPersisted,token:l.token,name:e,onDidDispose:this.onDidDispose,addCoverage:u=>{if(a)return;const d=u instanceof Cu?u.includesTests:[];if(d.length)for(const w of d)this.ensureTestIsKnown(w);const f=u.uri.toString(),p=new Re([t,r,f]).toString();this.publishedCoverage.set(p,{report:u,extIds:d.map(w=>Re.fromExtHostTestItem(w,i).toString())}),this.proxy.$appendCoverage(t,r,af.fromFile(i,p,u))},enqueued:s(u=>{this.proxy.$updateTestStateInRun(t,r,Re.fromExtHostTestItem(u,i).toString(),Xt.Queued)}),skipped:s(u=>{this.proxy.$updateTestStateInRun(t,r,Re.fromExtHostTestItem(u,i).toString(),Xt.Skipped)}),started:s(u=>{this.proxy.$updateTestStateInRun(t,r,Re.fromExtHostTestItem(u,i).toString(),Xt.Running)}),errored:s((u,d,f)=>{o(u,d),this.proxy.$updateTestStateInRun(t,r,Re.fromExtHostTestItem(u,i).toString(),Xt.Errored,f)}),failed:s((u,d,f)=>{o(u,d),this.proxy.$updateTestStateInRun(t,r,Re.fromExtHostTestItem(u,i).toString(),Xt.Failed,f)}),passed:s((u,d)=>{this.proxy.$updateTestStateInRun(t,r,Re.fromExtHostTestItem(u,this.dto.controllerId).toString(),Xt.Passed,d)}),appendOutput:(u,d,f)=>{a||(f&&this.ensureTestIsKnown(f),this.proxy.$appendOutputToRun(t,r,Pe.fromString(u),d&&ii.from(d),f&&Re.fromExtHostTestItem(f,i).toString()))},end:()=>{a||(a=!0,this.proxy.$finishedTestRunTask(t,r),--this.running||this.markEnded())}};return this.running++,this.tasks.set(r,{run:c,cts:l}),this.proxy.$startedTestRunTask(t,{id:r,ctrlId:this.dto.controllerId,name:e||this.extension.displayName||this.extension.identifier.value,running:!0}),c}forciblyEndTasks(){for(const{run:e}of this.tasks.values())e.end()}markEnded(){this.state!==Ks.Ended&&(this.state=Ks.Ended,this.endEmitter.fire())}ensureTestIsKnown(e){if(!(e instanceof Rl))throw new Ug(e.id);if(this.sharedTestIds.has(Re.fromExtHostTestItem(e,this.dto.controllerId).toString()))return;const t=[],i=this.dto.colllection.root;for(;;){const r=Ro.from(e);if(t.unshift(r),this.sharedTestIds.has(r.extId)||(this.sharedTestIds.add(r.extId),e===i))break;e=e.parent||i}this.proxy.$addTestsToRun(this.dto.controllerId,this.dto.id,t)}dispose(){this.markEnded(),super.dispose()}}class HL{get trackers(){return this.tracked.values()}constructor(e,t){this.proxy=e,this.logService=t,this.tracked=new Map,this.trackedById=new Map}getCoverageDetails(e,t,i){var s;const r=Re.root(e);return((s=this.trackedById.get(r))==null?void 0:s.getCoverageDetails(e,t,i))||[]}disposeTestRun(e){var t;(t=this.trackedById.get(e))==null||t.dispose(),this.trackedById.delete(e);for(const[i,{id:r}]of this.tracked)r===e&&this.tracked.delete(i)}prepareForMainThreadTestRun(e,t,i,r,s){return this.getTracker(t,i,r,e,s)}cancelRunById(e,t){var i;(i=this.trackedById.get(e))==null||i.cancel(t)}cancelAllRuns(){for(const e of this.tracked.values())e.cancel()}createTestRun(e,t,i,r,s,o){var d,f;const a=this.tracked.get(r);if(a)return a.createRun(s);const l=yf.fromPublic(t,i,r,o),c=Q5(r);this.proxy.$startedExtensionTestRun({controllerId:t,continuous:!!r.continuous,profile:c&&{group:Uu.from(c.kind),id:c.profileId},exclude:((d=r.exclude)==null?void 0:d.map(p=>Re.fromExtHostTestItem(p,i.root.id).toString()))??[],id:l.id,include:((f=r.include)==null?void 0:f.map(p=>Re.fromExtHostTestItem(p,i.root.id).toString()))??[i.root.id],preserveFocus:r.preserveFocus??!0,persist:o});const u=this.getTracker(r,l,r.profile,e);return Ht.once(u.onEnd)(()=>{this.proxy.$finishedExtensionTestRun(l.id)}),u.createRun(s)}getTracker(e,t,i,r,s){const o=new UL(t,this.proxy,this.logService,i,r,s);return this.tracked.set(e,o),this.trackedById.set(o.id,o),o}}const Q5=n=>{if(n.profile){if(!(n.profile instanceof J5))throw new Error("TestRunRequest.profile is not an instance created from TestController.createRunProfile");return n.profile}};class yf{static fromPublic(e,t,i,r){return new yf(e,Mn(),r,t)}static fromInternal(e,t){return new yf(e.controllerId,e.runId,!0,t)}constructor(e,t,i,r){this.controllerId=e,this.id=t,this.isPersisted=i,this.colllection=r}}class BL{get isEmpty(){return this.added.size===0&&this.removed.size===0&&this.updated.size===0}constructor(e){this.emitter=e,this.added=new Set,this.updated=new Set,this.removed=new Set,this.alreadyRemoved=new Set}add(e){this.added.add(e)}update(e){Object.assign(e.revived,Ro.toPlain(e.item)),this.added.has(e)||this.updated.add(e)}remove(e){if(this.added.has(e)){this.added.delete(e);return}this.updated.delete(e);const t=Re.parentId(e.item.extId);if(t&&this.alreadyRemoved.has(t.toString())){this.alreadyRemoved.add(e.item.extId);return}this.removed.add(e)}getChangeEvent(){const{added:e,updated:t,removed:i}=this;return{get added(){return[...e].map(r=>r.revived)},get updated(){return[...t].map(r=>r.revived)},get removed(){return[...i].map(r=>r.revived)}}}complete(){this.isEmpty||this.emitter.fire(this.getChangeEvent())}}class WL extends HR{constructor(){super(...arguments),this.changeEmitter=new L,this.onDidChangeTests=this.changeEmitter.event}get rootTests(){return this.roots}getMirroredTestDataById(e){return this.items.get(e)}getMirroredTestDataByReference(e){return this.items.get(e.id)}createItem(e,t){return{...e,revived:Ro.toPlain(e.item),depth:t?t.depth+1:0,children:new Set}}createChangeCollector(){return new BL(this.changeEmitter)}}class VL{constructor(e){this.proxy=e}checkout(){this.current||(this.current=this.createObserverData());const e=this.current;return e.observers++,{onDidChangeTest:e.tests.onDidChangeTests,get tests(){return[...e.tests.rootTests].map(t=>t.revived)},dispose:lx(()=>{--e.observers===0&&(this.proxy.$unsubscribeFromDiffs(),this.current=void 0)})}}getMirroredTestDataByReference(e){var t;return(t=this.current)==null?void 0:t.tests.getMirroredTestDataByReference(e)}applyDiff(e){var t;(t=this.current)==null||t.tests.apply(e)}createObserverData(){const e=new WL({asCanonicalUri:t=>t});return this.proxy.$subscribeToDiffs(),{observers:0,tests:e}}}const md=(n,e,t,i)=>{t?Object.assign(t,i):e.$updateTestRunConfig(n.controllerId,n.profileId,i)};var tr,Ia,Tf,xi,zc;class J5 extends XC{constructor(t,i,r,s,o,a,l,c,u,d=!1,f=void 0,p=!1){super(o,a,c);ge(this,tr);ge(this,Ia);ge(this,Tf);ge(this,xi);ge(this,zc);this._label=l,this.runHandler=u,this._tag=f,this._supportsContinuousRun=p,ie(this,tr,t),ie(this,zc,i),ie(this,Ia,r),ie(this,Tf,s),i.set(a,this);const w=Uu.from(c);d&&r.add(a),ie(this,xi,{profileId:a,controllerId:o,tag:f?gr.namespace(this.controllerId,f.id):null,label:l,group:w,isDefault:d,hasConfigurationHandler:!1,supportsContinuousRun:p}),queueMicrotask(()=>{A(this,xi)&&(A(this,tr).$publishTestRunProfile(A(this,xi)),ie(this,xi,void 0))})}get label(){return this._label}set label(t){t!==this._label&&(this._label=t,md(this,A(this,tr),A(this,xi),{label:t}))}get supportsContinuousRun(){return this._supportsContinuousRun}set supportsContinuousRun(t){t!==this._supportsContinuousRun&&(this._supportsContinuousRun=t,md(this,A(this,tr),A(this,xi),{supportsContinuousRun:t}))}get isDefault(){return A(this,Ia).has(this.profileId)}set isDefault(t){t!==this.isDefault&&(t?A(this,Ia).add(this.profileId):A(this,Ia).delete(this.profileId),md(this,A(this,tr),A(this,xi),{isDefault:t}))}get tag(){return this._tag}set tag(t){var i;(t==null?void 0:t.id)!==((i=this._tag)==null?void 0:i.id)&&(this._tag=t,md(this,A(this,tr),A(this,xi),{tag:t?gr.namespace(this.controllerId,t.id):null}))}get configureHandler(){return this._configureHandler}set configureHandler(t){t!==this._configureHandler&&(this._configureHandler=t,md(this,A(this,tr),A(this,xi),{hasConfigurationHandler:!!t}))}get onDidChangeDefault(){return Ht.chain(A(this,Tf),t=>t.map(i=>{var r;return(r=i.get(this.controllerId))==null?void 0:r.get(this.profileId)}).filter(Ui))}dispose(){var t;(t=A(this,zc))!=null&&t.delete(this.profileId)&&(ie(this,zc,void 0),A(this,tr).$removeTestProfile(this.controllerId,this.profileId)),ie(this,xi,void 0)}}tr=new WeakMap,Ia=new WeakMap,Tf=new WeakMap,xi=new WeakMap,zc=new WeakMap;function zL(n,e){for(let t=0;t<n.path.length;t++){const i=e.find(r=>r.id===n.path[t]);if(!i)return;if(t===n.path.length-1)return i;e=i.children}}var ht;(function(n){n.Unknown="unknown",n.Env="env",n.Config="config",n.Command="command",n.Input="input",n.ExtensionInstallFolder="extensionInstallFolder",n.WorkspaceFolder="workspaceFolder",n.Cwd="cwd",n.WorkspaceFolderBasename="workspaceFolderBasename",n.UserHome="userHome",n.LineNumber="lineNumber",n.ColumnNumber="columnNumber",n.SelectedText="selectedText",n.File="file",n.FileWorkspaceFolder="fileWorkspaceFolder",n.FileWorkspaceFolderBasename="fileWorkspaceFolderBasename",n.RelativeFile="relativeFile",n.RelativeFileDirname="relativeFileDirname",n.FileDirname="fileDirname",n.FileExtname="fileExtname",n.FileBasename="fileBasename",n.FileBasenameNoExtension="fileBasenameNoExtension",n.FileDirnameBasename="fileDirnameBasename",n.ExecPath="execPath",n.ExecInstallFolder="execInstallFolder",n.PathSeparator="pathSeparator",n.PathSeparatorAlias="/"})(ht||(ht={}));const qL=Object.values(ht).filter(n=>typeof n=="string");class Qn extends Wr{constructor(e,t){super(t),this.variable=e}}const ch=class ch{constructor(e){this.locations=new Map,typeof e=="string"?(this.stringRoot=!0,this.root={value:e}):(this.stringRoot=!1,this.root=structuredClone(e))}static parse(e){if(e instanceof ch)return e;const t=new ch(e);return t.applyPlatformSpecificKeys(),t.parseObject(t.root),t}applyPlatformSpecificKeys(){const e=this.root,t=ni?"windows":Pi?"osx":Fs?"linux":void 0;t===void 0||!e||typeof e!="object"||!e.hasOwnProperty(t)||(Object.keys(e[t]).forEach(i=>e[i]=e[t][i]),delete e.windows,delete e.osx,delete e.linux)}parseVariable(e,t){if(e[t]!=="$"||e[t+1]!=="{")return;let i=t+2,r=1;for(;i<e.length;){if(e[i]==="{")r++;else if(e[i]==="}"&&(r--,r===0))break;i++}if(r!==0)return;const s=e.slice(t,i+1),o=e.substring(t+2,i),a=o.indexOf(":");return a===-1?{replacement:{id:s,name:o,inner:o},end:i}:{replacement:{id:s,inner:o,name:o.slice(0,a),arg:o.slice(a+1)},end:i}}parseObject(e){if(!(typeof e!="object"||e===null)){if(Array.isArray(e)){for(let t=0;t<e.length;t++){const i=e[t];typeof i=="string"?this.parseString(e,t,i):this.parseObject(i)}return}for(const[t,i]of Object.entries(e))typeof i=="string"?this.parseString(e,t,i):this.parseObject(i)}}parseString(e,t,i){let r=0;for(;r<i.length;){const s=i.indexOf("${",r);if(s===-1)break;const o=this.parseVariable(i,s);if(o){const a=this.locations.get(o.replacement.id)||{locations:[],replacement:o.replacement};a.locations.push({object:e,propertyName:t}),this.locations.set(o.replacement.id,a),r=o.end+1}else r=s+2}}unresolved(){return zn.map(zn.filter(this.locations.values(),e=>e.resolved===void 0),e=>e.replacement)}resolved(){return zn.map(zn.filter(this.locations.values(),e=>!!e.resolved),e=>[e.replacement,e.resolved])}resolve(e,t){typeof t!="object"&&(t={value:String(t)});const i=this.locations.get(e.id);if(i){if(t.value!==void 0)for(const{object:r,propertyName:s}of i.locations||[]){const o=r[s].replaceAll(e.id,t.value);r[s]=o}i.resolved=t}}toObject(){return this.stringRoot?this.root.value:this.root}};ch.VARIABLE_LHS="${";let p1=ch;class jL{constructor(e,t,i,r){this._contributedVariables=new Map,this.resolvableVariables=new Set(qL),this._context=e,this._labelService=t,this._userHomePromise=i,r&&(this._envVariablesPromise=r.then(s=>this.prepareEnv(s)))}prepareEnv(e){if(ni){const t=Object.create(null);return Object.keys(e).forEach(i=>{t[i.toLowerCase()]=e[i]}),t}return e}async resolveWithEnvironment(e,t,i){const r=p1.parse(i),s={env:this.prepareEnv(e),userHome:void 0};for(const o of r.unresolved()){const a=await this.evaluateSingleVariable(s,o,t==null?void 0:t.uri);a!==void 0&&r.resolve(o,a)}return r.toObject()}async resolveAsync(e,t){const i=p1.parse(t),r={env:await this._envVariablesPromise,userHome:await this._userHomePromise};for(const s of i.unresolved()){const o=await this.evaluateSingleVariable(r,s,e==null?void 0:e.uri);o!==void 0&&i.resolve(s,o)}return i.toObject()}resolveWithInteractionReplace(e,t){throw new Error("resolveWithInteractionReplace not implemented.")}resolveWithInteraction(e,t){throw new Error("resolveWithInteraction not implemented.")}contributeVariable(e,t){if(this._contributedVariables.has(e))throw new Error("Variable "+e+" is contributed twice.");this.resolvableVariables.add(e),this._contributedVariables.set(e,t)}fsPath(e){return this._labelService?this._labelService.getUriLabel(e,{noPrefix:!0}):e.fsPath}async evaluateSingleVariable(e,t,i,r){const{name:s,arg:o}=t,a=u=>{const d=this._context.getFilePath();if(d)return pd(d);throw new Qn(u,h(11994,"Variable {0} can not be resolved. Please open an editor.",t.id))},l=u=>{const d=a(u);if(this._context.getWorkspaceFolderPathForFile){const f=this._context.getWorkspaceFolderPathForFile();if(f)return pd(f)}throw new Qn(u,h(11995,"Variable {0}: can not find workspace folder of '{1}'.",t.id,ci(d)))},c=u=>{if(o){const d=this._context.getFolderUri(o);if(d)return d;throw new Qn(u,h(11996,"Variable {0} can not be resolved. No such folder '{1}'.",u,o))}if(i)return i;throw this._context.getWorkspaceFolderCount()>1?new Qn(u,h(11997,"Variable {0} can not be resolved in a multi folder workspace. Scope this variable using ':' and a workspace folder name.",u)):new Qn(u,h(11998,"Variable {0} can not be resolved. Please open a folder.",u))};switch(s){case"env":if(o){if(e.env){const u=e.env[ni?o.toLowerCase():o];if(Ze(u))return u}return""}throw new Qn(ht.Env,h(11999,"Variable {0} can not be resolved because no environment variable name is given.",t.id));case"config":if(o){const u=this._context.getConfigurationValue(i,o);if(Yt(u))throw new Qn(ht.Config,h(12e3,"Variable {0} can not be resolved because setting '{1}' not found.",t.id,o));if(Zt(u))throw new Qn(ht.Config,h(12001,"Variable {0} can not be resolved because '{1}' is a structured value.",t.id,o));return u}throw new Qn(ht.Config,h(12002,"Variable {0} can not be resolved because no settings name is given.",t.id));case"command":return this.resolveFromMap(ht.Command,t.id,o,r,"command");case"input":return this.resolveFromMap(ht.Input,t.id,o,r,"input");case"extensionInstallFolder":if(o){const u=await this._context.getExtension(o);if(!u)throw new Qn(ht.ExtensionInstallFolder,h(12003,"Variable {0} can not be resolved because the extension {1} is not installed.",t.id,o));return this.fsPath(u.extensionLocation)}throw new Qn(ht.ExtensionInstallFolder,h(12004,"Variable {0} can not be resolved because no extension name is given.",t.id));default:switch(s){case"workspaceRoot":case"workspaceFolder":{const u=c(ht.WorkspaceFolder);return u?pd(this.fsPath(u)):void 0}case"cwd":{if(!i&&!o)return uu();const u=c(ht.Cwd);return u?pd(this.fsPath(u)):void 0}case"workspaceRootFolderName":case"workspaceFolderBasename":{const u=c(ht.WorkspaceFolderBasename);return u?pd(ci(this.fsPath(u))):void 0}case"userHome":if(e.userHome)return e.userHome;throw new Qn(ht.UserHome,h(12005,"Variable {0} can not be resolved. UserHome path is not defined",t.id));case"lineNumber":{const u=this._context.getLineNumber();if(u)return u;throw new Qn(ht.LineNumber,h(12006,"Variable {0} can not be resolved. Make sure to have a line selected in the active editor.",t.id))}case"columnNumber":{const u=this._context.getColumnNumber();if(u)return u;throw new Error(h(12007,"Variable {0} can not be resolved. Make sure to have a column selected in the active editor.",t.id))}case"selectedText":{const u=this._context.getSelectedText();if(u)return u;throw new Qn(ht.SelectedText,h(12008,"Variable {0} can not be resolved. Make sure to have some text selected in the active editor.",t.id))}case"file":return a(ht.File);case"fileWorkspaceFolder":return l(ht.FileWorkspaceFolder);case"fileWorkspaceFolderBasename":return ci(l(ht.FileWorkspaceFolderBasename));case"relativeFile":return i||o?gh(this.fsPath(c(ht.RelativeFile)),a(ht.RelativeFile)):a(ht.RelativeFile);case"relativeFileDirname":{const u=Sc(a(ht.RelativeFileDirname));if(i||o){const d=gh(this.fsPath(c(ht.RelativeFileDirname)),u);return d.length===0?".":d}return u}case"fileDirname":return Sc(a(ht.FileDirname));case"fileExtname":return Wv(a(ht.FileExtname));case"fileBasename":return ci(a(ht.FileBasename));case"fileBasenameNoExtension":{const u=ci(a(ht.FileBasenameNoExtension));return u.slice(0,u.length-Wv(u).length)}case"fileDirnameBasename":return ci(Sc(a(ht.FileDirnameBasename)));case"execPath":{const u=this._context.getExecPath();return u||t.id}case"execInstallFolder":{const u=this._context.getAppRoot();return u||t.id}case"pathSeparator":case"/":return hr;default:try{return this.resolveFromMap(ht.Unknown,t.id,o,r,void 0)}catch{return t.id}}}}resolveFromMap(e,t,i,r,s){if(i&&r){const o=s===void 0?r[i]:r[s+":"+i];if(typeof o=="string")return o;throw new Qn(e,h(12009,"Variable {0} can not be resolved because the command has no value.",t))}return t}}const a2=De("IExtHostVariableResolverProvider");class GL extends jL{constructor(e,t,i,r,s,o,a){function l(){var c;if(i){const u=i.activeEditor();if(u)return u.document.uri;const d=(c=r.tabGroups.all.find(f=>f.isActive))==null?void 0:c.activeTab;if(d!==void 0){if(d.input instanceof ym||d.input instanceof zx)return d.input.modified;if(d.input instanceof Bx||d.input instanceof Vx||d.input instanceof Wx)return d.input.uri}}}super({getFolderUri:c=>{const u=o.folders.filter(d=>d.name===c);if(u&&u.length>0)return u[0].uri},getWorkspaceFolderCount:()=>o.folders.length,getConfigurationValue:(c,u)=>s.getConfiguration(void 0,c).get(u),getAppRoot:()=>uu(),getExecPath:()=>du.VSCODE_EXEC_PATH,getFilePath:()=>{const c=l();if(c)return hu(c.fsPath)},getWorkspaceFolderPathForFile:()=>{if(t){const c=l();if(c){const u=t.getWorkspaceFolder(c);if(u)return hu(u.uri.fsPath)}}},getSelectedText:()=>{if(i){const c=i.activeEditor();if(c&&!c.selection.isEmpty)return c.document.getText(c.selection)}},getLineNumber:()=>{if(i){const c=i.activeEditor();if(c)return String(c.selection.end.line+1)}},getColumnNumber:()=>{if(i){const c=i.activeEditor();if(c)return String(c.selection.end.character+1)}},getExtension:c=>e.getExtension(c)},void 0,a?Promise.resolve(a):void 0,Promise.resolve(du))}}let ey=class extends Te{constructor(e,t,i,r,s){super(),this.extensionService=e,this.workspaceService=t,this.editorService=i,this.configurationService=r,this.editorTabs=s,this._resolver=new Ci(async()=>{const o=await this.configurationService.getConfigProvider(),l={folders:await this.workspaceService.getWorkspaceFolders2()||[]};return this._register(this.workspaceService.onDidChangeWorkspace(async c=>{l.folders=await this.workspaceService.getWorkspaceFolders2()||[]})),new GL(this.extensionService,this.workspaceService,this.editorService,this.editorTabs,o,l,this.homeDir())})}getResolver(){return this._resolver.value}homeDir(){}};ey=V([F(0,No),F(1,Hs),F(2,ed),F(3,Bs),F(4,Kf)],ey);const X5=De("IExtHostDebugService");let ty=class extends Te{get onDidStartDebugSession(){return this._onDidStartDebugSession.event}get onDidTerminateDebugSession(){return this._onDidTerminateDebugSession.event}get onDidChangeActiveDebugSession(){return this._onDidChangeActiveDebugSession.event}get activeDebugSession(){var e;return(e=this._activeDebugSession)==null?void 0:e.api}get onDidReceiveDebugSessionCustomEvent(){return this._onDidReceiveDebugSessionCustomEvent.event}get activeDebugConsole(){return this._activeDebugConsole.value}constructor(e,t,i,r,s,o,a,l){super(),this._workspaceService=t,this._extensionService=i,this._configurationService=r,this._editorTabs=s,this._variableResolver=o,this._commands=a,this._testing=l,this._debugSessions=new Map,this._debugVisualizationTreeItemIdsCounter=0,this._debugVisualizationProviders=new Map,this._debugVisualizationTrees=new Map,this._debugVisualizationTreeItemIds=new WeakMap,this._debugVisualizationElements=new Map,this._visualizers=new Map,this._visualizerIdCounter=0,this._configProviderHandleCounter=0,this._configProviders=[],this._adapterFactoryHandleCounter=0,this._adapterFactories=[],this._trackerFactoryHandleCounter=0,this._trackerFactories=[],this._debugAdapters=new Map,this._debugAdaptersTrackers=new Map,this._onDidStartDebugSession=this._register(new L),this._onDidTerminateDebugSession=this._register(new L),this._onDidChangeActiveDebugSession=this._register(new L),this._onDidReceiveDebugSessionCustomEvent=this._register(new L),this._debugServiceProxy=e.getProxy(Z.MainThreadDebugService),this._onDidChangeBreakpoints=this._register(new L),this._onDidChangeActiveStackItem=this._register(new L),this._activeDebugConsole=new JL(this._debugServiceProxy),this._breakpoints=new Map,this._extensionService.getExtensionRegistry().then(c=>{this._register(c.onDidChange(u=>{this.registerAllDebugTypes(c)})),this.registerAllDebugTypes(c)}),this._telemetryProxy=e.getProxy(Z.MainThreadTelemetry)}async $getVisualizerTreeItem(e,t){var s,o;const i=this.hydrateVisualizationContext(t);if(!i)return;const r=await((o=(s=this._debugVisualizationTrees.get(e))==null?void 0:s.getTreeItem)==null?void 0:o.call(s,i));return r?this.convertVisualizerTreeItem(e,r):void 0}registerDebugVisualizationTree(e,t,i){const r=Ke.toKey(e.identifier),s=this.extensionVisKey(r,t);if(this._debugVisualizationProviders.has(s))throw new Error(`A debug visualization provider with id '${t}' is already registered`);return this._debugVisualizationTrees.set(s,i),this._debugServiceProxy.$registerDebugVisualizerTree(s,!!i.editItem),Se(()=>{this._debugServiceProxy.$unregisterDebugVisualizerTree(s),this._debugVisualizationTrees.delete(t)})}async $getVisualizerTreeItemChildren(e,t){var s,o,a;const i=(s=this._debugVisualizationElements.get(t))==null?void 0:s.item;if(!i)return[];const r=await((a=(o=this._debugVisualizationTrees.get(e))==null?void 0:o.getChildren)==null?void 0:a.call(o,i));return(r==null?void 0:r.map(l=>this.convertVisualizerTreeItem(e,l)))||[]}async $editVisualizerTreeItem(e,t){var s,o;const i=this._debugVisualizationElements.get(e);if(!i)return;const r=await((o=(s=this._debugVisualizationTrees.get(i.provider))==null?void 0:s.editItem)==null?void 0:o.call(s,i.item,t));return this.convertVisualizerTreeItem(i.provider,r||i.item)}$disposeVisualizedTree(e){var r;const t=this._debugVisualizationElements.get(e);if(!t)return;const i=[t.children];for(const s of i)if(s)for(const o of s)i.push((r=this._debugVisualizationElements.get(o))==null?void 0:r.children),this._debugVisualizationElements.delete(o)}convertVisualizerTreeItem(e,t){let i=this._debugVisualizationTreeItemIds.get(t);return i||(i=this._debugVisualizationTreeItemIdsCounter++,this._debugVisualizationTreeItemIds.set(t,i),this._debugVisualizationElements.set(i,{provider:e,item:t})),l0.from(t,i)}asDebugSourceUri(e,t){const i=e;if(typeof i.sourceReference=="number"&&i.sourceReference>0){let r=`debug:${encodeURIComponent(i.path||"")}`,s="?";return t&&(r+=`${s}session=${encodeURIComponent(t.id)}`,s="&"),r+=`${s}ref=${i.sourceReference}`,y.parse(r)}else{if(i.path)return y.file(i.path);throw new Error("cannot create uri from DAP 'source' object; properties 'path' and 'sourceReference' are both missing.")}}registerAllDebugTypes(e){const t=[];for(const i of e.getAllExtensionDescriptions())if(i.contributes){const r=i.contributes.debuggers;if(r&&r.length>0)for(const s of r)CL(s)&&t.push(s.type)}this._debugServiceProxy.$registerDebugTypes(t)}get activeStackItem(){return this._activeStackItem}get onDidChangeActiveStackItem(){return this._onDidChangeActiveStackItem.event}get onDidChangeBreakpoints(){return this._onDidChangeBreakpoints.event}get breakpoints(){const e=[];return this._breakpoints.forEach(t=>e.push(t)),e}async $resolveDebugVisualizer(e,t){var a;const i=this._visualizers.get(e);if(!i)throw new Error(`No debug visualizer found with id '${e}'`);let{v:r,provider:s,extensionId:o}=i;if(r.visualization||(r=await((a=s.resolveDebugVisualization)==null?void 0:a.call(s,r,t))||r,i.v=r),!r.visualization)throw new Error(`No visualization returned from resolveDebugVisualization in '${s}'`);return this.serializeVisualization(o,r.visualization)}async $executeDebugVisualizerCommand(e){const t=this._visualizers.get(e);if(!t)throw new Error(`No debug visualizer found with id '${e}'`);const i=t.v.visualization;i&&"command"in i&&this._commands.executeCommand(i.command,...i.arguments||[])}hydrateVisualizationContext(e){const t=this._debugSessions.get(e.sessionId);return t&&{session:t.api,variable:e.variable,containerId:e.containerId,frameId:e.frameId,threadId:e.threadId}}async $provideDebugVisualizers(e,t,i,r){const s=this.hydrateVisualizationContext(i),o=this.extensionVisKey(e,t),a=this._debugVisualizationProviders.get(o);if(!s||!a)return[];const l=await a.provideDebugVisualization(s,r);return l?l.map(c=>{const u=++this._visualizerIdCounter;this._visualizers.set(u,{v:c,provider:a,extensionId:e});const d=c.iconPath?this.getIconPathOrClass(c.iconPath):void 0;return{id:u,name:c.name,iconClass:d==null?void 0:d.iconClass,iconPath:d==null?void 0:d.iconPath,visualization:this.serializeVisualization(e,c.visualization)}}):[]}$disposeDebugVisualizers(e){for(const t of e)this._visualizers.delete(t)}registerDebugVisualizationProvider(e,t,i){var o,a;if(!((a=(o=e.contributes)==null?void 0:o.debugVisualizers)!=null&&a.some(l=>l.id===t)))throw new Error(`Extensions may only call registerDebugVisualizationProvider() for renderers they contribute (got ${t})`);const r=Ke.toKey(e.identifier),s=this.extensionVisKey(r,t);if(this._debugVisualizationProviders.has(s))throw new Error(`A debug visualization provider with id '${t}' is already registered`);return this._debugVisualizationProviders.set(s,i),this._debugServiceProxy.$registerDebugVisualizer(r,t),Se(()=>{this._debugServiceProxy.$unregisterDebugVisualizer(r,t),this._debugVisualizationProviders.delete(t)})}addBreakpoints(e){const t=e.filter(s=>{const o=s.id;return this._breakpoints.has(o)?!1:(this._breakpoints.set(o,s),!0)});this.fireBreakpointChanges(t,[],[]);const i=[],r=new Map;for(const s of t)if(s instanceof ga){let o=r.get(s.location.uri.toString());o||(o={type:"sourceMulti",uri:s.location.uri,lines:[]},r.set(s.location.uri.toString(),o),i.push(o)),o.lines.push({id:s.id,enabled:s.enabled,condition:s.condition,hitCondition:s.hitCondition,logMessage:s.logMessage,line:s.location.range.start.line,character:s.location.range.start.character,mode:s.mode})}else s instanceof ma&&i.push({type:"function",id:s.id,enabled:s.enabled,hitCondition:s.hitCondition,logMessage:s.logMessage,condition:s.condition,functionName:s.functionName,mode:s.mode});return this._debugServiceProxy.$registerBreakpoints(i)}removeBreakpoints(e){const t=e.filter(o=>this._breakpoints.delete(o.id));this.fireBreakpointChanges([],t,[]);const i=t.filter(o=>o instanceof ga).map(o=>o.id),r=t.filter(o=>o instanceof ma).map(o=>o.id),s=t.filter(o=>o instanceof sm).map(o=>o.id);return this._debugServiceProxy.$unregisterBreakpoints(i,r,s)}startDebugging(e,t,i){var s,o,a;const r=i.testRun&&this._testing.getMetadataForRun(i.testRun);return this._debugServiceProxy.$startDebugging(e?e.uri:void 0,t,{parentSessionID:i.parentSession?i.parentSession.id:void 0,lifecycleManagedByParent:i.lifecycleManagedByParent,repl:i.consoleMode===hm.MergeWithParent?"mergeWithParent":"separate",noDebug:i.noDebug,compact:i.compact,suppressSaveBeforeStart:i.suppressSaveBeforeStart,testRun:r&&{runId:r.runId,taskId:r.taskId},suppressDebugStatusbar:i.suppressDebugStatusbar??((s=i.debugUI)==null?void 0:s.simple),suppressDebugToolbar:i.suppressDebugToolbar??((o=i.debugUI)==null?void 0:o.simple),suppressDebugView:i.suppressDebugView??((a=i.debugUI)==null?void 0:a.simple)})}stopDebugging(e){return this._debugServiceProxy.$stopDebugging(e?e.id:void 0)}registerDebugConfigurationProvider(e,t,i){if(!t)return new je(()=>{});const r=this._configProviderHandleCounter++;return this._configProviders.push({type:e,handle:r,provider:t}),this._debugServiceProxy.$registerDebugConfigurationProvider(e,i,!!t.provideDebugConfigurations,!!t.resolveDebugConfiguration,!!t.resolveDebugConfigurationWithSubstitutedVariables,r),new je(()=>{this._configProviders=this._configProviders.filter(s=>s.provider!==t),this._debugServiceProxy.$unregisterDebugConfigurationProvider(r)})}registerDebugAdapterDescriptorFactory(e,t,i){if(!i)return new je(()=>{});if(!this.definesDebugType(e,t))throw new Error(`a DebugAdapterDescriptorFactory can only be registered from the extension that defines the '${t}' debugger.`);if(this.getAdapterDescriptorFactoryByType(t))throw new Error("a DebugAdapterDescriptorFactory can only be registered once per a type.");const r=this._adapterFactoryHandleCounter++;return this._adapterFactories.push({type:t,handle:r,factory:i}),this._debugServiceProxy.$registerDebugAdapterDescriptorFactory(t,r),new je(()=>{this._adapterFactories=this._adapterFactories.filter(s=>s.factory!==i),this._debugServiceProxy.$unregisterDebugAdapterDescriptorFactory(r)})}registerDebugAdapterTrackerFactory(e,t){if(!t)return new je(()=>{});const i=this._trackerFactoryHandleCounter++;return this._trackerFactories.push({type:e,handle:i,factory:t}),new je(()=>{this._trackerFactories=this._trackerFactories.filter(r=>r.factory!==t)})}async $runInTerminal(e,t){return Promise.resolve(void 0)}async $substituteVariables(e,t){let i;const r=await this.getFolder(e);return r&&(i={uri:r.uri,name:r.name,index:r.index,toResource:()=>{throw new Error("Not implemented")}}),(await this._variableResolver.getResolver()).resolveAsync(i,t)}createDebugAdapter(e,t){if(e instanceof Mh)return new YL(e.implementation)}createSignService(){}async $startDASession(e,t){const i=this,r=await this.getSession(t);return this.getAdapterDescriptor(this.getAdapterDescriptorFactoryByType(r.type),r).then(s=>{if(!s)throw new Error(`Couldn't find a debug adapter descriptor for debug type '${r.type}' (extension might have failed to activate)`);const o=this.createDebugAdapter(s,r);if(!o)throw new Error(`Couldn't create a debug adapter for type '${r.type}'.`);const a=o;return this._debugAdapters.set(e,a),this.getDebugAdapterTrackers(r).then(l=>(l&&this._debugAdaptersTrackers.set(e,l),a.onMessage(async c=>{if(c.type==="request"&&c.command==="handshake"){const u=c,d={type:"response",seq:0,command:u.command,request_seq:u.seq,success:!0};this._signService||(this._signService=this.createSignService());try{if(this._signService){const f=await this._signService.sign(u.arguments.value);d.body={signature:f},a.sendResponse(d)}else throw new Error("no signer")}catch(f){d.success=!1,d.message=f.message,a.sendResponse(d)}}else{l&&l.onDidSendMessage&&l.onDidSendMessage(c);try{c=NL(c,!0)}catch(u){const d=c.type+"_"+(c.command??c.event??"");throw this._telemetryProxy.$publicLog2("debugProtocolMessageError",{type:d,from:r.type}),u}i._debugServiceProxy.$acceptDAMessage(e,c)}}),a.onError(c=>{l&&l.onError&&l.onError(c),this._debugServiceProxy.$acceptDAError(e,c.name,c.message,c.stack)}),a.onExit(c=>{l&&l.onExit&&l.onExit(c??void 0,void 0),this._debugServiceProxy.$acceptDAExit(e,c??void 0,void 0)}),l&&l.onWillStartSession&&l.onWillStartSession(),a.startSession()))})}$sendDAMessage(e,t){t=LL(t);const i=this._debugAdaptersTrackers.get(e);i&&i.onWillReceiveMessage&&i.onWillReceiveMessage(t);const r=this._debugAdapters.get(e);r==null||r.sendMessage(t)}$stopDASession(e){const t=this._debugAdaptersTrackers.get(e);this._debugAdaptersTrackers.delete(e),t&&t.onWillStopSession&&t.onWillStopSession();const i=this._debugAdapters.get(e);return this._debugAdapters.delete(e),i?i.stopSession():Promise.resolve(void 0)}$acceptBreakpointsDelta(e){const t=[],i=[],r=[];if(e.added)for(const s of e.added){const o=s.id;if(o&&!this._breakpoints.has(o)){let a;if(s.type==="function")a=new ma(s.functionName,s.enabled,s.condition,s.hitCondition,s.logMessage,s.mode);else if(s.type==="data")a=new sm(s.label,s.dataId,s.canPersist,s.enabled,s.hitCondition,s.condition,s.logMessage,s.mode);else{const l=y.revive(s.uri);a=new ga(new Ti(l,new We(s.line,s.character)),s.enabled,s.condition,s.hitCondition,s.logMessage,s.mode)}d3(a,o),this._breakpoints.set(o,a),t.push(a)}}if(e.removed)for(const s of e.removed){const o=this._breakpoints.get(s);o&&(this._breakpoints.delete(s),i.push(o))}if(e.changed){for(const s of e.changed)if(s.id){const o=this._breakpoints.get(s.id);if(o){if(o instanceof ma&&s.type==="function"){const a=o;a.enabled=s.enabled,a.condition=s.condition,a.hitCondition=s.hitCondition,a.logMessage=s.logMessage,a.functionName=s.functionName}else if(o instanceof ga&&s.type==="source"){const a=o;a.enabled=s.enabled,a.condition=s.condition,a.hitCondition=s.hitCondition,a.logMessage=s.logMessage,a.location=new Ti(y.revive(s.uri),new We(s.line,s.character))}r.push(o)}}}this.fireBreakpointChanges(t,i,r)}async $acceptStackFrameFocus(e){let t;if(e){const i=await this.getSession(e.sessionId);e.kind==="thread"?t=new qC(i.api,e.threadId):t=new zC(i.api,e.threadId,e.frameId)}this._activeStackItem=t,this._onDidChangeActiveStackItem.fire(this._activeStackItem)}$provideDebugConfigurations(e,t,i){return Nn(async()=>{const r=this.getConfigProviderByHandle(e);if(!r)throw new Error("no DebugConfigurationProvider found");if(!r.provideDebugConfigurations)throw new Error("DebugConfigurationProvider has no method provideDebugConfigurations");const s=await this.getFolder(t);return r.provideDebugConfigurations(s,i)}).then(r=>{if(!r)throw new Error("nothing returned from DebugConfigurationProvider.provideDebugConfigurations");return r})}$resolveDebugConfiguration(e,t,i,r){return Nn(async()=>{const s=this.getConfigProviderByHandle(e);if(!s)throw new Error("no DebugConfigurationProvider found");if(!s.resolveDebugConfiguration)throw new Error("DebugConfigurationProvider has no method resolveDebugConfiguration");const o=await this.getFolder(t);return s.resolveDebugConfiguration(o,i,r)})}$resolveDebugConfigurationWithSubstitutedVariables(e,t,i,r){return Nn(async()=>{const s=this.getConfigProviderByHandle(e);if(!s)throw new Error("no DebugConfigurationProvider found");if(!s.resolveDebugConfigurationWithSubstitutedVariables)throw new Error("DebugConfigurationProvider has no method resolveDebugConfigurationWithSubstitutedVariables");const o=await this.getFolder(t);return s.resolveDebugConfigurationWithSubstitutedVariables(o,i,r)})}async $provideDebugAdapter(e,t){const i=this.getAdapterDescriptorFactoryByHandle(e);if(!i)return Promise.reject(new Error("no adapter descriptor factory found for handle"));const r=await this.getSession(t);return this.getAdapterDescriptor(i,r).then(s=>{if(!s)throw new Error(`Couldn't find a debug adapter descriptor for debug type '${r.type}'`);return this.convertToDto(s)})}async $acceptDebugSessionStarted(e){const t=await this.getSession(e);this._onDidStartDebugSession.fire(t.api)}async $acceptDebugSessionTerminated(e){const t=await this.getSession(e);t&&(this._onDidTerminateDebugSession.fire(t.api),this._debugSessions.delete(t.id))}async $acceptDebugSessionActiveChanged(e){var t;this._activeDebugSession=e?await this.getSession(e):void 0,this._onDidChangeActiveDebugSession.fire((t=this._activeDebugSession)==null?void 0:t.api)}async $acceptDebugSessionNameChanged(e,t){const i=await this.getSession(e);i==null||i._acceptNameChanged(t)}async $acceptDebugSessionCustomEvent(e,t){const r={session:(await this.getSession(e)).api,event:t.event,body:t.body};this._onDidReceiveDebugSessionCustomEvent.fire(r)}convertToDto(e){if(e instanceof om)return this.convertExecutableToDto(e);if(e instanceof Fh)return this.convertServerToDto(e);if(e instanceof am)return this.convertPipeServerToDto(e);if(e instanceof Mh)return this.convertImplementationToDto(e);throw new Error("convertToDto unexpected type")}convertExecutableToDto(e){return{type:"executable",command:e.command,args:e.args,options:e.options}}convertServerToDto(e){return{type:"server",port:e.port,host:e.host}}convertPipeServerToDto(e){return{type:"pipeServer",path:e.path}}convertImplementationToDto(e){return{type:"implementation"}}getAdapterDescriptorFactoryByType(e){const t=this._adapterFactories.filter(i=>i.type===e);if(t.length>0)return t[0].factory}getAdapterDescriptorFactoryByHandle(e){const t=this._adapterFactories.filter(i=>i.handle===e);if(t.length>0)return t[0].factory}getConfigProviderByHandle(e){const t=this._configProviders.filter(i=>i.handle===e);if(t.length>0)return t[0].provider}definesDebugType(e,t){if(e.contributes){const i=e.contributes.debuggers;if(i&&i.length>0){for(const r of i)if(r.label&&r.type&&r.type===t)return!0}}return!1}getDebugAdapterTrackers(e){const i=e.configuration.type,r=this._trackerFactories.filter(s=>s.type===i||s.type==="*").map(s=>Nn(()=>s.factory.createDebugAdapterTracker(e.api)).then(o=>o,o=>null));return Promise.race([Promise.all(r).then(s=>{const o=sn(s);if(o.length>0)return new XL(o)}),new Promise(s=>setTimeout(()=>s(void 0),1e3))]).catch(s=>{})}async getAdapterDescriptor(e,t){const i=t.configuration.debugServer;if(typeof i=="number")return Promise.resolve(new Fh(i));if(e){const s=await this._extensionService.getExtensionRegistry();return Nn(()=>e.createDebugAdapterDescriptor(t.api,this.daExecutableFromPackage(t,s))).then(o=>{if(o)return o})}const r=await this._extensionService.getExtensionRegistry();return Promise.resolve(this.daExecutableFromPackage(t,r))}daExecutableFromPackage(e,t){}fireBreakpointChanges(e,t,i){(e.length>0||t.length>0||i.length>0)&&this._onDidChangeBreakpoints.fire(Object.freeze({added:e,removed:t,changed:i}))}async getSession(e){if(e)if(typeof e=="string"){const t=this._debugSessions.get(e);if(t)return t}else{let t=this._debugSessions.get(e.id);if(!t){const i=await this.getFolder(e.folderUri),r=e.parent?this._debugSessions.get(e.parent):void 0;t=new QL(this._debugServiceProxy,e.id,e.type,e.name,i,e.configuration,r==null?void 0:r.api),this._debugSessions.set(t.id,t),this._debugServiceProxy.$sessionCached(t.id)}return t}throw new Error("cannot find session")}getFolder(e){if(e){const t=y.revive(e);return this._workspaceService.resolveWorkspaceFolder(t)}return Promise.resolve(void 0)}extensionVisKey(e,t){return`${e}\0${t}`}serializeVisualization(e,t){if(t){if("title"in t&&"command"in t)return{type:Cg.Command};if("treeId"in t)return{type:Cg.Tree,id:`${e}\0${t.treeId}`};throw new Error("Unsupported debug visualization type")}}getIconPathOrClass(e){const t=this.getIconUris(e);let i,r;return"id"in t?r=On.asClassName(t):i=t,{iconPath:i,iconClass:r}}getIconUris(e){if(e instanceof qn)return{id:e.id};const t=typeof e=="object"&&"dark"in e?e.dark:e,i=typeof e=="object"&&"light"in e?e.light:e;return{dark:typeof t=="string"?y.file(t):t,light:typeof i=="string"?y.file(i):i}}};ty=V([F(0,tt),F(1,Hs),F(2,No),F(3,Bs),F(4,Kf),F(5,a2),F(6,Ll),F(7,P_)],ty);class QL{constructor(e,t,i,r,s,o,a){this._debugServiceProxy=e,this._id=t,this._type=i,this._name=r,this._workspaceFolder=s,this._configuration=o,this._parentSession=a}get api(){const e=this;return this.apiSession??(this.apiSession=Object.freeze({id:e._id,type:e._type,get name(){return e._name},set name(t){e._name=t,e._debugServiceProxy.$setDebugSessionName(e._id,t)},parentSession:e._parentSession,workspaceFolder:e._workspaceFolder,configuration:e._configuration,customRequest(t,i){return e._debugServiceProxy.$customDebugAdapterRequest(e._id,t,i)},getDebugProtocolBreakpoint(t){return e._debugServiceProxy.$getDebugProtocolBreakpoint(e._id,t.id)}}))}get id(){return this._id}get type(){return this._type}_acceptNameChanged(e){this._name=e}get configuration(){return this._configuration}}class JL{constructor(e){this.value=Object.freeze({append(t){e.$appendDebugConsole(t)},appendLine(t){this.append(t+`
`)}})}}class XL{constructor(e){this.trackers=e}onWillStartSession(){this.trackers.forEach(e=>e.onWillStartSession?e.onWillStartSession():void 0)}onWillReceiveMessage(e){this.trackers.forEach(t=>t.onWillReceiveMessage?t.onWillReceiveMessage(e):void 0)}onDidSendMessage(e){this.trackers.forEach(t=>t.onDidSendMessage?t.onDidSendMessage(e):void 0)}onWillStopSession(){this.trackers.forEach(e=>e.onWillStopSession?e.onWillStopSession():void 0)}onError(e){this.trackers.forEach(t=>t.onError?t.onError(e):void 0)}onExit(e,t){this.trackers.forEach(i=>i.onExit?i.onExit(e,t):void 0)}}class YL extends IL{constructor(e){super(),this.implementation=e,e.onDidSendMessage(t=>{this.acceptMessage(t)})}startSession(){return Promise.resolve(void 0)}sendMessage(e){this.implementation.handleMessage(e)}stopSession(){return this.implementation.dispose(),Promise.resolve(void 0)}}let ny=class extends ty{constructor(e,t,i,r,s,o,a,l){super(e,t,i,r,s,o,a,l)}};ny=V([F(0,tt),F(1,Hs),F(2,No),F(3,Bs),F(4,Kf),F(5,a2),F(6,Ll),F(7,P_)],ny);function ZL(n){return"uri"in n&&"ranges"in n&&"preview"in n}function KL(n){return n.folderOptions.map(e=>({folder:e.folder,excludes:e.excludes.map(t=>typeof t=="string"?t:t.pattern),includes:e.includes,useGlobalIgnoreFiles:e.useIgnoreFiles.global,useIgnoreFiles:e.useIgnoreFiles.local,useParentIgnoreFiles:e.useIgnoreFiles.parent,followSymlinks:e.followSymlinks,maxResults:n.maxResults,session:n.session}))}class Y5{constructor(e){this.provider=e}provideFileSearchResults(e,t,i){return(async()=>{const s=KL(t);return Promise.all(s.map(o=>this.provider.provideFileSearchResults({pattern:e},o,i)))})().then(s=>sn(s).flat())}}function eN(n){return n.folderOptions.map(e=>({folder:e.folder,excludes:e.excludes.map(t=>typeof t=="string"?t:t.pattern),includes:e.includes,useGlobalIgnoreFiles:e.useIgnoreFiles.global,useIgnoreFiles:e.useIgnoreFiles.local,useParentIgnoreFiles:e.useIgnoreFiles.parent,followSymlinks:e.followSymlinks,maxResults:n.maxResults,previewOptions:tN(n.previewOptions),maxFileSize:n.maxFileSize,encoding:e.encoding,afterContext:n.surroundingContext,beforeContext:n.surroundingContext}))}function tN(n){return{matchLines:(n==null?void 0:n.matchLines)??d0.matchLines,charsPerLine:(n==null?void 0:n.charsPerLine)??d0.charsPerLine}}function nN(n){if(ZL(n)){const e=Bi(n.ranges).map((t,i)=>{const s=Bi(n.preview.matches)[i];return{sourceRange:t,previewRange:s}});return new wo(n.uri,e,n.preview.text)}else return new jx(n.uri,n.text,n.lineNumber)}class iN{constructor(e){this.provider=e}provideTextSearchResults(e,t,i,r){const s=l=>{rN(l)&&i.report(nN(l))};return(async()=>sn(await Promise.all(eN(t).map(l=>this.provider.provideTextSearchResults(e,l,{report:c=>s(c)},r)))).reduce((l,c)=>({limitHit:l.limitHit||c.limitHit}),{limitHit:!1}))().then(l=>({limitHit:l.limitHit,message:sn(Bi(l.message))}))}}function rN(n){if(sN(n)){if(Array.isArray(n.ranges)){if(!Array.isArray(n.preview.matches))return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same type."),!1;if(n.preview.matches.length!==n.ranges.length)return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length."),!1}else if(Array.isArray(n.preview.matches))return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length."),!1}return!0}function sN(n){return!!n.preview}class Z5 extends ki{constructor(e,t,i=()=>!1){const r=new GI(i,()=>!1);super(r);const s=new on;e.forEach((o,a)=>{const l=o.folder.with({query:"",fragment:""});s.has(l)?s.get(l).push({fq:o,i:a}):s.set(l,[{fq:o,i:a}])}),s.forEach((o,a)=>{const l=new Map;for(const c of o){const u=t(c.fq,c.i);l.set(this.encodeKey(c.fq.folder),u)}super.set(a,l)})}findQueryFragmentAwareSubstr(e){const t=super.findSubstr(e.with({query:"",fragment:""}));if(!t)return;const i=this.encodeKey(e);return t.get(i)}forEachFolderQueryInfo(e){return this.forEach(t=>t.forEach(i=>e(i)))}encodeKey(e){let t="";return e.query&&(t+=e.query),e.fragment&&(t+="#"+e.fragment),t}}class oN{constructor(e,t,i){this.config=e,this.provider=t,this.sessionLifecycle=i,this.isLimitHit=!1,this.resultCount=0,this.isCanceled=!1,this.filePattern=e.filePattern,this.includePattern=e.includePattern&&_u(e.includePattern),this.maxResults=e.maxResults||void 0,this.exists=e.exists,this.activeCancellationTokens=new Set,this.globalExcludePattern=e.excludePattern&&_u(e.excludePattern)}cancel(){this.isCanceled=!0,this.activeCancellationTokens.forEach(e=>e.cancel()),this.activeCancellationTokens=new Set}search(e){const t=this.config.folderQueries||[];return new Promise((i,r)=>{const s=o=>{this.resultCount++,e(o)};if(this.isCanceled)return i({limitHit:this.isLimitHit});this.config.extraFileResources&&this.config.extraFileResources.forEach(o=>{const a=o.toString(),l=ci(a);this.globalExcludePattern&&this.globalExcludePattern(a,l)||this.matchFile(s,{base:o,basename:l})}),this.doSearch(t,s).then(o=>{i({limitHit:this.isLimitHit,stats:o||void 0})},o=>{r(new Error(Zu(o)))})})}async doSearch(e,t){var u,d;const i=new Bt,r=e.map(f=>this.getSearchOptionsForFolder(f)),s=this.provider instanceof Y5?(u=this.sessionLifecycle)==null?void 0:u.tokenSource.token:(d=this.sessionLifecycle)==null?void 0:d.obj,o={folderOptions:r,maxResults:this.config.maxResults??g5,session:s},a=f=>{const p=new w5(this.config,f),w=!p.hasSiblingExcludeClauses();return{queryTester:p,noSiblingsClauses:w,folder:f.folder,tree:this.initDirectoryTree()}},l=new Z5(e,a);let c;try{this.activeCancellationTokens.add(i),c=Os.create();const f=await this.provider.provideFileSearchResults(this.config.filePattern||"",o,i.token),p=c.elapsed(),w=Os.create();return this.isCanceled&&!this.isLimitHit||(f&&f.forEach(v=>{const m=l.findQueryFragmentAwareSubstr(v),x=ot.relative(m.folder.path,v.path);if(m.noSiblingsClauses){const k=ci(v.path);this.matchFile(t,{base:m.folder,relativePath:x,basename:k});return}this.addDirectoryEntries(m.tree,m.folder,x,t)}),this.isCanceled&&!this.isLimitHit)?null:(l.forEachFolderQueryInfo(v=>{this.matchDirectoryTree(v.tree,v.queryTester,t)}),{providerTime:p,postProcessTime:w.elapsed()})}finally{i.dispose(),this.activeCancellationTokens.delete(i)}}getSearchOptionsForFolder(e){var s;const t=Hc(this.config.includePattern,e.includePattern);let i=(s=e.excludePattern)==null?void 0:s.map(o=>({folder:o.folder,patterns:Hc(this.config.excludePattern,o.pattern)}));i!=null&&i.length||(i=[{folder:void 0,patterns:Hc(this.config.excludePattern,void 0)}]);const r=y5(i);return{folder:e.folder,excludes:r,includes:t,useIgnoreFiles:{local:!e.disregardIgnoreFiles,parent:!e.disregardParentIgnoreFiles,global:!e.disregardGlobalIgnoreFiles},followSymlinks:!e.ignoreSymlinks}}initDirectoryTree(){const e={rootEntries:[],pathToEntries:Object.create(null)};return e.pathToEntries["."]=e.rootEntries,e}addDirectoryEntries({pathToEntries:e},t,i,r){if(i===this.filePattern){const o=ci(this.filePattern);this.matchFile(r,{base:t,relativePath:this.filePattern,basename:o})}function s(o){const a=ci(o),l=Sc(o);let c=e[l];c||(c=e[l]=[],s(l)),c.push({base:t,relativePath:o,basename:a})}s(i)}matchDirectoryTree({rootEntries:e,pathToEntries:t},i,r){const s=this,o=this.filePattern;function a(l){const c=F3(()=>l.map(u=>u.basename));for(let u=0,d=l.length;u<d;u++){const f=l[u],{relativePath:p,basename:w}=f;if(i.matchesExcludesSync(p,w,o!==w?c:void 0))continue;const v=t[p];if(v)a(v);else{if(p===o)continue;s.matchFile(r,f)}if(s.isLimitHit)break}}a(e)}matchFile(e,t){(!this.includePattern||t.relativePath&&this.includePattern(t.relativePath,t.basename))&&((this.exists||this.maxResults&&this.resultCount>=this.maxResults)&&(this.isLimitHit=!0,this.cancel()),this.isLimitHit||e(t))}}class aN{constructor(){this._obj=new Object,this.tokenSource=new Bt}get obj(){if(this._obj)return this._obj;throw new Error("Session object has been dereferenced.")}cancel(){this.tokenSource.cancel(),this._obj=void 0}}const M1=class M1{constructor(){this.sessions=new Map}fileSearch(e,t,i,r){const s=this.getSessionTokenSource(e.cacheKey),o=new oN(e,t,s);let a=0;const l=c=>{a+=c.length,i(c.map(u=>this.rawMatchToSearchItem(u)))};return this.doSearch(o,M1.BATCH_SIZE,l,r).then(c=>({limitHit:c.limitHit,stats:c.stats?{fromCache:!1,type:"fileSearchProvider",resultCount:a,detailStats:c.stats}:void 0,messages:[]}))}clearCache(e){var t;(t=this.sessions.get(e))==null||t.cancel(),this.sessions.delete(e)}getSessionTokenSource(e){if(e)return this.sessions.has(e)||this.sessions.set(e,new aN),this.sessions.get(e)}rawMatchToSearchItem(e){return e.relativePath?{resource:An(e.base,e.relativePath)}:{resource:e.base}}doSearch(e,t,i,r){const s=r.onCancellationRequested(()=>{e.cancel()}),o=l=>{l&&(a.push(l),t>0&&a.length>=t&&(i(a),a=[]))};let a=[];return e.search(o).then(l=>(a.length&&i(a),s.dispose(),l),l=>(a.length&&i(a),s.dispose(),Promise.reject(l)))}};M1.BATCH_SIZE=512;let iy=M1;class ND{constructor(e,t,i){this.queryProviderPair=e,this.fileUtils=t,this.processType=i,this.collector=null,this.isLimitHit=!1,this.resultCount=0}get query(){return this.queryProviderPair.query}search(e,t){const i=this.query.folderQueries||[],r=new Bt(t);return new Promise((s,o)=>{this.collector=new cN(e);let a=!1;const l=(c,u)=>{if(!a&&!this.isLimitHit){const d=this.resultSize(c);c instanceof wo&&typeof this.query.maxResults=="number"&&this.resultCount+d>this.query.maxResults&&(this.isLimitHit=!0,a=!0,r.cancel(),c=this.trimResultToSize(c,this.query.maxResults-this.resultCount));const f=this.resultSize(c);this.resultCount+=f;const p=c instanceof wo;(f>0||!p)&&this.collector.add(c,u)}};this.doSearch(i,l,r.token).then(c=>{r.dispose(),this.collector.flush(),s({limitHit:this.isLimitHit||(c==null?void 0:c.limitHit),messages:this.getMessagesFromResults(c),stats:{type:this.processType}})},c=>{r.dispose();const u=Zu(c);o(new Error(u))})})}getMessagesFromResults(e){return e!=null&&e.message?Array.isArray(e.message)?e.message:[e.message]:[]}resultSize(e){return e instanceof wo?Array.isArray(e.ranges)?e.ranges.length:1:0}trimResultToSize(e,t){return new wo(e.uri,e.ranges.slice(0,t),e.previewText)}async doSearch(e,t,i){const r=new Z5(e,(u,d)=>({queryTester:new w5(this.query,u),folder:u.folder,folderIdx:d}),()=>!0),s=[],o={report:u=>{if(u.uri===void 0)throw Error("Text search result URI is undefined. Please check provider implementation.");const d=r.findQueryFragmentAwareSubstr(u.uri),f=d.folder.scheme===oe.file?O3(()=>this.fileUtils.readdir(r_(u.uri))):void 0,p=$I(d.folder,u.uri);if(p){const w=d.queryTester.includedInQuery(p,ci(p),f);Io(w)?s.push(w.then(v=>{v&&t(u,d.folderIdx)})):w&&t(u,d.folderIdx)}}},l={folderOptions:e.map(u=>this.getSearchOptionsForFolder(u)),maxFileSize:this.query.maxFileSize,maxResults:this.query.maxResults??g5,previewOptions:this.query.previewOptions??d0,surroundingContext:this.query.surroundingContext??0};"usePCRE2"in this.query&&(l.usePCRE2=this.query.usePCRE2);let c;return this.queryProviderPair.query.type===tl.aiText?c=await this.queryProviderPair.provider.provideAITextSearchResults(this.queryProviderPair.query.contentPattern,l,o,i):c=await this.queryProviderPair.provider.provideTextSearchResults(lN(this.queryProviderPair.query.contentPattern),l,o,i),s.length&&await Promise.all(s),c}getSearchOptionsForFolder(e){var o;const t=Hc(this.query.includePattern,e.includePattern);let i=(o=e.excludePattern)==null?void 0:o.map(a=>({folder:a.folder,patterns:Hc(this.query.excludePattern,a.pattern)}));(!i||i.length===0)&&(i=[{folder:void 0,patterns:Hc(this.query.excludePattern,void 0)}]);const r=y5(i);return{folder:y.from(e.folder),excludes:r,includes:t,useIgnoreFiles:{local:!e.disregardIgnoreFiles,parent:!e.disregardParentIgnoreFiles,global:!e.disregardGlobalIgnoreFiles},followSymlinks:!e.ignoreSymlinks,encoding:(e.fileEncoding&&this.fileUtils.toCanonicalName(e.fileEncoding))??""}}}function lN(n){return{isCaseSensitive:n.isCaseSensitive||!1,isRegExp:n.isRegExp||!1,isWordMatch:n.isWordMatch||!1,isMultiline:n.isMultiline||!1,pattern:n.pattern}}class cN{constructor(e){this._onResult=e,this._currentFolderIdx=-1,this._currentFileMatch=null,this._batchedCollector=new ry(512,t=>this.sendItems(t))}add(e,t){this._currentFileMatch&&(this._currentFolderIdx!==t||!Dc(this._currentUri,e.uri))&&(this.pushToCollector(),this._currentFileMatch=null),this._currentFileMatch||(this._currentFolderIdx=t,this._currentFileMatch={resource:e.uri,results:[]}),this._currentFileMatch.results.push(uN(e))}pushToCollector(){const e=this._currentFileMatch&&this._currentFileMatch.results?this._currentFileMatch.results.length:0;this._batchedCollector.addItem(this._currentFileMatch,e)}flush(){this.pushToCollector(),this._batchedCollector.flush()}sendItems(e){this._onResult(e)}}function uN(n){return n instanceof wo?{previewText:n.previewText,rangeLocations:n.ranges.map(e=>({preview:{startLineNumber:e.previewRange.start.line,startColumn:e.previewRange.start.character,endLineNumber:e.previewRange.end.line,endColumn:e.previewRange.end.character},source:{startLineNumber:e.sourceRange.start.line,startColumn:e.sourceRange.start.character,endLineNumber:e.sourceRange.end.line,endColumn:e.sourceRange.end.character}}))}:{text:n.text,lineNumber:n.lineNumber}}const bc=class bc{constructor(e,t){this.maxBatchSize=e,this.cb=t,this.totalNumberCompleted=0,this.batch=[],this.batchSize=0}addItem(e,t){e&&this.addItemToBatch(e,t)}addItems(e,t){e&&this.addItemsToBatch(e,t)}addItemToBatch(e,t){this.batch.push(e),this.batchSize+=t,this.onUpdate()}addItemsToBatch(e,t){this.batch=this.batch.concat(e),this.batchSize+=t,this.onUpdate()}onUpdate(){this.totalNumberCompleted<bc.START_BATCH_AFTER_COUNT?this.flush():this.batchSize>=this.maxBatchSize?this.flush():this.timeoutHandle||(this.timeoutHandle=setTimeout(()=>{this.flush()},bc.TIMEOUT))}flush(){this.batchSize&&(this.totalNumberCompleted+=this.batchSize,this.cb(this.batch),this.batch=[],this.batchSize=0,this.timeoutHandle&&(clearTimeout(this.timeoutHandle),this.timeoutHandle=0))}};bc.TIMEOUT=4e3,bc.START_BATCH_AFTER_COUNT=50;let ry=bc;const K5=De("IExtHostSearch");let sy=class{constructor(e,t,i){this.extHostRpc=e,this._uriTransformer=t,this._logService=i,this._proxy=this.extHostRpc.getProxy(Z.MainThreadSearch),this._handlePool=0,this._textSearchProvider=new Map,this._textSearchUsedSchemes=new Set,this._aiTextSearchProvider=new Map,this._aiTextSearchUsedSchemes=new Set,this._fileSearchProvider=new Map,this._fileSearchUsedSchemes=new Set,this._fileSearchManager=new iy}_transformScheme(e){return this._uriTransformer.transformOutgoingScheme(e)}registerTextSearchProviderOld(e,t){if(this._textSearchUsedSchemes.has(e))throw new Error(`a text search provider for the scheme '${e}' is already registered`);this._textSearchUsedSchemes.add(e);const i=this._handlePool++;return this._textSearchProvider.set(i,new iN(t)),this._proxy.$registerTextSearchProvider(i,this._transformScheme(e)),Se(()=>{this._textSearchUsedSchemes.delete(e),this._textSearchProvider.delete(i),this._proxy.$unregisterProvider(i)})}registerTextSearchProvider(e,t){if(this._textSearchUsedSchemes.has(e))throw new Error(`a text search provider for the scheme '${e}' is already registered`);this._textSearchUsedSchemes.add(e);const i=this._handlePool++;return this._textSearchProvider.set(i,t),this._proxy.$registerTextSearchProvider(i,this._transformScheme(e)),Se(()=>{this._textSearchUsedSchemes.delete(e),this._textSearchProvider.delete(i),this._proxy.$unregisterProvider(i)})}registerAITextSearchProvider(e,t){if(this._aiTextSearchUsedSchemes.has(e))throw new Error(`an AI text search provider for the scheme '${e}'is already registered`);this._aiTextSearchUsedSchemes.add(e);const i=this._handlePool++;return this._aiTextSearchProvider.set(i,t),this._proxy.$registerAITextSearchProvider(i,this._transformScheme(e)),Se(()=>{this._aiTextSearchUsedSchemes.delete(e),this._aiTextSearchProvider.delete(i),this._proxy.$unregisterProvider(i)})}registerFileSearchProviderOld(e,t){if(this._fileSearchUsedSchemes.has(e))throw new Error(`a file search provider for the scheme '${e}' is already registered`);this._fileSearchUsedSchemes.add(e);const i=this._handlePool++;return this._fileSearchProvider.set(i,new Y5(t)),this._proxy.$registerFileSearchProvider(i,this._transformScheme(e)),Se(()=>{this._fileSearchUsedSchemes.delete(e),this._fileSearchProvider.delete(i),this._proxy.$unregisterProvider(i)})}registerFileSearchProvider(e,t){if(this._fileSearchUsedSchemes.has(e))throw new Error(`a file search provider for the scheme '${e}' is already registered`);this._fileSearchUsedSchemes.add(e);const i=this._handlePool++;return this._fileSearchProvider.set(i,t),this._proxy.$registerFileSearchProvider(i,this._transformScheme(e)),Se(()=>{this._fileSearchUsedSchemes.delete(e),this._fileSearchProvider.delete(i),this._proxy.$unregisterProvider(i)})}$provideFileSearchResults(e,t,i,r){const s=_v(i),o=this._fileSearchProvider.get(e);if(o)return this._fileSearchManager.fileSearch(s,o,a=>{this._proxy.$handleFileMatch(e,t,a.map(l=>l.resource))},r);throw new Error("unknown provider: "+e)}async doInternalFileSearchWithCustomCallback(e,t,i){return{messages:[]}}$clearCache(e){return this._fileSearchManager.clearCache(e),Promise.resolve(void 0)}$provideTextSearchResults(e,t,i,r){const s=this._textSearchProvider.get(e);if(!s||!s.provideTextSearchResults)throw new Error(`Unknown Text Search Provider ${e}`);const o=_v(i);return this.createTextSearchManager(o,s).search(l=>this._proxy.$handleTextMatch(e,t,l),r)}$provideAITextSearchResults(e,t,i,r){const s=this._aiTextSearchProvider.get(e);if(!s||!s.provideAITextSearchResults)throw new Error(`Unknown AI Text Search Provider ${e}`);const o=_v(i);return this.createAITextSearchManager(o,s).search(l=>this._proxy.$handleTextMatch(e,t,l),r)}$enableExtensionHostSearch(){}async $getAIName(e){const t=this._aiTextSearchProvider.get(e);if(!(!t||!t.provideAITextSearchResults))return t.name??"AI"}createTextSearchManager(e,t){return new ND({query:e,provider:t},{readdir:i=>Promise.resolve([]),toCanonicalName:i=>i},"textSearchProvider")}createAITextSearchManager(e,t){return new ND({query:e,provider:t},{readdir:i=>Promise.resolve([]),toCanonicalName:i=>i},"aiTextSearchProvider")}};sy=V([F(0,tt),F(1,s_),F(2,ct)],sy);function _v(n){return{...n,folderQueries:n.folderQueries&&n.folderQueries.map(dN),extraFileResources:n.extraFileResources&&n.extraFileResources.map(e=>y.revive(e))}}function dN(n){return jn(n)}var oy,al;let ay=(al=class{getState(){const e=this._state;return{get focused(){return e.focused},get active(){return e.active}}}constructor(e,t){this._onDidChangeWindowState=new L,this.onDidChangeWindowState=this._onDidChangeWindowState.event,this._state=oy.InitialState,e.handle&&(this._nativeHandle=Zp(e.handle).buffer),this._proxy=t.getProxy(Z.MainThreadWindow),this._proxy.$getInitialState().then(({isFocused:i,isActive:r})=>{this.onDidChangeWindowProperty("focused",i),this.onDidChangeWindowProperty("active",r)})}get nativeHandle(){return this._nativeHandle}$onDidChangeActiveNativeWindowHandle(e){this._nativeHandle=e?Zp(e).buffer:void 0}$onDidChangeWindowFocus(e){this.onDidChangeWindowProperty("focused",e)}$onDidChangeWindowActive(e){this.onDidChangeWindowProperty("active",e)}onDidChangeWindowProperty(e,t){t!==this._state[e]&&(this._state={...this._state,[e]:t},this._onDidChangeWindowState.fire(this._state))}openUri(e,t){let i;if(typeof e=="string"){i=e;try{e=y.parse(e)}catch{return Promise.reject(`Invalid uri - '${e}'`)}}return mh(e.scheme)?Promise.reject("Invalid scheme - cannot be empty"):e.scheme===oe.command?Promise.reject(`Invalid scheme '${e.scheme}'`):this._proxy.$openUri(e,i,t)}async asExternalUri(e,t){if(mh(e.scheme))return Promise.reject("Invalid scheme - cannot be empty");const i=await this._proxy.$asExternalUri(e,t);return y.from(i)}},oy=al,al.InitialState={focused:!0,active:!0},al);ay=oy=V([F(0,In),F(1,tt)],ay);const e7=De("IExtHostWindow"),t7=De("IExtHostTerminalShellIntegration");let ly=class extends Te{constructor(e,t){super(),this._extHostTerminalService=t,this._activeShellIntegrations=new Map,this._onDidChangeTerminalShellIntegration=new L,this.onDidChangeTerminalShellIntegration=this._onDidChangeTerminalShellIntegration.event,this._onDidStartTerminalShellExecution=new L,this.onDidStartTerminalShellExecution=this._onDidStartTerminalShellExecution.event,this._onDidEndTerminalShellExecution=new L,this.onDidEndTerminalShellExecution=this._onDidEndTerminalShellExecution.event,this._proxy=e.getProxy(Z.MainThreadTerminalShellIntegration),this._register(Se(()=>{for(const[i,r]of this._activeShellIntegrations)r.dispose();this._activeShellIntegrations.clear()}))}$shellIntegrationChange(e){const t=this._extHostTerminalService.getTerminalById(e);if(!t)return;const i=t.value;let r=this._activeShellIntegrations.get(e);r||(r=new hN(t.value,this._onDidStartTerminalShellExecution),this._activeShellIntegrations.set(e,r),r.store.add(t.onWillDispose(()=>{var s;return(s=this._activeShellIntegrations.get(e))==null?void 0:s.dispose()})),r.store.add(r.onDidRequestShellExecution(s=>this._proxy.$executeCommand(e,s))),r.store.add(r.onDidRequestEndExecution(s=>this._onDidEndTerminalShellExecution.fire(s))),r.store.add(r.onDidRequestChangeShellIntegration(s=>this._onDidChangeTerminalShellIntegration.fire(s))),t.shellIntegration=r.value),this._onDidChangeTerminalShellIntegration.fire({terminal:i,shellIntegration:r.value})}$shellExecutionStart(e,t,i,r,s){var a;this._activeShellIntegrations.has(e)||this.$shellIntegrationChange(e);const o={value:t,confidence:i,isTrusted:r};(a=this._activeShellIntegrations.get(e))==null||a.startShellExecution(o,y.revive(s))}$shellExecutionEnd(e,t,i,r,s){var a;const o={value:t,confidence:i,isTrusted:r};(a=this._activeShellIntegrations.get(e))==null||a.endShellExecution(o,s)}$shellExecutionData(e,t){var i;(i=this._activeShellIntegrations.get(e))==null||i.emitData(t)}$shellEnvChange(e,t,i,r){var s;(s=this._activeShellIntegrations.get(e))==null||s.setEnv(t,i,r)}$cwdChange(e,t){var i;(i=this._activeShellIntegrations.get(e))==null||i.setCwd(y.revive(t))}$closeTerminal(e){var t;(t=this._activeShellIntegrations.get(e))==null||t.dispose(),this._activeShellIntegrations.delete(e)}};ly=V([F(0,tt),F(1,Ku)],ly);class hN extends Te{get currentExecution(){return this._currentExecution}constructor(e,t){super(),this._terminal=e,this._onDidStartTerminalShellExecution=t,this._pendingExecutions=[],this.store=this._register(new Ie),this._onDidRequestChangeShellIntegration=this._register(new L),this.onDidRequestChangeShellIntegration=this._onDidRequestChangeShellIntegration.event,this._onDidRequestShellExecution=this._register(new L),this.onDidRequestShellExecution=this._onDidRequestShellExecution.event,this._onDidRequestEndExecution=this._register(new L),this.onDidRequestEndExecution=this._onDidRequestEndExecution.event,this._onDidRequestNewExecution=this._register(new L),this.onDidRequestNewExecution=this._onDidRequestNewExecution.event;const i=this;this.value={get cwd(){return i._cwd},get env(){if(i._env)return Object.freeze({isTrusted:i._env.isTrusted,value:Object.freeze({...i._env.value})})},executeCommand(r,s){let o=r;if(s)for(const c of s)!c.match(/["'`]/)&&c.match(/\s/)?o+=` "${c}"`:o+=` ${c}`;i._onDidRequestShellExecution.fire(o);const a={value:o,confidence:Lh.High,isTrusted:!0};return i.requestNewShellExecution(a,i._cwd).value}}}requestNewShellExecution(e,t){const i=new OD(e,t??this._cwd);return zp(e.value).length>1&&(this._currentExecutionProperties={isMultiLine:!0,unresolvedCommandLines:zp(e.value)}),this._pendingExecutions.push(i),this._onDidRequestNewExecution.fire(e.value),i}startShellExecution(e,t){var r;if(this._pendingEndingExecution&&(this._onDidRequestEndExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._pendingEndingExecution.value,exitCode:void 0}),this._pendingEndingExecution=void 0),this._currentExecution){if((r=this._currentExecutionProperties)!=null&&r.isMultiLine&&this._currentExecutionProperties.unresolvedCommandLines){const s=FD(this._currentExecutionProperties.unresolvedCommandLines,e);if(s){this._currentExecutionProperties.unresolvedCommandLines=s.unresolvedCommandLines;return}}this._currentExecution.endExecution(void 0),this._currentExecution.flush(),this._onDidRequestEndExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._currentExecution.value,exitCode:void 0})}let i;if(e.confidence===Lh.High)for(const[s,o]of this._pendingExecutions.entries())if(o.value.commandLine.value===e.value){i=o,this._currentExecutionProperties={isMultiLine:!1,unresolvedCommandLines:void 0},i=o,this._pendingExecutions.splice(s,1);break}else{const a=FD(zp(o.value.commandLine.value),e);if(a){this._currentExecutionProperties={isMultiLine:!0,unresolvedCommandLines:a.unresolvedCommandLines},i=o,this._pendingExecutions.splice(s,1);break}}else i=this._pendingExecutions.shift();i||(i=new OD(e,t??this._cwd)),this._currentExecution=i,this._onDidStartTerminalShellExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._currentExecution.value})}emitData(e){var t;(t=this.currentExecution)==null||t.emitData(e)}endShellExecution(e,t){var i,r;if(!((i=this._currentExecutionProperties)!=null&&i.isMultiLine&&this._currentExecutionProperties.unresolvedCommandLines&&this._currentExecutionProperties.unresolvedCommandLines.length>0)&&this._currentExecution){const s=(r=this._currentExecutionProperties)!=null&&r.isMultiLine?this._currentExecution.value.commandLine:e;this._currentExecution.endExecution(s);const o=this._currentExecution;this._pendingEndingExecution=o,this._currentExecution=void 0,o.flush().then(()=>{this._pendingEndingExecution===o&&(this._onDidRequestEndExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:o.value,exitCode:t}),this._pendingEndingExecution=void 0)})}}setEnv(e,t,i){const r={};for(let s=0;s<e.length;s++)r[e[s]]=t[s];this._env={value:r,isTrusted:i},this._fireChangeEvent()}setCwd(e){let t=!1;y.isUri(this._cwd)?t=!y.isUri(e)||this._cwd.toString()!==e.toString():this._cwd!==e&&(t=!0),t&&(this._cwd=e,this._fireChangeEvent())}_fireChangeEvent(){this._onDidRequestChangeShellIntegration.fire({terminal:this._terminal,shellIntegration:this.value})}}class OD{constructor(e,t){this._commandLine=e,this.cwd=t,this._isEnded=!1;const i=this;this.value={get commandLine(){return i._commandLine},get cwd(){return i.cwd},read(){return i._createDataStream()}}}_createDataStream(){if(!this._dataStream){if(this._isEnded)return pl.EMPTY;this._dataStream=new fN}return this._dataStream.createIterable()}emitData(e){var t;this._isEnded||(t=this._dataStream)==null||t.emitData(e)}endExecution(e){var t;e&&(this._commandLine=e),(t=this._dataStream)==null||t.endExecution(),this._isEnded=!0}async flush(){this._dataStream&&(await this._dataStream.flush(),this._dataStream.dispose(),this._dataStream=void 0)}}class fN extends Te{constructor(){super(...arguments),this._iterables=[],this._emitters=[]}createIterable(){this._barrier||(this._barrier=new Nr);const e=this._barrier,t=new pl(async i=>{this._emitters.push(i),await e.wait()});return this._iterables.push(t),t}emitData(e){for(const t of this._emitters)t.emitOne(e)}endExecution(){var e;(e=this._barrier)==null||e.open()}async flush(){await Promise.all(this._iterables.map(e=>e.toPromise()))}}function zp(n){return n.split(`
`).map(e=>e.trim()).filter(e=>e.length>0)}function FD(n,e){if(n.length===0)return!1;const t=[...n],i=zp(e.value);if(t&&t.length>0){for(;t.length>0&&t[0]===i[0];)t.shift(),i.shift();if(i.length===0)return{unresolvedCommandLines:t}}return!1}class pN{constructor(e,t,i){this.id=e,this.dependencies=t,this.callback=i}}var Zo;(function(n){n[n.Uninitialized=1]="Uninitialized",n[n.InitializedInternal=2]="InitializedInternal",n[n.InitializedExternal=3]="InitializedExternal"})(Zo||(Zo={}));const $1=class $1{constructor(){this._isWebWorker=typeof self=="object"&&self.constructor&&self.constructor.name==="DedicatedWorkerGlobalScope",this._isRenderer=typeof document=="object",this._defineCalls=[],this._state=Zo.Uninitialized}_initialize(){var e,t;if(this._state===Zo.Uninitialized){if(globalThis.define){this._state=Zo.InitializedExternal;return}}else return;this._state=Zo.InitializedInternal,globalThis.define=(i,r,s)=>{typeof i!="string"&&(s=r,r=i,i=null),(typeof r!="object"||!Array.isArray(r))&&(s=r,r=null),this._defineCalls.push(new pN(i,r,s))},globalThis.define.amd=!0,this._isRenderer?this._amdPolicy=globalThis._VSCODE_WEB_PACKAGE_TTP??((e=window.trustedTypes)==null?void 0:e.createPolicy("amdLoader",{createScriptURL(i){if(i.startsWith(window.location.origin)||i.startsWith(`${oe.vscodeFileResource}://${MI}`))return i;throw new Error(`[trusted_script_src] Invalid script url: ${i}`)}})):this._isWebWorker&&(this._amdPolicy=globalThis._VSCODE_WEB_PACKAGE_TTP??((t=globalThis.trustedTypes)==null?void 0:t.createPolicy("amdLoader",{createScriptURL(i){return i}})))}async load(e){if(this._initialize(),this._state===Zo.InitializedExternal)return new Promise(o=>{const a=Mn();globalThis.define(a,[e],function(l){o(l)})});const t=await(this._isWebWorker?this._workerLoadScript(e):this._isRenderer?this._rendererLoadScript(e):this._nodeJSLoadScript(e));if(!t){console.warn(`Did not receive a define call from script ${e}`);return}const i={},r=[],s=[];if(Array.isArray(t.dependencies))for(const o of t.dependencies)o==="exports"?r.push(i):s.push(o);if(s.length>0)throw new Error(`Cannot resolve dependencies for script ${e}. The dependencies are: ${s.join(", ")}`);return typeof t.callback=="function"?t.callback(...r)??i:t.callback}_rendererLoadScript(e){return new Promise((t,i)=>{const r=document.createElement("script");r.setAttribute("async","async"),r.setAttribute("type","text/javascript");const s=()=>{r.removeEventListener("load",o),r.removeEventListener("error",a)},o=l=>{s(),t(this._defineCalls.pop())},a=l=>{s(),i(l)};r.addEventListener("load",o),r.addEventListener("error",a),this._amdPolicy&&(e=this._amdPolicy.createScriptURL(e)),r.setAttribute("src",e),window.document.getElementsByTagName("head")[0].appendChild(r)})}async _workerLoadScript(e){return this._amdPolicy&&(e=this._amdPolicy.createScriptURL(e)),await import(e).then(t=>t.default??t),this._defineCalls.pop()}async _nodeJSLoadScript(e){try{const t=(await import("fs").then(u=>u.default??u)).default,i=(await import("vm").then(u=>u.default??u)).default,r=(await import("module").then(u=>u.default??u)).default,s=y.parse(e).fsPath,o=t.readFileSync(s).toString(),a=r.wrap(o.replace(/^#!.*/,""));return new i.Script(a).runInThisContext().apply(),this._defineCalls.pop()}catch(t){throw t}}};$1.INSTANCE=new $1;let cy=$1;const vv=new Map;async function gN(n,e,t){var o,a,l,c;t===void 0&&(t=!!((c=globalThis._VSCODE_PRODUCT_JSON??((l=(a=(o=globalThis.vscode)==null?void 0:o.context)==null?void 0:a.configuration())==null?void 0:l.product))!=null&&c.commit));const i=`${n}/${e}`;if(vv.has(i))return vv.get(i);let r;if(/^\w[\w\d+.-]*:\/\//.test(i))r=i;else{const d=`${D9}/${i}`;r=k9.asBrowserUri(d).toString(!0)}const s=cy.INSTANCE.load(r);return vv.set(i,s),s}var Kd;(function(n){n[n.STORAGE_DOES_NOT_EXIST=0]="STORAGE_DOES_NOT_EXIST",n[n.STORAGE_IN_MEMORY=1]="STORAGE_IN_MEMORY"})(Kd||(Kd={}));var Xi;(function(n){n[n.None=0]="None",n[n.Initialized=1]="Initialized",n[n.Closed=2]="Closed"})(Xi||(Xi={}));const U1=class U1 extends Te{constructor(e,t=Object.create(null)){super(),this.database=e,this.options=t,this._onDidChangeStorage=this._register(new Kp),this.onDidChangeStorage=this._onDidChangeStorage.event,this.state=Xi.None,this.cache=new Map,this.flushDelayer=this._register(new H9(U1.DEFAULT_FLUSH_DELAY)),this.pendingDeletes=new Set,this.pendingInserts=new Map,this.pendingClose=void 0,this.whenFlushedCallbacks=[],this.registerListeners()}registerListeners(){this._register(this.database.onDidChangeItemsExternal(e=>this.onDidChangeItemsExternal(e)))}onDidChangeItemsExternal(e){var t,i;this._onDidChangeStorage.pause();try{(t=e.changed)==null||t.forEach((r,s)=>this.acceptExternal(s,r)),(i=e.deleted)==null||i.forEach(r=>this.acceptExternal(r,void 0))}finally{this._onDidChangeStorage.resume()}}acceptExternal(e,t){if(this.state===Xi.Closed)return;let i=!1;Yt(t)?i=this.cache.delete(e):this.cache.get(e)!==t&&(this.cache.set(e,t),i=!0),i&&this._onDidChangeStorage.fire({key:e,external:!0})}get items(){return this.cache}get size(){return this.cache.size}async init(){this.state===Xi.None&&(this.state=Xi.Initialized,this.options.hint!==Kd.STORAGE_DOES_NOT_EXIST&&(this.cache=await this.database.getItems()))}get(e,t){const i=this.cache.get(e);return Yt(i)?t:i}getBoolean(e,t){const i=this.get(e);return Yt(i)?t:i==="true"}getNumber(e,t){const i=this.get(e);return Yt(i)?t:parseInt(i,10)}getObject(e,t){const i=this.get(e);return Yt(i)?t:mC(i)}async set(e,t,i=!1){if(this.state===Xi.Closed)return;if(Yt(t))return this.delete(e,i);const r=Zt(t)||Array.isArray(t)?p8(t):String(t);if(this.cache.get(e)!==r)return this.cache.set(e,r),this.pendingInserts.set(e,r),this.pendingDeletes.delete(e),this._onDidChangeStorage.fire({key:e,external:i}),this.doFlush()}async delete(e,t=!1){if(!(this.state===Xi.Closed||!this.cache.delete(e)))return this.pendingDeletes.has(e)||this.pendingDeletes.add(e),this.pendingInserts.delete(e),this._onDidChangeStorage.fire({key:e,external:t}),this.doFlush()}async optimize(){if(this.state!==Xi.Closed)return await this.flush(0),this.database.optimize()}async close(){return this.pendingClose||(this.pendingClose=this.doClose()),this.pendingClose}async doClose(){this.state=Xi.Closed;try{await this.doFlush(0)}catch{}await this.database.close(()=>this.cache)}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}async flushPending(){if(!this.hasPending)return;const e={insert:this.pendingInserts,delete:this.pendingDeletes};return this.pendingDeletes=new Set,this.pendingInserts=new Map,this.database.updateItems(e).finally(()=>{var t;if(!this.hasPending)for(;this.whenFlushedCallbacks.length;)(t=this.whenFlushedCallbacks.pop())==null||t()})}async flush(e){if(!(this.state===Xi.Closed||this.pendingClose))return this.doFlush(e)}async doFlush(e){return this.options.hint===Kd.STORAGE_IN_MEMORY?this.flushPending():this.flushDelayer.trigger(()=>this.flushPending(),e)}async whenFlushed(){if(this.hasPending)return new Promise(e=>this.whenFlushedCallbacks.push(e))}isInMemory(){return this.options.hint===Kd.STORAGE_IN_MEMORY}};U1.DEFAULT_FLUSH_DELAY=100;let MD=U1;const mN=De("environmentService");var $D;(function(n){n.Settings="settings",n.Keybindings="keybindings",n.Snippets="snippets",n.Prompts="prompts",n.Tasks="tasks",n.Extensions="extensions",n.GlobalState="globalState"})($D||($D={}));function _N(n){const e=n;return!!(e&&typeof e=="object"&&typeof e.id=="string"&&typeof e.isDefault=="boolean"&&typeof e.name=="string"&&y.isUri(e.location)&&y.isUri(e.globalStorageHome)&&y.isUri(e.settingsResource)&&y.isUri(e.keybindingsResource)&&y.isUri(e.tasksResource)&&y.isUri(e.snippetsHome)&&y.isUri(e.promptsHome)&&y.isUri(e.extensionsResource))}function hp(n,e,t,i,r,s){var o,a,l,c,u,d,f;return{id:n,name:e,location:t,isDefault:!1,icon:r==null?void 0:r.icon,globalStorageHome:s&&((o=r==null?void 0:r.useDefaultFlags)!=null&&o.globalState)?s.globalStorageHome:An(t,"globalStorage"),settingsResource:s&&((a=r==null?void 0:r.useDefaultFlags)!=null&&a.settings)?s.settingsResource:An(t,"settings.json"),keybindingsResource:s&&((l=r==null?void 0:r.useDefaultFlags)!=null&&l.keybindings)?s.keybindingsResource:An(t,"keybindings.json"),tasksResource:s&&((c=r==null?void 0:r.useDefaultFlags)!=null&&c.tasks)?s.tasksResource:An(t,"tasks.json"),snippetsHome:s&&((u=r==null?void 0:r.useDefaultFlags)!=null&&u.snippets)?s.snippetsHome:An(t,"snippets"),promptsHome:s&&((d=r==null?void 0:r.useDefaultFlags)!=null&&d.prompts)?s.promptsHome:An(t,"prompts"),extensionsResource:s&&((f=r==null?void 0:r.useDefaultFlags)!=null&&f.extensions)?s.extensionsResource:An(t,"extensions.json"),cacheHome:An(i,n),useDefaultFlags:r==null?void 0:r.useDefaultFlags,isTransient:r==null?void 0:r.transient,workspaces:r==null?void 0:r.workspaces}}var ll;let UD=(ll=class extends Te{get defaultProfile(){return this.profiles[0]}get profiles(){return[...this.profilesObject.profiles,...this.transientProfilesObject.profiles]}constructor(e,t,i,r){super(),this.environmentService=e,this.fileService=t,this.uriIdentityService=i,this.logService=r,this._onDidChangeProfiles=this._register(new L),this.onDidChangeProfiles=this._onDidChangeProfiles.event,this._onWillCreateProfile=this._register(new L),this.onWillCreateProfile=this._onWillCreateProfile.event,this._onWillRemoveProfile=this._register(new L),this.onWillRemoveProfile=this._onWillRemoveProfile.event,this._onDidResetWorkspaces=this._register(new L),this.onDidResetWorkspaces=this._onDidResetWorkspaces.event,this.profileCreationPromises=new Map,this.transientProfilesObject={profiles:[],emptyWindows:new Map},this.profilesHome=An(this.environmentService.userRoamingDataHome,"profiles"),this.profilesCacheHome=An(this.environmentService.cacheHome,"CachedProfilesData")}init(){this._profilesObject=void 0}get profilesObject(){if(!this._profilesObject){const e=this.createDefaultProfile(),t=[e];try{for(const r of this.getStoredProfiles()){if(!r.name||!Ze(r.name)||!r.location){this.logService.warn("Skipping the invalid stored profile",r.location||r.name);continue}t.push(hp(Lo(r.location),r.name,r.location,this.profilesCacheHome,{icon:r.icon,useDefaultFlags:r.useDefaultFlags},e))}}catch(r){this.logService.error(r)}const i=new Map;if(t.length)try{const r=this.getStoredProfileAssociations();if(r.workspaces)for(const[s,o]of Object.entries(r.workspaces)){const a=y.parse(s),l=t.find(c=>c.id===o);if(l){const c=l.workspaces?l.workspaces.slice(0):[];c.push(a),l.workspaces=c}}if(r.emptyWindows)for(const[s,o]of Object.entries(r.emptyWindows)){const a=t.find(l=>l.id===o);a&&i.set(s,a)}}catch(r){this.logService.error(r)}this._profilesObject={profiles:t,emptyWindows:i}}return this._profilesObject}createDefaultProfile(){const e=hp("__default__profile__",h(2344,"Default"),this.environmentService.userRoamingDataHome,this.profilesCacheHome);return{...e,extensionsResource:this.getDefaultProfileExtensionsLocation()??e.extensionsResource,isDefault:!0}}async createTransientProfile(e){const t="Temp",i=new RegExp(`${hl(t)}\\s(\\d+)`);let r=0;for(const o of this.profiles){const a=i.exec(o.name),l=a?parseInt(a[1]):0;r=l>r?l:r}const s=`${t} ${r+1}`;return this.createProfile(_f(Mn()).toString(16),s,{transient:!0},e)}async createNamedProfile(e,t,i){return this.createProfile(_f(Mn()).toString(16),e,t,i)}async createProfile(e,t,i,r){return await this.doCreateProfile(e,t,i,r)}async doCreateProfile(e,t,i,r){if(!Ze(t)||!t)throw new Error("Name of the profile is mandatory and must be of type `string`");let s=this.profileCreationPromises.get(t);return s||(s=(async()=>{try{if(this.profiles.find(u=>u.id===e||!u.isTransient&&!(i!=null&&i.transient)&&u.name===t))throw new Error(`Profile with ${t} name already exists`);const a=r?this.getWorkspace(r):void 0;y.isUri(a)&&(i={...i,workspaces:[a]});const l=hp(e,t,An(this.profilesHome,e),this.profilesCacheHome,i,this.defaultProfile);await this.fileService.createFolder(l.location);const c=[];return this._onWillCreateProfile.fire({profile:l,join(u){c.push(u)}}),await fu.settled(c),a&&!y.isUri(a)&&this.updateEmptyWindowAssociation(a,l,!!l.isTransient),this.updateProfiles([l],[],[]),l}finally{this.profileCreationPromises.delete(t)}})(),this.profileCreationPromises.set(t,s)),s}async updateProfile(e,t){var s,o;const i=[];for(const a of this.profiles){let l;if(e.id===a.id)a.isDefault?t.workspaces&&(l=a,l.workspaces=t.workspaces):l=hp(a.id,t.name??a.name,a.location,this.profilesCacheHome,{icon:t.icon===null?void 0:t.icon??a.icon,transient:t.transient??a.isTransient,useDefaultFlags:t.useDefaultFlags??a.useDefaultFlags,workspaces:t.workspaces??a.workspaces},this.defaultProfile);else if(t.workspaces){const c=(s=a.workspaces)==null?void 0:s.filter(u=>{var d;return!((d=t.workspaces)!=null&&d.some(f=>this.uriIdentityService.extUri.isEqual(u,f)))});((o=a.workspaces)==null?void 0:o.length)!==(c==null?void 0:c.length)&&(l=a,l.workspaces=c)}l&&i.push(l)}if(!i.length)throw e.isDefault?new Error("Cannot update default profile"):new Error(`Profile '${e.name}' does not exist`);this.updateProfiles([],[],i);const r=this.profiles.find(a=>a.id===e.id);if(!r)throw new Error(`Profile '${e.name}' was not updated`);return r}async removeProfile(e){if(e.isDefault)throw new Error("Cannot remove default profile");const t=this.profiles.find(r=>r.id===e.id);if(!t)throw new Error(`Profile '${e.name}' does not exist`);const i=[];this._onWillRemoveProfile.fire({profile:t,join(r){i.push(r)}});try{await Promise.allSettled(i)}catch(r){this.logService.error(r)}this.updateProfiles([],[t],[]);try{await this.fileService.del(t.cacheHome,{recursive:!0})}catch(r){hT(r)!==Ei.FILE_NOT_FOUND&&this.logService.error(r)}}async setProfileForWorkspace(e,t){const i=this.profiles.find(s=>s.id===t.id);if(!i)throw new Error(`Profile '${t.name}' does not exist`);const r=this.getWorkspace(e);if(y.isUri(r)){const s=i.workspaces?[...i.workspaces]:[];s.some(o=>this.uriIdentityService.extUri.isEqual(o,r))||(s.push(r),await this.updateProfile(i,{workspaces:s}))}else this.updateEmptyWindowAssociation(r,i,!1),this.updateStoredProfiles(this.profiles)}unsetWorkspace(e,t=!1){var r;const i=this.getWorkspace(e);if(y.isUri(i)){const s=this.getProfileForWorkspace(e);s&&this.updateProfile(s,{workspaces:(r=s.workspaces)==null?void 0:r.filter(o=>!this.uriIdentityService.extUri.isEqual(o,i))})}else this.updateEmptyWindowAssociation(i,void 0,t),this.updateStoredProfiles(this.profiles)}async resetWorkspaces(){this.transientProfilesObject.emptyWindows.clear(),this.profilesObject.emptyWindows.clear();for(const e of this.profiles)e.workspaces=void 0;this.updateProfiles([],[],this.profiles),this._onDidResetWorkspaces.fire()}async cleanUp(){if(await this.fileService.exists(this.profilesHome)){const e=await this.fileService.resolve(this.profilesHome);await Promise.all((e.children||[]).filter(t=>t.isDirectory&&this.profiles.every(i=>!this.uriIdentityService.extUri.isEqual(i.location,t.resource))).map(t=>this.fileService.del(t.resource,{recursive:!0})))}}async cleanUpTransientProfiles(){const e=this.transientProfilesObject.profiles.filter(t=>!this.isProfileAssociatedToWorkspace(t));await Promise.allSettled(e.map(t=>this.removeProfile(t)))}getProfileForWorkspace(e){const t=this.getWorkspace(e);return y.isUri(t)?this.profiles.find(i=>{var r;return(r=i.workspaces)==null?void 0:r.some(s=>this.uriIdentityService.extUri.isEqual(s,t))}):this.profilesObject.emptyWindows.get(t)??this.transientProfilesObject.emptyWindows.get(t)}getWorkspace(e){return pT(e)?e.uri:gT(e)?e.configPath:e.id}isProfileAssociatedToWorkspace(e){var t;return!!((t=e.workspaces)!=null&&t.length||[...this.profilesObject.emptyWindows.values()].some(i=>this.uriIdentityService.extUri.isEqual(i.location,e.location))||[...this.transientProfilesObject.emptyWindows.values()].some(i=>this.uriIdentityService.extUri.isEqual(i.location,e.location)))}updateProfiles(e,t,i){var a,l;const r=[...this.profiles,...e],s=this.transientProfilesObject.profiles;this.transientProfilesObject.profiles=[];const o=[];for(let c of r){if(t.some(u=>c.id===u.id)){for(const u of[...this.profilesObject.emptyWindows.keys()])c.id===((a=this.profilesObject.emptyWindows.get(u))==null?void 0:a.id)&&this.profilesObject.emptyWindows.delete(u);continue}if(!c.isDefault){c=i.find(d=>c.id===d.id)??c;const u=s.find(d=>c.id===d.id);if(c.isTransient)this.transientProfilesObject.profiles.push(c);else if(u){for(const[d,f]of this.transientProfilesObject.emptyWindows.entries())if(c.id===f.id){this.transientProfilesObject.emptyWindows.delete(d),this.profilesObject.emptyWindows.set(d,c);break}}}((l=c.workspaces)==null?void 0:l.length)===0&&(c.workspaces=void 0),o.push(c)}this.updateStoredProfiles(o),this.triggerProfilesChanges(e,t,i)}triggerProfilesChanges(e,t,i){this._onDidChangeProfiles.fire({added:e,removed:t,updated:i,all:this.profiles})}updateEmptyWindowAssociation(e,t,i){i=t!=null&&t.isTransient?!0:i,i?t?this.transientProfilesObject.emptyWindows.set(e,t):this.transientProfilesObject.emptyWindows.delete(e):(this.transientProfilesObject.emptyWindows.delete(e),t?this.profilesObject.emptyWindows.set(e,t):this.profilesObject.emptyWindows.delete(e))}updateStoredProfiles(e){const t=[],i={},r={};for(const s of e)if(!s.isTransient&&(s.isDefault||t.push({location:s.location,name:s.name,icon:s.icon,useDefaultFlags:s.useDefaultFlags}),s.workspaces))for(const o of s.workspaces)i[o.toString()]=s.id;for(const[s,o]of this.profilesObject.emptyWindows.entries())r[s.toString()]=o.id;this.saveStoredProfileAssociations({workspaces:i,emptyWindows:r}),this.saveStoredProfiles(t),this._profilesObject=void 0}getStoredProfiles(){return[]}saveStoredProfiles(e){throw new Error("not implemented")}getStoredProfileAssociations(){return{}}saveStoredProfileAssociations(e){throw new Error("not implemented")}getDefaultProfileExtensionsLocation(){}},ll.PROFILES_KEY="userDataProfiles",ll.PROFILE_ASSOCIATIONS_KEY="profileAssociations",ll);UD=V([F(0,mN),F(1,PC),F(2,O5),F(3,ct)],UD);const vN="__$__isNewStorageMarker",qp="__$__targetStorageMarker";var lc;(function(n){n[n.NONE=0]="NONE",n[n.SHUTDOWN=1]="SHUTDOWN"})(lc||(lc={}));var ln;(function(n){n[n.APPLICATION=-1]="APPLICATION",n[n.PROFILE=0]="PROFILE",n[n.WORKSPACE=1]="WORKSPACE"})(ln||(ln={}));var HD;(function(n){n[n.USER=0]="USER",n[n.MACHINE=1]="MACHINE"})(HD||(HD={}));function wN(n){const e=n.get(qp);if(e)try{return JSON.parse(e)}catch{}return Object.create(null)}const H1=class H1 extends Te{constructor(e={flushInterval:H1.DEFAULT_FLUSH_INTERVAL}){super(),this._onDidChangeValue=this._register(new Kp),this._onDidChangeTarget=this._register(new Kp),this.onDidChangeTarget=this._onDidChangeTarget.event,this._onWillSaveState=this._register(new L),this.onWillSaveState=this._onWillSaveState.event,this.runFlushWhenIdle=this._register(new go),this._workspaceKeyTargets=void 0,this._profileKeyTargets=void 0,this._applicationKeyTargets=void 0,this.flushWhenIdleScheduler=this._register(new Gu(()=>this.doFlushWhenIdle(),e.flushInterval))}onDidChangeValue(e,t,i){return Ht.filter(this._onDidChangeValue.event,r=>r.scope===e&&(t===void 0||r.key===t),i)}doFlushWhenIdle(){this.runFlushWhenIdle.value=HI(()=>{this.shouldFlushWhenIdle()&&this.flush(),this.flushWhenIdleScheduler.schedule()})}shouldFlushWhenIdle(){return!0}stopFlushWhenIdle(){Ns([this.runFlushWhenIdle,this.flushWhenIdleScheduler])}initialize(){return this.initializationPromise||(this.initializationPromise=(async()=>{ti("code/willInitStorage");try{await this.doInitialize()}finally{ti("code/didInitStorage")}this.flushWhenIdleScheduler.schedule()})()),this.initializationPromise}emitDidChangeValue(e,t){const{key:i,external:r}=t;if(i===qp){switch(e){case ln.APPLICATION:this._applicationKeyTargets=void 0;break;case ln.PROFILE:this._profileKeyTargets=void 0;break;case ln.WORKSPACE:this._workspaceKeyTargets=void 0;break}this._onDidChangeTarget.fire({scope:e})}else this._onDidChangeValue.fire({scope:e,key:i,target:this.getKeyTargets(e)[i],external:r})}emitWillSaveState(e){this._onWillSaveState.fire({reason:e})}get(e,t,i){var r;return(r=this.getStorage(t))==null?void 0:r.get(e,i)}getBoolean(e,t,i){var r;return(r=this.getStorage(t))==null?void 0:r.getBoolean(e,i)}getNumber(e,t,i){var r;return(r=this.getStorage(t))==null?void 0:r.getNumber(e,i)}getObject(e,t,i){var r;return(r=this.getStorage(t))==null?void 0:r.getObject(e,i)}storeAll(e,t){this.withPausedEmitters(()=>{for(const i of e)this.store(i.key,i.value,i.scope,i.target,t)})}store(e,t,i,r,s=!1){if(Yt(t)){this.remove(e,i,s);return}this.withPausedEmitters(()=>{var o;this.updateKeyTarget(e,i,r),(o=this.getStorage(i))==null||o.set(e,t,s)})}remove(e,t,i=!1){this.withPausedEmitters(()=>{var r;this.updateKeyTarget(e,t,void 0),(r=this.getStorage(t))==null||r.delete(e,i)})}withPausedEmitters(e){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{e()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}keys(e,t){const i=[],r=this.getKeyTargets(e);for(const s of Object.keys(r))r[s]===t&&i.push(s);return i}updateKeyTarget(e,t,i,r=!1){var o,a;const s=this.getKeyTargets(t);typeof i=="number"?s[e]!==i&&(s[e]=i,(o=this.getStorage(t))==null||o.set(qp,JSON.stringify(s),r)):typeof s[e]=="number"&&(delete s[e],(a=this.getStorage(t))==null||a.set(qp,JSON.stringify(s),r))}get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(ln.WORKSPACE)),this._workspaceKeyTargets}get profileKeyTargets(){return this._profileKeyTargets||(this._profileKeyTargets=this.loadKeyTargets(ln.PROFILE)),this._profileKeyTargets}get applicationKeyTargets(){return this._applicationKeyTargets||(this._applicationKeyTargets=this.loadKeyTargets(ln.APPLICATION)),this._applicationKeyTargets}getKeyTargets(e){switch(e){case ln.APPLICATION:return this.applicationKeyTargets;case ln.PROFILE:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(e){const t=this.getStorage(e);return t?wN(t):Object.create(null)}isNew(e){return this.getBoolean(vN,e)===!0}async flush(e=lc.NONE){this._onWillSaveState.fire({reason:e});const t=this.getStorage(ln.APPLICATION),i=this.getStorage(ln.PROFILE),r=this.getStorage(ln.WORKSPACE);switch(e){case lc.NONE:await fu.settled([(t==null?void 0:t.whenFlushed())??Promise.resolve(),(i==null?void 0:i.whenFlushed())??Promise.resolve(),(r==null?void 0:r.whenFlushed())??Promise.resolve()]);break;case lc.SHUTDOWN:await fu.settled([(t==null?void 0:t.flush(0))??Promise.resolve(),(i==null?void 0:i.flush(0))??Promise.resolve(),(r==null?void 0:r.flush(0))??Promise.resolve()]);break}}async log(){var r,s,o;const e=((r=this.getStorage(ln.APPLICATION))==null?void 0:r.items)??new Map,t=((s=this.getStorage(ln.PROFILE))==null?void 0:s.items)??new Map,i=((o=this.getStorage(ln.WORKSPACE))==null?void 0:o.items)??new Map;return bN(e,t,i,this.getLogDetails(ln.APPLICATION)??"",this.getLogDetails(ln.PROFILE)??"",this.getLogDetails(ln.WORKSPACE)??"")}async optimize(e){var t;return await this.flush(),(t=this.getStorage(e))==null?void 0:t.optimize()}async switch(e,t){return this.emitWillSaveState(lc.NONE),_N(e)?this.switchToProfile(e,t):this.switchToWorkspace(e,t)}canSwitchProfile(e,t){return!(e.id===t.id||WD(t)&&WD(e))}switchData(e,t,i){this.withPausedEmitters(()=>{const r=new Set;for(const[s,o]of e)r.add(s),t.get(s)!==o&&this.emitDidChangeValue(i,{key:s,external:!0});for(const[s]of t.items)r.has(s)||this.emitDidChangeValue(i,{key:s,external:!0})})}};H1.DEFAULT_FLUSH_INTERVAL=60*1e3;let BD=H1;function WD(n){var e;return n.isDefault||!!((e=n.useDefaultFlags)!=null&&e.globalState)}async function bN(n,e,t,i,r,s){const o=v=>{try{return JSON.parse(v)}catch{return v}},a=new Map,l=new Map;n.forEach((v,m)=>{a.set(m,v),l.set(m,o(v))});const c=new Map,u=new Map;e.forEach((v,m)=>{c.set(m,v),u.set(m,o(v))});const d=new Map,f=new Map;t.forEach((v,m)=>{d.set(m,v),f.set(m,o(v))}),console.group(i!==r?`Storage: Application (path: ${i})`:`Storage: Application & Profile (path: ${i}, default profile)`);const p=[];if(a.forEach((v,m)=>{p.push({key:m,value:v})}),console.table(p),console.groupEnd(),console.log(l),i!==r){console.group(`Storage: Profile (path: ${r}, profile specific)`);const v=[];c.forEach((m,x)=>{v.push({key:x,value:m})}),console.table(v),console.groupEnd(),console.log(u)}console.group(`Storage: Workspace (path: ${s})`);const w=[];d.forEach((v,m)=>{w.push({key:m,value:v})}),console.table(w),console.groupEnd(),console.log(f)}function yN(n,e){return Ke.toKey(n)+"/"+e}var VD;(function(n){n[n.WorkspaceFolder=0]="WorkspaceFolder",n[n.Workspace=100]="Workspace",n[n.User=200]="User",n[n.Extension=300]="Extension",n[n.Filesystem=400]="Filesystem",n[n.RemoteBoost=-50]="RemoteBoost"})(VD||(VD={}));var zD;(function(n){function e(t,i){return t.id===i.id&&t.remoteAuthority===i.remoteAuthority&&t.label===i.label&&t.isTrustedByDefault===i.isTrustedByDefault}n.equals=e})(zD||(zD={}));var qD;(function(n){function e(r){return r}n.toSerialized=e;function t(r){return{id:r.id,label:r.label,launch:g1.fromSerialized(r.launch),variableReplacement:r.variableReplacement?uy.fromSerialized(r.variableReplacement):void 0}}n.fromSerialized=t;function i(r,s){return r.id===s.id&&r.label===s.label&&$r(r.roots,s.roots,(o,a)=>o.toString()===a.toString())&&fi(r.launch,s.launch)&&fi(r.presentation,s.presentation)&&fi(r.variableReplacement,s.variableReplacement)}n.equals=i})(qD||(qD={}));var uy;(function(n){function e(i){return i}n.toSerialized=e;function t(i){return{section:i.section,folder:i.folder?{...i.folder,uri:y.revive(i.folder.uri)}:void 0,target:i.target}}n.fromSerialized=t})(uy||(uy={}));var jD;(function(n){n[n.HasUnknown=0]="HasUnknown",n[n.LoadingUnknown=1]="LoadingUnknown",n[n.AllKnown=2]="AllKnown"})(jD||(jD={}));var GD;(function(n){n[n.Unknown=0]="Unknown",n[n.Cached=1]="Cached",n[n.RefreshingFromUnknown=2]="RefreshingFromUnknown",n[n.RefreshingFromCached=3]="RefreshingFromCached",n[n.Live=4]="Live"})(GD||(GD={}));var il;(function(n){n[n.Stdio=1]="Stdio",n[n.SSE=2]="SSE"})(il||(il={}));var g1;(function(n){function e(i){return i}n.toSerialized=e;function t(i){switch(i.type){case il.SSE:return{type:i.type,uri:y.revive(i.uri),headers:i.headers};case il.Stdio:return{type:i.type,cwd:i.cwd?y.revive(i.cwd):void 0,command:i.command,args:i.args,env:i.env,envFile:i.envFile}}}n.fromSerialized=t})(g1||(g1={}));var ba;(function(n){let e;(function(t){t[t.Stopped=0]="Stopped",t[t.Starting=1]="Starting",t[t.Running=2]="Running",t[t.Error=3]="Error"})(e=n.Kind||(n.Kind={})),n.toString=t=>{switch(t.state){case e.Stopped:return h(7672,"Stopped");case e.Starting:return h(7673,"Starting");case e.Running:return h(7674,"Running");case e.Error:return h(7675,"Error {0}",t.message);default:Mv()}},n.toKindString=t=>{switch(t){case e.Stopped:return"stopped";case e.Starting:return"starting";case e.Running:return"running";case e.Error:return"error";default:Mv()}},n.canBeStarted=t=>t===e.Error||t===e.Stopped,n.isRunning=t=>!n.canBeStarted(t.state)})(ba||(ba={}));const dy=De("IExtHostMpcService");let hy=class extends Te{constructor(e){super(),this._initialProviderPromises=new Set,this._sseEventSources=this._register(new Yp),this._eventSource=new Ci(async()=>(await gN("@c4312/eventsource-umd","dist/index.umd.js")).EventSource),this._proxy=e.getProxy(Z.MainThreadMcp)}$startMcp(e,t){this._startMcp(e,g1.fromSerialized(t))}_startMcp(e,t){if(t.type===il.SSE){this._sseEventSources.set(e,new xN(this._eventSource.value,e,t,this._proxy));return}throw new Error("not implemented")}$stopMcp(e){this._sseEventSources.has(e)&&(this._sseEventSources.deleteAndDispose(e),this._proxy.$onDidChangeState(e,{state:ba.Kind.Stopped}))}$sendMessage(e,t){var i;(i=this._sseEventSources.get(e))==null||i.send(t)}async $waitForInitialCollectionProviders(){await Promise.all(this._initialProviderPromises)}registerMcpConfigurationProvider(e,t,i){var c,u;const r=new Ie,s=(u=(c=e.contributes)==null?void 0:c.modelContextServerCollections)==null?void 0:u.find(d=>d.id===t);if(!s)throw new Error(`MCP configuration providers must be registered in the contributes.modelContextServerCollections array within your package.json, but "${t}" was not`);const o={id:yN(e.identifier,t),isTrustedByDefault:!0,label:(s==null?void 0:s.label)??e.displayName??e.name,scope:ln.WORKSPACE},a=async()=>{const d=await i.provideMcpServerDefinitions(Pt.None);function f(w){return!!w.uri}const p=[];for(const w of d??[])p.push({id:Ke.toKey(e.identifier),label:w.label,launch:f(w)?{type:il.SSE,uri:w.uri,headers:w.headers}:{type:il.Stdio,cwd:w.cwd,args:w.args,command:w.command,env:w.env,envFile:void 0}});this._proxy.$upsertMcpCollection(o,p)};r.add(Se(()=>{this._proxy.$deleteMcpCollection(o.id)})),i.onDidChange&&r.add(i.onDidChange(a));const l=new Promise(d=>{setTimeout(()=>a().finally(()=>{this._initialProviderPromises.delete(l),d()}),0)});return this._initialProviderPromises.add(l),r}};hy=V([F(0,tt)],hy);class xN extends Te{constructor(e,t,i,r){super(),this._id=t,this._proxy=r,this._requestSequencer=new F9,this._postEndpoint=new Sl,e.then(s=>this._attach(s,i))}_attach(e,t){if(this._store.isDisposed)return;const i=new e(t.uri.toString(),{fetch:(r,s)=>fetch(r,{...s,headers:{...Object.fromEntries(t.headers),...s==null?void 0:s.headers}}).then(async o=>(o.status>=300&&(this._proxy.$onDidChangeState(this._id,{state:ba.Kind.Error,message:`${o.status} status connecting to ${t.uri}: ${await this._getErrText(o)}`}),i.close()),o),o=>(this._proxy.$onDidChangeState(this._id,{state:ba.Kind.Error,message:`Error connecting to ${t.uri}: ${String(o)}`}),i.close(),Promise.reject(o)))});this._register(Se(()=>i.close())),i.addEventListener("endpoint",r=>{this._postEndpoint.complete(new URL(r.data,t.uri.toString()).toString())}),i.addEventListener("message",r=>{this._proxy.$onDidReceiveMessage(this._id,r.data)}),i.addEventListener("open",()=>{this._proxy.$onDidChangeState(this._id,{state:ba.Kind.Running})}),i.addEventListener("error",r=>{this._postEndpoint.cancel(),this._proxy.$onDidChangeState(this._id,{state:ba.Kind.Error,message:`Error connecting to ${t.uri}: ${r.code||0} ${r.message||JSON.stringify(r)}`}),i.close()})}async send(e){try{const t=await this._requestSequencer.queue(async()=>{const i=await this._postEndpoint.p,r=new TextEncoder().encode(e);return fetch(i,{method:"POST",headers:{"Content-Type":"application/json","Content-Length":String(r.length)},body:r})});t.status>=300&&this._proxy.$onDidPublishLog(this._id,Xe.Warning,`${t.status} status sending message to ${this._postEndpoint}: ${await this._getErrText(t)}`)}catch{}}async _getErrText(e){try{return await e.text()}catch{return e.statusText}}}bt(n2,R0,gt.Delayed);bt(Qu,o1,gt.Delayed);bt(C_,W0,gt.Delayed);bt(Ll,I0,gt.Eager);bt(Zx,T0,gt.Eager);bt(Kx,A0,gt.Eager);bt(Bs,m0,gt.Eager);bt(S_,w0,gt.Eager);bt(P_,K0,gt.Eager);bt(X5,ny,gt.Eager);bt(q5,$0,gt.Eager);bt(ed,B0,gt.Eager);bt(i2,L0,gt.Eager);bt(Ju,vT,gt.Eager);bt(z5,M0,gt.Delayed);bt(K5,sy,gt.Eager);bt(Qx,I5,gt.Eager);bt(j5,X0,gt.Eager);bt(Ku,P0,gt.Eager);bt(t7,ly,gt.Eager);bt(Xx,S0,gt.Eager);bt(e7,ay,gt.Eager);bt(Hs,h0,gt.Eager);bt(t2,M5,gt.Eager);bt(Kf,Y0,gt.Eager);bt(a2,ey,gt.Eager);bt(dy,hy,gt.Eager);function n7(n,e,t,i,r,s){if(Array.isArray(n)){let o=0;for(const a of n){const l=n7(a,e,t,i,r,s);if(l===10)return l;l>o&&(o=l)}return o}else{if(typeof n=="string")return n==="*"?5:n===t?10:0;if(n){const{language:o,pattern:a,scheme:l,hasAccessToAllModels:c,notebookType:u}=n;u&&r&&(e=r);let d=0;if(l)if(l===e.scheme)d=10;else if(l==="*")d=5;else return 0;if(o)if(o===t)d=10;else if(o==="*")d=Math.max(d,5);else return 0;if(u)if(u===s)d=10;else if(u==="*"&&s!==void 0)d=Math.max(d,5);else return 0;if(a){let f;if(typeof a=="string"?f=a:f={...a,base:hu(a.base)},f===e.fsPath||zd(f,e.fsPath))d=10;else return 0}return d}else return 0}}function i7(n){return typeof n=="string"?!1:Array.isArray(n)?n.some(i7):!!n.notebookType}var fy;(function(n){n[n.None=0]="None",n[n.Indent=1]="Indent",n[n.IndentOutdent=2]="IndentOutdent",n[n.Outdent=3]="Outdent"})(fy||(fy={}));var py;(function(n){n[n.Complete=100]="Complete",n[n.Partial=50]="Partial",n[n.None=0]="None"})(py||(py={}));class EN{constructor(e){this._relatedInformationProviders=new Map,this._nextHandle=0,this._proxy=e.getProxy(Z.MainThreadAiRelatedInformation)}async $provideAiRelatedInformation(e,t,i){if(this._relatedInformationProviders.size===0)throw new Error("No related information providers registered");const r=this._relatedInformationProviders.get(e);if(!r)throw new Error("related information provider not found");return await r.provideRelatedInformation(t,i)??[]}getRelatedInformation(e,t,i){return this._proxy.$getAiRelatedInformation(t,i)}registerRelatedInformationProvider(e,t,i){const r=this._nextHandle;return this._nextHandle++,this._relatedInformationProviders.set(r,i),this._proxy.$registerAiRelatedInformationProvider(r,t),new je(()=>{this._proxy.$unregisterAiRelatedInformationProvider(r),this._relatedInformationProviders.delete(r)})}}var xf;(function(n){n[n.Full=1]="Full",n[n.Delta=2]="Delta"})(xf||(xf={}));function r7(n){for(let e=0,t=n.length;e<t;e+=4){const i=n[e+0],r=n[e+1],s=n[e+2],o=n[e+3];n[e+0]=o,n[e+1]=s,n[e+2]=r,n[e+3]=i}}function SN(n){const e=new Uint8Array(n.buffer,n.byteOffset,n.length*4);return yI()||r7(e),Pe.wrap(e)}function DN(n){const e=n.buffer;if(yI()||r7(e),e.byteOffset%4===0)return new Uint32Array(e.buffer,e.byteOffset,e.length/4);{const t=new Uint8Array(e.byteLength);return t.set(e),new Uint32Array(t.buffer,t.byteOffset,t.length/4)}}function gy(n){const e=new Uint32Array(kN(n));let t=0;if(e[t++]=n.id,n.type==="full")e[t++]=xf.Full,e[t++]=n.data.length,e.set(n.data,t),t+=n.data.length;else{e[t++]=xf.Delta,e[t++]=n.deltas.length;for(const i of n.deltas)e[t++]=i.start,e[t++]=i.deleteCount,i.data?(e[t++]=i.data.length,e.set(i.data,t),t+=i.data.length):e[t++]=0}return SN(e)}function kN(n){let e=0;if(e+=2,n.type==="full")e+=1+n.data.length;else{e+=1,e+=3*n.deltas.length;for(const t of n.deltas)t.data&&(e+=t.data.length)}return e}function QD(n){const e=DN(n);let t=0;const i=e[t++];if(e[t++]===xf.Full){const a=e[t++],l=e.subarray(t,t+a);return t+=a,{id:i,type:"full",data:l}}const s=e[t++],o=[];for(let a=0;a<s;a++){const l=e[t++],c=e[t++],u=e[t++];let d;u>0&&(d=e.subarray(t,t+u),t+=u),o[a]={start:l,deleteCount:c,data:d}}return{id:i,type:"delta",deltas:o}}const IN=[new ke("vscode.executeDocumentHighlights","_executeDocumentHighlights","Execute document highlight provider.",[q.Uri,q.Position],new be("A promise that resolves to an array of DocumentHighlight-instances.",zi(Ru.to))),new ke("vscode.executeDocumentSymbolProvider","_executeDocumentSymbolProvider","Execute document symbol provider.",[q.Uri],new be("A promise that resolves to an array of SymbolInformation and DocumentSymbol instances.",(n,e)=>{if(ox(n))return;class t extends Dh{static to(r){const s=new t(r.name,Wi.to(r.kind),r.containerName||"",new Ti(e[0],W.to(r.range)));return s.detail=r.detail,s.range=s.location.range,s.selectionRange=W.to(r.selectionRange),s.children=r.children?r.children.map(t.to):[],s}}return n.map(t.to)})),new ke("vscode.executeFormatDocumentProvider","_executeFormatDocumentProvider","Execute document format provider.",[q.Uri,new q("options","Formatting options",n=>!0,n=>n)],new be("A promise that resolves to an array of TextEdits.",zi(rn.to))),new ke("vscode.executeFormatRangeProvider","_executeFormatRangeProvider","Execute range format provider.",[q.Uri,q.Range,new q("options","Formatting options",n=>!0,n=>n)],new be("A promise that resolves to an array of TextEdits.",zi(rn.to))),new ke("vscode.executeFormatOnTypeProvider","_executeFormatOnTypeProvider","Execute format on type provider.",[q.Uri,q.Position,new q("ch","Trigger character",n=>typeof n=="string",n=>n),new q("options","Formatting options",n=>!0,n=>n)],new be("A promise that resolves to an array of TextEdits.",zi(rn.to))),new ke("vscode.executeDefinitionProvider","_executeDefinitionProvider","Execute all definition providers.",[q.Uri,q.Position],new be("A promise that resolves to an array of Location or LocationLink instances.",Qs)),new ke("vscode.experimental.executeDefinitionProvider_recursive","_executeDefinitionProvider_recursive","Execute all definition providers.",[q.Uri,q.Position],new be("A promise that resolves to an array of Location or LocationLink instances.",Qs)),new ke("vscode.executeTypeDefinitionProvider","_executeTypeDefinitionProvider","Execute all type definition providers.",[q.Uri,q.Position],new be("A promise that resolves to an array of Location or LocationLink instances.",Qs)),new ke("vscode.experimental.executeTypeDefinitionProvider_recursive","_executeTypeDefinitionProvider_recursive","Execute all type definition providers.",[q.Uri,q.Position],new be("A promise that resolves to an array of Location or LocationLink instances.",Qs)),new ke("vscode.executeDeclarationProvider","_executeDeclarationProvider","Execute all declaration providers.",[q.Uri,q.Position],new be("A promise that resolves to an array of Location or LocationLink instances.",Qs)),new ke("vscode.experimental.executeDeclarationProvider_recursive","_executeDeclarationProvider_recursive","Execute all declaration providers.",[q.Uri,q.Position],new be("A promise that resolves to an array of Location or LocationLink instances.",Qs)),new ke("vscode.executeImplementationProvider","_executeImplementationProvider","Execute all implementation providers.",[q.Uri,q.Position],new be("A promise that resolves to an array of Location or LocationLink instances.",Qs)),new ke("vscode.experimental.executeImplementationProvider_recursive","_executeImplementationProvider_recursive","Execute all implementation providers.",[q.Uri,q.Position],new be("A promise that resolves to an array of Location or LocationLink instances.",Qs)),new ke("vscode.executeReferenceProvider","_executeReferenceProvider","Execute all reference providers.",[q.Uri,q.Position],new be("A promise that resolves to an array of Location-instances.",zi(ii.to))),new ke("vscode.experimental.executeReferenceProvider","_executeReferenceProvider_recursive","Execute all reference providers.",[q.Uri,q.Position],new be("A promise that resolves to an array of Location-instances.",zi(ii.to))),new ke("vscode.executeHoverProvider","_executeHoverProvider","Execute all hover providers.",[q.Uri,q.Position],new be("A promise that resolves to an array of Hover-instances.",zi(rf.to))),new ke("vscode.experimental.executeHoverProvider_recursive","_executeHoverProvider_recursive","Execute all hover providers.",[q.Uri,q.Position],new be("A promise that resolves to an array of Hover-instances.",zi(rf.to))),new ke("vscode.executeSelectionRangeProvider","_executeSelectionRangeProvider","Execute selection range provider.",[q.Uri,new q("position","A position in a text document",n=>Array.isArray(n)&&n.every(e=>We.isPosition(e)),n=>n.map(nt.from))],new be("A promise that resolves to an array of ranges.",n=>n.map(e=>{let t;for(const i of e.reverse())t=new Ph(W.to(i),t);return t}))),new ke("vscode.executeWorkspaceSymbolProvider","_executeWorkspaceSymbolProvider","Execute all workspace symbol providers.",[q.String.with("query","Search string")],new be("A promise that resolves to an array of SymbolInformation-instances.",n=>n.map(yl.to))),new ke("vscode.prepareCallHierarchy","_executePrepareCallHierarchy","Prepare call hierarchy at a position inside a document",[q.Uri,q.Position],new be("A promise that resolves to an array of CallHierarchyItem-instances",n=>n.map(xl.to))),new ke("vscode.provideIncomingCalls","_executeProvideIncomingCalls","Compute incoming calls for an item",[q.CallHierarchyItem],new be("A promise that resolves to an array of CallHierarchyIncomingCall-instances",n=>n.map(Nb.to))),new ke("vscode.provideOutgoingCalls","_executeProvideOutgoingCalls","Compute outgoing calls for an item",[q.CallHierarchyItem],new be("A promise that resolves to an array of CallHierarchyOutgoingCall-instances",n=>n.map(Ob.to))),new ke("vscode.prepareRename","_executePrepareRename","Execute the prepareRename of rename provider.",[q.Uri,q.Position],new be("A promise that resolves to a range and placeholder text.",n=>{if(n)return{range:W.to(n.range),placeholder:n.text}})),new ke("vscode.executeDocumentRenameProvider","_executeDocumentRenameProvider","Execute rename provider.",[q.Uri,q.Position,q.String.with("newName","The new symbol name")],new be("A promise that resolves to a WorkspaceEdit.",n=>{if(n){if(n.rejectReason)throw new Error(n.rejectReason);return gi.to(n)}})),new ke("vscode.executeLinkProvider","_executeLinkProvider","Execute document link provider.",[q.Uri,q.Number.with("linkResolveCount","Number of links that should be resolved, only when links are unresolved.").optional()],new be("A promise that resolves to an array of DocumentLink-instances.",n=>n.map(Ya.to))),new ke("vscode.provideDocumentSemanticTokensLegend","_provideDocumentSemanticTokensLegend","Provide semantic tokens legend for a document",[q.Uri],new be("A promise that resolves to SemanticTokensLegend.",n=>{if(n)return new ib(n.tokenTypes,n.tokenModifiers)})),new ke("vscode.provideDocumentSemanticTokens","_provideDocumentSemanticTokens","Provide semantic tokens for a document",[q.Uri],new be("A promise that resolves to SemanticTokens.",n=>{if(!n)return;const e=QD(n);if(e.type==="full")return new ku(e.data,void 0)})),new ke("vscode.provideDocumentRangeSemanticTokensLegend","_provideDocumentRangeSemanticTokensLegend","Provide semantic tokens legend for a document range",[q.Uri,q.Range.optional()],new be("A promise that resolves to SemanticTokensLegend.",n=>{if(n)return new ib(n.tokenTypes,n.tokenModifiers)})),new ke("vscode.provideDocumentRangeSemanticTokens","_provideDocumentRangeSemanticTokens","Provide semantic tokens for a document range",[q.Uri,q.Range],new be("A promise that resolves to SemanticTokens.",n=>{if(!n)return;const e=QD(n);if(e.type==="full")return new ku(e.data,void 0)})),new ke("vscode.executeCompletionItemProvider","_executeCompletionItemProvider","Execute completion item provider.",[q.Uri,q.Position,q.String.with("triggerCharacter","Trigger completion when the user types the character, like `,` or `(`").optional(),q.Number.with("itemResolveCount","Number of completions to resolve (too large numbers slow down completions)").optional()],new be("A promise that resolves to a CompletionList-instance.",(n,e,t)=>{if(!n)return new wu([]);const i=n.suggestions.map(r=>Hb.to(r,t));return new wu(i,n.incomplete)})),new ke("vscode.executeSignatureHelpProvider","_executeSignatureHelpProvider","Execute signature help provider.",[q.Uri,q.Position,q.String.with("triggerCharacter","Trigger signature help when the user types the character, like `,` or `(`").optional()],new be("A promise that resolves to SignatureHelp.",n=>{if(n)return sf.to(n)})),new ke("vscode.executeCodeLensProvider","_executeCodeLensProvider","Execute code lens provider.",[q.Uri,q.Number.with("itemResolveCount","Number of lenses that should be resolved and returned. Will only return resolved lenses, will impact performance)").optional()],new be("A promise that resolves to an array of CodeLens-instances.",(n,e,t)=>zi(i=>new Gg(W.to(i.range),i.command&&t.fromInternal(i.command)))(n))),new ke("vscode.executeCodeActionProvider","_executeCodeActionProvider","Execute code action provider.",[q.Uri,new q("rangeOrSelection","Range in a text document. Some refactoring provider requires Selection object.",n=>Oe.isRange(n),n=>$s.isSelection(n)?pr.from(n):W.from(n)),q.String.with("kind","Code action kind to return code actions for").optional(),q.Number.with("itemResolveCount","Number of code actions to resolve (too large numbers slow down code actions)").optional()],new be("A promise that resolves to an array of Command-instances.",(n,e,t)=>zi(i=>{if(i._isSynthetic){if(!i.command)throw new Error("Synthetic code actions must have a command");return t.fromInternal(i.command)}else{const r=new Ch(i.title,i.kind?new Tt(i.kind):void 0);return i.edit&&(r.edit=gi.to(i.edit)),i.command&&(r.command=t.fromInternal(i.command)),r.isPreferred=i.isPreferred,r}})(n))),new ke("vscode.executeDocumentColorProvider","_executeDocumentColorProvider","Execute document color provider.",[q.Uri],new be("A promise that resolves to an array of ColorInformation objects.",n=>n?n.map(e=>new Kg(W.to(e.range),Lu.to(e.color))):[])),new ke("vscode.executeColorPresentationProvider","_executeColorPresentationProvider","Execute color presentation provider.",[new q("color","The color to show and insert",n=>n instanceof xu,Lu.from),new q("context","Context object with uri and range",n=>!0,n=>({uri:n.uri,range:W.from(n.range)}))],new be("A promise that resolves to an array of ColorPresentation objects.",n=>n?n.map(Om.to):[])),new ke("vscode.executeInlayHintProvider","_executeInlayHintProvider","Execute inlay hints provider",[q.Uri,q.Range],new be("A promise that resolves to an array of Inlay objects",(n,e,t)=>n.map(Bb.to.bind(void 0,t)))),new ke("vscode.executeFoldingRangeProvider","_executeFoldingRangeProvider","Execute folding range provider",[q.Uri],new be("A promise that resolves to an array of FoldingRange objects",(n,e)=>{if(n)return n.map(Mm.to)})),new ke("vscode.resolveNotebookContentProviders","_resolveNotebookContentProvider","Resolve Notebook Content Providers",[],new be("A promise that resolves to an array of NotebookContentProvider static info objects.",zi(n=>({viewType:n.viewType,displayName:n.displayName,options:{transientOutputs:n.options.transientOutputs,transientCellMetadata:n.options.transientCellMetadata,transientDocumentMetadata:n.options.transientDocumentMetadata},filenamePattern:n.filenamePattern.map(e=>Um.to(e))})))),new ke("vscode.executeInlineValueProvider","_executeInlineValueProvider","Execute inline value provider",[q.Uri,q.Range,new q("context","An InlineValueContext",n=>n&&typeof n.frameId=="number"&&n.stoppedLocation instanceof Oe,n=>Pm.from(n))],new be("A promise that resolves to an array of InlineValue objects",n=>n.map(Cm.to))),new ke("vscode.open","_workbench.open","Opens the provided resource in the editor. Can be a text or binary file, or an http(s) URL. If you need more control over the options for opening a text file, use vscode.window.showTextDocument instead.",[new q("uriOrString","Uri-instance or string (only http/https)",n=>y.isUri(n)||typeof n=="string"&&b9(n,oe.http,oe.https),n=>n),new q("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",n=>n===void 0||typeof n=="number"||typeof n=="object",n=>n&&(typeof n=="number"?[nn.from(n),void 0]:[nn.from(n.viewColumn),Jd.from(n)])).optional(),q.String.with("label","").optional()],be.Void),new ke("vscode.openWith","_workbench.openWith","Opens the provided resource with a specific editor.",[q.Uri.with("resource","Resource to open"),q.String.with("viewId","Custom editor view id. This should be the viewType string for custom editors or the notebookType string for notebooks. Use 'default' to use VS Code's default text editor"),new q("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",n=>n===void 0||typeof n=="number"||typeof n=="object",n=>n&&(typeof n=="number"?[nn.from(n),void 0]:[nn.from(n.viewColumn),Jd.from(n)])).optional()],be.Void),new ke("vscode.diff","_workbench.diff","Opens the provided resources in the diff editor to compare their contents.",[q.Uri.with("left","Left-hand side resource of the diff editor"),q.Uri.with("right","Right-hand side resource of the diff editor"),q.String.with("title","Human readable title for the diff editor").optional(),new q("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",n=>n===void 0||typeof n=="object",n=>n&&[nn.from(n.viewColumn),Jd.from(n)]).optional()],be.Void),new ke("vscode.changes","_workbench.changes","Opens a list of resources in the changes editor to compare their contents.",[q.String.with("title","Human readable title for the changes editor"),new q("resourceList","List of resources to compare",n=>{for(const e of n){if(e.length!==3)return!1;const[t,i,r]=e;if(!y.isUri(t)||!y.isUri(i)&&i!==void 0&&i!==null||!y.isUri(r)&&r!==void 0&&r!==null)return!1}return!0},n=>n)],be.Void),new ke("vscode.prepareTypeHierarchy","_executePrepareTypeHierarchy","Prepare type hierarchy at a position inside a document",[q.Uri,q.Position],new be("A promise that resolves to an array of TypeHierarchyItem-instances",n=>n.map(Za.to))),new ke("vscode.provideSupertypes","_executeProvideSupertypes","Compute supertypes for an item",[q.TypeHierarchyItem],new be("A promise that resolves to an array of TypeHierarchyItem-instances",n=>n.map(Za.to))),new ke("vscode.provideSubtypes","_executeProvideSubtypes","Compute subtypes for an item",[q.TypeHierarchyItem],new be("A promise that resolves to an array of TypeHierarchyItem-instances",n=>n.map(Za.to))),new ke("vscode.revealTestInExplorer","_revealTestInExplorer","Reveals a test instance in the explorer",[q.TestItem],be.Void),new ke("vscode.startContinuousTestRun","testing.startContinuousRunFromExtension","Starts running the given tests with continuous run mode.",[q.TestProfile,q.Arr(q.TestItem)],be.Void),new ke("vscode.stopContinuousTestRun","testing.stopContinuousRunFromExtension","Stops running the given tests with continuous run mode.",[q.Arr(q.TestItem)],be.Void),new ke("vscode.experimental.editSession.continue","_workbench.editSessions.actions.continueEditSession","Continue the current edit session in a different workspace",[q.Uri.with("workspaceUri","The target workspace to continue the current edit session in")],be.Void),new ke("setContext","_setContext","Set a custom context key value that can be used in when clauses.",[q.String.with("name","The context key name"),new q("value","The context key value",()=>!0,n=>n)],be.Void),new ke("vscode.editorChat.start","inlineChat.start","Invoke a new editor chat session",[new q("Run arguments","",n=>!0,n=>{if(n)return{initialRange:n.initialRange?W.from(n.initialRange):void 0,initialSelection:$s.isSelection(n.initialSelection)?pr.from(n.initialSelection):void 0,message:n.message,autoSend:n.autoSend,position:n.position?nt.from(n.position):void 0}})],be.Void)];class CN{static register(e){IN.forEach(e.registerApiCommand,e),this._registerValidateWhenClausesCommand(e)}static _registerValidateWhenClausesCommand(e){e.registerCommand(!1,"_validateWhenClauses",R8)}}function zi(n){return e=>{if(Array.isArray(e))return e.map(n)}}function Qs(n){if(!Array.isArray(n))return;const e=[];for(const t of n)PA(t)?e.push(nf.to(t)):e.push(ii.to(t));return e}let my=class{constructor(e,t){this._proxy=e.getProxy(Z.MainThreadBulkEdits),this._versionInformationProvider={getTextDocumentVersion:i=>{var r;return(r=t.getDocument(i))==null?void 0:r.version},getNotebookDocumentVersion:()=>{}}}applyWorkspaceEdit(e,t,i){const r=new hi(gi.from(e,this._versionInformationProvider));return this._proxy.$tryApplyWorkspaceEdit(r,void 0,(i==null?void 0:i.isRefactoring)??!1)}};my=V([F(0,tt)],my);function PN(n){return!!n&&typeof n.sessionId=="string"&&n.$mid===rt.ChatViewContext}var JD;(function(n){n[n.Info=0]="Info",n[n.Warning=1]="Warning",n[n.Error=2]="Error"})(JD||(JD={}));var XD;(function(n){n[n.Complete=1]="Complete",n[n.Partial=2]="Partial",n[n.Omitted=3]="Omitted"})(XD||(XD={}));var m1;(function(n){n[n.Down=0]="Down",n[n.Up=1]="Up"})(m1||(m1={}));var YD;(function(n){n.IncorrectCode="incorrectCode",n.DidNotFollowInstructions="didNotFollowInstructions",n.IncompleteCode="incompleteCode",n.MissingContext="missingContext",n.PoorlyWrittenOrFormatted="poorlyWrittenOrFormatted",n.RefusedAValidRequest="refusedAValidRequest",n.OffensiveOrUnsafe="offensiveOrUnsafe",n.Other="other",n.WillReportIssue="willReportIssue"})(YD||(YD={}));var ZD;(function(n){n[n.Action=1]="Action",n[n.Toolbar=2]="Toolbar"})(ZD||(ZD={}));class TN{constructor(e,t,i,r,s){this._extension=e,this._request=t,this._proxy=i,this._commandsConverter=r,this._sessionDisposables=s,this._stopWatch=Os.create(!1),this._isClosed=!1}close(){this._isClosed=!0}get timings(){return{firstProgress:this._firstProgress,totalElapsed:this._stopWatch.elapsed()}}get apiObject(){if(!this._apiObject){let t=function(r){if(e._isClosed){const s=new Error("Response stream has been closed");throw Error.captureStackTrace(s,r),s}};const e=this;this._stopWatch.reset();const i=(r,s)=>{if(typeof this._firstProgress>"u"&&(r.kind==="markdownContent"||r.kind==="markdownVuln")&&(this._firstProgress=this._stopWatch.elapsed()),s){const o=this._proxy.$handleProgressChunk(this._request.requestId,r),a={report:l=>{o==null||o.then(c=>{c&&(pi.isMarkdownString(l.value)?this._proxy.$handleProgressChunk(this._request.requestId,hf.from(l),c):this._proxy.$handleProgressChunk(this._request.requestId,el.from(l),c))})}};Promise.all([o,s==null?void 0:s(a)]).then(([l,c])=>{l!==void 0&&this._proxy.$handleProgressChunk(this._request.requestId,e0.from(c),l)})}else this._proxy.$handleProgressChunk(this._request.requestId,r)};this._apiObject=Object.freeze({markdown(r){t(this.markdown);const s=new m_(r),o=cf.from(s);return i(o),this},markdownWithVulnerabilities(r,s){t(this.markdown),s&&$(e._extension,"chatParticipantAdditions");const o=new Jh(r,s),a=Vm.from(o);return i(a),this},codeblockUri(r,s){t(this.codeblockUri),$(e._extension,"chatParticipantAdditions");const o=new w_(r,s),a=Wm.from(o);return i(a),this},filetree(r,s){t(this.filetree);const o=new __(r,s),a=uf.from(o);return i(a),this},anchor(r,s){const o=new Xh(r,s);return this.push(o)},button(r){t(this.anchor);const s=new v_(r),o=ff.from(s,e._commandsConverter,e._sessionDisposables);return i(o),this},progress(r,s){t(this.progress);const o=new Up(r,s),a=s?qm.from(o):df.from(o);return i(a,s),this},warning(r){t(this.progress),$(e._extension,"chatParticipantAdditions");const s=new Yh(r),o=hf.from(s);return i(o),this},reference(r,s){return this.reference2(r,s)},reference2(r,s,o){var a;if(t(this.reference),typeof r=="object"&&"variableName"in r&&$(e._extension,"chatParticipantAdditions"),typeof r=="object"&&"variableName"in r&&!r.value){const l=e._request.variables.variables.find(c=>c.name===r.variableName);if(l){let c;if((a=l.references)!=null&&a.length)c=l.references.map(u=>({kind:"reference",reference:{variableName:r.variableName,value:u.reference}}));else{const u=new Xa(r,s,o);c=[el.from(u)]}return c.forEach(u=>i(u)),this}}else{const l=new Xa(r,s,o),c=el.from(l);i(c)}return this},codeCitation(r,s,o){t(this.codeCitation),$(e._extension,"chatParticipantAdditions");const a=new Em(r,s,o),l=Jm.from(a);i(l)},textEdit(r,s){t(this.textEdit),$(e._extension,"chatParticipantAdditions");const o=new Zh(r,s);o.isDone=s===!0?!0:void 0;const a=jm.from(o);return i(a),this},notebookEdit(r,s){t(this.notebookEdit),$(e._extension,"chatParticipantAdditions");const o=new Sm(r,s),a=Qm.from(o);return i(a),this},confirmation(r,s,o,a){t(this.confirmation),$(e._extension,"chatParticipantAdditions");const l=new xm(r,s,o,a),c=zm.from(l);return i(c),this},push(r){if(t(this.push),(r instanceof Zh||r instanceof Sm||r instanceof Jh||r instanceof Yh||r instanceof xm||r instanceof Em||r instanceof b_||r instanceof Up)&&$(e._extension,"chatParticipantAdditions"),r instanceof Xa)this.reference2(r.value,r.iconPath,r.options);else if(r instanceof Up){const s=r.task?qm.from(r):df.from(r);i(s,r.task)}else if(r instanceof Xh){const s=Wu.from(r);if(r.resolve){$(e._extension,"chatParticipantAdditions"),s.resolveId=Mn();const o=new Bt;r.resolve(o.token).then(()=>{const a=Wu.from(r);e._proxy.$handleAnchorResolve(e._request.requestId,s.resolveId,a)}).then(()=>o.dispose(),()=>o.dispose()),e._sessionDisposables.add(Se(()=>o.dispose(!0)))}i(s)}else{const s=Xm.from(r,e._commandsConverter,e._sessionDisposables);i(s)}return this}})}return this._apiObject}}const ds=class ds extends Te{constructor(e,t,i,r,s,o,a){super(),this._logService=t,this._commands=i,this._documents=r,this._languageModels=s,this._diagnostics=o,this._tools=a,this._agents=new Map,this._participantDetectionProviders=new Map,this._relatedFilesProviders=new Map,this._sessionDisposables=this._register(new Yp),this._completionDisposables=this._register(new Yp),this._inFlightRequests=new Set,this._onDidDisposeChatSession=this._register(new L),this.onDidDisposeChatSession=this._onDidDisposeChatSession.event,this._proxy=e.getProxy(Z.MainThreadChatAgents2),i.registerArgumentProcessor({processArgument:l=>PN(l)?null:l})}transferActiveChat(e){this._proxy.$transferActiveChatSession(e)}createChatAgent(e,t,i){const r=ds._idPool++,s=new KD(e,t,this._proxy,r,i);return this._agents.set(r,s),this._proxy.$registerAgent(r,e.identifier,t,{},void 0),s.apiAgent}createDynamicChatAgent(e,t,i,r){const s=ds._idPool++,o=new KD(e,t,this._proxy,s,r);return this._agents.set(s,o),this._proxy.$registerAgent(s,e.identifier,t,{isSticky:!0},i),o.apiAgent}registerChatParticipantDetectionProvider(e,t){const i=ds._participantDetectionProviderIdPool++;return this._participantDetectionProviders.set(i,new AN(e,t)),this._proxy.$registerChatParticipantDetectionProvider(i),Se(()=>{this._participantDetectionProviders.delete(i),this._proxy.$unregisterChatParticipantDetectionProvider(i)})}registerRelatedFilesProvider(e,t,i){const r=ds._relatedFilesProviderIdPool++;return this._relatedFilesProviders.set(r,new RN(e,t)),this._proxy.$registerRelatedFilesProvider(r,i),Se(()=>{this._relatedFilesProviders.delete(r),this._proxy.$unregisterRelatedFilesProvider(r)})}async $provideRelatedFiles(e,t,i){const r=this._relatedFilesProviders.get(e);if(!r)return Promise.resolve([]);const s=t0.to(t);return await r.provider.provideRelatedFiles(s,i)??void 0}async $detectChatParticipant(e,t,i,r,s){const o=this._participantDetectionProviders.get(e);if(!o)return;const{request:a,location:l,history:c}=await this._createRequest(t,i,o.extension),u=await this.getModelForRequest(a,o.extension),d=vt(o.extension,"chatParticipantPrivate"),f=Ym.to(d?a:{...a,requestId:""},l,u,this.getDiagnosticsWhenEnabled(o.extension),this.getToolsForRequest(o.extension,a));return o.provider.provideParticipantDetection(f,{history:c},{participants:r.participants,location:pf.to(r.location)},s)}async _createRequest(e,t,i){var a,l;const r=jn(e),s=await this.prepareHistoryTurns(i,r.agentId,t);let o;if(((a=r.locationData)==null?void 0:a.type)===En.Editor){const c=this._documents.getDocument(r.locationData.document);o=new l5(c,pr.to(r.locationData.selection),W.to(r.locationData.wholeRange))}else if(((l=r.locationData)==null?void 0:l.type)===En.Notebook){const c=this._documents.getDocument(r.locationData.sessionInputUri);o=new c5(c)}return{request:r,location:o,history:s}}async getModelForRequest(e,t){let i;if(e.userSelectedModelId&&(i=await this._languageModels.getLanguageModelByIdentifier(t,e.userSelectedModelId)),!i&&(i=await this._languageModels.getDefaultLanguageModel(t),!i))throw new Error("Language model unavailable");return i}async $setRequestPaused(e,t,i){const r=this._agents.get(e);if(!r)return;const s=zn.find(this._inFlightRequests,o=>o.requestId===t);s&&r.setChatRequestPauseState({request:s.extRequest,isPaused:i})}async $invokeAgent(e,t,i,r){const s=this._agents.get(e);if(!s)throw new Error(`[CHAT](${e}) CANNOT invoke agent because the agent is not registered`);let o,a;try{const{request:l,location:c,history:u}=await this._createRequest(t,i,s.extension);let d=this._sessionDisposables.get(l.sessionId);d||(d=new Ie,this._sessionDisposables.set(l.sessionId,d)),o=new TN(s.extension,l,this._proxy,this._commands.converter,d);const f=await this.getModelForRequest(l,s.extension),p=vt(s.extension,"chatParticipantPrivate"),w=Ym.to(p?l:{...l,requestId:""},c,f,this.getDiagnosticsWhenEnabled(s.extension),this.getToolsForRequest(s.extension,l));a={requestId:t.requestId,extRequest:w},this._inFlightRequests.add(a);const v=s.invoke(w,{history:u},o.apiObject,r);return await UI(Promise.resolve(v).then(m=>{if(m!=null&&m.metadata)try{JSON.stringify(m.metadata)}catch(k){const D=`result.metadata MUST be JSON.stringify-able. Got error: ${k.message}`;return this._logService.error(`[${s.extension.identifier.value}] [@${s.id}] ${D}`,s.extension),{errorDetails:{message:D},timings:o==null?void 0:o.timings,nextQuestion:m.nextQuestion}}let x;return m!=null&&m.errorDetails&&(x={...m.errorDetails,responseIsIncomplete:!0}),(x!=null&&x.responseIsRedacted||x!=null&&x.isQuotaExceeded)&&$(s.extension,"chatParticipantPrivate"),{errorDetails:x,timings:o==null?void 0:o.timings,metadata:m==null?void 0:m.metadata,nextQuestion:m==null?void 0:m.nextQuestion}}),r)}catch(l){this._logService.error(l,s.extension),l instanceof nr&&l.cause&&(l=l.cause);const c=l instanceof Error&&l.name==="ChatQuotaExceeded";return{errorDetails:{message:Zu(l),responseIsIncomplete:!0,isQuotaExceeded:c}}}finally{a&&this._inFlightRequests.delete(a),o==null||o.close()}}getDiagnosticsWhenEnabled(e){return vt(e,"chatReferenceDiagnostic")?this._diagnostics.getDiagnostics():[]}getToolsForRequest(e,t){if(!ju(t.userSelectedTools))return;const i=new Set(t.userSelectedTools);return this._tools.getTools(e).filter(r=>i.has(r.name))}async prepareHistoryTurns(e,t,i){const r=[];for(const s of i.history){const o=Uc.to(s.result),a=t===s.request.agentId?o:{...o,metadata:void 0},l=s.request.variables.variables.filter(f=>!f.isTool).map(f=>Zm.to(f,this.getDiagnosticsWhenEnabled(e))),c=s.request.variables.variables.filter(f=>f.isTool).map(Km.to),u=new o5(s.request.message,s.request.command,l,s.request.agentId,c);r.push(u);const d=sn(s.response.map(f=>Xm.toContent(f,this._commands.converter)));r.push(new a5(d,a,s.request.agentId,s.request.command))}return r}$releaseSession(e){this._sessionDisposables.deleteAndDispose(e),this._onDidDisposeChatSession.fire(e)}async $provideFollowups(e,t,i,r,s){const o=this._agents.get(t);if(!o)return Promise.resolve([]);const a=jn(e),l=await this.prepareHistoryTurns(o.extension,o.id,r),c=Uc.to(i);return(await o.provideFollowups(c,{history:l},s)).filter(u=>{const d=!u.participant||zn.some(this._agents.values(),f=>f.id===u.participant&&Ke.equals(f.extension.identifier,o.extension.identifier));return d||this._logService.warn(`[@${o.id}] ChatFollowup refers to an unknown participant: ${u.participant}`),d}).map(u=>lf.from(u,a))}$acceptFeedback(e,t,i){const r=this._agents.get(e);if(!r)return;const s=Uc.to(t);let o;switch(i.direction){case m1.Down:o=Qh.Unhelpful;break;case m1.Up:o=Qh.Helpful;break}const a={result:s,kind:o,unhelpfulReason:vt(r.extension,"chatParticipantAdditions")?i.reason:void 0};r.acceptFeedback(Object.freeze(a))}$acceptAction(e,t,i){const r=this._agents.get(e);if(!r||i.action.kind==="vote")return;const s=i0.to(t,i,this._commands.converter);s&&r.acceptAction(Object.freeze(s))}async $invokeCompletionProvider(e,t,i){const r=this._agents.get(e);if(!r)return[];let s=this._completionDisposables.get(e);return s?s.clear():(s=new Ie,this._completionDisposables.set(e,s)),(await r.invokeCompletionProvider(t,i)).map(a=>n0.from(a,this._commands.converter,s))}async $provideChatTitle(e,t,i){const r=this._agents.get(e);if(!r)return;const s=await this.prepareHistoryTurns(r.extension,r.id,{history:t});return await r.provideTitle({history:s},i)}async $provideSampleQuestions(e,t,i){const r=this._agents.get(e);if(r)return(await r.provideSampleQuestions(pf.to(t),i)).map(s=>lf.from(s,void 0))}};ds._idPool=0,ds._participantDetectionProviderIdPool=0,ds._relatedFilesProviderIdPool=0;let _y=ds;class AN{constructor(e,t){this.extension=e,this.provider=t}}class RN{constructor(e,t){this.extension=e,this.provider=t}}class KD{constructor(e,t,i,r,s){this.extension=e,this.id=t,this._proxy=i,this._handle=r,this._requestHandler=s,this._onDidReceiveFeedback=new L,this._onDidPerformAction=new L,this._pauseStateEmitter=new L}acceptFeedback(e){this._onDidReceiveFeedback.fire(e)}acceptAction(e){this._onDidPerformAction.fire(e)}setChatRequestPauseState(e){this._pauseStateEmitter.fire(e)}async invokeCompletionProvider(e,t){return this._agentVariableProvider?await this._agentVariableProvider.provider.provideCompletionItems(e,t)??[]:[]}async provideFollowups(e,t,i){if(!this._followupProvider)return[];const r=await this._followupProvider.provideFollowups(e,t,i);return r?r.filter(s=>!(s&&"commandId"in s)).filter(s=>!(s&&"message"in s)):[]}async provideTitle(e,t){if(this._titleProvider)return await this._titleProvider.provideChatTitle(e,t)??void 0}async provideSampleQuestions(e,t){if(!this._welcomeMessageProvider||!this._welcomeMessageProvider.provideSampleQuestions)return[];const i=await this._welcomeMessageProvider.provideSampleQuestions(e,t);return i||[]}get apiAgent(){let e=!1,t=!1;const i=()=>{e||t||(t=!0,queueMicrotask(()=>{this._proxy.$updateAgent(this._handle,{icon:this._iconPath?this._iconPath instanceof y?this._iconPath:"light"in this._iconPath?this._iconPath.light:void 0:void 0,iconDark:this._iconPath&&"dark"in this._iconPath?this._iconPath.dark:void 0,themeIcon:this._iconPath instanceof qn?this._iconPath:void 0,hasFollowups:this._followupProvider!==void 0,helpTextPrefix:!this._helpTextPrefix||typeof this._helpTextPrefix=="string"?this._helpTextPrefix:Le.from(this._helpTextPrefix),helpTextVariablesPrefix:!this._helpTextVariablesPrefix||typeof this._helpTextVariablesPrefix=="string"?this._helpTextVariablesPrefix:Le.from(this._helpTextVariablesPrefix),helpTextPostfix:!this._helpTextPostfix||typeof this._helpTextPostfix=="string"?this._helpTextPostfix:Le.from(this._helpTextPostfix),supportIssueReporting:this._supportIssueReporting,requester:this._requester,welcomeMessageContent:this._welcomeMessageContent&&{...this._welcomeMessageContent,message:Le.from(this._welcomeMessageContent.message)}}),t=!1}))},r=this;return{get id(){return r.id},get iconPath(){return r._iconPath},set iconPath(s){r._iconPath=s,i()},get requestHandler(){return r._requestHandler},set requestHandler(s){uI(typeof s=="function","Invalid request handler"),r._requestHandler=s},get followupProvider(){return r._followupProvider},set followupProvider(s){r._followupProvider=s,i()},get helpTextPrefix(){return $(r.extension,"defaultChatParticipant"),r._helpTextPrefix},set helpTextPrefix(s){$(r.extension,"defaultChatParticipant"),r._helpTextPrefix=s,i()},get helpTextVariablesPrefix(){return $(r.extension,"defaultChatParticipant"),r._helpTextVariablesPrefix},set helpTextVariablesPrefix(s){$(r.extension,"defaultChatParticipant"),r._helpTextVariablesPrefix=s,i()},get helpTextPostfix(){return $(r.extension,"defaultChatParticipant"),r._helpTextPostfix},set helpTextPostfix(s){$(r.extension,"defaultChatParticipant"),r._helpTextPostfix=s,i()},get supportIssueReporting(){return $(r.extension,"chatParticipantPrivate"),r._supportIssueReporting},set supportIssueReporting(s){$(r.extension,"chatParticipantPrivate"),r._supportIssueReporting=s,i()},get onDidReceiveFeedback(){return r._onDidReceiveFeedback.event},set participantVariableProvider(s){if($(r.extension,"chatParticipantAdditions"),r._agentVariableProvider=s,s){if(!s.triggerCharacters.length)throw new Error("triggerCharacters are required");r._proxy.$registerAgentCompletionsProvider(r._handle,r.id,s.triggerCharacters)}else r._proxy.$unregisterAgentCompletionsProvider(r._handle,r.id)},get participantVariableProvider(){return $(r.extension,"chatParticipantAdditions"),r._agentVariableProvider},set welcomeMessageProvider(s){$(r.extension,"defaultChatParticipant"),r._welcomeMessageProvider=s,i()},get welcomeMessageProvider(){return $(r.extension,"defaultChatParticipant"),r._welcomeMessageProvider},set welcomeMessageContent(s){$(r.extension,"defaultChatParticipant"),r._welcomeMessageContent=s,i()},get welcomeMessageContent(){return $(r.extension,"defaultChatParticipant"),r._welcomeMessageContent},set titleProvider(s){$(r.extension,"defaultChatParticipant"),r._titleProvider=s,i()},get titleProvider(){return $(r.extension,"defaultChatParticipant"),r._titleProvider},get onDidChangePauseState(){return $(r.extension,"chatParticipantAdditions"),r._pauseStateEmitter.event},onDidPerformAction:vt(this.extension,"chatParticipantAdditions")?this._onDidPerformAction.event:void 0,set requester(s){r._requester=s,i()},get requester(){return r._requester},dispose(){e=!0,r._followupProvider=void 0,r._onDidReceiveFeedback.dispose(),r._proxy.$unregisterAgent(r._handle)}}}invoke(e,t,i,r){return this._requestHandler(e,t,i,r)}}class LN{constructor(e){this._items=new Map,this._proxy=e.getProxy(Z.MainThreadChatStatus)}createChatStatusItem(e,t){const i=NN(e.identifier,t);if(this._items.has(i))throw new Error(`Chat status item '${t}' already exists`);const r={id:i,title:"",description:"",detail:""};let s=!1,o=!1;const a=()=>{if(s)throw new Error("Chat status item is disposed");o&&this._proxy.$setEntry(t,r)},l=Object.freeze({id:t,get title(){return r.title},set title(c){r.title=c,a()},get description(){return r.description},set description(c){r.description=c,a()},get detail(){return r.detail},set detail(c){r.detail=c,a()},show:()=>{o=!0,a()},hide:()=>{o=!1,this._proxy.$disposeEntry(t)},dispose:()=>{s=!0,this._proxy.$disposeEntry(t),this._items.delete(i)}});return this._items.set(i,l),l}}function NN(n,e){return`${Ke.toKey(n)}.${e}`}class ON{constructor(e){const t=e.getProxy(Z.MainThreadClipboard);this.value=Object.freeze({readText(){return t.$readText()},writeText(i){return t.$writeText(i)}})}}const s7="vscode-cdn.net",FN=`vscode-resource.${s7}`,vy=`'self' https://*.${s7}`;function eh(n,e){return n.scheme===oe.http||n.scheme===oe.https?n:(e&&e.authority&&e.isRemote&&n.scheme===oe.file&&(n=y.from({scheme:oe.vscodeRemote,authority:e.authority,path:n.path})),y.from({scheme:oe.https,authority:`${n.scheme}+${MN(n.authority)}.${FN}`,path:n.path,fragment:n.fragment,query:n.query}))}function MN(n){return n.replace(/./g,e=>{const t=e.charCodeAt(0);return t>=P.a&&t<=P.z||t>=P.A&&t<=P.Z||t>=P.Digit0&&t<=P.Digit9?e:"-"+t.toString(16).padStart(4,"0")})}class $N{constructor(e,t,i){this._proxy=e,this._editors=t,this._remoteInfo=i,this._handlePool=0,this._disposables=new Ie,this._insets=new Map,this._disposables.add(t.onDidChangeVisibleTextEditors(()=>{const r=t.getVisibleTextEditors();for(const s of this._insets.values())r.indexOf(s.editor)<0&&s.inset.dispose()}))}dispose(){this._insets.forEach(e=>e.inset.dispose()),this._disposables.dispose()}createWebviewEditorInset(e,t,i,r,s){let o;for(const p of this._editors.getVisibleTextEditors(!0))if(p.value===e){o=p;break}if(!o)throw new Error("not a visible editor");const a=this,l=this._handlePool++,c=new L,u=new L,d=new class{constructor(){this._html="",this._options=Object.create(null)}asWebviewUri(p){return eh(p,a._remoteInfo)}get cspSource(){return vy}set options(p){this._options=p,a._proxy.$setOptions(l,p)}get options(){return this._options}set html(p){this._html=p,a._proxy.$setHtml(l,p)}get html(){return this._html}get onDidReceiveMessage(){return c.event}postMessage(p){return a._proxy.$postMessage(l,p)}},f=new class{constructor(){this.editor=e,this.line=t,this.height=i,this.webview=d,this.onDidDispose=u.event}dispose(){a._insets.has(l)&&(a._insets.delete(l),a._proxy.$disposeEditorInset(l),u.fire(),u.dispose(),c.dispose())}};return this._proxy.$createEditorInset(l,o.id,o.value.document.uri,t+1,i,r||{},s.identifier,s.extensionLocation),this._insets.set(l,{editor:e,inset:f,onDidReceiveMessage:c}),f}$onDidDispose(e){const t=this._insets.get(e);t&&t.inset.dispose()}$onDidReceiveMessage(e,t){const i=this._insets.get(e);i==null||i.onDidReceiveMessage.fire(t)}}const B1=class B1{constructor(e){this.providers=new Map,this._proxy=e.getProxy(Z.MainThreadCodeMapper)}async $mapCode(e,t,i){const r=this.providers.get(e);if(!r)throw new Error(`Received request to map code for unknown provider handle ${e}`);const s={textEdit:(l,c)=>{c=Bi(c),this._proxy.$handleProgress(t.requestId,{uri:l,edits:c.map(rn.from)})},notebookEdit:(l,c)=>{c=Bi(c),this._proxy.$handleProgress(t.requestId,{uri:l,edits:c.map(Gm.from)})}},o={location:t.location,chatRequestId:t.chatRequestId,codeBlocks:t.codeBlocks.map(l=>({code:l.code,resource:y.revive(l.resource),markdownBeforeBlock:l.markdownBeforeBlock}))};return await r.provideMappedEdits(o,s,i)??null}registerMappedEditsProvider(e,t){const i=B1._providerHandlePool++;return this._proxy.$registerCodeMapperProvider(i,e.displayName??e.name),this.providers.set(i,t),{dispose:()=>this._proxy.$unregisterCodeMapperProvider(i)}}};B1._providerHandlePool=0;let wy=B1;function UN(n,e,t){const i=n.getProxy(Z.MainThreadComments),p=class p{constructor(){this._commentControllers=new Map,this._commentControllersByExtension=new Ms,e.registerArgumentProcessor({processArgument:m=>{if(m&&m.$mid===rt.CommentController){const x=this._commentControllers.get(m.handle);return x?x.value:m}else if(m&&m.$mid===rt.CommentThread){const x=m,k=this._commentControllers.get(x.commentControlHandle);if(!k)return x;const D=k.getCommentThread(x.commentThreadHandle);return D?D.value:x}else if(m&&(m.$mid===rt.CommentThreadReply||m.$mid===rt.CommentThreadInstance)){const x=this._commentControllers.get(m.thread.commentControlHandle);if(!x)return m;const k=x.getCommentThread(m.thread.commentThreadHandle);return k?m.$mid===rt.CommentThreadInstance?k.value:{thread:k.value,text:m.text}:m}else if(m&&m.$mid===rt.CommentNode){const x=this._commentControllers.get(m.thread.commentControlHandle);if(!x)return m;const k=x.getCommentThread(m.thread.commentThreadHandle);if(!k)return m;const D=m.commentUniqueId,B=k.getCommentByUniqueId(D);return B||m}else if(m&&m.$mid===rt.CommentThreadNode){const x=this._commentControllers.get(m.thread.commentControlHandle);if(!x)return m;const k=x.getCommentThread(m.thread.commentThreadHandle);if(!k)return m;const D=m.text,B=m.commentUniqueId,T=k.getCommentByUniqueId(B);return T?(typeof T.body=="string"?T.body=D:T.body=new pi(D),T):m}return m}})}createCommentController(m,x,k){const D=p.handlePool++,B=new o(m,D,x,k);this._commentControllers.set(B.handle,B);const T=this._commentControllersByExtension.get(m.identifier)||[];return T.push(B),this._commentControllersByExtension.set(m.identifier,T),B.value}async $createCommentThreadTemplate(m,x,k,D){const B=this._commentControllers.get(m);B&&B.$createCommentThreadTemplate(x,k,D)}async $setActiveComment(m,x){const k=this._commentControllers.get(m);k&&k.$setActiveComment(x??void 0)}async $updateCommentThreadTemplate(m,x,k){const D=this._commentControllers.get(m);D&&D.$updateCommentThreadTemplate(x,k)}$deleteCommentThread(m,x){const k=this._commentControllers.get(m);k==null||k.$deleteCommentThread(x)}async $updateCommentThread(m,x,k){const D=this._commentControllers.get(m);D==null||D.$updateCommentThread(x,k)}async $provideCommentingRanges(m,x,k){const D=this._commentControllers.get(m);if(!D||!D.commentingRangeProvider)return Promise.resolve(void 0);const B=await t.ensureDocumentData(y.revive(x));return Nn(async()=>{var K;const T=await((K=D.commentingRangeProvider)==null?void 0:K.provideCommentingRanges(B.document,k));let z;return Array.isArray(T)?z={ranges:T,fileComments:!1}:T?z={ranges:T.ranges||[],fileComments:T.enableFileComments||!1}:z=T??void 0,z}).then(T=>{let z;return T&&(z={ranges:T.ranges.map(K=>W.from(K)),fileComments:T.fileComments}),z})}$toggleReaction(m,x,k,D,B){const T=this._commentControllers.get(m);return!T||!T.reactionHandler?Promise.resolve(void 0):Nn(()=>{const z=T.getCommentThread(x);if(z){const K=z.getCommentByUniqueId(D.uniqueIdInThread);if(T!==void 0&&K&&T.reactionHandler)return T.reactionHandler(K,c(B))}return Promise.resolve(void 0)})}};p.handlePool=0;let r=p;const w=class w{set threadId(m){this._id=m}get threadId(){return this._id}get id(){return this._id}get resource(){return this._uri}get uri(){return this._uri}set range(m){(m===void 0!=(this._range===void 0)||!m||!this._range||!m.isEqual(this._range))&&(this._range=m,this.modifications.range=m,this._onDidUpdateCommentThread.fire())}get range(){return this._range}set canReply(m){this._canReply!==m&&(this._canReply=m,this.modifications.canReply=m,this._onDidUpdateCommentThread.fire())}get canReply(){return this._canReply}get label(){return this._label}set label(m){this._label=m,this.modifications.label=m,this._onDidUpdateCommentThread.fire()}get contextValue(){return this._contextValue}set contextValue(m){this._contextValue=m,this.modifications.contextValue=m,this._onDidUpdateCommentThread.fire()}get comments(){return this._comments}set comments(m){this._comments=m,this.modifications.comments=m,this._onDidUpdateCommentThread.fire()}get collapsibleState(){return this._collapseState}set collapsibleState(m){this._collapseState!==m&&(this._collapseState=m,this.modifications.collapsibleState=m,this._onDidUpdateCommentThread.fire())}get state(){return this._state}set state(m){this._state=m,typeof m=="object"?($(this.extensionDescription,"commentThreadApplicability"),this.modifications.state=m.resolved,this.modifications.applicability=m.applicability):this.modifications.state=m,this._onDidUpdateCommentThread.fire()}get isDisposed(){return this._isDiposed}constructor(m,x,k,D,B,T,z,K,Ee){this._commentControllerHandle=x,this._id=k,this._uri=D,this._range=B,this._comments=T,this.extensionDescription=z,this._isTemplate=K,this.handle=w._handlePool++,this.commentHandle=0,this.modifications=Object.create(null),this._onDidUpdateCommentThread=new L,this.onDidUpdateCommentThread=this._onDidUpdateCommentThread.event,this._canReply=!0,this._commentsMap=new Map,this._acceptInputDisposables=new go,this._acceptInputDisposables.value=new Ie,this._id===void 0&&(this._id=`${m}.${this.handle}`),i.$createCommentThread(x,this.handle,this._id,this._uri,W.from(this._range),this._comments.map(le=>a(this,le,this._commentsMap,this.extensionDescription)),z.identifier,this._isTemplate,Ee),this._localDisposables=[],this._isDiposed=!1,this._localDisposables.push(this.onDidUpdateCommentThread(()=>{this.eventuallyUpdateCommentThread()})),this._localDisposables.push({dispose:()=>{i.$deleteCommentThread(x,this.handle)}});const Q=this;this.value={get uri(){return Q.uri},get range(){return Q.range},set range(le){Q.range=le},get comments(){return Q.comments},set comments(le){Q.comments=le},get collapsibleState(){return Q.collapsibleState},set collapsibleState(le){Q.collapsibleState=le},get canReply(){return Q.canReply},set canReply(le){Q.canReply=le},get contextValue(){return Q.contextValue},set contextValue(le){Q.contextValue=le},get label(){return Q.label},set label(le){Q.label=le},get state(){return Q.state},set state(le){Q.state=le},reveal:(le,Ye)=>Q.reveal(le,Ye),hide:()=>Q.hide(),dispose:()=>{Q.dispose()}}}updateIsTemplate(){this._isTemplate&&(this._isTemplate=!1,this.modifications.isTemplate=!1)}eventuallyUpdateCommentThread(){if(this._isDiposed)return;this.updateIsTemplate(),this._acceptInputDisposables.value||(this._acceptInputDisposables.value=new Ie);const m=k=>Object.prototype.hasOwnProperty.call(this.modifications,k),x={};m("range")&&(x.range=W.from(this._range)),m("label")&&(x.label=this.label),m("contextValue")&&(x.contextValue=this.contextValue??null),m("comments")&&(x.comments=this._comments.map(k=>a(this,k,this._commentsMap,this.extensionDescription))),m("collapsibleState")&&(x.collapseState=u(this._collapseState)),m("canReply")&&(x.canReply=this.canReply),m("state")&&(x.state=d(this._state)),m("applicability")&&(x.applicability=f(this._state)),m("isTemplate")&&(x.isTemplate=this._isTemplate),this.modifications={},i.$updateCommentThread(this._commentControllerHandle,this.handle,this._id,this._uri,x)}getCommentByUniqueId(m){for(const x of this._commentsMap){const k=x[0],D=x[1];if(m===D)return k}}async reveal(m,x){$(this.extensionDescription,"commentReveal");let k;m&&m.body!==void 0?k=m:x=x??m;let D=k?this._commentsMap.get(k):void 0;D??(D=this._commentsMap.get(this._comments[0]));let B=!0,T=!1;return(x==null?void 0:x.focus)===Vh.Reply?(T=!0,B=!1):(x==null?void 0:x.focus)===Vh.Comment&&(B=!1),i.$revealCommentThread(this._commentControllerHandle,this.handle,D,{preserveFocus:B,focusReply:T})}async hide(){return i.$hideCommentThread(this._commentControllerHandle,this.handle)}dispose(){this._isDiposed=!0,this._acceptInputDisposables.dispose(),this._localDisposables.forEach(m=>m.dispose())}};w._handlePool=0;let s=w;class o{get id(){return this._id}get label(){return this._label}get handle(){return this._handle}get commentingRangeProvider(){return this._commentingRangeProvider}set commentingRangeProvider(m){this._commentingRangeProvider=m,m!=null&&m.resourceHints&&$(this._extension,"commentingRangeHint"),i.$updateCommentingRanges(this.handle,m==null?void 0:m.resourceHints)}get reactionHandler(){return this._reactionHandler}set reactionHandler(m){this._reactionHandler=m,i.$updateCommentControllerFeatures(this.handle,{reactionHandler:!!m})}get options(){return this._options}set options(m){this._options=m,i.$updateCommentControllerFeatures(this.handle,{options:this._options})}get activeComment(){return $(this._extension,"activeComment"),this._activeComment}get activeCommentThread(){var m;return $(this._extension,"activeComment"),(m=this._activeThread)==null?void 0:m.value}constructor(m,x,k,D){this._extension=m,this._handle=x,this._id=k,this._label=D,this._threads=new Map,i.$registerCommentController(this.handle,k,D,this._extension.identifier.value);const B=this;this.value=Object.freeze({id:B.id,label:B.label,get options(){return B.options},set options(T){B.options=T},get commentingRangeProvider(){return B.commentingRangeProvider},set commentingRangeProvider(T){B.commentingRangeProvider=T},get reactionHandler(){return B.reactionHandler},set reactionHandler(T){B.reactionHandler=T},get activeCommentThread(){return B.activeCommentThread},createCommentThread(T,z,K){return B.createCommentThread(T,z,K).value},dispose:()=>{B.dispose()}}),this._localDisposables=[],this._localDisposables.push({dispose:()=>{i.$unregisterCommentController(this.handle)}})}createCommentThread(m,x,k){const D=new s(this.id,this.handle,void 0,m,x,k,this._extension,!1);return this._threads.set(D.handle,D),D}$setActiveComment(m){if(!m){this._activeComment=void 0,this._activeThread=void 0;return}const x=this._threads.get(m.commentThreadHandle);x&&(this._activeComment=m.uniqueIdInThread?x.getCommentByUniqueId(m.uniqueIdInThread):void 0,this._activeThread=x)}$createCommentThreadTemplate(m,x,k){const D=new s(this.id,this.handle,void 0,y.revive(m),W.to(x),[],this._extension,!0,k);return D.collapsibleState=nc.Expanded,this._threads.set(D.handle,D),D}$updateCommentThreadTemplate(m,x){const k=this._threads.get(m);k&&(k.range=W.to(x))}$updateCommentThread(m,x){const k=this._threads.get(m);if(!k)return;(B=>Object.prototype.hasOwnProperty.call(x,B))("collapseState")&&(k.collapsibleState=u(x.collapseState))}$deleteCommentThread(m){const x=this._threads.get(m);x==null||x.dispose(),this._threads.delete(m)}getCommentThread(m){return this._threads.get(m)}dispose(){this._threads.forEach(m=>{m.dispose()}),this._localDisposables.forEach(m=>m.dispose())}}function a(v,m,x,k){var B,T;let D=x.get(m);return D||(D=++v.commentHandle,x.set(m,D)),m.state!==void 0&&$(k,"commentsDraftState"),(B=m.reactions)!=null&&B.some(z=>z.reactors!==void 0)&&$(k,"commentReactor"),{mode:m.mode,contextValue:m.contextValue,uniqueIdInThread:D,body:typeof m.body=="string"?m.body:Le.from(m.body),userName:m.author.name,userIconPath:m.author.iconPath,label:m.label,commentReactions:m.reactions?m.reactions.map(z=>l(z)):void 0,state:m.state,timestamp:(T=m.timestamp)==null?void 0:T.toJSON()}}function l(v){return{label:v.label,iconPath:v.iconPath?x_(v.iconPath):void 0,count:v.count,hasReacted:v.authorHasReacted,reactors:v.reactors&&v.reactors.length>0&&typeof v.reactors[0]!="string"?v.reactors.map(m=>m.name):v.reactors}}function c(v){var m;return{label:v.label||"",count:v.count||0,iconPath:v.iconPath?y.revive(v.iconPath):"",authorHasReacted:v.hasReacted||!1,reactors:(m=v.reactors)==null?void 0:m.map(x=>({name:x}))}}function u(v){if(v!==void 0)switch(v){case Hh.Expanded:return nc.Expanded;case Hh.Collapsed:return nc.Collapsed}return nc.Collapsed}function d(v){let m;if(typeof v=="object"?m=v.resolved:m=v,m!==void 0)switch(m){case Bh.Unresolved:return Hd.Unresolved;case Bh.Resolved:return Hd.Resolved}return Hd.Unresolved}function f(v){let m;if(typeof v=="object"&&(m=v.applicability),m!==void 0)switch(m){case Wh.Current:return Bd.Current;case Wh.Outdated:return Bd.Outdated}return Bd.Current}return new r}var fp={exports:{}},wv={},ek;function HN(){return ek||(ek=1,function(n,e){e=n.exports=it;var t;typeof process=="object"&&wv&&wv.NODE_DEBUG&&/\bsemver\b/i.test(wv.NODE_DEBUG)?t=function(){var E=Array.prototype.slice.call(arguments,0);E.unshift("SEMVER"),console.log.apply(console,E)}:t=function(){},e.SEMVER_SPEC_VERSION="2.0.0";var i=256,r=Number.MAX_SAFE_INTEGER||9007199254740991,s=16,o=e.re=[],a=e.src=[],l=0,c=l++;a[c]="0|[1-9]\\d*";var u=l++;a[u]="[0-9]+";var d=l++;a[d]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var f=l++;a[f]="("+a[c]+")\\.("+a[c]+")\\.("+a[c]+")";var p=l++;a[p]="("+a[u]+")\\.("+a[u]+")\\.("+a[u]+")";var w=l++;a[w]="(?:"+a[c]+"|"+a[d]+")";var v=l++;a[v]="(?:"+a[u]+"|"+a[d]+")";var m=l++;a[m]="(?:-("+a[w]+"(?:\\."+a[w]+")*))";var x=l++;a[x]="(?:-?("+a[v]+"(?:\\."+a[v]+")*))";var k=l++;a[k]="[0-9A-Za-z-]+";var D=l++;a[D]="(?:\\+("+a[k]+"(?:\\."+a[k]+")*))";var B=l++,T="v?"+a[f]+a[m]+"?"+a[D]+"?";a[B]="^"+T+"$";var z="[v=\\s]*"+a[p]+a[x]+"?"+a[D]+"?",K=l++;a[K]="^"+z+"$";var Ee=l++;a[Ee]="((?:<|>)?=?)";var Q=l++;a[Q]=a[u]+"|x|X|\\*";var le=l++;a[le]=a[c]+"|x|X|\\*";var Ye=l++;a[Ye]="[v=\\s]*("+a[le]+")(?:\\.("+a[le]+")(?:\\.("+a[le]+")(?:"+a[m]+")?"+a[D]+"?)?)?";var Ce=l++;a[Ce]="[v=\\s]*("+a[Q]+")(?:\\.("+a[Q]+")(?:\\.("+a[Q]+")(?:"+a[x]+")?"+a[D]+"?)?)?";var Y=l++;a[Y]="^"+a[Ee]+"\\s*"+a[Ye]+"$";var j=l++;a[j]="^"+a[Ee]+"\\s*"+a[Ce]+"$";var ae=l++;a[ae]="(?:^|[^\\d])(\\d{1,"+s+"})(?:\\.(\\d{1,"+s+"}))?(?:\\.(\\d{1,"+s+"}))?(?:$|[^\\d])";var ne=l++;a[ne]="(?:~>?)";var he=l++;a[he]="(\\s*)"+a[ne]+"\\s+",o[he]=new RegExp(a[he],"g");var _e="$1~",Ve=l++;a[Ve]="^"+a[ne]+a[Ye]+"$";var yt=l++;a[yt]="^"+a[ne]+a[Ce]+"$";var $e=l++;a[$e]="(?:\\^)";var Gt=l++;a[Gt]="(\\s*)"+a[$e]+"\\s+",o[Gt]=new RegExp(a[Gt],"g");var Un="$1^",xt=l++;a[xt]="^"+a[$e]+a[Ye]+"$";var mi=l++;a[mi]="^"+a[$e]+a[Ce]+"$";var _n=l++;a[_n]="^"+a[Ee]+"\\s*("+z+")$|^$";var Wt=l++;a[Wt]="^"+a[Ee]+"\\s*("+T+")$|^$";var Ri=l++;a[Ri]="(\\s*)"+a[Ee]+"\\s*("+z+"|"+a[Ye]+")",o[Ri]=new RegExp(a[Ri],"g");var R_="$1$2$3",Ws=l++;a[Ws]="^\\s*("+a[Ye]+")\\s+-\\s+("+a[Ye]+")\\s*$";var Oo=l++;a[Oo]="^\\s*("+a[Ce]+")\\s+-\\s+("+a[Ce]+")\\s*$";var qe=l++;a[qe]="(<|>)?=?\\s*\\*";for(var jr=0;jr<l;jr++)t(jr,a[jr]),o[jr]||(o[jr]=new RegExp(a[jr]));e.parse=Gr;function Gr(E,N){if(E instanceof it)return E;if(typeof E!="string"||E.length>i)return null;var U=N?o[K]:o[B];if(!U.test(E))return null;try{return new it(E,N)}catch{return null}}e.valid=Qr;function Qr(E,N){var U=Gr(E,N);return U?U.version:null}e.clean=Fo;function Fo(E,N){var U=Gr(E.trim().replace(/^[=v]+/,""),N);return U?U.version:null}e.SemVer=it;function it(E,N){if(E instanceof it){if(E.loose===N)return E;E=E.version}else if(typeof E!="string")throw new TypeError("Invalid Version: "+E);if(E.length>i)throw new TypeError("version is longer than "+i+" characters");if(!(this instanceof it))return new it(E,N);t("SemVer",E,N),this.loose=N;var U=E.trim().match(N?o[K]:o[B]);if(!U)throw new TypeError("Invalid Version: "+E);if(this.raw=E,this.major=+U[1],this.minor=+U[2],this.patch=+U[3],this.major>r||this.major<0)throw new TypeError("Invalid major version");if(this.minor>r||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>r||this.patch<0)throw new TypeError("Invalid patch version");U[4]?this.prerelease=U[4].split(".").map(function(re){if(/^[0-9]+$/.test(re)){var J=+re;if(J>=0&&J<r)return J}return re}):this.prerelease=[],this.build=U[5]?U[5].split("."):[],this.format()}it.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},it.prototype.toString=function(){return this.version},it.prototype.compare=function(E){return t("SemVer.compare",this.version,this.loose,E),E instanceof it||(E=new it(E,this.loose)),this.compareMain(E)||this.comparePre(E)},it.prototype.compareMain=function(E){return E instanceof it||(E=new it(E,this.loose)),Jr(this.major,E.major)||Jr(this.minor,E.minor)||Jr(this.patch,E.patch)},it.prototype.comparePre=function(E){if(E instanceof it||(E=new it(E,this.loose)),this.prerelease.length&&!E.prerelease.length)return-1;if(!this.prerelease.length&&E.prerelease.length)return 1;if(!this.prerelease.length&&!E.prerelease.length)return 0;var N=0;do{var U=this.prerelease[N],re=E.prerelease[N];if(t("prerelease compare",N,U,re),U===void 0&&re===void 0)return 0;if(re===void 0)return 1;if(U===void 0)return-1;if(U===re)continue;return Jr(U,re)}while(++N)},it.prototype.inc=function(E,N){switch(E){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",N);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",N);break;case"prepatch":this.prerelease.length=0,this.inc("patch",N),this.inc("pre",N);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",N),this.inc("pre",N);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var U=this.prerelease.length;--U>=0;)typeof this.prerelease[U]=="number"&&(this.prerelease[U]++,U=-2);U===-1&&this.prerelease.push(0)}N&&(this.prerelease[0]===N?isNaN(this.prerelease[1])&&(this.prerelease=[N,0]):this.prerelease=[N,0]);break;default:throw new Error("invalid increment argument: "+E)}return this.format(),this.raw=this.version,this},e.inc=L_;function L_(E,N,U,re){typeof U=="string"&&(re=U,U=void 0);try{return new it(E,U).inc(N,re).version}catch{return null}}e.diff=N_;function N_(E,N){if(_r(E,N))return null;var U=Gr(E),re=Gr(N);if(U.prerelease.length||re.prerelease.length){for(var J in U)if((J==="major"||J==="minor"||J==="patch")&&U[J]!==re[J])return"pre"+J;return"prerelease"}for(var J in U)if((J==="major"||J==="minor"||J==="patch")&&U[J]!==re[J])return J}e.compareIdentifiers=Jr;var ep=/^[0-9]+$/;function Jr(E,N){var U=ep.test(E),re=ep.test(N);return U&&re&&(E=+E,N=+N),U&&!re?-1:re&&!U?1:E<N?-1:E>N?1:0}e.rcompareIdentifiers=O_;function O_(E,N){return Jr(N,E)}e.major=tp;function tp(E,N){return new it(E,N).major}e.minor=F_;function F_(E,N){return new it(E,N).minor}e.patch=nd;function nd(E,N){return new it(E,N).patch}e.compare=_i;function _i(E,N,U){return new it(E,U).compare(new it(N,U))}e.compareLoose=M_;function M_(E,N){return _i(E,N,!0)}e.rcompare=$_;function $_(E,N,U){return _i(N,E,U)}e.sort=Vs;function Vs(E,N){return E.sort(function(U,re){return e.compare(U,re,N)})}e.rsort=U_;function U_(E,N){return E.sort(function(U,re){return e.rcompare(U,re,N)})}e.gt=Nl;function Nl(E,N,U){return _i(E,N,U)>0}e.lt=Xr;function Xr(E,N,U){return _i(E,N,U)<0}e.eq=_r;function _r(E,N,U){return _i(E,N,U)===0}e.neq=id;function id(E,N,U){return _i(E,N,U)!==0}e.gte=rd;function rd(E,N,U){return _i(E,N,U)>=0}e.lte=Ol;function Ol(E,N,U){return _i(E,N,U)<=0}e.cmp=Fl;function Fl(E,N,U,re){var J;switch(N){case"===":typeof E=="object"&&(E=E.version),typeof U=="object"&&(U=U.version),J=E===U;break;case"!==":typeof E=="object"&&(E=E.version),typeof U=="object"&&(U=U.version),J=E!==U;break;case"":case"=":case"==":J=_r(E,U,re);break;case"!=":J=id(E,U,re);break;case">":J=Nl(E,U,re);break;case">=":J=rd(E,U,re);break;case"<":J=Xr(E,U,re);break;case"<=":J=Ol(E,U,re);break;default:throw new TypeError("Invalid operator: "+N)}return J}e.Comparator=vn;function vn(E,N){if(E instanceof vn){if(E.loose===N)return E;E=E.value}if(!(this instanceof vn))return new vn(E,N);t("comparator",E,N),this.loose=N,this.parse(E),this.semver===Mo?this.value="":this.value=this.operator+this.semver.version,t("comp",this)}var Mo={};vn.prototype.parse=function(E){var N=this.loose?o[_n]:o[Wt],U=E.match(N);if(!U)throw new TypeError("Invalid comparator: "+E);this.operator=U[1],this.operator==="="&&(this.operator=""),U[2]?this.semver=new it(U[2],this.loose):this.semver=Mo},vn.prototype.toString=function(){return this.value},vn.prototype.test=function(E){return t("Comparator.test",E,this.loose),this.semver===Mo?!0:(typeof E=="string"&&(E=new it(E,this.loose)),Fl(E,this.operator,this.semver,this.loose))},vn.prototype.intersects=function(E,N){if(!(E instanceof vn))throw new TypeError("a Comparator is required");var U;if(this.operator==="")return U=new Mt(E.value,N),Ml(this.value,U,N);if(E.operator==="")return U=new Mt(this.value,N),Ml(E.semver,U,N);var re=(this.operator===">="||this.operator===">")&&(E.operator===">="||E.operator===">"),J=(this.operator==="<="||this.operator==="<")&&(E.operator==="<="||E.operator==="<"),ye=this.semver.version===E.semver.version,Ue=(this.operator===">="||this.operator==="<=")&&(E.operator===">="||E.operator==="<="),_=Fl(this.semver,"<",E.semver,N)&&(this.operator===">="||this.operator===">")&&(E.operator==="<="||E.operator==="<"),b=Fl(this.semver,">",E.semver,N)&&(this.operator==="<="||this.operator==="<")&&(E.operator===">="||E.operator===">");return re||J||ye&&Ue||_||b},e.Range=Mt;function Mt(E,N){if(E instanceof Mt)return E.loose===N?E:new Mt(E.raw,N);if(E instanceof vn)return new Mt(E.value,N);if(!(this instanceof Mt))return new Mt(E,N);if(this.loose=N,this.raw=E,this.set=E.split(/\s*\|\|\s*/).map(function(U){return this.parseRange(U.trim())},this).filter(function(U){return U.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+E);this.format()}Mt.prototype.format=function(){return this.range=this.set.map(function(E){return E.join(" ").trim()}).join("||").trim(),this.range},Mt.prototype.toString=function(){return this.range},Mt.prototype.parseRange=function(E){var N=this.loose;E=E.trim(),t("range",E,N);var U=N?o[Oo]:o[Ws];E=E.replace(U,V_),t("hyphen replace",E),E=E.replace(o[Ri],R_),t("comparator trim",E,o[Ri]),E=E.replace(o[he],_e),E=E.replace(o[Gt],Un),E=E.split(/\s+/).join(" ");var re=N?o[_n]:o[Wt],J=E.split(" ").map(function(ye){return sd(ye,N)}).join(" ").split(/\s+/);return this.loose&&(J=J.filter(function(ye){return!!ye.match(re)})),J=J.map(function(ye){return new vn(ye,N)}),J},Mt.prototype.intersects=function(E,N){if(!(E instanceof Mt))throw new TypeError("a Range is required");return this.set.some(function(U){return U.every(function(re){return E.set.some(function(J){return J.every(function(ye){return re.intersects(ye,N)})})})})},e.toComparators=H_;function H_(E,N){return new Mt(E,N).set.map(function(U){return U.map(function(re){return re.value}).join(" ").trim().split(" ")})}function sd(E,N){return t("comp",E),E=vr(E,N),t("caret",E),E=B_(E,N),t("tildes",E),E=ue(E,N),t("xrange",E),E=W_(E,N),t("stars",E),E}function wn(E){return!E||E.toLowerCase()==="x"||E==="*"}function B_(E,N){return E.trim().split(/\s+/).map(function(U){return I(U,N)}).join(" ")}function I(E,N){var U=N?o[yt]:o[Ve];return E.replace(U,function(re,J,ye,Ue,_){t("tilde",E,re,J,ye,Ue,_);var b;return wn(J)?b="":wn(ye)?b=">="+J+".0.0 <"+(+J+1)+".0.0":wn(Ue)?b=">="+J+"."+ye+".0 <"+J+"."+(+ye+1)+".0":_?(t("replaceTilde pr",_),_.charAt(0)!=="-"&&(_="-"+_),b=">="+J+"."+ye+"."+Ue+_+" <"+J+"."+(+ye+1)+".0"):b=">="+J+"."+ye+"."+Ue+" <"+J+"."+(+ye+1)+".0",t("tilde return",b),b})}function vr(E,N){return E.trim().split(/\s+/).map(function(U){return od(U,N)}).join(" ")}function od(E,N){t("caret",E,N);var U=N?o[mi]:o[xt];return E.replace(U,function(re,J,ye,Ue,_){t("caret",E,re,J,ye,Ue,_);var b;return wn(J)?b="":wn(ye)?b=">="+J+".0.0 <"+(+J+1)+".0.0":wn(Ue)?J==="0"?b=">="+J+"."+ye+".0 <"+J+"."+(+ye+1)+".0":b=">="+J+"."+ye+".0 <"+(+J+1)+".0.0":_?(t("replaceCaret pr",_),_.charAt(0)!=="-"&&(_="-"+_),J==="0"?ye==="0"?b=">="+J+"."+ye+"."+Ue+_+" <"+J+"."+ye+"."+(+Ue+1):b=">="+J+"."+ye+"."+Ue+_+" <"+J+"."+(+ye+1)+".0":b=">="+J+"."+ye+"."+Ue+_+" <"+(+J+1)+".0.0"):(t("no pr"),J==="0"?ye==="0"?b=">="+J+"."+ye+"."+Ue+" <"+J+"."+ye+"."+(+Ue+1):b=">="+J+"."+ye+"."+Ue+" <"+J+"."+(+ye+1)+".0":b=">="+J+"."+ye+"."+Ue+" <"+(+J+1)+".0.0"),t("caret return",b),b})}function ue(E,N){return t("replaceXRanges",E,N),E.split(/\s+/).map(function(U){return st(U,N)}).join(" ")}function st(E,N){E=E.trim();var U=N?o[j]:o[Y];return E.replace(U,function(re,J,ye,Ue,_,b){t("xRange",E,re,J,ye,Ue,_,b);var S=wn(ye),ce=S||wn(Ue),He=ce||wn(_),at=He;return J==="="&&at&&(J=""),S?J===">"||J==="<"?re="<0.0.0":re="*":J&&at?(ce&&(Ue=0),He&&(_=0),J===">"?(J=">=",ce?(ye=+ye+1,Ue=0,_=0):He&&(Ue=+Ue+1,_=0)):J==="<="&&(J="<",ce?ye=+ye+1:Ue=+Ue+1),re=J+ye+"."+Ue+"."+_):ce?re=">="+ye+".0.0 <"+(+ye+1)+".0.0":He&&(re=">="+ye+"."+Ue+".0 <"+ye+"."+(+Ue+1)+".0"),t("xRange return",re),re})}function W_(E,N){return t("replaceStars",E,N),E.trim().replace(o[qe],"")}function V_(E,N,U,re,J,ye,Ue,_,b,S,ce,He,at){return wn(U)?N="":wn(re)?N=">="+U+".0.0":wn(J)?N=">="+U+"."+re+".0":N=">="+N,wn(b)?_="":wn(S)?_="<"+(+b+1)+".0.0":wn(ce)?_="<"+b+"."+(+S+1)+".0":He?_="<="+b+"."+S+"."+ce+"-"+He:_="<="+_,(N+" "+_).trim()}Mt.prototype.test=function(E){if(!E)return!1;typeof E=="string"&&(E=new it(E,this.loose));for(var N=0;N<this.set.length;N++)if(z_(this.set[N],E))return!0;return!1};function z_(E,N){for(var U=0;U<E.length;U++)if(!E[U].test(N))return!1;if(N.prerelease.length){for(var U=0;U<E.length;U++)if(t(E[U].semver),E[U].semver!==Mo&&E[U].semver.prerelease.length>0){var re=E[U].semver;if(re.major===N.major&&re.minor===N.minor&&re.patch===N.patch)return!0}return!1}return!0}e.satisfies=Ml;function Ml(E,N,U){try{N=new Mt(N,U)}catch{return!1}return N.test(E)}e.maxSatisfying=$l;function $l(E,N,U){var re=null,J=null;try{var ye=new Mt(N,U)}catch{return null}return E.forEach(function(Ue){ye.test(Ue)&&(!re||J.compare(Ue)===-1)&&(re=Ue,J=new it(re,U))}),re}e.minSatisfying=q_;function q_(E,N,U){var re=null,J=null;try{var ye=new Mt(N,U)}catch{return null}return E.forEach(function(Ue){ye.test(Ue)&&(!re||J.compare(Ue)===1)&&(re=Ue,J=new it(re,U))}),re}e.validRange=j_;function j_(E,N){try{return new Mt(E,N).range||"*"}catch{return null}}e.ltr=G_;function G_(E,N,U){return ad(E,N,"<",U)}e.gtr=np;function np(E,N,U){return ad(E,N,">",U)}e.outside=ad;function ad(E,N,U,re){E=new it(E,re),N=new Mt(N,re);var J,ye,Ue,_,b;switch(U){case">":J=Nl,ye=Ol,Ue=Xr,_=">",b=">=";break;case"<":J=Xr,ye=rd,Ue=Nl,_="<",b="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Ml(E,N,re))return!1;for(var S=0;S<N.set.length;++S){var ce=N.set[S],He=null,at=null;if(ce.forEach(function(Li){Li.semver===Mo&&(Li=new vn(">=0.0.0")),He=He||Li,at=at||Li,J(Li.semver,He.semver,re)?He=Li:Ue(Li.semver,at.semver,re)&&(at=Li)}),He.operator===_||He.operator===b||(!at.operator||at.operator===_)&&ye(E,at.semver))return!1;if(at.operator===b&&Ue(E,at.semver))return!1}return!0}e.prerelease=Q_;function Q_(E,N){var U=Gr(E,N);return U&&U.prerelease.length?U.prerelease:null}e.intersects=J_;function J_(E,N,U){return E=new Mt(E,U),N=new Mt(N,U),E.intersects(N)}e.coerce=X_;function X_(E){if(E instanceof it)return E;if(typeof E!="string")return null;var N=E.match(o[ae]);return N==null?null:Gr((N[1]||"0")+"."+(N[2]||"0")+"."+(N[3]||"0"))}}(fp,fp.exports)),fp.exports}HN();const o7=/^(\^|>=)?((\d+)|x)\.((\d+)|x)\.((\d+)|x)(\-.*)?$/,BN=/^-(\d{4})(\d{2})(\d{2})$/;function WN(n){return n=n.trim(),n==="*"||o7.test(n)}function a7(n){if(!WN(n))return null;if(n=n.trim(),n==="*")return{hasCaret:!1,hasGreaterEquals:!1,majorBase:0,majorMustEqual:!1,minorBase:0,minorMustEqual:!1,patchBase:0,patchMustEqual:!1,preRelease:null};const e=n.match(o7);return e?{hasCaret:e[1]==="^",hasGreaterEquals:e[1]===">=",majorBase:e[2]==="x"?0:parseInt(e[2],10),majorMustEqual:e[2]!=="x",minorBase:e[4]==="x"?0:parseInt(e[4],10),minorMustEqual:e[4]!=="x",patchBase:e[6]==="x"?0:parseInt(e[6],10),patchMustEqual:e[6]!=="x",preRelease:e[8]||null}:null}function l7(n){if(!n)return null;const e=n.majorBase,t=n.majorMustEqual,i=n.minorBase;let r=n.minorMustEqual;const s=n.patchBase;let o=n.patchMustEqual;n.hasCaret&&(e===0||(r=!1),o=!1);let a=0;if(n.preRelease){const l=BN.exec(n.preRelease);if(l){const[,c,u,d]=l;a=Date.UTC(Number(c),Number(u)-1,Number(d))}}return{majorBase:e,majorMustEqual:t,minorBase:i,minorMustEqual:r,patchBase:s,patchMustEqual:o,isMinimum:n.hasGreaterEquals,notBefore:a}}class VN{constructor(){this.buffers=[]}add(e){let t=this.buffers.indexOf(e);return t<0&&(t=this.buffers.length,this.buffers.push(e)),t}}function zN(n,e){if(e.serializeBuffersForPostMessage){const t=new VN,r=JSON.stringify(n,(o,a)=>{if(a instanceof ArrayBuffer)return{$$vscode_array_buffer_reference$$:!0,index:t.add(a)};if(ArrayBuffer.isView(a)){const l=qN(a);if(l)return{$$vscode_array_buffer_reference$$:!0,index:t.add(a.buffer),view:{type:l,byteLength:a.byteLength,byteOffset:a.byteOffset}}}return a}),s=t.buffers.map(o=>{const a=new Uint8Array(o);return Pe.wrap(a)});return{message:r,buffers:s}}else return{message:JSON.stringify(n),buffers:[]}}function qN(n){switch(n.constructor.name){case"Int8Array":return Ut.Int8Array;case"Uint8Array":return Ut.Uint8Array;case"Uint8ClampedArray":return Ut.Uint8ClampedArray;case"Int16Array":return Ut.Int16Array;case"Uint16Array":return Ut.Uint16Array;case"Int32Array":return Ut.Int32Array;case"Uint32Array":return Ut.Uint32Array;case"Float32Array":return Ut.Float32Array;case"Float64Array":return Ut.Float64Array;case"BigInt64Array":return Ut.BigInt64Array;case"BigUint64Array":return Ut.BigUint64Array}}function jN(n,e){const t=e.map(s=>{const o=new ArrayBuffer(s.byteLength);return new Uint8Array(o).set(s.buffer),o}),i=e.length?(s,o)=>{if(o&&typeof o=="object"&&o.$$vscode_array_buffer_reference$$){const a=o,{index:l}=a,c=t[l];if(a.view)switch(a.view.type){case Ut.Int8Array:return new Int8Array(c,a.view.byteOffset,a.view.byteLength/Int8Array.BYTES_PER_ELEMENT);case Ut.Uint8Array:return new Uint8Array(c,a.view.byteOffset,a.view.byteLength/Uint8Array.BYTES_PER_ELEMENT);case Ut.Uint8ClampedArray:return new Uint8ClampedArray(c,a.view.byteOffset,a.view.byteLength/Uint8ClampedArray.BYTES_PER_ELEMENT);case Ut.Int16Array:return new Int16Array(c,a.view.byteOffset,a.view.byteLength/Int16Array.BYTES_PER_ELEMENT);case Ut.Uint16Array:return new Uint16Array(c,a.view.byteOffset,a.view.byteLength/Uint16Array.BYTES_PER_ELEMENT);case Ut.Int32Array:return new Int32Array(c,a.view.byteOffset,a.view.byteLength/Int32Array.BYTES_PER_ELEMENT);case Ut.Uint32Array:return new Uint32Array(c,a.view.byteOffset,a.view.byteLength/Uint32Array.BYTES_PER_ELEMENT);case Ut.Float32Array:return new Float32Array(c,a.view.byteOffset,a.view.byteLength/Float32Array.BYTES_PER_ELEMENT);case Ut.Float64Array:return new Float64Array(c,a.view.byteOffset,a.view.byteLength/Float64Array.BYTES_PER_ELEMENT);case Ut.BigInt64Array:return new BigInt64Array(c,a.view.byteOffset,a.view.byteLength/BigInt64Array.BYTES_PER_ELEMENT);case Ut.BigUint64Array:return new BigUint64Array(c,a.view.byteOffset,a.view.byteLength/BigUint64Array.BYTES_PER_ELEMENT);default:throw new Error("Unknown array buffer view type")}return c}return o}:void 0;return{message:JSON.parse(n,i),arrayBuffers:t}}var Ca,Pa,Af,Rf,Lf,Dr,Ta,Aa,Ra,La,Nf,qc,Na;class GN{constructor(e,t,i,r,s,o,a){ge(this,Ca);ge(this,Pa);ge(this,Af);ge(this,Rf);ge(this,Lf);ge(this,Dr);ge(this,Ta);ge(this,Aa);ge(this,Ra);ge(this,La);ge(this,Nf);ge(this,qc);ge(this,Na);ie(this,Ta,""),ie(this,Ra,!1),ie(this,La,!1),this._onMessageEmitter=new L,this.onDidReceiveMessage=this._onMessageEmitter.event,ie(this,Na,new L),this._onDidDispose=A(this,Na).event,ie(this,Ca,e),ie(this,Pa,t),ie(this,Aa,i),ie(this,Rf,r),ie(this,Lf,s),ie(this,Dr,o),ie(this,Nf,qu(o)),ie(this,qc,QN(o)),ie(this,Af,a)}dispose(){ie(this,Ra,!0),A(this,Na).fire(),A(this,Na).dispose(),this._onMessageEmitter.dispose()}asWebviewUri(e){return ie(this,La,!0),eh(e,A(this,Rf))}get cspSource(){const e=A(this,Dr).extensionLocation;if(e.scheme===oe.https||e.scheme===oe.http){let t=e.toString();return t.endsWith("/")||(t+="/"),t+" "+vy}return vy}get html(){return this.assertNotDisposed(),A(this,Ta)}set html(e){this.assertNotDisposed(),A(this,Ta)!==e&&(ie(this,Ta,e),A(this,qc)&&!A(this,La)&&/(["'])vscode-resource:([^\s'"]+?)(["'])/i.test(e)&&(ie(this,La,!0),A(this,Af).report("Webview vscode-resource: uris",A(this,Dr),"Please migrate to use the 'webview.asWebviewUri' api instead: https://aka.ms/vscode-webview-use-aswebviewuri")),A(this,Pa).$setHtml(A(this,Ca),this.rewriteOldResourceUrlsIfNeeded(e)))}get options(){return this.assertNotDisposed(),A(this,Aa)}set options(e){this.assertNotDisposed(),fi(A(this,Aa),e)||A(this,Pa).$setOptions(A(this,Ca),c7(A(this,Dr),A(this,Lf),e)),ie(this,Aa,e)}async postMessage(e){if(A(this,Ra))return!1;const t=zN(e,{serializeBuffersForPostMessage:A(this,Nf)});return A(this,Pa).$postMessage(A(this,Ca),t.message,...t.buffers)}assertNotDisposed(){if(A(this,Ra))throw new Error("Webview is disposed")}rewriteOldResourceUrlsIfNeeded(e){var r;if(!A(this,qc))return e;const t=((r=A(this,Dr).extensionLocation)==null?void 0:r.scheme)===oe.vscodeRemote,i=A(this,Dr).extensionLocation.scheme===oe.vscodeRemote?A(this,Dr).extensionLocation.authority:void 0;return e.replace(/(["'])(?:vscode-resource):(\/\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,(s,o,a,l,c,u)=>{const d=y.from({scheme:l||"file",path:decodeURIComponent(c)}),f=eh(d,{isRemote:t,authority:i}).toString();return`${o}${f}${u}`}).replace(/(["'])(?:vscode-webview-resource):(\/\/[^\s\/'"]+\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,(s,o,a,l,c,u)=>{const d=y.from({scheme:l||"file",path:decodeURIComponent(c)}),f=eh(d,{isRemote:t,authority:i}).toString();return`${o}${f}${u}`})}}Ca=new WeakMap,Pa=new WeakMap,Af=new WeakMap,Rf=new WeakMap,Lf=new WeakMap,Dr=new WeakMap,Ta=new WeakMap,Aa=new WeakMap,Ra=new WeakMap,La=new WeakMap,Nf=new WeakMap,qc=new WeakMap,Na=new WeakMap;function qu(n){try{const e=l7(a7(n.engines.vscode));return!!e&&e.majorBase>=1&&e.minorBase>=57}catch{return!1}}function QN(n){try{const e=l7(a7(n.engines.vscode));return e?e.majorBase<1||e.majorBase===1&&e.minorBase<60:!1}catch{return!1}}class JN extends Te{constructor(e,t,i,r,s){super(),this.remoteInfo=t,this.workspace=i,this._logService=r,this._deprecationService=s,this._webviews=new Map,this._webviewProxy=e.getProxy(Z.MainThreadWebviews)}dispose(){super.dispose();for(const e of this._webviews.values())e.dispose();this._webviews.clear()}$onMessage(e,t,i){const r=this.getWebview(e);if(r){const{message:s}=jN(t,i.value);r._onMessageEmitter.fire(s)}}$onMissingCsp(e,t){this._logService.warn(`${t} created a webview without a content security policy: https://aka.ms/vscode-webview-missing-csp`)}createNewWebview(e,t,i){const r=new GN(e,this._webviewProxy,XN(t),this.remoteInfo,this.workspace,i,this._deprecationService);this._webviews.set(e,r);const s=r._onDidDispose(()=>{s.dispose(),this.deleteWebview(e)});return r}deleteWebview(e){this._webviews.delete(e)}getWebview(e){return this._webviews.get(e)}}function _1(n){return{id:n.identifier,location:n.extensionLocation}}function c7(n,e,t){return{enableCommandUris:t.enableCommandUris,enableScripts:t.enableScripts,enableForms:t.enableForms,portMapping:t.portMapping,localResourceRoots:t.localResourceRoots||YN(n,e)}}function XN(n){var e;return{enableCommandUris:n.enableCommandUris,enableScripts:n.enableScripts,enableForms:n.enableForms,portMapping:n.portMapping,localResourceRoots:(e=n.localResourceRoots)==null?void 0:e.map(t=>y.from(t))}}function YN(n,e){return[...((e==null?void 0:e.getWorkspaceFolders())||[]).map(t=>t.uri),n.extensionLocation]}const W1=class W1{constructor(e){this.id=e,this._data=new Map,this._idPool=1}add(e){const t=this._idPool++;return this._data.set(t,e),this.logDebugInfo(),t}get(e,t){return this._data.has(e)?this._data.get(e)[t]:void 0}delete(e){this._data.delete(e),this.logDebugInfo()}logDebugInfo(){W1.enableDebugLogging&&console.log(`${this.id} cache size - ${this._data.size}`)}};W1.enableDebugLogging=!1;let Ai=W1;class ZN{constructor(e,t){this.document=e,this._storagePath=t,this._backupCounter=1,this._edits=new Ai("custom documents")}addEdit(e){return this._edits.add([e])}async undo(e,t){await this.getEdit(e).undo(),t||this.disposeBackup()}async redo(e,t){await this.getEdit(e).redo(),t||this.disposeBackup()}disposeEdits(e){for(const t of e)this._edits.delete(t)}getNewBackupUri(){if(!this._storagePath)throw new Error("Backup requires a valid storage path");const e=rO(this.document.uri)+this._backupCounter++;return An(this._storagePath,e)}updateBackup(e){var t;(t=this._backup)==null||t.delete(),this._backup=e}disposeBackup(){var e;(e=this._backup)==null||e.delete(),this._backup=void 0}getEdit(e){const t=this._edits.get(e,0);if(!t)throw new Error("No edit found");return t}}class KN{constructor(){this._documents=new Map}get(e,t){return this._documents.get(this.key(e,t))}add(e,t,i){const r=this.key(e,t.uri);if(this._documents.has(r))throw new Error(`Document already exists for viewType:${e} resource:${t.uri}`);const s=new ZN(t,i);return this._documents.set(r,s),s}delete(e,t){const i=this.key(e,t.uri);this._documents.delete(i)}key(e,t){return`${e}@@@${t}`}}var yo;(function(n){n[n.Text=0]="Text",n[n.Custom=1]="Custom"})(yo||(yo={}));class eO{constructor(){this._providers=new Map}addTextProvider(e,t,i){return this.add(e,{type:yo.Text,extension:t,provider:i})}addCustomProvider(e,t,i){return this.add(e,{type:yo.Custom,extension:t,provider:i})}get(e){return this._providers.get(e)}add(e,t){if(this._providers.has(e))throw new Error(`Provider for viewType:${e} already registered`);return this._providers.set(e,t),new je(()=>this._providers.delete(e))}}class tO{constructor(e,t,i,r,s){this._extHostDocuments=t,this._extensionStoragePaths=i,this._extHostWebview=r,this._extHostWebviewPanels=s,this._editorProviders=new eO,this._documents=new KN,this._proxy=e.getProxy(Z.MainThreadCustomEditors)}registerCustomEditorProvider(e,t,i,r){const s=new Ie;return nO(i)?(s.add(this._editorProviders.addTextProvider(t,e,i)),this._proxy.$registerTextEditorProvider(_1(e),t,r.webviewOptions||{},{supportsMove:!!i.moveCustomTextEditor},qu(e))):(s.add(this._editorProviders.addCustomProvider(t,e,i)),pp(i)&&s.add(i.onDidChangeCustomDocument(o=>{const a=this.getCustomDocumentEntry(t,o.document.uri);if(iO(o)){const l=a.addEdit(o);this._proxy.$onDidEdit(o.document.uri,t,l,o.label)}else this._proxy.$onContentChange(o.document.uri,t)})),this._proxy.$registerCustomEditorProvider(_1(e),t,r.webviewOptions||{},!!r.supportsMultipleEditorsPerDocument,qu(e))),je.from(s,new je(()=>{this._proxy.$unregisterEditorProvider(t)}))}async $createCustomDocument(e,t,i,r,s){const o=this._editorProviders.get(t);if(!o)throw new Error(`No provider found for '${t}'`);if(o.type!==yo.Custom)throw new Error(`Invalid provide type for '${t}'`);const a=y.revive(e),l=await o.provider.openCustomDocument(a,{backupId:i,untitledDocumentData:r==null?void 0:r.buffer},s);let c;return pp(o.provider)&&this._extensionStoragePaths&&(c=this._extensionStoragePaths.workspaceValue(o.extension)??this._extensionStoragePaths.globalValue(o.extension)),this._documents.add(t,l,c),{editable:pp(o.provider)}}async $disposeCustomDocument(e,t){const i=this._editorProviders.get(t);if(!i)throw new Error(`No provider found for '${t}'`);if(i.type!==yo.Custom)throw new Error(`Invalid provider type for '${t}'`);const r=y.revive(e),{document:s}=this.getCustomDocumentEntry(t,r);this._documents.delete(t,s),s.dispose()}async $resolveCustomEditor(e,t,i,r,s,o){const a=this._editorProviders.get(i);if(!a)throw new Error(`No provider found for '${i}'`);const l=nn.to(s),c=this._extHostWebview.createNewWebview(t,r.contentOptions,a.extension),u=this._extHostWebviewPanels.createNewWebviewPanel(t,i,r.title,l,r.options,c,r.active),d=y.revive(e);switch(a.type){case yo.Custom:{const{document:f}=this.getCustomDocumentEntry(i,d);return a.provider.resolveCustomEditor(f,u,o)}case yo.Text:{const f=this._extHostDocuments.getDocument(d);return a.provider.resolveCustomTextEditor(f,u,o)}default:throw new Error("Unknown webview provider type")}}$disposeEdits(e,t,i){this.getCustomDocumentEntry(t,e).disposeEdits(i)}async $onMoveCustomEditor(e,t,i){const r=this._editorProviders.get(i);if(!r)throw new Error(`No provider found for '${i}'`);if(!r.provider.moveCustomTextEditor)throw new Error(`Provider does not implement move '${i}'`);const s=this._extHostWebviewPanels.getWebviewPanel(e);if(!s)throw new Error("No webview found");const o=y.revive(t),a=this._extHostDocuments.getDocument(o);await r.provider.moveCustomTextEditor(a,s,Pt.None)}async $undo(e,t,i,r){return this.getCustomDocumentEntry(t,e).undo(i,r)}async $redo(e,t,i,r){return this.getCustomDocumentEntry(t,e).redo(i,r)}async $revert(e,t,i){const r=this.getCustomDocumentEntry(t,e);await this.getCustomEditorProvider(t).revertCustomDocument(r.document,i),r.disposeBackup()}async $onSave(e,t,i){const r=this.getCustomDocumentEntry(t,e);await this.getCustomEditorProvider(t).saveCustomDocument(r.document,i),r.disposeBackup()}async $onSaveAs(e,t,i,r){const s=this.getCustomDocumentEntry(t,e);return this.getCustomEditorProvider(t).saveCustomDocumentAs(s.document,y.revive(i),r)}async $backup(e,t,i){const r=this.getCustomDocumentEntry(t,e),o=await this.getCustomEditorProvider(t).backupCustomDocument(r.document,{destination:r.getNewBackupUri()},i);return r.updateBackup(o),o.id}getCustomDocumentEntry(e,t){const i=this._documents.get(e,y.revive(t));if(!i)throw new Error("No custom document found");return i}getCustomEditorProvider(e){const t=this._editorProviders.get(e),i=t==null?void 0:t.provider;if(!i||!pp(i))throw new Error("Custom document is not editable");return i}}function pp(n){return!!n.onDidChangeCustomDocument}function nO(n){return typeof n.resolveCustomTextEditor=="function"}function iO(n){return typeof n.undo=="function"&&typeof n.redo=="function"}function rO(n){const e=n.scheme===oe.file||n.scheme===oe.untitled?n.fsPath:n.toString();return _f(e)+""}var jo,ws,ao,fn;const v2=class v2{constructor(e,t,i,r,s,o,a,l){ge(this,ws);ge(this,ao);ge(this,fn);this._name=e,this._owner=t,this._maxDiagnosticsTotal=i,this._maxDiagnosticsPerFile=r,this._modelVersionIdProvider=s,this._isDisposed=!1,this._maxDiagnosticsTotal=Math.max(r,i),ie(this,fn,new on(c=>o.getComparisonKey(c))),ie(this,ws,a),ie(this,ao,l)}dispose(){var e;this._isDisposed||(A(this,ao).fire([...A(this,fn).keys()]),(e=A(this,ws))==null||e.$clear(this._owner),A(this,fn).clear(),this._isDisposed=!0)}get name(){return this._checkDisposed(),this._name}set(e,t){if(!e){this.clear();return}this._checkDisposed();let i=[];if(y.isUri(e)){if(!t){this.delete(e);return}A(this,fn).set(e,t.slice()),i=[e]}else if(Array.isArray(e)){i=[];let o;e=[...e].sort(v2._compareIndexedTuplesByUri);for(const a of e){const[l,c]=a;if((!o||l.toString()!==o.toString())&&(o&&A(this,fn).get(o).length===0&&A(this,fn).delete(o),o=l,i.push(l),A(this,fn).set(l,[])),c){const u=A(this,fn).get(l);u==null||u.push(...c)}else{const u=A(this,fn).get(l);u&&(u.length=0)}}}if(A(this,ao).fire(i),!A(this,ws))return;const r=[];let s=0;for(const o of i){let a=[];const l=A(this,fn).get(o);if(l)if(l.length>this._maxDiagnosticsPerFile){a=[];const c=[Sn.Error,Sn.Warning,Sn.Information,Sn.Hint];e:for(let u=0;u<4;u++)for(const d of l)if(d.severity===c[u]&&a.push({...Tu.from(d),modelVersionId:this._modelVersionIdProvider(o)})===this._maxDiagnosticsPerFile)break e;a.push({severity:ei.Info,message:h(2537,"Not showing {0} further errors and warnings.",l.length-this._maxDiagnosticsPerFile),startLineNumber:a[a.length-1].startLineNumber,startColumn:a[a.length-1].startColumn,endLineNumber:a[a.length-1].endLineNumber,endColumn:a[a.length-1].endColumn})}else a=l.map(c=>({...Tu.from(c),modelVersionId:this._modelVersionIdProvider(o)}));if(r.push([o,a]),s+=a.length,s>this._maxDiagnosticsTotal)break}A(this,ws).$changeMany(this._owner,r)}delete(e){var t;this._checkDisposed(),A(this,ao).fire([e]),A(this,fn).delete(e),(t=A(this,ws))==null||t.$changeMany(this._owner,[[e,void 0]])}clear(){var e;this._checkDisposed(),A(this,ao).fire([...A(this,fn).keys()]),A(this,fn).clear(),(e=A(this,ws))==null||e.$clear(this._owner)}forEach(e,t){this._checkDisposed();for(const[i,r]of this)e.call(t,i,r,this)}*[Symbol.iterator](){this._checkDisposed();for(const e of A(this,fn).keys())yield[e,this.get(e)]}get(e){this._checkDisposed();const t=A(this,fn).get(e);return Array.isArray(t)?Object.freeze(t.slice(0)):[]}has(e){return this._checkDisposed(),Array.isArray(A(this,fn).get(e))}_checkDisposed(){if(this._isDisposed)throw new Error("illegal state - object is disposed")}static _compareIndexedTuplesByUri(e,t){return e[0].toString()<t[0].toString()?-1:e[0].toString()>t[0].toString()?1:0}};ws=new WeakMap,ao=new WeakMap,fn=new WeakMap;let v1=v2;var Lr;let by=(Lr=class{static _mapper(e){const t=new on;for(const i of e)t.set(i,i);return{uris:Object.freeze(Array.from(t.values()))}}constructor(e,t,i,r){this._logService=t,this._fileSystemInfoService=i,this._extHostDocumentsAndEditors=r,this._collections=new Map,this._onDidChangeDiagnostics=new vP({merge:s=>s.flat(),delay:50}),this.onDidChangeDiagnostics=Ht.map(this._onDidChangeDiagnostics.event,jo._mapper),this._proxy=e.getProxy(Z.MainThreadDiagnostics)}createDiagnosticCollection(e,t){const{_collections:i,_proxy:r,_onDidChangeDiagnostics:s,_logService:o,_fileSystemInfoService:a,_extHostDocumentsAndEditors:l}=this,c=new class{$changeMany(f,p){r.$changeMany(f,p),o.trace("[DiagnosticCollection] change many (extension, owner, uris)",e.value,f,p.length===0?"CLEARING":p)}$clear(f){r.$clear(f),o.trace("[DiagnosticCollection] remove all (extension, owner)",e.value,f)}dispose(){r.dispose()}};let u;if(!t)t="_generated_diagnostic_collection_name_#"+jo._idPool++,u=t;else if(!i.has(t))u=t;else{this._logService.warn(`DiagnosticCollection with name '${t}' does already exist.`);do u=t+jo._idPool++;while(i.has(u))}return new class extends v1{constructor(){super(t,u,jo._maxDiagnosticsTotal,jo._maxDiagnosticsPerFile,f=>{var p;return(p=l.getDocument(f))==null?void 0:p.version},a.extUri,c,s),i.set(u,this)}dispose(){super.dispose(),i.delete(u)}}}getDiagnostics(e){if(e)return this._getDiagnostics(e);{const t=new Map,i=[];for(const r of this._collections.values())r.forEach((s,o)=>{let a=t.get(s.toString());typeof a>"u"&&(a=i.length,t.set(s.toString(),a),i.push([s,[]])),i[a][1]=i[a][1].concat(...o)});return i}}_getDiagnostics(e){let t=[];for(const i of this._collections.values())i.has(e)&&(t=t.concat(i.get(e)));return t}$acceptMarkersChange(e){if(!this._mirrorCollection){const t="_generated_mirror",i=new v1(t,t,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,r=>{},this._fileSystemInfoService.extUri,void 0,this._onDidChangeDiagnostics);this._collections.set(t,i),this._mirrorCollection=i}for(const[t,i]of e)this._mirrorCollection.set(y.revive(t),i.map(Tu.to))}},jo=Lr,Lr._idPool=0,Lr._maxDiagnosticsPerFile=1e3,Lr._maxDiagnosticsTotal=1.1*Lr._maxDiagnosticsPerFile,Lr);by=jo=V([F(1,ct),F(2,Ju)],by);class sO{constructor(e){this._proxy=e.getProxy(Z.MainThreadDialogs)}showOpenDialog(e){return this._proxy.$showOpenDialog(e).then(t=>t?t.map(i=>y.revive(i)):void 0)}showSaveDialog(e){return this._proxy.$showSaveDialog(e).then(t=>t?y.revive(t):void 0)}}const V1=class V1{constructor(e,t,i){this._documentsAndEditors=t,this._logService=i,this._documentContentProviders=new Map,this._proxy=e.getProxy(Z.MainThreadDocumentContentProviders)}registerTextDocumentContentProvider(e,t){if(Object.keys(oe).indexOf(e)>=0)throw new Error(`scheme '${e}' already registered`);const i=V1._handlePool++;this._documentContentProviders.set(i,t),this._proxy.$registerTextContentProvider(i,e);let r;if(typeof t.onDidChange=="function"){let s;r=t.onDidChange(async o=>{if(o.scheme!==e){this._logService.warn(`Provider for scheme '${e}' is firing event for schema '${o.scheme}' which will be IGNORED`);return}if(!this._documentsAndEditors.getDocument(o))return;s&&await s;const a=this.$provideTextDocumentContent(i,o).then(async l=>{if(!l&&typeof l!="string")return;const c=this._documentsAndEditors.getDocument(o);if(!c)return;const u=AI(l);if(!c.equalLines(u))return this._proxy.$onVirtualDocumentChange(o,l)}).catch(Fn).finally(()=>{s===a&&(s=void 0)});s=a})}return new je(()=>{this._documentContentProviders.delete(i)&&this._proxy.$unregisterTextContentProvider(i),r&&(r.dispose(),r=void 0)})}$provideTextDocumentContent(e,t){const i=this._documentContentProviders.get(e);return i?Promise.resolve(i.provideTextDocumentContent(y.revive(t),Pt.None)):Promise.reject(new Error(`unsupported uri-scheme: ${t.scheme}`))}};V1._handlePool=0;let yy=V1;class oO{constructor(e,t,i,r={timeout:1500,errors:3}){this._logService=e,this._documents=t,this._mainThreadBulkEdits=i,this._thresholds=r,this._callbacks=new Hf,this._badListeners=new WeakMap}dispose(){this._callbacks.clear()}getOnWillSaveTextDocumentEvent(e){return(t,i,r)=>{const o={dispose:this._callbacks.push([t,i,e])};return Array.isArray(r)&&r.push(o),o}}async $participateInSave(e,t){const i=y.revive(e);let r=!1;const s=setTimeout(()=>r=!0,this._thresholds.timeout),o=[];try{for(const a of[...this._callbacks]){if(r)break;const l=this._documents.getDocument(i),c=await this._deliverEventAsyncAndBlameBadListeners(a,{document:l,reason:Fm.to(t)});o.push(c)}}finally{clearTimeout(s)}return o}_deliverEventAsyncAndBlameBadListeners([e,t,i],r){const s=this._badListeners.get(e);return typeof s=="number"&&s>this._thresholds.errors?Promise.resolve(!1):this._deliverEventAsync(i,e,t,r).then(()=>!0,o=>{if(this._logService.error(`onWillSaveTextDocument-listener from extension '${i.identifier.value}' threw ERROR`),this._logService.error(o),!(o instanceof Error)||o.message!=="concurrent_edits"){const a=this._badListeners.get(e);this._badListeners.set(e,a?a+1:1),typeof a=="number"&&a>this._thresholds.errors&&this._logService.info(`onWillSaveTextDocument-listener from extension '${i.identifier.value}' will now be IGNORED because of timeouts and/or errors`)}return!1})}_deliverEventAsync(e,t,i,r){const s=[],o=Date.now(),{document:a,reason:l}=r,{version:c}=a,u=Object.freeze({document:a,reason:l,waitUntil(d){if(Object.isFrozen(s))throw sx("waitUntil can not be called async");s.push(Promise.resolve(d))}});try{t.apply(i,[u])}catch(d){return Promise.reject(d)}return new Promise((d,f)=>{const p=setTimeout(()=>f(new Error("timeout")),this._thresholds.timeout);return Promise.all(s).then(w=>{this._logService.debug(`onWillSaveTextDocument-listener from extension '${e.identifier.value}' finished after ${Date.now()-o}ms`),clearTimeout(p),d(w)}).catch(w=>{clearTimeout(p),f(w)})}).then(d=>{const f={edits:[]};for(const p of d)if(Array.isArray(p)&&p.every(w=>w instanceof Co))for(const{newText:w,newEol:v,range:m}of p)f.edits.push({resource:a.uri,versionId:void 0,textEdit:{range:m&&W.from(m),text:w,eol:v&&Nu.from(v)}});if(f.edits.length!==0)return c===a.version?this._mainThreadBulkEdits.$tryApplyWorkspaceEdit(new hi(f)):Promise.reject(new Error("concurrent_edits"))})}}class aO{constructor(e,t){this._onDidAddDocument=new L,this._onDidRemoveDocument=new L,this._onDidChangeDocument=new L,this._onDidSaveDocument=new L,this.onDidAddDocument=this._onDidAddDocument.event,this.onDidRemoveDocument=this._onDidRemoveDocument.event,this.onDidChangeDocument=this._onDidChangeDocument.event,this.onDidSaveDocument=this._onDidSaveDocument.event,this._toDispose=new Ie,this._documentLoader=new Map,this._proxy=e.getProxy(Z.MainThreadDocuments),this._documentsAndEditors=t,this._documentsAndEditors.onDidRemoveDocuments(i=>{for(const r of i)this._onDidRemoveDocument.fire(r.document)},void 0,this._toDispose),this._documentsAndEditors.onDidAddDocuments(i=>{for(const r of i)this._onDidAddDocument.fire(r.document)},void 0,this._toDispose)}dispose(){this._toDispose.dispose()}getAllDocumentData(){return[...this._documentsAndEditors.allDocuments()]}getDocumentData(e){if(!e)return;const t=this._documentsAndEditors.getDocument(e);if(t)return t}getDocument(e){const t=this.getDocumentData(e);if(!(t!=null&&t.document))throw new Error(`Unable to retrieve document from URI '${e}'`);return t.document}ensureDocumentData(e,t){const i=this._documentsAndEditors.getDocument(e);if(i&&(!(t!=null&&t.encoding)||i.document.encoding===t.encoding))return Promise.resolve(i);let r=this._documentLoader.get(e.toString());return r?t!=null&&t.encoding&&(r=r.then(s=>s.document.encoding!==t.encoding?this.ensureDocumentData(e,t):s)):(r=this._proxy.$tryOpenDocument(e,t).then(s=>{this._documentLoader.delete(e.toString());const o=y.revive(s);return cu(this._documentsAndEditors.getDocument(o))},s=>(this._documentLoader.delete(e.toString()),Promise.reject(s))),this._documentLoader.set(e.toString(),r)),r}createDocumentData(e){return this._proxy.$tryCreateDocument(e).then(t=>y.revive(t))}$acceptModelLanguageChanged(e,t){const i=y.revive(e),r=this._documentsAndEditors.getDocument(i);if(!r)throw new Error("unknown document");this._onDidRemoveDocument.fire(r.document),r._acceptLanguageId(t),this._onDidAddDocument.fire(r.document)}$acceptModelSaved(e){const t=y.revive(e),i=this._documentsAndEditors.getDocument(t);if(!i)throw new Error("unknown document");this.$acceptDirtyStateChanged(e,!1),this._onDidSaveDocument.fire(i.document)}$acceptDirtyStateChanged(e,t){const i=y.revive(e),r=this._documentsAndEditors.getDocument(i);if(!r)throw new Error("unknown document");r._acceptIsDirty(t),this._onDidChangeDocument.fire({document:r.document,contentChanges:[],reason:void 0})}$acceptEncodingChanged(e,t){const i=y.revive(e),r=this._documentsAndEditors.getDocument(i);if(!r)throw new Error("unknown document");r._acceptEncoding(t),this._onDidChangeDocument.fire({document:r.document,contentChanges:[],reason:void 0})}$acceptModelChanged(e,t,i){const r=y.revive(e),s=this._documentsAndEditors.getDocument(r);if(!s)throw new Error("unknown document");s._acceptIsDirty(i),s.onEvents(t);let o;t.isUndoing?o=Rh.Undo:t.isRedoing&&(o=Rh.Redo),this._onDidChangeDocument.fire(QI({document:s.document,contentChanges:t.changes.map(a=>({range:W.to(a.range),rangeOffset:a.rangeOffset,rangeLength:a.rangeLength,text:a.text})),reason:o}))}setWordDefinitionFor(e,t){pL(e,t)}}class lO{constructor(e){this._provider=new Map,this._onDidChange=new L,this.onDidChange=this._onDidChange.event,this._allKnownModels=new Set,this._handlePool=0,this._proxy=e.getProxy(Z.MainThreadEmbeddings)}registerEmbeddingsProvider(e,t,i){if(this._allKnownModels.has(t))throw new Error("An embeddings provider for this model is already registered");const r=this._handlePool++;return this._proxy.$registerEmbeddingProvider(r,t),this._provider.set(r,{id:t,provider:i}),Se(()=>{this._allKnownModels.delete(t),this._proxy.$unregisterEmbeddingProvider(r),this._provider.delete(r)})}async computeEmbeddings(e,t,i){i??(i=Pt.None);let r=!1;typeof t=="string"&&(t=[t],r=!0);const s=await this._proxy.$computeEmbeddings(e,t,i);if(s.length!==t.length)throw new Error;if(r){if(s.length!==1)throw new Error;return s[0]}return s}async $provideEmbeddings(e,t,i){const r=this._provider.get(e);if(!r)return[];const s=await r.provider.provideEmbeddings(t,i);return s||[]}get embeddingsModels(){return Array.from(this._allKnownModels)}$acceptEmbeddingModels(e){this._allKnownModels=new Set(e),this._onDidChange.fire()}}class cO{constructor(e){this._AiEmbeddingVectorProviders=new Map,this._nextHandle=0,this._proxy=e.getProxy(Z.MainThreadAiEmbeddingVector)}async $provideAiEmbeddingVector(e,t,i){if(this._AiEmbeddingVectorProviders.size===0)throw new Error("No embedding vector providers registered");const r=this._AiEmbeddingVectorProviders.get(e);if(!r)throw new Error("Embedding vector provider not found");const s=await r.provideEmbeddingVector(t,i);if(!s)throw new Error("Embedding vector provider returned undefined");return s}registerEmbeddingVectorProvider(e,t,i){const r=this._nextHandle;return this._nextHandle++,this._AiEmbeddingVectorProviders.set(r,i),this._proxy.$registerAiEmbeddingVectorProvider(t,r),new je(()=>{this._proxy.$unregisterAiEmbeddingVectorProvider(r),this._AiEmbeddingVectorProviders.delete(r)})}}var ve;(function(n){n[n.Invalid=0]="Invalid",n[n.Start=1]="Start",n[n.H=2]="H",n[n.HT=3]="HT",n[n.HTT=4]="HTT",n[n.HTTP=5]="HTTP",n[n.F=6]="F",n[n.FI=7]="FI",n[n.FIL=8]="FIL",n[n.BeforeColon=9]="BeforeColon",n[n.AfterColon=10]="AfterColon",n[n.AlmostThere=11]="AlmostThere",n[n.End=12]="End",n[n.Accept=13]="Accept",n[n.LastKnownState=14]="LastKnownState"})(ve||(ve={}));class uO{constructor(e,t,i){const r=new Uint8Array(e*t);for(let s=0,o=e*t;s<o;s++)r[s]=i;this._data=r,this.rows=e,this.cols=t}get(e,t){return this._data[e*this.cols+t]}set(e,t,i){this._data[e*this.cols+t]=i}}class u7{constructor(e){let t=0,i=ve.Invalid;for(let s=0,o=e.length;s<o;s++){const[a,l,c]=e[s];l>t&&(t=l),a>i&&(i=a),c>i&&(i=c)}t++,i++;const r=new uO(i,t,ve.Invalid);for(let s=0,o=e.length;s<o;s++){const[a,l,c]=e[s];r.set(a,l,c)}this._states=r,this._maxCharCode=t}nextState(e,t){return t<0||t>=this._maxCharCode?ve.Invalid:this._states.get(e,t)}}let bv=null;function dO(){return bv===null&&(bv=new u7([[ve.Start,P.h,ve.H],[ve.Start,P.H,ve.H],[ve.Start,P.f,ve.F],[ve.Start,P.F,ve.F],[ve.H,P.t,ve.HT],[ve.H,P.T,ve.HT],[ve.HT,P.t,ve.HTT],[ve.HT,P.T,ve.HTT],[ve.HTT,P.p,ve.HTTP],[ve.HTT,P.P,ve.HTTP],[ve.HTTP,P.s,ve.BeforeColon],[ve.HTTP,P.S,ve.BeforeColon],[ve.HTTP,P.Colon,ve.AfterColon],[ve.F,P.i,ve.FI],[ve.F,P.I,ve.FI],[ve.FI,P.l,ve.FIL],[ve.FI,P.L,ve.FIL],[ve.FIL,P.e,ve.BeforeColon],[ve.FIL,P.E,ve.BeforeColon],[ve.BeforeColon,P.Colon,ve.AfterColon],[ve.AfterColon,P.Slash,ve.AlmostThere],[ve.AlmostThere,P.Slash,ve.End]])),bv}var Ct;(function(n){n[n.None=0]="None",n[n.ForceTermination=1]="ForceTermination",n[n.CannotEndIn=2]="CannotEndIn"})(Ct||(Ct={}));let _d=null;function hO(){if(_d===null){_d=new I_(Ct.None);const n=` 	<>'"`;for(let t=0;t<n.length;t++)_d.set(n.charCodeAt(t),Ct.ForceTermination);const e=".,;:";for(let t=0;t<e.length;t++)_d.set(e.charCodeAt(t),Ct.CannotEndIn)}return _d}class w1{static _createLink(e,t,i,r,s){let o=s-1;do{const a=t.charCodeAt(o);if(e.get(a)!==Ct.CannotEndIn)break;o--}while(o>r);if(r>0){const a=t.charCodeAt(r-1),l=t.charCodeAt(o);(a===P.OpenParen&&l===P.CloseParen||a===P.OpenSquareBracket&&l===P.CloseSquareBracket||a===P.OpenCurlyBrace&&l===P.CloseCurlyBrace)&&o--}return{range:{startLineNumber:i,startColumn:r+1,endLineNumber:i,endColumn:o+2},url:t.substring(r,o+1)}}static computeLinks(e,t=dO()){const i=hO(),r=[];for(let s=1,o=e.getLineCount();s<=o;s++){const a=e.getLineContent(s),l=a.length;let c=0,u=0,d=0,f=ve.Start,p=!1,w=!1,v=!1,m=!1;for(;c<l;){let x=!1;const k=a.charCodeAt(c);if(f===ve.Accept){let D;switch(k){case P.OpenParen:p=!0,D=Ct.None;break;case P.CloseParen:D=p?Ct.None:Ct.ForceTermination;break;case P.OpenSquareBracket:v=!0,w=!0,D=Ct.None;break;case P.CloseSquareBracket:v=!1,D=w?Ct.None:Ct.ForceTermination;break;case P.OpenCurlyBrace:m=!0,D=Ct.None;break;case P.CloseCurlyBrace:D=m?Ct.None:Ct.ForceTermination;break;case P.SingleQuote:case P.DoubleQuote:case P.BackTick:d===k?D=Ct.ForceTermination:d===P.SingleQuote||d===P.DoubleQuote||d===P.BackTick?D=Ct.None:D=Ct.ForceTermination;break;case P.Asterisk:D=d===P.Asterisk?Ct.ForceTermination:Ct.None;break;case P.Pipe:D=d===P.Pipe?Ct.ForceTermination:Ct.None;break;case P.Space:D=v?Ct.None:Ct.ForceTermination;break;default:D=i.get(k)}D===Ct.ForceTermination&&(r.push(w1._createLink(i,a,s,u,c)),x=!0)}else if(f===ve.End){let D;k===P.OpenSquareBracket?(w=!0,D=Ct.None):D=i.get(k),D===Ct.ForceTermination?x=!0:f=ve.Accept}else f=t.nextState(f,k),f===ve.Invalid&&(x=!0);x&&(f=ve.Start,p=!1,w=!1,m=!1,u=c+1,d=k),c++}f===ve.Accept&&r.push(w1._createLink(i,a,s,u,l))}return r}}class fO{constructor(){this._schemes=[]}add(e){this._stateMachine=void 0,this._schemes.push(e)}delete(e){const t=this._schemes.indexOf(e);t>=0&&(this._schemes.splice(t,1),this._stateMachine=void 0)}_initStateMachine(){if(!this._stateMachine){const e=this._schemes.sort(),t=[];let i,r,s=ve.LastKnownState,o=ve.LastKnownState;for(const a of e){let l=i?o9(i,a):0;for(l===0?r=ve.Start:r=o;l<a.length;l++)l+1===a.length?(s=o,o=ve.BeforeColon):o+=1,t.push([r,a.toUpperCase().charCodeAt(l),o]),t.push([r,a.toLowerCase().charCodeAt(l),o]),r=o;i=a,o=s}t.push([ve.BeforeColon,P.Colon,ve.AfterColon]),t.push([ve.AfterColon,P.Slash,ve.End]),this._stateMachine=new u7(t)}}provideDocumentLinks(e){this._initStateMachine();const t=[],i=w1.computeLinks({getLineContent(r){return e.lineAt(r-1).text},getLineCount(){return e.lineCount}},this._stateMachine);for(const r of i){const s=Ya.to(r);s.target&&t.push(s)}return t}}class b1{constructor(e,t){this._extHostLanguageFeatures=t,this._linkProvider=new fO,this._fsProvider=new Map,this._registeredSchemes=new Set,this._watches=new Map,this._handlePool=0,this._proxy=e.getProxy(Z.MainThreadFileSystem)}dispose(){var e;(e=this._linkProviderRegistration)==null||e.dispose()}registerFileSystemProvider(e,t,i,r={}){if(b1._validateFileSystemProvider(i),this._registeredSchemes.has(t))throw new Error(`a provider for the scheme '${t}' is already registered`);this._linkProviderRegistration||(this._linkProviderRegistration=this._extHostLanguageFeatures.registerDocumentLinkProvider(e,"*",this._linkProvider));const s=this._handlePool++;this._linkProvider.add(t),this._registeredSchemes.add(t),this._fsProvider.set(s,i);let o=Cr.FileReadWrite;r.isCaseSensitive&&(o+=Cr.PathCaseSensitive),r.isReadonly&&(o+=Cr.Readonly),typeof i.copy=="function"&&(o+=Cr.FileFolderCopy),typeof i.open=="function"&&typeof i.close=="function"&&typeof i.read=="function"&&typeof i.write=="function"&&($(e,"fsChunks"),o+=Cr.FileOpenReadWriteClose);let a;r.isReadonly&&kl(r.isReadonly)&&r.isReadonly.value!==""&&(a={value:r.isReadonly.value,isTrusted:r.isReadonly.isTrusted,supportThemeIcons:r.isReadonly.supportThemeIcons,supportHtml:r.isReadonly.supportHtml,baseUri:r.isReadonly.baseUri,uris:r.isReadonly.uris}),this._proxy.$registerFileSystemProvider(s,t,o,a).catch(c=>{console.error(`FAILED to register filesystem provider of ${e.identifier.value}-extension for the scheme ${t}`),console.error(c)});const l=i.onDidChangeFile(c=>{const u=[];for(const d of c){const{uri:f,type:p}=d;if(f.scheme!==t)continue;let w;switch(p){case Nc.Changed:w=sr.UPDATED;break;case Nc.Created:w=sr.ADDED;break;case Nc.Deleted:w=sr.DELETED;break;default:throw new Error("Unknown FileChangeType")}u.push({resource:f,type:w})}this._proxy.$onFileSystemChange(s,u)});return Se(()=>{l.dispose(),this._linkProvider.delete(t),this._registeredSchemes.delete(t),this._fsProvider.delete(s),this._proxy.$unregisterProvider(s)})}static _validateFileSystemProvider(e){if(!e)throw new Error("MISSING provider");if(typeof e.watch!="function")throw new Error("Provider does NOT implement watch");if(typeof e.stat!="function")throw new Error("Provider does NOT implement stat");if(typeof e.readDirectory!="function")throw new Error("Provider does NOT implement readDirectory");if(typeof e.createDirectory!="function")throw new Error("Provider does NOT implement createDirectory");if(typeof e.readFile!="function")throw new Error("Provider does NOT implement readFile");if(typeof e.writeFile!="function")throw new Error("Provider does NOT implement writeFile");if(typeof e.delete!="function")throw new Error("Provider does NOT implement delete");if(typeof e.rename!="function")throw new Error("Provider does NOT implement rename")}static _asIStat(e){const{type:t,ctime:i,mtime:r,size:s,permissions:o}=e;return{type:t,ctime:i,mtime:r,size:s,permissions:o}}$stat(e,t){return Promise.resolve(this._getFsProvider(e).stat(y.revive(t))).then(i=>b1._asIStat(i))}$readdir(e,t){return Promise.resolve(this._getFsProvider(e).readDirectory(y.revive(t)))}$readFile(e,t){return Promise.resolve(this._getFsProvider(e).readFile(y.revive(t))).then(i=>Pe.wrap(i))}$writeFile(e,t,i,r){return Promise.resolve(this._getFsProvider(e).writeFile(y.revive(t),i.buffer,r))}$delete(e,t,i){return Promise.resolve(this._getFsProvider(e).delete(y.revive(t),i))}$rename(e,t,i,r){return Promise.resolve(this._getFsProvider(e).rename(y.revive(t),y.revive(i),r))}$copy(e,t,i,r){const s=this._getFsProvider(e);if(!s.copy)throw new Error('FileSystemProvider does not implement "copy"');return Promise.resolve(s.copy(y.revive(t),y.revive(i),r))}$mkdir(e,t){return Promise.resolve(this._getFsProvider(e).createDirectory(y.revive(t)))}$watch(e,t,i,r){const s=this._getFsProvider(e).watch(y.revive(i),r);this._watches.set(t,s)}$unwatch(e,t){const i=this._watches.get(t);i&&(i.dispose(),this._watches.delete(t))}$open(e,t,i){const r=this._getFsProvider(e);if(!r.open)throw new Error('FileSystemProvider does not implement "open"');return Promise.resolve(r.open(y.revive(t),i))}$close(e,t){const i=this._getFsProvider(e);if(!i.close)throw new Error('FileSystemProvider does not implement "close"');return Promise.resolve(i.close(t))}$read(e,t,i,r){const s=this._getFsProvider(e);if(!s.read)throw new Error('FileSystemProvider does not implement "read"');const o=Pe.alloc(r);return Promise.resolve(s.read(t,i,o.buffer,0,r)).then(a=>o.slice(0,a))}$write(e,t,i,r){const s=this._getFsProvider(e);if(!s.write)throw new Error('FileSystemProvider does not implement "write"');return Promise.resolve(s.write(t,i,r.buffer,0,r.byteLength))}_getFsProvider(e){const t=this._fsProvider.get(e);if(!t){const i=new Error;throw i.name="ENOPRO",i.message="no provider",i}return t}}const z1=class z1 extends Te{constructor(e,t,i,r){super(),this.onFileChanges=e,this.onLogMessage=t,this.verboseLogging=i,this.options=r,this.watcherDisposables=this._register(new go),this.requests=void 0,this.restartCounter=0}init(){const e=new Ie;this.watcherDisposables.value=e,this.watcher=this.createWatcher(e),this.watcher.setVerboseLogging(this.verboseLogging),e.add(this.watcher.onDidChangeFile(t=>this.onFileChanges(t))),e.add(this.watcher.onDidLogMessage(t=>this.onLogMessage(t))),e.add(this.watcher.onDidError(t=>this.onError(t.error,t.request)))}onError(e,t){this.canRestart(e,t)?this.restartCounter<z1.MAX_RESTARTS&&this.requests?(this.error(`restarting watcher after unexpected error: ${e}`),this.restart(this.requests)):this.error(`gave up attempting to restart watcher after unexpected error: ${e}`):this.error(e)}canRestart(e,t){return!(!this.options.restartOnError||t||e.indexOf("No space left on device")!==-1||e.indexOf("EMFILE")!==-1)}restart(e){this.restartCounter++,this.init(),this.watch(e)}async watch(e){var t;this.requests=e,await((t=this.watcher)==null?void 0:t.watch(e))}async setVerboseLogging(e){var t;this.verboseLogging=e,await((t=this.watcher)==null?void 0:t.setVerboseLogging(e))}error(e){this.onLogMessage({type:"error",message:`[File Watcher (${this.options.type})] ${e}`})}trace(e){this.onLogMessage({type:"trace",message:`[File Watcher (${this.options.type})] ${e}`})}dispose(){return this.watcher=void 0,super.dispose()}};z1.MAX_RESTARTS=5;let tk=z1;function pO(n,e){return typeof e=="string"&&!e.startsWith(da)&&!ng(e)?{base:n,pattern:e}:e}class gO{get ignoreCreateEvents(){return!!(this._config&1)}get ignoreChangeEvents(){return!!(this._config&2)}get ignoreDeleteEvents(){return!!(this._config&4)}constructor(e,t,i,r,s,o,a){this.session=Math.random(),this._onDidCreate=new L,this._onDidChange=new L,this._onDidDelete=new L,this._config=0,a.ignoreCreateEvents&&(this._config+=1),a.ignoreChangeEvents&&(this._config+=2),a.ignoreDeleteEvents&&(this._config+=4);const l=_u(o),c=typeof o=="string",u=s(d=>{if(!(typeof d.session=="number"&&d.session!==this.session)){if(!a.ignoreCreateEvents)for(const f of d.created){const p=y.revive(f);l(p.fsPath)&&(!c||i.getWorkspaceFolder(p))&&this._onDidCreate.fire(p)}if(!a.ignoreChangeEvents)for(const f of d.changed){const p=y.revive(f);l(p.fsPath)&&(!c||i.getWorkspaceFolder(p))&&this._onDidChange.fire(p)}if(!a.ignoreDeleteEvents)for(const f of d.deleted){const p=y.revive(f);l(p.fsPath)&&(!c||i.getWorkspaceFolder(p))&&this._onDidDelete.fire(p)}}});this._disposable=je.from(this.ensureWatching(e,i,t,r,o,a,!1),this._onDidCreate,this._onDidChange,this._onDidDelete,u)}ensureWatching(e,t,i,r,s,o,a){const l=je.from();if(typeof s=="string"||o.ignoreChangeEvents&&o.ignoreCreateEvents&&o.ignoreDeleteEvents)return l;const c=e.getProxy(Z.MainThreadFileSystemEventService);let u=!1;(s.pattern.includes(da)||s.pattern.includes(_w))&&(u=!0);const d=[];let f,p;if(a)(o.ignoreChangeEvents||o.ignoreCreateEvents||o.ignoreDeleteEvents)&&(p=Xs.UPDATED|Xs.ADDED|Xs.DELETED,o.ignoreChangeEvents&&(p&=~Xs.UPDATED),o.ignoreCreateEvents&&(p&=~Xs.ADDED),o.ignoreDeleteEvents&&(p&=~Xs.DELETED));else if(u&&d.length===0){const w=t.getWorkspaceFolder(y.revive(s.baseUri)),v=i.getConfiguration("files",w).get("watcherExclude");if(v)for(const m in v)m&&v[m]===!0&&d.push(m)}else if(!u){const w=t.getWorkspaceFolder(y.revive(s.baseUri));if(w){const v=i.getConfiguration("files",w).get("watcherExclude");if(v){for(const m in v)if(m&&v[m]===!0){const x=`${qv(m,"/")}/${da}`;f||(f=[]),f.push(pO(w.uri.fsPath,x))}}if(!f||f.length===0)return l}}return c.$watch(r.identifier.value,this.session,s.baseUri,{recursive:u,excludes:d,includes:f,filter:p},!!a),je.from({dispose:()=>c.$unwatch(this.session)})}dispose(){this._disposable.dispose()}get onDidCreate(){return this._onDidCreate.event}get onDidChange(){return this._onDidChange.event}get onDidDelete(){return this._onDidDelete.event}}class mO{get created(){return this._created.value}get changed(){return this._changed.value}get deleted(){return this._deleted.value}constructor(e){this._events=e,this._created=new Ci(()=>this._events.created.map(y.revive)),this._changed=new Ci(()=>this._events.changed.map(y.revive)),this._deleted=new Ci(()=>this._events.deleted.map(y.revive)),this.session=this._events.session}}class _O{constructor(e,t,i){this._mainContext=e,this._logService=t,this._extHostDocumentsAndEditors=i,this._onFileSystemEvent=new L,this._onDidRenameFile=new L,this._onDidCreateFile=new L,this._onDidDeleteFile=new L,this._onWillRenameFile=new Td,this._onWillCreateFile=new Td,this._onWillDeleteFile=new Td,this.onDidRenameFile=this._onDidRenameFile.event,this.onDidCreateFile=this._onDidCreateFile.event,this.onDidDeleteFile=this._onDidDeleteFile.event}createFileSystemWatcher(e,t,i,r,s){return new gO(this._mainContext,t,e,i,this._onFileSystemEvent.event,di.from(r),s)}$onFileEvent(e){this._onFileSystemEvent.fire(new mO(e))}$onDidRunFileOperation(e,t){switch(e){case xr.MOVE:this._onDidRenameFile.fire(Object.freeze({files:t.map(i=>({oldUri:y.revive(i.source),newUri:y.revive(i.target)}))}));break;case xr.DELETE:this._onDidDeleteFile.fire(Object.freeze({files:t.map(i=>y.revive(i.target))}));break;case xr.CREATE:case xr.COPY:this._onDidCreateFile.fire(Object.freeze({files:t.map(i=>y.revive(i.target))}));break}}getOnWillRenameFileEvent(e){return this._createWillExecuteEvent(e,this._onWillRenameFile)}getOnWillCreateFileEvent(e){return this._createWillExecuteEvent(e,this._onWillCreateFile)}getOnWillDeleteFileEvent(e){return this._createWillExecuteEvent(e,this._onWillDeleteFile)}_createWillExecuteEvent(e,t){return(i,r,s)=>{const o=function(l){i.call(r,l)};return o.extension=e,t.event(o,void 0,s)}}async $onWillRunFileOperation(e,t,i,r){switch(e){case xr.MOVE:return await this._fireWillEvent(this._onWillRenameFile,{files:t.map(s=>({oldUri:y.revive(s.source),newUri:y.revive(s.target)}))},i,r);case xr.DELETE:return await this._fireWillEvent(this._onWillDeleteFile,{files:t.map(s=>y.revive(s.target))},i,r);case xr.CREATE:case xr.COPY:return await this._fireWillEvent(this._onWillCreateFile,{files:t.map(s=>y.revive(s.target))},i,r)}}async _fireWillEvent(e,t,i,r){const s=new Set,o=[];if(await e.fireAsync(t,r,async(l,c)=>{const u=Date.now(),d=await Promise.resolve(l);d instanceof _l&&(o.push([c.extension,d]),s.add(c.extension.displayName??c.extension.identifier.value)),Date.now()-u>i&&this._logService.warn("SLOW file-participant",c.extension.identifier)}),r.isCancellationRequested||o.length===0)return;const a={edits:[]};for(const[,l]of o){const{edits:c}=gi.from(l,{getTextDocumentVersion:u=>{var d;return(d=this._extHostDocumentsAndEditors.getDocument(u))==null?void 0:d.version},getNotebookDocumentVersion:()=>{}});a.edits=a.edits.concat(c)}return{edit:a,extensionNames:Array.from(s)}}}class vO{constructor(e,t,i,r,s){this._extHostNotebooks=t,this._textDocumentsAndEditors=i,this._commands=r;const o=new ke("interactive.open","_interactive.open","Open interactive window and return notebook editor and input URI",[new q("showOptions","Show Options",a=>!0,a=>a),new q("resource","Interactive resource Uri",a=>!0,a=>a),new q("controllerId","Notebook controller Id",a=>!0,a=>a),new q("title","Interactive editor title",a=>!0,a=>a)],new be("Notebook and input URI",a=>{if(s.debug("[ExtHostInteractive] open iw with notebook editor id",a.notebookEditorId),a.notebookEditorId!==void 0){const l=this._extHostNotebooks.getEditorById(a.notebookEditorId);return s.debug("[ExtHostInteractive] notebook editor found",l.id),{notebookUri:y.revive(a.notebookUri),inputUri:y.revive(a.inputUri),notebookEditor:l.apiEditor}}return s.debug("[ExtHostInteractive] notebook editor not found, uris for the interactive document",a.notebookUri,a.inputUri),{notebookUri:y.revive(a.notebookUri),inputUri:y.revive(a.inputUri)}}));this._commands.registerApiCommand(o)}$willAddInteractiveDocument(e,t,i,r){this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({addedDocuments:[{EOL:t,lines:[""],languageId:i,uri:e,isDirty:!1,versionId:1,encoding:"utf8"}]})}$willRemoveInteractiveDocument(e,t){this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({removedDocuments:[e]})}}class wO{constructor(e){this._handlePool=0,this._proxy=e.getProxy(Z.MainThreadLabelService)}$registerResourceLabelFormatter(e){const t=this._handlePool++;return this._proxy.$registerResourceLabelFormatter(t,e),Se(()=>{this._proxy.$unregisterResourceLabelFormatter(t)})}}var eo;(function(n){n[n.LTR=0]="LTR",n[n.RTL=1]="RTL"})(eo||(eo={}));class wi extends lt{constructor(e,t,i,r){super(e,t,i,r),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=i,this.positionColumn=r}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return wi.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?eo.LTR:eo.RTL}setEndPosition(e,t){return this.getDirection()===eo.LTR?new wi(this.startLineNumber,this.startColumn,e,t):new wi(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new Ii(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new Ii(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(e,t){return this.getDirection()===eo.LTR?new wi(e,t,this.endLineNumber,this.endColumn):new wi(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new wi(e.lineNumber,e.column,t.lineNumber,t.column)}static fromRange(e,t){return t===eo.LTR?new wi(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):new wi(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn)}static liftSelection(e){return new wi(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let i=0,r=e.length;i<r;i++)if(!this.selectionsEqual(e[i],t[i]))return!1;return!0}static isISelection(e){return e&&typeof e.selectionStartLineNumber=="number"&&typeof e.selectionStartColumn=="number"&&typeof e.positionLineNumber=="number"&&typeof e.positionColumn=="number"}static createWithDirection(e,t,i,r,s){return s===eo.LTR?new wi(e,t,i,r):new wi(i,r,e,t)}}class y1{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentSymbols(e,t){const i=this._documents.getDocument(e),r=await this._provider.provideDocumentSymbols(i,t);if(!ox(r))return r[0]instanceof kh?r.map(Lb.from):y1._asDocumentSymbolTree(r)}static _asDocumentSymbolTree(e){var r,s;e=e.slice(0).sort((o,a)=>{let l=o.location.range.start.compareTo(a.location.range.start);return l===0&&(l=a.location.range.end.compareTo(o.location.range.end)),l});const t=[],i=[];for(const o of e){const a={name:o.name||"!!MISSING: name!!",kind:Wi.from(o.kind),tags:((r=o.tags)==null?void 0:r.map(Us.from))||[],detail:"",containerName:o.containerName,range:W.from(o.location.range),selectionRange:W.from(o.location.range),children:[]};for(;;){if(i.length===0){i.push(a),t.push(a);break}const l=i[i.length-1];if(lt.containsRange(l.range,a.range)&&!lt.equalsRange(l.range,a.range)){(s=l.children)==null||s.push(a),i.push(a);break}i.pop()}}return t}}class gp{constructor(e,t,i,r,s,o){this._documents=e,this._commands=t,this._provider=i,this._extension=r,this._extTelemetry=s,this._logService=o,this._cache=new Ai("CodeLens"),this._disposables=new Map}async provideCodeLenses(e,t){const i=this._documents.getDocument(e),r=await this._provider.provideCodeLenses(i,t);if(!r||t.isCancellationRequested)return;const s=this._cache.add(r),o=new Ie;this._disposables.set(s,o);const a={cacheId:s,lenses:[]};for(let l=0;l<r.length;l++){if(!Oe.isRange(r[l].range)){console.warn("INVALID code lens, range is not defined",this._extension.identifier.value);continue}a.lenses.push({cacheId:[s,l],range:W.from(r[l].range),command:this._commands.toInternal(r[l].command,o)})}return a}async resolveCodeLens(e,t){const i=e.cacheId&&this._cache.get(...e.cacheId);if(!i)return;let r;if(typeof this._provider.resolveCodeLens!="function"||i.isResolved?r=i:r=await this._provider.resolveCodeLens(i,t),r||(r=i),t.isCancellationRequested)return;const s=e.cacheId&&this._disposables.get(e.cacheId[0]);if(s){if(!r.command){const o=new Error("INVALID code lens resolved, lacks command: "+this._extension.identifier.value);this._extTelemetry.onExtensionError(this._extension.identifier,o),this._logService.error(o);return}return e.command=this._commands.toInternal(r.command,s),e}}releaseCodeLenses(e){var t;(t=this._disposables.get(e))==null||t.dispose(),this._disposables.delete(e),this._cache.delete(e)}}function T_(n){return Array.isArray(n)?n.map(nf.from):n?[nf.from(n)]:[]}class nk{constructor(e,t){this._documents=e,this._provider=t}async provideDefinition(e,t,i){const r=this._documents.getDocument(e),s=nt.to(t),o=await this._provider.provideDefinition(r,s,i);return T_(o)}}class ik{constructor(e,t){this._documents=e,this._provider=t}async provideDeclaration(e,t,i){const r=this._documents.getDocument(e),s=nt.to(t),o=await this._provider.provideDeclaration(r,s,i);return T_(o)}}class rk{constructor(e,t){this._documents=e,this._provider=t}async provideImplementation(e,t,i){const r=this._documents.getDocument(e),s=nt.to(t),o=await this._provider.provideImplementation(r,s,i);return T_(o)}}class sk{constructor(e,t){this._documents=e,this._provider=t}async provideTypeDefinition(e,t,i){const r=this._documents.getDocument(e),s=nt.to(t),o=await this._provider.provideTypeDefinition(r,s,i);return T_(o)}}const q1=class q1{constructor(e,t){this._documents=e,this._provider=t,this._hoverCounter=0,this._hoverMap=new Map}async provideHover(e,t,i,r){const s=this._documents.getDocument(e),o=nt.to(t);let a;if(i&&i.verbosityRequest){const d=i.verbosityRequest.previousHover.id,f=this._hoverMap.get(d);if(!f)throw new Error(`Hover with id ${d} not found`);const p={verbosityDelta:i.verbosityRequest.verbosityDelta,previousHover:f};a=await this._provider.provideHover(s,o,r,p)}else a=await this._provider.provideHover(s,o,r);if(!a||ox(a.contents))return;a.range||(a.range=s.getWordRangeAtPosition(o)),a.range||(a.range=new Oe(o,o));const l=rf.from(a),c=this._hoverCounter;if(this._hoverMap.size===q1.HOVER_MAP_MAX_SIZE){const d=Math.min(...this._hoverMap.keys());this._hoverMap.delete(d)}return this._hoverMap.set(c,a),this._hoverCounter+=1,{...l,id:c}}releaseHover(e){this._hoverMap.delete(e)}};q1.HOVER_MAP_MAX_SIZE=10;let th=q1;class ok{constructor(e,t){this._documents=e,this._provider=t}async provideEvaluatableExpression(e,t,i){const r=this._documents.getDocument(e),s=nt.to(t),o=await this._provider.provideEvaluatableExpression(r,s,i);if(o)return Fb.from(o)}}class ak{constructor(e,t){this._documents=e,this._provider=t}async provideInlineValues(e,t,i,r){const s=this._documents.getDocument(e),o=await this._provider.provideInlineValues(s,W.to(t),Pm.to(i),r);if(Array.isArray(o))return o.map(a=>Cm.from(a))}}class lk{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentHighlights(e,t,i){const r=this._documents.getDocument(e),s=nt.to(t),o=await this._provider.provideDocumentHighlights(r,s,i);if(Array.isArray(o))return o.map(Ru.from)}}class ck{constructor(e,t,i){this._documents=e,this._provider=t,this._logService=i}async provideMultiDocumentHighlights(e,t,i,r){const s=this._documents.getDocument(e),o=i.map(c=>{try{return this._documents.getDocument(c)}catch(u){this._logService.error("Error: Unable to retrieve document from URI: "+c+". Error message: "+u);return}}).filter(c=>c!==void 0),a=nt.to(t),l=await this._provider.provideMultiDocumentHighlights(s,a,o,r);if(Array.isArray(l))return l.map(Mb.from)}}class uk{constructor(e,t){this._documents=e,this._provider=t}async provideLinkedEditingRanges(e,t,i){const r=this._documents.getDocument(e),s=nt.to(t),o=await this._provider.provideLinkedEditingRanges(r,s,i);if(o&&Array.isArray(o.ranges))return{ranges:sn(o.ranges.map(W.from)),wordPattern:o.wordPattern}}}class dk{constructor(e,t){this._documents=e,this._provider=t}async provideReferences(e,t,i,r){const s=this._documents.getDocument(e),o=nt.to(t),a=await this._provider.provideReferences(s,o,i,r);if(Array.isArray(a))return a.map(ii.from)}}const yc=class yc{constructor(e,t,i,r,s,o,a){this._documents=e,this._commands=t,this._diagnostics=i,this._provider=r,this._logService=s,this._extension=o,this._apiDeprecation=a,this._cache=new Ai("CodeAction"),this._disposables=new Map}async provideCodeActions(e,t,i,r){var p;const s=this._documents.getDocument(e),o=wi.isISelection(t)?pr.to(t):W.to(t),a=[];for(const w of this._diagnostics.getDiagnostics(e))if(o.intersection(w.range)&&a.push(w)>yc._maxCodeActionsPerFile)break;const l={diagnostics:a,only:i.only?new Tt(i.only):void 0,triggerKind:Zb.to(i.trigger)},c=await this._provider.provideCodeActions(s,o,l,r);if(!ju(c)||r.isCancellationRequested)return;const u=this._cache.add(c),d=new Ie;this._disposables.set(u,d);const f=[];for(let w=0;w<c.length;w++){const v=c[w];if(v)if(yc._isCommand(v)&&!(v instanceof Ch))this._apiDeprecation.report("CodeActionProvider.provideCodeActions - return commands",this._extension,"Return 'CodeAction' instances instead."),f.push({_isSynthetic:!0,title:v.title,command:this._commands.toInternal(v,d)});else{const m=v;l.only&&(m.kind?l.only.contains(m.kind)||this._logService.warn(`${this._extension.identifier.value} - Code actions of kind '${l.only.value}' requested but returned code action is of kind '${m.kind.value}'. Code action will be dropped. Please check 'CodeActionContext.only' to only return requested code actions.`):this._logService.warn(`${this._extension.identifier.value} - Code actions of kind '${l.only.value}' requested but returned code action does not have a 'kind'. Code action will be dropped. Please set 'CodeAction.kind'.`));const x=m.ranges??[];f.push({cacheId:[u,w],title:m.title,command:m.command&&this._commands.toInternal(m.command,d),diagnostics:m.diagnostics&&m.diagnostics.map(Tu.from),edit:m.edit&&gi.from(m.edit,void 0),kind:m.kind&&m.kind.value,isPreferred:m.isPreferred,isAI:vt(this._extension,"codeActionAI")?m.isAI:!1,ranges:vt(this._extension,"codeActionRanges")?sn(x.map(W.from)):void 0,disabled:(p=m.disabled)==null?void 0:p.reason})}}return{cacheId:u,actions:f}}async resolveCodeAction(e,t){const[i,r]=e,s=this._cache.get(i,r);if(!s||yc._isCommand(s))return{};if(!this._provider.resolveCodeAction)return{};const o=await this._provider.resolveCodeAction(s,t)??s;let a;o.edit&&(a=gi.from(o.edit,void 0));let l;if(o.command){const c=this._disposables.get(i);c&&(l=this._commands.toInternal(o.command,c))}return{edit:a,command:l}}releaseCodeActions(e){var t;(t=this._disposables.get(e))==null||t.dispose(),this._disposables.delete(e),this._cache.delete(e)}static _isCommand(e){return typeof e.command=="string"&&typeof e.title=="string"}};yc._maxCodeActionsPerFile=1e3;let cc=yc;class vd{constructor(e,t,i,r,s){this._proxy=e,this._documents=t,this._provider=i,this._handle=r,this._extension=s,this._editsCache=new Ai("DocumentPasteEdit.edits")}async prepareDocumentPaste(e,t,i,r){if(!this._provider.prepareDocumentPaste)return;this._cachedPrepare=void 0;const s=this._documents.getDocument(e),o=t.map(d=>W.to(d)),a=Hu.toDataTransfer(i,()=>{throw new N7});if(await this._provider.prepareDocumentPaste(s,o,a,r),r.isCancellationRequested)return;const l=Array.from(a).filter(([,d])=>!(d instanceof rm)),c=new Map,u=await Promise.all(Array.from(l,async([d,f])=>{const p=Mn();return c.set(p,f),[d,await Ka.from(d,f,p)]}));return this._cachedPrepare=c,{items:u}}async providePasteEdits(e,t,i,r,s,o){if(!this._provider.provideDocumentPasteEdits)return[];const a=this._documents.getDocument(t),l=i.map(p=>W.to(p)),c=r.items.map(([p,w])=>{var m;const v=(m=this._cachedPrepare)==null?void 0:m.get(w.id);return v?[p,v]:[p,Ka.to(p,w,async x=>(await this._proxy.$resolvePasteFileData(this._handle,e,x)).buffer)]}),u=new Su(c),d=await this._provider.provideDocumentPasteEdits(a,l,u,{only:s.only?new zr(s.only):void 0,triggerKind:s.triggerKind},o);if(!d||o.isCancellationRequested)return[];const f=this._editsCache.add(d);return d.map((p,w)=>{var v;return{_cacheId:[f,w],title:p.title??h(2540,"Paste using '{0}' extension",this._extension.displayName||this._extension.name),kind:p.kind,yieldTo:(v=p.yieldTo)==null?void 0:v.map(m=>m.value),insertText:typeof p.insertText=="string"?p.insertText:{snippet:p.insertText.value},additionalEdit:p.additionalEdit?gi.from(p.additionalEdit,void 0):void 0}})}async resolvePasteEdit(e,t){const[i,r]=e,s=this._editsCache.get(i,r);if(!s||!this._provider.resolveDocumentPasteEdit)return{};const o=await this._provider.resolveDocumentPasteEdit(s,t)??s;return{insertText:o.insertText,additionalEdit:o.additionalEdit?gi.from(o.additionalEdit,void 0):void 0}}releasePasteEdits(e){this._editsCache.delete(e)}}class hk{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentFormattingEdits(e,t,i){const r=this._documents.getDocument(e),s=await this._provider.provideDocumentFormattingEdits(r,t,i);if(Array.isArray(s))return s.map(rn.from)}}class yv{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentRangeFormattingEdits(e,t,i,r){const s=this._documents.getDocument(e),o=W.to(t),a=await this._provider.provideDocumentRangeFormattingEdits(s,o,i,r);if(Array.isArray(a))return a.map(rn.from)}async provideDocumentRangesFormattingEdits(e,t,i,r){uI(typeof this._provider.provideDocumentRangesFormattingEdits=="function","INVALID invocation of `provideDocumentRangesFormattingEdits`");const s=this._documents.getDocument(e),o=t.map(W.to),a=await this._provider.provideDocumentRangesFormattingEdits(s,o,i,r);if(Array.isArray(a))return a.map(rn.from)}}class fk{constructor(e,t){this._documents=e,this._provider=t,this.autoFormatTriggerCharacters=[]}async provideOnTypeFormattingEdits(e,t,i,r,s){const o=this._documents.getDocument(e),a=nt.to(t),l=await this._provider.provideOnTypeFormattingEdits(o,a,i,r,s);if(Array.isArray(l))return l.map(rn.from)}}class mp{constructor(e,t){this._provider=e,this._logService=t,this._cache=new Ai("WorkspaceSymbols")}async provideWorkspaceSymbols(e,t){const i=await this._provider.provideWorkspaceSymbols(e,t);if(!ju(i))return{symbols:[]};const r=this._cache.add(i),s={cacheId:r,symbols:[]};for(let o=0;o<i.length;o++){const a=i[o];if(!a||!a.name){this._logService.warn("INVALID SymbolInformation",a);continue}s.symbols.push({...yl.from(a),cacheId:[r,o]})}return s}async resolveWorkspaceSymbol(e,t){if(typeof this._provider.resolveWorkspaceSymbol!="function"||!e.cacheId)return e;const i=this._cache.get(...e.cacheId);if(i){const r=await this._provider.resolveWorkspaceSymbol(i,t);return r&&gl(e,yl.from(r),!0)}}releaseWorkspaceSymbols(e){this._cache.delete(e)}}class ya{static supportsResolving(e){return typeof e.prepareRename=="function"}constructor(e,t,i){this._documents=e,this._provider=t,this._logService=i}async provideRenameEdits(e,t,i,r){const s=this._documents.getDocument(e),o=nt.to(t);try{const a=await this._provider.provideRenameEdits(s,o,i,r);return a?gi.from(a):void 0}catch(a){const l=ya._asMessage(a);return l?{rejectReason:l,edits:void 0}:Promise.reject(a)}}async resolveRenameLocation(e,t,i){if(typeof this._provider.prepareRename!="function")return Promise.resolve(void 0);const r=this._documents.getDocument(e),s=nt.to(t);try{const o=await this._provider.prepareRename(r,s,i);let a,l;if(Oe.isRange(o)?(a=o,l=r.getText(o)):Zt(o)&&(a=o.range,l=o.placeholder),!a||!l)return;if(a.start.line>s.line||a.end.line<s.line){this._logService.warn("INVALID rename location: position line must be within range start/end lines");return}return{range:W.from(a),text:l}}catch(o){const a=ya._asMessage(o);return a?{rejectReason:a,range:void 0,text:void 0}:Promise.reject(o)}}static _asMessage(e){return typeof e=="string"?e:e instanceof Error&&typeof e.message=="string"?e.message:void 0}}const uh=class uh{constructor(e,t,i){this._documents=e,this._provider=t,this._logService=i}async supportsAutomaticNewSymbolNamesTriggerKind(){return this._provider.supportsAutomaticTriggerKind}async provideNewSymbolNames(e,t,i,r){const s=this._documents.getDocument(e),o=W.to(t);try{const a=uh.languageTriggerKindToVSCodeTriggerKind[i],l=await this._provider.provideNewSymbolNames(s,o,a,r);return l?l.map(c=>typeof c=="string"?{newSymbolName:c}:{newSymbolName:c.newSymbolName,tags:c.tags}):void 0}catch(a){this._logService.error(uh._asMessage(a)??JSON.stringify(a,null,"	"));return}}static _asMessage(e){return typeof e=="string"?e:e instanceof Error&&typeof e.message=="string"?e.message:void 0}};uh.languageTriggerKindToVSCodeTriggerKind={[Eg.Invoke]:Uh.Invoke,[Eg.Automatic]:Uh.Automatic};let nh=uh;class xv{constructor(e,t){this.resultId=e,this.tokens=t}}class ai{constructor(e,t){this._documents=e,this._provider=t,this._nextResultId=1,this._previousResults=new Map}async provideDocumentSemanticTokens(e,t,i){const r=this._documents.getDocument(e),s=t!==0?this._previousResults.get(t):null;let o=typeof(s==null?void 0:s.resultId)=="string"&&typeof this._provider.provideDocumentSemanticTokensEdits=="function"?await this._provider.provideDocumentSemanticTokensEdits(r,s.resultId,i):await this._provider.provideDocumentSemanticTokens(r,i);return s&&this._previousResults.delete(t),o?(o=ai._fixProvidedSemanticTokens(o),this._send(ai._convertToEdits(s,o),o)):null}async releaseDocumentSemanticColoring(e){this._previousResults.delete(e)}static _fixProvidedSemanticTokens(e){return ai._isSemanticTokens(e)?ai._isCorrectSemanticTokens(e)?e:new ku(new Uint32Array(e.data),e.resultId):ai._isSemanticTokensEdits(e)?ai._isCorrectSemanticTokensEdits(e)?e:new Fp(e.edits.map(t=>new jC(t.start,t.deleteCount,t.data?new Uint32Array(t.data):t.data)),e.resultId):e}static _isSemanticTokens(e){return e&&!!e.data}static _isCorrectSemanticTokens(e){return e.data instanceof Uint32Array}static _isSemanticTokensEdits(e){return e&&Array.isArray(e.edits)}static _isCorrectSemanticTokensEdits(e){for(const t of e.edits)if(!(t.data instanceof Uint32Array))return!1;return!0}static _convertToEdits(e,t){if(!ai._isSemanticTokens(t)||!e||!e.tokens)return t;const i=e.tokens,r=i.length,s=t.data,o=s.length;let a=0;const l=Math.min(r,o);for(;a<l&&i[a]===s[a];)a++;if(a===r&&a===o)return new Fp([],t.resultId);let c=0;const u=l-a;for(;c<u&&i[r-c-1]===s[o-c-1];)c++;return new Fp([{start:a,deleteCount:r-a-c,data:s.subarray(a,o-c)}],t.resultId)}_send(e,t){if(ai._isSemanticTokens(e)){const i=this._nextResultId++;return this._previousResults.set(i,new xv(e.resultId,e.data)),gy({id:i,type:"full",data:e.data})}if(ai._isSemanticTokensEdits(e)){const i=this._nextResultId++;return ai._isSemanticTokens(t)?this._previousResults.set(i,new xv(t.resultId,t.data)):this._previousResults.set(i,new xv(e.resultId)),gy({id:i,type:"delta",deltas:(e.edits||[]).map(r=>({start:r.start,deleteCount:r.deleteCount,data:r.data}))})}return null}}class pk{constructor(e,t){this._documents=e,this._provider=t}async provideDocumentRangeSemanticTokens(e,t,i){const r=this._documents.getDocument(e),s=await this._provider.provideDocumentRangeSemanticTokens(r,W.to(t),i);return s?this._send(s):null}_send(e){return gy({id:0,type:"full",data:e.data})}}class Ko{static supportsResolving(e){return typeof e.resolveCompletionItem=="function"}constructor(e,t,i,r,s){this._documents=e,this._commands=t,this._provider=i,this._apiDeprecation=r,this._extension=s,this._cache=new Ai("CompletionItem"),this._disposables=new Map}async provideCompletionItems(e,t,i,r){const s=this._documents.getDocument(e),o=nt.to(t),a=s.getWordRangeAtPosition(o)||new Oe(o,o),l=a.with({end:o}),c=new Os,u=await this._provider.provideCompletionItems(s,o,r,Ub.to(i));if(!u||r.isCancellationRequested)return;const d=Array.isArray(u)?new wu(u):u,f=Ko.supportsResolving(this._provider)?this._cache.add(d.items):this._cache.add([]),p=new Ie;this._disposables.set(f,p);const w=[],v={x:f,[Zl.completions]:w,[Zl.defaultRanges]:{replace:W.from(a),insert:W.from(l)},[Zl.isIncomplete]:d.isIncomplete||void 0,[Zl.duration]:c.elapsed()};for(let m=0;m<d.items.length;m++){const x=d.items[m],k=this._convertCompletionItem(x,[f,m],l,a);w.push(k)}return v}async resolveCompletionItem(e,t){if(typeof this._provider.resolveCompletionItem!="function")return;const i=this._cache.get(...e);if(!i)return;const r=this._convertCompletionItem(i,e),s=await this._provider.resolveCompletionItem(i,t);if(!s)return;const o=this._convertCompletionItem(s,e);return(r[Fe.insertText]!==o[Fe.insertText]||r[Fe.insertTextRules]!==o[Fe.insertTextRules])&&this._apiDeprecation.report("CompletionItem.insertText",this._extension,"extension MAY NOT change 'insertText' of a CompletionItem during resolve"),(r[Fe.commandIdent]!==o[Fe.commandIdent]||r[Fe.commandId]!==o[Fe.commandId]||!fi(r[Fe.commandArguments],o[Fe.commandArguments]))&&this._apiDeprecation.report("CompletionItem.command",this._extension,"extension MAY NOT change 'command' of a CompletionItem during resolve"),{...r,[Fe.documentation]:o[Fe.documentation],[Fe.detail]:o[Fe.detail],[Fe.additionalTextEdits]:o[Fe.additionalTextEdits],[Fe.insertText]:o[Fe.insertText],[Fe.insertTextRules]:o[Fe.insertTextRules],[Fe.commandIdent]:o[Fe.commandIdent],[Fe.commandId]:o[Fe.commandId],[Fe.commandArguments]:o[Fe.commandArguments]}}releaseCompletionItems(e){var t;(t=this._disposables.get(e))==null||t.dispose(),this._disposables.delete(e),this._cache.delete(e)}_convertCompletionItem(e,t,i,r){var c;const s=this._disposables.get(t[0]);if(!s)throw Error("DisposableStore is missing...");const o=this._commands.toInternal(e.command,s),a={x:t,[Fe.label]:e.label,[Fe.kind]:e.kind!==void 0?Am.from(e.kind):void 0,[Fe.kindModifier]:e.tags&&e.tags.map(Tm.from),[Fe.detail]:e.detail,[Fe.documentation]:typeof e.documentation>"u"?void 0:Le.fromStrict(e.documentation),[Fe.sortText]:e.sortText!==e.label?e.sortText:void 0,[Fe.filterText]:e.filterText!==e.label?e.filterText:void 0,[Fe.preselect]:e.preselect||void 0,[Fe.insertTextRules]:e.keepWhitespace?za.KeepWhitespace:za.None,[Fe.commitCharacters]:(c=e.commitCharacters)==null?void 0:c.join(""),[Fe.additionalTextEdits]:e.additionalTextEdits&&e.additionalTextEdits.map(rn.from),[Fe.commandIdent]:o==null?void 0:o.$ident,[Fe.commandId]:o==null?void 0:o.id,[Fe.commandArguments]:o!=null&&o.$ident||o==null?void 0:o.arguments};e.textEdit?(this._apiDeprecation.report("CompletionItem.textEdit",this._extension,"Use 'CompletionItem.insertText' and 'CompletionItem.range' instead."),a[Fe.insertText]=e.textEdit.newText):typeof e.insertText=="string"?a[Fe.insertText]=e.insertText:e.insertText instanceof vl&&(a[Fe.insertText]=e.insertText.value,a[Fe.insertTextRules]|=za.InsertAsSnippet);let l;return e.textEdit?l=e.textEdit.range:e.range&&(l=e.range),Oe.isRange(l)?a[Fe.range]=W.from(l):l&&(!(i!=null&&i.isEqual(l.inserting))||!(r!=null&&r.isEqual(l.replacing)))&&(a[Fe.range]={insert:W.from(l.inserting),replace:W.from(l.replacing)}),a}}class Bo{constructor(e,t,i,r){this._extension=e,this._documents=t,this._provider=i,this._commands=r,this._references=new d7,this._isAdditionsProposedApiEnabled=vt(this._extension,"inlineCompletionsAdditions"),this.languageTriggerKindToVSCodeTriggerKind={[bg.Automatic]:$h.Automatic,[bg.Explicit]:$h.Invoke}}get supportsHandleEvents(){return vt(this._extension,"inlineCompletionsAdditions")&&(typeof this._provider.handleDidShowCompletionItem=="function"||typeof this._provider.handleDidPartiallyAcceptCompletionItem=="function"||typeof this._provider.handleDidRejectCompletionItem=="function")}async provideInlineCompletions(e,t,i,r){const s=this._documents.getDocument(e),o=nt.to(t),a=await this._provider.provideInlineCompletionItems(s,o,{selectedCompletionInfo:i.selectedSuggestionInfo?{range:W.to(i.selectedSuggestionInfo.range),text:i.selectedSuggestionInfo.text}:void 0,triggerKind:this.languageTriggerKindToVSCodeTriggerKind[i.triggerKind],requestUuid:i.requestUuid},r);if(!a||r.isCancellationRequested)return;const l=Array.isArray(a)?a:a.items,c=this._isAdditionsProposedApiEnabled?Array.isArray(a)?[]:a.commands||[]:[],u=this._isAdditionsProposedApiEnabled&&!Array.isArray(a)?a.enableForwardStability:void 0;let d;return{pid:this._references.createReferenceId({dispose(){d==null||d.dispose()},items:l}),items:l.map((p,w)=>{let v;p.command&&(d||(d=new Ie),v=this._commands.toInternal(p.command,d));let m;p.action&&(d||(d=new Ie),m=this._commands.toInternal(p.action,d));const x=p.insertText;return{insertText:typeof x=="string"?x:{snippet:x.value},filterText:p.filterText,range:p.range?W.from(p.range):void 0,showRange:this._isAdditionsProposedApiEnabled&&p.showRange?W.from(p.showRange):void 0,command:v,action:m,idx:w,completeBracketPairs:this._isAdditionsProposedApiEnabled?p.completeBracketPairs:!1,isInlineEdit:this._isAdditionsProposedApiEnabled?p.isInlineEdit:!1,showInlineEditMenu:this._isAdditionsProposedApiEnabled?p.showInlineEditMenu:!1,warning:p.warning&&this._isAdditionsProposedApiEnabled?{message:Le.from(p.warning.message),icon:p.warning.icon?u0.fromThemeIcon(p.warning.icon):void 0}:void 0}}),commands:c.map(p=>(d||(d=new Ie),this._commands.toInternal(p,d))),suppressSuggestions:!1,enableForwardStability:u}}async provideInlineEditsForRange(e,t,i,r){if(!this._provider.provideInlineEditsForRange)return;$(this._extension,"inlineCompletionsAdditions");const s=this._documents.getDocument(e),o=W.to(t),a=await this._provider.provideInlineEditsForRange(s,o,{selectedCompletionInfo:i.selectedSuggestionInfo?{range:W.to(i.selectedSuggestionInfo.range),text:i.selectedSuggestionInfo.text}:void 0,triggerKind:this.languageTriggerKindToVSCodeTriggerKind[i.triggerKind],userPrompt:i.userPrompt,requestUuid:i.requestUuid},r);if(!a||r.isCancellationRequested)return;const l=Array.isArray(a)?a:a.items,c=this._isAdditionsProposedApiEnabled?Array.isArray(a)?[]:a.commands||[]:[],u=this._isAdditionsProposedApiEnabled&&!Array.isArray(a)?a.enableForwardStability:void 0;let d;return{pid:this._references.createReferenceId({dispose(){d==null||d.dispose()},items:l}),items:l.map((p,w)=>{let v;p.command&&(d||(d=new Ie),v=this._commands.toInternal(p.command,d));let m;p.action&&(d||(d=new Ie),m=this._commands.toInternal(p.action,d));const x=p.insertText;return{insertText:typeof x=="string"?x:{snippet:x.value},filterText:p.filterText,range:p.range?W.from(p.range):void 0,command:v,action:m,idx:w,completeBracketPairs:this._isAdditionsProposedApiEnabled?p.completeBracketPairs:!1}}),commands:c.map(p=>(d||(d=new Ie),this._commands.toInternal(p,d))),suppressSuggestions:!1,enableForwardStability:u}}disposeCompletions(e){const t=this._references.disposeReferenceId(e);t==null||t.dispose()}handleDidShowCompletionItem(e,t,i){var s;const r=(s=this._references.get(e))==null?void 0:s.items[t];r&&this._provider.handleDidShowCompletionItem&&this._isAdditionsProposedApiEnabled&&this._provider.handleDidShowCompletionItem(r,i)}handlePartialAccept(e,t,i,r){var o;const s=(o=this._references.get(e))==null?void 0:o.items[t];s&&this._provider.handleDidPartiallyAcceptCompletionItem&&this._isAdditionsProposedApiEnabled&&(this._provider.handleDidPartiallyAcceptCompletionItem(s,i),this._provider.handleDidPartiallyAcceptCompletionItem(s,o0.to(r)))}handleRejection(e,t){var r;const i=(r=this._references.get(e))==null?void 0:r.items[t];i&&this._provider.handleDidRejectCompletionItem&&this._isAdditionsProposedApiEnabled&&this._provider.handleDidRejectCompletionItem(i)}}class Ev{async provideInlineEdits(e,t,i){var p;const r=this._documents.getDocument(e),s=await this._provider.provideInlineEdit(r,{triggerKind:this.languageTriggerKindToVSCodeTriggerKind[t.triggerKind],requestUuid:t.requestUuid},i);if(!s||i.isCancellationRequested)return;let o;const a=this._references.createReferenceId({dispose(){o==null||o.dispose()},item:s});let l;s.accepted&&(o||(o=new Ie),l=this._commands.toInternal(s.accepted,o));let c;s.rejected&&(o||(o=new Ie),c=this._commands.toInternal(s.rejected,o));let u;s.shown&&(o||(o=new Ie),u=this._commands.toInternal(s.shown,o));let d;return s.action&&(o||(o=new Ie),d=this._commands.toInternal(s.action,o)),o||(o=new Ie),{pid:a,text:s.text,range:W.from(s.range),showRange:W.from(s.showRange),accepted:l,rejected:c,shown:u,action:d,commands:(p=s.commands)==null?void 0:p.map(w=>this._commands.toInternal(w,o))}}disposeEdit(e){const t=this._references.disposeReferenceId(e);t==null||t.dispose()}constructor(e,t,i,r){this._documents=t,this._provider=i,this._commands=r,this._references=new d7,this.languageTriggerKindToVSCodeTriggerKind={[Sg.Automatic]:ef.Automatic,[Sg.Invoke]:ef.Invoke}}}class d7{constructor(){this._references=new Map,this._idPool=1}createReferenceId(e){const t=this._idPool++;return this._references.set(t,e),t}disposeReferenceId(e){const t=this._references.get(e);return this._references.delete(e),t}get(e){return this._references.get(e)}}class Sv{constructor(e,t){this._documents=e,this._provider=t,this._cache=new Ai("SignatureHelp")}async provideSignatureHelp(e,t,i,r){const s=this._documents.getDocument(e),o=nt.to(t),a=this.reviveContext(i),l=await this._provider.provideSignatureHelp(s,o,r,a);if(l){const c=this._cache.add([l]);return{...sf.from(l),id:c}}}reviveContext(e){let t;if(e.activeSignatureHelp){const i=sf.to(e.activeSignatureHelp),r=this._cache.get(e.activeSignatureHelp.id,0);r?(t=r,t.activeSignature=i.activeSignature,t.activeParameter=i.activeParameter):t=i}return{...e,activeSignatureHelp:t}}releaseSignatureHelp(e){this._cache.delete(e)}}class _p{constructor(e,t,i,r,s){this._documents=e,this._commands=t,this._provider=i,this._logService=r,this._extension=s,this._cache=new Ai("InlayHints"),this._disposables=new Map}async provideInlayHints(e,t,i){const r=this._documents.getDocument(e),s=W.to(t),o=await this._provider.provideInlayHints(r,s,i);if(!Array.isArray(o)||o.length===0){this._logService.trace(`[InlayHints] NO inlay hints from '${this._extension.identifier.value}' for range ${JSON.stringify(t)}`);return}if(i.isCancellationRequested)return;const a=this._cache.add(o);this._disposables.set(a,new Ie);const l={hints:[],cacheId:a};for(let c=0;c<o.length;c++)this._isValidInlayHint(o[c],s)&&l.hints.push(this._convertInlayHint(o[c],[a,c]));return this._logService.trace(`[InlayHints] ${l.hints.length} inlay hints from '${this._extension.identifier.value}' for range ${JSON.stringify(t)}`),l}async resolveInlayHint(e,t){if(typeof this._provider.resolveInlayHint!="function")return;const i=this._cache.get(...e);if(!i)return;const r=await this._provider.resolveInlayHint(i,t);if(r&&this._isValidInlayHint(r))return this._convertInlayHint(r,e)}releaseHints(e){var t;(t=this._disposables.get(e))==null||t.dispose(),this._disposables.delete(e),this._cache.delete(e)}_isValidInlayHint(e,t){return e.label.length===0||Array.isArray(e.label)&&e.label.every(i=>i.value.length===0)?(console.log("INVALID inlay hint, empty label",e),!1):!(t&&!t.contains(e.position))}_convertInlayHint(e,t){const i=this._disposables.get(t[0]);if(!i)throw Error("DisposableStore is missing...");const r={label:"",cacheId:t,tooltip:Le.fromStrict(e.tooltip),position:nt.from(e.position),textEdits:e.textEdits&&e.textEdits.map(rn.from),kind:e.kind&&Nm.from(e.kind),paddingLeft:e.paddingLeft,paddingRight:e.paddingRight};if(typeof e.label=="string")r.label=e.label;else{const s=[];r.label=s;for(const o of e.label){if(!o.value){console.warn("INVALID inlay hint, empty label part",this._extension.identifier.value);continue}const a={label:o.value,tooltip:Le.fromStrict(o.tooltip)};Ti.isLocation(o.location)&&(a.location=ii.from(o.location)),o.command&&(a.command=this._commands.toInternal(o.command,i)),s.push(a)}}return r}}class xo{constructor(e,t){this._documents=e,this._provider=t,this._cache=new Ai("DocumentLink")}async provideLinks(e,t){const i=this._documents.getDocument(e),r=await this._provider.provideDocumentLinks(i,t);if(!(!Array.isArray(r)||r.length===0)&&!t.isCancellationRequested){if(typeof this._provider.resolveDocumentLink!="function")return{links:r.filter(xo._validateLink).map(Ya.from)};{const s=this._cache.add(r),o={links:[],cacheId:s};for(let a=0;a<r.length;a++){if(!xo._validateLink(r[a]))continue;const l=Ya.from(r[a]);l.cacheId=[s,a],o.links.push(l)}return o}}}static _validateLink(e){return e.target&&e.target.path.length>5e4?(console.warn("DROPPING link because it is too long"),!1):!0}async resolveLink(e,t){if(typeof this._provider.resolveDocumentLink!="function")return;const i=this._cache.get(...e);if(!i)return;const r=await this._provider.resolveDocumentLink(i,t);if(!(!r||!xo._validateLink(r)))return Ya.from(r)}releaseLinks(e){this._cache.delete(e)}}class Dv{constructor(e,t){this._documents=e,this._provider=t}async provideColors(e,t){const i=this._documents.getDocument(e),r=await this._provider.provideDocumentColors(i,t);return Array.isArray(r)?r.map(o=>({color:Lu.from(o.color),range:W.from(o.range)})):[]}async provideColorPresentations(e,t,i){const r=this._documents.getDocument(e),s=W.to(t.range),o=Lu.to(t.color),a=await this._provider.provideColorPresentations(o,{document:r,range:s},i);if(Array.isArray(a))return a.map(Om.from)}}class gk{constructor(e,t){this._documents=e,this._provider=t}async provideFoldingRanges(e,t,i){const r=this._documents.getDocument(e),s=await this._provider.provideFoldingRanges(r,t,i);if(Array.isArray(s))return s.map(Mm.from)}}class mk{constructor(e,t,i){this._documents=e,this._provider=t,this._logService=i}async provideSelectionRanges(e,t,i){const r=this._documents.getDocument(e),s=t.map(nt.to),o=await this._provider.provideSelectionRanges(r,s,i);if(!ju(o))return[];if(o.length!==s.length)return this._logService.warn("BAD selection ranges, provider must return ranges for each position"),[];const a=[];for(let l=0;l<s.length;l++){const c=[];a.push(c);let u=s[l],d=o[l];for(;;){if(!d.range.contains(u))throw new Error("INVALID selection range, must contain the previous range");if(c.push(Vb.from(d)),!d.parent)break;u=d.range,d=d.parent}}return a}}class wd{constructor(e,t){this._documents=e,this._provider=t,this._idPool=new o2(""),this._cache=new Map}async prepareSession(e,t,i){const r=this._documents.getDocument(e),s=nt.to(t),o=await this._provider.prepareCallHierarchy(r,s,i);if(!o)return;const a=this._idPool.nextId();return this._cache.set(a,new Map),Array.isArray(o)?o.map(l=>this._cacheAndConvertItem(a,l)):[this._cacheAndConvertItem(a,o)]}async provideCallsTo(e,t,i){const r=this._itemFromCache(e,t);if(!r)throw new Error("missing call hierarchy item");const s=await this._provider.provideCallHierarchyIncomingCalls(r,i);if(s)return s.map(o=>({from:this._cacheAndConvertItem(e,o.from),fromRanges:o.fromRanges.map(a=>W.from(a))}))}async provideCallsFrom(e,t,i){const r=this._itemFromCache(e,t);if(!r)throw new Error("missing call hierarchy item");const s=await this._provider.provideCallHierarchyOutgoingCalls(r,i);if(s)return s.map(o=>({to:this._cacheAndConvertItem(e,o.to),fromRanges:o.fromRanges.map(a=>W.from(a))}))}releaseSession(e){this._cache.delete(e)}_cacheAndConvertItem(e,t){const i=this._cache.get(e),r=xl.from(t,e,i.size.toString(36));return i.set(r._itemId,t),r}_itemFromCache(e,t){const i=this._cache.get(e);return i==null?void 0:i.get(t)}}class bd{constructor(e,t){this._documents=e,this._provider=t,this._idPool=new o2(""),this._cache=new Map}async prepareSession(e,t,i){const r=this._documents.getDocument(e),s=nt.to(t),o=await this._provider.prepareTypeHierarchy(r,s,i);if(!o)return;const a=this._idPool.nextId();return this._cache.set(a,new Map),Array.isArray(o)?o.map(l=>this._cacheAndConvertItem(a,l)):[this._cacheAndConvertItem(a,o)]}async provideSupertypes(e,t,i){const r=this._itemFromCache(e,t);if(!r)throw new Error("missing type hierarchy item");const s=await this._provider.provideTypeHierarchySupertypes(r,i);if(s)return s.map(o=>this._cacheAndConvertItem(e,o))}async provideSubtypes(e,t,i){const r=this._itemFromCache(e,t);if(!r)throw new Error("missing type hierarchy item");const s=await this._provider.provideTypeHierarchySubtypes(r,i);if(s)return s.map(o=>this._cacheAndConvertItem(e,o))}releaseSession(e){this._cache.delete(e)}_cacheAndConvertItem(e,t){const i=this._cache.get(e),r=Za.from(t,e,i.size.toString(36));return i.set(r._itemId,t),r}_itemFromCache(e,t){const i=this._cache.get(e);return i==null?void 0:i.get(t)}}class vp{constructor(e,t,i,r,s){this._proxy=e,this._documents=t,this._provider=i,this._handle=r,this._extension=s,this._cache=new Ai("DocumentDropEdit")}async provideDocumentOnDropEdits(e,t,i,r,s){const o=this._documents.getDocument(t),a=nt.to(i),l=Hu.toDataTransfer(r,async f=>(await this._proxy.$resolveDocumentOnDropFileData(this._handle,e,f)).buffer),c=await this._provider.provideDocumentDropEdits(o,a,l,s);if(!c)return;const u=Bi(c),d=this._cache.add(u);return u.map((f,p)=>{var w,v;return{_cacheId:[d,p],title:f.title??h(2541,"Drop using '{0}' extension",this._extension.displayName||this._extension.name),kind:(w=f.kind)==null?void 0:w.value,yieldTo:(v=f.yieldTo)==null?void 0:v.map(m=>m.value),insertText:typeof f.insertText=="string"?f.insertText:{snippet:f.insertText.value},additionalEdit:f.additionalEdit?gi.from(f.additionalEdit,void 0):void 0}})}async resolveDropEdit(e,t){const[i,r]=e,s=this._cache.get(i,r);if(!s||!this._provider.resolveDocumentDropEdit)return{};const o=await this._provider.resolveDocumentDropEdit(s,t)??s;return{additionalEdit:o.additionalEdit?gi.from(o.additionalEdit,void 0):void 0}}releaseDropEdits(e){this._cache.delete(e)}}class yd{constructor(e,t){this.adapter=e,this.extension=t}}const Qt=class Qt{constructor(e,t,i,r,s,o,a,l){this._uriTransformer=t,this._documents=i,this._commands=r,this._diagnostics=s,this._logService=o,this._apiDeprecation=a,this._extensionTelemetry=l,this._adapter=new Map,this._proxy=e.getProxy(Z.MainThreadLanguageFeatures)}_transformDocumentSelector(e,t){return Pu.from(e,this._uriTransformer,t)}_createDisposable(e){return new je(()=>{this._adapter.delete(e),this._proxy.$unregister(e)})}_nextHandle(){return Qt._handlePool++}async _withAdapter(e,t,i,r,s,o=!1){const a=this._adapter.get(e);if(!a||!(a.adapter instanceof t))return r;const l=Date.now();o||this._logService.trace(`[${a.extension.identifier.value}] INVOKE provider '${i.toString().replace(/[\r\n]/g,"")}'`);const c=i(a.adapter,a.extension);return Promise.resolve(c).catch(u=>{dl(u)||(this._logService.error(`[${a.extension.identifier.value}] provider FAILED`),this._logService.error(u),this._extensionTelemetry.onExtensionError(a.extension.identifier,u))}).finally(()=>{o||this._logService.trace(`[${a.extension.identifier.value}] provider DONE after ${Date.now()-l}ms`)}),Pt.isCancellationToken(s)?L9(c,s):c}_addNewAdapter(e,t){const i=this._nextHandle();return this._adapter.set(i,new yd(e,t)),i}static _extLabel(e){return e.displayName||e.name}static _extId(e){return e.identifier.value}registerDocumentSymbolProvider(e,t,i,r){const s=this._addNewAdapter(new y1(this._documents,i),e),o=r&&r.label||Qt._extLabel(e);return this._proxy.$registerDocumentSymbolProvider(s,this._transformDocumentSelector(t,e),o),this._createDisposable(s)}$provideDocumentSymbols(e,t,i){return this._withAdapter(e,y1,r=>r.provideDocumentSymbols(y.revive(t),i),void 0,i)}registerCodeLensProvider(e,t,i){const r=this._nextHandle(),s=typeof i.onDidChangeCodeLenses=="function"?this._nextHandle():void 0;this._adapter.set(r,new yd(new gp(this._documents,this._commands.converter,i,e,this._extensionTelemetry,this._logService),e)),this._proxy.$registerCodeLensSupport(r,this._transformDocumentSelector(t,e),s);let o=this._createDisposable(r);if(s!==void 0){const a=i.onDidChangeCodeLenses(l=>this._proxy.$emitCodeLensEvent(s));o=je.from(o,a)}return o}$provideCodeLenses(e,t,i){return this._withAdapter(e,gp,r=>r.provideCodeLenses(y.revive(t),i),void 0,i,t.scheme==="output")}$resolveCodeLens(e,t,i){return this._withAdapter(e,gp,r=>r.resolveCodeLens(t,i),void 0,void 0,!0)}$releaseCodeLenses(e,t){this._withAdapter(e,gp,i=>Promise.resolve(i.releaseCodeLenses(t)),void 0,void 0,!0)}registerDefinitionProvider(e,t,i){const r=this._addNewAdapter(new nk(this._documents,i),e);return this._proxy.$registerDefinitionSupport(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideDefinition(e,t,i,r){return this._withAdapter(e,nk,s=>s.provideDefinition(y.revive(t),i,r),[],r)}registerDeclarationProvider(e,t,i){const r=this._addNewAdapter(new ik(this._documents,i),e);return this._proxy.$registerDeclarationSupport(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideDeclaration(e,t,i,r){return this._withAdapter(e,ik,s=>s.provideDeclaration(y.revive(t),i,r),[],r)}registerImplementationProvider(e,t,i){const r=this._addNewAdapter(new rk(this._documents,i),e);return this._proxy.$registerImplementationSupport(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideImplementation(e,t,i,r){return this._withAdapter(e,rk,s=>s.provideImplementation(y.revive(t),i,r),[],r)}registerTypeDefinitionProvider(e,t,i){const r=this._addNewAdapter(new sk(this._documents,i),e);return this._proxy.$registerTypeDefinitionSupport(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideTypeDefinition(e,t,i,r){return this._withAdapter(e,sk,s=>s.provideTypeDefinition(y.revive(t),i,r),[],r)}registerHoverProvider(e,t,i,r){const s=this._addNewAdapter(new th(this._documents,i),e);return this._proxy.$registerHoverProvider(s,this._transformDocumentSelector(t,e)),this._createDisposable(s)}$provideHover(e,t,i,r,s){return this._withAdapter(e,th,o=>o.provideHover(y.revive(t),i,r,s),void 0,s)}$releaseHover(e,t){this._withAdapter(e,th,i=>Promise.resolve(i.releaseHover(t)),void 0,void 0)}registerEvaluatableExpressionProvider(e,t,i,r){const s=this._addNewAdapter(new ok(this._documents,i),e);return this._proxy.$registerEvaluatableExpressionProvider(s,this._transformDocumentSelector(t,e)),this._createDisposable(s)}$provideEvaluatableExpression(e,t,i,r){return this._withAdapter(e,ok,s=>s.provideEvaluatableExpression(y.revive(t),i,r),void 0,r)}registerInlineValuesProvider(e,t,i,r){const s=typeof i.onDidChangeInlineValues=="function"?this._nextHandle():void 0,o=this._addNewAdapter(new ak(this._documents,i),e);this._proxy.$registerInlineValuesProvider(o,this._transformDocumentSelector(t,e),s);let a=this._createDisposable(o);if(s!==void 0){const l=i.onDidChangeInlineValues(c=>this._proxy.$emitInlineValuesEvent(s));a=je.from(a,l)}return a}$provideInlineValues(e,t,i,r,s){return this._withAdapter(e,ak,o=>o.provideInlineValues(y.revive(t),i,r,s),void 0,s)}registerDocumentHighlightProvider(e,t,i){const r=this._addNewAdapter(new lk(this._documents,i),e);return this._proxy.$registerDocumentHighlightProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}registerMultiDocumentHighlightProvider(e,t,i){const r=this._addNewAdapter(new ck(this._documents,i,this._logService),e);return this._proxy.$registerMultiDocumentHighlightProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideDocumentHighlights(e,t,i,r){return this._withAdapter(e,lk,s=>s.provideDocumentHighlights(y.revive(t),i,r),void 0,r)}$provideMultiDocumentHighlights(e,t,i,r,s){return this._withAdapter(e,ck,o=>o.provideMultiDocumentHighlights(y.revive(t),i,r.map(a=>y.revive(a)),s),void 0,s)}registerLinkedEditingRangeProvider(e,t,i){const r=this._addNewAdapter(new uk(this._documents,i),e);return this._proxy.$registerLinkedEditingRangeProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideLinkedEditingRanges(e,t,i,r){return this._withAdapter(e,uk,async s=>{const o=await s.provideLinkedEditingRanges(y.revive(t),i,r);if(o)return{ranges:o.ranges,wordPattern:o.wordPattern?Qt._serializeRegExp(o.wordPattern):void 0}},void 0,r)}registerReferenceProvider(e,t,i){const r=this._addNewAdapter(new dk(this._documents,i),e);return this._proxy.$registerReferenceSupport(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideReferences(e,t,i,r,s){return this._withAdapter(e,dk,o=>o.provideReferences(y.revive(t),i,r,s),void 0,s)}registerCodeActionProvider(e,t,i,r){var a,l;const s=new Ie,o=this._addNewAdapter(new cc(this._documents,this._commands.converter,this._diagnostics,i,this._logService,e,this._apiDeprecation),e);return this._proxy.$registerCodeActionSupport(o,this._transformDocumentSelector(t,e),{providedKinds:(a=r==null?void 0:r.providedCodeActionKinds)==null?void 0:a.map(c=>c.value),documentation:(l=r==null?void 0:r.documentation)==null?void 0:l.map(c=>({kind:c.kind.value,command:this._commands.converter.toInternal(c.command,s)}))},Qt._extLabel(e),Qt._extId(e),!!i.resolveCodeAction),s.add(this._createDisposable(o)),s}$provideCodeActions(e,t,i,r,s){return this._withAdapter(e,cc,o=>o.provideCodeActions(y.revive(t),i,r,s),void 0,s)}$resolveCodeAction(e,t,i){return this._withAdapter(e,cc,r=>r.resolveCodeAction(t,i),{},void 0)}$releaseCodeActions(e,t){this._withAdapter(e,cc,i=>Promise.resolve(i.releaseCodeActions(t)),void 0,void 0)}registerDocumentFormattingEditProvider(e,t,i){const r=this._addNewAdapter(new hk(this._documents,i),e);return this._proxy.$registerDocumentFormattingSupport(r,this._transformDocumentSelector(t,e),e.identifier,e.displayName||e.name),this._createDisposable(r)}$provideDocumentFormattingEdits(e,t,i,r){return this._withAdapter(e,hk,s=>s.provideDocumentFormattingEdits(y.revive(t),i,r),void 0,r)}registerDocumentRangeFormattingEditProvider(e,t,i){const r=typeof i.provideDocumentRangesFormattingEdits=="function",s=this._addNewAdapter(new yv(this._documents,i),e);return this._proxy.$registerRangeFormattingSupport(s,this._transformDocumentSelector(t,e),e.identifier,e.displayName||e.name,r),this._createDisposable(s)}$provideDocumentRangeFormattingEdits(e,t,i,r,s){return this._withAdapter(e,yv,o=>o.provideDocumentRangeFormattingEdits(y.revive(t),i,r,s),void 0,s)}$provideDocumentRangesFormattingEdits(e,t,i,r,s){return this._withAdapter(e,yv,o=>o.provideDocumentRangesFormattingEdits(y.revive(t),i,r,s),void 0,s)}registerOnTypeFormattingEditProvider(e,t,i,r){const s=this._addNewAdapter(new fk(this._documents,i),e);return this._proxy.$registerOnTypeFormattingSupport(s,this._transformDocumentSelector(t,e),r,e.identifier),this._createDisposable(s)}$provideOnTypeFormattingEdits(e,t,i,r,s,o){return this._withAdapter(e,fk,a=>a.provideOnTypeFormattingEdits(y.revive(t),i,r,s,o),void 0,o)}registerWorkspaceSymbolProvider(e,t){const i=this._addNewAdapter(new mp(t,this._logService),e);return this._proxy.$registerNavigateTypeSupport(i,typeof t.resolveWorkspaceSymbol=="function"),this._createDisposable(i)}$provideWorkspaceSymbols(e,t,i){return this._withAdapter(e,mp,r=>r.provideWorkspaceSymbols(t,i),{symbols:[]},i)}$resolveWorkspaceSymbol(e,t,i){return this._withAdapter(e,mp,r=>r.resolveWorkspaceSymbol(t,i),void 0,void 0)}$releaseWorkspaceSymbols(e,t){this._withAdapter(e,mp,i=>i.releaseWorkspaceSymbols(t),void 0,void 0)}registerRenameProvider(e,t,i){const r=this._addNewAdapter(new ya(this._documents,i,this._logService),e);return this._proxy.$registerRenameSupport(r,this._transformDocumentSelector(t,e),ya.supportsResolving(i)),this._createDisposable(r)}$provideRenameEdits(e,t,i,r,s){return this._withAdapter(e,ya,o=>o.provideRenameEdits(y.revive(t),i,r,s),void 0,s)}$resolveRenameLocation(e,t,i,r){return this._withAdapter(e,ya,s=>s.resolveRenameLocation(y.revive(t),i,r),void 0,r)}registerNewSymbolNamesProvider(e,t,i){const r=this._addNewAdapter(new nh(this._documents,i,this._logService),e);return this._proxy.$registerNewSymbolNamesProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$supportsAutomaticNewSymbolNamesTriggerKind(e){return this._withAdapter(e,nh,t=>t.supportsAutomaticNewSymbolNamesTriggerKind(),!1,void 0)}$provideNewSymbolNames(e,t,i,r,s){return this._withAdapter(e,nh,o=>o.provideNewSymbolNames(y.revive(t),i,r,s),void 0,s)}registerDocumentSemanticTokensProvider(e,t,i,r){const s=this._addNewAdapter(new ai(this._documents,i),e),o=typeof i.onDidChangeSemanticTokens=="function"?this._nextHandle():void 0;this._proxy.$registerDocumentSemanticTokensProvider(s,this._transformDocumentSelector(t,e),r,o);let a=this._createDisposable(s);if(o){const l=i.onDidChangeSemanticTokens(c=>this._proxy.$emitDocumentSemanticTokensEvent(o));a=je.from(a,l)}return a}$provideDocumentSemanticTokens(e,t,i,r){return this._withAdapter(e,ai,s=>s.provideDocumentSemanticTokens(y.revive(t),i,r),null,r)}$releaseDocumentSemanticTokens(e,t){this._withAdapter(e,ai,i=>i.releaseDocumentSemanticColoring(t),void 0,void 0)}registerDocumentRangeSemanticTokensProvider(e,t,i,r){const s=this._addNewAdapter(new pk(this._documents,i),e);return this._proxy.$registerDocumentRangeSemanticTokensProvider(s,this._transformDocumentSelector(t,e),r),this._createDisposable(s)}$provideDocumentRangeSemanticTokens(e,t,i,r){return this._withAdapter(e,pk,s=>s.provideDocumentRangeSemanticTokens(y.revive(t),i,r),null,r)}registerCompletionItemProvider(e,t,i,r){const s=this._addNewAdapter(new Ko(this._documents,this._commands.converter,i,this._apiDeprecation,e),e);return this._proxy.$registerCompletionsProvider(s,this._transformDocumentSelector(t,e),r,Ko.supportsResolving(i),e.identifier),this._createDisposable(s)}$provideCompletionItems(e,t,i,r,s){return this._withAdapter(e,Ko,o=>o.provideCompletionItems(y.revive(t),i,r,s),void 0,s)}$resolveCompletionItem(e,t,i){return this._withAdapter(e,Ko,r=>r.resolveCompletionItem(t,i),void 0,i)}$releaseCompletionItems(e,t){this._withAdapter(e,Ko,i=>i.releaseCompletionItems(t),void 0,void 0)}registerInlineCompletionsProvider(e,t,i,r){var a;const s=new Bo(e,this._documents,i,this._commands.converter),o=this._addNewAdapter(s,e);return this._proxy.$registerInlineCompletionsSupport(o,this._transformDocumentSelector(t,e),s.supportsHandleEvents,Ke.toKey(e.identifier.value),((a=r==null?void 0:r.yieldTo)==null?void 0:a.map(l=>Ke.toKey(l)))||[],r==null?void 0:r.displayName,r==null?void 0:r.debounceDelayMs),this._createDisposable(o)}$provideInlineCompletions(e,t,i,r,s){return this._withAdapter(e,Bo,o=>o.provideInlineCompletions(y.revive(t),i,r,s),void 0,s)}$provideInlineEditsForRange(e,t,i,r,s){return this._withAdapter(e,Bo,o=>o.provideInlineEditsForRange(y.revive(t),i,r,s),void 0,s)}$handleInlineCompletionDidShow(e,t,i,r){this._withAdapter(e,Bo,async s=>{s.handleDidShowCompletionItem(t,i,r)},void 0,void 0)}$handleInlineCompletionPartialAccept(e,t,i,r,s){this._withAdapter(e,Bo,async o=>{o.handlePartialAccept(t,i,r,s)},void 0,void 0)}$handleInlineCompletionRejection(e,t,i){this._withAdapter(e,Bo,async r=>{r.handleRejection(t,i)},void 0,void 0)}$freeInlineCompletionsList(e,t){this._withAdapter(e,Bo,async i=>{i.disposeCompletions(t)},void 0,void 0)}registerInlineEditProvider(e,t,i){const r=new Ev(e,this._documents,i,this._commands.converter),s=this._addNewAdapter(r,e);return this._proxy.$registerInlineEditProvider(s,this._transformDocumentSelector(t,e),e.identifier,i.displayName||e.name),this._createDisposable(s)}$provideInlineEdit(e,t,i,r){return this._withAdapter(e,Ev,s=>s.provideInlineEdits(y.revive(t),i,r),void 0,r)}$freeInlineEdit(e,t){this._withAdapter(e,Ev,async i=>{i.disposeEdit(t)},void 0,void 0)}registerSignatureHelpProvider(e,t,i,r){const s=Array.isArray(r)?{triggerCharacters:r,retriggerCharacters:[]}:r,o=this._addNewAdapter(new Sv(this._documents,i),e);return this._proxy.$registerSignatureHelpProvider(o,this._transformDocumentSelector(t,e),s),this._createDisposable(o)}$provideSignatureHelp(e,t,i,r,s){return this._withAdapter(e,Sv,o=>o.provideSignatureHelp(y.revive(t),i,r,s),void 0,s)}$releaseSignatureHelp(e,t){this._withAdapter(e,Sv,i=>i.releaseSignatureHelp(t),void 0,void 0)}registerInlayHintsProvider(e,t,i){const r=typeof i.onDidChangeInlayHints=="function"?this._nextHandle():void 0,s=this._addNewAdapter(new _p(this._documents,this._commands.converter,i,this._logService,e),e);this._proxy.$registerInlayHintsProvider(s,this._transformDocumentSelector(t,e),typeof i.resolveInlayHint=="function",r,Qt._extLabel(e));let o=this._createDisposable(s);if(r!==void 0){const a=i.onDidChangeInlayHints(l=>this._proxy.$emitInlayHintsEvent(r));o=je.from(o,a)}return o}$provideInlayHints(e,t,i,r){return this._withAdapter(e,_p,s=>s.provideInlayHints(y.revive(t),i,r),void 0,r)}$resolveInlayHint(e,t,i){return this._withAdapter(e,_p,r=>r.resolveInlayHint(t,i),void 0,i)}$releaseInlayHints(e,t){this._withAdapter(e,_p,i=>i.releaseHints(t),void 0,void 0)}registerDocumentLinkProvider(e,t,i){const r=this._addNewAdapter(new xo(this._documents,i),e);return this._proxy.$registerDocumentLinkProvider(r,this._transformDocumentSelector(t,e),typeof i.resolveDocumentLink=="function"),this._createDisposable(r)}$provideDocumentLinks(e,t,i){return this._withAdapter(e,xo,r=>r.provideLinks(y.revive(t),i),void 0,i,t.scheme==="output")}$resolveDocumentLink(e,t,i){return this._withAdapter(e,xo,r=>r.resolveLink(t,i),void 0,void 0,!0)}$releaseDocumentLinks(e,t){this._withAdapter(e,xo,i=>i.releaseLinks(t),void 0,void 0,!0)}registerColorProvider(e,t,i){const r=this._addNewAdapter(new Dv(this._documents,i),e);return this._proxy.$registerDocumentColorProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideDocumentColors(e,t,i){return this._withAdapter(e,Dv,r=>r.provideColors(y.revive(t),i),[],i)}$provideColorPresentations(e,t,i,r){return this._withAdapter(e,Dv,s=>s.provideColorPresentations(y.revive(t),i,r),void 0,r)}registerFoldingRangeProvider(e,t,i){const r=this._nextHandle(),s=typeof i.onDidChangeFoldingRanges=="function"?this._nextHandle():void 0;this._adapter.set(r,new yd(new gk(this._documents,i),e)),this._proxy.$registerFoldingRangeProvider(r,this._transformDocumentSelector(t,e),e.identifier,s);let o=this._createDisposable(r);if(s!==void 0){const a=i.onDidChangeFoldingRanges(()=>this._proxy.$emitFoldingRangeEvent(s));o=je.from(o,a)}return o}$provideFoldingRanges(e,t,i,r){return this._withAdapter(e,gk,s=>s.provideFoldingRanges(y.revive(t),i,r),void 0,r)}registerSelectionRangeProvider(e,t,i){const r=this._addNewAdapter(new mk(this._documents,i,this._logService),e);return this._proxy.$registerSelectionRangeProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$provideSelectionRanges(e,t,i,r){return this._withAdapter(e,mk,s=>s.provideSelectionRanges(y.revive(t),i,r),[],r)}registerCallHierarchyProvider(e,t,i){const r=this._addNewAdapter(new wd(this._documents,i),e);return this._proxy.$registerCallHierarchyProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$prepareCallHierarchy(e,t,i,r){return this._withAdapter(e,wd,s=>Promise.resolve(s.prepareSession(y.revive(t),i,r)),void 0,r)}$provideCallHierarchyIncomingCalls(e,t,i,r){return this._withAdapter(e,wd,s=>s.provideCallsTo(t,i,r),void 0,r)}$provideCallHierarchyOutgoingCalls(e,t,i,r){return this._withAdapter(e,wd,s=>s.provideCallsFrom(t,i,r),void 0,r)}$releaseCallHierarchy(e,t){this._withAdapter(e,wd,i=>Promise.resolve(i.releaseSession(t)),void 0,void 0)}registerTypeHierarchyProvider(e,t,i){const r=this._addNewAdapter(new bd(this._documents,i),e);return this._proxy.$registerTypeHierarchyProvider(r,this._transformDocumentSelector(t,e)),this._createDisposable(r)}$prepareTypeHierarchy(e,t,i,r){return this._withAdapter(e,bd,s=>Promise.resolve(s.prepareSession(y.revive(t),i,r)),void 0,r)}$provideTypeHierarchySupertypes(e,t,i,r){return this._withAdapter(e,bd,s=>s.provideSupertypes(t,i,r),void 0,r)}$provideTypeHierarchySubtypes(e,t,i,r){return this._withAdapter(e,bd,s=>s.provideSubtypes(t,i,r),void 0,r)}$releaseTypeHierarchy(e,t){this._withAdapter(e,bd,i=>Promise.resolve(i.releaseSession(t)),void 0,void 0)}registerDocumentOnDropEditProvider(e,t,i,r){var o;const s=this._nextHandle();return this._adapter.set(s,new yd(new vp(this._proxy,this._documents,i,s,e),e)),this._proxy.$registerDocumentOnDropEditProvider(s,this._transformDocumentSelector(t,e),r?{supportsResolve:!!i.resolveDocumentDropEdit,dropMimeTypes:r.dropMimeTypes,providedDropKinds:(o=r.providedDropEditKinds)==null?void 0:o.map(a=>a.value)}:void 0),this._createDisposable(s)}$provideDocumentOnDropEdits(e,t,i,r,s,o){return this._withAdapter(e,vp,a=>Promise.resolve(a.provideDocumentOnDropEdits(t,y.revive(i),r,s,o)),void 0,void 0)}$resolveDropEdit(e,t,i){return this._withAdapter(e,vp,r=>r.resolveDropEdit(t,i),{},void 0)}$releaseDocumentOnDropEdits(e,t){this._withAdapter(e,vp,i=>Promise.resolve(i.releaseDropEdits(t)),void 0,void 0)}registerDocumentPasteEditProvider(e,t,i,r){var o;const s=this._nextHandle();return this._adapter.set(s,new yd(new vd(this._proxy,this._documents,i,s,e),e)),this._proxy.$registerPasteEditProvider(s,this._transformDocumentSelector(t,e),{supportsCopy:!!i.prepareDocumentPaste,supportsPaste:!!i.provideDocumentPasteEdits,supportsResolve:!!i.resolveDocumentPasteEdit,providedPasteEditKinds:(o=r.providedPasteEditKinds)==null?void 0:o.map(a=>a.value),copyMimeTypes:r.copyMimeTypes,pasteMimeTypes:r.pasteMimeTypes}),this._createDisposable(s)}$prepareDocumentPaste(e,t,i,r,s){return this._withAdapter(e,vd,o=>o.prepareDocumentPaste(y.revive(t),i,r,s),void 0,s)}$providePasteEdits(e,t,i,r,s,o,a){return this._withAdapter(e,vd,l=>l.providePasteEdits(t,y.revive(i),r,s,o,a),void 0,a)}$resolvePasteEdit(e,t,i){return this._withAdapter(e,vd,r=>r.resolvePasteEdit(t,i),{},void 0)}$releasePasteEdits(e,t){this._withAdapter(e,vd,i=>Promise.resolve(i.releasePasteEdits(t)),void 0,void 0)}static _serializeRegExp(e){return{pattern:e.source,flags:e.flags}}static _serializeIndentationRule(e){return{decreaseIndentPattern:Qt._serializeRegExp(e.decreaseIndentPattern),increaseIndentPattern:Qt._serializeRegExp(e.increaseIndentPattern),indentNextLinePattern:e.indentNextLinePattern?Qt._serializeRegExp(e.indentNextLinePattern):void 0,unIndentedLinePattern:e.unIndentedLinePattern?Qt._serializeRegExp(e.unIndentedLinePattern):void 0}}static _serializeOnEnterRule(e){return{beforeText:Qt._serializeRegExp(e.beforeText),afterText:e.afterText?Qt._serializeRegExp(e.afterText):void 0,previousLineText:e.previousLineText?Qt._serializeRegExp(e.previousLineText):void 0,action:e.action}}static _serializeOnEnterRules(e){return e.map(Qt._serializeOnEnterRule)}static _serializeAutoClosingPair(e){return{open:e.open,close:e.close,notIn:e.notIn?e.notIn.map(t=>yu.toString(t)):void 0}}static _serializeAutoClosingPairs(e){return e.map(Qt._serializeAutoClosingPair)}setLanguageConfiguration(e,t,i){const{wordPattern:r}=i;if(r&&TI(r))throw new Error(`Invalid language configuration: wordPattern '${r}' is not allowed to match the empty string.`);r?this._documents.setWordDefinitionFor(t,r):this._documents.setWordDefinitionFor(t,void 0),i.__electricCharacterSupport&&this._apiDeprecation.report("LanguageConfiguration.__electricCharacterSupport",e,"Do not use."),i.__characterPairSupport&&this._apiDeprecation.report("LanguageConfiguration.__characterPairSupport",e,"Do not use.");const s=this._nextHandle(),o={comments:i.comments,brackets:i.brackets,wordPattern:i.wordPattern?Qt._serializeRegExp(i.wordPattern):void 0,indentationRules:i.indentationRules?Qt._serializeIndentationRule(i.indentationRules):void 0,onEnterRules:i.onEnterRules?Qt._serializeOnEnterRules(i.onEnterRules):void 0,__electricCharacterSupport:i.__electricCharacterSupport,__characterPairSupport:i.__characterPairSupport,autoClosingPairs:i.autoClosingPairs?Qt._serializeAutoClosingPairs(i.autoClosingPairs):void 0};return this._proxy.$setLanguageConfiguration(s,t,o),this._createDisposable(s)}$setWordDefinitions(e){for(const t of e)this._documents.setWordDefinitionFor(t.languageId,new RegExp(t.regexSource,t.regexFlags))}};Qt._handlePool=0;let xy=Qt;var _k;(function(n){function e(t){switch(t.type){case"extension":return`extension:${t.extensionId.value}`;case"mcp":return`mcp:${t.collectionId}:${t.definitionId}`;case"internal":return"internal"}}n.toKey=e})(_k||(_k={}));function bO(n){return typeof n=="object"&&typeof n.sessionId=="string"}const yO=De("ILanguageModelToolsService");let Go;function h7(n){Go?Go instanceof vk?Go.loggers.push(n):Go=new vk([Go,n]):Go=n}function gn(){return Go}let Ey;function xO(n){Ey=n}function EO(n){Ey&&Ey(n)}class vk{constructor(e){this.loggers=e}handleObservableCreated(e){for(const t of this.loggers)t.handleObservableCreated(e)}handleOnListenerCountChanged(e,t){for(const i of this.loggers)i.handleOnListenerCountChanged(e,t)}handleObservableUpdated(e,t){for(const i of this.loggers)i.handleObservableUpdated(e,t)}handleAutorunCreated(e){for(const t of this.loggers)t.handleAutorunCreated(e)}handleAutorunDisposed(e){for(const t of this.loggers)t.handleAutorunDisposed(e)}handleAutorunDependencyChanged(e,t,i){for(const r of this.loggers)r.handleAutorunDependencyChanged(e,t,i)}handleAutorunStarted(e){for(const t of this.loggers)t.handleAutorunStarted(e)}handleAutorunFinished(e){for(const t of this.loggers)t.handleAutorunFinished(e)}handleDerivedDependencyChanged(e,t,i){for(const r of this.loggers)r.handleDerivedDependencyChanged(e,t,i)}handleDerivedCleared(e){for(const t of this.loggers)t.handleDerivedCleared(e)}handleBeginTransaction(e){for(const t of this.loggers)t.handleBeginTransaction(e)}handleEndTransaction(e){for(const t of this.loggers)t.handleEndTransaction(e)}}class l2{constructor(e,t,i){this.owner=e,this.debugNameSource=t,this.referenceFn=i}getDebugName(e){return SO(e,this)}}const wk=new Map,Sy=new WeakMap;function SO(n,e){const t=Sy.get(n);if(t)return t;const i=DO(n,e);if(i){let r=wk.get(i)??0;r++,wk.set(i,r);const s=r===1?i:`${i}#${r}`;return Sy.set(n,s),s}}function DO(n,e){const t=Sy.get(n);if(t)return t;const i=e.owner?IO(e.owner)+".":"";let r;const s=e.debugNameSource;if(s!==void 0)if(typeof s=="function"){if(r=s(),r!==void 0)return i+r}else return i+s;const o=e.referenceFn;if(o!==void 0&&(r=c2(o),r!==void 0))return i+r;if(e.owner!==void 0){const a=kO(e.owner,n);if(a!==void 0)return i+a}}function kO(n,e){for(const t in n)if(n[t]===e)return t}const bk=new Map,yk=new WeakMap;function IO(n){const e=yk.get(n);if(e)return e;const t=f7(n)??"Object";let i=bk.get(t)??0;i++,bk.set(t,i);const r=i===1?t:`${t}#${i}`;return yk.set(n,r),r}function f7(n){const e=n.constructor;if(e)return e.name==="Object"?void 0:e.name}function c2(n){const e=n.toString(),i=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(e),r=i?i[1]:void 0;return r==null?void 0:r.trim()}function Dy(n){return new u2(new l2(void 0,void 0,n),n,void 0,void 0)}var yn;(function(n){n[n.dependenciesMightHaveChanged=1]="dependenciesMightHaveChanged",n[n.stale=2]="stale",n[n.upToDate=3]="upToDate"})(yn||(yn={}));class u2{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,t,i,r){var s,o;this._debugNameData=e,this._runFn=t,this.createChangeSummary=i,this._handleChange=r,this._state=yn.stale,this._updateCount=0,this._disposed=!1,this._dependencies=new Set,this._dependenciesToBeRemoved=new Set,this._isRunning=!1,this._changeSummary=(s=this.createChangeSummary)==null?void 0:s.call(this),(o=gn())==null||o.handleAutorunCreated(this),this._run()}dispose(){var e;this._disposed=!0;for(const t of this._dependencies)t.removeObserver(this);this._dependencies.clear(),(e=gn())==null||e.handleAutorunDisposed(this)}_run(){var t,i,r;const e=this._dependenciesToBeRemoved;this._dependenciesToBeRemoved=this._dependencies,this._dependencies=e,this._state=yn.upToDate;try{if(!this._disposed){(t=gn())==null||t.handleAutorunStarted(this);const s=this._changeSummary;try{this._changeSummary=(i=this.createChangeSummary)==null?void 0:i.call(this),this._isRunning=!0,this._runFn(this,s)}catch(o){Jp(o)}finally{this._isRunning=!1}}}finally{this._disposed||(r=gn())==null||r.handleAutorunFinished(this);for(const s of this._dependenciesToBeRemoved)s.removeObserver(this);this._dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(e){this._state===yn.upToDate&&(this._state=yn.dependenciesMightHaveChanged),this._updateCount++}endUpdate(e){try{if(this._updateCount===1)do{if(this._state===yn.dependenciesMightHaveChanged){this._state=yn.upToDate;for(const t of this._dependencies)if(t.reportChanges(),this._state===yn.stale)break}this._state!==yn.upToDate&&this._run()}while(this._state!==yn.upToDate)}finally{this._updateCount--}cI(()=>this._updateCount>=0)}handlePossibleChange(e){this._state===yn.upToDate&&this._isDependency(e)&&(this._state=yn.dependenciesMightHaveChanged)}handleChange(e,t){var i;if(this._isDependency(e)){(i=gn())==null||i.handleAutorunDependencyChanged(this,e,t);try{(this._handleChange?this._handleChange({changedObservable:e,change:t,didChange:s=>s===e},this._changeSummary):!0)&&(this._state=yn.stale)}catch(r){Jp(r)}}}_isDependency(e){return this._dependencies.has(e)&&!this._dependenciesToBeRemoved.has(e)}readObservable(e){if(!this._isRunning)throw new ur("The reader object cannot be used outside its compute function!");if(this._disposed)return e.get();e.addObserver(this);const t=e.get();return this._dependencies.add(e),this._dependenciesToBeRemoved.delete(e),t}debugGetState(){return{isRunning:this._isRunning,updateCount:this._updateCount,dependencies:this._dependencies,state:this._state}}debugRerun(){this._isRunning?this._state=yn.stale:this._run()}}(function(n){n.Observer=u2})(Dy||(Dy={}));const p7=(n,e)=>n===e;function ky(n,e){if(n===e)return!0;if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!ky(n[t],e[t]))return!1;return!0}if(n&&typeof n=="object"&&e&&typeof e=="object"&&Object.getPrototypeOf(n)===Object.prototype&&Object.getPrototypeOf(e)===Object.prototype){const t=n,i=e,r=Object.keys(t),s=Object.keys(i),o=new Set(s);if(r.length!==s.length)return!1;for(const a of r)if(!o.has(a)||!ky(t[a],i[a]))return!1;return!0}return!1}let g7;function CO(n){g7=n}let m7;function PO(n){m7=n}let Iy;function TO(n){Iy=n}class AO{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t){const i=t===void 0?void 0:e,r=t===void 0?e:t;return Iy({owner:i,debugName:()=>{const s=c2(r);if(s!==void 0)return s;const a=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(r.toString());if(a)return`${this.debugName}.${a[2]}`;if(!i)return`${this.debugName} (mapped)`},debugReferenceFn:r},s=>r(this.read(s),s))}flatten(){return Iy({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,t){return e.add(g7(this,t)),this}keepObserved(e){return e.add(m7(this)),this}get debugValue(){return this.get()}}class d2 extends AO{constructor(){var e;super(),this._observers=new Set,(e=gn())==null||e.handleObservableCreated(this)}addObserver(e){var i;const t=this._observers.size;this._observers.add(e),t===0&&this.onFirstObserverAdded(),t!==this._observers.size&&((i=gn())==null||i.handleOnListenerCountChanged(this,this._observers.size))}removeObserver(e){var i;const t=this._observers.delete(e);t&&this._observers.size===0&&this.onLastObserverRemoved(),t&&((i=gn())==null||i.handleOnListenerCountChanged(this,this._observers.size))}onFirstObserverAdded(){}onLastObserverRemoved(){}log(){var t;const e=!!gn();return EO(this),e||(t=gn())==null||t.handleObservableCreated(this),this}debugGetObservers(){return this._observers}}function _7(n,e){const t=new v7(n,e);try{n(t)}finally{t.finish()}}function RO(n,e,t){n?e(n):_7(e,t)}class v7{constructor(e,t){var i;this._fn=e,this._getDebugName=t,this._updatingObservers=[],(i=gn())==null||i.handleBeginTransaction(this)}getDebugName(){return this._getDebugName?this._getDebugName():c2(this._fn)}updateObserver(e,t){if(!this._updatingObservers){xk("Transaction already finished!"),_7(i=>{i.updateObserver(e,t)});return}this._updatingObservers.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){var t;const e=this._updatingObservers;if(!e){xk("transaction.finish() has already been called!");return}for(let i=0;i<e.length;i++){const{observer:r,observable:s}=e[i];r.endUpdate(s)}this._updatingObservers=null,(t=gn())==null||t.handleEndTransaction(this)}debugGetUpdatingObservers(){return this._updatingObservers}}function xk(n){const e=new Error("BugIndicatingErrorRecovery: "+n);Fn(e),console.error("recovered from an error that indicates a bug",e)}class Ek extends d2{get debugName(){return this._debugNameData.getDebugName(this)??"ObservableValue"}constructor(e,t,i){var r;super(),this._debugNameData=e,this._equalityComparator=i,this._value=t,(r=gn())==null||r.handleObservableUpdated(this,{hadValue:!1,newValue:t,change:void 0,didChange:!0,oldValue:void 0})}get(){return this._value}set(e,t,i){var s;if(i===void 0&&this._equalityComparator(this._value,e))return;let r;t||(t=r=new v7(()=>{},()=>`Setting ${this.debugName}`));try{const o=this._value;this._setValue(e),(s=gn())==null||s.handleObservableUpdated(this,{oldValue:o,newValue:e,change:i,didChange:!0,hadValue:!0});for(const a of this._observers)t.updateObserver(a,this),a.handleChange(this,i)}finally{r&&r.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}debugGetState(){return{value:this._value}}debugSetValue(e){this._value=e}}function LO(n,e){return new gs(new l2(n.owner,n.debugName,n.debugReferenceFn),e,void 0,void 0,n.onLastObserverRemoved,n.equalsFn??p7)}TO(LO);var zt;(function(n){n[n.initial=0]="initial",n[n.dependenciesMightHaveChanged=1]="dependenciesMightHaveChanged",n[n.stale=2]="stale",n[n.upToDate=3]="upToDate"})(zt||(zt={}));class gs extends d2{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,t,i,r,s=void 0,o){var a;super(),this._debugNameData=e,this._computeFn=t,this.createChangeSummary=i,this._handleChange=r,this._handleLastObserverRemoved=s,this._equalityComparator=o,this._state=zt.initial,this._value=void 0,this._updateCount=0,this._dependencies=new Set,this._dependenciesToBeRemoved=new Set,this._changeSummary=void 0,this._isUpdating=!1,this._isComputing=!1,this._removedObserverToCallEndUpdateOn=null,this._isReaderValid=!1,this._changeSummary=(a=this.createChangeSummary)==null?void 0:a.call(this)}onLastObserverRemoved(){var e,t;this._state=zt.initial,this._value=void 0,(e=gn())==null||e.handleDerivedCleared(this);for(const i of this._dependencies)i.removeObserver(this);this._dependencies.clear(),(t=this._handleLastObserverRemoved)==null||t.call(this)}get(){var e;if(this._observers.size===0){let t;try{this._isReaderValid=!0,t=this._computeFn(this,(e=this.createChangeSummary)==null?void 0:e.call(this))}finally{this._isReaderValid=!1}return this.onLastObserverRemoved(),t}else{do{if(this._state===zt.dependenciesMightHaveChanged){for(const t of this._dependencies)if(t.reportChanges(),this._state===zt.stale)break}this._state===zt.dependenciesMightHaveChanged&&(this._state=zt.upToDate),this._state!==zt.upToDate&&this._recompute()}while(this._state!==zt.upToDate);return this._value}}_recompute(){var s,o;const e=this._dependenciesToBeRemoved;this._dependenciesToBeRemoved=this._dependencies,this._dependencies=e;const t=this._state!==zt.initial,i=this._value;this._state=zt.upToDate;let r=!1;this._isComputing=!0;try{const a=this._changeSummary;this._changeSummary=(s=this.createChangeSummary)==null?void 0:s.call(this);try{this._isReaderValid=!0,this._value=this._computeFn(this,a)}finally{this._isReaderValid=!1;for(const l of this._dependenciesToBeRemoved)l.removeObserver(this);this._dependenciesToBeRemoved.clear()}r=t&&!this._equalityComparator(i,this._value),(o=gn())==null||o.handleObservableUpdated(this,{oldValue:i,newValue:this._value,change:void 0,didChange:r,hadValue:t})}catch(a){Jp(a)}if(this._isComputing=!1,r)for(const a of this._observers)a.handleChange(this,void 0)}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(e){if(this._isUpdating)throw new ur("Cyclic deriveds are not supported yet!");this._updateCount++,this._isUpdating=!0;try{const t=this._updateCount===1;if(this._state===zt.upToDate&&(this._state=zt.dependenciesMightHaveChanged,!t))for(const i of this._observers)i.handlePossibleChange(this);if(t)for(const i of this._observers)i.beginUpdate(this)}finally{this._isUpdating=!1}}endUpdate(e){if(this._updateCount--,this._updateCount===0){const t=[...this._observers];for(const i of t)i.endUpdate(this);if(this._removedObserverToCallEndUpdateOn){const i=[...this._removedObserverToCallEndUpdateOn];this._removedObserverToCallEndUpdateOn=null;for(const r of i)r.endUpdate(this)}}cI(()=>this._updateCount>=0)}handlePossibleChange(e){if(this._state===zt.upToDate&&this._dependencies.has(e)&&!this._dependenciesToBeRemoved.has(e)){this._state=zt.dependenciesMightHaveChanged;for(const t of this._observers)t.handlePossibleChange(this)}}handleChange(e,t){var i;if(this._dependencies.has(e)&&!this._dependenciesToBeRemoved.has(e)){(i=gn())==null||i.handleDerivedDependencyChanged(this,e,t);let r=!1;try{r=this._handleChange?this._handleChange({changedObservable:e,change:t,didChange:o=>o===e},this._changeSummary):!0}catch(o){Jp(o)}const s=this._state===zt.upToDate;if(r&&(this._state===zt.dependenciesMightHaveChanged||s)&&(this._state=zt.stale,s))for(const o of this._observers)o.handlePossibleChange(this)}}readObservable(e){if(!this._isReaderValid)throw new ur("The reader object cannot be used outside its compute function!");e.addObserver(this);const t=e.get();return this._dependencies.add(e),this._dependenciesToBeRemoved.delete(e),t}addObserver(e){const t=!this._observers.has(e)&&this._updateCount>0;super.addObserver(e),t&&(this._removedObserverToCallEndUpdateOn&&this._removedObserverToCallEndUpdateOn.has(e)?this._removedObserverToCallEndUpdateOn.delete(e):e.beginUpdate(this))}removeObserver(e){this._observers.has(e)&&this._updateCount>0&&(this._removedObserverToCallEndUpdateOn||(this._removedObserverToCallEndUpdateOn=new Set),this._removedObserverToCallEndUpdateOn.add(e)),super.removeObserver(e)}debugGetState(){return{state:this._state,updateCount:this._updateCount,isComputing:this._isComputing,dependencies:this._dependencies,value:this._value}}debugSetValue(e){this._value=e}}function Sk(...n){let e,t,i;return n.length===3?[e,t,i]=n:[t,i]=n,new xa(new l2(e,void 0,i),t,i,()=>xa.globalTransaction,p7)}class xa extends d2{constructor(e,t,i,r,s){super(),this._debugNameData=e,this.event=t,this._getValue=i,this._getTransaction=r,this._equalityComparator=s,this._hasValue=!1,this.handleEvent=o=>{var d;const a=this._getValue(o),l=this._value,c=!this._hasValue||!this._equalityComparator(l,a);let u=!1;c&&(this._value=a,this._hasValue&&(u=!0,RO(this._getTransaction(),f=>{var p;(p=gn())==null||p.handleObservableUpdated(this,{oldValue:l,newValue:a,change:void 0,didChange:c,hadValue:this._hasValue});for(const w of this._observers)f.updateObserver(w,this),w.handleChange(this,void 0)},()=>{const f=this.getDebugName();return"Event fired"+(f?`: ${f}`:"")})),this._hasValue=!0),u||(d=gn())==null||d.handleObservableUpdated(this,{oldValue:l,newValue:a,change:void 0,didChange:c,hadValue:this._hasValue})}}getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){const e=this.getDebugName();return"From Event"+(e?`: ${e}`:"")}onFirstObserverAdded(){this._subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this._subscription.dispose(),this._subscription=void 0,this._hasValue=!1,this._value=void 0}get(){return this._subscription?(this._hasValue||this.handleEvent(void 0),this._value):this._getValue(void 0)}debugSetValue(e){this._value=e}}(function(n){n.Observer=xa;function e(t,i){let r=!1;xa.globalTransaction===void 0&&(xa.globalTransaction=t,r=!0);try{i()}finally{r&&(xa.globalTransaction=void 0)}}n.batchEventsGlobally=e})(Sk||(Sk={}));function NO(n){const e=new w7(!1,void 0);return n.addObserver(e),Se(()=>{n.removeObserver(e)})}PO(NO);function OO(n,e){const t=new w7(!0,e);n.addObserver(t);try{t.beginUpdate(n)}finally{t.endUpdate(n)}return Se(()=>{n.removeObserver(t)})}CO(OO);class w7{constructor(e,t){this._forceRecompute=e,this._handleValue=t,this._counter=0}beginUpdate(e){this._counter++}endUpdate(e){this._counter===1&&this._forceRecompute&&(this._handleValue?this._handleValue(e.get()):e.reportChanges()),this._counter--}handlePossibleChange(e){}handleChange(e,t){}}let wp;function FO(n){wp||(wp=new MO,h7(wp)),wp.addFilteredObj(n)}class MO{constructor(){this.indentation=0,this.changedObservablesSets=new WeakMap}addFilteredObj(e){this._filteredObjects||(this._filteredObjects=new Set),this._filteredObjects.add(e)}_isIncluded(e){var t;return((t=this._filteredObjects)==null?void 0:t.has(e))??!0}textToConsoleArgs(e){return $O([Jl(BO("|  ",this.indentation)),e])}formatInfo(e){return e.hadValue?e.didChange?[Jl(" "),Mi(ks(e.oldValue,70),{color:"red",strikeThrough:!0}),Jl(" "),Mi(ks(e.newValue,60),{color:"green"})]:[Jl(" (unchanged)")]:[Jl(" "),Mi(ks(e.newValue,60),{color:"green"}),Jl(" (initial)")]}handleObservableCreated(e){if(e instanceof gs){const t=e;this.changedObservablesSets.set(t,new Set)}}handleOnListenerCountChanged(e,t){}handleObservableUpdated(e,t){if(this._isIncluded(e)){if(e instanceof gs){this._handleDerivedRecomputed(e,t);return}console.log(...this.textToConsoleArgs([Xl("observable value changed"),Mi(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t)]))}}formatChanges(e){if(e.size!==0)return Mi(" (changed deps: "+[...e].map(t=>t.debugName).join(", ")+")",{color:"gray"})}handleDerivedDependencyChanged(e,t,i){var r;this._isIncluded(e)&&((r=this.changedObservablesSets.get(e))==null||r.add(t))}_handleDerivedRecomputed(e,t){if(!this._isIncluded(e))return;const i=this.changedObservablesSets.get(e);i&&(console.log(...this.textToConsoleArgs([Xl("derived recomputed"),Mi(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t),this.formatChanges(i),{data:[{fn:e._debugNameData.referenceFn??e._computeFn}]}])),i.clear())}handleDerivedCleared(e){this._isIncluded(e)&&console.log(...this.textToConsoleArgs([Xl("derived cleared"),Mi(e.debugName,{color:"BlueViolet"})]))}handleFromEventObservableTriggered(e,t){this._isIncluded(e)&&console.log(...this.textToConsoleArgs([Xl("observable from event triggered"),Mi(e.debugName,{color:"BlueViolet"}),...this.formatInfo(t),{data:[{fn:e._getValue}]}]))}handleAutorunCreated(e){this._isIncluded(e)&&this.changedObservablesSets.set(e,new Set)}handleAutorunDisposed(e){}handleAutorunDependencyChanged(e,t,i){this._isIncluded(e)&&this.changedObservablesSets.get(e).add(t)}handleAutorunStarted(e){const t=this.changedObservablesSets.get(e);t&&(this._isIncluded(e)&&console.log(...this.textToConsoleArgs([Xl("autorun"),Mi(e.debugName,{color:"BlueViolet"}),this.formatChanges(t),{data:[{fn:e._debugNameData.referenceFn??e._runFn}]}])),t.clear(),this.indentation++)}handleAutorunFinished(e){this.indentation--}handleBeginTransaction(e){let t=e.getDebugName();t===void 0&&(t=""),this._isIncluded(e)&&console.log(...this.textToConsoleArgs([Xl("transaction"),Mi(t,{color:"BlueViolet"}),{data:[{fn:e._fn}]}])),this.indentation++}handleEndTransaction(){this.indentation--}}function $O(n){const e=new Array,t=[];let i="";function r(o){if("length"in o)for(const a of o)a&&r(a);else"text"in o?(i+=`%c${o.text}`,e.push(o.style),o.data&&t.push(...o.data)):"data"in o&&t.push(...o.data)}r(n);const s=[i,...e];return s.push(...t),s}function Jl(n){return Mi(n,{color:"black"})}function Xl(n){return Mi(WO(`${n}: `,10),{color:"black",bold:!0})}function Mi(n,e={color:"black"}){function t(r){return Object.entries(r).reduce((s,[o,a])=>`${s}${o}:${a};`,"")}const i={color:e.color};return e.strikeThrough&&(i["text-decoration"]="line-through"),e.bold&&(i["font-weight"]="bold"),{text:n,style:t(i)}}function ks(n,e){switch(typeof n){case"number":return""+n;case"string":return n.length+2<=e?`"${n}"`:`"${n.substr(0,e-7)}"+...`;case"boolean":return n?"true":"false";case"undefined":return"undefined";case"object":return n===null?"null":Array.isArray(n)?UO(n,e):HO(n,e);case"symbol":return n.toString();case"function":return`[[Function${n.name?" "+n.name:""}]]`;default:return""+n}}function UO(n,e){let t="[ ",i=!0;for(const r of n){if(i||(t+=", "),t.length-5>e){t+="...";break}i=!1,t+=`${ks(r,e-t.length)}`}return t+=" ]",t}function HO(n,e){if(typeof n.toString=="function"&&n.toString!==Object.prototype.toString){const s=n.toString();return s.length<=e?s:s.substring(0,e-3)+"..."}const t=f7(n);let i=t?t+"(":"{ ",r=!0;for(const[s,o]of Object.entries(n)){if(r||(i+=", "),i.length-5>e){i+="...";break}r=!1,i+=`${s}: ${ks(o,e-i.length)}`}return i+=t?")":" }",i}function BO(n,e){let t="";for(let i=1;i<=e;i++)t+=n;return t}function WO(n,e){for(;n.length<e;)n+=" ";return n}class x1{static createHost(e,t){return new x1(e,t)}static createClient(e,t){return new x1(e,t)}constructor(e,t){this._channelFactory=e,this._getHandler=t,this._channel=this._channelFactory({handleNotification:s=>{const o=s,a=this._getHandler().notifications[o[0]];if(!a)throw new Error(`Unknown notification "${o[0]}"!`);a(...o[1])},handleRequest:s=>{const o=s;try{return{type:"result",value:this._getHandler().requests[o[0]](...o[1])}}catch(a){return{type:"error",value:a}}}});const i=new Proxy({},{get:(s,o)=>async(...a)=>{const l=await this._channel.sendRequest([o,a]);if(l.type==="error")throw l.value;return l.value}}),r=new Proxy({},{get:(s,o)=>(...a)=>{this._channel.sendNotification([o,a])}});this.api={notifications:r,requests:i}}}function VO(n,e){const t=globalThis;let i=[],r;const{channel:s,handler:o}=zO({sendNotification:l=>{r?r.sendNotification(l):i.push(l)}});let a;return(t.$$debugValueEditor_debugChannels??(t.$$debugValueEditor_debugChannels={}))[n]=l=>{a=e(),r=l;for(const c of i)l.sendNotification(c);return i=[],o},x1.createClient(s,()=>{if(!a)throw new Error("Not supported");return a})}function zO(n){let e;return{channel:i=>(e=i,{sendNotification:r=>{n.sendNotification(r)},sendRequest:r=>{throw new Error("not supported")}}),handler:{handleRequest:i=>i.type==="notification"?e==null?void 0:e.handleNotification(i.data):e==null?void 0:e.handleRequest(i.data)}}}function Dk(n,e){const t=n.split(`
`);for(const i of t.slice(1)){if(e&&e.test(i))continue;const r=qO(i);if(r)return r}}function qO(n){const e=n.match(/\((.*):(\d+):(\d+)\)/);if(e)return{fileName:e[1],line:parseInt(e[2]),column:parseInt(e[3]),id:n};const t=n.match(/at ([^\(\)]*):(\d+):(\d+)/);if(t)return{fileName:t[1],line:parseInt(t[2]),column:parseInt(t[3]),id:n}}class jO{constructor(){this._timeout=void 0}throttle(e,t){this._timeout===void 0&&(this._timeout=setTimeout(()=>{this._timeout=void 0,e()},t))}dispose(){this._timeout!==void 0&&clearTimeout(this._timeout)}}function b7(n,e){for(const t in e)n[t]&&typeof n[t]=="object"&&e[t]&&typeof e[t]=="object"?b7(n[t],e[t]):n[t]=e[t]}function y7(n,e){for(const t in e)e[t]===null?delete n[t]:n[t]&&typeof n[t]=="object"&&e[t]&&typeof e[t]=="object"?y7(n[t],e[t]):n[t]=e[t]}const sa=class sa{static getInstance(){return sa._instance===void 0&&(sa._instance=new sa),sa._instance}getTransactionState(){const e=[],t=[...this._activeTransactions];if(t.length===0)return;const i=t.flatMap(s=>s.debugGetUpdatingObservers()??[]).map(s=>s.observer),r=new Set;for(;i.length>0;){const s=i.shift();if(r.has(s))continue;r.add(s);const o=this._getInfo(s,a=>{r.has(a)||i.push(a)});o&&e.push(o)}return{names:t.map(s=>s.getDebugName()??"tx"),affected:e}}_getObservableInfo(e){const t=this._instanceInfos.get(e);if(!t){Fn(new ur("No info found"));return}return t}_getAutorunInfo(e){const t=this._instanceInfos.get(e);if(!t){Fn(new ur("No info found"));return}return t}_getInfo(e,t){if(e instanceof gs){const i=[...e.debugGetObservers()];for(const l of i)t(l);const r=this._getObservableInfo(e);if(!r)return;const s=e.debugGetState(),o={name:e.debugName,instanceId:r.instanceId,updateCount:s.updateCount},a=[...r.changedObservables].map(l=>{var c;return(c=this._instanceInfos.get(l))==null?void 0:c.instanceId}).filter(Ui);if(s.isComputing)return{...o,type:"observable/derived",state:"updating",changedDependencies:a,initialComputation:!1};switch(s.state){case zt.initial:return{...o,type:"observable/derived",state:"noValue"};case zt.upToDate:return{...o,type:"observable/derived",state:"upToDate"};case zt.stale:return{...o,type:"observable/derived",state:"stale",changedDependencies:a};case zt.dependenciesMightHaveChanged:return{...o,type:"observable/derived",state:"possiblyStale"}}}else if(e instanceof u2){const i=this._getAutorunInfo(e);if(!i)return;const r={name:e.debugName,instanceId:i.instanceId,updateCount:i.updateCount},s=[...i.changedObservables].map(o=>this._instanceInfos.get(o).instanceId);if(e.debugGetState().isRunning)return{...r,type:"autorun",state:"updating",changedDependencies:s};switch(e.debugGetState().state){case yn.upToDate:return{...r,type:"autorun",state:"upToDate"};case yn.stale:return{...r,type:"autorun",state:"stale",changedDependencies:s};case yn.dependenciesMightHaveChanged:return{...r,type:"autorun",state:"possiblyStale"}}}}_formatObservable(e){const t=this._getObservableInfo(e);if(t)return{name:e.debugName,instanceId:t.instanceId}}_formatObserver(e){var i;if(e instanceof gs)return{name:e.toString(),instanceId:(i=this._getObservableInfo(e))==null?void 0:i.instanceId};const t=this._getAutorunInfo(e);if(t)return{name:e.toString(),instanceId:t.instanceId}}constructor(){this._declarationId=0,this._instanceId=0,this._declarations=new Map,this._instanceInfos=new WeakMap,this._aliveInstances=new Map,this._activeTransactions=new Set,this._channel=VO("observableDevTools",()=>({notifications:{setDeclarationIdFilter:e=>{},logObservableValue:e=>{console.log("logObservableValue",e)},flushUpdates:()=>{this._flushUpdates()},resetUpdates:()=>{this._pendingChanges=null,this._channel.api.notifications.handleChange(this._fullState,!0)}},requests:{getDeclarations:()=>{const e={};for(const t of this._declarations.values())e[t.id]=t;return{decls:e}},getSummarizedInstances:()=>null,getObservableValueInfo:e=>({observers:[...this._aliveInstances.get(e).debugGetObservers()].map(i=>this._formatObserver(i)).filter(Ui)}),getDerivedInfo:e=>{const t=this._aliveInstances.get(e);return{dependencies:[...t.debugGetState().dependencies].map(i=>this._formatObservable(i)).filter(Ui),observers:[...t.debugGetObservers()].map(i=>this._formatObserver(i)).filter(Ui)}},getAutorunInfo:e=>({dependencies:[...this._aliveInstances.get(e).debugGetState().dependencies].map(i=>this._formatObservable(i)).filter(Ui)}),getTransactionState:()=>this.getTransactionState(),setValue:(e,t)=>{const i=this._aliveInstances.get(e);if(i instanceof gs)i.debugSetValue(t);else if(i instanceof Ek)i.debugSetValue(t);else if(i instanceof xa)i.debugSetValue(t);else throw new ur("Observable is not supported");const r=[...i.debugGetObservers()];for(const s of r)s.beginUpdate(i);for(const s of r)s.handleChange(i,void 0);for(const s of r)s.endUpdate(i)},getValue:e=>{const t=this._aliveInstances.get(e);if(t instanceof gs)return ks(t.debugGetState().value,200);if(t instanceof Ek)return ks(t.debugGetState().value,200)}}})),this._pendingChanges=null,this._changeThrottler=new jO,this._fullState={},this._flushUpdates=()=>{this._pendingChanges!==null&&(this._channel.api.notifications.handleChange(this._pendingChanges,!1),this._pendingChanges=null)}}_handleChange(e){y7(this._fullState,e),this._pendingChanges===null?this._pendingChanges=e:b7(this._pendingChanges,e),this._changeThrottler.throttle(this._flushUpdates,10)}_getDeclarationId(e){let t=!0,i;const r=Error;for(;;){const o=r.stackTraceLimit;r.stackTraceLimit=t?6:20;const a=new Error().stack;r.stackTraceLimit=o;let l=Dk(a,/[/\\]observableInternal[/\\]|\.observe|[/\\]util(s)?\./);if(!t&&!l&&(l=Dk(a,/[/\\]observableInternal[/\\]|\.observe/)),l){i=l;break}if(!t){console.error("Could not find location for declaration",new Error().stack),i={fileName:"unknown",line:0,column:0,id:"unknown"};break}t=!1}let s=this._declarations.get(i.id);return s===void 0&&(s={id:this._declarationId++,type:e,url:i.fileName,line:i.line,column:i.column},this._declarations.set(i.id,s),this._handleChange({decls:{[s.id]:s}})),s.id}handleObservableCreated(e){const i={declarationId:this._getDeclarationId("observable/value"),instanceId:this._instanceId++,listenerCount:0,lastValue:void 0,updateCount:0,changedObservables:new Set};this._instanceInfos.set(e,i)}handleOnListenerCountChanged(e,t){const i=this._getObservableInfo(e);if(i){if(i.listenerCount===0&&t>0){const r=e instanceof gs?"observable/derived":"observable/value";this._aliveInstances.set(i.instanceId,e),this._handleChange({instances:{[i.instanceId]:{instanceId:i.instanceId,declarationId:i.declarationId,formattedValue:i.lastValue,type:r,name:e.debugName}}})}else i.listenerCount>0&&t===0&&(this._handleChange({instances:{[i.instanceId]:null}}),this._aliveInstances.delete(i.instanceId));i.listenerCount=t}}handleObservableUpdated(e,t){if(e instanceof gs){this._handleDerivedRecomputed(e,t);return}const i=this._getObservableInfo(e);i&&t.didChange&&(i.lastValue=ks(t.newValue,30),i.listenerCount>0&&this._handleChange({instances:{[i.instanceId]:{formattedValue:i.lastValue}}}))}handleAutorunCreated(e){const i={declarationId:this._getDeclarationId("autorun"),instanceId:this._instanceId++,updateCount:0,changedObservables:new Set};this._instanceInfos.set(e,i),this._aliveInstances.set(i.instanceId,e),i&&this._handleChange({instances:{[i.instanceId]:{instanceId:i.instanceId,declarationId:i.declarationId,runCount:0,type:"autorun",name:e.debugName}}})}handleAutorunDisposed(e){const t=this._getAutorunInfo(e);t&&(this._handleChange({instances:{[t.instanceId]:null}}),this._instanceInfos.delete(e),this._aliveInstances.delete(t.instanceId))}handleAutorunDependencyChanged(e,t,i){const r=this._getAutorunInfo(e);r&&r.changedObservables.add(t)}handleAutorunStarted(e){}handleAutorunFinished(e){const t=this._getAutorunInfo(e);t&&(t.changedObservables.clear(),t.updateCount++,this._handleChange({instances:{[t.instanceId]:{runCount:t.updateCount}}}))}handleDerivedDependencyChanged(e,t,i){const r=this._getObservableInfo(e);r&&r.changedObservables.add(t)}_handleDerivedRecomputed(e,t){const i=this._getObservableInfo(e);if(!i)return;const r=ks(t.newValue,30);i.updateCount++,i.changedObservables.clear(),i.lastValue=r,i.listenerCount>0&&this._handleChange({instances:{[i.instanceId]:{formattedValue:r,recomputationCount:i.updateCount}}})}handleDerivedCleared(e){const t=this._getObservableInfo(e);t&&(t.lastValue=void 0,t.changedObservables.clear(),t.listenerCount>0&&this._handleChange({instances:{[t.instanceId]:{formattedValue:void 0}}}))}handleBeginTransaction(e){this._activeTransactions.add(e)}handleEndTransaction(e){this._activeTransactions.delete(e)}};sa._instance=void 0;let Cy=sa;xO(FO);du&&du.VSCODE_DEV_DEBUG&&h7(Cy.getInstance());const GO=De("textFileService"),QO=De("notebookService"),JO=De("codeMapperService"),XO=De("IChatService"),YO=De("languageModelIgnoredFilesService"),kk=`
The user is very smart and can understand how to apply your edits to their files, you just need to provide minimal hints.
Avoid repeating existing code, instead use comments to represent regions of unchanged code. The user prefers that you are as concise as possible. For example:
// ...existing code...
{ changed code }
// ...existing code...
{ changed code }
// ...existing code...

Here is an example of how you should use format an edit to an existing Person class:
class Person {
	// ...existing code...
	age: number;
	// ...existing code...
	getAge() {
		return this.age;
	}
}
`,Ik="vscode_editFile",Py="vscode_editFile_internal",Ty={id:Py,displayName:h(5006,"Edit File"),modelDescription:`Edit a file in the workspace. Use this tool once per file that needs to be modified, even if there are multiple changes for a file. Generate the "explanation" property first. ${kk}`,source:{type:"internal"},inputSchema:{type:"object",properties:{explanation:{type:"string",description:"A short explanation of the edit being made. Can be the same as the explanation you showed to the user."},filePath:{type:"string",description:"An absolute path to the file to edit, or the URI of a untitled, not yet named, file, such as `untitled:Untitled-1."},code:{type:"string",description:"The code change to apply to the file. "+kk}},required:["explanation","filePath","code"]}};let Ay=class{constructor(e,t,i,r,s,o,a){this.chatService=e,this.codeMapperService=t,this.workspaceContextService=i,this.ignoredFilesService=r,this.textFileService=s,this.notebookService=o,this.editorGroupsService=a}async invoke(e,t,i){var f,p,w;if(!e.context)throw new Error("toolInvocationToken is required for this tool");const r=e.parameters,s=y.revive(r.file),o=((f=bw.parse(s))==null?void 0:f.notebook)||s;if(!this.workspaceContextService.isInsideWorkspace(o)&&!this.notebookService.getNotebookTextModel(o)&&!this.editorGroupsService.getGroups(Ew.MOST_RECENTLY_ACTIVE).some(x=>x.editors.some(k=>Dc(k.resource,o))))throw new Error(`File ${o.fsPath} can't be edited because it's not inside the current workspace`);if(await this.ignoredFilesService.fileIsIgnored(o,i))throw new Error(`File ${o.fsPath} can't be edited because it is configured to be ignored by Copilot`);const a=this.chatService.getSession((p=e.context)==null?void 0:p.sessionId),l=a.getRequests().at(-1);(w=l.response)!=null&&w.response.getMarkdown().length&&a.acceptResponseProgress(l,{kind:"undoStop",id:Mn()}),a.acceptResponseProgress(l,{kind:"markdownContent",content:new hg("\n````\n")}),a.acceptResponseProgress(l,{kind:"codeblockUri",uri:o,isEdit:!0}),a.acceptResponseProgress(l,{kind:"markdownContent",content:new hg(r.code+"\n````\n")}),this.notebookService.hasSupportedNotebooks(o)&&this.notebookService.getNotebookTextModel(o)?a.acceptResponseProgress(l,{kind:"notebookEdit",edits:[],uri:o}):a.acceptResponseProgress(l,{kind:"textEdit",edits:[],uri:o});const c=a.editingSession;if(!c)throw new Error("This tool must be called from within an editing session");const u=await this.codeMapperService.mapCode({codeBlocks:[{code:r.code,resource:o,markdownBeforeBlock:r.explanation}],location:"tool",chatRequestId:e.chatRequestId},{textEdit:(v,m)=>{a.acceptResponseProgress(l,{kind:"textEdit",uri:v,edits:m})},notebookEdit(v,m){a.acceptResponseProgress(l,{kind:"notebookEdit",uri:v,edits:m})}},i);if(this.notebookService.hasSupportedNotebooks(o)&&this.notebookService.getNotebookTextModel(o)?a.acceptResponseProgress(l,{kind:"notebookEdit",uri:o,edits:[],done:!0}):a.acceptResponseProgress(l,{kind:"textEdit",uri:o,edits:[],done:!0}),u!=null&&u.errorMessage)throw new Error(u.errorMessage);let d;return await new Promise(v=>{let m=!1;d=Dy(x=>{const k=c.entries.read(x),D=k==null?void 0:k.find(B=>B.modifiedURI.toString()===o.toString());D&&(D.isCurrentlyBeingModifiedBy.read(x)?m=!0:m&&v(!0))})}).finally(()=>{d.dispose()}),await this.textFileService.save(o,{reason:ua.AUTO,skipSaveParticipants:!0}),{content:[{kind:"text",value:"The file was edited successfully"}]}}async prepareToolInvocation(e,t){return{presentation:"hidden"}}};Ay=V([F(0,XO),F(1,JO),F(2,e2),F(3,YO),F(4,GO),F(5,QO),F(6,F5)],Ay);class ZO{processInput(e){if(!e.filePath)return e;const t=e.filePath;return{file:t.startsWith("untitled:")?y.parse(t):y.file(t),explanation:e.explanation,code:e.code}}}var jc;let Ck=(jc=class extends Te{constructor(e,t){super();const i=t.createInstance(Ay);this._register(e.registerToolData(Ty)),this._register(e.registerToolImplementation(Ty.id,i))}},jc.ID="chat.builtinTools",jc);Ck=V([F(0,yO),F(1,zf)],Ck);const KO="vscode_fetchWebPage_internal";class eF{constructor(e,t){this._languageModels=t,this._registeredTools=new Map,this._tokenCountFuncs=new Map,this._allTools=new Map,this._toolInputProcessors=new Map,this._proxy=e.getProxy(Z.MainThreadLanguageModelTools),this._proxy.$getTools().then(i=>{for(const r of i)this._allTools.set(r.id,jn(r))}),this._toolInputProcessors.set(Ty.id,new ZO)}async $countTokensForInvocation(e,t,i){const r=this._tokenCountFuncs.get(e);if(!r)throw new Error(`Tool invocation call ${e} not found`);return await r(t,i)}async invokeTool(e,t,i,r){var o,a;const s=Mn();i.tokenizationOptions&&this._tokenCountFuncs.set(s,i.tokenizationOptions.countTokens);try{if(i.toolInvocationToken&&!bO(i.toolInvocationToken))throw new Error("Invalid tool invocation token");if((t===Py||t===Ik)&&!vt(e,"chatParticipantPrivate"))throw new Error(`Invalid tool: ${t}`);const l=((o=this._toolInputProcessors.get(t))==null?void 0:o.processInput(i.input))??i.input,c=await this._proxy.$invokeTool({toolId:t,callId:s,parameters:l,tokenBudget:(a=i.tokenizationOptions)==null?void 0:a.tokenBudget,context:i.toolInvocationToken,chatRequestId:vt(e,"chatParticipantPrivate")?i.chatRequestId:void 0,chatInteractionId:vt(e,"chatParticipantPrivate")?i.chatInteractionId:void 0},r);return n1.to(jn(c))}finally{this._tokenCountFuncs.delete(s)}}$onDidChangeTools(e){this._allTools.clear();for(const t of e)this._allTools.set(t.id,t)}getTools(e){return Array.from(this._allTools.values()).map(t=>c0.to(t)).filter(t=>{switch(t.name){case Py:case Ik:case KO:return vt(e,"chatParticipantPrivate");default:return!0}})}async $invokeTool(e,t){var o,a;const i=this._registeredTools.get(e.toolId);if(!i)throw new Error(`Unknown tool ${e.toolId}`);const r={input:e.parameters,toolInvocationToken:e.context};vt(i.extension,"chatParticipantPrivate")&&(r.chatRequestId=e.chatRequestId,r.chatInteractionId=e.chatInteractionId,r.chatSessionId=(o=e.context)==null?void 0:o.sessionId,((a=e.toolSpecificData)==null?void 0:a.kind)==="terminal"&&(r.terminalCommand=e.toolSpecificData.command)),vt(i.extension,"chatParticipantAdditions")&&e.modelId&&(r.model=await this.getModel(e.modelId,i.extension)),e.tokenBudget!==void 0&&(r.tokenizationOptions={tokenBudget:e.tokenBudget,countTokens:this._tokenCountFuncs.get(e.callId)||((l,c=Pt.None)=>this._proxy.$countTokensForInvocation(e.callId,l,c))});const s=await UI(Promise.resolve(i.tool.invoke(r,t)),t);if(!s)throw new qr;return n1.from(s,i.extension)}async getModel(e,t){let i;if(e&&(i=await this._languageModels.getLanguageModelByIdentifier(t,e)),!i&&(i=await this._languageModels.getDefaultLanguageModel(t),!i))throw new Error("Language model unavailable");return i}async $prepareToolInvocation(e,t,i){const r=this._registeredTools.get(e);if(!r)throw new Error(`Unknown tool ${e}`);const s={input:t};if(vt(r.extension,"chatParticipantPrivate")&&r.tool.prepareInvocation2){const o=await r.tool.prepareInvocation2(s,i);return o?{confirmationMessages:o.confirmationMessages?{title:o.confirmationMessages.title,message:typeof o.confirmationMessages.message=="string"?o.confirmationMessages.message:Le.from(o.confirmationMessages.message)}:void 0,toolSpecificData:{kind:"terminal",language:o.language,command:o.command}}:void 0}else if(r.tool.prepareInvocation){const o=await r.tool.prepareInvocation(s,i);return o?((o.pastTenseMessage||o.presentation)&&$(r.extension,"chatParticipantPrivate"),{confirmationMessages:o.confirmationMessages?{title:o.confirmationMessages.title,message:typeof o.confirmationMessages.message=="string"?o.confirmationMessages.message:Le.from(o.confirmationMessages.message)}:void 0,invocationMessage:Le.fromStrict(o.invocationMessage),pastTenseMessage:Le.fromStrict(o.pastTenseMessage),presentation:o.presentation}):void 0}}registerTool(e,t,i){return this._registeredTools.set(t,{extension:e,tool:i}),this._proxy.$registerTool(t),Se(()=>{this._registeredTools.delete(t),this._proxy.$unregisterTool(t)})}}class tF{constructor(e,t,i,r){this._documents=t,this._commands=i,this._uriTransformer=r,this._languageIds=[],this._handlePool=0,this._ids=new Set,this._proxy=e.getProxy(Z.MainThreadLanguages)}$acceptLanguageIds(e){this._languageIds=e}async getLanguages(){return this._languageIds.slice(0)}async changeLanguage(e,t){await this._proxy.$changeLanguage(e,t);const i=this._documents.getDocumentData(e);if(!i)throw new Error(`document '${e.toString()}' NOT found`);return i.document}async tokenAtPosition(e,t){const i=e.version,r=nt.from(t),s=await this._proxy.$tokensAtPosition(e.uri,r),o={type:vo.Other,range:e.getWordRangeAtPosition(t)??new Oe(t.line,t.character,t.line,t.character)};if(!s)return o;const a={range:W.to(s.range),type:Tb.to(s.type)};return!a.range.contains(t)||i!==e.version?o:a}createLanguageStatusItem(e,t,i){const r=this._handlePool++,s=this._proxy,o=this._ids,a=`${e.identifier.value}/${t}`;if(o.has(a))throw new Error(`LanguageStatusItem with id '${t}' ALREADY exists`);o.add(a);const l={selector:i,id:t,name:e.displayName??e.name,severity:Cc.Information,command:void 0,text:"",detail:"",busy:!1};let c;const u=new Ie,d=()=>{if(c==null||c.dispose(),!o.has(a)){console.warn(`LanguageStatusItem (${t}) from ${e.identifier.value} has been disposed and CANNOT be updated anymore`);return}c=B9(()=>{u.clear(),this._proxy.$setLanguageStatus(r,{id:a,name:l.name??e.displayName??e.name,source:e.displayName??e.name,selector:Pu.from(l.selector,this._uriTransformer),label:l.text,detail:l.detail??"",severity:l.severity===Cc.Error?qt.Error:l.severity===Cc.Warning?qt.Warning:qt.Info,command:l.command&&this._commands.toInternal(l.command,u),accessibilityInfo:l.accessibilityInformation,busy:l.busy})},0)},f={dispose(){u.dispose(),c==null||c.dispose(),s.$removeLanguageStatus(r),o.delete(a)},get id(){return l.id},get name(){return l.name},set name(p){l.name=p,d()},get selector(){return l.selector},set selector(p){l.selector=p,d()},get text(){return l.text},set text(p){l.text=p,d()},set text2(p){$(e,"languageStatusText"),l.text=p,d()},get text2(){return $(e,"languageStatusText"),l.text},get detail(){return l.detail},set detail(p){l.detail=p,d()},get severity(){return l.severity},set severity(p){l.severity=p,d()},get accessibilityInformation(){return l.accessibilityInformation},set accessibilityInformation(p){l.accessibilityInformation=p,d()},get command(){return l.command},set command(p){l.command=p,d()},get busy(){return l.busy},set busy(p){l.busy=p,d()}};return d(),f}}function nF(n){return n&&n.title}let Ry=class{constructor(e,t){this._logService=t,this._proxy=e.getProxy(Z.MainThreadMessageService)}showMessage(e,t,i,r,s){const o={source:{identifier:e.identifier,label:e.displayName||e.name}};let a;typeof r=="string"||nF(r)?a=[r,...s]:(o.modal=r==null?void 0:r.modal,o.useCustom=r==null?void 0:r.useCustom,o.detail=r==null?void 0:r.detail,a=s),o.useCustom&&$(e,"resolvers");const l=[];let c=!1;for(let u=0;u<a.length;u++){const d=a[u];if(typeof d=="string")l.push({title:d,handle:u,isCloseAffordance:!1});else if(typeof d=="object"){const{title:f,isCloseAffordance:p}=d;l.push({title:f,isCloseAffordance:!!p,handle:u}),p&&(c?this._logService.warn(`[${e.identifier}] Only one message item can have 'isCloseAffordance':`,d):c=!0)}else this._logService.warn(`[${e.identifier}] Invalid message item:`,d)}return this._proxy.$showMessage(t,i,o,l).then(u=>{if(typeof u=="number")return a[u]})}};Ry=V([F(1,ct)],Ry);class kv{constructor(e,t,i,r){this.start=e,this.deletedCount=t,this.deletedItems=i,this.items=r}asApiEvent(){return{range:new Ss(this.start,this.start+this.deletedCount),addedCells:this.items.map(e=>e.apiCell),removedCells:this.deletedItems}}}class Ly{static asModelAddData(e){return{EOL:e.eol,lines:e.source,languageId:e.language,uri:e.uri,isDirty:!1,versionId:1,encoding:"utf8"}}constructor(e,t,i){this.notebook=e,this._extHostDocument=t,this._cellData=i,this.handle=i.handle,this.uri=y.revive(i.uri),this.cellKind=i.cellKind,this._outputs=i.outputs.map(Ao.to),this._internalMetadata=i.internalMetadata??{},this._metadata=Object.freeze(i.metadata??{}),this._previousResult=Object.freeze(Ou.to(i.internalMetadata??{}))}get internalMetadata(){return this._internalMetadata}get apiCell(){if(!this._apiCell){const e=this,t=this._extHostDocument.getDocument(this.uri);if(!t)throw new Error(`MISSING extHostDocument for notebook cell: ${this.uri}`);const i={get index(){return e.notebook.getCellIndex(e)},notebook:e.notebook.apiNotebook,kind:of.to(this._cellData.cellKind),document:t.document,get mime(){return e._mime},set mime(r){e._mime=r},get outputs(){return e._outputs.slice(0)},get metadata(){return e._metadata},get executionSummary(){return e._previousResult}};this._apiCell=Object.freeze(i)}return this._apiCell}setOutputs(e){this._outputs=e.map(Ao.to)}setOutputItems(e,t,i){const r=i.map(Mu.to),s=this._outputs.find(o=>o.id===e);if(s&&(t||(s.items.length=0),s.items.push(...r),s.items.length>1&&s.items.every(o=>NC(o.mime)))){const o=new Map,a=[];s.items.forEach(l=>{let c;o.has(l.mime)?c=o.get(l.mime):(c=[],o.set(l.mime,c),a.push(l.mime)),c.push(l.data)}),s.items.length=0,a.forEach(l=>{const c=AR(o.get(l));s.items.push({mime:l,data:c.data.buffer})})}}setMetadata(e){this._metadata=Object.freeze(e)}setInternalMetadata(e){this._internalMetadata=e,this._previousResult=Object.freeze(Ou.to(e))}setMime(e){}}const j1=class j1{constructor(e,t,i,r,s){this._proxy=e,this._textDocumentsAndEditors=t,this._textDocuments=i,this.uri=r,this.handle=j1._handlePool++,this._cells=[],this._versionId=0,this._isDirty=!1,this._disposed=!1,this._notebookType=s.viewType,this._metadata=Object.freeze(s.metadata??Object.create(null)),this._spliceNotebookCells([[0,0,s.cells]],!0,void 0),this._versionId=s.versionId}dispose(){this._disposed=!0}get versionId(){return this._versionId}get apiNotebook(){if(!this._notebook){const e=this,t={get uri(){return e.uri},get version(){return e._versionId},get notebookType(){return e._notebookType},get isDirty(){return e._isDirty},get isUntitled(){return e.uri.scheme===oe.untitled},get isClosed(){return e._disposed},get metadata(){return e._metadata},get cellCount(){return e._cells.length},cellAt(i){return i=e._validateIndex(i),e._cells[i].apiCell},getCells(i){return(i?e._getCells(i):e._cells).map(s=>s.apiCell)},save(){return e._save()},[Symbol.for("debug.description")](){return`NotebookDocument(${this.uri.toString()})`}};this._notebook=Object.freeze(t)}return this._notebook}acceptDocumentPropertiesChanged(e){e.metadata&&(this._metadata=Object.freeze({...this._metadata,...e.metadata}))}acceptDirty(e){this._isDirty=e}acceptModelChanged(e,t,i){this._versionId=e.versionId,this._isDirty=t,this.acceptDocumentPropertiesChanged({metadata:i});const r={notebook:this.apiNotebook,metadata:i,cellChanges:[],contentChanges:[]},s=[];for(const a of e.rawEvents)a.kind===Ji.ModelChange?this._spliceNotebookCells(a.changes,!1,r.contentChanges):a.kind===Ji.Move?this._moveCells(a.index,a.length,a.newIdx,r.contentChanges):a.kind===Ji.Output?(this._setCellOutputs(a.index,a.outputs),s.push({cell:this._cells[a.index].apiCell,outputs:this._cells[a.index].apiCell.outputs})):a.kind===Ji.OutputItem?(this._setCellOutputItems(a.index,a.outputId,a.append,a.outputItems),s.push({cell:this._cells[a.index].apiCell,outputs:this._cells[a.index].apiCell.outputs})):a.kind===Ji.ChangeCellLanguage?(this._changeCellLanguage(a.index,a.language),s.push({cell:this._cells[a.index].apiCell,document:this._cells[a.index].apiCell.document})):a.kind===Ji.ChangeCellContent?s.push({cell:this._cells[a.index].apiCell,document:this._cells[a.index].apiCell.document}):a.kind===Ji.ChangeCellMime?this._changeCellMime(a.index,a.mime):a.kind===Ji.ChangeCellMetadata?(this._changeCellMetadata(a.index,a.metadata),s.push({cell:this._cells[a.index].apiCell,metadata:this._cells[a.index].apiCell.metadata})):a.kind===Ji.ChangeCellInternalMetadata&&(this._changeCellInternalMetadata(a.index,a.internalMetadata),s.push({cell:this._cells[a.index].apiCell,executionSummary:this._cells[a.index].apiCell.executionSummary}));const o=new Map;for(let a=0;a<s.length;a++){const l=s[a],c=o.get(l.cell);if(c===void 0){const u=r.cellChanges.push({document:void 0,executionSummary:void 0,metadata:void 0,outputs:void 0,...l});o.set(l.cell,u-1)}else r.cellChanges[c]={...r.cellChanges[c],...l}}return r}_validateIndex(e){return e=e|0,e<0?0:e>=this._cells.length?this._cells.length-1:e}_validateRange(e){let t=e.start|0,i=e.end|0;return t<0&&(t=0),i>this._cells.length&&(i=this._cells.length),e.with({start:t,end:i})}_getCells(e){e=this._validateRange(e);const t=[];for(let i=e.start;i<e.end;i++)t.push(this._cells[i]);return t}async _save(){return this._disposed?Promise.reject(new Error("Notebook has been closed")):this._proxy.$trySaveNotebook(this.uri)}_spliceNotebookCells(e,t,i){if(this._disposed)return;const r=[],s=[],o=[];if(e.reverse().forEach(a=>{const c=a[2].map(f=>{const p=new Ly(this,this._textDocumentsAndEditors,f);return t||s.push(Ly.asModelAddData(f)),p}),u=new kv(a[0],a[1],[],c),d=this._cells.splice(a[0],a[1],...c);for(const f of d)o.push(f.uri),u.deletedItems.push(f.apiCell);r.push(u)}),this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({addedDocuments:s,removedDocuments:o}),i)for(const a of r)i.push(a.asApiEvent())}_moveCells(e,t,i,r){const s=this._cells.splice(e,t);this._cells.splice(i,0,...s);const o=[new kv(e,t,s.map(a=>a.apiCell),[]),new kv(i,0,[],s)];for(const a of o)r.push(a.asApiEvent())}_setCellOutputs(e,t){this._cells[e].setOutputs(t)}_setCellOutputItems(e,t,i,r){this._cells[e].setOutputItems(t,i,r)}_changeCellLanguage(e,t){const i=this._cells[e];i.apiCell.document.languageId!==t&&this._textDocuments.$acceptModelLanguageChanged(i.uri,t)}_changeCellMime(e,t){const i=this._cells[e];i.apiCell.mime=t}_changeCellMetadata(e,t){this._cells[e].setMetadata(t)}_changeCellInternalMetadata(e,t){this._cells[e].setInternalMetadata(t)}getCellFromApiCell(e){return this._cells.find(t=>t.apiCell===e)}getCellFromIndex(e){return this._cells[e]}getCell(e){return this._cells.find(t=>t.handle===e)}getCellIndex(e){return this._cells.indexOf(e)}};j1._handlePool=0;let Ny=j1;const G1=class G1{constructor(e,t,i,r,s,o,a){this.id=e,this._proxy=t,this.notebookData=i,this._visibleRanges=r,this._selections=s,this._viewColumn=o,this.viewType=a,this._visible=!1}get apiEditor(){if(!this._editor){const e=this;this._editor={get notebook(){return e.notebookData.apiNotebook},get selection(){return e._selections[0]},set selection(t){this.selections=[t]},get selections(){return e._selections},set selections(t){if(!Array.isArray(t)||!t.every(Ss.isNotebookRange))throw Be("selections");e._selections=t,e._trySetSelections(t)},get visibleRanges(){return e._visibleRanges},revealRange(t,i){e._proxy.$tryRevealRange(e.id,Hr.from(t),i??mm.Default)},get viewColumn(){return e._viewColumn},get replOptions(){if(e.viewType==="repl")return{appendIndex:this.notebook.cellCount-1}},[Symbol.for("debug.description")](){return`NotebookEditor(${this.notebook.uri.toString()})`}},G1.apiEditorsToExtHost.set(this._editor,this)}return this._editor}get visible(){return this._visible}_acceptVisibility(e){this._visible=e}_acceptVisibleRanges(e){this._visibleRanges=e}_acceptSelections(e){this._selections=e}_trySetSelections(e){this._proxy.$trySetSelections(this.id,e.map(Hr.from))}_acceptViewColumn(e){this._viewColumn=e}};G1.apiEditorsToExtHost=new WeakMap;let Ef=G1;class Oy{constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==fe)return h2(this.right);let e=this;for(;e.parent!==fe&&e.parent.left!==e;)e=e.parent;return e.parent===fe?fe:e.parent}prev(){if(this.left!==fe)return x7(this.left);let e=this;for(;e.parent!==fe&&e.parent.right!==e;)e=e.parent;return e.parent===fe?fe:e.parent}detach(){this.parent=null,this.left=null,this.right=null}}var Me;(function(n){n[n.Black=0]="Black",n[n.Red=1]="Red"})(Me||(Me={}));const fe=new Oy(null,Me.Black);fe.parent=fe;fe.left=fe;fe.right=fe;fe.color=Me.Black;function h2(n){for(;n.left!==fe;)n=n.left;return n}function x7(n){for(;n.right!==fe;)n=n.right;return n}function f2(n){return n===fe?0:n.size_left+n.piece.length+f2(n.right)}function p2(n){return n===fe?0:n.lf_left+n.piece.lineFeedCnt+p2(n.right)}function Iv(){fe.parent=fe}function ih(n,e){const t=e.right;t.size_left+=e.size_left+(e.piece?e.piece.length:0),t.lf_left+=e.lf_left+(e.piece?e.piece.lineFeedCnt:0),e.right=t.left,t.left!==fe&&(t.left.parent=e),t.parent=e.parent,e.parent===fe?n.root=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}function rh(n,e){const t=e.left;e.left=t.right,t.right!==fe&&(t.right.parent=e),t.parent=e.parent,e.size_left-=t.size_left+(t.piece?t.piece.length:0),e.lf_left-=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),e.parent===fe?n.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}function bp(n,e){let t,i;if(e.left===fe?(i=e,t=i.right):e.right===fe?(i=e,t=i.left):(i=h2(e.right),t=i.right),i===n.root){n.root=t,t.color=Me.Black,e.detach(),Iv(),n.root.parent=fe;return}const r=i.color===Me.Red;if(i===i.parent.left?i.parent.left=t:i.parent.right=t,i===e?(t.parent=i.parent,Pd(n,t)):(i.parent===e?t.parent=i:t.parent=i.parent,Pd(n,t),i.left=e.left,i.right=e.right,i.parent=e.parent,i.color=e.color,e===n.root?n.root=i:e===e.parent.left?e.parent.left=i:e.parent.right=i,i.left!==fe&&(i.left.parent=i),i.right!==fe&&(i.right.parent=i),i.size_left=e.size_left,i.lf_left=e.lf_left,Pd(n,i)),e.detach(),t.parent.left===t){const o=f2(t),a=p2(t);if(o!==t.parent.size_left||a!==t.parent.lf_left){const l=o-t.parent.size_left,c=a-t.parent.lf_left;t.parent.size_left=o,t.parent.lf_left=a,ns(n,t.parent,l,c)}}if(Pd(n,t.parent),r){Iv();return}let s;for(;t!==n.root&&t.color===Me.Black;)t===t.parent.left?(s=t.parent.right,s.color===Me.Red&&(s.color=Me.Black,t.parent.color=Me.Red,ih(n,t.parent),s=t.parent.right),s.left.color===Me.Black&&s.right.color===Me.Black?(s.color=Me.Red,t=t.parent):(s.right.color===Me.Black&&(s.left.color=Me.Black,s.color=Me.Red,rh(n,s),s=t.parent.right),s.color=t.parent.color,t.parent.color=Me.Black,s.right.color=Me.Black,ih(n,t.parent),t=n.root)):(s=t.parent.left,s.color===Me.Red&&(s.color=Me.Black,t.parent.color=Me.Red,rh(n,t.parent),s=t.parent.left),s.left.color===Me.Black&&s.right.color===Me.Black?(s.color=Me.Red,t=t.parent):(s.left.color===Me.Black&&(s.right.color=Me.Black,s.color=Me.Red,ih(n,s),s=t.parent.left),s.color=t.parent.color,t.parent.color=Me.Black,s.left.color=Me.Black,rh(n,t.parent),t=n.root));t.color=Me.Black,Iv()}function Pk(n,e){for(Pd(n,e);e!==n.root&&e.parent.color===Me.Red;)if(e.parent===e.parent.parent.left){const t=e.parent.parent.right;t.color===Me.Red?(e.parent.color=Me.Black,t.color=Me.Black,e.parent.parent.color=Me.Red,e=e.parent.parent):(e===e.parent.right&&(e=e.parent,ih(n,e)),e.parent.color=Me.Black,e.parent.parent.color=Me.Red,rh(n,e.parent.parent))}else{const t=e.parent.parent.left;t.color===Me.Red?(e.parent.color=Me.Black,t.color=Me.Black,e.parent.parent.color=Me.Red,e=e.parent.parent):(e===e.parent.left&&(e=e.parent,rh(n,e)),e.parent.color=Me.Black,e.parent.parent.color=Me.Red,ih(n,e.parent.parent))}n.root.color=Me.Black}function ns(n,e,t,i){for(;e!==n.root&&e!==fe;)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}function Pd(n,e){let t=0,i=0;if(e!==n.root){for(;e!==n.root&&e===e.parent.right;)e=e.parent;if(e!==n.root)for(e=e.parent,t=f2(e.left)-e.size_left,i=p2(e.left)-e.lf_left,e.size_left+=t,e.lf_left+=i;e!==n.root&&(t!==0||i!==0);)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}}const Kr=65535;function E7(n){let e;return n[n.length-1]<65536?e=new Uint16Array(n.length):e=new Uint32Array(n.length),e.set(n,0),e}class iF{constructor(e,t,i,r,s){this.lineStarts=e,this.cr=t,this.lf=i,this.crlf=r,this.isBasicASCII=s}}function ls(n,e=!0){const t=[0];let i=1;for(let r=0,s=n.length;r<s;r++){const o=n.charCodeAt(r);o===P.CarriageReturn?r+1<s&&n.charCodeAt(r+1)===P.LineFeed?(t[i++]=r+2,r++):t[i++]=r+1:o===P.LineFeed&&(t[i++]=r+1)}return e?E7(t):t}function rF(n,e){n.length=0,n[0]=0;let t=1,i=0,r=0,s=0,o=!0;for(let l=0,c=e.length;l<c;l++){const u=e.charCodeAt(l);u===P.CarriageReturn?l+1<c&&e.charCodeAt(l+1)===P.LineFeed?(s++,n[t++]=l+2,l++):(i++,n[t++]=l+1):u===P.LineFeed?(r++,n[t++]=l+1):o&&u!==P.Tab&&(u<32||u>126)&&(o=!1)}const a=new iF(E7(n),i,r,s,o);return n.length=0,a}class Jn{constructor(e,t,i,r,s){this.bufferIndex=e,this.start=t,this.end=i,this.lineFeedCnt=r,this.length=s}}class ea{constructor(e,t){this.buffer=e,this.lineStarts=t}}class sF{constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==fe&&e.iterate(e.root,i=>(i!==fe&&this._pieces.push(i.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}}class oF{constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartOffset<=e&&i.nodeStartOffset+i.node.piece.length>=e)return i}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartLineNumber&&i.nodeStartLineNumber<e&&i.nodeStartLineNumber+i.node.piece.lineFeedCnt>=e)return i}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1;const i=this._cache;for(let r=0;r<i.length;r++){const s=i[r];if(s.node.parent===null||s.nodeStartOffset>=e){i[r]=null,t=!0;continue}}if(t){const r=[];for(const s of i)s!==null&&r.push(s);this._cache=r}}}class aF{constructor(e,t,i){this.create(e,t,i)}create(e,t,i){this._buffers=[new ea("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=fe,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=i;let r=null;for(let s=0,o=e.length;s<o;s++)if(e[s].buffer.length>0){e[s].lineStarts||(e[s].lineStarts=ls(e[s].buffer));const a=new Jn(s+1,{line:0,column:0},{line:e[s].lineStarts.length-1,column:e[s].buffer.length-e[s].lineStarts[e[s].lineStarts.length-1]},e[s].lineStarts.length-1,e[s].buffer.length);this._buffers.push(e[s]),r=this.rbInsertRight(r,a)}this._searchCache=new oF(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){const t=Kr,i=t-Math.floor(t/3),r=i*2;let s="",o=0;const a=[];if(this.iterate(this.root,l=>{const c=this.getNodeContent(l),u=c.length;if(o<=i||o+u<r)return s+=c,o+=u,!0;const d=s.replace(/\r\n|\r|\n/g,e);return a.push(new ea(d,ls(d))),s=c,o=u,!0}),o>0){const l=s.replace(/\r\n|\r|\n/g,e);a.push(new ea(l,ls(l)))}this.create(a,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new sF(this,e)}equal(e){if(this.getLength()!==e.getLength()||this.getLineCount()!==e.getLineCount())return!1;let t=0;return this.iterate(this.root,r=>{if(r===fe)return!0;const s=this.getNodeContent(r),o=s.length,a=e.nodeAt(t),l=e.nodeAt(t+o),c=e.getValueInRange2(a,l);return t+=o,s===c})}getOffsetAt(e,t){let i=0,r=this.root;for(;r!==fe;)if(r.left!==fe&&r.lf_left+1>=e)r=r.left;else if(r.lf_left+r.piece.lineFeedCnt+1>=e){i+=r.size_left;const s=this.getAccumulatedValue(r,e-r.lf_left-2);return i+=s+t-1}else e-=r.lf_left+r.piece.lineFeedCnt,i+=r.size_left+r.piece.length,r=r.right;return i}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,i=0;const r=e;for(;t!==fe;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){const s=this.getIndexOf(t,e-t.size_left);if(i+=t.lf_left+s.index,s.index===0){const o=this.getOffsetAt(i+1,1),a=r-o;return new Ii(i+1,a+1)}return new Ii(i+1,s.remainder+1)}else if(e-=t.size_left+t.piece.length,i+=t.lf_left+t.piece.lineFeedCnt,t.right===fe){const s=this.getOffsetAt(i+1,1),o=r-e-s;return new Ii(i+1,o+1)}else t=t.right;return new Ii(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";const i=this.nodeAt2(e.startLineNumber,e.startColumn),r=this.nodeAt2(e.endLineNumber,e.endColumn),s=this.getValueInRange2(i,r);return t?t!==this._EOL||!this._EOLNormalized?s.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this._EOLNormalized?s:s.replace(/\r\n|\r|\n/g,t):s}getValueInRange2(e,t){if(e.node===t.node){const a=e.node,l=this._buffers[a.piece.bufferIndex].buffer,c=this.offsetInBuffer(a.piece.bufferIndex,a.piece.start);return l.substring(c+e.remainder,c+t.remainder)}let i=e.node;const r=this._buffers[i.piece.bufferIndex].buffer,s=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);let o=r.substring(s+e.remainder,s+i.piece.length);for(i=i.next();i!==fe;){const a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(i===t.node){o+=a.substring(l,l+t.remainder);break}else o+=a.substr(l,i.piece.length);i=i.next()}return o}getLinesContent(){const e=[];let t=0,i="",r=!1;return this.iterate(this.root,s=>{if(s===fe)return!0;const o=s.piece;let a=o.length;if(a===0)return!0;const l=this._buffers[o.bufferIndex].buffer,c=this._buffers[o.bufferIndex].lineStarts,u=o.start.line,d=o.end.line;let f=c[u]+o.start.column;if(r&&(l.charCodeAt(f)===P.LineFeed&&(f++,a--),e[t++]=i,i="",r=!1,a===0))return!0;if(u===d)return!this._EOLNormalized&&l.charCodeAt(f+a-1)===P.CarriageReturn?(r=!0,i+=l.substr(f,a-1)):i+=l.substr(f,a),!0;i+=this._EOLNormalized?l.substring(f,Math.max(f,c[u+1]-this._EOLLength)):l.substring(f,c[u+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;for(let p=u+1;p<d;p++)i=this._EOLNormalized?l.substring(c[p],c[p+1]-this._EOLLength):l.substring(c[p],c[p+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;return!this._EOLNormalized&&l.charCodeAt(c[d]+o.end.column-1)===P.CarriageReturn?(r=!0,o.end.column===0?t--:i=l.substr(c[d],o.end.column-1)):i=l.substr(c[d],o.end.column),!0}),r&&(e[t++]=i,i=""),e[t++]=i,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(e){if(e.remainder===e.node.piece.length){const t=e.node.next();if(!t)return 0;const i=this._buffers[t.piece.bufferIndex],r=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return i.buffer.charCodeAt(r)}else{const t=this._buffers[e.node.piece.bufferIndex],r=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(r)}}getLineCharCode(e,t){const i=this.nodeAt2(e,t+1);return this._getCharCode(i)}getLineLength(e){if(e===this.getLineCount()){const t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}getCharCode(e){const t=this.nodeAt(e);return this._getCharCode(t)}getNearestChunk(e){const t=this.nodeAt(e);if(t.remainder===t.node.piece.length){const i=t.node.next();if(!i||i===fe)return"";const r=this._buffers[i.piece.bufferIndex],s=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return r.buffer.substring(s,s+i.piece.length)}else{const i=this._buffers[t.node.piece.bufferIndex],r=this.offsetInBuffer(t.node.piece.bufferIndex,t.node.piece.start),s=r+t.remainder,o=r+t.node.piece.length;return i.buffer.substring(s,o)}}findMatchesInNode(e,t,i,r,s,o,a,l,c,u,d){const f=this._buffers[e.piece.bufferIndex],p=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),w=this.offsetInBuffer(e.piece.bufferIndex,s),v=this.offsetInBuffer(e.piece.bufferIndex,o);let m;const x={line:0,column:0};let k,D;t._wordSeparators?(k=f.buffer.substring(w,v),D=B=>B+w,t.reset(0)):(k=f.buffer,D=B=>B,t.reset(w));do if(m=t.next(k),m){if(D(m.index)>=v)return u;this.positionInBuffer(e,D(m.index)-p,x);const B=this.getLineFeedCnt(e.piece.bufferIndex,s,x),T=x.line===s.line?x.column-s.column+r:x.column+1,z=T+m[0].length;if(d[u++]=lD(new lt(i+B,T,i+B,z),m,l),D(m.index)+m[0].length>=v||u>=c)return u}while(m);return u}findMatchesLineByLine(e,t,i,r){const s=[];let o=0;const a=new R6(t.wordSeparators,t.regex);let l=this.nodeAt2(e.startLineNumber,e.startColumn);if(l===null)return[];const c=this.nodeAt2(e.endLineNumber,e.endColumn);if(c===null)return[];let u=this.positionInBuffer(l.node,l.remainder);const d=this.positionInBuffer(c.node,c.remainder);if(l.node===c.node)return this.findMatchesInNode(l.node,a,e.startLineNumber,e.startColumn,u,d,t,i,r,o,s),s;let f=e.startLineNumber,p=l.node;for(;p!==c.node;){const v=this.getLineFeedCnt(p.piece.bufferIndex,u,p.piece.end);if(v>=1){const x=this._buffers[p.piece.bufferIndex].lineStarts,k=this.offsetInBuffer(p.piece.bufferIndex,p.piece.start),D=x[u.line+v],B=f===e.startLineNumber?e.startColumn:1;if(o=this.findMatchesInNode(p,a,f,B,u,this.positionInBuffer(p,D-k),t,i,r,o,s),o>=r)return s;f+=v}const m=f===e.startLineNumber?e.startColumn-1:0;if(f===e.endLineNumber){const x=this.getLineContent(f).substring(m,e.endColumn-1);return o=this._findMatchesInLine(t,a,x,e.endLineNumber,m,o,s,i,r),s}if(o=this._findMatchesInLine(t,a,this.getLineContent(f).substr(m),f,m,o,s,i,r),o>=r)return s;f++,l=this.nodeAt2(f,1),p=l.node,u=this.positionInBuffer(l.node,l.remainder)}if(f===e.endLineNumber){const v=f===e.startLineNumber?e.startColumn-1:0,m=this.getLineContent(f).substring(v,e.endColumn-1);return o=this._findMatchesInLine(t,a,m,e.endLineNumber,v,o,s,i,r),s}const w=f===e.startLineNumber?e.startColumn:1;return o=this.findMatchesInNode(c.node,a,f,w,u,d,t,i,r,o,s),s}_findMatchesInLine(e,t,i,r,s,o,a,l,c){const u=e.wordSeparators;if(!l&&e.simpleSearch){const f=e.simpleSearch,p=f.length,w=i.length;let v=-p;for(;(v=i.indexOf(f,v+p))!==-1;)if((!u||N5(u,i,w,v,p))&&(a[o++]=new hw(new lt(r,v+1+s,r,v+1+p+s),null),o>=c))return o;return o}let d;t.reset(0);do if(d=t.next(i),d&&(a[o++]=lD(new lt(r,d.index+1+s,r,d.index+1+d[0].length+s),d,l),o>=c))return o;while(d);return o}insert(e,t,i=!1){if(this._EOLNormalized=this._EOLNormalized&&i,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==fe){const{node:r,remainder:s,nodeStartOffset:o}=this.nodeAt(e),a=r.piece,l=a.bufferIndex,c=this.positionInBuffer(r,s);if(r.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&o+a.length===e&&t.length<Kr){this.appendToNode(r,t),this.computeBufferMetadata();return}if(o===e)this.insertContentToNodeLeft(t,r),this._searchCache.validate(e);else if(o+r.piece.length>e){const u=[];let d=new Jn(a.bufferIndex,c,a.end,this.getLineFeedCnt(a.bufferIndex,c,a.end),this.offsetInBuffer(l,a.end)-this.offsetInBuffer(l,c));if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.nodeCharCodeAt(r,s)===10){const v={line:d.start.line+1,column:0};d=new Jn(d.bufferIndex,v,d.end,this.getLineFeedCnt(d.bufferIndex,v,d.end),d.length-1),t+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(t))if(this.nodeCharCodeAt(r,s-1)===13){const v=this.positionInBuffer(r,s-1);this.deleteNodeTail(r,v),t="\r"+t,r.piece.length===0&&u.push(r)}else this.deleteNodeTail(r,c);else this.deleteNodeTail(r,c);const f=this.createNewPieces(t);d.length>0&&this.rbInsertRight(r,d);let p=r;for(let w=0;w<f.length;w++)p=this.rbInsertRight(p,f[w]);this.deleteNodes(u)}else this.insertContentToNodeRight(t,r)}else{const r=this.createNewPieces(t);let s=this.rbInsertLeft(null,r[0]);for(let o=1;o<r.length;o++)s=this.rbInsertRight(s,r[o])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===fe)return;const i=this.nodeAt(e),r=this.nodeAt(e+t),s=i.node,o=r.node;if(s===o){const f=this.positionInBuffer(s,i.remainder),p=this.positionInBuffer(s,r.remainder);if(i.nodeStartOffset===e){if(t===s.piece.length){const w=s.next();bp(this,s),this.validateCRLFWithPrevNode(w),this.computeBufferMetadata();return}this.deleteNodeHead(s,p),this._searchCache.validate(e),this.validateCRLFWithPrevNode(s),this.computeBufferMetadata();return}if(i.nodeStartOffset+s.piece.length===e+t){this.deleteNodeTail(s,f),this.validateCRLFWithNextNode(s),this.computeBufferMetadata();return}this.shrinkNode(s,f,p),this.computeBufferMetadata();return}const a=[],l=this.positionInBuffer(s,i.remainder);this.deleteNodeTail(s,l),this._searchCache.validate(e),s.piece.length===0&&a.push(s);const c=this.positionInBuffer(o,r.remainder);this.deleteNodeHead(o,c),o.piece.length===0&&a.push(o);const u=s.next();for(let f=u;f!==fe&&f!==o;f=f.next())a.push(f);const d=s.piece.length===0?s.prev():s;this.deleteNodes(a),this.validateCRLFWithNextNode(d),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){const i=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){const o=t.piece,a={line:o.start.line+1,column:0},l=new Jn(o.bufferIndex,a,o.end,this.getLineFeedCnt(o.bufferIndex,a,o.end),o.length-1);t.piece=l,e+=`
`,ns(this,t,-1,-1),t.piece.length===0&&i.push(t)}const r=this.createNewPieces(e);let s=this.rbInsertLeft(t,r[r.length-1]);for(let o=r.length-2;o>=0;o--)s=this.rbInsertLeft(s,r[o]);this.validateCRLFWithPrevNode(s),this.deleteNodes(i)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+=`
`);const i=this.createNewPieces(e),r=this.rbInsertRight(t,i[0]);let s=r;for(let o=1;o<i.length;o++)s=this.rbInsertRight(s,i[o]);this.validateCRLFWithPrevNode(r)}positionInBuffer(e,t,i){const r=e.piece,s=e.piece.bufferIndex,o=this._buffers[s].lineStarts,l=o[r.start.line]+r.start.column+t;let c=r.start.line,u=r.end.line,d=0,f=0,p=0;for(;c<=u&&(d=c+(u-c)/2|0,p=o[d],d!==u);)if(f=o[d+1],l<p)u=d-1;else if(l>=f)c=d+1;else break;return i?(i.line=d,i.column=l-p,null):{line:d,column:l-p}}getLineFeedCnt(e,t,i){if(i.column===0)return i.line-t.line;const r=this._buffers[e].lineStarts;if(i.line===r.length-1)return i.line-t.line;const s=r[i.line+1],o=r[i.line]+i.column;if(s>o+1)return i.line-t.line;const a=o-1;return this._buffers[e].buffer.charCodeAt(a)===13?i.line-t.line+1:i.line-t.line}offsetInBuffer(e,t){return this._buffers[e].lineStarts[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)bp(this,e[t])}createNewPieces(e){if(e.length>Kr){const u=[];for(;e.length>Kr;){const f=e.charCodeAt(Kr-1);let p;f===P.CarriageReturn||f>=55296&&f<=56319?(p=e.substring(0,Kr-1),e=e.substring(Kr-1)):(p=e.substring(0,Kr),e=e.substring(Kr));const w=ls(p);u.push(new Jn(this._buffers.length,{line:0,column:0},{line:w.length-1,column:p.length-w[w.length-1]},w.length-1,p.length)),this._buffers.push(new ea(p,w))}const d=ls(e);return u.push(new Jn(this._buffers.length,{line:0,column:0},{line:d.length-1,column:e.length-d[d.length-1]},d.length-1,e.length)),this._buffers.push(new ea(e,d)),u}let t=this._buffers[0].buffer.length;const i=ls(e,!1);let r=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&t!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},r=this._lastChangeBufferPos;for(let u=0;u<i.length;u++)i[u]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(t!==0)for(let u=0;u<i.length;u++)i[u]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+=e}const s=this._buffers[0].buffer.length,o=this._buffers[0].lineStarts.length-1,a=s-this._buffers[0].lineStarts[o],l={line:o,column:a},c=new Jn(0,r,l,this.getLineFeedCnt(0,r,l),s-t);return this._lastChangeBufferPos=l,[c]}getLinesRawContent(){return this.getContentOfSubTree(this.root)}getLineRawContent(e,t=0){let i=this.root,r="";const s=this._searchCache.get2(e);if(s){i=s.node;const o=this.getAccumulatedValue(i,e-s.nodeStartLineNumber-1),a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(s.nodeStartLineNumber+i.piece.lineFeedCnt===e)r=a.substring(l+o,l+i.piece.length);else{const c=this.getAccumulatedValue(i,e-s.nodeStartLineNumber);return a.substring(l+o,l+c-t)}}else{let o=0;const a=e;for(;i!==fe;)if(i.left!==fe&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const l=this.getAccumulatedValue(i,e-i.lf_left-2),c=this.getAccumulatedValue(i,e-i.lf_left-1),u=this._buffers[i.piece.bufferIndex].buffer,d=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return o+=i.size_left,this._searchCache.set({node:i,nodeStartOffset:o,nodeStartLineNumber:a-(e-1-i.lf_left)}),u.substring(d+l,d+c-t)}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const l=this.getAccumulatedValue(i,e-i.lf_left-2),c=this._buffers[i.piece.bufferIndex].buffer,u=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);r=c.substring(u+l,u+i.piece.length);break}else e-=i.lf_left+i.piece.lineFeedCnt,o+=i.size_left+i.piece.length,i=i.right}for(i=i.next();i!==fe;){const o=this._buffers[i.piece.bufferIndex].buffer;if(i.piece.lineFeedCnt>0){const a=this.getAccumulatedValue(i,0),l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return r+=o.substring(l,l+a-t),r}else{const a=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);r+=o.substr(a,i.piece.length)}i=i.next()}return r}computeBufferMetadata(){let e=this.root,t=1,i=0;for(;e!==fe;)t+=e.lf_left+e.piece.lineFeedCnt,i+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=i,this._searchCache.validate(this._length)}getIndexOf(e,t){const i=e.piece,r=this.positionInBuffer(e,t),s=r.line-i.start.line;if(this.offsetInBuffer(i.bufferIndex,i.end)-this.offsetInBuffer(i.bufferIndex,i.start)===t){const o=this.getLineFeedCnt(e.piece.bufferIndex,i.start,r);if(o!==s)return{index:o,remainder:0}}return{index:s,remainder:r.column}}getAccumulatedValue(e,t){if(t<0)return 0;const i=e.piece,r=this._buffers[i.bufferIndex].lineStarts,s=i.start.line+t+1;return s>i.end.line?r[i.end.line]+i.end.column-r[i.start.line]-i.start.column:r[s]-r[i.start.line]-i.start.column}deleteNodeTail(e,t){const i=e.piece,r=i.lineFeedCnt,s=this.offsetInBuffer(i.bufferIndex,i.end),o=t,a=this.offsetInBuffer(i.bufferIndex,o),l=this.getLineFeedCnt(i.bufferIndex,i.start,o),c=l-r,u=a-s,d=i.length+u;e.piece=new Jn(i.bufferIndex,i.start,o,l,d),ns(this,e,u,c)}deleteNodeHead(e,t){const i=e.piece,r=i.lineFeedCnt,s=this.offsetInBuffer(i.bufferIndex,i.start),o=t,a=this.getLineFeedCnt(i.bufferIndex,o,i.end),l=this.offsetInBuffer(i.bufferIndex,o),c=a-r,u=s-l,d=i.length+u;e.piece=new Jn(i.bufferIndex,o,i.end,a,d),ns(this,e,u,c)}shrinkNode(e,t,i){const r=e.piece,s=r.start,o=r.end,a=r.length,l=r.lineFeedCnt,c=t,u=this.getLineFeedCnt(r.bufferIndex,r.start,c),d=this.offsetInBuffer(r.bufferIndex,t)-this.offsetInBuffer(r.bufferIndex,s);e.piece=new Jn(r.bufferIndex,r.start,c,u,d),ns(this,e,d-a,u-l);const f=new Jn(r.bufferIndex,i,o,this.getLineFeedCnt(r.bufferIndex,i,o),this.offsetInBuffer(r.bufferIndex,o)-this.offsetInBuffer(r.bufferIndex,i)),p=this.rbInsertRight(e,f);this.validateCRLFWithPrevNode(p)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+=`
`);const i=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),r=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;const s=ls(t,!1);for(let p=0;p<s.length;p++)s[p]+=r;if(i){const p=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:r-p}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(s.slice(1));const o=this._buffers[0].lineStarts.length-1,a=this._buffers[0].buffer.length-this._buffers[0].lineStarts[o],l={line:o,column:a},c=e.piece.length+t.length,u=e.piece.lineFeedCnt,d=this.getLineFeedCnt(0,e.piece.start,l),f=d-u;e.piece=new Jn(e.piece.bufferIndex,e.piece.start,l,d,c),this._lastChangeBufferPos=l,ns(this,e,t.length,f)}nodeAt(e){let t=this.root;const i=this._searchCache.get(e);if(i)return{node:i.node,nodeStartOffset:i.nodeStartOffset,remainder:e-i.nodeStartOffset};let r=0;for(;t!==fe;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){r+=t.size_left;const s={node:t,remainder:e-t.size_left,nodeStartOffset:r};return this._searchCache.set(s),s}else e-=t.size_left+t.piece.length,r+=t.size_left+t.piece.length,t=t.right;return null}nodeAt2(e,t){let i=this.root,r=0;for(;i!==fe;)if(i.left!==fe&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const s=this.getAccumulatedValue(i,e-i.lf_left-2),o=this.getAccumulatedValue(i,e-i.lf_left-1);return r+=i.size_left,{node:i,remainder:Math.min(s+t-1,o),nodeStartOffset:r}}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const s=this.getAccumulatedValue(i,e-i.lf_left-2);if(s+t-1<=i.piece.length)return{node:i,remainder:s+t-1,nodeStartOffset:r};t-=i.piece.length-s;break}else e-=i.lf_left+i.piece.lineFeedCnt,r+=i.size_left+i.piece.length,i=i.right;for(i=i.next();i!==fe;){if(i.piece.lineFeedCnt>0){const s=this.getAccumulatedValue(i,0),o=this.offsetOfNode(i);return{node:i,remainder:Math.min(t-1,s),nodeStartOffset:o}}else if(i.piece.length>=t-1){const s=this.offsetOfNode(i);return{node:i,remainder:t-1,nodeStartOffset:s}}else t-=i.piece.length;i=i.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;const i=this._buffers[e.piece.bufferIndex],r=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return i.buffer.charCodeAt(r)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(e){if(typeof e=="string")return e.charCodeAt(0)===10;if(e===fe||e.piece.lineFeedCnt===0)return!1;const t=e.piece,i=this._buffers[t.bufferIndex].lineStarts,r=t.start.line,s=i[r]+t.start.column;return r===i.length-1||i[r+1]>s+1?!1:this._buffers[t.bufferIndex].buffer.charCodeAt(s)===10}endWithCR(e){return typeof e=="string"?e.charCodeAt(e.length-1)===13:e===fe||e.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){const t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){const i=[],r=this._buffers[e.piece.bufferIndex].lineStarts;let s;e.piece.end.column===0?s={line:e.piece.end.line-1,column:r[e.piece.end.line]-r[e.piece.end.line-1]-1}:s={line:e.piece.end.line,column:e.piece.end.column-1};const o=e.piece.length-1,a=e.piece.lineFeedCnt-1;e.piece=new Jn(e.piece.bufferIndex,e.piece.start,s,a,o),ns(this,e,-1,-1),e.piece.length===0&&i.push(e);const l={line:t.piece.start.line+1,column:0},c=t.piece.length-1,u=this.getLineFeedCnt(t.piece.bufferIndex,l,t.piece.end);t.piece=new Jn(t.piece.bufferIndex,l,t.piece.end,u,c),ns(this,t,-1,-1),t.piece.length===0&&i.push(t);const d=this.createNewPieces(`\r
`);this.rbInsertRight(e,d[0]);for(let f=0;f<i.length;f++)bp(this,i[f])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const i=t.next();if(this.startWithLF(i)){if(e+=`
`,i.piece.length===1)bp(this,i);else{const r=i.piece,s={line:r.start.line+1,column:0},o=r.length-1,a=this.getLineFeedCnt(r.bufferIndex,s,r.end);i.piece=new Jn(r.bufferIndex,s,r.end,a,o),ns(this,i,-1,-1)}return!0}}return!1}iterate(e,t){if(e===fe)return t(fe);const i=this.iterate(e.left,t);return i&&t(e)&&this.iterate(e.right,t)}getNodeContent(e){if(e===fe)return"";const t=this._buffers[e.piece.bufferIndex],i=e.piece,r=this.offsetInBuffer(i.bufferIndex,i.start),s=this.offsetInBuffer(i.bufferIndex,i.end);return t.buffer.substring(r,s)}getPieceContent(e){const t=this._buffers[e.bufferIndex],i=this.offsetInBuffer(e.bufferIndex,e.start),r=this.offsetInBuffer(e.bufferIndex,e.end);return t.buffer.substring(i,r)}rbInsertRight(e,t){const i=new Oy(t,Me.Red);if(i.left=fe,i.right=fe,i.parent=fe,i.size_left=0,i.lf_left=0,this.root===fe)this.root=i,i.color=Me.Black;else if(e.right===fe)e.right=i,i.parent=e;else{const s=h2(e.right);s.left=i,i.parent=s}return Pk(this,i),i}rbInsertLeft(e,t){const i=new Oy(t,Me.Red);if(i.left=fe,i.right=fe,i.parent=fe,i.size_left=0,i.lf_left=0,this.root===fe)this.root=i,i.color=Me.Black;else if(e.left===fe)e.left=i,i.parent=e;else{const r=x7(e.left);r.right=i,i.parent=r}return Pk(this,i),i}getContentOfSubTree(e){let t="";return this.iterate(e,i=>(t+=this.getNodeContent(i),!0)),t}}var Is;(function(n){n[n.Unknown=0]="Unknown",n[n.Invalid=3]="Invalid",n[n.LF=1]="LF",n[n.CRLF=2]="CRLF"})(Is||(Is={}));function Cv(n){let e=0,t=0,i=0,r=Is.Unknown;for(let s=0,o=n.length;s<o;s++){const a=n.charCodeAt(s);a===P.CarriageReturn?(e===0&&(t=s),e++,s+1<o&&n.charCodeAt(s+1)===P.LineFeed?(r|=Is.CRLF,s++):r|=Is.Invalid,i=s+1):a===P.LineFeed&&(r|=Is.LF,e===0&&(t=s),e++,i=s+1)}return e===0&&(t=n.length),[e,t,n.length-i,r]}let Pv;function lF(){return Pv||(Pv=new TextDecoder("UTF-16LE")),Pv}function cF(n,e,t){const i=new Uint16Array(n.buffer,e,t);return t>0&&(i[0]===65279||i[0]===65534)?uF(n,e,t):lF().decode(i)}function uF(n,e,t){const i=[];let r=0;for(let s=0;s<t;s++){const o=nP(n,e);e+=2,i[r++]=String.fromCharCode(o)}return i.join("")}function yp(n){return n.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}class Yi{get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}constructor(e,t,i,r){this.oldPosition=e,this.oldText=t,this.newPosition=i,this.newText=r}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${yp(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${yp(this.oldText)}")`:`(replace@${this.oldPosition} "${yp(this.oldText)}" with "${yp(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,i){const r=t.length;Sp(e,r,i),i+=4;for(let s=0;s<r;s++)iP(e,t.charCodeAt(s),i),i+=2;return i}static _readString(e,t){const i=Ep(e,t);return t+=4,cF(e,t,i)}writeSize(){return 8+Yi._writeStringSize(this.oldText)+Yi._writeStringSize(this.newText)}write(e,t){return Sp(e,this.oldPosition,t),t+=4,Sp(e,this.newPosition,t),t+=4,t=Yi._writeString(e,this.oldText,t),t=Yi._writeString(e,this.newText,t),t}static read(e,t,i){const r=Ep(e,t);t+=4;const s=Ep(e,t);t+=4;const o=Yi._readString(e,t);t+=Yi._writeStringSize(o);const a=Yi._readString(e,t);return t+=Yi._writeStringSize(a),i.push(new Yi(r,o,s,a)),t}}class uc extends Te{constructor(e,t,i,r,s,o,a){super(),this._onDidChangeContent=this._register(new L),this.onDidChangeContent=this._onDidChangeContent.event,this._BOM=t,this._mightContainNonBasicASCII=!o,this._mightContainRTL=r,this._mightContainUnusualLineTerminators=s,this._pieceTree=new aF(e,i,a)}equals(e){return!(e instanceof uc)||this._BOM!==e._BOM||this.getEOL()!==e.getEOL()?!1:this._pieceTree.equal(e._pieceTree)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){const i=e+t,r=this.getPositionAt(e),s=this.getPositionAt(i);return new lt(r.lineNumber,r.column,s.lineNumber,s.column)}getValueInRange(e,t=os.TextDefined){if(e.isEmpty())return"";const i=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,i)}getValueLengthInRange(e,t=os.TextDefined){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;const i=this.getOffsetAt(e.startLineNumber,e.startColumn),r=this.getOffsetAt(e.endLineNumber,e.endColumn);let s=0;const o=this._getEndOfLine(t),a=this.getEOL();if(o.length!==a.length){const l=o.length-a.length,c=e.endLineNumber-e.startLineNumber;s=l*c}return r-i+s}getCharacterCountInRange(e,t=os.TextDefined){if(this._mightContainNonBasicASCII){let i=0;const r=e.startLineNumber,s=e.endLineNumber;for(let o=r;o<=s;o++){const a=this.getLineContent(o),l=o===r?e.startColumn-1:0,c=o===s?e.endColumn-1:a.length;for(let u=l;u<c;u++)i_(a.charCodeAt(u))?(i=i+1,u=u+1):i=i+1}return i+=this._getEndOfLine(t).length*(s-r),i}return this.getValueLengthInRange(e,t)}getNearestChunk(e){return this._pieceTree.getNearestChunk(e)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getCharCode(e){return this._pieceTree.getCharCode(e)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineMinColumn(e){return 1}getLineMaxColumn(e){return this.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){const t=nv(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){const t=s9(this.getLineContent(e));return t===-1?0:t+2}_getEndOfLine(e){switch(e){case os.LF:return`
`;case os.CRLF:return`\r
`;case os.TextDefined:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,i){let r=this._mightContainRTL,s=this._mightContainUnusualLineTerminators,o=this._mightContainNonBasicASCII,a=!0,l=[];for(let v=0;v<e.length;v++){const m=e[v];a&&m._isTracked&&(a=!1);const x=m.range;if(m.text){let z=!0;o||(z=!h9(m.text),o=z),!r&&z&&(r=LI(m.text)),!s&&z&&(s=NI(m.text))}let k="",D=0,B=0,T=0;if(m.text){let z;[D,B,T,z]=Cv(m.text);const K=this.getEOL(),Ee=K===`\r
`?Is.CRLF:Is.LF;z===Is.Unknown||z===Ee?k=m.text:k=m.text.replace(/\r\n|\r|\n/g,K)}l[v]={sortIndex:v,identifier:m.identifier||null,range:x,rangeOffset:this.getOffsetAt(x.startLineNumber,x.startColumn),rangeLength:this.getValueLengthInRange(x),text:k,eolCount:D,firstLineLength:B,lastLineLength:T,forceMoveMarkers:!!m.forceMoveMarkers,isAutoWhitespaceEdit:m.isAutoWhitespaceEdit||!1}}l.sort(uc._sortOpsAscending);let c=!1;for(let v=0,m=l.length-1;v<m;v++){const x=l[v].range.getEndPosition(),k=l[v+1].range.getStartPosition();if(k.isBeforeOrEqual(x)){if(k.isBefore(x))throw new Error("Overlapping ranges are not allowed!");c=!0}}a&&(l=this._reduceOperations(l));const u=i||t?uc._getInverseEditRanges(l):[],d=[];if(t)for(let v=0;v<l.length;v++){const m=l[v],x=u[v];if(m.isAutoWhitespaceEdit&&m.range.isEmpty())for(let k=x.startLineNumber;k<=x.endLineNumber;k++){let D="";k===x.startLineNumber&&(D=this.getLineContent(m.range.startLineNumber),nv(D)!==-1)||d.push({lineNumber:k,oldContent:D})}}let f=null;if(i){let v=0;f=[];for(let m=0;m<l.length;m++){const x=l[m],k=u[m],D=this.getValueInRange(x.range),B=x.rangeOffset+v;v+=x.text.length-D.length,f[m]={sortIndex:x.sortIndex,identifier:x.identifier,range:k,text:D,textChange:new Yi(x.rangeOffset,D,B,x.text)}}c||f.sort((m,x)=>m.sortIndex-x.sortIndex)}this._mightContainRTL=r,this._mightContainUnusualLineTerminators=s,this._mightContainNonBasicASCII=o;const p=this._doApplyEdits(l);let w=null;if(t&&d.length>0){d.sort((v,m)=>m.lineNumber-v.lineNumber),w=[];for(let v=0,m=d.length;v<m;v++){const x=d[v].lineNumber;if(v>0&&d[v-1].lineNumber===x)continue;const k=d[v].oldContent,D=this.getLineContent(x);D.length===0||D===k||nv(D)!==-1||w.push(x)}}return this._onDidChangeContent.fire(),new AA(f,p,w)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1;const i=e[0].range,r=e[e.length-1].range,s=new lt(i.startLineNumber,i.startColumn,r.endLineNumber,r.endColumn);let o=i.startLineNumber,a=i.startColumn;const l=[];for(let p=0,w=e.length;p<w;p++){const v=e[p],m=v.range;t=t||v.forceMoveMarkers,l.push(this.getValueInRange(new lt(o,a,m.startLineNumber,m.startColumn))),v.text.length>0&&l.push(v.text),o=m.endLineNumber,a=m.endColumn}const c=l.join(""),[u,d,f]=Cv(c);return{sortIndex:0,identifier:e[0].identifier,range:s,rangeOffset:this.getOffsetAt(s.startLineNumber,s.startColumn),rangeLength:this.getValueLengthInRange(s,os.TextDefined),text:c,eolCount:u,firstLineLength:d,lastLineLength:f,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(e){e.sort(uc._sortOpsDescending);const t=[];for(let i=0;i<e.length;i++){const r=e[i],s=r.range.startLineNumber,o=r.range.startColumn,a=r.range.endLineNumber,l=r.range.endColumn;if(s===a&&o===l&&r.text.length===0)continue;r.text?(this._pieceTree.delete(r.rangeOffset,r.rangeLength),this._pieceTree.insert(r.rangeOffset,r.text,!0)):this._pieceTree.delete(r.rangeOffset,r.rangeLength);const c=new lt(s,o,a,l);t.push({range:c,rangeLength:r.rangeLength,text:r.text,rangeOffset:r.rangeOffset,forceMoveMarkers:r.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,i,r){return this._pieceTree.findMatchesLineByLine(e,t,i,r)}getPieceTree(){return this._pieceTree}static _getInverseEditRange(e,t){const i=e.startLineNumber,r=e.startColumn,[s,o,a]=Cv(t);let l;if(t.length>0){const c=s+1;c===1?l=new lt(i,r,i,r+o):l=new lt(i,r,i+c-1,a+1)}else l=new lt(i,r,i,r);return l}static _getInverseEditRanges(e){const t=[];let i=0,r=0,s=null;for(let o=0,a=e.length;o<a;o++){const l=e[o];let c,u;s?s.range.endLineNumber===l.range.startLineNumber?(c=i,u=r+(l.range.startColumn-s.range.endColumn)):(c=i+(l.range.startLineNumber-s.range.endLineNumber),u=l.range.startColumn):(c=l.range.startLineNumber,u=l.range.startColumn);let d;if(l.text.length>0){const f=l.eolCount+1;f===1?d=new lt(c,u,c,u+l.firstLineLength):d=new lt(c,u,c+f-1,l.lastLineLength+1)}else d=new lt(c,u,c,u);i=d.endLineNumber,r=d.endColumn,t.push(d),s=l}return t}static _sortOpsAscending(e,t){const i=lt.compareRangesUsingEnds(e.range,t.range);return i===0?e.sortIndex-t.sortIndex:i}static _sortOpsDescending(e,t){const i=lt.compareRangesUsingEnds(e.range,t.range);return i===0?t.sortIndex-e.sortIndex:-i}}class dF{constructor(e,t,i,r,s,o,a,l,c){this._chunks=e,this._bom=t,this._cr=i,this._lf=r,this._crlf=s,this._containsRTL=o,this._containsUnusualLineTerminators=a,this._isBasicASCII=l,this._normalizeEOL=c}_getEOL(e){const t=this._cr+this._lf+this._crlf,i=this._cr+this._crlf;return t===0?e===wh.LF?`
`:`\r
`:i>t/2?`\r
`:`
`}create(e){const t=this._getEOL(e),i=this._chunks;if(this._normalizeEOL&&(t===`\r
`&&(this._cr>0||this._lf>0)||t===`
`&&(this._cr>0||this._crlf>0)))for(let s=0,o=i.length;s<o;s++){const a=i[s].buffer.replace(/\r\n|\r|\n/g,t),l=ls(a);i[s]=new ea(a,l)}const r=new uc(i,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:r,disposable:r}}getFirstLineText(e){return this._chunks[0].buffer.substr(0,e).split(/\r\n|\r|\n/)[0]}}class Tk{constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(e.length===0)return;this.chunks.length===0&&g9(e)&&(this.BOM=p9,e=e.substr(1));const t=e.charCodeAt(e.length-1);t===P.CarriageReturn||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){!t&&e.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){const t=rF(this._tmpLineStarts,e);this.chunks.push(new ea(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,t.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=LI(e)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=NI(e)))}finish(e=!0){return this._finish(),new dF(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;const e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);const t=ls(e.buffer);e.lineStarts=t,this._previousChar===P.CarriageReturn&&this.cr++}}}class hF extends Te{constructor(e,t,i){super(),this._source=e,this._inputTextBuffer=t,this._outputs=i,this._outputTextBuffers=void 0}_getFullModelRange(e){const t=e.getLineCount();return new lt(1,1,t,this._getLineMaxColumn(e,t))}_getLineMaxColumn(e,t){if(t<1||t>e.getLineCount())throw new Error("Illegal value for lineNumber");return e.getLineLength(t)+1}get inputTextBuffer(){if(!this._inputTextBuffer){const e=new Tk;e.acceptChunk(this._source);const t=e.finish(!0),{textBuffer:i,disposable:r}=t.create(wh.LF);this._inputTextBuffer=i,this._register(r)}return this._inputTextBuffer}get outputTextBuffers(){return this._outputTextBuffers||(this._outputTextBuffers=this._outputs.map(e=>{const t=new Tk;t.acceptChunk(e);const i=t.finish(!0),{textBuffer:r,disposable:s}=i.create(wh.LF);return this._register(s),r})),this._outputTextBuffers}findInInputs(e){const i=new aD(e,!1,!1,null).parseSearchRequest();if(!i)return[];const r=this._getFullModelRange(this.inputTextBuffer);return this.inputTextBuffer.findMatchesLineByLine(r,i,!0,5e3)}findInOutputs(e){const i=new aD(e,!1,!1,null).parseSearchRequest();return i?this.outputTextBuffers.map(r=>{const s=r.findMatchesLineByLine(this._getFullModelRange(r),i,!0,5e3);if(s.length!==0)return{textBuffer:r,matches:s}}).filter(r=>!!r):[]}}function Ak(n,e){let t=-1;const i=[];let r=[];return n.forEach(o=>{o.range.startLineNumber!==t&&r.length>0&&(i.push([...r]),r=[]),r.push(o),t=o.range.endLineNumber}),r.length>0&&i.push([...r]),i.map(o=>{const a=[],l=o[0].range.startLineNumber,c=o[o.length-1].range.endLineNumber;for(let u=l;u<=c;u++)a.push(e.getLineContent(u));return new T3(a.join(`
`)+`
`,o.map(u=>new lt(u.range.startLineNumber-1,u.range.startColumn-1,u.range.endLineNumber-1,u.range.endColumn-1)))})}const fF=De("remoteAgentService"),pF=De("IUserDataProfilesService");Object.freeze({id:"application",order:100,title:h(3747,"Application"),type:"object"});const gF=Object.freeze({id:"workbench",order:7,title:h(3748,"Workbench"),type:"object"}),mF=Object.freeze({id:"security",scope:Ft.APPLICATION,title:h(3749,"Security"),type:"object",order:7});Object.freeze({id:"problems",title:h(3750,"Problems"),type:"object",order:101});const _F=Object.freeze({id:"window",order:8,title:h(3751,"Window"),type:"object"}),vF={ConfigurationMigration:"base.contributions.configuration.migration"};class wF{constructor(){this.migrations=[],this._onDidRegisterConfigurationMigrations=new L,this.onDidRegisterConfigurationMigration=this._onDidRegisterConfigurationMigrations.event}registerConfigurationMigrations(e){this.migrations.push(...e)}}const jp=new wF;Cn.add(vF.ConfigurationMigration,jp);var Gc;let Rk=(Gc=class extends Te{constructor(e,t){super(),this.configurationService=e,this.workspaceService=t,this._register(this.workspaceService.onDidChangeWorkspaceFolders(async i=>{for(const r of i.added)await this.migrateConfigurationsForFolder(r,jp.migrations)})),this.migrateConfigurations(jp.migrations),this._register(jp.onDidRegisterConfigurationMigration(i=>this.migrateConfigurations(i)))}async migrateConfigurations(e){await this.migrateConfigurationsForFolder(void 0,e);for(const t of this.workspaceService.getWorkspace().folders)await this.migrateConfigurationsForFolder(t,e)}async migrateConfigurationsForFolder(e,t){await Promise.all([t.map(i=>this.migrateConfigurationsForFolderAndOverride(i,e==null?void 0:e.uri))])}async migrateConfigurationsForFolderAndOverride(e,t){const i=this.configurationService.inspect(e.key,{resource:t}),r=this.workspaceService.getWorkbenchState()===ug.WORKSPACE?[["user",dn.USER],["userLocal",dn.USER_LOCAL],["userRemote",dn.USER_REMOTE],["workspace",dn.WORKSPACE],["workspaceFolder",dn.WORKSPACE_FOLDER]]:[["user",dn.USER],["userLocal",dn.USER_LOCAL],["userRemote",dn.USER_REMOTE],["workspace",dn.WORKSPACE]];for(const[s,o]of r){const a=i[s];if(!a)continue;const l=[];if(a.value!==void 0){const c=await this.runMigration(e,s,a.value,t,void 0);for(const u of c??[])l.push([u,[]])}for(const{identifiers:c,value:u}of a.overrides??[])if(u!==void 0){const d=await this.runMigration(e,s,u,t,c);for(const f of d??[])l.push([f,c])}l.length&&await Promise.allSettled(l.map(async([[c,u],d])=>this.configurationService.updateValue(c,u.value,{resource:t,overrideIdentifiers:d},o)))}}async runMigration(e,t,i,r,s){const o=l=>{var d,f;const u=this.configurationService.inspect(l,{resource:r})[t];if(u)return s?(f=(d=u.overrides)==null?void 0:d.find(({identifiers:p})=>fi(p,s)))==null?void 0:f.value:u.value},a=await e.migrateFn(i,o);return Array.isArray(a)?a:[[e.key,a]]}},Gc.ID="workbench.contrib.configurationMigration",Gc);Rk=V([F(0,D_),F(1,e2)],Rk);var Qc;let Lk=(Qc=class extends Te{constructor(e){super(),this.remoteAgentService=e,this._ready=new Sl,this.ready=this._ready.p,this.create()}async create(){try{await this.doCreate()}finally{this._ready.complete()}}async doCreate(){if(!ni){const t=await this.remoteAgentService.getEnvironment();if((t==null?void 0:t.os)!==Ec.Windows)return}Cn.as(Zf.Configuration).registerConfiguration({...mF,properties:{"security.allowedUNCHosts":{type:"array",items:{type:"string",pattern:"^[^\\\\]+$",patternErrorMessage:h(3752,"UNC host names must not contain backslashes.")},default:[],markdownDescription:h(3753,"A set of UNC host names (without leading or trailing backslash, for example `192.168.0.1` or `my-server`) to allow without user confirmation. If a UNC host is being accessed that is not allowed via this setting or has not been acknowledged via user confirmation, an error will occur and the operation stopped. A restart is required when changing this setting. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:Ft.APPLICATION_MACHINE},"security.restrictUNCAccess":{type:"boolean",default:!0,markdownDescription:h(3754,"If enabled, only allows access to UNC host names that are allowed by the `#security.allowedUNCHosts#` setting or after user confirmation. Find out more about this setting at https://aka.ms/vscode-windows-unc."),scope:Ft.APPLICATION_MACHINE}}})}},Qc.ID="workbench.contrib.dynamicWorkbenchSecurityConfiguration",Qc);Lk=V([F(0,fF)],Lk);const xd="window.newWindowProfile";var Jc;let Nk=(Jc=class extends Te{constructor(e,t){super(),this.userDataProfilesService=e,this.configurationService=t,this.registerNewWindowProfileConfiguration(),this._register(this.userDataProfilesService.onDidChangeProfiles(i=>this.registerNewWindowProfileConfiguration())),this.setNewWindowProfile(),this.checkAndResetNewWindowProfileConfig(),this._register(t.onDidChangeConfiguration(i=>{i.source!==dn.DEFAULT&&i.affectsConfiguration(xd)&&this.setNewWindowProfile()})),this._register(this.userDataProfilesService.onDidChangeProfiles(()=>this.checkAndResetNewWindowProfileConfig()))}registerNewWindowProfileConfiguration(){const e=Cn.as(Zf.Configuration),t={..._F,properties:{[xd]:{type:["string","null"],default:null,enum:[...this.userDataProfilesService.profiles.map(i=>i.name),null],enumItemLabels:[...this.userDataProfilesService.profiles.map(i=>""),h(3755,"Active Window")],description:h(3756,"Specifies the profile to use when opening a new window. If a profile name is provided, the new window will use that profile. If no profile name is provided, the new window will use the profile of the active window or the Default profile if no active window exists."),scope:Ft.APPLICATION}}};this.configurationNode?e.updateConfigurations({add:[t],remove:[this.configurationNode]}):e.registerConfiguration(t),this.configurationNode=t}setNewWindowProfile(){const e=this.configurationService.getValue(xd);this.newWindowProfile=e?this.userDataProfilesService.profiles.find(t=>t.name===e):void 0}checkAndResetNewWindowProfileConfig(){const e=this.configurationService.getValue(xd);if(!e)return;const t=this.newWindowProfile?this.userDataProfilesService.profiles.find(i=>i.id===this.newWindowProfile.id):void 0;e!==(t==null?void 0:t.name)&&this.configurationService.updateValue(xd,t==null?void 0:t.name)}},Jc.ID="workbench.contrib.dynamicWindowConfiguration",Jc);Nk=V([F(0,pF),F(1,D_)],Nk);const bF=Cn.as(Zf.Configuration),yF={...gF,properties:{"workbench.editorAssociations":{type:"object",markdownDescription:h(12062,'Configure [glob patterns](https://aka.ms/vscode-glob-patterns) to editors (for example `"*.hex": "hexEditor.hexedit"`). These have precedence over the default behavior.'),additionalProperties:{type:"string"}}}};bF.registerConfiguration(yF);var Fy;(function(n){n.builtin="builtin",n.option="option",n.exclusive="exclusive",n.default="default"})(Fy||(Fy={}));var Ok;(function(n){n[n.ABORT=1]="ABORT",n[n.NONE=2]="NONE"})(Ok||(Ok={}));function xF(n,e){if(new Set([oe.extension,oe.webviewPanel,oe.vscodeWorkspaceTrust,oe.vscodeSettings]).has(e.scheme))return!1;const r=typeof n=="string"&&n.indexOf(ot.sep)>=0?`${e.scheme}:${e.path}`:Lo(e);return zd(typeof n=="string"?n.toLowerCase():n,r.toLowerCase())}const oa=class oa{get activeNotebookEditor(){var e;return(e=this._activeNotebookEditor)==null?void 0:e.apiEditor}get visibleNotebookEditors(){return this._visibleNotebookEditors.map(e=>e.apiEditor)}constructor(e,t,i,r,s,o,a){this._textDocumentsAndEditors=i,this._textDocuments=r,this._extHostFileSystem=s,this._extHostSearch=o,this._logService=a,this._notebookStatusBarItemProviders=new Map,this._documents=new on,this._editors=new Map,this._onDidChangeActiveNotebookEditor=new L,this.onDidChangeActiveNotebookEditor=this._onDidChangeActiveNotebookEditor.event,this._visibleNotebookEditors=[],this._onDidOpenNotebookDocument=new L,this.onDidOpenNotebookDocument=this._onDidOpenNotebookDocument.event,this._onDidCloseNotebookDocument=new L,this.onDidCloseNotebookDocument=this._onDidCloseNotebookDocument.event,this._onDidChangeVisibleNotebookEditors=new L,this.onDidChangeVisibleNotebookEditors=this._onDidChangeVisibleNotebookEditors.event,this._statusBarCache=new Ai("NotebookCellStatusBarCache"),this._handlePool=0,this._notebookSerializer=new Map,this._notebookProxy=e.getProxy(Z.MainThreadNotebook),this._notebookDocumentsProxy=e.getProxy(Z.MainThreadNotebookDocuments),this._notebookEditorsProxy=e.getProxy(Z.MainThreadNotebookEditors),this._commandsConverter=t.converter,t.registerArgumentProcessor({processArgument:l=>{var c;if(l&&l.$mid===rt.NotebookCellActionContext){const u=(c=l.notebookEditor)==null?void 0:c.notebookUri,d=l.cell.handle,f=this._documents.get(u),p=f==null?void 0:f.getCell(d);if(p)return p.apiCell}if(l&&l.$mid===rt.NotebookActionContext){const u=l.uri,d=this._documents.get(u);if(d)return d.apiNotebook}return l}}),oa._registerApiCommands(t)}getEditorById(e){const t=this._editors.get(e);if(!t)throw new Error(`unknown text editor: ${e}. known editors: ${[...this._editors.keys()]} `);return t}getIdByEditor(e){for(const[t,i]of this._editors)if(i.apiEditor===e)return t}get notebookDocuments(){return[...this._documents.values()]}getNotebookDocument(e,t){const i=this._documents.get(e);if(!i&&!t)throw new Error(`NO notebook document for '${e}'`);return i}static _convertNotebookRegistrationData(e,t){if(!t)return;const i=t.filenamePattern.map(r=>Um.from(r)).filter(r=>r!==void 0);if(t.filenamePattern&&!i){console.warn(`Notebook content provider view options file name pattern is invalid ${t.filenamePattern}`);return}return{extension:e.identifier,providerDisplayName:e.displayName||e.name,displayName:t.displayName,filenamePattern:i,priority:t.exclusive?Fy.exclusive:void 0}}registerNotebookCellStatusBarItemProvider(e,t,i){const r=oa._notebookStatusBarItemProviderHandlePool++,s=typeof i.onDidChangeCellStatusBarItems=="function"?oa._notebookStatusBarItemProviderHandlePool++:void 0;this._notebookStatusBarItemProviders.set(r,i),this._notebookProxy.$registerNotebookCellStatusBarItemProvider(r,s,t);let o;return s!==void 0&&(o=i.onDidChangeCellStatusBarItems(a=>this._notebookProxy.$emitCellStatusBarEvent(s))),new je(()=>{this._notebookStatusBarItemProviders.delete(r),this._notebookProxy.$unregisterNotebookCellStatusBarItemProvider(r,s),o==null||o.dispose()})}async createNotebookDocument(e){const t=await this._notebookDocumentsProxy.$tryCreateNotebook({viewType:e.viewType,content:e.content&&Ys.from(e.content)});return y.revive(t)}async openNotebookDocument(e){const t=this._documents.get(e);if(t)return t.apiNotebook;const i=await this._notebookDocumentsProxy.$tryOpenNotebook(e),r=this._documents.get(y.revive(i));return cu(r==null?void 0:r.apiNotebook)}async showNotebookDocument(e,t){var a;let i;typeof t=="object"?i={position:nn.from(t.viewColumn),preserveFocus:t.preserveFocus,selections:t.selections&&t.selections.map(Hr.from),pinned:typeof t.preview=="boolean"?!t.preview:void 0,label:typeof t.asRepl=="string"?t.asRepl:typeof t.asRepl=="object"?t.asRepl.label:void 0}:i={preserveFocus:!1,pinned:!0};const r=t!=null&&t.asRepl?"repl":e.notebookType,s=await this._notebookEditorsProxy.$tryShowNotebookDocument(e.uri,r,i),o=s&&((a=this._editors.get(s))==null?void 0:a.apiEditor);if(o)return o;throw s?new Error(`Could NOT open editor for "${e.uri.toString()}" because another editor opened in the meantime.`):new Error(`Could NOT open editor for "${e.uri.toString()}".`)}async $provideNotebookCellStatusBarItems(e,t,i,r){const s=this._notebookStatusBarItemProviders.get(e),o=y.revive(t),a=this._documents.get(o);if(!a||!s)return;const l=a.getCellFromIndex(i);if(!l)return;const c=await s.provideCellStatusBarItems(l.apiCell,r);if(!c)return;const u=new Ie,d=this._statusBarCache.add([u]),p=(Array.isArray(c)?c:[c]).map(w=>Gb.from(w,this._commandsConverter,u));return{cacheId:d,items:p}}$releaseNotebookCellStatusBarItems(e){this._statusBarCache.delete(e)}registerNotebookSerializer(e,t,i,r,s){if(mh(t))throw new Error("viewType cannot be empty or just whitespace");const o=this._handlePool++;return this._notebookSerializer.set(o,{viewType:t,serializer:i,options:r}),this._notebookProxy.$registerNotebookSerializer(o,{id:e.identifier,location:e.extensionLocation},t,Jb.from(r),oa._convertNotebookRegistrationData(e,s)),Se(()=>{this._notebookProxy.$unregisterNotebookSerializer(o)})}async $dataToNotebook(e,t,i){const r=this._notebookSerializer.get(e);if(!r)throw new Error("NO serializer found");const s=await r.serializer.deserializeNotebook(t.buffer,i);return new hi(Ys.from(s))}async $notebookToData(e,t,i){const r=this._notebookSerializer.get(e);if(!r)throw new Error("NO serializer found");const s=await r.serializer.serializeNotebook(Ys.to(t.value),i);return Pe.wrap(s)}async $saveNotebook(e,t,i,r,s){var w;const o=y.revive(t),a=this._notebookSerializer.get(e);if(this.trace(`enter saveNotebook(versionId: ${i}, ${o.toString()})`),!a)throw new Error("NO serializer found");const l=this._documents.get(o);if(!l)throw new Error("Document NOT found");if(l.versionId!==i)throw new Error("Document version mismatch");if(!this._extHostFileSystem.value.isWritableFileSystem(o.scheme))throw new tw(h(2546,"Unable to modify read-only file '{0}'",this._resourceForError(o)),Ei.FILE_PERMISSION_DENIED);const c={metadata:cE(l.apiNotebook.metadata,v=>{var m;return!(((m=a.options)==null?void 0:m.transientDocumentMetadata)??{})[v]}),cells:[]};for(const v of l.apiNotebook.getCells()){const m=new g_(v.kind,v.document.getText(),v.document.languageId,v.mime,(w=a.options)!=null&&w.transientOutputs?[]:[...v.outputs],v.metadata,v.executionSummary);m.metadata=cE(v.metadata,x=>{var k;return!(((k=a.options)==null?void 0:k.transientCellMetadata)??{})[x]}),c.cells.push(m)}if(await this._validateWriteFile(o,r),s.isCancellationRequested)throw new Error("canceled");const u=await a.serializer.serializeNotebook(c,s);if(s.isCancellationRequested)throw new Error("canceled");this.trace(`serialized versionId: ${i} ${o.toString()}`),await this._extHostFileSystem.value.writeFile(o,u),this.trace(`Finished write versionId: ${i} ${o.toString()}`);const d=this._extHostFileSystem.getFileSystemProviderExtUri(o.scheme),f=await this._extHostFileSystem.value.stat(o),p={name:d.basename(o),isFile:(f.type&Wa.File)!==0,isDirectory:(f.type&Wa.Directory)!==0,isSymbolicLink:(f.type&Wa.SymbolicLink)!==0,mtime:f.mtime,ctime:f.ctime,size:f.size,readonly:!!((f.permissions??0)&gu.Readonly)||!this._extHostFileSystem.value.isWritableFileSystem(o.scheme),locked:!!((f.permissions??0)&gu.Locked),etag:hE({mtime:f.mtime,size:f.size}),children:void 0};return this.trace(`exit saveNotebook(versionId: ${i}, ${o.toString()})`),p}async $searchInNotebooks(e,t,i,r,s){var f;const o=(f=this._notebookSerializer.get(e))==null?void 0:f.serializer;if(!o)return{limitHit:!1,results:[]};const a=new aI;await(async(p,w,v)=>{await Promise.all(p.map(async m=>await Promise.all(m.filenamePatterns.map(x=>{const k={_reason:v._reason,folderQueries:v.folderQueries,includePattern:v.includePattern,excludePattern:v.excludePattern,maxResults:v.maxResults,type:tl.File,filePattern:x};return this._extHostSearch.doInternalFileSearchWithCustomCallback(k,w,D=>{D.forEach(B=>{a.has(B)||r.some(z=>m.isFromSettings&&!z.isFromSettings?!1:z.filenamePatterns.some(K=>xF(K,B)))||a.add(B)})}).catch(D=>{if(D.code==="ENOENT")return console.warn("Could not find notebook search results, ignoring notebook results."),{limitHit:!1,messages:[]};throw D})}))))})(i,s,t);const c=new on;let u=!1;const d=Array.from(a).map(async p=>{const w=[];try{if(s.isCancellationRequested)return;if(t.maxResults&&[...c.values()].reduce((k,D)=>k+D.cellResults.length,0)>t.maxResults){u=!0;return}const v=[],m=this._documents.get(p);if(m)m.apiNotebook.getCells().forEach(D=>v.push({input:D.document.getText(),outputs:D.outputs.flatMap(B=>B.items.map(T=>T.data.toString()))}));else{const k=await this._extHostFileSystem.value.readFile(p),D=Pe.fromString(k.toString()),B=await o.deserializeNotebook(D.buffer,s);if(s.isCancellationRequested)return;Ys.from(B).cells.forEach(z=>v.push({input:z.source,outputs:z.outputs.flatMap(K=>K.items.map(Ee=>Ee.valueBytes.toString()))}))}if(s.isCancellationRequested)return;v.forEach((k,D)=>{const B=t.contentPattern.pattern,T=new hF(k.input,void 0,k.outputs),z=T.findInInputs(B),K=T.findInOutputs(B),Ee=K.flatMap(Q=>Ak(Q.matches,Q.textBuffer)).map((Q,le)=>(Q.webviewIndex=le,Q));if(z.length>0||K.length>0){const Q={index:D,contentResults:Ak(z,T.inputTextBuffer),webviewResults:Ee};w.push(Q)}});const x={resource:p,cellResults:w};c.set(p,x);return}catch{return}});return await Promise.all(d),{limitHit:u,results:[...c.values()]}}async _validateWriteFile(e,t){const i=await this._extHostFileSystem.value.stat(e);if(typeof(t==null?void 0:t.mtime)=="number"&&typeof t.etag=="string"&&t.etag!==fT&&typeof i.mtime=="number"&&typeof i.size=="number"&&t.mtime<i.mtime&&t.etag!==hE({mtime:t.mtime,size:i.size}))throw new tw(h(2547,"File Modified Since"),Ei.FILE_MODIFIED_SINCE,t)}_resourceForError(e){return e.scheme===oe.file?e.fsPath:e.toString()}_createExtHostEditor(e,t,i){if(this._editors.has(t))throw new Error(`editor with id ALREADY EXSIST: ${t}`);const r=new Ef(t,this._notebookEditorsProxy,e,i.visibleRanges.map(Hr.to),i.selections.map(Hr.to),typeof i.viewColumn=="number"?nn.to(i.viewColumn):void 0,i.viewType);this._editors.set(t,r)}$acceptDocumentAndEditorsDelta(e){var t,i,r;if(e.value.removedDocuments)for(const s of e.value.removedDocuments){const o=y.revive(s),a=this._documents.get(o);a&&(a.dispose(),this._documents.delete(o),this._textDocumentsAndEditors.$acceptDocumentsAndEditorsDelta({removedDocuments:a.apiNotebook.getCells().map(l=>l.document.uri)}),this._onDidCloseNotebookDocument.fire(a.apiNotebook));for(const l of this._editors.values())l.notebookData.uri.toString()===o.toString()&&this._editors.delete(l.id)}if(e.value.addedDocuments){const s=[];for(const o of e.value.addedDocuments){const a=y.revive(o.uri);if(this._documents.has(a))throw new Error(`adding EXISTING notebook ${a} `);const l=new Ny(this._notebookDocumentsProxy,this._textDocumentsAndEditors,this._textDocuments,a,o);s.push(...o.cells.map(c=>Ly.asModelAddData(c))),(t=this._documents.get(a))==null||t.dispose(),this._documents.set(a,l),this._textDocumentsAndEditors.$acceptDocumentsAndEditorsDelta({addedDocuments:s}),this._onDidOpenNotebookDocument.fire(l.apiNotebook)}}if(e.value.addedEditors)for(const s of e.value.addedEditors){if(this._editors.has(s.id))return;const o=y.revive(s.documentUri),a=this._documents.get(o);a&&this._createExtHostEditor(a,s.id,s)}if(e.value.removedEditors)for(const s of e.value.removedEditors){const o=this._editors.get(s);o&&(this._editors.delete(s),((i=this._activeNotebookEditor)==null?void 0:i.id)===o.id&&(this._activeNotebookEditor=void 0))}if(e.value.visibleEditors){this._visibleNotebookEditors=e.value.visibleEditors.map(o=>this._editors.get(o)).filter(o=>!!o);const s=new Set;this._visibleNotebookEditors.forEach(o=>s.add(o.id));for(const o of this._editors.values()){const a=s.has(o.id);o._acceptVisibility(a)}this._visibleNotebookEditors=[...this._editors.values()].map(o=>o).filter(o=>o.visible),this._onDidChangeVisibleNotebookEditors.fire(this.visibleNotebookEditors)}e.value.newActiveEditor===null?this._activeNotebookEditor=void 0:e.value.newActiveEditor&&(this._editors.get(e.value.newActiveEditor)||console.error(`FAILED to find active notebook editor ${e.value.newActiveEditor}`),this._activeNotebookEditor=this._editors.get(e.value.newActiveEditor)),e.value.newActiveEditor!==void 0&&this._onDidChangeActiveNotebookEditor.fire((r=this._activeNotebookEditor)==null?void 0:r.apiEditor)}static _registerApiCommands(e){const t=q.String.with("notebookType","A notebook type"),i=new ke("vscode.executeDataToNotebook","_executeDataToNotebook","Invoke notebook serializer",[t,new q("data","Bytes to convert to data",s=>s instanceof Uint8Array,s=>Pe.wrap(s))],new be("Notebook Data",s=>Ys.to(s.value))),r=new ke("vscode.executeNotebookToData","_executeNotebookToData","Invoke notebook serializer",[t,new q("NotebookData","Notebook data to convert to bytes",s=>!0,s=>new hi(Ys.from(s)))],new be("Bytes",s=>s.buffer));e.registerApiCommand(i),e.registerApiCommand(r)}trace(e){this._logService.trace(`[Extension Host Notebook] ${e}`)}};oa._notebookStatusBarItemProviderHandlePool=0;let My=oa;class EF{constructor(e,t,i,r={timeout:1500,errors:3}){this._logService=e,this._notebooksAndEditors=t,this._mainThreadBulkEdits=i,this._thresholds=r,this._onWillSaveNotebookDocumentEvent=new Td}dispose(){}getOnWillSaveNotebookDocumentEvent(e){return(t,i,r)=>{const s=function(a){t.call(i,a)};return s.extension=e,this._onWillSaveNotebookDocumentEvent.event(s,void 0,r)}}async $participateInSave(e,t,i){const r=y.revive(e),s=this._notebooksAndEditors.getNotebookDocument(r);if(!s)throw new Error("Unable to resolve notebook document");const o=[];if(await this._onWillSaveNotebookDocumentEvent.fireAsync({notebook:s.apiNotebook,reason:Fm.to(t)},i,async(l,c)=>{const u=Date.now(),d=await await Promise.resolve(l);Date.now()-u>this._thresholds.timeout&&this._logService.warn("onWillSaveNotebookDocument-listener from extension",c.extension.identifier),!i.isCancellationRequested&&d&&(d instanceof _l?o.push(d):this._logService.warn("onWillSaveNotebookDocument-listener from extension",c.extension.identifier,"ignored due to invalid data"))}),i.isCancellationRequested)return!1;if(o.length===0)return!0;const a={edits:[]};for(const l of o){const{edits:c}=gi.from(l);a.edits=a.edits.concat(c)}return this._mainThreadBulkEdits.$tryApplyWorkspaceEdit(new hi(a))}}class SF{constructor(e){this._notebooksAndEditors=e,this._onDidSaveNotebookDocument=new L,this.onDidSaveNotebookDocument=this._onDidSaveNotebookDocument.event,this._onDidChangeNotebookDocument=new L,this.onDidChangeNotebookDocument=this._onDidChangeNotebookDocument.event}$acceptModelChanged(e,t,i,r){const o=this._notebooksAndEditors.getNotebookDocument(y.revive(e)).acceptModelChanged(t.value,i,r);this._onDidChangeNotebookDocument.fire(o)}$acceptDirtyStateChanged(e,t){this._notebooksAndEditors.getNotebookDocument(y.revive(e)).acceptDirty(t)}$acceptModelSaved(e){const t=this._notebooksAndEditors.getNotebookDocument(y.revive(e));this._onDidSaveNotebookDocument.fire(t.apiNotebook)}}let $y=class{constructor(e,t){this._logService=e,this._notebooksAndEditors=t,this._onDidChangeNotebookEditorSelection=new L,this._onDidChangeNotebookEditorVisibleRanges=new L,this.onDidChangeNotebookEditorSelection=this._onDidChangeNotebookEditorSelection.event,this.onDidChangeNotebookEditorVisibleRanges=this._onDidChangeNotebookEditorVisibleRanges.event}$acceptEditorPropertiesChanged(e,t){this._logService.debug("ExtHostNotebook#$acceptEditorPropertiesChanged",e,t);const i=this._notebooksAndEditors.getEditorById(e);t.visibleRanges&&i._acceptVisibleRanges(t.visibleRanges.ranges.map(Hr.to)),t.selections&&i._acceptSelections(t.selections.selections.map(Hr.to)),t.visibleRanges&&this._onDidChangeNotebookEditorVisibleRanges.fire({notebookEditor:i.apiEditor,visibleRanges:i.apiEditor.visibleRanges}),t.selections&&this._onDidChangeNotebookEditorSelection.fire(Object.freeze({notebookEditor:i.apiEditor,selections:i.apiEditor.selections}))}$acceptEditorViewColumns(e){for(const t in e)this._notebooksAndEditors.getEditorById(t)._acceptViewColumn(nn.to(e[t]))}};$y=V([F(0,ct)],$y);var dc;(function(n){n[n.Output=1]="Output",n[n.OutputItems=2]="OutputItems",n[n.ExecutionState=3]="ExecutionState"})(dc||(dc={}));const DF=100;var Fk;(function(n){n[n.Disconnected=1]="Disconnected",n[n.Connected=2]="Connected",n[n.Initializing=3]="Initializing"})(Fk||(Fk={}));let Uy=class{constructor(e,t,i,r,s){this._initData=t,this._extHostNotebook=i,this._commands=r,this._logService=s,this._activeExecutions=new on,this._activeNotebookExecutions=new on,this._kernelDetectionTask=new Map,this._kernelDetectionTaskHandlePool=0,this._kernelSourceActionProviders=new Map,this._kernelSourceActionProviderHandlePool=0,this._kernelData=new Map,this._handlePool=0,this._onDidChangeCellExecutionState=new L,this.onDidChangeNotebookCellExecutionState=this._onDidChangeCellExecutionState.event,this.id=0,this.variableStore={},this._proxy=e.getProxy(Z.MainThreadNotebookKernels);const o=new ke("notebook.selectKernel","_notebook.selectKernel","Trigger kernel picker for specified notebook editor widget",[new q("options","Select kernel options",l=>!0,l=>{if(l&&"notebookEditor"in l&&"id"in l){const c=this._extHostNotebook.getIdByEditor(l.notebookEditor);return{id:l.id,extension:l.extension,notebookEditorId:c}}else if(l&&"notebookEditor"in l){const c=this._extHostNotebook.getIdByEditor(l.notebookEditor);if(c===void 0)throw new Error(`Cannot invoke 'notebook.selectKernel' for unrecognized notebook editor ${l.notebookEditor.notebook.uri.toString()}`);return{notebookEditorId:c}}return l})],be.Void),a=new ke("vscode.executeNotebookVariableProvider","_executeNotebookVariableProvider","Execute notebook variable provider",[q.Uri],new be("A promise that resolves to an array of variables",(l,c)=>l.map(u=>({variable:{name:u.name,value:u.value,expression:u.expression,type:u.type,language:u.language},hasNamedChildren:u.hasNamedChildren,indexedChildrenCount:u.indexedChildrenCount}))));this._commands.registerApiCommand(o),this._commands.registerApiCommand(a)}createNotebookController(e,t,i,r,s,o){for(const T of this._kernelData.values())if(T.controller.id===t&&Ke.equals(e.identifier,T.extensionId))throw new Error(`notebook controller with id '${t}' ALREADY exist`);const a=this._handlePool++,l=this;this._logService.trace(`NotebookController[${a}], CREATED by ${e.identifier.value}, ${t}`);const c=()=>console.warn(`NO execute handler from notebook controller '${p.id}' of extension: '${e.identifier}'`);let u=!1;const d=new L,f=new L,p={id:xp(e.identifier,t),notebookType:i,extensionId:e.identifier,extensionLocation:e.extensionLocation,label:r||e.identifier.value,preloads:o?o.map(Hm.from):[]};let w=s??c,v,m;this._proxy.$addKernel(a,p).catch(T=>{console.log(T),u=!0});let x=0;const k=()=>{if(u)return;const T=++x;Promise.resolve().then(()=>{T===x&&this._proxy.$updateKernel(a,p)})},D=new on,B={get id(){return t},get notebookType(){return p.notebookType},onDidChangeSelectedNotebooks:d.event,get label(){return p.label},set label(T){p.label=T??e.displayName??e.name,k()},get detail(){return p.detail??""},set detail(T){p.detail=T,k()},get description(){return p.description??""},set description(T){p.description=T,k()},get supportedLanguages(){return p.supportedLanguages},set supportedLanguages(T){p.supportedLanguages=T,k()},get supportsExecutionOrder(){return p.supportsExecutionOrder??!1},set supportsExecutionOrder(T){p.supportsExecutionOrder=T,k()},get rendererScripts(){return p.preloads?p.preloads.map(Hm.to):[]},get executeHandler(){return w},set executeHandler(T){w=T??c},get interruptHandler(){return v},set interruptHandler(T){v=T,p.supportsInterrupt=!!T,k()},set variableProvider(T){$(e,"notebookVariableProvider"),m=T,p.hasVariableProvider=!!T,T==null||T.onDidChangeVariables(z=>l._proxy.$variablesUpdated(z.uri)),k()},get variableProvider(){return m},createNotebookCellExecution(T){if(u)throw new Error("notebook controller is DISPOSED");if(!D.has(T.notebook.uri))throw l._logService.trace(`NotebookController[${a}] NOT associated to notebook, associated to THESE notebooks:`,Array.from(D.keys()).map(z=>z.toString())),new Error(`notebook controller is NOT associated to notebook: ${T.notebook.uri.toString()}`);return l._createNotebookCellExecution(T,xp(e.identifier,this.id))},createNotebookExecution(T){if($(e,"notebookExecution"),u)throw new Error("notebook controller is DISPOSED");if(!D.has(T.uri))throw l._logService.trace(`NotebookController[${a}] NOT associated to notebook, associated to THESE notebooks:`,Array.from(D.keys()).map(z=>z.toString())),new Error(`notebook controller is NOT associated to notebook: ${T.uri.toString()}`);return l._createNotebookExecution(T,xp(e.identifier,this.id))},dispose:()=>{u||(this._logService.trace(`NotebookController[${a}], DISPOSED`),u=!0,this._kernelData.delete(a),d.dispose(),f.dispose(),this._proxy.$removeKernel(a))},updateNotebookAffinity(T,z){z===_m.Hidden&&$(e,"notebookControllerAffinityHidden"),l._proxy.$updateNotebookPriority(a,T.uri,z)},onDidReceiveMessage:f.event,postMessage(T,z){return $(e,"notebookMessaging"),l._proxy.$postMessage(a,z&&l._extHostNotebook.getIdByEditor(z),T)},asWebviewUri(T){return $(e,"notebookMessaging"),eh(T,l._initData.remote)}};return this._kernelData.set(a,{extensionId:e.identifier,controller:B,onDidReceiveMessage:f,onDidChangeSelection:d,associatedNotebooks:D}),B}getIdByController(e){for(const[t,i]of this._kernelData)if(i.controller===e)return xp(i.extensionId,e.id);return null}createNotebookControllerDetectionTask(e,t){const i=this._kernelDetectionTaskHandlePool++,r=this;this._logService.trace(`NotebookControllerDetectionTask[${i}], CREATED by ${e.identifier.value}`),this._proxy.$addKernelDetectionTask(i,t);const s={dispose:()=>{this._kernelDetectionTask.delete(i),r._proxy.$removeKernelDetectionTask(i)}};return this._kernelDetectionTask.set(i,s),s}registerKernelSourceActionProvider(e,t,i){const r=this._kernelSourceActionProviderHandlePool++,s=typeof i.onDidChangeNotebookKernelSourceActions=="function"?r:void 0,o=this;this._kernelSourceActionProviders.set(r,i),this._logService.trace(`NotebookKernelSourceActionProvider[${r}], CREATED by ${e.identifier.value}`),this._proxy.$addKernelSourceActionProvider(r,r,t);let a;return s!==void 0&&(a=i.onDidChangeNotebookKernelSourceActions(l=>this._proxy.$emitNotebookKernelSourceActionsChangeEvent(s))),{dispose:()=>{this._kernelSourceActionProviders.delete(r),o._proxy.$removeKernelSourceActionProvider(r,r),a==null||a.dispose()}}}async $provideKernelSourceActions(e,t){const i=this._kernelSourceActionProviders.get(e);if(i){const r=new Ie;return(await i.provideNotebookKernelSourceActions(t)??[]).map(o=>Qb.from(o,this._commands.converter,r))}return[]}$acceptNotebookAssociation(e,t,i){const r=this._kernelData.get(e);if(r){const s=this._extHostNotebook.getNotebookDocument(y.revive(t));i?r.associatedNotebooks.set(s.uri,!0):r.associatedNotebooks.delete(s.uri),this._logService.trace(`NotebookController[${e}] ASSOCIATE notebook`,s.uri.toString(),i),r.onDidChangeSelection.fire({selected:i,notebook:s.apiNotebook})}}async $executeCells(e,t,i){const r=this._kernelData.get(e);if(!r)return;const s=this._extHostNotebook.getNotebookDocument(y.revive(t)),o=[];for(const a of i){const l=s.getCell(a);l&&o.push(l.apiCell)}try{this._logService.trace(`NotebookController[${e}] EXECUTE cells`,s.uri.toString(),o.length),await r.controller.executeHandler.call(r.controller,o,s.apiNotebook,r.controller)}catch(a){this._logService.error(`NotebookController[${e}] execute cells FAILED`,a),console.error(a)}}async $cancelCells(e,t,i){var o;const r=this._kernelData.get(e);if(!r)return;const s=this._extHostNotebook.getNotebookDocument(y.revive(t));if(r.controller.interruptHandler)await r.controller.interruptHandler.call(r.controller,s.apiNotebook);else for(const a of i){const l=s.getCell(a);l&&((o=this._activeExecutions.get(l.uri))==null||o.cancel())}if(r.controller.interruptHandler){const a=this._activeNotebookExecutions.get(s.uri);this._activeNotebookExecutions.delete(s.uri),i.length&&Array.isArray(a)&&a.length&&a.forEach(l=>l.dispose())}}async $provideVariables(e,t,i,r,s,o,a){const l=this._kernelData.get(e);if(!l)return;const c=this._extHostNotebook.getNotebookDocument(y.revive(i)),u=l.controller.variableProvider;if(!u)return;let d;if(r!==void 0){if(d=this.variableStore[r],!d)return}else this.variableStore={};const f=s==="named"?jh.Named:jh.Indexed,p=u.provideVariables(c.apiNotebook,d,f,o,a);let w=0;for await(const v of p){if(a.isCancellationRequested)return;const m={id:this.id++,name:v.variable.name,value:v.variable.value,type:v.variable.type,interfaces:v.variable.interfaces,language:v.variable.language,expression:v.variable.expression,hasNamedChildren:v.hasNamedChildren,indexedChildrenCount:v.indexedChildrenCount,extensionId:l.extensionId.value};if(this.variableStore[m.id]=v.variable,this._proxy.$receiveVariable(t,m),w++>=DF)return}}$acceptKernelMessageFromRenderer(e,t,i){const r=this._kernelData.get(e);if(!r)return;const s=this._extHostNotebook.getEditorById(t);r.onDidReceiveMessage.fire(Object.freeze({editor:s.apiEditor,message:i}))}$cellExecutionChanged(e,t,i){const s=this._extHostNotebook.getNotebookDocument(y.revive(e)).getCell(t);if(s){const o=i?jb.to(i):Iu.Idle;o!==void 0&&this._onDidChangeCellExecutionState.fire({cell:s.apiCell,state:o})}}_createNotebookCellExecution(e,t){if(e.index<0)throw new Error("CANNOT execute cell that has been REMOVED from notebook");const r=this._extHostNotebook.getNotebookDocument(e.notebook.uri).getCellFromApiCell(e);if(!r)throw new Error("invalid cell");if(this._activeExecutions.has(r.uri))throw new Error(`duplicate execution for ${r.uri}`);const s=new Hy(t,r,this._proxy);this._activeExecutions.set(r.uri,s);const o=s.onDidChangeState(()=>{s.state===er.Resolved&&(s.dispose(),o.dispose(),this._activeExecutions.delete(r.uri))});return s.asApiObject()}_createNotebookExecution(e,t){const i=this._extHostNotebook.getNotebookDocument(e.uri),r=e.getCells().find(a=>{const l=i.getCellFromApiCell(a);return l&&this._activeExecutions.has(l.uri)});if(r)throw new Error(`duplicate cell execution for ${r.document.uri}`);if(this._activeNotebookExecutions.has(i.uri))throw new Error(`duplicate notebook execution for ${i.uri}`);const s=new By(t,i,this._proxy),o=s.onDidChangeState(()=>{s.state===ms.Resolved&&(s.dispose(),o.dispose(),this._activeNotebookExecutions.delete(i.uri))});return this._activeNotebookExecutions.set(i.uri,[s,o]),s.asApiObject()}};Uy=V([F(4,ct)],Uy);var er;(function(n){n[n.Init=0]="Init",n[n.Started=1]="Started",n[n.Resolved=2]="Resolved"})(er||(er={}));const Q1=class Q1 extends Te{get state(){return this._state}constructor(e,t,i){super(),this._cell=t,this._proxy=i,this._handle=Q1.HANDLE++,this._onDidChangeState=new L,this.onDidChangeState=this._onDidChangeState.event,this._state=er.Init,this._tokenSource=this._register(new Bt),this._collector=new IF(10,r=>this.update(r)),this._executionOrder=t.internalMetadata.executionOrder,this._proxy.$createExecution(this._handle,e,this._cell.notebook.uri,this._cell.handle)}cancel(){this._tokenSource.cancel()}async updateSoon(e){await this._collector.addItem(e)}async update(e){const t=Array.isArray(e)?e:[e];return this._proxy.$updateExecution(this._handle,new hi(t))}verifyStateForOutput(){if(this._state===er.Init)throw new Error("Must call start before modifying cell output");if(this._state===er.Resolved)throw new Error("Cannot modify cell output after calling resolve")}cellIndexToHandle(e){let t=this._cell;if(e&&(t=this._cell.notebook.getCellFromApiCell(e)),!t)throw new Error("INVALID cell");return t.handle}validateAndConvertOutputs(e){return e.map(t=>{const i=pm.ensureUniqueMimeTypes(t.items,!0);return i===t.items?Ao.from(t):Ao.from({items:i,id:t.id,metadata:t.metadata})})}async updateOutputs(e,t,i){const r=this.cellIndexToHandle(t),s=this.validateAndConvertOutputs(Bi(e));return this.updateSoon({editType:dc.Output,cellHandle:r,append:i,outputs:s})}async updateOutputItems(e,t,i){return e=pm.ensureUniqueMimeTypes(Bi(e),!0),this.updateSoon({editType:dc.OutputItems,items:e.map(Mu.from),outputId:t.id,append:i})}asApiObject(){const e=this;return Object.freeze({get token(){return e._tokenSource.token},get cell(){return e._cell.apiCell},get executionOrder(){return e._executionOrder},set executionOrder(i){e._executionOrder=i,e.update([{editType:dc.ExecutionState,executionOrder:e._executionOrder}])},start(i){if(e._state===er.Resolved||e._state===er.Started)throw new Error("Cannot call start again");e._state=er.Started,e._onDidChangeState.fire(),e.update({editType:dc.ExecutionState,runStartTime:i})},end(i,r,s){if(e._state===er.Resolved)throw new Error("Cannot call resolve twice");e._state=er.Resolved,e._onDidChangeState.fire(),e._collector.flush();const o=kF(s);e._proxy.$completeExecution(e._handle,new hi({runEndTime:r,lastRunSuccess:i,error:o}))},clearOutput(i){return e.verifyStateForOutput(),e.updateOutputs([],i,!1)},appendOutput(i,r){return e.verifyStateForOutput(),e.updateOutputs(i,r,!0)},replaceOutput(i,r){return e.verifyStateForOutput(),e.updateOutputs(i,r,!1)},appendOutputItems(i,r){return e.verifyStateForOutput(),e.updateOutputItems(i,r,!0)},replaceOutputItems(i,r){return e.verifyStateForOutput(),e.updateOutputItems(i,r,!1)}})}};Q1.HANDLE=0;let Hy=Q1;function kF(n){const e=r=>r?{startLineNumber:r.start.line,startColumn:r.start.character,endLineNumber:r.end.line,endColumn:r.end.character}:void 0,t=r=>({uri:r.uri,position:r.position,label:r.label});return n?{name:n.name,message:n.message,stack:n.stack instanceof Array?n.stack.map(r=>t(r)):n.stack,location:e(n.location),uri:n.uri}:void 0}var ms;(function(n){n[n.Init=0]="Init",n[n.Started=1]="Started",n[n.Resolved=2]="Resolved"})(ms||(ms={}));const J1=class J1 extends Te{get state(){return this._state}constructor(e,t,i){super(),this._notebook=t,this._proxy=i,this._handle=J1.HANDLE++,this._onDidChangeState=new L,this.onDidChangeState=this._onDidChangeState.event,this._state=ms.Init,this._tokenSource=this._register(new Bt),this._proxy.$createNotebookExecution(this._handle,e,this._notebook.uri)}cancel(){this._tokenSource.cancel()}asApiObject(){return Object.freeze({start:()=>{if(this._state===ms.Resolved||this._state===ms.Started)throw new Error("Cannot call start again");this._state=ms.Started,this._onDidChangeState.fire(),this._proxy.$beginNotebookExecution(this._handle)},end:()=>{if(this._state===ms.Resolved)throw new Error("Cannot call resolve twice");this._state=ms.Resolved,this._onDidChangeState.fire(),this._proxy.$completeNotebookExecution(this._handle)}})}};J1.HANDLE=0;let By=J1;class IF{constructor(e,t){this.delay=e,this.callback=t,this.batch=[],this.startedTimer=Date.now()}addItem(e){return this.batch.push(e),this.currentDeferred||(this.currentDeferred=new Sl,this.startedTimer=Date.now(),Eo(this.delay).then(()=>this.flush())),Date.now()-this.startedTimer>this.delay?this.flush():this.currentDeferred.p}flush(){if(this.batch.length===0||!this.currentDeferred)return Promise.resolve();const e=this.currentDeferred;this.currentDeferred=void 0;const t=this.batch;return this.batch=[],this.callback(t).finally(()=>e.complete())}}function xp(n,e){return`${n.value}/${e}`}class CF{constructor(e,t){this._extHostNotebook=t,this._rendererMessageEmitters=new Map,this.proxy=e.getProxy(Z.MainThreadNotebookRenderers)}$postRendererMessage(e,t,i){var s;const r=this._extHostNotebook.getEditorById(e);(s=this._rendererMessageEmitters.get(t))==null||s.fire({editor:r.apiEditor,message:i})}createRendererMessaging(e,t){var r,s;if(!((s=(r=e.contributes)==null?void 0:r.notebookRenderer)!=null&&s.some(o=>o.id===t)))throw new Error(`Extensions may only call createRendererMessaging() for renderers they contribute (got ${t})`);return{onDidReceiveMessage:(o,a,l)=>this.getOrCreateEmitterFor(t).event(o,a,l),postMessage:(o,a)=>{Ef.apiEditorsToExtHost.has(o)&&([o,a]=[a,o]);const l=a&&Ef.apiEditorsToExtHost.get(a);return this.proxy.$postMessage(l==null?void 0:l.id,t,o)}}}getOrCreateEmitterFor(e){let t=this._rendererMessageEmitters.get(e);return t||(t=new L({onDidRemoveLastListener:()=>{t==null||t.dispose(),this._rendererMessageEmitters.delete(e)}}),this._rendererMessageEmitters.set(e,t),t)}}class PF{constructor(e){this.handlers=new Map,this.proxy=e.getProxy(Z.MainThreadProfileContentHandlers)}registerProfileContentHandler(e,t,i){if($(e,"profileContentHandlers"),this.handlers.has(t))throw new Error(`Handler with id '${t}' already registered`);return this.handlers.set(t,i),this.proxy.$registerProfileContentHandler(t,i.name,i.description,e.identifier.value),Se(()=>{this.handlers.delete(t),this.proxy.$unregisterProfileContentHandler(t)})}async $saveProfile(e,t,i,r){const s=this.handlers.get(e);if(!s)throw new Error(`Unknown handler with id: ${e}`);return s.saveProfile(t,i,r)}async $readProfile(e,t,i){const r=this.handlers.get(e);if(!r)throw new Error(`Unknown handler with id: ${e}`);return r.readProfile(Ze(t)?t:y.revive(t),i)}}function S7(n){return(e,t,i)=>{let r=null,s=null;if(typeof i.value=="function"?(r="value",s=i.value):typeof i.get=="function"&&(r="get",s=i.get),!s||typeof t=="symbol")throw new Error("not supported");i[r]=n(s,t)}}function D7(n,e,t){return S7((i,r)=>{const s=`$debounce$${r}`,o=`$debounce$result$${r}`;return function(...a){this[o]||(this[o]=void 0),clearTimeout(this[s]),this[s]=setTimeout(()=>{i.apply(this,a),this[o]=void 0},n)}})}function TF(n,e,t){return S7((i,r)=>{const s=`$throttle$timer$${r}`,o=`$throttle$result$${r}`,a=`$throttle$lastRun$${r}`,l=`$throttle$pending$${r}`;return function(...c){if(this[o]||(this[o]=t?t():void 0),(this[a]===null||this[a]===void 0)&&(this[a]=-Number.MAX_VALUE),e&&(this[o]=e(this[o],...c)),this[l])return;const u=this[a]+n;u<=Date.now()?(this[a]=Date.now(),i.apply(this,[this[o]]),this[o]=t?t():void 0):(this[l]=!0,this[s]=setTimeout(()=>{this[l]=!1,this[a]=Date.now(),i.apply(this,[this[o]]),this[o]=t?t():void 0},u-Date.now()))}})}class AF{constructor(e){this._handles=0,this._mapHandleToCancellationSource=new Map,this._proxy=e}async withProgress(e,t,i){const r=this._handles++,{title:s,location:o,cancellable:a}=t,l={label:e.displayName||e.name,id:e.identifier.value};return this._proxy.$startProgress(r,{location:zb.from(o),title:s,source:l,cancellable:a},e.isUnderDevelopment?void 0:e.identifier.value).catch(iI),this._withProgress(r,i,!!a)}_withProgress(e,t,i){let r;i&&(r=new Bt,this._mapHandleToCancellationSource.set(e,r));const s=a=>{this._proxy.$progressEnd(a),this._mapHandleToCancellationSource.delete(a),r==null||r.dispose()};let o;try{o=t(new Wy(this._proxy,e),i&&r?r.token:Pt.None)}catch(a){throw s(e),a}return o.then(a=>s(e),a=>s(e)),o}$acceptProgressCanceled(e){const t=this._mapHandleToCancellationSource.get(e);t&&(t.cancel(),this._mapHandleToCancellationSource.delete(e))}}function RF(n,e){return n.message=e.message,typeof e.increment=="number"&&(typeof n.increment=="number"?n.increment+=e.increment:n.increment=e.increment),n}class Wy extends Dg{constructor(e,t){super(i=>this.throttledReport(i)),this._proxy=e,this._handle=t}throttledReport(e){this._proxy.$progressReport(this._handle,e)}}Wy.__decorator=V([TF(100,(n,e)=>RF(n,e),()=>Object.create(null))],Wy.prototype,"throttledReport",null);const X1=class X1{constructor(e,t){this.uriTransformer=t,this.providers=new Map,this.proxy=e.getProxy(Z.MainThreadQuickDiff)}$provideOriginalResource(e,t,i){const r=y.revive(t),s=this.providers.get(e);return s?Nn(()=>s.provideOriginalResource(r,i)).then(o=>o||null):Promise.resolve(null)}registerQuickDiffProvider(e,t,i,r){const s=X1.handlePool++;return this.providers.set(s,t),this.proxy.$registerQuickDiffProvider(s,Pu.from(e,this.uriTransformer),i,r,t.visible??!0),{dispose:()=>{this.proxy.$unregisterQuickDiffProvider(s),this.providers.delete(s)}}}};X1.handlePool=0;let Vy=X1;function LF(n,e,t){const i=n.getProxy(Z.MainThreadQuickOpen);class r{constructor(w,v){this._sessions=new Map,this._instances=0,this._workspace=w,this._commands=v}showQuickPick(w,v,m,x=Pt.None){this._onDidSelectItem=void 0;const k=Promise.resolve(v),D=++this._instances,B=i.$show(D,{title:m==null?void 0:m.title,placeHolder:m==null?void 0:m.placeHolder,matchOnDescription:m==null?void 0:m.matchOnDescription,matchOnDetail:m==null?void 0:m.matchOnDetail,ignoreFocusLost:m==null?void 0:m.ignoreFocusOut,canPickMany:m==null?void 0:m.canPickMany},x),T={},z=B.then(()=>T);return Promise.race([z,k]).then(K=>{if(K===T)return;const Ee=vt(w,"quickPickItemTooltip");return k.then(Q=>{const le=[];for(let Ye=0;Ye<Q.length;Ye++){const Ce=Q[Ye];if(typeof Ce=="string")le.push({label:Ce,handle:Ye});else if(Ce.kind===qh.Separator)le.push({type:"separator",label:Ce.label});else{Ce.tooltip&&!Ee&&console.warn(`Extension '${w.identifier.value}' uses a tooltip which is proposed API that is only available when running out of dev or with the following command line switch: --enable-proposed-api ${w.identifier.value}`);const Y=Ce.iconPath?c(Ce.iconPath):void 0;le.push({label:Ce.label,iconPath:Y==null?void 0:Y.iconPath,iconClass:Y==null?void 0:Y.iconClass,description:Ce.description,detail:Ce.detail,picked:Ce.picked,alwaysShow:Ce.alwaysShow,tooltip:Ee?Le.fromStrict(Ce.tooltip):void 0,handle:Ye})}}return m&&typeof m.onDidSelectItem=="function"&&(this._onDidSelectItem=Ye=>{m.onDidSelectItem(Q[Ye])}),i.$setItems(D,le),B.then(Ye=>{if(typeof Ye=="number")return Q[Ye];if(Array.isArray(Ye))return Ye.map(Ce=>Q[Ce])})})}).then(void 0,K=>{if(!dl(K))return i.$setError(D,K),Promise.reject(K)})}$onItemSelected(w){var v;(v=this._onDidSelectItem)==null||v.call(this,w)}showInput(w,v=Pt.None){return this._validateInput=w==null?void 0:w.validateInput,i.$input(w,typeof this._validateInput=="function",v).then(void 0,m=>{if(!dl(m))return Promise.reject(m)})}async $validateInput(w){if(!this._validateInput)return;const v=await this._validateInput(w);if(!v||typeof v=="string")return v;let m;switch(v.severity){case Oc.Info:m=qt.Info;break;case Oc.Warning:m=qt.Warning;break;case Oc.Error:m=qt.Error;break;default:m=v.message?qt.Error:qt.Ignore;break}return{content:v.message,severity:m}}async showWorkspaceFolderPick(w,v=Pt.None){const m=await this._commands.executeCommand("_workbench.pickWorkspaceFolder",[w]);if(!m)return;const x=await this._workspace.getWorkspaceFolders2();if(x)return x.find(k=>k.uri.toString()===m.uri.toString())}createQuickPick(w){const v=new u(w,()=>this._sessions.delete(v._id));return this._sessions.set(v._id,v),v}createInputBox(w){const v=new d(w,()=>this._sessions.delete(v._id));return this._sessions.set(v._id,v),v}$onDidChangeValue(w,v){const m=this._sessions.get(w);m==null||m._fireDidChangeValue(v)}$onDidAccept(w){const v=this._sessions.get(w);v==null||v._fireDidAccept()}$onDidChangeActive(w,v){const m=this._sessions.get(w);m instanceof u&&m._fireDidChangeActive(v)}$onDidChangeSelection(w,v){const m=this._sessions.get(w);m instanceof u&&m._fireDidChangeSelection(v)}$onDidTriggerButton(w,v){const m=this._sessions.get(w);m==null||m._fireDidTriggerButton(v)}$onDidTriggerItemButton(w,v,m){const x=this._sessions.get(w);x instanceof u&&x._fireDidTriggerItemButton(v,m)}$onDidHide(w){const v=this._sessions.get(w);v==null||v._fireDidHide()}}const f=class f{constructor(w,v){this._extension=w,this._onDidDispose=v,this._id=u._nextId++,this._visible=!1,this._expectingHide=!1,this._enabled=!0,this._busy=!1,this._ignoreFocusOut=!0,this._value="",this._valueSelection=void 0,this._buttons=[],this._handlesToButtons=new Map,this._onDidAcceptEmitter=new L,this._onDidChangeValueEmitter=new L,this._onDidTriggerButtonEmitter=new L,this._onDidHideEmitter=new L,this._pendingUpdate={id:this._id},this._disposed=!1,this._disposables=[this._onDidTriggerButtonEmitter,this._onDidHideEmitter,this._onDidAcceptEmitter,this._onDidChangeValueEmitter],this.onDidChangeValue=this._onDidChangeValueEmitter.event,this.onDidAccept=this._onDidAcceptEmitter.event,this.onDidTriggerButton=this._onDidTriggerButtonEmitter.event,this.onDidHide=this._onDidHideEmitter.event}get title(){return this._title}set title(w){this._title=w,this.update({title:w})}get step(){return this._steps}set step(w){this._steps=w,this.update({step:w})}get totalSteps(){return this._totalSteps}set totalSteps(w){this._totalSteps=w,this.update({totalSteps:w})}get enabled(){return this._enabled}set enabled(w){this._enabled=w,this.update({enabled:w})}get busy(){return this._busy}set busy(w){this._busy=w,this.update({busy:w})}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(w){this._ignoreFocusOut=w,this.update({ignoreFocusOut:w})}get value(){return this._value}set value(w){this._value=w,this.update({value:w})}get valueSelection(){return this._valueSelection}set valueSelection(w){this._valueSelection=w,this.update({valueSelection:w})}get placeholder(){return this._placeholder}set placeholder(w){this._placeholder=w,this.update({placeholder:w})}get buttons(){return this._buttons}set buttons(w){const v=vt(this._extension,"quickInputButtonLocation");!v&&w.some(m=>m.location)&&console.warn(`Extension '${this._extension.identifier.value}' uses a button location which is proposed API that is only available when running out of dev or with the following command line switch: --enable-proposed-api ${this._extension.identifier.value}`),this._buttons=w.slice(),this._handlesToButtons.clear(),w.forEach((m,x)=>{const k=m===zh.Back?-1:x;this._handlesToButtons.set(k,m)}),this.update({buttons:w.map((m,x)=>({...c(m.iconPath),tooltip:m.tooltip,handle:m===zh.Back?-1:x,location:v?m.location:void 0}))})}show(){this._visible=!0,this._expectingHide=!0,this.update({visible:!0})}hide(){this._visible=!1,this.update({visible:!1})}_fireDidAccept(){this._onDidAcceptEmitter.fire()}_fireDidChangeValue(w){this._value=w,this._onDidChangeValueEmitter.fire(w)}_fireDidTriggerButton(w){const v=this._handlesToButtons.get(w);v&&this._onDidTriggerButtonEmitter.fire(v)}_fireDidHide(){this._expectingHide&&(this._expectingHide=this._visible,this._onDidHideEmitter.fire())}dispose(){this._disposed||(this._disposed=!0,this._fireDidHide(),this._disposables=Ns(this._disposables),this._updateTimeout&&(clearTimeout(this._updateTimeout),this._updateTimeout=void 0),this._onDidDispose(),i.$dispose(this._id))}update(w){if(!this._disposed){for(const v of Object.keys(w)){const m=w[v];this._pendingUpdate[v]=m===void 0?null:m}"visible"in this._pendingUpdate?(this._updateTimeout&&(clearTimeout(this._updateTimeout),this._updateTimeout=void 0),this.dispatchUpdate()):this._visible&&!this._updateTimeout&&(this._updateTimeout=setTimeout(()=>{this._updateTimeout=void 0,this.dispatchUpdate()},0))}}dispatchUpdate(){i.$createOrUpdate(this._pendingUpdate),this._pendingUpdate={id:this._id}}};f._nextId=1;let s=f;function o(p){if(p instanceof qn)return{id:p.id};const w=l(p),v=a(p);return{dark:typeof w=="string"?y.file(w):w,light:typeof v=="string"?y.file(v):v}}function a(p){return typeof p=="object"&&"light"in p?p.light:p}function l(p){return typeof p=="object"&&"dark"in p?p.dark:p}function c(p){const w=o(p);let v,m;return"id"in w?m=On.asClassName(w):v=w,{iconPath:v,iconClass:m}}class u extends s{constructor(w,v){super(w,v),this._items=[],this._handlesToItems=new Map,this._itemsToHandles=new Map,this._canSelectMany=!1,this._matchOnDescription=!0,this._matchOnDetail=!0,this._sortByLabel=!0,this._keepScrollPosition=!1,this._activeItems=[],this._onDidChangeActiveEmitter=new L,this._selectedItems=[],this._onDidChangeSelectionEmitter=new L,this._onDidTriggerItemButtonEmitter=new L,this.onDidChangeActive=this._onDidChangeActiveEmitter.event,this.onDidChangeSelection=this._onDidChangeSelectionEmitter.event,this.onDidTriggerItemButton=this._onDidTriggerItemButtonEmitter.event,this._disposables.push(this._onDidChangeActiveEmitter,this._onDidChangeSelectionEmitter,this._onDidTriggerItemButtonEmitter),this.update({type:"quickPick"})}get items(){return this._items}set items(w){var x;this._items=w.slice(),this._handlesToItems.clear(),this._itemsToHandles.clear(),w.forEach((k,D)=>{this._handlesToItems.set(D,k),this._itemsToHandles.set(k,D)});const v=vt(this._extension,"quickPickItemTooltip"),m=[];for(let k=0;k<w.length;k++){const D=w[k];if(D.kind===qh.Separator)m.push({type:"separator",label:D.label});else{D.tooltip&&!v&&console.warn(`Extension '${this._extension.identifier.value}' uses a tooltip which is proposed API that is only available when running out of dev or with the following command line switch: --enable-proposed-api ${this._extension.identifier.value}`);const B=D.iconPath?c(D.iconPath):void 0;m.push({handle:k,label:D.label,iconPath:B==null?void 0:B.iconPath,iconClass:B==null?void 0:B.iconClass,description:D.description,detail:D.detail,picked:D.picked,alwaysShow:D.alwaysShow,tooltip:v?Le.fromStrict(D.tooltip):void 0,buttons:(x=D.buttons)==null?void 0:x.map((T,z)=>({...c(T.iconPath),tooltip:T.tooltip,handle:z}))})}}this.update({items:m})}get canSelectMany(){return this._canSelectMany}set canSelectMany(w){this._canSelectMany=w,this.update({canSelectMany:w})}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(w){this._matchOnDescription=w,this.update({matchOnDescription:w})}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(w){this._matchOnDetail=w,this.update({matchOnDetail:w})}get sortByLabel(){return this._sortByLabel}set sortByLabel(w){this._sortByLabel=w,this.update({sortByLabel:w})}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(w){this._keepScrollPosition=w,this.update({keepScrollPosition:w})}get activeItems(){return this._activeItems}set activeItems(w){this._activeItems=w.filter(v=>this._itemsToHandles.has(v)),this.update({activeItems:this._activeItems.map(v=>this._itemsToHandles.get(v))})}get selectedItems(){return this._selectedItems}set selectedItems(w){this._selectedItems=w.filter(v=>this._itemsToHandles.has(v)),this.update({selectedItems:this._selectedItems.map(v=>this._itemsToHandles.get(v))})}_fireDidChangeActive(w){const v=sn(w.map(m=>this._handlesToItems.get(m)));this._activeItems=v,this._onDidChangeActiveEmitter.fire(v)}_fireDidChangeSelection(w){const v=sn(w.map(m=>this._handlesToItems.get(m)));this._selectedItems=v,this._onDidChangeSelectionEmitter.fire(v)}_fireDidTriggerItemButton(w,v){const m=this._handlesToItems.get(w);if(!m||!m.buttons||!m.buttons.length)return;const x=m.buttons[v];x&&this._onDidTriggerItemButtonEmitter.fire({button:x,item:m})}}class d extends s{constructor(w,v){super(w,v),this._password=!1,this.update({type:"inputBox"})}get password(){return this._password}set password(w){this._password=w,this.update({password:w})}get prompt(){return this._prompt}set prompt(w){this._prompt=w,this.update({prompt:w})}get validationMessage(){return this._validationMessage}set validationMessage(w){this._validationMessage=w,w?typeof w=="string"?this.update({validationMessage:w,severity:qt.Error}):this.update({validationMessage:w.message,severity:w.severity??qt.Error}):this.update({validationMessage:void 0,severity:qt.Ignore})}}return new r(e,t)}const Mk=new Ci(()=>{const n=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:n,collatorIsNumeric:n.resolvedOptions().numeric}});function NF(n,e,t=!1){const i=n||"",r=e||"",s=Mk.value.collator.compare(i,r);return Mk.value.collatorIsNumeric&&s===0&&i!==r?i<r?-1:1:s}function OF(n,e,t=!1){return t||(n=n&&n.toLowerCase(),e=e&&e.toLowerCase()),n===e?0:n<e?-1:1}function Gp(n,e,t=!1){const i=n.split(hr),r=e.split(hr),s=i.length-1,o=r.length-1;let a,l;for(let c=0;;c++){if(a=s===c,l=o===c,a&&l)return NF(i[c],r[c],t);if(a)return-1;if(l)return 1;const u=OF(i[c],r[c],t);if(u!==0)return u}}var zy;function $k(n){return n instanceof y}function FF(n,e){return n.scheme===oe.file&&e.scheme===oe.file&&Fs?n.toString()===e.toString():n.toString().toLowerCase()===e.toString().toLowerCase()}function Tv(n){if(n)return typeof n.iconPath=="string"?y.file(n.iconPath):y.isUri(n.iconPath)||On.isThemeIcon(n.iconPath)?n.iconPath:void 0}function rl(n){if(n){if(y.isUri(n))return n;if(On.isThemeIcon(n))return n;{const e=n;return{light:e.light,dark:e.dark}}}else return}function MF(n){var i;const e=rl(n.authorIcon),t=(i=n.references)==null?void 0:i.map(r=>({...r,icon:rl(r.icon)}));return{...n,authorIcon:e,references:t}}function Av(n){return n?{...n,icon:rl(n.icon)}:void 0}function Rv(n,e){if(!n.iconPath&&!e.iconPath)return 0;if(n.iconPath){if(!e.iconPath)return 1}else return-1;const t=typeof n.iconPath=="string"?n.iconPath:y.isUri(n.iconPath)?n.iconPath.fsPath:n.iconPath.id,i=typeof e.iconPath=="string"?e.iconPath:y.isUri(e.iconPath)?e.iconPath.fsPath:e.iconPath.id;return Gp(t,i)}function $F(n,e){let t=0;if(n.strikeThrough!==e.strikeThrough)return n.strikeThrough?1:-1;if(n.faded!==e.faded)return n.faded?1:-1;if(n.tooltip!==e.tooltip)return(n.tooltip||"").localeCompare(e.tooltip||"");if(t=Rv(n,e),t!==0)return t;if(n.light&&e.light)t=Rv(n.light,e.light);else{if(n.light)return 1;if(e.light)return-1}if(t!==0)return t;if(n.dark&&e.dark)t=Rv(n.dark,e.dark);else{if(n.dark)return 1;if(e.dark)return-1}return t}function UF(n,e){if(n.command!==e.command)return n.command<e.command?-1:1;if(n.title!==e.title)return n.title<e.title?-1:1;if(n.tooltip!==e.tooltip){if(n.tooltip!==void 0&&e.tooltip!==void 0)return n.tooltip<e.tooltip?-1:1;if(n.tooltip!==void 0)return 1;if(e.tooltip!==void 0)return-1}if(n.arguments===e.arguments)return 0;if(n.arguments)if(e.arguments){if(n.arguments.length!==e.arguments.length)return n.arguments.length-e.arguments.length}else return 1;else return-1;for(let t=0;t<n.arguments.length;t++){const i=n.arguments[t],r=e.arguments[t];if(i!==r&&!($k(i)&&$k(r)&&FF(i,r)))return i<r?-1:1}return 0}function Uk(n,e){let t=Gp(n.resourceUri.fsPath,e.resourceUri.fsPath,!0);if(t!==0)return t;if(n.command&&e.command)t=UF(n.command,e.command);else{if(n.command)return 1;if(e.command)return-1}if(t!==0)return t;if(n.decorations&&e.decorations)t=$F(n.decorations,e.decorations);else{if(n.decorations)return 1;if(e.decorations)return-1}if(t!==0)return t;if(n.multiFileDiffEditorModifiedUri&&e.multiFileDiffEditorModifiedUri)t=Gp(n.multiFileDiffEditorModifiedUri.fsPath,e.multiFileDiffEditorModifiedUri.fsPath,!0);else{if(n.multiFileDiffEditorModifiedUri)return 1;if(e.multiFileDiffEditorModifiedUri)return-1}if(t!==0)return t;if(n.multiDiffEditorOriginalUri&&e.multiDiffEditorOriginalUri)t=Gp(n.multiDiffEditorOriginalUri.fsPath,e.multiDiffEditorOriginalUri.fsPath,!0);else{if(n.multiDiffEditorOriginalUri)return 1;if(e.multiDiffEditorOriginalUri)return-1}return t}function HF(n,e){for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function BF(n,e){return n.command===e.command&&n.title===e.title&&n.tooltip===e.tooltip&&(n.arguments&&e.arguments?HF(n.arguments,e.arguments):n.arguments===e.arguments)}function WF(n,e){return $r(n,e,BF)}var kr,Of;class VF{constructor(e,t,i,r,s){ge(this,kr);ge(this,Of);this._extension=e,this._sourceControlHandle=r,this._documentUri=s,this._value="",this._onDidChange=new L,this._placeholder="",this._enabled=!0,this._visible=!0,ie(this,Of,t),ie(this,kr,i)}get value(){return this._value}set value(e){e=e??"",A(this,kr).$setInputBoxValue(this._sourceControlHandle,e),this.updateValue(e)}get onDidChange(){return this._onDidChange.event}get placeholder(){return this._placeholder}set placeholder(e){A(this,kr).$setInputBoxPlaceholder(this._sourceControlHandle,e),this._placeholder=e}get validateInput(){return $(this._extension,"scmValidation"),this._validateInput}set validateInput(e){if($(this._extension,"scmValidation"),e&&typeof e!="function")throw new Error(`[${this._extension.identifier.value}]: Invalid SCM input box validation function`);this._validateInput=e,A(this,kr).$setValidationProviderIsEnabled(this._sourceControlHandle,!!e)}get enabled(){return this._enabled}set enabled(e){e=!!e,this._enabled!==e&&(this._enabled=e,A(this,kr).$setInputBoxEnablement(this._sourceControlHandle,e))}get visible(){return this._visible}set visible(e){e=!!e,this._visible!==e&&(this._visible=e,A(this,kr).$setInputBoxVisibility(this._sourceControlHandle,e))}get document(){return $(this._extension,"scmTextDocument"),A(this,Of).getDocument(this._documentUri)}showValidationMessage(e,t){$(this._extension,"scmValidation"),A(this,kr).$showValidationMessage(this._sourceControlHandle,e,t)}$onInputBoxValueChange(e){this.updateValue(e)}updateValue(e){this._value=e,this._onDidChange.fire(e)}}kr=new WeakMap,Of=new WeakMap;const Y1=class Y1{get disposed(){return this._disposed}get id(){return this._id}get label(){return this._label}set label(e){this._label=e,this._proxy.$updateGroupLabel(this._sourceControlHandle,this.handle,e)}get contextValue(){return this._contextValue}set contextValue(e){this._contextValue=e,this._proxy.$updateGroup(this._sourceControlHandle,this.handle,this.features)}get hideWhenEmpty(){return this._hideWhenEmpty}set hideWhenEmpty(e){this._hideWhenEmpty=e,this._proxy.$updateGroup(this._sourceControlHandle,this.handle,this.features)}get features(){return{contextValue:this.contextValue,hideWhenEmpty:this.hideWhenEmpty}}get resourceStates(){return[...this._resourceStates]}set resourceStates(e){this._resourceStates=[...e],this._onDidUpdateResourceStates.fire()}constructor(e,t,i,r,s,o,a){this._proxy=e,this._commands=t,this._sourceControlHandle=i,this._id=r,this._label=s,this.multiDiffEditorEnableViewChanges=o,this._extension=a,this._resourceHandlePool=0,this._resourceStates=[],this._resourceStatesMap=new Map,this._resourceStatesCommandsMap=new Map,this._resourceStatesDisposablesMap=new Map,this._onDidUpdateResourceStates=new L,this.onDidUpdateResourceStates=this._onDidUpdateResourceStates.event,this._disposed=!1,this._onDidDispose=new L,this.onDidDispose=this._onDidDispose.event,this._handlesSnapshot=[],this._resourceSnapshot=[],this._contextValue=void 0,this._hideWhenEmpty=void 0,this.handle=Y1._handlePool++}getResourceState(e){return this._resourceStatesMap.get(e)}$executeResourceCommand(e,t){const i=this._resourceStatesCommandsMap.get(e);return i?Nn(()=>this._commands.executeCommand(i.command,...i.arguments||[],t)):Promise.resolve(void 0)}_takeResourceStateSnapshot(){var o;const e=[...this._resourceStates].sort(Uk),i=sI(this._resourceSnapshot,e,Uk).map(a=>{const l=a.toInsert.map(c=>{const u=this._resourceHandlePool++;this._resourceStatesMap.set(u,c);const d=c.resourceUri;let f;if(c.command)if(c.command.command==="vscode.open"||c.command.command==="vscode.diff"||c.command.command==="vscode.changes"){const Q=new Ie;f=this._commands.converter.toInternal(c.command,Q),this._resourceStatesDisposablesMap.set(u,Q)}else this._resourceStatesCommandsMap.set(u,c.command);const p=vt(this._extension,"scmMultiDiffEditor"),w=p?c.multiDiffEditorOriginalUri:void 0,v=p?c.multiFileDiffEditorModifiedUri:void 0,m=Tv(c.decorations),x=c.decorations&&Tv(c.decorations.light)||m,k=c.decorations&&Tv(c.decorations.dark)||m,D=[x,k],B=c.decorations&&c.decorations.tooltip||"",T=c.decorations&&!!c.decorations.strikeThrough,z=c.decorations&&!!c.decorations.faded,K=c.contextValue||"";return{rawResource:[u,d,D,B,T,z,K,f,w,v],handle:u}});return{start:a.start,deleteCount:a.deleteCount,toInsert:l}}),r=i.map(({start:a,deleteCount:l,toInsert:c})=>[a,l,c.map(u=>u.rawResource)]),s=i.reverse();for(const{start:a,deleteCount:l,toInsert:c}of s){const u=c.map(f=>f.handle),d=this._handlesSnapshot.splice(a,l,...u);for(const f of d)this._resourceStatesMap.delete(f),this._resourceStatesCommandsMap.delete(f),(o=this._resourceStatesDisposablesMap.get(f))==null||o.dispose(),this._resourceStatesDisposablesMap.delete(f)}return this._resourceSnapshot=e,r}dispose(){this._disposed=!0,this._onDidDispose.fire()}};Y1._handlePool=0;let qy=Y1;var cn;const Z1=class Z1{constructor(e,t,i,r,s,o,a){ge(this,cn);this._extension=e,this._commands=r,this._id=s,this._label=o,this._rootUri=a,this._groups=new Map,this._count=void 0,this._quickDiffProvider=void 0,this._historyProviderDisposable=new go,this._commitTemplate=void 0,this._acceptInputDisposables=new go,this._acceptInputCommand=void 0,this._actionButtonDisposables=new go,this._statusBarDisposables=new go,this._statusBarCommands=void 0,this._selected=!1,this._onDidChangeSelection=new L,this.onDidChangeSelection=this._onDidChangeSelection.event,this.handle=Z1._handlePool++,this.createdResourceGroups=new Map,this.updatedResourceGroups=new Set,ie(this,cn,i);const l=y.from({scheme:oe.vscodeSourceControl,path:`${s}/scm${this.handle}/input`,query:a?`rootUri=${encodeURIComponent(a.toString())}`:void 0});this._inputBox=new VF(e,t,A(this,cn),this.handle,l),A(this,cn).$registerSourceControl(this.handle,s,o,a,l)}get id(){return this._id}get label(){return this._label}get rootUri(){return this._rootUri}get inputBox(){return this._inputBox}get count(){return this._count}set count(e){this._count!==e&&(this._count=e,A(this,cn).$updateSourceControl(this.handle,{count:e}))}get quickDiffProvider(){return this._quickDiffProvider}set quickDiffProvider(e){this._quickDiffProvider=e;let t;vt(this._extension,"quickDiffProvider")&&(t=e==null?void 0:e.label),A(this,cn).$updateSourceControl(this.handle,{hasQuickDiffProvider:!!e,quickDiffLabel:t})}get historyProvider(){return $(this._extension,"scmHistoryProvider"),this._historyProvider}set historyProvider(e){$(this._extension,"scmHistoryProvider"),this._historyProvider=e,this._historyProviderDisposable.value=new Ie,A(this,cn).$updateSourceControl(this.handle,{hasHistoryProvider:!!e}),e&&(this._historyProviderDisposable.value.add(e.onDidChangeCurrentHistoryItemRefs(()=>{const t=Av(e==null?void 0:e.currentHistoryItemRef),i=Av(e==null?void 0:e.currentHistoryItemRemoteRef),r=Av(e==null?void 0:e.currentHistoryItemBaseRef);A(this,cn).$onDidChangeHistoryProviderCurrentHistoryItemRefs(this.handle,t,i,r)})),this._historyProviderDisposable.value.add(e.onDidChangeHistoryItemRefs(t=>{if(t.added.length===0&&t.modified.length===0&&t.removed.length===0)return;const i=t.added.map(o=>({...o,icon:rl(o.icon)})),r=t.modified.map(o=>({...o,icon:rl(o.icon)})),s=t.removed.map(o=>({...o,icon:rl(o.icon)}));A(this,cn).$onDidChangeHistoryProviderHistoryItemRefs(this.handle,{added:i,modified:r,removed:s,silent:t.silent})})))}get commitTemplate(){return this._commitTemplate}set commitTemplate(e){e!==this._commitTemplate&&(this._commitTemplate=e,A(this,cn).$updateSourceControl(this.handle,{commitTemplate:e}))}get acceptInputCommand(){return this._acceptInputCommand}set acceptInputCommand(e){this._acceptInputDisposables.value=new Ie,this._acceptInputCommand=e;const t=this._commands.converter.toInternal(e,this._acceptInputDisposables.value);A(this,cn).$updateSourceControl(this.handle,{acceptInputCommand:t})}get actionButton(){return $(this._extension,"scmActionButton"),this._actionButton}set actionButton(e){var i;if($(this._extension,"scmActionButton"),ky(this._actionButton,e))return;this._actionButton=e,this._actionButtonDisposables.value=new Ie;const t=e!==void 0?{command:{...this._commands.converter.toInternal(e.command,this._actionButtonDisposables.value),shortTitle:e.command.shortTitle},secondaryCommands:(i=e.secondaryCommands)==null?void 0:i.map(r=>r.map(s=>this._commands.converter.toInternal(s,this._actionButtonDisposables.value))),enabled:e.enabled}:void 0;A(this,cn).$updateSourceControl(this.handle,{actionButton:t??null})}get statusBarCommands(){return this._statusBarCommands}set statusBarCommands(e){if(this._statusBarCommands&&e&&WF(this._statusBarCommands,e))return;this._statusBarDisposables.value=new Ie,this._statusBarCommands=e;const t=(e||[]).map(i=>this._commands.converter.toInternal(i,this._statusBarDisposables.value));A(this,cn).$updateSourceControl(this.handle,{statusBarCommands:t})}get selected(){return this._selected}createResourceGroup(e,t,i){const r=vt(this._extension,"scmMultiDiffEditor")&&(i==null?void 0:i.multiDiffEditorEnableViewChanges)===!0,s=new qy(A(this,cn),this._commands,this.handle,e,t,r,this._extension),o=Ht.once(s.onDidDispose)(()=>this.createdResourceGroups.delete(s));return this.createdResourceGroups.set(s,o),this.eventuallyAddResourceGroups(),s}eventuallyAddResourceGroups(){const e=[],t=[];for(const[i,r]of this.createdResourceGroups){r.dispose();const s=i.onDidUpdateResourceStates(()=>{this.updatedResourceGroups.add(i),this.eventuallyUpdateResourceStates()});Ht.once(i.onDidDispose)(()=>{this.updatedResourceGroups.delete(i),s.dispose(),this._groups.delete(i.handle),A(this,cn).$unregisterGroup(this.handle,i.handle)}),e.push([i.handle,i.id,i.label,i.features,i.multiDiffEditorEnableViewChanges]);const o=i._takeResourceStateSnapshot();o.length>0&&t.push([i.handle,o]),this._groups.set(i.handle,i)}A(this,cn).$registerGroups(this.handle,e,t),this.createdResourceGroups.clear()}eventuallyUpdateResourceStates(){const e=[];this.updatedResourceGroups.forEach(t=>{const i=t._takeResourceStateSnapshot();i.length!==0&&e.push([t.handle,i])}),e.length>0&&A(this,cn).$spliceResourceStates(this.handle,e),this.updatedResourceGroups.clear()}getResourceGroup(e){return this._groups.get(e)}setSelectionState(e){this._selected=e,this._onDidChangeSelection.fire(e)}dispose(){this._acceptInputDisposables.dispose(),this._actionButtonDisposables.dispose(),this._statusBarDisposables.dispose(),this._groups.forEach(e=>e.dispose()),A(this,cn).$unregisterSourceControl(this.handle)}};cn=new WeakMap,Z1._handlePool=0;let El=Z1;El.__decorator=V([D7(100)],El.prototype,"eventuallyAddResourceGroups",null);El.__decorator=V([D7(100)],El.prototype,"eventuallyUpdateResourceStates",null);var cl;let jy=(cl=class{get onDidChangeActiveProvider(){return this._onDidChangeActiveProvider.event}constructor(e,t,i,r){this._commands=t,this._extHostDocuments=i,this.logService=r,this._sourceControls=new Map,this._sourceControlsByExtension=new Ms,this._onDidChangeActiveProvider=new L,this._proxy=e.getProxy(Z.MainThreadSCM),this._telemetry=e.getProxy(Z.MainThreadTelemetry),t.registerArgumentProcessor({processArgument:s=>{if(s&&s.$mid===rt.ScmResource){const o=this._sourceControls.get(s.sourceControlHandle);if(!o)return s;const a=o.getResourceGroup(s.groupHandle);return a?a.getResourceState(s.handle):s}else if(s&&s.$mid===rt.ScmResourceGroup){const o=this._sourceControls.get(s.sourceControlHandle);return o?o.getResourceGroup(s.groupHandle):s}else if(s&&s.$mid===rt.ScmProvider){const o=this._sourceControls.get(s.handle);return o||s}return s}})}createSourceControl(e,t,i,r){this.logService.trace("ExtHostSCM#createSourceControl",e.identifier.value,t,i,r),this._telemetry.$publicLog2("api/scm/createSourceControl",{extensionId:e.identifier.value});const s=zy._handlePool++,o=new El(e,this._extHostDocuments,this._proxy,this._commands,t,i,r);this._sourceControls.set(s,o);const a=this._sourceControlsByExtension.get(e.identifier)||[];return a.push(o),this._sourceControlsByExtension.set(e.identifier,a),o}getLastInputBox(e){this.logService.trace("ExtHostSCM#getLastInputBox",e.identifier.value);const t=this._sourceControlsByExtension.get(e.identifier),i=t&&t[t.length-1];return i&&i.inputBox}$provideOriginalResource(e,t,i){const r=y.revive(t);this.logService.trace("ExtHostSCM#$provideOriginalResource",e,r.toString());const s=this._sourceControls.get(e);return!s||!s.quickDiffProvider||!s.quickDiffProvider.provideOriginalResource?Promise.resolve(null):Nn(()=>s.quickDiffProvider.provideOriginalResource(r,i)).then(o=>o||null)}$onInputBoxValueChange(e,t){this.logService.trace("ExtHostSCM#$onInputBoxValueChange",e);const i=this._sourceControls.get(e);return i&&i.inputBox.$onInputBoxValueChange(t),Promise.resolve(void 0)}$executeResourceCommand(e,t,i,r){this.logService.trace("ExtHostSCM#$executeResourceCommand",e,t,i);const s=this._sourceControls.get(e);if(!s)return Promise.resolve(void 0);const o=s.getResourceGroup(t);return o?o.$executeResourceCommand(i,r):Promise.resolve(void 0)}$validateInput(e,t,i){this.logService.trace("ExtHostSCM#$validateInput",e);const r=this._sourceControls.get(e);return!r||!r.inputBox.validateInput?Promise.resolve(void 0):Nn(()=>r.inputBox.validateInput(t,i)).then(s=>{if(!s)return Promise.resolve(void 0);const o=Le.fromStrict(s.message);return o?Promise.resolve([o,s.type]):Promise.resolve(void 0)})}$setSelectedSourceControl(e){var t,i;return this.logService.trace("ExtHostSCM#$setSelectedSourceControl",e),e!==void 0&&((t=this._sourceControls.get(e))==null||t.setSelectionState(!0)),this._selectedSourceControlHandle!==void 0&&((i=this._sourceControls.get(this._selectedSourceControlHandle))==null||i.setSelectionState(!1)),this._selectedSourceControlHandle=e,Promise.resolve(void 0)}async $resolveHistoryItemRefsCommonAncestor(e,t,i){var r;try{const s=(r=this._sourceControls.get(e))==null?void 0:r.historyProvider;return await(s==null?void 0:s.resolveHistoryItemRefsCommonAncestor(t,i))??void 0}catch(s){this.logService.error("ExtHostSCM#$resolveHistoryItemRefsCommonAncestor",s);return}}async $provideHistoryItemRefs(e,t,i){var r;try{const s=(r=this._sourceControls.get(e))==null?void 0:r.historyProvider,o=await(s==null?void 0:s.provideHistoryItemRefs(t,i));return(o==null?void 0:o.map(a=>({...a,icon:rl(a.icon)})))??void 0}catch(s){this.logService.error("ExtHostSCM#$provideHistoryItemRefs",s);return}}async $provideHistoryItems(e,t,i){var r;try{const s=(r=this._sourceControls.get(e))==null?void 0:r.historyProvider,o=await(s==null?void 0:s.provideHistoryItems(t,i));return(o==null?void 0:o.map(a=>MF(a)))??void 0}catch(s){this.logService.error("ExtHostSCM#$provideHistoryItems",s);return}}async $provideHistoryItemChanges(e,t,i,r){var s;try{const o=(s=this._sourceControls.get(e))==null?void 0:s.historyProvider;return await(o==null?void 0:o.provideHistoryItemChanges(t,i,r))??void 0}catch(o){this.logService.error("ExtHostSCM#$provideHistoryItemChanges",o);return}}},zy=cl,cl._handlePool=0,cl);jy=zy=V([F(3,ct)],jy);const K1=class K1{constructor(e,t){this.uriTransformer=t,this.providers=new Map,this.proxy=e.getProxy(Z.MainThreadShare)}async $provideShare(e,t,i){const r=this.providers.get(e);return await(r==null?void 0:r.provideShare({selection:W.to(t.selection),resourceUri:y.revive(t.resourceUri)},i))??void 0}registerShareProvider(e,t){const i=K1.handlePool++;return this.providers.set(i,t),this.proxy.$registerShareProvider(i,Pu.from(e,this.uriTransformer),t.id,t.label,t.priority),{dispose:()=>{this.proxy.$unregisterShareProvider(i),this.providers.delete(i)}}}};K1.handlePool=0;let Gy=K1;const e_=class e_{constructor(e){this.providers=new Map,this.sessions=new Map,this.synthesizers=new Map,this.proxy=e.getProxy(Z.MainThreadSpeech)}async $createSpeechToTextSession(e,t,i){const r=this.providers.get(e);if(!r)return;const s=new Ie,o=new Bt;this.sessions.set(t,o);const a=await r.provideSpeechToTextSession(o.token,i?{language:i}:void 0);a&&(s.add(a.onDidChange(l=>{o.token.isCancellationRequested||this.proxy.$emitSpeechToTextEvent(t,l)})),s.add(o.token.onCancellationRequested(()=>s.dispose())))}async $cancelSpeechToTextSession(e){var t;(t=this.sessions.get(e))==null||t.dispose(!0),this.sessions.delete(e)}async $createTextToSpeechSession(e,t,i){const r=this.providers.get(e);if(!r)return;const s=new Ie,o=new Bt;this.sessions.set(t,o);const a=await r.provideTextToSpeechSession(o.token,i?{language:i}:void 0);a&&(this.synthesizers.set(t,a),s.add(a.onDidChange(l=>{o.token.isCancellationRequested||this.proxy.$emitTextToSpeechEvent(t,l)})),s.add(o.token.onCancellationRequested(()=>s.dispose())))}async $synthesizeSpeech(e,t){var i;(i=this.synthesizers.get(e))==null||i.synthesize(t)}async $cancelTextToSpeechSession(e){var t;(t=this.sessions.get(e))==null||t.dispose(!0),this.sessions.delete(e),this.synthesizers.delete(e)}async $createKeywordRecognitionSession(e,t){const i=this.providers.get(e);if(!i)return;const r=new Ie,s=new Bt;this.sessions.set(t,s);const o=await i.provideKeywordRecognitionSession(s.token);o&&(r.add(o.onDidChange(a=>{s.token.isCancellationRequested||this.proxy.$emitKeywordRecognitionEvent(t,a)})),r.add(s.token.onCancellationRequested(()=>r.dispose())))}async $cancelKeywordRecognitionSession(e){var t;(t=this.sessions.get(e))==null||t.dispose(!0),this.sessions.delete(e)}registerProvider(e,t,i){const r=e_.ID_POOL++;return this.providers.set(r,i),this.proxy.$registerProvider(r,t,{extension:e,displayName:e.value}),Se(()=>{this.proxy.$unregisterProvider(r),this.providers.delete(r)})}};e_.ID_POOL=1;let Qy=e_;var Xc,Yc;const aa=class aa{constructor(e,t,i,r,s,o=_o.Left,a,l){ge(this,Xc);ge(this,Yc);if(this._onDispose=l,this._disposed=!1,this._text="",this._staleCommandRegistrations=new Ie,ie(this,Xc,e),ie(this,Yc,t),s&&r){this._entryId=t3(r.identifier,s);const c=i.get(this._entryId);c&&(o=c.alignLeft?_o.Left:_o.Right,a=c.priority,this._visible=!0,this.name=c.name,this.text=c.text,this.tooltip=c.tooltip,this.command=c.command,this.accessibilityInformation=c.accessibilityInformation)}else this._entryId=String(aa.ID_GEN++);this._extension=r,this._id=s,this._alignment=o,this._priority=this.validatePriority(a)}validatePriority(e){if(Ua(e))return e===Number.POSITIVE_INFINITY?Number.MAX_VALUE:e===Number.NEGATIVE_INFINITY?-Number.MAX_VALUE:e}get id(){return this._id??this._extension.identifier.value}get entryId(){return this._entryId}get alignment(){return this._alignment}get priority(){return this._priority}get text(){return this._text}get name(){return this._name}get tooltip(){return this._tooltip}get tooltip2(){return this._extension&&$(this._extension,"statusBarItemTooltip"),this._tooltip2}get color(){return this._color}get backgroundColor(){return this._backgroundColor}get command(){var e;return(e=this._command)==null?void 0:e.fromApi}get accessibilityInformation(){return this._accessibilityInformation}set text(e){this._text=e,this.update()}set name(e){this._name=e,this.update()}set tooltip(e){this._tooltip=e,this.update()}set tooltip2(e){this._extension&&$(this._extension,"statusBarItemTooltip"),this._tooltip2=e,this.update()}set color(e){this._color=e,this.update()}set backgroundColor(e){e&&!aa.ALLOWED_BACKGROUND_COLORS.has(e.id)&&(e=void 0),this._backgroundColor=e,this.update()}set command(e){var t;((t=this._command)==null?void 0:t.fromApi)!==e&&(this._latestCommandRegistration&&this._staleCommandRegistrations.add(this._latestCommandRegistration),this._latestCommandRegistration=new Ie,typeof e=="string"?this._command={fromApi:e,internal:A(this,Yc).toInternal({title:"",command:e},this._latestCommandRegistration)}:e?this._command={fromApi:e,internal:A(this,Yc).toInternal(e,this._latestCommandRegistration)}:this._command=void 0,this.update())}set accessibilityInformation(e){this._accessibilityInformation=e,this.update()}show(){this._visible=!0,this.update()}hide(){clearTimeout(this._timeoutHandle),this._visible=!1,A(this,Xc).$disposeEntry(this._entryId)}update(){this._disposed||!this._visible||(clearTimeout(this._timeoutHandle),this._timeoutHandle=setTimeout(()=>{var o,a;this._timeoutHandle=void 0;let e;this._extension?this._id?e=`${this._extension.identifier.value}.${this._id}`:e=this._extension.identifier.value:e=this._id;let t;this._name?t=this._name:t=h(2548,"{0} (Extension)",this._extension.displayName||this._extension.name);let i=this._color;this._backgroundColor&&(i=aa.ALLOWED_BACKGROUND_COLORS.get(this._backgroundColor.id));let r,s;typeof this._tooltip2=="function"?(r=Le.fromStrict(this._tooltip),s=!0):(r=Le.fromStrict(this._tooltip2??this._tooltip),s=!1),A(this,Xc).$setEntry(this._entryId,e,(o=this._extension)==null?void 0:o.identifier.value,t,this._text,r,s,(a=this._command)==null?void 0:a.internal,i,this._backgroundColor,this._alignment===_o.Left,this._priority,this._accessibilityInformation),this._staleCommandRegistrations.clear()},0))}dispose(){var e;this.hide(),(e=this._onDispose)==null||e.call(this),this._disposed=!0}};Xc=new WeakMap,Yc=new WeakMap,aa.ID_GEN=0,aa.ALLOWED_BACKGROUND_COLORS=new Map([["statusBarItem.errorBackground",new Oh("statusBarItem.errorForeground")],["statusBarItem.warningBackground",new Oh("statusBarItem.warningForeground")]]);let Jy=aa;class zF{constructor(e){this._messages=[],this._item=e.createStatusBarEntry(void 0,"status.extensionMessage",_o.Left,Number.MIN_VALUE),this._item.name=h(2549,"Extension Status")}dispose(){this._messages.length=0,this._item.dispose()}setMessage(e){const t={message:e};return this._messages.unshift(t),this._update(),new je(()=>{const i=this._messages.indexOf(t);i>=0&&(this._messages.splice(i,1),this._update())})}_update(){this._messages.length>0?(this._item.text=this._messages[0].message,this._item.show()):this._item.hide()}}class qF{constructor(e,t){this._entries=new Map,this._existingItems=new Map,this._proxy=e.getProxy(Z.MainThreadStatusBar),this._commands=t,this._statusMessage=new zF(this)}$acceptStaticEntries(e){for(const t of e)this._existingItems.set(t.entryId,t)}async $provideTooltip(e,t){const i=this._entries.get(e);if(!i)return;const r=typeof i.tooltip2=="function"?await i.tooltip2(t):i.tooltip2;return t.isCancellationRequested?void 0:Le.fromStrict(r)}createStatusBarEntry(e,t,i,r){const s=new Jy(this._proxy,this._commands,this._existingItems,e,t,i,r,()=>this._entries.delete(s.entryId));return this._entries.set(s.entryId,s),s}setStatusBarMessage(e,t){const i=this._statusMessage.setMessage(e);let r;return typeof t=="number"?r=setTimeout(()=>i.dispose(),t):typeof t<"u"&&t.then(()=>i.dispose(),()=>i.dispose()),new je(()=>{i.dispose(),clearTimeout(r)})}}class jF extends Te{constructor(e,t){super(),this._extHostDocumentsAndEditors=t,this._onDidChangeTextEditorSelection=new L,this._onDidChangeTextEditorOptions=new L,this._onDidChangeTextEditorVisibleRanges=new L,this._onDidChangeTextEditorViewColumn=new L,this._onDidChangeTextEditorDiffInformation=new L,this._onDidChangeActiveTextEditor=new L,this._onDidChangeVisibleTextEditors=new L,this.onDidChangeTextEditorSelection=this._onDidChangeTextEditorSelection.event,this.onDidChangeTextEditorOptions=this._onDidChangeTextEditorOptions.event,this.onDidChangeTextEditorVisibleRanges=this._onDidChangeTextEditorVisibleRanges.event,this.onDidChangeTextEditorViewColumn=this._onDidChangeTextEditorViewColumn.event,this.onDidChangeTextEditorDiffInformation=this._onDidChangeTextEditorDiffInformation.event,this.onDidChangeActiveTextEditor=this._onDidChangeActiveTextEditor.event,this.onDidChangeVisibleTextEditors=this._onDidChangeVisibleTextEditors.event,this._proxy=e.getProxy(Z.MainThreadTextEditors),this._register(this._extHostDocumentsAndEditors.onDidChangeVisibleTextEditors(i=>this._onDidChangeVisibleTextEditors.fire(i))),this._register(this._extHostDocumentsAndEditors.onDidChangeActiveTextEditor(i=>this._onDidChangeActiveTextEditor.fire(i)))}getActiveTextEditor(){return this._extHostDocumentsAndEditors.activeEditor()}getVisibleTextEditors(e){const t=this._extHostDocumentsAndEditors.allEditors();return e?t:t.map(i=>i.value)}async showTextDocument(e,t,i){let r;typeof t=="number"?r={position:nn.from(t),preserveFocus:i}:typeof t=="object"?r={position:nn.from(t.viewColumn),preserveFocus:t.preserveFocus,selection:typeof t.selection=="object"?W.from(t.selection):void 0,pinned:typeof t.preview=="boolean"?!t.preview:void 0}:r={preserveFocus:!1};const s=await this._proxy.$tryShowTextDocument(e.uri,r),o=s&&this._extHostDocumentsAndEditors.getEditor(s);if(o)return o.value;throw s?new Error(`Could NOT open editor for "${e.uri.toString()}" because another editor opened in the meantime.`):new Error(`Could NOT open editor for "${e.uri.toString()}".`)}createTextEditorDecorationType(e,t){return new H0(this._proxy,e,t).value}$acceptEditorPropertiesChanged(e,t){const i=this._extHostDocumentsAndEditors.getEditor(e);if(!i)throw new Error("unknown text editor");if(t.options&&i._acceptOptions(t.options),t.selections){const r=t.selections.selections.map(pr.to);i._acceptSelections(r)}if(t.visibleRanges){const r=sn(t.visibleRanges.map(W.to));i._acceptVisibleRanges(r)}if(t.options&&this._onDidChangeTextEditorOptions.fire({textEditor:i.value,options:{...t.options,lineNumbers:$c.to(t.options.lineNumbers)}}),t.selections){const r=bu.fromValue(t.selections.source),s=t.selections.selections.map(pr.to);this._onDidChangeTextEditorSelection.fire({textEditor:i.value,selections:s,kind:r})}if(t.visibleRanges){const r=sn(t.visibleRanges.map(W.to));this._onDidChangeTextEditorVisibleRanges.fire({textEditor:i.value,visibleRanges:r})}}$acceptEditorPositionData(e){for(const t in e){const i=this._extHostDocumentsAndEditors.getEditor(t);if(!i)throw new Error("Unknown text editor");const r=nn.to(e[t]);i.value.viewColumn!==r&&(i._acceptViewColumn(r),this._onDidChangeTextEditorViewColumn.fire({textEditor:i.value,viewColumn:r}))}}$acceptEditorDiffInformation(e,t){const i=this._extHostDocumentsAndEditors.getEditor(e);if(!i)throw new Error("unknown text editor");if(!t){i._acceptDiffInformation(void 0),this._onDidChangeTextEditorDiffInformation.fire({textEditor:i.value,diffInformation:void 0});return}const r=this,s=t.map(o=>{const a=y.revive(o.original),l=y.revive(o.modified),c=o.changes.map(u=>{const[d,f,p,w]=u;let v;return d===f?v=Ac.Addition:p===w?v=Ac.Deletion:v=Ac.Modification,{original:{startLineNumber:d,endLineNumberExclusive:f},modified:{startLineNumber:p,endLineNumberExclusive:w},kind:v}});return Object.freeze({documentVersion:o.documentVersion,original:a,modified:l,changes:c,get isStale(){const u=r._extHostDocumentsAndEditors.getDocument(l);return(u==null?void 0:u.version)!==o.documentVersion}})});i._acceptDiffInformation(s),this._onDidChangeTextEditorDiffInformation.fire({textEditor:i.value,diffInformation:s})}getDiffInformation(e){return Promise.resolve(this._proxy.$getDiffInformation(e))}}let Xy=class{constructor(e){this._actual=new fm(so.Dark),this._onDidChangeActiveColorTheme=new L}get activeColorTheme(){return this._actual}$onColorThemeChange(e){let t;switch(e){case"light":t=so.Light;break;case"hcDark":t=so.HighContrast;break;case"hcLight":t=so.HighContrastLight;break;default:t=so.Dark}this._actual=new fm(t),this._onDidChangeActiveColorTheme.fire(this._actual)}get onDidChangeActiveColorTheme(){return this._onDidChangeActiveColorTheme.event}};Xy=V([F(0,tt)],Xy);class GF{constructor(e,t){this._providers=new Map,this._itemsBySourceAndUriMap=new Map,this._proxy=e.getProxy(Z.MainThreadTimeline),t.registerArgumentProcessor({processArgument:(i,r)=>{var s,o;if(i&&i.$mid===rt.TimelineActionContext)if(this._providers.get(i.source)&&r&&vt(r,"timeline")){const a=i.uri===void 0?void 0:y.revive(i.uri);return(o=(s=this._itemsBySourceAndUriMap.get(i.source))==null?void 0:s.get(Hk(a)))==null?void 0:o.get(i.handle)}else return;return i}})}async $getTimeline(e,t,i,r){const s=this._providers.get(e);return s==null?void 0:s.provider.provideTimeline(y.revive(t),i,r)}registerTimelineProvider(e,t,i,r){const s=new Ie,o=this.convertTimelineItem(t.id,r,s).bind(this);let a;t.onDidChange&&(a=t.onDidChange(c=>this._proxy.$emitTimelineChangeEvent({uri:void 0,reset:!0,...c,id:t.id}),this));const l=this._itemsBySourceAndUriMap;return this.registerTimelineProviderCore({...t,scheme:e,onDidChange:void 0,async provideTimeline(c,u,d){var w;u!=null&&u.resetCache&&(s.clear(),(w=l.get(t.id))==null||w.clear());const f=await t.provideTimeline(c,u,d);if(f==null)return;const p=o(c,u);return{...f,source:t.id,items:f.items.map(p)}},dispose(){var c;for(const u of l.values())(c=u.get(t.id))==null||c.clear();a==null||a.dispose(),s.dispose()}},i)}convertTimelineItem(e,t,i){return(r,s)=>{let o;if(s!=null&&s.cacheResults){let a=this._itemsBySourceAndUriMap.get(e);a===void 0&&(a=new Map,this._itemsBySourceAndUriMap.set(e,a));const l=Hk(r);o=a.get(l),o===void 0&&(o=new Map,a.set(l,o))}return a=>{const{iconPath:l,...c}=a,u=`${e}|${a.id??a.timestamp}`;o==null||o.set(u,a);let d,f,p;a.iconPath&&(l instanceof qn?p={id:l.id,color:l.color}:y.isUri(l)?(d=l,f=l):{light:d,dark:f}=l);let w;return pi.isMarkdownString(c.tooltip)?w=Le.from(c.tooltip):Ze(c.tooltip)?w=c.tooltip:pi.isMarkdownString(c.detail)?(console.warn("Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip"),w=Le.from(c.detail)):Ze(c.detail)&&(console.warn("Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip"),w=c.detail),{...c,id:c.id??void 0,handle:u,source:e,command:a.command?t.toInternal(a.command,i):void 0,icon:d,iconDark:f,themeIcon:p,tooltip:w,accessibilityInformation:a.accessibilityInformation}}}}registerTimelineProviderCore(e,t){if(this._providers.get(e.id))throw new Error(`Timeline Provider ${e.id} already exists.`);return this._proxy.$registerTimelineProvider({id:e.id,label:e.label,scheme:e.scheme}),this._providers.set(e.id,{provider:e,extension:t}),Se(()=>{var r;for(const s of this._itemsBySourceAndUriMap.values())(r=s.get(e.id))==null||r.clear();this._providers.delete(e.id),this._proxy.$unregisterTimelineProvider(e.id),e.dispose()})}}function Hk(n){return n==null?void 0:n.toString()}const QF={IconContribution:"base.contributions.icons"};var Bk;(function(n){function e(t,i){let r=t.defaults;for(;On.isThemeIcon(r);){const s=td.getIcon(r.id);if(!s)return;r=s.defaults}return r}n.getDefinition=e})(Bk||(Bk={}));var Wk;(function(n){function e(i){return{weight:i.weight,style:i.style,src:i.src.map(r=>({format:r.format,location:r.location.toString()}))}}n.toJSONObject=e;function t(i){const r=s=>Ze(s)?s:void 0;if(i&&Array.isArray(i.src)&&i.src.every(s=>Ze(s.format)&&Ze(s.location)))return{weight:r(i.weight),style:r(i.style),src:i.src.map(s=>({format:s.format,location:y.parse(s.location)}))}}n.fromJSONObject=t})(Wk||(Wk={}));const JF=/^([\w_-]+)$/,XF=h(2268,"The font ID must only contain letters, numbers, underscores and dashes.");class YF{constructor(){this._onDidChange=new L,this.onDidChange=this._onDidChange.event,this.iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:h(2269,"The id of the font to use. If not set, the font that is defined first is used."),pattern:JF.source,patternErrorMessage:XF},fontCharacter:{type:"string",description:h(2270,"The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}},this.iconReferenceSchema={type:"string",pattern:`^${On.iconNameExpression}$`,enum:[],enumDescriptions:[]},this.iconsById={},this.iconFontsById={}}registerIcon(e,t,i,r){const s=this.iconsById[e];if(s){if(i&&!s.description){s.description=i,this.iconSchema.properties[e].markdownDescription=`${i} $(${e})`;const l=this.iconReferenceSchema.enum.indexOf(e);l!==-1&&(this.iconReferenceSchema.enumDescriptions[l]=i),this._onDidChange.fire()}return s}const o={id:e,description:i,defaults:t,deprecationMessage:r};this.iconsById[e]=o;const a={$ref:"#/definitions/icons"};return r&&(a.deprecationMessage=r),i&&(a.markdownDescription=`${i}: $(${e})`),this.iconSchema.properties[e]=a,this.iconReferenceSchema.enum.push(e),this.iconReferenceSchema.enumDescriptions.push(i||""),this._onDidChange.fire(),{id:e}}deregisterIcon(e){delete this.iconsById[e],delete this.iconSchema.properties[e];const t=this.iconReferenceSchema.enum.indexOf(e);t!==-1&&(this.iconReferenceSchema.enum.splice(t,1),this.iconReferenceSchema.enumDescriptions.splice(t,1)),this._onDidChange.fire()}getIcons(){return Object.keys(this.iconsById).map(e=>this.iconsById[e])}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}getIconReferenceSchema(){return this.iconReferenceSchema}registerIconFont(e,t){const i=this.iconFontsById[e];return i||(this.iconFontsById[e]=t,this._onDidChange.fire(),t)}deregisterIconFont(e){delete this.iconFontsById[e]}getIconFont(e){return this.iconFontsById[e]}toString(){const e=(s,o)=>s.id.localeCompare(o.id),t=s=>{for(;On.isThemeIcon(s.defaults);)s=this.iconsById[s.defaults.id];return`codicon codicon-${s?s.id:""}`},i=[];i.push("| preview     | identifier                        | default codicon ID                | description"),i.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");const r=Object.keys(this.iconsById).map(s=>this.iconsById[s]);for(const s of r.filter(o=>!!o.description).sort(e))i.push(`|<i class="${t(s)}"></i>|${s.id}|${On.isThemeIcon(s.defaults)?s.defaults.id:s.id}|${s.description||""}|`);i.push("| preview     | identifier                        "),i.push("| ----------- | --------------------------------- |");for(const s of r.filter(o=>!On.isThemeIcon(o.defaults)).sort(e))i.push(`|<i class="${t(s)}"></i>|${s.id}|`);return i.join(`
`)}}const td=new YF;Cn.add(QF.IconContribution,td);function A_(n,e,t,i){return td.registerIcon(n,e,t,i)}function ZF(){const n=IT();for(const e in n){const t="\\"+n[e].toString(16);td.registerIcon(e,{fontCharacter:t})}}ZF();const k7="vscode://schemas/icons",I7=Cn.as(f_.JSONContribution);I7.registerSchema(k7,td.getIconSchema());const Vk=new Gu(()=>I7.notifySchemaChanged(k7),200);td.onDidChange(()=>{Vk.isScheduled()||Vk.schedule()});A_("widget-close",we.close,h(2271,"Icon for the close action in widgets."));A_("goto-previous-location",we.arrowUp,h(2272,"Icon for goto previous editor location."));A_("goto-next-location",we.arrowDown,h(2273,"Icon for goto next editor location."));On.modify(we.sync,"spin");On.modify(we.loading,"spin");h(3994,"Views");A_("default-view-icon",we.window,h(3995,"Default view icon."));var E1;(function(n){n.ViewContainersRegistry="workbench.registry.view.containers",n.ViewsRegistry="workbench.registry.view"})(E1||(E1={}));var sh;(function(n){n[n.Sidebar=0]="Sidebar",n[n.Panel=1]="Panel",n[n.AuxiliaryBar=2]="AuxiliaryBar"})(sh||(sh={}));sh.Sidebar,sh.Panel,sh.AuxiliaryBar;class KF extends Te{constructor(){super(...arguments),this._onDidRegister=this._register(new L),this.onDidRegister=this._onDidRegister.event,this._onDidDeregister=this._register(new L),this.onDidDeregister=this._onDidDeregister.event,this.viewContainers=new Map,this.defaultViewContainers=[]}get all(){return[...this.viewContainers.values()].flat()}registerViewContainer(e,t,i){const r=this.get(e.id);if(r)return r;const s=e;return s.openCommandActionDescriptor=i!=null&&i.doNotRegisterOpenCommand?void 0:s.openCommandActionDescriptor??{id:s.id},B7(this.viewContainers,t,[]).push(s),i!=null&&i.isDefault&&this.defaultViewContainers.push(s),this._onDidRegister.fire({viewContainer:s,viewContainerLocation:t}),s}deregisterViewContainer(e){for(const t of this.viewContainers.keys()){const i=this.viewContainers.get(t),r=i==null?void 0:i.indexOf(e);if(r!==-1){i==null||i.splice(r,1),i.length===0&&this.viewContainers.delete(t),this._onDidDeregister.fire({viewContainer:e,viewContainerLocation:t});return}}}get(e){return this.all.filter(t=>t.id===e)[0]}getViewContainers(e){return[...this.viewContainers.get(e)||[]]}getViewContainerLocation(e){return[...this.viewContainers.keys()].filter(t=>this.getViewContainers(t).filter(i=>(i==null?void 0:i.id)===e.id).length>0)[0]}getDefaultViewContainer(e){return this.defaultViewContainers.find(t=>this.getViewContainerLocation(t)===e)}}Cn.add(E1.ViewContainersRegistry,new KF);var S1;(function(n){n.Open="2_open",n.Debug="4_debug",n.SCM="5_scm",n.More="9_more"})(S1||(S1={}));function eM(n,e){const t=n.group??S1.More,i=e.group??S1.More;return t!==i?t.localeCompare(i):(n.order??5)-(e.order??5)}class tM extends Te{constructor(){super(...arguments),this._onViewsRegistered=this._register(new L),this.onViewsRegistered=this._onViewsRegistered.event,this._onViewsDeregistered=this._register(new L),this.onViewsDeregistered=this._onViewsDeregistered.event,this._onDidChangeContainer=this._register(new L),this.onDidChangeContainer=this._onDidChangeContainer.event,this._onDidChangeViewWelcomeContent=this._register(new L),this.onDidChangeViewWelcomeContent=this._onDidChangeViewWelcomeContent.event,this._viewContainers=[],this._views=new Map,this._viewWelcomeContents=new lI}registerViews(e,t){this.registerViews2([{views:e,viewContainer:t}])}registerViews2(e){e.forEach(({views:t,viewContainer:i})=>this.addViews(t,i)),this._onViewsRegistered.fire(e)}deregisterViews(e,t){const i=this.removeViews(e,t);i.length&&this._onViewsDeregistered.fire({views:i,viewContainer:t})}moveViews(e,t){for(const i of this._views.keys())if(i!==t){const r=this.removeViews(e,i);r.length&&(this.addViews(r,t),this._onDidChangeContainer.fire({views:r,from:i,to:t}))}}getViews(e){return this._views.get(e)||[]}getView(e){for(const t of this._viewContainers){const i=(this._views.get(t)||[]).filter(r=>r.id===e)[0];if(i)return i}return null}getViewContainer(e){for(const t of this._viewContainers)if((this._views.get(t)||[]).filter(r=>r.id===e)[0])return t;return null}registerViewWelcomeContent(e,t){return this._viewWelcomeContents.add(e,t),this._onDidChangeViewWelcomeContent.fire(e),Se(()=>{this._viewWelcomeContents.delete(e,t),this._onDidChangeViewWelcomeContent.fire(e)})}registerViewWelcomeContent2(e,t){const i=new Map;for(const[r,s]of t)this._viewWelcomeContents.add(e,s),i.set(r,Se(()=>{this._viewWelcomeContents.delete(e,s),this._onDidChangeViewWelcomeContent.fire(e)}));return this._onDidChangeViewWelcomeContent.fire(e),i}getViewWelcomeContent(e){const t=[];return this._viewWelcomeContents.forEach(e,i=>t.push(i)),t.sort(eM)}addViews(e,t){let i=this._views.get(t);i||(i=[],this._views.set(t,i),this._viewContainers.push(t));for(const r of e){if(this.getView(r.id)!==null)throw new Error(h(3996,"A view with id '{0}' is already registered",r.id));i.push(r)}}removeViews(e,t){const i=this._views.get(t);if(!i)return[];const r=[],s=[];for(const o of i)e.includes(o)?r.push(o):s.push(o);return r.length&&(s.length?this._views.set(t,s):(this._views.delete(t),this._viewContainers.splice(this._viewContainers.indexOf(t),1))),r}}Cn.add(E1.ViewsRegistry,new tM);var zk;(function(n){n[n.Default=0]="Default",n[n.Expand=1]="Expand"})(zk||(zk={}));var qk;(function(n){n[n.None=0]="None",n[n.Collapsed=1]="Collapsed",n[n.Expanded=2]="Expanded"})(qk||(qk={}));class es extends Error{constructor(e){super(h(3997,"No tree view with id '{0}' registered.",e)),this.name="NoTreeViewError"}static is(e){return!!e&&e.name==="NoTreeViewError"}}class nM{constructor(){this._dragOperations=new Map}removeDragOperationTransfer(e){if(e&&this._dragOperations.has(e)){const t=this._dragOperations.get(e);return this._dragOperations.delete(e),t}}addDragOperationTransfer(e,t){this._dragOperations.set(e,t)}}function jk(n,e){if(Ze(n))return{label:n};if(n&&typeof n=="object"&&typeof n.label=="string"){let t;return Array.isArray(n.highlights)&&(t=n.highlights.filter(i=>i.length===2&&typeof i[0]=="number"&&typeof i[1]=="number"),t=t.length?t:void 0),{label:n.label,highlights:t}}}class iM extends Te{constructor(e,t,i){super(),this._proxy=e,this.commands=t,this.logService=i,this.treeViews=new Map,this.treeDragAndDropService=new nM;function r(s){return s&&s.$treeViewId&&(s.$treeItemHandle||s.$selectedTreeItems||s.$focusedTreeItem)}t.registerArgumentProcessor({processArgument:s=>r(s)?this.convertArgument(s):Array.isArray(s)&&s.length>0?s.map(o=>r(o)?this.convertArgument(o):o):s})}registerTreeDataProvider(e,t,i){const r=this.createTreeView(e,{treeDataProvider:t},i);return{dispose:()=>r.dispose()}}createTreeView(e,t,i){var f,p,w,v;if(!t||!t.treeDataProvider)throw new Error("Options with treeDataProvider is mandatory");const r=((f=t.dragAndDropController)==null?void 0:f.dropMimeTypes)??[],s=((p=t.dragAndDropController)==null?void 0:p.dragMimeTypes)??[],o=!!((w=t.dragAndDropController)!=null&&w.handleDrag),a=!!((v=t.dragAndDropController)!=null&&v.handleDrop),l=this.createExtHostTreeView(e,t,i),c={showCollapseAll:!!t.showCollapseAll,canSelectMany:!!t.canSelectMany,dropMimeTypes:r,dragMimeTypes:s,hasHandleDrag:o,hasHandleDrop:a,manuallyManageCheckboxes:!!t.manageCheckboxStateManually},u=this._proxy.$registerTreeViewDataProvider(e,c),d={get onDidCollapseElement(){return l.onDidCollapseElement},get onDidExpandElement(){return l.onDidExpandElement},get selection(){return l.selectedElements},get onDidChangeSelection(){return l.onDidChangeSelection},get activeItem(){return $(i,"treeViewActiveItem"),l.focusedElement},get onDidChangeActiveItem(){return $(i,"treeViewActiveItem"),l.onDidChangeActiveItem},get visible(){return l.visible},get onDidChangeVisibility(){return l.onDidChangeVisibility},get onDidChangeCheckboxState(){return l.onDidChangeCheckboxState},get message(){return l.message},set message(m){kl(m)&&$(i,"treeViewMarkdownMessage"),l.message=m},get title(){return l.title},set title(m){l.title=m},get description(){return l.description},set description(m){l.description=m},get badge(){return l.badge},set badge(m){m!==void 0&&Jw.isViewBadge(m)?l.badge={value:Math.floor(Math.abs(m.value)),tooltip:m.tooltip}:m===void 0&&(l.badge=void 0)},reveal:(m,x)=>l.reveal(m,x),dispose:async()=>{await u,this.treeViews.delete(e),l.dispose()}};return this._register(d),d}async $getChildren(e,t){const i=this.treeViews.get(e);if(!i)return Promise.reject(new es(e));if(!t){const s=await i.getChildren();return s?[[0,...s]]:void 0}const r=[];for(let s=0;s<t.length;s++){const o=t[s],a=await i.getChildren(o);a&&r.push([s,...a])}return r}async $handleDrop(e,t,i,r,s,o,a,l){const c=this.treeViews.get(e);if(!c)return Promise.reject(new es(e));const u=Hu.toDataTransfer(i,async d=>(await this._proxy.$resolveDropFileData(e,t,d)).buffer);return a===e&&l&&await this.addAdditionalTransferItems(u,c,l,s,o),c.onDrop(u,r,s)}async addAdditionalTransferItems(e,t,i,r,s){var a;const o=this.treeDragAndDropService.removeDragOperationTransfer(s);if(o)(a=await o)==null||a.forEach((l,c)=>{l&&e.set(c,l)});else if(s&&t.handleDrag){const l=t.handleDrag(i,e,r);this.treeDragAndDropService.addDragOperationTransfer(s,l),await l}return e}async $handleDrag(e,t,i,r){const s=this.treeViews.get(e);if(!s)return Promise.reject(new es(e));const o=await this.addAdditionalTransferItems(new Su,s,t,r,i);if(!(!o||r.isCancellationRequested))return Hu.from(o)}async $hasResolve(e){const t=this.treeViews.get(e);if(!t)throw new es(e);return t.hasResolve}$resolve(e,t,i){const r=this.treeViews.get(e);if(!r)throw new es(e);return r.resolveTreeItem(t,i)}$setExpanded(e,t,i){const r=this.treeViews.get(e);if(!r)throw new es(e);r.setExpanded(t,i)}$setSelectionAndFocus(e,t,i){const r=this.treeViews.get(e);if(!r)throw new es(e);r.setSelectionAndFocus(t,i)}$setVisible(e,t){const i=this.treeViews.get(e);if(!i){if(!t)return;throw new es(e)}i.setVisible(t)}$changeCheckboxState(e,t){const i=this.treeViews.get(e);if(!i)throw new es(e);i.setCheckboxState(t)}createExtHostTreeView(e,t,i){const r=this._register(new Yy(e,t,this._proxy,this.commands.converter,this.logService,i));return this.treeViews.set(e,r),r}convertArgument(e){const t=this.treeViews.get(e.$treeViewId);return t&&"$treeItemHandle"in e?t.getExtensionElement(e.$treeItemHandle):t&&"$focusedTreeItem"in e&&e.$focusedTreeItem?t.focusedElement:null}}const xc=class xc extends Te{get visible(){return this._visible}get selectedElements(){return this._selectedHandles.map(e=>this.getExtensionElement(e)).filter(e=>!Yt(e))}get focusedElement(){return this._focusedHandle?this.getExtensionElement(this._focusedHandle):void 0}constructor(e,t,i,r,s,o){if(super(),this.viewId=e,this.proxy=i,this.commands=r,this.logService=s,this.extension=o,this.roots=void 0,this.elements=new Map,this.nodes=new Map,this._visible=!1,this._selectedHandles=[],this._focusedHandle=void 0,this._onDidExpandElement=this._register(new L),this.onDidExpandElement=this._onDidExpandElement.event,this._onDidCollapseElement=this._register(new L),this.onDidCollapseElement=this._onDidCollapseElement.event,this._onDidChangeSelection=this._register(new L),this.onDidChangeSelection=this._onDidChangeSelection.event,this._onDidChangeActiveItem=this._register(new L),this.onDidChangeActiveItem=this._onDidChangeActiveItem.event,this._onDidChangeVisibility=this._register(new L),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._onDidChangeCheckboxState=this._register(new L),this.onDidChangeCheckboxState=this._onDidChangeCheckboxState.event,this._onDidChangeData=this._register(new L),this.refreshPromise=Promise.resolve(),this.refreshQueue=Promise.resolve(),this._message="",this._title="",this._refreshCancellationSource=new Bt,o.contributes&&o.contributes.views)for(const u in o.contributes.views)for(const d of o.contributes.views[u])d.id===e&&(this._title=d.name);this.dataProvider=t.treeDataProvider,this.dndController=t.dragAndDropController,this.dataProvider.onDidChangeTreeData&&this._register(this.dataProvider.onDidChangeTreeData(u=>{Array.isArray(u)&&u.length===0||this._onDidChangeData.fire({message:!1,element:u})}));let a,l;const c=Ht.debounce(this._onDidChangeData.event,(u,d)=>(u||(u={message:!1,elements:[]}),d.element!==!1&&(a||(a=new Promise(f=>l=f),this.refreshPromise=this.refreshPromise.then(()=>a)),Array.isArray(d.element)?u.elements.push(...d.element):u.elements.push(d.element)),d.message&&(u.message=!0),u),200,!0);this._register(c(({message:u,elements:d})=>{d.length&&(this.refreshQueue=this.refreshQueue.then(()=>{const f=l;return a=null,this.refresh(d).then(()=>f())})),u&&this.proxy.$setMessage(this.viewId,Le.fromStrict(this._message)??"")}))}async getChildren(e){const t=e?this.getExtensionElement(e):void 0;if(e&&!t)return this.logService.error(`No tree item with id '${e}' found.`),Promise.resolve([]);let i=this.getChildrenNodes(e);return i||(i=await this.fetchChildrenNodes(t)),i?i.map(r=>r.item):void 0}getExtensionElement(e){return this.elements.get(e)}reveal(e,t){t=t||{select:!0,focus:!1};const i=Yt(t.select)?!0:t.select,r=Yt(t.focus)?!1:t.focus,s=Yt(t.expand)?!1:t.expand;return typeof this.dataProvider.getParent!="function"?Promise.reject(new Error("Required registered TreeDataProvider to implement 'getParent' method to access 'reveal' method")):e?this.refreshPromise.then(()=>this.resolveUnknownParentChain(e)).then(o=>this.resolveTreeNode(e,o[o.length-1]).then(a=>this.proxy.$reveal(this.viewId,{item:a.item,parentChain:o.map(l=>l.item)},{select:i,focus:r,expand:s})),o=>this.logService.error(o)):this.proxy.$reveal(this.viewId,void 0,{select:i,focus:r,expand:s})}get message(){return this._message}set message(e){this._message=e,this._onDidChangeData.fire({message:!0,element:!1})}get title(){return this._title}set title(e){this._title=e,this.proxy.$setTitle(this.viewId,e,this._description)}get description(){return this._description}set description(e){this._description=e,this.proxy.$setTitle(this.viewId,this._title,e)}get badge(){return this._badge}set badge(e){var t,i;((t=this._badge)==null?void 0:t.value)===(e==null?void 0:e.value)&&((i=this._badge)==null?void 0:i.tooltip)===(e==null?void 0:e.tooltip)||(this._badge=Bm.from(e),this.proxy.$setBadge(this.viewId,e))}setExpanded(e,t){const i=this.getExtensionElement(e);i&&(t?this._onDidExpandElement.fire(Object.freeze({element:i})):this._onDidCollapseElement.fire(Object.freeze({element:i})))}setSelectionAndFocus(e,t){const i=!$r(this._selectedHandles,e);this._selectedHandles=e;const r=this._focusedHandle!==t;this._focusedHandle=t,i&&this._onDidChangeSelection.fire(Object.freeze({selection:this.selectedElements})),r&&this._onDidChangeActiveItem.fire(Object.freeze({activeItem:this.focusedElement}))}setVisible(e){e!==this._visible&&(this._visible=e,this._onDidChangeVisibility.fire(Object.freeze({visible:this._visible})))}async setCheckboxState(e){const t=(await Promise.all(e.map(async i=>{const r=this.getExtensionElement(i.treeItemHandle);return r?{extensionItem:r,treeItem:await this.dataProvider.getTreeItem(r),newState:i.newState?Tr.Checked:Tr.Unchecked}:Promise.resolve(void 0)}))).filter(i=>i!==void 0);t.forEach(i=>{i.treeItem.checkboxState=i.newState?Tr.Checked:Tr.Unchecked}),this._onDidChangeCheckboxState.fire({items:t.map(i=>[i.extensionItem,i.newState])})}async handleDrag(e,t,i){var s;const r=[];for(const o of e){const a=this.getExtensionElement(o);a&&r.push(a)}if(!(!((s=this.dndController)!=null&&s.handleDrag)||r.length===0))return await this.dndController.handleDrag(r,t,i),t}get hasHandleDrag(){var e;return!!((e=this.dndController)!=null&&e.handleDrag)}async onDrop(e,t,i){var s;const r=t?this.getExtensionElement(t):void 0;if(!(!r&&t||!((s=this.dndController)!=null&&s.handleDrop)))return Nn(()=>{var o;return(o=this.dndController)!=null&&o.handleDrop?this.dndController.handleDrop(r,e,i):void 0})}get hasResolve(){return!!this.dataProvider.resolveTreeItem}async resolveTreeItem(e,t){if(!this.dataProvider.resolveTreeItem)return;const i=this.elements.get(e);if(i){const r=this.nodes.get(i);if(r){const s=await this.dataProvider.resolveTreeItem(r.extensionItem,i,t)??r.extensionItem;return this.validateTreeItem(s),r.item.tooltip=this.getTooltip(s.tooltip),r.item.command=this.getCommand(r.disposableStore,s.command),r.item}}}resolveUnknownParentChain(e){return this.resolveParent(e).then(t=>t?this.resolveUnknownParentChain(t).then(i=>this.resolveTreeNode(t,i[i.length-1]).then(r=>(i.push(r),i))):Promise.resolve([]))}resolveParent(e){const t=this.nodes.get(e);return t?Promise.resolve(t.parent?this.elements.get(t.parent.item.handle):void 0):Nn(()=>this.dataProvider.getParent(e))}resolveTreeNode(e,t){const i=this.nodes.get(e);return i?Promise.resolve(i):Nn(()=>this.dataProvider.getTreeItem(e)).then(r=>this.createHandle(e,r,t,!0)).then(r=>this.getChildren(t?t.item.handle:void 0).then(()=>{const s=this.getExtensionElement(r);if(s){const o=this.nodes.get(s);if(o)return Promise.resolve(o)}throw new Error(`Cannot resolve tree item for element ${r} from extension ${this.extension.identifier.value}`)}))}getChildrenNodes(e){if(e){let t;if(typeof e=="string"){const i=this.getExtensionElement(e);t=i?this.nodes.get(i):void 0}else t=e;return t&&t.children||void 0}return this.roots}async fetchChildrenNodes(e){this.clearChildren(e);const t=new Bt(this._refreshCancellationSource.token);try{const i=e?this.nodes.get(e):void 0,r=await this.dataProvider.getChildren(e);if(t.token.isCancellationRequested)return;const s=sn(r||[]),o=await Promise.all(sn(s).map(l=>this.dataProvider.getTreeItem(l)));if(t.token.isCancellationRequested)return;const a=o.map((l,c)=>l?this.createAndRegisterTreeNode(s[c],l,i):null);return sn(a)}finally{t.dispose()}}refresh(e){if(e.some(i=>!i))return this._refreshCancellationSource.dispose(!0),this._refreshCancellationSource=new Bt,this.clearAll(),this.proxy.$refresh(this.viewId);{const i=this.getHandlesToRefresh(e);if(i.length)return this.refreshHandles(i)}return Promise.resolve(void 0)}getHandlesToRefresh(e){const t=new Set,i=e.map(s=>this.nodes.get(s));for(const s of i)if(s&&!t.has(s.item.handle)){let o=s;for(;o&&o.parent&&i.findIndex(a=>o&&o.parent&&a&&a.item.handle===o.parent.item.handle)===-1;){const a=this.elements.get(o.parent.item.handle);o=a?this.nodes.get(a):void 0}o&&!o.parent&&t.add(s.item.handle)}const r=[];return t.forEach(s=>{const o=this.elements.get(s);if(o){const a=this.nodes.get(o);a&&(!a.parent||!t.has(a.parent.item.handle))&&r.push(s)}}),r}refreshHandles(e){const t={};return Promise.all(e.map(i=>this.refreshNode(i).then(r=>{r&&(t[i]=r.item)}))).then(()=>Object.keys(t).length?this.proxy.$refresh(this.viewId,t):void 0)}refreshNode(e){const t=this.getExtensionElement(e);if(t){const i=this.nodes.get(t);if(i)return this.clearChildren(t),Nn(()=>this.dataProvider.getTreeItem(t)).then(r=>{if(r){const s=this.createTreeNode(t,r,i.parent);return this.updateNodeCache(t,s,i,i.parent),i.dispose(),s}return null})}return Promise.resolve(null)}createAndRegisterTreeNode(e,t,i){const r=this.createTreeNode(e,t,i);if(t.id&&this.elements.has(r.item.handle))throw new Error(h(2552,"Element with id {0} is already registered",t.id));return this.addNodeToCache(e,r),this.addNodeToParentCache(r,i),r}getTooltip(e){return pi.isMarkdownString(e)?Le.from(e):e}getCommand(e,t){return t?{...this.commands.toInternal(t,e),originalId:t.command}:void 0}getCheckbox(e){if(e.checkboxState===void 0)return;let t,i,r;return typeof e.checkboxState=="number"?t=e.checkboxState:(t=e.checkboxState.state,i=e.checkboxState.tooltip,r=e.checkboxState.accessibilityInformation),{isChecked:t===Tr.Checked,tooltip:i,accessibilityInformation:r}}validateTreeItem(e){if(!nm.isTreeItem(e,this.extension))throw new Error(`Extension ${this.extension.identifier.value} has provided an invalid tree item.`)}createTreeNode(e,t,i){this.validateTreeItem(t);const r=this._register(new Ie),s=this.createHandle(e,t,i),o=this.getLightIconPath(t);return{item:{handle:s,parentHandle:i?i.item.handle:void 0,label:jk(t.label),description:t.description,resourceUri:t.resourceUri,tooltip:this.getTooltip(t.tooltip),command:this.getCommand(r,t.command),contextValue:t.contextValue,icon:o,iconDark:this.getDarkIconPath(t)||o,themeIcon:this.getThemeIcon(t),collapsibleState:Yt(t.collapsibleState)?Qa.None:t.collapsibleState,accessibilityInformation:t.accessibilityInformation,checkbox:this.getCheckbox(t)},extensionItem:t,parent:i,children:void 0,disposableStore:r,dispose(){r.dispose()}}}getThemeIcon(e){return e.iconPath instanceof qn?e.iconPath:void 0}createHandle(e,{id:t,label:i,resourceUri:r},s,o){if(t)return`${xc.ID_HANDLE_PREFIX}/${t}`;const a=jk(i),l=s?s.item.handle:xc.LABEL_HANDLE_PREFIX;let c=a?a.label:r?Lo(r):"";c=c.indexOf("/")!==-1?c.replace("/","//"):c;const u=this.nodes.has(e)?this.nodes.get(e).item.handle:void 0,d=this.getChildrenNodes(s)||[];let f,p=0;do{if(f=`${l}/${p}:${c}`,o||!this.elements.has(f)||u===f)break;p++}while(p<=d.length);return f}getLightIconPath(e){if(e.iconPath&&!(e.iconPath instanceof qn))return typeof e.iconPath=="string"||y.isUri(e.iconPath)?this.getIconPath(e.iconPath):this.getIconPath(e.iconPath.light)}getDarkIconPath(e){if(e.iconPath&&!(e.iconPath instanceof qn)&&e.iconPath.dark)return this.getIconPath(e.iconPath.dark)}getIconPath(e){return y.isUri(e)?e:y.file(e)}addNodeToCache(e,t){this.elements.set(t.item.handle,e),this.nodes.set(e,t)}updateNodeCache(e,t,i,r){this.elements.delete(t.item.handle),this.nodes.delete(e),t.item.handle!==i.item.handle&&this.elements.delete(i.item.handle),this.addNodeToCache(e,t);const s=this.getChildrenNodes(r)||[],o=s.filter(a=>a.item.handle===i.item.handle)[0];o&&s.splice(s.indexOf(o),1,t)}addNodeToParentCache(e,t){t?(t.children||(t.children=[]),t.children.push(e)):(this.roots||(this.roots=[]),this.roots.push(e))}clearChildren(e){if(e){const t=this.nodes.get(e);if(t){if(t.children)for(const i of t.children){const r=this.elements.get(i.item.handle);r&&this.clear(r)}t.children=void 0}}else this.clearAll()}clear(e){const t=this.nodes.get(e);if(t){if(t.children)for(const i of t.children){const r=this.elements.get(i.item.handle);r&&this.clear(r)}this.nodes.delete(e),this.elements.delete(t.item.handle),t.dispose()}}clearAll(){this.roots=void 0,this.elements.clear(),this.nodes.forEach(e=>e.dispose()),this.nodes.clear()}dispose(){super.dispose(),this._refreshCancellationSource.dispose(),this.clearAll(),this.proxy.$disposeTree(this.viewId)}};xc.LABEL_HANDLE_PREFIX="0",xc.ID_HANDLE_PREFIX="1";let Yy=xc;const t_=class t_{constructor(e){this._openers=new Map,this._proxy=e.getProxy(Z.MainThreadUriOpeners)}registerExternalUriOpener(e,t,i,r){if(this._openers.has(t))throw new Error(`Opener with id '${t}' already registered`);const s=r.schemes.find(o=>!t_.supportedSchemes.has(o));if(s)throw new Error(`Scheme '${s}' is not supported. Only http and https are currently supported.`);return this._openers.set(t,i),this._proxy.$registerUriOpener(t,r.schemes,e,r.label),Se(()=>{this._openers.delete(t),this._proxy.$unregisterUriOpener(t)})}async $canOpenUri(e,t,i){const r=this._openers.get(e);if(!r)throw new Error(`Unknown opener with id: ${e}`);const s=y.revive(t);return r.canOpenExternalUri(s,i)}async $openUri(e,t,i){const r=this._openers.get(e);if(!r)throw new Error(`Unknown opener id: '${e}'`);return r.openExternalUri(y.revive(t.resolvedUri),{sourceUri:y.revive(t.sourceUri)},i)}};t_.supportedSchemes=new Set([oe.http,oe.https]);let Zy=t_;const n_=class n_{constructor(e){this.handles=new Dl,this.handlers=new Map,this._proxy=e.getProxy(Z.MainThreadUrls)}registerUriHandler(e,t){const i=e.identifier;if(this.handles.has(i))throw new Error(`Protocol handler already registered for extension ${i}`);const r=n_.HandlePool++;return this.handles.add(i),this.handlers.set(r,t),this._proxy.$registerUriHandler(r,i,e.displayName||e.name),Se(()=>{this.handles.delete(i),this.handlers.delete(r),this._proxy.$unregisterUriHandler(r)})}$handleExternalUri(e,t){const i=this.handlers.get(e);if(!i)return Promise.resolve(void 0);try{i.handleUri(y.revive(t))}catch(r){Fn(r)}return Promise.resolve(void 0)}async createAppUri(e){return y.revive(await this._proxy.$createAppUri(e))}};n_.HandlePool=0;let Ky=n_;var lo,co,Ff,Zc,Mf,Oa,Kc,bs,eu,tu,uo,nu,iu;class rM extends Te{constructor(t,i,r,s){super();ge(this,lo);ge(this,co);ge(this,Ff);ge(this,Zc);ge(this,Mf);ge(this,Oa);ge(this,Kc);ge(this,bs);ge(this,eu);ge(this,tu);ge(this,uo);ge(this,nu);ge(this,iu);ie(this,bs,void 0),ie(this,eu,!0),ie(this,uo,!1),ie(this,nu,this._register(new L)),this.onDidDispose=A(this,nu).event,ie(this,iu,this._register(new L)),this.onDidChangeViewState=A(this,iu).event,ie(this,lo,t),ie(this,co,i),ie(this,Zc,r),ie(this,Ff,s.viewType),ie(this,Mf,s.panelOptions),ie(this,bs,s.viewColumn),ie(this,Oa,s.title),ie(this,tu,s.active)}dispose(){A(this,uo)||(ie(this,uo,!0),A(this,nu).fire(),A(this,co).$disposeWebview(A(this,lo)),A(this,Zc).dispose(),super.dispose())}get webview(){return this.assertNotDisposed(),A(this,Zc)}get viewType(){return this.assertNotDisposed(),A(this,Ff)}get title(){return this.assertNotDisposed(),A(this,Oa)}set title(t){this.assertNotDisposed(),A(this,Oa)!==t&&(ie(this,Oa,t),A(this,co).$setTitle(A(this,lo),t))}get iconPath(){return this.assertNotDisposed(),A(this,Kc)}set iconPath(t){this.assertNotDisposed(),A(this,Kc)!==t&&(ie(this,Kc,t),A(this,co).$setIconPath(A(this,lo),y.isUri(t)?{light:t,dark:t}:t))}get options(){return A(this,Mf)}get viewColumn(){if(this.assertNotDisposed(),!(typeof A(this,bs)=="number"&&A(this,bs)<0))return A(this,bs)}get active(){return this.assertNotDisposed(),A(this,tu)}get visible(){return this.assertNotDisposed(),A(this,eu)}_updateViewState(t){A(this,uo)||(this.active!==t.active||this.visible!==t.visible||this.viewColumn!==t.viewColumn)&&(ie(this,tu,t.active),ie(this,eu,t.visible),ie(this,bs,t.viewColumn),A(this,iu).fire({webviewPanel:this}))}reveal(t,i){this.assertNotDisposed(),A(this,co).$reveal(A(this,lo),{viewColumn:typeof t>"u"?void 0:nn.from(t),preserveFocus:!!i})}assertNotDisposed(){if(A(this,uo))throw new Error("Webview is disposed")}}lo=new WeakMap,co=new WeakMap,Ff=new WeakMap,Zc=new WeakMap,Mf=new WeakMap,Oa=new WeakMap,Kc=new WeakMap,bs=new WeakMap,eu=new WeakMap,tu=new WeakMap,uo=new WeakMap,nu=new WeakMap,iu=new WeakMap;class g2 extends Te{static newHandle(){return Mn()}constructor(e,t,i){super(),this.webviews=t,this.workspace=i,this._webviewPanels=new Map,this._serializers=new Map,this._proxy=e.getProxy(Z.MainThreadWebviewPanels)}dispose(){super.dispose(),this._webviewPanels.forEach(e=>e.dispose()),this._webviewPanels.clear()}createWebviewPanel(e,t,i,r,s={}){const o=typeof r=="object"?r.viewColumn:r,a={viewColumn:nn.from(o),preserveFocus:typeof r=="object"&&!!r.preserveFocus},l=qu(e),c=g2.newHandle();this._proxy.$createWebviewPanel(_1(e),c,t,{title:i,panelOptions:sM(s),webviewOptions:c7(e,this.workspace,s),serializeBuffersForPostMessage:l},a);const u=this.webviews.createNewWebview(c,s,e);return this.createNewWebviewPanel(c,t,i,o,s,u,!0)}$onDidChangeWebviewPanelViewStates(e){const t=Object.keys(e);t.sort((i,r)=>{const s=e[i],o=e[r];return s.active?1:o.active?-1:+s.visible-+o.visible});for(const i of t){const r=this.getWebviewPanel(i);if(!r)continue;const s=e[i];r._updateViewState({active:s.active,visible:s.visible,viewColumn:nn.to(s.position)})}}async $onDidDisposeWebviewPanel(e){const t=this.getWebviewPanel(e);t==null||t.dispose(),this._webviewPanels.delete(e),this.webviews.deleteWebview(e)}registerWebviewPanelSerializer(e,t,i){if(this._serializers.has(t))throw new Error(`Serializer for '${t}' already registered`);return this._serializers.set(t,{serializer:i,extension:e}),this._proxy.$registerSerializer(t,{serializeBuffersForPostMessage:qu(e)}),new je(()=>{this._serializers.delete(t),this._proxy.$unregisterSerializer(t)})}async $deserializeWebviewPanel(e,t,i,r){const s=this._serializers.get(t);if(!s)throw new Error(`No serializer found for '${t}'`);const{serializer:o,extension:a}=s,l=this.webviews.createNewWebview(e,i.webviewOptions,a),c=this.createNewWebviewPanel(e,t,i.title,r,i.panelOptions,l,i.active);await o.deserializeWebviewPanel(c,i.state)}createNewWebviewPanel(e,t,i,r,s,o,a){const l=new rM(e,this._proxy,o,{viewType:t,title:i,viewColumn:r,panelOptions:s,active:a});return this._webviewPanels.set(e,l),l}getWebviewPanel(e){return this._webviewPanels.get(e)}}function sM(n){return{enableFindWidget:n.enableFindWidget,retainContextWhenHidden:n.retainContextWhenHidden}}var ho,fo,$f,ru,po,Fa,Ma,su,$a,ou,au;class oM extends Te{constructor(t,i,r,s,o,a){super();ge(this,ho);ge(this,fo);ge(this,$f);ge(this,ru);ge(this,po);ge(this,Fa);ge(this,Ma);ge(this,su);ge(this,$a);ge(this,ou);ge(this,au);ie(this,po,!1),ie(this,ou,this._register(new L)),this.onDidChangeVisibility=A(this,ou).event,ie(this,au,this._register(new L)),this.onDidDispose=A(this,au).event,ie(this,$f,r),ie(this,Ma,s),ie(this,ho,t),ie(this,fo,i),ie(this,ru,o),ie(this,Fa,a)}dispose(){A(this,po)||(ie(this,po,!0),A(this,au).fire(),A(this,ru).dispose(),super.dispose())}get title(){return this.assertNotDisposed(),A(this,Ma)}set title(t){this.assertNotDisposed(),A(this,Ma)!==t&&(ie(this,Ma,t),A(this,fo).$setWebviewViewTitle(A(this,ho),t))}get description(){return this.assertNotDisposed(),A(this,su)}set description(t){this.assertNotDisposed(),A(this,su)!==t&&(ie(this,su,t),A(this,fo).$setWebviewViewDescription(A(this,ho),t))}get visible(){return A(this,Fa)}get webview(){return A(this,ru)}get viewType(){return A(this,$f)}_setVisible(t){t===A(this,Fa)||A(this,po)||(ie(this,Fa,t),A(this,ou).fire())}get badge(){return this.assertNotDisposed(),A(this,$a)}set badge(t){var i,r;this.assertNotDisposed(),!((t==null?void 0:t.value)===((i=A(this,$a))==null?void 0:i.value)&&(t==null?void 0:t.tooltip)===((r=A(this,$a))==null?void 0:r.tooltip))&&(ie(this,$a,Bm.from(t)),A(this,fo).$setWebviewViewBadge(A(this,ho),t))}show(t){this.assertNotDisposed(),A(this,fo).$show(A(this,ho),!!t)}assertNotDisposed(){if(A(this,po))throw new Error("Webview is disposed")}}ho=new WeakMap,fo=new WeakMap,$f=new WeakMap,ru=new WeakMap,po=new WeakMap,Fa=new WeakMap,Ma=new WeakMap,su=new WeakMap,$a=new WeakMap,ou=new WeakMap,au=new WeakMap;class aM{constructor(e,t){this._extHostWebview=t,this._viewProviders=new Map,this._webviewViews=new Map,this._proxy=e.getProxy(Z.MainThreadWebviewViews)}registerWebviewViewProvider(e,t,i,r){if(this._viewProviders.has(t))throw new Error(`View provider for '${t}' already registered`);return this._viewProviders.set(t,{provider:i,extension:e}),this._proxy.$registerWebviewViewProvider(_1(e),t,{retainContextWhenHidden:r==null?void 0:r.retainContextWhenHidden,serializeBuffersForPostMessage:qu(e)}),new je(()=>{this._viewProviders.delete(t),this._proxy.$unregisterWebviewViewProvider(t)})}async $resolveWebviewView(e,t,i,r,s){const o=this._viewProviders.get(t);if(!o)throw new Error(`No view provider found for '${t}'`);const{provider:a,extension:l}=o,c=this._extHostWebview.createNewWebview(e,{},l),u=new oM(e,this._proxy,t,i,c,!0);this._webviewViews.set(e,u),await a.resolveWebviewView(u,{state:r},s)}async $onDidChangeWebviewViewVisibility(e,t){this.getWebviewView(e)._setVisible(t)}async $disposeWebviewView(e){const t=this.getWebviewView(e);this._webviewViews.delete(e),t.dispose(),this._extHostWebview.deleteWebview(e)}getWebviewView(e){const t=this._webviewViews.get(e);if(!t)throw new Error("No webview found");return t}}function lM(n){const e=n.get(In),t=n.get(Ju),i=n.get(S_),r=n.get(No),s=n.get(Hs),o=n.get(k_),a=n.get(Bs),l=n.get(s_),c=n.get(tt),u=n.get(Qx),d=n.get(Jx),f=n.get(Qu),p=n.get(ct),w=n.get(Xx),v=n.get(C_),m=n.get(e7),x=n.get(t2),k=n.get(Kf),D=n.get(i2),B=n.get(Zx),T=n.get(Kx),z=n.get(dy);c.set(de.ExtHostFileSystemInfo,t),c.set(de.ExtHostLogLevelServiceShape,f),c.set(de.ExtHostWorkspace,s),c.set(de.ExtHostConfiguration,a),c.set(de.ExtHostExtensionService,r),c.set(de.ExtHostStorage,u),c.set(de.ExtHostTunnelService,w),c.set(de.ExtHostWindow,m),c.set(de.ExtHostSecretState,x),c.set(de.ExtHostTelemetry,o),c.set(de.ExtHostEditorTabs,k),c.set(de.ExtHostManagedSockets,D),c.set(de.ExtHostAuthentication,B),c.set(de.ExtHostChatProvider,T);const K=c.set(de.ExtHostDecorations,n.get(q5)),Ee=c.set(de.ExtHostDocumentsAndEditors,n.get(ed)),Q=c.set(de.ExtHostCommands,n.get(Ll)),le=c.set(de.ExtHostTerminalService,n.get(Ku)),Ye=c.set(de.ExtHostTerminalShellIntegration,n.get(t7)),Ce=c.set(de.ExtHostDebugService,n.get(X5)),Y=c.set(de.ExtHostSearch,n.get(K5)),j=c.set(de.ExtHostTask,n.get(j5)),ae=c.set(de.ExtHostOutputService,n.get(z5)),ne=c.set(de.ExtHostLocalization,n.get(n2)),he=c.set(de.ExtHostUrls,new Ky(c)),_e=c.set(de.ExtHostDocuments,new aO(c,Ee)),Ve=c.set(de.ExtHostDocumentContentProviders,new yy(c,Ee,p)),yt=c.set(de.ExtHostDocumentSaveParticipant,new oO(p,_e,c.getProxy(Z.MainThreadBulkEdits))),$e=c.set(de.ExtHostNotebook,new My(c,Q,Ee,_e,i,Y,p)),Gt=c.set(de.ExtHostNotebookDocuments,new SF($e)),Un=c.set(de.ExtHostNotebookEditors,new $y(p,$e)),xt=c.set(de.ExtHostNotebookKernels,new Uy(c,e,$e,Q,p)),mi=c.set(de.ExtHostNotebookRenderers,new CF(c,$e)),_n=c.set(de.ExtHostNotebookDocumentSaveParticipant,new EF(p,$e,c.getProxy(Z.MainThreadBulkEdits))),Wt=c.set(de.ExtHostEditors,new jF(c,Ee)),Ri=c.set(de.ExtHostTreeViews,new iM(c.getProxy(Z.MainThreadTreeViews),Q,p)),R_=c.set(de.ExtHostEditorInsets,new $N(c.getProxy(Z.MainThreadEditorInsets),Wt,e.remote)),Ws=c.set(de.ExtHostDiagnostics,new by(c,p,t,Ee)),Oo=c.set(de.ExtHostLanguages,new tF(c,_e,Q.converter,l)),qe=c.set(de.ExtHostLanguageFeatures,new xy(c,l,_e,Q,Ws,p,v,o)),jr=c.set(de.ExtHostCodeMapper,new wy(c)),Gr=c.set(de.ExtHostFileSystem,new b1(c,qe)),Qr=c.set(de.ExtHostFileSystemEventService,new _O(c,p,Ee)),Fo=c.set(de.ExtHostQuickOpen,LF(c,s,Q)),it=c.set(de.ExtHostSCM,new jy(c,Q,_e,p)),L_=c.set(de.ExtHostQuickDiff,new Vy(c,l)),N_=c.set(de.ExtHostShare,new Gy(c,l)),ep=c.set(de.ExtHostComments,UN(c,Q,_e)),Jr=c.set(de.ExtHostProgress,new AF(c.getProxy(Z.MainThreadProgress))),O_=c.set(de.ExtHostLabelService,new wO(c)),tp=c.set(de.ExtHostTheming,new Xy(c)),F_=c.set(de.ExtHostTimeline,new GF(c,Q)),nd=c.set(de.ExtHostWebviews,new JN(c,e.remote,s,p,v)),_i=c.set(de.ExtHostWebviewPanels,new g2(c,nd,s)),M_=c.set(de.ExtHostCustomEditors,new tO(c,_e,d,nd,_i)),$_=c.set(de.ExtHostWebviewViews,new aM(c,nd)),Vs=c.set(de.ExtHostTesting,n.get(P_)),U_=c.set(de.ExtHostUriOpeners,new Zy(c)),Nl=c.set(de.ExtHostProfileContentHandlers,new PF(c));c.set(de.ExtHostInteractive,new vO(c,$e,Ee,Q,p));const Xr=c.set(de.ExtHostLanguageModelTools,new eF(c,T)),_r=c.set(de.ExtHostChatAgents2,new _y(c,p,Q,_e,T,Ws,Xr)),id=c.set(de.ExtHostAiRelatedInformation,new EN(c)),rd=c.set(de.ExtHostAiEmbeddingVector,new cO(c)),Ol=c.set(de.ExtHostStatusBar,new qF(c,Q.converter)),Fl=c.set(de.ExtHostSpeech,new Qy(c)),vn=c.set(de.ExtHostEmbeddings,new lO(c));c.set(de.ExtHostMcp,n.get(dy));const Mo=Object.values(de);c.assertRegistered(Mo);const Mt=new my(c,Ee),H_=new ON(c),sd=new Ry(c,p),wn=new sO(c),B_=new LN(c);return CN.register(Q),function(I,vr,od){function ue(_){return(b,S,ce)=>{const He=_(at=>{try{b.call(S,at)}catch(Li){iI(new zI(I.identifier,Li,"FAILED to handle event"))}});return ce==null||ce.push(He),He}}const st=function(){let _=!I.isUnderDevelopment;function b(){_||(p.info(`Extension '${I.identifier.value}' uses a document selector without scheme. Learn more about this: https://go.microsoft.com/fwlink/?linkid=872305`),_=!0)}return function S(ce){if(Array.isArray(ce))ce.forEach(S);else if(typeof ce=="string")b();else{const He=ce;typeof He.scheme>"u"&&b(),typeof He.exclusive=="boolean"&&$(I,"documentFiltersExclusive")}return ce}}(),W_={getSession(_,b,S){return(typeof(S==null?void 0:S.forceNewSession)=="object"&&S.forceNewSession.learnMore||typeof(S==null?void 0:S.createIfNone)=="object"&&S.createIfNone.learnMore)&&$(I,"authLearnMore"),B.getSession(I,_,b,S)},getAccounts(_){return B.getAccounts(_)},async hasSession(_,b){return $(I,"authSession"),!!await B.getSession(I,_,b,{silent:!0})},get onDidChangeSessions(){return ue(B.getExtensionScopedSessionsEvent(I.identifier.value))},registerAuthenticationProvider(_,b,S,ce){return B.registerAuthenticationProvider(_,b,S,ce)}},V_={registerCommand(_,b,S){return Q.registerCommand(!0,_,b,S,void 0,I)},registerTextEditorCommand(_,b,S){return Q.registerCommand(!0,_,(...ce)=>{const He=Wt.getActiveTextEditor();if(!He){p.warn("Cannot execute "+_+" because there is no active text editor.");return}return He.edit(at=>{b.apply(S,[He,at,...ce])}).then(at=>{at||p.warn("Edits from command "+_+" were not applied.")},at=>{p.warn("An error occurred while running command "+_,at)})},void 0,void 0,I)},registerDiffInformationCommand:(_,b,S)=>($(I,"diffCommand"),Q.registerCommand(!0,_,async(...ce)=>{const He=Ee.activeEditor(!0);if(!He){p.warn("Cannot execute "+_+" because there is no active text editor.");return}const at=await Wt.getDiffInformation(He.id);b.apply(S,[at,...ce])},void 0,void 0,I)),executeCommand(_,...b){return Q.executeCommand(_,...b)},getCommands(_=!1){return Q.getCommands(_)}},z_={get machineId(){return e.telemetryInfo.machineId},get sessionId(){return e.telemetryInfo.sessionId},get language(){return e.environment.appLanguage},get appName(){return e.environment.appName},get appRoot(){var _;return((_=e.environment.appRoot)==null?void 0:_.fsPath)??""},get appHost(){return e.environment.appHost},get uriScheme(){return e.environment.appUriScheme},get clipboard(){return H_.value},get shell(){return le.getDefaultShell(!1)},get onDidChangeShell(){return ue(le.onDidChangeShell)},get isTelemetryEnabled(){return o.getTelemetryConfiguration()},get onDidChangeTelemetryEnabled(){return ue(o.onDidChangeTelemetryEnabled)},get telemetryConfiguration(){return $(I,"telemetry"),o.getTelemetryDetails()},get onDidChangeTelemetryConfiguration(){return $(I,"telemetry"),ue(o.onDidChangeTelemetryConfiguration)},get isNewAppInstall(){return T5(e.telemetryInfo.firstSessionDate)},createTelemetryLogger(_,b){return P5.validateSender(_),o.instantiateLogger(I,_,b)},openExternal(_,b){return m.openUri(_,{allowTunneling:!!e.remote.authority,allowContributedOpeners:b==null?void 0:b.allowContributedOpeners})},async asExternalUri(_){if(_.scheme===e.environment.appUriScheme)return he.createAppUri(_);try{return await m.asExternalUri(_,{allowTunneling:!!e.remote.authority})}catch(b){if(Gv(_,oe.http)||Gv(_,oe.https))return _;throw b}},get remoteName(){return wx(e.remote.authority)},get remoteAuthority(){return $(I,"resolvers"),e.remote.authority},get uiKind(){return e.uiKind},get logLevel(){return p.getLevel()},get onDidChangeLogLevel(){return ue(p.onDidChangeLogLevel)},get appQuality(){return $(I,"resolvers"),e.quality},get appCommit(){return $(I,"resolvers"),e.commit}},Ml={createTestController(_,b,S){return Vs.createTestController(I,_,b,S)},createTestObserver(){return $(I,"testObserver"),Vs.createTestObserver()},runTests(_){return $(I,"testObserver"),Vs.runTests(_)},registerTestFollowupProvider(_){return $(I,"testObserver"),Vs.registerTestFollowupProvider(_)},get onDidChangeTestResults(){return $(I,"testObserver"),ue(Vs.onResultsChanged)},get testResults(){return $(I,"testObserver"),Vs.results}},$l=e.remote.isRemote?Ja.Workspace:Ja.UI,q_={getExtension(_,b){vt(I,"extensionsAny")||(b=!1);const S=vr.mine.getExtensionDescription(_);if(S)return new Id(r,I.identifier,S,$l,!1);if(b){const ce=vr.all.getExtensionDescription(_);if(ce)return new Id(r,I.identifier,ce,$l,!0)}},get all(){const _=[];for(const b of vr.mine.getAllExtensionDescriptions())_.push(new Id(r,I.identifier,b,$l,!1));return _},get allAcrossExtensionHosts(){$(I,"extensionsAny");const _=new Dl(vr.mine.getAllExtensionDescriptions().map(S=>S.identifier)),b=[];for(const S of vr.all.getAllExtensionDescriptions()){const ce=!_.has(S.identifier);b.push(new Id(r,I.identifier,S,$l,ce))}return b},get onDidChange(){return vt(I,"extensionsAny")?ue(Ht.any(vr.mine.onDidChange,vr.all.onDidChange)):ue(vr.mine.onDidChange)}},j_={createDiagnosticCollection(_){return Ws.createDiagnosticCollection(I.identifier,_)},get onDidChangeDiagnostics(){return ue(Ws.onDidChangeDiagnostics)},getDiagnostics:_=>Ws.getDiagnostics(_),getLanguages(){return Oo.getLanguages()},setTextDocumentLanguage(_,b){return Oo.changeLanguage(_.uri,b)},match(_,b){var He;const S=qb.from(_);let ce;return i7(S)&&(ce=(He=$e.notebookDocuments.find(at=>at.apiNotebook.getCells().find(Li=>Li.document===b)))==null?void 0:He.apiNotebook),n7(S,b.uri,b.languageId,!0,ce==null?void 0:ce.uri,ce==null?void 0:ce.notebookType)},registerCodeActionsProvider(_,b,S){return qe.registerCodeActionProvider(I,st(_),b,S)},registerDocumentPasteEditProvider(_,b,S){return qe.registerDocumentPasteEditProvider(I,st(_),b,S)},registerCodeLensProvider(_,b){return qe.registerCodeLensProvider(I,st(_),b)},registerDefinitionProvider(_,b){return qe.registerDefinitionProvider(I,st(_),b)},registerDeclarationProvider(_,b){return qe.registerDeclarationProvider(I,st(_),b)},registerImplementationProvider(_,b){return qe.registerImplementationProvider(I,st(_),b)},registerTypeDefinitionProvider(_,b){return qe.registerTypeDefinitionProvider(I,st(_),b)},registerHoverProvider(_,b){return qe.registerHoverProvider(I,st(_),b,I.identifier)},registerEvaluatableExpressionProvider(_,b){return qe.registerEvaluatableExpressionProvider(I,st(_),b,I.identifier)},registerInlineValuesProvider(_,b){return qe.registerInlineValuesProvider(I,st(_),b,I.identifier)},registerDocumentHighlightProvider(_,b){return qe.registerDocumentHighlightProvider(I,st(_),b)},registerMultiDocumentHighlightProvider(_,b){return qe.registerMultiDocumentHighlightProvider(I,st(_),b)},registerLinkedEditingRangeProvider(_,b){return qe.registerLinkedEditingRangeProvider(I,st(_),b)},registerReferenceProvider(_,b){return qe.registerReferenceProvider(I,st(_),b)},registerRenameProvider(_,b){return qe.registerRenameProvider(I,st(_),b)},registerNewSymbolNamesProvider(_,b){return $(I,"newSymbolNamesProvider"),qe.registerNewSymbolNamesProvider(I,st(_),b)},registerDocumentSymbolProvider(_,b,S){return qe.registerDocumentSymbolProvider(I,st(_),b,S)},registerWorkspaceSymbolProvider(_){return qe.registerWorkspaceSymbolProvider(I,_)},registerDocumentFormattingEditProvider(_,b){return qe.registerDocumentFormattingEditProvider(I,st(_),b)},registerDocumentRangeFormattingEditProvider(_,b){return qe.registerDocumentRangeFormattingEditProvider(I,st(_),b)},registerOnTypeFormattingEditProvider(_,b,S,...ce){return qe.registerOnTypeFormattingEditProvider(I,st(_),b,[S].concat(ce))},registerDocumentSemanticTokensProvider(_,b,S){return qe.registerDocumentSemanticTokensProvider(I,st(_),b,S)},registerDocumentRangeSemanticTokensProvider(_,b,S){return qe.registerDocumentRangeSemanticTokensProvider(I,st(_),b,S)},registerSignatureHelpProvider(_,b,S,...ce){return typeof S=="object"?qe.registerSignatureHelpProvider(I,st(_),b,S):qe.registerSignatureHelpProvider(I,st(_),b,typeof S>"u"?[]:[S,...ce])},registerCompletionItemProvider(_,b,...S){return qe.registerCompletionItemProvider(I,st(_),b,S)},registerInlineCompletionItemProvider(_,b,S){return b.handleDidShowCompletionItem&&$(I,"inlineCompletionsAdditions"),b.handleDidPartiallyAcceptCompletionItem&&$(I,"inlineCompletionsAdditions"),S&&$(I,"inlineCompletionsAdditions"),qe.registerInlineCompletionsProvider(I,st(_),b,S)},registerInlineEditProvider(_,b){return $(I,"inlineEdit"),qe.registerInlineEditProvider(I,st(_),b)},registerDocumentLinkProvider(_,b){return qe.registerDocumentLinkProvider(I,st(_),b)},registerColorProvider(_,b){return qe.registerColorProvider(I,st(_),b)},registerFoldingRangeProvider(_,b){return qe.registerFoldingRangeProvider(I,st(_),b)},registerSelectionRangeProvider(_,b){return qe.registerSelectionRangeProvider(I,_,b)},registerCallHierarchyProvider(_,b){return qe.registerCallHierarchyProvider(I,_,b)},registerTypeHierarchyProvider(_,b){return qe.registerTypeHierarchyProvider(I,_,b)},setLanguageConfiguration:(_,b)=>qe.setLanguageConfiguration(I,_,b),getTokenInformationAtPosition(_,b){return $(I,"tokenInformation"),Oo.tokenAtPosition(_,b)},registerInlayHintsProvider(_,b){return qe.registerInlayHintsProvider(I,_,b)},createLanguageStatusItem(_,b){return Oo.createLanguageStatusItem(I,_,b)},registerDocumentDropEditProvider(_,b,S){return qe.registerDocumentOnDropEditProvider(I,_,b,S)}},G_={get activeTextEditor(){return Wt.getActiveTextEditor()},get visibleTextEditors(){return Wt.getVisibleTextEditors()},get activeTerminal(){return le.activeTerminal},get terminals(){return le.terminals},async showTextDocument(_,b,S){y.isUri(_)&&_.scheme===oe.vscodeRemote&&!_.authority&&v.report("workspace.showTextDocument",I,"A URI of 'vscode-remote' scheme requires an authority.");const ce=await(y.isUri(_)?Promise.resolve(np.openTextDocument(_)):Promise.resolve(_));return Wt.showTextDocument(ce,b,S)},createTextEditorDecorationType(_){return Wt.createTextEditorDecorationType(I,_)},onDidChangeActiveTextEditor(_,b,S){return ue(Wt.onDidChangeActiveTextEditor)(_,b,S)},onDidChangeVisibleTextEditors(_,b,S){return ue(Wt.onDidChangeVisibleTextEditors)(_,b,S)},onDidChangeTextEditorSelection(_,b,S){return ue(Wt.onDidChangeTextEditorSelection)(_,b,S)},onDidChangeTextEditorOptions(_,b,S){return ue(Wt.onDidChangeTextEditorOptions)(_,b,S)},onDidChangeTextEditorVisibleRanges(_,b,S){return ue(Wt.onDidChangeTextEditorVisibleRanges)(_,b,S)},onDidChangeTextEditorViewColumn(_,b,S){return ue(Wt.onDidChangeTextEditorViewColumn)(_,b,S)},onDidChangeTextEditorDiffInformation(_,b,S){return $(I,"textEditorDiffInformation"),ue(Wt.onDidChangeTextEditorDiffInformation)(_,b,S)},onDidCloseTerminal(_,b,S){return ue(le.onDidCloseTerminal)(_,b,S)},onDidOpenTerminal(_,b,S){return ue(le.onDidOpenTerminal)(_,b,S)},onDidChangeActiveTerminal(_,b,S){return ue(le.onDidChangeActiveTerminal)(_,b,S)},onDidChangeTerminalDimensions(_,b,S){return $(I,"terminalDimensions"),ue(le.onDidChangeTerminalDimensions)(_,b,S)},onDidChangeTerminalState(_,b,S){return ue(le.onDidChangeTerminalState)(_,b,S)},onDidWriteTerminalData(_,b,S){return $(I,"terminalDataWriteEvent"),ue(le.onDidWriteTerminalData)(_,b,S)},onDidExecuteTerminalCommand(_,b,S){return $(I,"terminalExecuteCommandEvent"),ue(le.onDidExecuteTerminalCommand)(_,b,S)},onDidChangeTerminalShellIntegration(_,b,S){return ue(Ye.onDidChangeTerminalShellIntegration)(_,b,S)},onDidStartTerminalShellExecution(_,b,S){return ue(Ye.onDidStartTerminalShellExecution)(_,b,S)},onDidEndTerminalShellExecution(_,b,S){return ue(Ye.onDidEndTerminalShellExecution)(_,b,S)},get state(){return m.getState()},onDidChangeWindowState(_,b,S){return ue(m.onDidChangeWindowState)(_,b,S)},showInformationMessage(_,...b){return sd.showMessage(I,qt.Info,_,b[0],b.slice(1))},showWarningMessage(_,...b){return sd.showMessage(I,qt.Warning,_,b[0],b.slice(1))},showErrorMessage(_,...b){return sd.showMessage(I,qt.Error,_,b[0],b.slice(1))},showQuickPick(_,b,S){return Fo.showQuickPick(I,_,b,S)},showWorkspaceFolderPick(_){return Fo.showWorkspaceFolderPick(_)},showInputBox(_,b){return Fo.showInput(_,b)},showOpenDialog(_){return wn.showOpenDialog(_)},showSaveDialog(_){return wn.showSaveDialog(_)},createStatusBarItem(_,b,S){let ce,He,at;return typeof _=="string"?(ce=_,He=b,at=S):(He=_,at=b),Ol.createStatusBarEntry(I,ce,He,at)},setStatusBarMessage(_,b){return Ol.setStatusBarMessage(_,b)},withScmProgress(_){return v.report("window.withScmProgress",I,"Use 'withProgress' instead."),Jr.withProgress(I,{location:Ga.SourceControl},(b,S)=>_({report(ce){}}))},withProgress(_,b){return Jr.withProgress(I,_,b)},createOutputChannel(_,b){return ae.createOutputChannel(_,b,I)},createWebviewPanel(_,b,S,ce){return _i.createWebviewPanel(I,_,b,S,ce)},createWebviewTextEditorInset(_,b,S,ce){return $(I,"editorInsets"),R_.createWebviewEditorInset(_,b,S,ce,I)},createTerminal(_,b,S){return typeof _=="object"?"pty"in _?le.createExtensionTerminal(_):le.createTerminalFromOptions(_):le.createTerminal(_,b,S)},registerTerminalLinkProvider(_){return le.registerLinkProvider(_)},registerTerminalProfileProvider(_,b){return le.registerProfileProvider(I,_,b)},registerTerminalCompletionProvider(_,...b){return $(I,"terminalCompletionProvider"),le.registerTerminalCompletionProvider(I,_,...b)},registerTerminalQuickFixProvider(_,b){return $(I,"terminalQuickFixProvider"),le.registerTerminalQuickFixProvider(_,I.identifier.value,b)},registerTreeDataProvider(_,b){return Ri.registerTreeDataProvider(_,b,I)},createTreeView(_,b){return Ri.createTreeView(_,b,I)},registerWebviewPanelSerializer:(_,b)=>_i.registerWebviewPanelSerializer(I,_,b),registerCustomEditorProvider:(_,b,S={})=>M_.registerCustomEditorProvider(I,_,b,S),registerFileDecorationProvider(_){return K.registerFileDecorationProvider(_,I)},registerUriHandler(_){return he.registerUriHandler(I,_)},createQuickPick(){return Fo.createQuickPick(I)},createInputBox(){return Fo.createInputBox(I)},get activeColorTheme(){return tp.activeColorTheme},onDidChangeActiveColorTheme(_,b,S){return ue(tp.onDidChangeActiveColorTheme)(_,b,S)},registerWebviewViewProvider(_,b,S){return $_.registerWebviewViewProvider(I,_,b,S==null?void 0:S.webviewOptions)},get activeNotebookEditor(){return $e.activeNotebookEditor},onDidChangeActiveNotebookEditor(_,b,S){return ue($e.onDidChangeActiveNotebookEditor)(_,b,S)},get visibleNotebookEditors(){return $e.visibleNotebookEditors},get onDidChangeVisibleNotebookEditors(){return ue($e.onDidChangeVisibleNotebookEditors)},onDidChangeNotebookEditorSelection(_,b,S){return ue(Un.onDidChangeNotebookEditorSelection)(_,b,S)},onDidChangeNotebookEditorVisibleRanges(_,b,S){return ue(Un.onDidChangeNotebookEditorVisibleRanges)(_,b,S)},showNotebookDocument(_,b){return $e.showNotebookDocument(_,b)},registerExternalUriOpener(_,b,S){return $(I,"externalUriOpener"),U_.registerExternalUriOpener(I.identifier,_,b,S)},registerProfileContentHandler(_,b){return $(I,"profileContentHandlers"),Nl.registerProfileContentHandler(I,_,b)},registerQuickDiffProvider(_,b,S,ce){return $(I,"quickDiffProvider"),L_.registerQuickDiffProvider(st(_),b,S,ce)},get tabGroups(){return k.tabGroups},registerShareProvider(_,b){return $(I,"shareProvider"),N_.registerShareProvider(st(_),b)},get nativeHandle(){return $(I,"nativeWindowHandle"),m.nativeHandle},createChatStatusItem:_=>($(I,"chatStatusItem"),B_.createChatStatusItem(I,_))},np={get rootPath(){return v.report("workspace.rootPath",I,"Please use 'workspace.workspaceFolders' instead. More details: https://aka.ms/vscode-eliminating-rootpath"),s.getPath()},set rootPath(_){throw new la("rootPath")},getWorkspaceFolder(_){return s.getWorkspaceFolder(_)},get workspaceFolders(){return s.getWorkspaceFolders()},get name(){return s.name},set name(_){throw new la("name")},get workspaceFile(){return s.workspaceFile},set workspaceFile(_){throw new la("workspaceFile")},updateWorkspaceFolders:(_,b,...S)=>s.updateWorkspaceFolders(I,_,b||0,...S),onDidChangeWorkspaceFolders:function(_,b,S){return ue(s.onDidChangeWorkspace)(_,b,S)},asRelativePath:(_,b)=>s.getRelativePath(_,b),findFiles:(_,b,S,ce)=>s.findFiles(_,b,S,I.identifier,ce),findFiles2:(_,b,S)=>($(I,"findFiles2"),s.findFiles2(_,b,I.identifier,S)),findTextInFiles:(_,b,S,ce)=>{$(I,"findTextInFiles");let He,at;return typeof b=="object"?(He=b,at=S):(He={},at=b,ce=S),s.findTextInFiles(_,He||{},at,I.identifier,ce)},findTextInFiles2:(_,b,S)=>($(I,"findTextInFiles2"),$(I,"textSearchProvider2"),s.findTextInFiles2(_,b,I.identifier,S)),save:_=>s.save(_),saveAs:_=>s.saveAs(_),saveAll:_=>s.saveAll(_),applyEdit(_,b){return Mt.applyWorkspaceEdit(_,I,b)},createFileSystemWatcher:(_,b,S,ce)=>{const He={ignoreCreateEvents:!!b,ignoreChangeEvents:!!S,ignoreDeleteEvents:!!ce};return Qr.createFileSystemWatcher(s,od,I,_,He)},get textDocuments(){return _e.getAllDocumentData().map(_=>_.document)},set textDocuments(_){throw new la("textDocuments")},openTextDocument(_,b){let S;if(b=b??_,typeof(b==null?void 0:b.encoding)=="string"&&$(I,"textDocumentEncoding"),typeof _=="string")S=Promise.resolve(y.file(_));else if(y.isUri(_))S=Promise.resolve(_);else if(!b||typeof b=="object")S=_e.createDocumentData(b);else throw new Error("illegal argument - uriOrFileNameOrOptions");return S.then(ce=>(p.trace(`openTextDocument from ${I.identifier}`),ce.scheme===oe.vscodeRemote&&!ce.authority&&v.report("workspace.openTextDocument",I,"A URI of 'vscode-remote' scheme requires an authority."),_e.ensureDocumentData(ce,b).then(He=>He.document)))},onDidOpenTextDocument:(_,b,S)=>ue(_e.onDidAddDocument)(_,b,S),onDidCloseTextDocument:(_,b,S)=>ue(_e.onDidRemoveDocument)(_,b,S),onDidChangeTextDocument:(_,b,S)=>ue(_e.onDidChangeDocument)(_,b,S),onDidSaveTextDocument:(_,b,S)=>ue(_e.onDidSaveDocument)(_,b,S),onWillSaveTextDocument:(_,b,S)=>ue(yt.getOnWillSaveTextDocumentEvent(I))(_,b,S),get notebookDocuments(){return $e.notebookDocuments.map(_=>_.apiNotebook)},async openNotebookDocument(_,b){let S;if(y.isUri(_))S=_,await $e.openNotebookDocument(_);else if(typeof _=="string")S=y.revive(await $e.createNotebookDocument({viewType:_,content:b}));else throw new Error("Invalid arguments");return $e.getNotebookDocument(S).apiNotebook},onDidSaveNotebookDocument(_,b,S){return ue(Gt.onDidSaveNotebookDocument)(_,b,S)},onDidChangeNotebookDocument(_,b,S){return ue(Gt.onDidChangeNotebookDocument)(_,b,S)},onWillSaveNotebookDocument(_,b,S){return ue(_n.getOnWillSaveNotebookDocumentEvent(I))(_,b,S)},get onDidOpenNotebookDocument(){return ue($e.onDidOpenNotebookDocument)},get onDidCloseNotebookDocument(){return ue($e.onDidCloseNotebookDocument)},registerNotebookSerializer(_,b,S,ce){return $e.registerNotebookSerializer(I,_,b,S,vt(I,"notebookLiveShare")?ce:void 0)},onDidChangeConfiguration:(_,b,S)=>ue(od.onDidChangeConfiguration)(_,b,S),getConfiguration(_,b){return b=arguments.length===1?void 0:b,od.getConfiguration(_,b,I)},registerTextDocumentContentProvider(_,b){return Ve.registerTextDocumentContentProvider(_,b)},registerTaskProvider:(_,b)=>(v.report("window.registerTaskProvider",I,"Use the corresponding function on the 'tasks' namespace instead"),j.registerTaskProvider(I,_,b)),registerFileSystemProvider(_,b,S){return hI(Gr.registerFileSystemProvider(I,_,b,S),i.addFileSystemProvider(_,b,S))},get fs(){return i.value},registerFileSearchProvider:(_,b)=>($(I,"fileSearchProvider"),Y.registerFileSearchProviderOld(_,b)),registerTextSearchProvider:(_,b)=>($(I,"textSearchProvider"),Y.registerTextSearchProviderOld(_,b)),registerAITextSearchProvider:(_,b)=>($(I,"aiTextSearchProvider"),$(I,"textSearchProvider2"),Y.registerAITextSearchProvider(_,b)),registerFileSearchProvider2:(_,b)=>($(I,"fileSearchProvider2"),Y.registerFileSearchProvider(_,b)),registerTextSearchProvider2:(_,b)=>($(I,"textSearchProvider2"),Y.registerTextSearchProvider(_,b)),registerRemoteAuthorityResolver:(_,b)=>($(I,"resolvers"),r.registerRemoteAuthorityResolver(_,b)),registerResourceLabelFormatter:_=>($(I,"resolvers"),O_.$registerResourceLabelFormatter(_)),getRemoteExecServer:_=>($(I,"resolvers"),r.getRemoteExecServer(_)),onDidCreateFiles:(_,b,S)=>ue(Qr.onDidCreateFile)(_,b,S),onDidDeleteFiles:(_,b,S)=>ue(Qr.onDidDeleteFile)(_,b,S),onDidRenameFiles:(_,b,S)=>ue(Qr.onDidRenameFile)(_,b,S),onWillCreateFiles:(_,b,S)=>ue(Qr.getOnWillCreateFileEvent(I))(_,b,S),onWillDeleteFiles:(_,b,S)=>ue(Qr.getOnWillDeleteFileEvent(I))(_,b,S),onWillRenameFiles:(_,b,S)=>ue(Qr.getOnWillRenameFileEvent(I))(_,b,S),openTunnel:_=>($(I,"tunnels"),w.openTunnel(I,_).then(b=>{if(!b)throw new Error("cannot open tunnel");return b})),get tunnels(){return $(I,"tunnels"),w.getTunnels()},onDidChangeTunnels:(_,b,S)=>($(I,"tunnels"),ue(w.onDidChangeTunnels)(_,b,S)),registerPortAttributesProvider:(_,b)=>($(I,"portsAttributes"),w.registerPortsAttributesProvider(_,b)),registerTunnelProvider:(_,b)=>($(I,"tunnelFactory"),w.registerTunnelProvider(_,b)),registerTimelineProvider:(_,b)=>($(I,"timeline"),F_.registerTimelineProvider(_,b,I.identifier,Q.converter)),get isTrusted(){return s.trusted},requestWorkspaceTrust:_=>($(I,"workspaceTrust"),s.requestWorkspaceTrust(_)),onDidGrantWorkspaceTrust:(_,b,S)=>ue(s.onDidGrantWorkspaceTrust)(_,b,S),registerEditSessionIdentityProvider:(_,b)=>($(I,"editSessionIdentityProvider"),s.registerEditSessionIdentityProvider(_,b)),onWillCreateEditSessionIdentity:(_,b,S)=>($(I,"editSessionIdentityProvider"),ue(s.getOnWillCreateEditSessionIdentityEvent(I))(_,b,S)),registerCanonicalUriProvider:(_,b)=>($(I,"canonicalUriProvider"),s.registerCanonicalUriProvider(_,b)),getCanonicalUri:(_,b,S)=>($(I,"canonicalUriProvider"),s.provideCanonicalUri(_,b,S)),decode(_,b,S){return $(I,"textDocumentEncoding"),s.decode(_,b,S)},encode(_,b,S){return $(I,"textDocumentEncoding"),s.encode(_,b,S)}},ad={get inputBox(){return v.report("scm.inputBox",I,"Use 'SourceControl.inputBox' instead"),it.getLastInputBox(I)},createSourceControl(_,b,S){return it.createSourceControl(I,_,b,S)}},Q_={createCommentController(_,b){return ep.createCommentController(I,_,b)}},J_={get activeDebugSession(){return Ce.activeDebugSession},get activeDebugConsole(){return Ce.activeDebugConsole},get breakpoints(){return Ce.breakpoints},get activeStackItem(){return Ce.activeStackItem},registerDebugVisualizationProvider(_,b){return $(I,"debugVisualization"),Ce.registerDebugVisualizationProvider(I,_,b)},registerDebugVisualizationTreeProvider(_,b){return $(I,"debugVisualization"),Ce.registerDebugVisualizationTree(I,_,b)},onDidStartDebugSession(_,b,S){return ue(Ce.onDidStartDebugSession)(_,b,S)},onDidTerminateDebugSession(_,b,S){return ue(Ce.onDidTerminateDebugSession)(_,b,S)},onDidChangeActiveDebugSession(_,b,S){return ue(Ce.onDidChangeActiveDebugSession)(_,b,S)},onDidReceiveDebugSessionCustomEvent(_,b,S){return ue(Ce.onDidReceiveDebugSessionCustomEvent)(_,b,S)},onDidChangeBreakpoints(_,b,S){return ue(Ce.onDidChangeBreakpoints)(_,b,S)},onDidChangeActiveStackItem(_,b,S){return ue(Ce.onDidChangeActiveStackItem)(_,b,S)},registerDebugConfigurationProvider(_,b,S){return Ce.registerDebugConfigurationProvider(_,b,S||Ig.Initial)},registerDebugAdapterDescriptorFactory(_,b){return Ce.registerDebugAdapterDescriptorFactory(I,_,b)},registerDebugAdapterTrackerFactory(_,b){return Ce.registerDebugAdapterTrackerFactory(_,b)},startDebugging(_,b,S){return!S||typeof S=="object"&&"configuration"in S?Ce.startDebugging(_,b,{parentSession:S}):Ce.startDebugging(_,b,S||{})},stopDebugging(_){return Ce.stopDebugging(_)},addBreakpoints(_){return Ce.addBreakpoints(_)},removeBreakpoints(_){return Ce.removeBreakpoints(_)},asDebugSourceUri(_,b){return Ce.asDebugSourceUri(_,b)}},X_={registerTaskProvider:(_,b)=>j.registerTaskProvider(I,_,b),fetchTasks:_=>j.fetchTasks(_),executeTask:_=>j.executeTask(I,_),get taskExecutions(){return j.taskExecutions},onDidStartTask:(_,b,S)=>ue(j.onDidStartTask)(_,b,S),onDidEndTask:(_,b,S)=>ue(j.onDidEndTask)(_,b,S),onDidStartTaskProcess:(_,b,S)=>ue(j.onDidStartTaskProcess)(_,b,S),onDidEndTaskProcess:(_,b,S)=>ue(j.onDidEndTaskProcess)(_,b,S),onDidStartTaskProblemMatchers:(_,b,S)=>($(I,"taskProblemMatcherStatus"),ue(j.onDidStartTaskProblemMatchers)(_,b,S)),onDidEndTaskProblemMatchers:(_,b,S)=>($(I,"taskProblemMatcherStatus"),ue(j.onDidEndTaskProblemMatchers)(_,b,S))},E={createNotebookController(_,b,S,ce,He){return xt.createNotebookController(I,_,b,S,ce,vt(I,"notebookMessaging")?He:void 0)},registerNotebookCellStatusBarItemProvider:(_,b)=>$e.registerNotebookCellStatusBarItemProvider(I,_,b),createRendererMessaging(_){return mi.createRendererMessaging(I,_)},createNotebookControllerDetectionTask(_){return $(I,"notebookKernelSource"),xt.createNotebookControllerDetectionTask(I,_)},registerKernelSourceActionProvider(_,b){return $(I,"notebookKernelSource"),xt.registerKernelSourceActionProvider(I,_,b)},onDidChangeNotebookCellExecutionState(_,b,S){return $(I,"notebookCellExecutionState"),ue(xt.onDidChangeNotebookCellExecutionState)(_,b,S)}},N={t(..._){if(typeof _[0]=="string"){const b=_.shift(),S=!_||typeof _[0]!="object"?_:_[0];return ne.getMessage(I.identifier.value,{message:b,args:S})}return ne.getMessage(I.identifier.value,_[0])},get bundle(){return ne.getBundle(I.identifier.value)},get uri(){return ne.getBundleUri(I.identifier.value)}},U={transferActiveChat(_){return $(I,"interactive"),_r.transferActiveChat(_)}},re={getRelatedInformation(_,b){return $(I,"aiRelatedInformation"),id.getRelatedInformation(I,_,b)},registerRelatedInformationProvider(_,b){return $(I,"aiRelatedInformation"),id.registerRelatedInformationProvider(I,_,b)},registerEmbeddingVectorProvider(_,b){return $(I,"aiRelatedInformation"),rd.registerEmbeddingVectorProvider(I,_,b)}},J={registerChatResponseProvider(_,b,S){return $(I,"chatProvider"),T.registerLanguageModel(I,_,b,S)},registerMappedEditsProvider(_,b){return $(I,"mappedEditsProvider"),{dispose(){}}},registerMappedEditsProvider2(_){return $(I,"mappedEditsProvider"),jr.registerMappedEditsProvider(I,_)},createChatParticipant(_,b){return _r.createChatAgent(I,_,b)},createDynamicChatParticipant(_,b,S){return $(I,"chatParticipantPrivate"),_r.createDynamicChatAgent(I,_,b,S)},registerChatParticipantDetectionProvider(_){return $(I,"chatParticipantPrivate"),_r.registerChatParticipantDetectionProvider(I,_)},registerRelatedFilesProvider(_,b){return $(I,"chatEditing"),_r.registerRelatedFilesProvider(I,_,b)},onDidDisposeChatSession:(_,b,S)=>($(I,"chatParticipantPrivate"),ue(_r.onDidDisposeChatSession)(_,b,S))},ye={selectChatModels:_=>T.selectLanguageModels(I,_??{}),onDidChangeChatModels:(_,b,S)=>T.onDidChangeProviders(_,b,S),registerChatModelProvider:(_,b,S)=>($(I,"chatProvider"),T.registerLanguageModel(I,_,b,S)),get embeddingModels(){return $(I,"embeddings"),vn.embeddingsModels},onDidChangeEmbeddingModels:(_,b,S)=>($(I,"embeddings"),vn.onDidChange(_,b,S)),registerEmbeddingsProvider(_,b){return $(I,"embeddings"),vn.registerEmbeddingsProvider(I,_,b)},async computeEmbeddings(_,b,S){return $(I,"embeddings"),vn.computeEmbeddings(_,b,S)},registerTool(_,b){return Xr.registerTool(I,_,b)},invokeTool(_,b,S){return Xr.invokeTool(I,_,b,S)},get tools(){return Xr.getTools(I)},fileIsIgnored(_,b){return T.fileIsIgnored(I,_,b)},registerIgnoredFileProvider(_){return T.registerIgnoredFileProvider(I,_)},registerMcpConfigurationProvider(_,b){return $(I,"mcpConfigurationProvider"),z.registerMcpConfigurationProvider(I,_,b)}},Ue={registerSpeechProvider(_,b){return $(I,"speech"),Fl.registerProvider(I.identifier,_,b)}};return{version:e.version,ai:re,authentication:W_,commands:V_,comments:Q_,chat:J,debug:J_,env:z_,extensions:q_,interactive:U,l10n:N,languages:j_,lm:ye,notebooks:E,scm:ad,speech:Ue,tasks:X_,tests:Ml,window:G_,workspace:np,Breakpoint:Du,TerminalOutputAnchor:Aw,ChatResultFeedbackKind:Qh,ChatVariableLevel:_b,ChatCompletionItem:y3,ChatReferenceDiagnostic:d5,CallHierarchyIncomingCall:HC,CallHierarchyItem:Mx,CallHierarchyOutgoingCall:BC,CancellationError:qr,CancellationTokenSource:Bt,CandidatePortSource:zv,CodeAction:Ch,CodeActionKind:Tt,CodeActionTriggerKind:Ih,CodeLens:Gg,Color:xu,ColorInformation:Kg,ColorPresentation:em,ColorThemeKind:so,CommentMode:tb,CommentState:nb,CommentThreadCollapsibleState:Hh,CommentThreadState:Bh,CommentThreadApplicability:Wh,CommentThreadFocus:Vh,CompletionItem:Xg,CompletionItemKind:xe,CompletionItemTag:Th,CompletionList:wu,CompletionTriggerKind:Pc,ConfigurationTarget:Rc,CustomExecution:$x,DebugAdapterExecutable:om,DebugAdapterInlineImplementation:Mh,DebugAdapterNamedPipeServer:am,DebugAdapterServer:Fh,DebugConfigurationProviderTriggerKind:Ig,DebugConsoleMode:hm,DebugVisualization:p3,DecorationRangeBehavior:pa,Diagnostic:Wg,DiagnosticRelatedInformation:xh,DiagnosticSeverity:Sn,DiagnosticTag:ha,Disposable:je,DocumentHighlight:qg,DocumentHighlightKind:Eh,MultiDocumentHighlight:jg,DocumentLink:Zg,DocumentSymbol:kh,EndOfLine:cr,EnvironmentVariableMutatorType:Ic,EvaluatableExpression:lm,InlineValueText:cm,InlineValueVariableLookup:um,InlineValueEvaluatableExpression:dm,InlineCompletionTriggerKind:$h,EventEmitter:L,ExtensionKind:Ja,ExtensionMode:Fc,ExternalUriOpenerPriority:hb,FileChangeType:Nc,FileDecoration:sb,FileDecoration2:sb,FileSystemError:en,FileType:Wa,FilePermission:gu,FoldingRange:eb,FoldingRangeKind:fs,FunctionBreakpoint:ma,InlineCompletionItem:$w,InlineCompletionList:Uw,Hover:Vg,VerboseHover:zg,HoverVerbosityAction:Rw,IndentAction:fy,Location:Ti,MarkdownString:pi,OverviewRulerLane:dw,ParameterInformation:Lw,PortAutoForwardAction:pb,Position:We,ProcessExecution:Eu,ProgressLocation:Ga,QuickInputButtonLocation:rb,QuickInputButtons:zh,Range:Oe,RelativePattern:Lc,Selection:$s,SelectionRange:Ph,SemanticTokens:ku,SemanticTokensBuilder:Ux,SemanticTokensEdit:jC,SemanticTokensEdits:Fp,SemanticTokensLegend:ib,ShellExecution:wl,ShellQuoting:Qw,SignatureHelp:Ow,SignatureHelpTriggerKind:Fw,SignatureInformation:Nw,SnippetString:vl,SourceBreakpoint:ga,StandardTokenType:vo,StatusBarAlignment:_o,SymbolInformation:Dh,SymbolKind:ft,SymbolTag:Sh,Task:tm,TaskEventKind:jw,TaskGroup:Nh,TaskPanelKind:Gw,TaskRevealKind:qw,TaskScope:Po,TerminalLink:n3,TerminalQuickFixTerminalCommand:r3,TerminalQuickFixOpener:i3,TerminalLocation:Vw,TerminalProfile:s3,TerminalExitReason:Bw,TerminalShellExecutionCommandLineConfidence:Lh,TerminalCompletionItem:o3,TerminalCompletionItemKind:zw,TerminalCompletionList:a3,TerminalShellType:Ww,TextDocumentSaveReason:Tc,TextEdit:Co,SnippetTextEdit:ja,TextEditorCursorStyle:or,TextEditorChangeKind:Ac,TextEditorLineNumbersStyle:Ki,TextEditorRevealType:Yg,TextEditorSelectionChangeKind:bu,SyntaxTokenType:yu,TextDocumentChangeReason:Rh,ThemeColor:Oh,ThemeIcon:qn,TreeItem:nm,TreeItemCheckboxState:Tr,TreeItemCollapsibleState:Qa,TypeHierarchyItem:Hx,UIKind:dh,Uri:y,ViewColumn:Ah,WorkspaceEdit:_l,DocumentPasteTriggerKind:Yw,DocumentDropEdit:Xw,DocumentDropOrPasteEditKind:zr,DocumentPasteEdit:u3,InlayHint:Jg,InlayHintLabelPart:Qg,InlayHintKind:Mw,RemoteAuthorityResolverError:Pr,ResolvedAuthority:e3,ManagedResolvedAuthority:Op,SourceControlInputBoxValidationType:Hw,ExtensionRuntime:vm,TimelineItem:ub,NotebookRange:Ss,NotebookCellKind:_a,NotebookCellExecutionState:Iu,NotebookCellData:g_,NotebookData:GC,NotebookRendererScript:JC,NotebookCellStatusBarAlignment:gm,NotebookEditorRevealType:mm,NotebookCellOutput:pm,NotebookCellOutputItem:QC,CellErrorStackFrame:g3,NotebookCellStatusBarItem:m3,NotebookControllerAffinity:cb,NotebookControllerAffinity2:_m,NotebookEdit:Bg,NotebookKernelSourceAction:_3,NotebookVariablesRequestKind:jh,PortAttributes:w3,LinkedEditingRanges:v3,TestResultState:db,TestRunRequest:wm,TestMessage:bm,TestMessageStackFrame:b3,TestTag:Gh,TestRunProfileKind:Mc,TextSearchCompleteMessageType:i1,DataTransfer:Su,DataTransferItem:im,TestCoverageCount:Mp,FileCoverage:Cu,StatementCoverage:YC,BranchCoverage:ZC,DeclarationCoverage:KC,WorkspaceTrustState:fb,LanguageStatusSeverity:Cc,QuickPickItemKind:qh,InputBoxValidationSeverity:Oc,TabInputText:Bx,TabInputTextDiff:ym,TabInputTextMerge:e5,TabInputCustom:Wx,TabInputNotebook:Vx,TabInputNotebookDiff:zx,TabInputWebview:t5,TabInputTerminal:n5,TabInputInteractiveWindow:i5,TabInputChat:r5,TabInputTextMultiDiff:s5,TelemetryTrustedValue:Rx,LogLevel:Xe,EditSessionIdentityMatch:py,InteractiveSessionVoteDirection:gb,ChatCopyKind:mb,ChatEditingSessionActionOutcome:va,InteractiveEditorResponseFeedbackKind:vb,DebugStackFrame:zC,DebugThread:qC,RelatedInformationType:kb,SpeechToTextStatus:Ib,TextToSpeechStatus:Cb,PartialAcceptTriggerKind:fa,KeywordRecognitionStatus:Pb,ChatResponseMarkdownPart:m_,ChatResponseFileTreePart:__,ChatResponseAnchorPart:Xh,ChatResponseProgressPart:qx,ChatResponseProgressPart2:Up,ChatResponseReferencePart:Xa,ChatResponseReferencePart2:Xa,ChatResponseCodeCitationPart:Em,ChatResponseCodeblockUriPart:w_,ChatResponseWarningPart:Yh,ChatResponseTextEditPart:Zh,ChatResponseNotebookEditPart:Sm,ChatResponseMarkdownWithVulnerabilitiesPart:Jh,ChatResponseCommandButtonPart:v_,ChatResponseConfirmationPart:xm,ChatResponseMovePart:b_,ChatResponseReferencePartStatusKind:wb,ChatRequestTurn:o5,ChatResponseTurn:a5,ChatLocation:yi,ChatRequestEditorData:l5,ChatRequestNotebookData:c5,ChatReferenceBinaryData:u5,LanguageModelChatMessageRole:ui,LanguageModelChatMessage:h5,LanguageModelChatMessage2:f5,LanguageModelToolResultPart:Kh,LanguageModelTextPart:jt,LanguageModelToolCallPart:bl,LanguageModelError:nr,LanguageModelToolResult:y_,LanguageModelDataPart:Eb,ChatImageMimeType:Sb,ExtendedLanguageModelToolResult:E3,PreparedTerminalToolInvocation:x3,LanguageModelChatToolMode:Db,LanguageModelPromptTsxPart:To,NewSymbolName:h3,NewSymbolNameTag:Kw,NewSymbolNameTriggerKind:Uh,InlineEdit:S3,InlineEditTriggerKind:ef,ExcludeSettingOptions:ps,TextSearchContext2:jx,TextSearchMatch2:wo,TextSearchCompleteMessageTypeNew:i1,ChatErrorLevel:bb,McpSSEServerDefinition:k3,McpStdioServerDefinition:D3}}}var Qp;let ex=class{constructor(e,t,i,r,s,o,a){this._apiFactory=e,this._extensionRegistry=t,this._instaService=i,this._extHostConfiguration=r,this._extHostExtensionService=s,this._initData=o,this._logService=a,this._factories=new Map,this._alternatives=[]}async install(){this._installInterceptor(),ti("code/extHost/willWaitForConfig");const e=await this._extHostConfiguration.getConfigProvider();ti("code/extHost/didWaitForConfig");const t=await this._extHostExtensionService.getExtensionPathIndex();this.register(new cM(this._apiFactory,t,this._extensionRegistry,e,this._logService)),this.register(this._instaService.createInstance(tx)),this._initData.remote.isRemote&&this.register(this._instaService.createInstance(nx,t,this._initData.environment.appUriScheme))}register(e){if("nodeModuleName"in e)if(Array.isArray(e.nodeModuleName))for(const t of e.nodeModuleName)this._factories.set(t,e);else this._factories.set(e.nodeModuleName,e);typeof e.alternativeModuleName=="function"&&this._alternatives.push(t=>e.alternativeModuleName(t))}};ex=V([F(2,zf),F(3,Bs),F(4,No),F(5,In),F(6,ct)],ex);var ul;let tx=(ul=class{constructor(e){if(e.environment.appRoot&&Qp.aliased.size){const t=hl(this.forceForwardSlashes(e.environment.appRoot.fsPath)),i="[a-z0-9_.-]",r=`@${i}+\\/${i}+|${i}+`,s="node_modules|node_modules\\.asar(?:\\.unpacked)?";this.re=new RegExp(`^(${t}/${s}\\/)(${r})(.*)$`,"i")}}alternativeModuleName(e){if(!this.re)return;const t=this.re.exec(this.forceForwardSlashes(e));if(!t)return;const[,i,r,s]=t,o=Qp.aliased.get(r);if(o!==void 0)return console.warn(`${r} as been renamed to ${o}, please update your imports`),i+o+s}forceForwardSlashes(e){return e.replace(/\\/g,"/")}},Qp=ul,ul.aliased=new Map([["vscode-ripgrep","@vscode/ripgrep"],["vscode-windows-registry","@vscode/windows-registry"]]),ul);tx=Qp=V([F(0,In)],tx);class cM{constructor(e,t,i,r,s){this._apiFactory=e,this._extensionPaths=t,this._extensionRegistry=i,this._configProvider=r,this._logService=s,this.nodeModuleName="vscode",this._extApiImpl=new Ms}load(e,t){const i=this._extensionPaths.findSubstr(t);if(i){let r=this._extApiImpl.get(i.identifier);return r||(r=this._apiFactory(i,this._extensionRegistry,this._configProvider),this._extApiImpl.set(i.identifier,r)),r}if(!this._defaultApiImpl){let r="";this._extensionPaths.forEach((s,o)=>r+=`	${o} -> ${s.identifier.value}
`),this._logService.warn(`Could not identify extension for 'vscode' require call from ${t}. These are the extension path mappings: 
${r}`),this._defaultApiImpl=this._apiFactory(GA,this._extensionRegistry,this._configProvider)}return this._defaultApiImpl}}let nx=class{constructor(e,t,i){this._extensionPaths=e,this._appUriScheme=t,this.nodeModuleName=["open","opn"],this._mainThreadTelemetry=i.getProxy(Z.MainThreadTelemetry);const r=i.getProxy(Z.MainThreadWindow);this._impl=(s,o)=>{const a=y.parse(s);return o?this.callOriginal(s,o):a.scheme==="http"||a.scheme==="https"?r.$openUri(a,s,{allowTunneling:!0}):a.scheme==="mailto"||a.scheme===this._appUriScheme?r.$openUri(a,s,{}):this.callOriginal(s,o)}}load(e,t,i){const r=this._extensionPaths.findSubstr(t);return r&&(this._extensionId=r.identifier.value,this.sendShimmingTelemetry()),this._original=i(e),this._impl}callOriginal(e,t){return this.sendNoForwardTelemetry(),this._original(e,t)}sendShimmingTelemetry(){this._extensionId&&this._mainThreadTelemetry.$publicLog2("shimming.open",{extension:this._extensionId})}sendNoForwardTelemetry(){this._extensionId&&this._mainThreadTelemetry.$publicLog2("shimming.open.call.noForward",{extension:this._extensionId})}};nx=V([F(2,tt)],nx);let ix=class{constructor(e,t){this._mainThreadConsole=e.getProxy(Z.MainThreadConsole),this._includeStack=t.consoleForward.includeStack,this._logNative=t.consoleForward.logNative,this._wrapConsoleMethod("info","log"),this._wrapConsoleMethod("log","log"),this._wrapConsoleMethod("warn","warn"),this._wrapConsoleMethod("debug","debug"),this._wrapConsoleMethod("error","error")}_wrapConsoleMethod(e,t){const i=this,r=console[e];Object.defineProperty(console,e,{set:()=>{},get:()=>function(){i._handleConsoleCall(e,t,r,arguments)}})}_handleConsoleCall(e,t,i,r){this._mainThreadConsole.$logExtensionHostMessage({type:"__$console",severity:t,arguments:dM(r,this._includeStack)}),this._logNative&&this._nativeConsoleLogMessage(e,i,r)}};ix=V([F(0,tt),F(1,In)],ix);const uM=1e5;function dM(n,e){const t=[];if(n.length)for(let i=0;i<n.length;i++){let r=n[i];if(typeof r>"u")r="undefined";else if(r instanceof Error){const s=r;s.stack?r=s.stack:r=s.toString()}t.push(r)}if(e){const i=new Error().stack;i&&t.push({__$stack:i.split(`
`).slice(3).join(`
`)})}try{const i=uT(t);return i.length>uM?"Output omitted for a large object that exceeds the limits":i}catch(i){return`Output omitted for an object that cannot be inspected ('${i.toString()}')`}}let rx=class extends ix{constructor(e,t){super(e,t)}_nativeConsoleLogMessage(e,t,i){t.apply(console,i)}};rx=V([F(0,tt),F(1,In)],rx);class hM extends ex{_installInterceptor(){}getModule(e,t){for(const i of this._alternatives){const r=i(e);if(r){e=r;break}}if(this._factories.has(e))return this._factories.get(e).load(e,t,()=>{throw new Error("CANNOT LOAD MODULE from here.")})}}class fM extends O0{constructor(){super(...arguments),this.extensionRuntime=vm.Webworker}async _beforeAlmostReadyToRunExtensions(){ph&&this._instaService.createInstance(rx),this._apiFactory=this._instaService.invokeFunction(lM),this._fakeModules=this._instaService.createInstance(hM,this._apiFactory,{mine:this._myRegistry,all:this._globalRegistry}),await this._fakeModules.install(),performance.mark("code/extHost/didInitAPI"),await this._waitForDebuggerAttachment()}_getEntryPoint(e){return e.browser}async _loadCommonJSModule(e,t,i){t=t.with({path:pM(t.path,".js")});const r=e==null?void 0:e.identifier.value;r&&performance.mark(`code/extHost/willFetchExtensionCode/${r}`);const s=y.revive(await this._mainThreadExtensionsProxy.$asBrowserUri(t)),o=await fetch(s.toString(!0));if(r&&performance.mark(`code/extHost/didFetchExtensionCode/${r}`),o.status!==200)throw new Error(o.statusText);const a=await o.text(),l=`${t.toString(!0)}#vscode-extension`,c=`${a}
//# sourceURL=${l}`;let u;try{u=new Function("module","exports","require",c)}catch(w){throw console.error(r?`Loading code for extension ${r} failed: ${w.message}`:`Loading code failed: ${w.message}`),console.error(`${t.toString(!0)}${typeof w.line=="number"?` line ${w.line}`:""}${typeof w.column=="number"?` column ${w.column}`:""}`),console.error(w),w}e&&await this._extHostLocalizationService.initializeLocalizedMessages(e);const d={},f={exports:d},p=w=>{const v=this._fakeModules.getModule(w,t);if(v===void 0)throw new Error(`Cannot load module '${w}'`);return v};try{return i.codeLoadingStart(),r&&performance.mark(`code/extHost/willLoadExtensionCode/${r}`),u(f,d,p),f.exports!==d?f.exports:d}finally{r&&performance.mark(`code/extHost/didLoadExtensionCode/${r}`),i.codeLoadingStop()}}async $setRemoteEnvironment(e){}async _waitForDebuggerAttachment(e=5e3){if(!this._initData.environment.isExtensionDevelopmentDebug)return;const t=Date.now()+e;for(;Date.now()<t&&!("__jsDebugIsReady"in globalThis);)await Eo(10)}}function pM(n,e){return n.endsWith(e)?n:n+e}bt(No,fM,gt.Eager);bt(Jx,b0,gt.Eager);bt(k_,new rr(k0,[!0],!0));const C7=self.close.bind(self);self.close=()=>console.trace("'close' has been blocked");const P7=postMessage.bind(self);self.postMessage=()=>console.trace("'postMessage' has been blocked");function Gk(n){return/^(file|extension-file|vscode-remote):/i.test(n)}const Qk=fetch.bind(self);function gM(n){self.fetch=async function(e,t){return e instanceof Request||Gk(String(e))&&(e=(await n(y.parse(String(e)))).toString(!0)),Qk(e,t)},self.XMLHttpRequest=class extends XMLHttpRequest{open(e,t,i,r,s){(async()=>(Gk(t.toString())&&(t=(await n(y.parse(t.toString()))).toString(!0)),super.open(e,t,i??!0,r,s)))()}}}self.importScripts=()=>{throw new Error("'importScripts' has been blocked")};self.addEventListener=()=>console.trace("'addEventListener' has been blocked");self.AMDLoader=void 0;self.NLSLoaderPlugin=void 0;self.define=void 0;self.require=void 0;self.webkitRequestFileSystem=void 0;self.webkitRequestFileSystemSync=void 0;self.webkitResolveLocalFileSystemSyncURL=void 0;self.webkitResolveLocalFileSystemURL=void 0;function mM(n,e){if(self.Worker){const t=self.Worker;Worker=function(i,r){if(/^vscode-remote:/i.test(i.toString()))throw new Error("Creating workers from remote extensions is currently not supported.");async function s(a){const[l,c]=await Promise.all([n(a).then(p=>p.toString(!0)),e().then(p=>Object.fromEntries(p.map(([w,v])=>[w.toString(!0),v.toString(!0)])))]),d=`(${(function(w,v){function m(D){return typeof D=="string"||D instanceof URL?(D=String(D).replace(/^file:\/\//i,"vscode-file://vscode-app"),v[D]??D):D}const x=fetch.bind(self);self.fetch=function(D,B){return D instanceof Request?x(D,B):x(m(D),B)},self.XMLHttpRequest=class extends XMLHttpRequest{constructor(){super(...arguments),this.notFound=!1}open(D,B,T,z,K){const Ee=m(B);return this.notFound=Ee.startsWith("extension-file:"),super.open(D,Ee,T??!0,z,K)}send(D){this.notFound||super.send(D)}get status(){return this.notFound?404:super.status}};const k=importScripts.bind(self);self.importScripts=(...D)=>{k(...D.map(m))},self.importExt=D=>new Function("url","return import(url)")(m(D)),k(w)}).toString()}('${l}', ${JSON.stringify(c)}))`,f=new Blob([d],{type:"application/javascript"});return URL.createObjectURL(f)}r=r||{},r.name=`${name} -> ${r.name||ci(i.toString())}`;class o{constructor(l,c){this._onmessage=null,this._onmessageerror=null,this._onerror=null,this.workerPromise=s(y.parse(l instanceof URL?l.toString():l)).then(u=>new t(u,c))}set onmessage(l){this._onmessage=l,this.workerPromise.then(c=>{c.onmessage=l},console.error)}get onmessage(){return this._onmessage}set onmessageerror(l){this._onmessageerror=l,this.workerPromise.then(c=>{c.onmessageerror=l},console.error)}get onmessageerror(){return this._onmessageerror}set onerror(l){this._onerror=l,this.workerPromise.then(c=>{c.onerror=l},console.error)}get onerror(){return this._onerror}postMessage(l,c){this.workerPromise.then(u=>{u.postMessage(l,c)},console.error)}terminate(){this.workerPromise.then(l=>{l.terminate()},console.error)}addEventListener(l,c,u){this.workerPromise.then(d=>{d.addEventListener(l,c,u)},console.error)}removeEventListener(l,c,u){this.workerPromise.then(d=>{d.removeEventListener(l,c,u)},console.error)}dispatchEvent(l){return this.workerPromise.then(c=>{c.dispatchEvent(l)},console.error),!1}}return new o(i,r)}}else self.Worker=class extends oL{constructor(t,i){super(P7,t,{name:ci(t.toString()),...i})}}}const _M=new class{constructor(){this.pid=void 0}exit(n){C7()}};class vM{constructor(){const e=new MessageChannel,t=new L;let i=!1;P7(e.port2,[e.port2]),e.port1.onmessage=r=>{const{data:s}=r;if(!(s instanceof ArrayBuffer)){console.warn("UNKNOWN data received",s);return}const o=Pe.wrap(new Uint8Array(s,0,s.byteLength));if(wP(o,dr.Terminate)){i=!0,T7("received terminate message from renderer");return}t.fire(o)},this.protocol={onMessage:t.event,send:r=>{if(!i){const s=r.buffer.buffer.slice(r.buffer.byteOffset,r.buffer.byteOffset+r.buffer.byteLength);e.port1.postMessage(s,[s])}}}}}function wM(n){return new Promise(e=>{const t=n.onMessage(i=>{t.dispose();const r=JSON.parse(i.toString());n.send(C2(dr.Initialized)),e({protocol:n,initData:r})});n.send(C2(dr.Ready))})}let T7=n=>C7();function bM(n){return!!n&&typeof n=="object"&&n.type==="vscode.init"&&n.data instanceof Map}function yM(){ti("code/extHost/willConnectToRenderer");const n=new vM;return{onmessage(e){bM(e)&&wM(n.protocol).then(t=>{ti("code/extHost/didWaitForInitData");const i=new s2(t.protocol,t.initData,_M,null,e.data);gM(r=>i.asBrowserUri(r)),mM(r=>i.asBrowserUri(r),()=>i.getAllStaticBrowserUris()),T7=r=>i.terminate(r)})}}}const xM=yM();self.onmessage=n=>xM.onmessage(n.data);
