/**
 * Copyright (c) 2014-2024 The xterm.js authors. All rights reserved.
 * @license MIT
 *
 * Copyright (c) 2012-2013, Christopher Jeffrey (MIT License)
 * @license MIT
 *
 * Originally forked from (with the author's permission):
 *   Fabrice Bellard's javascript vt100 for jslinux:
 *   http://bellard.org/jslinux/
 *   Copyright (c) 2011 Fabrice Bellard
 */var v="3.7.7",I=v,u=typeof Buffer=="function",g=typeof TextDecoder=="function"?new TextDecoder:void 0,B=typeof TextEncoder=="function"?new TextEncoder:void 0,L="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d=Array.prototype.slice.call(L),f=(e=>{let t={};return e.forEach((r,a)=>t[r]=a),t})(d),V=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,o=String.fromCharCode.bind(String),C=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),_=e=>e.replace(/=/g,"").replace(/[+\/]/g,t=>t=="+"?"-":"_"),w=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),U=e=>{let t,r,a,i,n="",s=e.length%3;for(let c=0;c<e.length;){if((r=e.charCodeAt(c++))>255||(a=e.charCodeAt(c++))>255||(i=e.charCodeAt(c++))>255)throw new TypeError("invalid character found");t=r<<16|a<<8|i,n+=d[t>>18&63]+d[t>>12&63]+d[t>>6&63]+d[t&63]}return s?n.slice(0,s-3)+"===".substring(s):n},x=typeof btoa=="function"?e=>btoa(e):u?e=>Buffer.from(e,"binary").toString("base64"):U,b=u?e=>Buffer.from(e).toString("base64"):e=>{let t=[];for(let r=0,a=e.length;r<a;r+=4096)t.push(o.apply(null,e.subarray(r,r+4096)));return x(t.join(""))},p=(e,t=!1)=>t?_(b(e)):b(e),$=e=>{if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?o(192|t>>>6)+o(128|t&63):o(224|t>>>12&15)+o(128|t>>>6&63)+o(128|t&63)}else{var t=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return o(240|t>>>18&7)+o(128|t>>>12&63)+o(128|t>>>6&63)+o(128|t&63)}},j=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,F=e=>e.replace(j,$),m=u?e=>Buffer.from(e,"utf8").toString("base64"):B?e=>b(B.encode(e)):e=>x(F(e)),l=(e,t=!1)=>t?_(m(e)):m(e),T=e=>l(e,!0),H=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,N=e=>{switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),r=t-65536;return o((r>>>10)+55296)+o((r&1023)+56320);case 3:return o((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return o((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},S=e=>e.replace(H,N),P=e=>{if(e=e.replace(/\s+/g,""),!V.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(e.length&3));let t,r="",a,i;for(let n=0;n<e.length;)t=f[e.charAt(n++)]<<18|f[e.charAt(n++)]<<12|(a=f[e.charAt(n++)])<<6|(i=f[e.charAt(n++)]),r+=a===64?o(t>>16&255):i===64?o(t>>16&255,t>>8&255):o(t>>16&255,t>>8&255,t&255);return r},y=typeof atob=="function"?e=>atob(w(e)):u?e=>Buffer.from(e,"base64").toString("binary"):P,R=u?e=>C(Buffer.from(e,"base64")):e=>C(y(e).split("").map(t=>t.charCodeAt(0))),E=e=>R(D(e)),k=u?e=>Buffer.from(e,"base64").toString("utf8"):g?e=>g.decode(R(e)):e=>S(y(e)),D=e=>w(e.replace(/[-_]/g,t=>t=="-"?"+":"/")),A=e=>k(D(e)),q=e=>{if(typeof e!="string")return!1;let t=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},z=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),O=function(){let e=(t,r)=>Object.defineProperty(String.prototype,t,z(r));e("fromBase64",function(){return A(this)}),e("toBase64",function(t){return l(this,t)}),e("toBase64URI",function(){return l(this,!0)}),e("toBase64URL",function(){return l(this,!0)}),e("toUint8Array",function(){return E(this)})},Z=function(){let e=(t,r)=>Object.defineProperty(Uint8Array.prototype,t,z(r));e("toBase64",function(t){return p(this,t)}),e("toBase64URI",function(){return p(this,!0)}),e("toBase64URL",function(){return p(this,!0)})},G=()=>{O(),Z()},h={version:v,VERSION:I,atob:y,atobPolyfill:P,btoa:x,btoaPolyfill:U,fromBase64:A,toBase64:l,encode:l,encodeURI:T,encodeURL:T,utob:F,btou:S,decode:A,isValid:q,fromUint8Array:p,toUint8Array:E,extendString:O,extendUint8Array:Z,extendBuiltins:G},M=class{constructor(e=new K,t=new J){this._base64=e,this._provider=t}activate(e){this._terminal=e,this._disposable=e.parser.registerOscHandler(52,t=>this._setOrReportClipboard(t))}dispose(){var e;return(e=this._disposable)==null?void 0:e.dispose()}_readText(e,t){var a;let r=this._base64.encodeText(t);(a=this._terminal)==null||a.input(`\x1B]52;${e};${r}\x07`,!1)}_setOrReportClipboard(e){let t=e.split(";");if(t.length<2)return!0;let r=t[0],a=t[1];if(a==="?"){let s=this._provider.readText(r);return s instanceof Promise?s.then(c=>(this._readText(r,c),!0)):(this._readText(r,s),!0)}let i="";try{i=this._base64.decodeText(a)}catch{}let n=this._provider.writeText(r,i);return n instanceof Promise?n.then(()=>!0):!0}},J=class{async readText(e){return e!=="c"?Promise.resolve(""):navigator.clipboard.readText()}async writeText(e,t){return e!=="c"?Promise.resolve():navigator.clipboard.writeText(t)}},K=class{encodeText(e){return h.encode(e)}decodeText(e){let t=h.decode(e);return!h.isValid(e)||h.encode(t)!==e?"":t}};export{K as Base64,J as BrowserClipboardProvider,M as ClipboardAddon};
