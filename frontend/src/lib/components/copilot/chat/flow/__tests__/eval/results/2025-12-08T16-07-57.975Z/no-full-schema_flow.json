{
  "summary": "",
  "value": {
    "modules": [
      {
        "id": "fetch_users",
        "summary": "Fetch mock users from API",
        "value": {
          "type": "rawscript",
          "language": "bun",
          "content": "inline_script.fetch_users",
          "input_transforms": {}
        }
      },
      {
        "id": "filter_active_users",
        "summary": "Filter only active users",
        "value": {
          "type": "rawscript",
          "language": "bun",
          "content": "inline_script.filter_active_users",
          "input_transforms": {
            "users": {
              "type": "javascript",
              "expr": "results.fetch_users"
            }
          }
        }
      },
      {
        "id": "loop_users",
        "summary": "Loop through all active users",
        "value": {
          "type": "forloopflow",
          "modules": [
            {
              "id": "role_branch",
              "summary": "Branch based on user role",
              "value": {
                "type": "branchone",
                "branches": [
                  {
                    "summary": "Admin role",
                    "expr": "flow_input.iter.value.role === 'admin'",
                    "modules": [
                      {
                        "id": "admin_action",
                        "summary": "Admin action",
                        "value": {
                          "type": "rawscript",
                          "language": "bun",
                          "content": "inline_script.admin_action",
                          "input_transforms": {
                            "user": {
                              "type": "javascript",
                              "expr": "flow_input.iter.value"
                            }
                          }
                        }
                      }
                    ]
                  },
                  {
                    "summary": "Moderator role",
                    "expr": "flow_input.iter.value.role === 'moderator'",
                    "modules": [
                      {
                        "id": "moderator_action",
                        "summary": "Moderator action",
                        "value": {
                          "type": "rawscript",
                          "language": "bun",
                          "content": "inline_script.moderator_action",
                          "input_transforms": {
                            "user": {
                              "type": "javascript",
                              "expr": "flow_input.iter.value"
                            }
                          }
                        }
                      }
                    ]
                  },
                  {
                    "summary": "Regular user role",
                    "expr": "flow_input.iter.value.role === 'user'",
                    "modules": [
                      {
                        "id": "user_action",
                        "summary": "User action",
                        "value": {
                          "type": "rawscript",
                          "language": "bun",
                          "content": "inline_script.user_action",
                          "input_transforms": {
                            "user": {
                              "type": "javascript",
                              "expr": "flow_input.iter.value"
                            }
                          }
                        }
                      }
                    ]
                  }
                ],
                "default": [
                  {
                    "id": "default_action",
                    "summary": "Default action",
                    "value": {
                      "type": "rawscript",
                      "language": "bun",
                      "content": "inline_script.default_action",
                      "input_transforms": {
                        "user": {
                          "type": "javascript",
                          "expr": "flow_input.iter.value"
                        }
                      }
                    }
                  }
                ]
              }
            }
          ],
          "iterator": {
            "type": "javascript",
            "expr": "results.filter_active_users"
          },
          "skip_failures": false,
          "parallel": false
        }
      },
      {
        "id": "return_results",
        "summary": "Return actions taken for each user",
        "value": {
          "type": "rawscript",
          "language": "bun",
          "content": "inline_script.return_results",
          "input_transforms": {
            "actions": {
              "type": "javascript",
              "expr": "results.loop_users"
            }
          }
        }
      }
    ]
  },
  "schema": {
    "type": "object",
    "properties": {},
    "required": []
  }
}