// Auto-generated MCP tools from OpenAPI specification
// This file is generated by generate_mcp_tools.py - DO NOT EDIT MANUALLY

export interface EndpointTool {
    name: string;
    description: string;
    instructions: string;
    path: string;
    method: string;
    pathParamsSchema?: object;
    queryParamsSchema?: object;
    bodySchema?: object;
}

export const mcpEndpointTools: EndpointTool[] = [
    {
        name: "queryDocumentation",
        description: "query Windmill AI documentation assistant (EE only)",
        instructions: "",
        path: "/inkeep",
        method: "POST",
        pathParamsSchema: undefined,
        queryParamsSchema: undefined,
        bodySchema: {
        "type": "object",
        "properties": {
                "query": {
                        "type": "string",
                        "description": "The documentation query to send to the AI assistant"
                }
        },
        "required": [
                "query"
        ]
}
    },
    {
        name: "createVariable",
        description: "create variable",
        instructions: "",
        path: "/w/{workspace}/variables/create",
        method: "POST",
        pathParamsSchema: undefined,
        queryParamsSchema: {
        "type": "object",
        "properties": {
                "already_encrypted": {
                        "type": "boolean",
                        "description": "whether the variable is already encrypted (default false)"
                }
        },
        "required": []
},
        bodySchema: {
        "type": "object",
        "properties": {
                "path": {
                        "type": "string",
                        "description": "The path to the variable"
                },
                "value": {
                        "type": "string",
                        "description": "The value of the variable"
                },
                "is_secret": {
                        "type": "boolean",
                        "description": "Whether the variable is a secret"
                },
                "description": {
                        "type": "string",
                        "description": "The description of the variable"
                },
                "account": {
                        "type": "integer",
                        "description": "The account identifier"
                },
                "is_oauth": {
                        "type": "boolean",
                        "description": "Whether the variable is an OAuth variable"
                },
                "expires_at": {
                        "type": "string",
                        "description": "The expiration date of the variable",
                        "format": "date-time"
                }
        },
        "required": [
                "path",
                "value",
                "is_secret",
                "description"
        ]
}
    },
    {
        name: "deleteVariable",
        description: "delete variable",
        instructions: "",
        path: "/w/{workspace}/variables/delete/{path}",
        method: "DELETE",
        pathParamsSchema: {
        "type": "object",
        "properties": {
                "path": {
                        "type": "string"
                }
        },
        "required": [
                "path"
        ]
},
        queryParamsSchema: undefined,
        bodySchema: undefined
    },
    {
        name: "updateVariable",
        description: "update variable",
        instructions: "",
        path: "/w/{workspace}/variables/update/{path}",
        method: "POST",
        pathParamsSchema: {
        "type": "object",
        "properties": {
                "path": {
                        "type": "string"
                }
        },
        "required": [
                "path"
        ]
},
        queryParamsSchema: {
        "type": "object",
        "properties": {
                "already_encrypted": {
                        "type": "boolean",
                        "description": "whether the variable is already encrypted (default false)"
                }
        },
        "required": []
},
        bodySchema: {
        "type": "object",
        "properties": {
                "path": {
                        "type": "string",
                        "description": "The path to the variable"
                },
                "value": {
                        "type": "string",
                        "description": "The new value of the variable"
                },
                "is_secret": {
                        "type": "boolean",
                        "description": "Whether the variable is a secret"
                },
                "description": {
                        "type": "string",
                        "description": "The new description of the variable"
                }
        }
}
    },
    {
        name: "getVariable",
        description: "get variable",
        instructions: "",
        path: "/w/{workspace}/variables/get/{path}",
        method: "GET",
        pathParamsSchema: {
        "type": "object",
        "properties": {
                "path": {
                        "type": "string"
                }
        },
        "required": [
                "path"
        ]
},
        queryParamsSchema: {
        "type": "object",
        "properties": {
                "decrypt_secret": {
                        "type": "boolean",
                        "description": "ask to decrypt secret if this variable is secret\n(if not secret no effect, default: true)\n"
                },
                "include_encrypted": {
                        "type": "boolean",
                        "description": "ask to include the encrypted value if secret and decrypt secret is not true (default: false)\n"
                }
        },
        "required": []
},
        bodySchema: undefined
    },
    {
        name: "listVariable",
        description: "list variables",
        instructions: "",
        path: "/w/{workspace}/variables/list",
        method: "GET",
        pathParamsSchema: undefined,
        queryParamsSchema: {
        "type": "object",
        "properties": {
                "path_start": {
                        "type": "string",
                        "description": "filter variables by path prefix"
                },
                "page": {
                        "type": "integer",
                        "description": "which page to return (start at 1, default 1)"
                },
                "per_page": {
                        "type": "integer",
                        "description": "number of items to return for a given page (default 30, max 100)"
                }
        },
        "required": []
},
        bodySchema: undefined
    },
    {
        name: "createResource",
        description: "create resource",
        instructions: "",
        path: "/w/{workspace}/resources/create",
        method: "POST",
        pathParamsSchema: undefined,
        queryParamsSchema: {
        "type": "object",
        "properties": {
                "update_if_exists": {
                        "type": "boolean",
                        "description": "update the resource if it already exists (default false)"
                }
        },
        "required": []
},
        bodySchema: {
        "type": "object",
        "properties": {
                "path": {
                        "type": "string",
                        "description": "The path to the resource"
                },
                "value": {},
                "description": {
                        "type": "string",
                        "description": "The description of the resource"
                },
                "resource_type": {
                        "type": "string",
                        "description": "The resource_type associated with the resource"
                }
        },
        "required": [
                "path",
                "value",
                "resource_type"
        ]
}
    },
    {
        name: "deleteResource",
        description: "delete resource",
        instructions: "",
        path: "/w/{workspace}/resources/delete/{path}",
        method: "DELETE",
        pathParamsSchema: {
        "type": "object",
        "properties": {
                "path": {
                        "type": "string"
                }
        },
        "required": [
                "path"
        ]
},
        queryParamsSchema: undefined,
        bodySchema: undefined
    },
    {
        name: "updateResource",
        description: "update resource",
        instructions: "",
        path: "/w/{workspace}/resources/update/{path}",
        method: "POST",
        pathParamsSchema: {
        "type": "object",
        "properties": {
                "path": {
                        "type": "string"
                }
        },
        "required": [
                "path"
        ]
},
        queryParamsSchema: undefined,
        bodySchema: {
        "type": "object",
        "properties": {
                "path": {
                        "type": "string",
                        "description": "The path to the resource"
                },
                "description": {
                        "type": "string",
                        "description": "The new description of the resource"
                },
                "value": {},
                "resource_type": {
                        "type": "string",
                        "description": "The new resource_type to be associated with the resource"
                }
        }
}
    },
    {
        name: "getResource",
        description: "get resource",
        instructions: "",
        path: "/w/{workspace}/resources/get/{path}",
        method: "GET",
        pathParamsSchema: {
        "type": "object",
        "properties": {
                "path": {
                        "type": "string"
                }
        },
        "required": [
                "path"
        ]
},
        queryParamsSchema: undefined,
        bodySchema: undefined
    },
    {
        name: "listResource",
        description: "list resources",
        instructions: "",
        path: "/w/{workspace}/resources/list",
        method: "GET",
        pathParamsSchema: undefined,
        queryParamsSchema: {
        "type": "object",
        "properties": {
                "page": {
                        "type": "integer",
                        "description": "which page to return (start at 1, default 1)"
                },
                "per_page": {
                        "type": "integer",
                        "description": "number of items to return for a given page (default 30, max 100)"
                },
                "resource_type": {
                        "type": "string",
                        "description": "resource_types to list from, separated by ',',"
                },
                "resource_type_exclude": {
                        "type": "string",
                        "description": "resource_types to not list from, separated by ',',"
                },
                "path_start": {
                        "type": "string",
                        "description": "filter resources by path prefix"
                }
        },
        "required": []
},
        bodySchema: undefined
    },
    {
        name: "listResourceType",
        description: "list resource_types",
        instructions: "",
        path: "/w/{workspace}/resources/type/list",
        method: "GET",
        pathParamsSchema: undefined,
        queryParamsSchema: undefined,
        bodySchema: undefined
    },
    {
        name: "listScripts",
        description: "list all scripts",
        instructions: "",
        path: "/w/{workspace}/scripts/list",
        method: "GET",
        pathParamsSchema: undefined,
        queryParamsSchema: {
        "type": "object",
        "properties": {
                "page": {
                        "type": "integer",
                        "description": "which page to return (start at 1, default 1)"
                },
                "per_page": {
                        "type": "integer",
                        "description": "number of items to return for a given page (default 30, max 100)"
                },
                "order_desc": {
                        "type": "boolean",
                        "description": "order by desc order (default true)"
                },
                "created_by": {
                        "type": "string",
                        "description": "mask to filter exact matching user creator"
                },
                "path_start": {
                        "type": "string",
                        "description": "mask to filter matching starting path"
                },
                "path_exact": {
                        "type": "string",
                        "description": "mask to filter exact matching path"
                },
                "first_parent_hash": {
                        "type": "string",
                        "description": "mask to filter scripts whom first direct parent has exact hash"
                },
                "last_parent_hash": {
                        "type": "string",
                        "description": "mask to filter scripts whom last parent in the chain has exact hash.\nBeware that each script stores only a limited number of parents. Hence\nthe last parent hash for a script is not necessarily its top-most parent.\nTo find the top-most parent you will have to jump from last to last hash\n until finding the parent\n"
                },
                "parent_hash": {
                        "type": "string",
                        "description": "is the hash present in the array of stored parent hashes for this script.\nThe same warning applies than for last_parent_hash. A script only store a\nlimited number of direct parent\n"
                },
                "show_archived": {
                        "type": "boolean",
                        "description": "(default false)\nshow only the archived files.\nwhen multiple archived hash share the same path, only the ones with the latest create_at\nare\ned.\n"
                },
                "include_without_main": {
                        "type": "boolean",
                        "description": "(default false)\ninclude scripts without an exported main function\n"
                },
                "include_draft_only": {
                        "type": "boolean",
                        "description": "(default false)\ninclude scripts that have no deployed version\n"
                },
                "is_template": {
                        "type": "boolean",
                        "description": "(default regardless)\nif true show only the templates\nif false show only the non templates\nif not defined, show all regardless of if the script is a template\n"
                },
                "kinds": {
                        "type": "string",
                        "description": "(default regardless)\nscript kinds to filter, split by comma\n"
                },
                "starred_only": {
                        "type": "boolean",
                        "description": "(default false)\nshow only the starred items\n"
                },
                "with_deployment_msg": {
                        "type": "boolean",
                        "description": "(default false)\ninclude deployment message\n"
                },
                "languages": {
                        "type": "string",
                        "description": "Filter to only include scripts written in the given languages.\nAccepts multiple values as a comma-separated list.\n"
                },
                "without_description": {
                        "type": "boolean",
                        "description": "(default false)\nIf true, the description field will be omitted from the response.\n"
                },
                "dedicated_worker": {
                        "type": "boolean",
                        "description": "(default regardless)\nIf true, show only scripts with dedicated_worker enabled.\nIf false, show only scripts with dedicated_worker disabled.\n"
                }
        },
        "required": []
},
        bodySchema: undefined
    },
    {
        name: "createScript",
        description: "create script",
        instructions: "",
        path: "/w/{workspace}/scripts/create",
        method: "POST",
        pathParamsSchema: undefined,
        queryParamsSchema: undefined,
        bodySchema: {
        "type": "object",
        "properties": {
                "path": {
                        "type": "string"
                },
                "parent_hash": {
                        "type": "string"
                },
                "summary": {
                        "type": "string"
                },
                "description": {
                        "type": "string"
                },
                "content": {
                        "type": "string"
                },
                "schema": {
                        "type": "object"
                },
                "is_template": {
                        "type": "boolean"
                },
                "lock": {
                        "type": "string"
                },
                "language": {
                        "type": "string",
                        "enum": [
                                "python3",
                                "deno",
                                "go",
                                "bash",
                                "powershell",
                                "postgresql",
                                "mysql",
                                "bigquery",
                                "snowflake",
                                "mssql",
                                "oracledb",
                                "graphql",
                                "nativets",
                                "bun",
                                "php",
                                "rust",
                                "ansible",
                                "csharp",
                                "nu",
                                "java",
                                "ruby",
                                "duckdb",
                                "bunnative"
                        ]
                },
                "kind": {
                        "type": "string",
                        "enum": [
                                "script",
                                "failure",
                                "trigger",
                                "command",
                                "approval",
                                "preprocessor"
                        ]
                },
                "tag": {
                        "type": "string"
                },
                "draft_only": {
                        "type": "boolean"
                },
                "envs": {
                        "type": "array",
                        "items": {
                                "type": "string"
                        }
                },
                "concurrent_limit": {
                        "type": "integer"
                },
                "concurrency_time_window_s": {
                        "type": "integer"
                },
                "cache_ttl": {
                        "type": "number"
                },
                "cache_ignore_s3_path": {
                        "type": "boolean"
                },
                "dedicated_worker": {
                        "type": "boolean"
                },
                "ws_error_handler_muted": {
                        "type": "boolean"
                },
                "priority": {
                        "type": "integer"
                },
                "restart_unless_cancelled": {
                        "type": "boolean"
                },
                "timeout": {
                        "type": "integer"
                },
                "delete_after_use": {
                        "type": "boolean"
                },
                "deployment_message": {
                        "type": "string"
                },
                "concurrency_key": {
                        "type": "string"
                },
                "debounce_key": {
                        "type": "string"
                },
                "debounce_delay_s": {
                        "type": "integer"
                },
                "debounce_args_to_accumulate": {
                        "type": "array",
                        "items": {
                                "type": "string"
                        }
                },
                "max_total_debouncing_time": {
                        "type": "integer"
                },
                "max_total_debounces_amount": {
                        "type": "integer"
                },
                "visible_to_runner_only": {
                        "type": "boolean"
                },
                "no_main_func": {
                        "type": "boolean"
                },
                "codebase": {
                        "type": "string"
                },
                "has_preprocessor": {
                        "type": "boolean"
                },
                "on_behalf_of_email": {
                        "type": "string"
                },
                "assets": {
                        "type": "array",
                        "items": {
                                "type": "object",
                                "required": [
                                        "path",
                                        "kind"
                                ],
                                "properties": {
                                        "path": {
                                                "type": "string"
                                        },
                                        "kind": {
                                                "type": "string",
                                                "enum": [
                                                        "s3object",
                                                        "resource",
                                                        "ducklake",
                                                        "datatable"
                                                ]
                                        },
                                        "access_type": {
                                                "type": "string",
                                                "enum": [
                                                        "r",
                                                        "w",
                                                        "rw"
                                                ]
                                        },
                                        "alt_access_type": {
                                                "type": "string",
                                                "enum": [
                                                        "r",
                                                        "w",
                                                        "rw"
                                                ]
                                        }
                                }
                        }
                }
        },
        "required": [
                "path",
                "summary",
                "description",
                "content",
                "language"
        ]
}
    },
    {
        name: "deleteScriptByHash",
        description: "delete script by hash (erase content but keep hash, require admin)",
        instructions: "",
        path: "/w/{workspace}/scripts/delete/h/{hash}",
        method: "POST",
        pathParamsSchema: {
        "type": "object",
        "properties": {
                "hash": {
                        "type": "string"
                }
        },
        "required": [
                "hash"
        ]
},
        queryParamsSchema: undefined,
        bodySchema: undefined
    },
    {
        name: "deleteScriptByPath",
        description: "delete script at a given path (require admin)",
        instructions: "",
        path: "/w/{workspace}/scripts/delete/p/{path}",
        method: "POST",
        pathParamsSchema: {
        "type": "object",
        "properties": {
                "path": {
                        "type": "string"
                }
        },
        "required": [
                "path"
        ]
},
        queryParamsSchema: {
        "type": "object",
        "properties": {
                "keep_captures": {
                        "type": "boolean",
                        "description": "keep captures"
                }
        },
        "required": []
},
        bodySchema: undefined
    },
    {
        name: "getScriptByPath",
        description: "get script by path",
        instructions: "",
        path: "/w/{workspace}/scripts/get/p/{path}",
        method: "GET",
        pathParamsSchema: {
        "type": "object",
        "properties": {
                "path": {
                        "type": "string"
                }
        },
        "required": [
                "path"
        ]
},
        queryParamsSchema: {
        "type": "object",
        "properties": {
                "with_starred_info": {
                        "type": "boolean"
                }
        },
        "required": []
},
        bodySchema: undefined
    },
    {
        name: "runScriptByPath",
        description: "run script by path",
        instructions: "",
        path: "/w/{workspace}/jobs/run/p/{path}",
        method: "POST",
        pathParamsSchema: {
        "type": "object",
        "properties": {
                "path": {
                        "type": "string"
                }
        },
        "required": [
                "path"
        ]
},
        queryParamsSchema: {
        "type": "object",
        "properties": {
                "scheduled_for": {
                        "type": "string",
                        "format": "date-time",
                        "description": "when to schedule this job (leave empty for immediate run)"
                },
                "scheduled_in_secs": {
                        "type": "integer",
                        "description": "schedule the script to execute in the number of seconds starting now"
                },
                "skip_preprocessor": {
                        "type": "boolean",
                        "description": "skip the preprocessor"
                },
                "parent_job": {
                        "type": "string",
                        "format": "uuid",
                        "description": "The parent job that is at the origin and responsible for the execution of this script if any"
                },
                "tag": {
                        "type": "string",
                        "description": "Override the tag to use"
                },
                "cache_ttl": {
                        "type": "string",
                        "description": "Override the cache time to live (in seconds). Can not be used to disable caching, only override with a new cache ttl"
                },
                "job_id": {
                        "type": "string",
                        "format": "uuid",
                        "description": "The job id to assign to the created job. if missing, job is chosen randomly using the ULID scheme. If a job id already exists in the queue or as a completed job, the request to create one will fail (Bad Request)"
                },
                "invisible_to_owner": {
                        "type": "boolean",
                        "description": "make the run invisible to the the script owner (default false)"
                }
        },
        "required": []
},
        bodySchema: {
        "type": "object",
        "description": "The arguments to pass to the script or flow",
        "additionalProperties": {}
}
    },
    {
        name: "listFlows",
        description: "list all flows",
        instructions: "",
        path: "/w/{workspace}/flows/list",
        method: "GET",
        pathParamsSchema: undefined,
        queryParamsSchema: {
        "type": "object",
        "properties": {
                "page": {
                        "type": "integer",
                        "description": "which page to return (start at 1, default 1)"
                },
                "per_page": {
                        "type": "integer",
                        "description": "number of items to return for a given page (default 30, max 100)"
                },
                "order_desc": {
                        "type": "boolean",
                        "description": "order by desc order (default true)"
                },
                "created_by": {
                        "type": "string",
                        "description": "mask to filter exact matching user creator"
                },
                "path_start": {
                        "type": "string",
                        "description": "mask to filter matching starting path"
                },
                "path_exact": {
                        "type": "string",
                        "description": "mask to filter exact matching path"
                },
                "show_archived": {
                        "type": "boolean",
                        "description": "(default false)\nshow only the archived files.\nwhen multiple archived hash share the same path, only the ones with the latest create_at\nare displayed.\n"
                },
                "starred_only": {
                        "type": "boolean",
                        "description": "(default false)\nshow only the starred items\n"
                },
                "include_draft_only": {
                        "type": "boolean",
                        "description": "(default false)\ninclude items that have no deployed version\n"
                },
                "with_deployment_msg": {
                        "type": "boolean",
                        "description": "(default false)\ninclude deployment message\n"
                },
                "without_description": {
                        "type": "boolean",
                        "description": "(default false)\nIf true, the description field will be omitted from the response.\n"
                },
                "dedicated_worker": {
                        "type": "boolean",
                        "description": "(default regardless)\nIf true, show only flows with dedicated_worker enabled.\nIf false, show only flows with dedicated_worker disabled.\n"
                }
        },
        "required": []
},
        bodySchema: undefined
    },
    {
        name: "getFlowByPath",
        description: "get flow by path",
        instructions: "",
        path: "/w/{workspace}/flows/get/{path}",
        method: "GET",
        pathParamsSchema: {
        "type": "object",
        "properties": {
                "path": {
                        "type": "string"
                }
        },
        "required": [
                "path"
        ]
},
        queryParamsSchema: {
        "type": "object",
        "properties": {
                "with_starred_info": {
                        "type": "boolean"
                }
        },
        "required": []
},
        bodySchema: undefined
    },
    {
        name: "createFlow",
        description: "create flow",
        instructions: "",
        path: "/w/{workspace}/flows/create",
        method: "POST",
        pathParamsSchema: undefined,
        queryParamsSchema: undefined,
        bodySchema: {
        "allOf": [
                {
                        "allOf": [
                                {
                                        "type": "object",
                                        "description": "Top-level flow definition containing metadata, configuration, and the flow structure",
                                        "properties": {
                                                "summary": {
                                                        "type": "string",
                                                        "description": "Short description of what this flow does"
                                                },
                                                "description": {
                                                        "type": "string",
                                                        "description": "Detailed documentation for this flow"
                                                },
                                                "value": {
                                                        "type": "object",
                                                        "description": "The flow structure containing modules and optional preprocessor/failure handlers",
                                                        "properties": {
                                                                "modules": {
                                                                        "type": "array",
                                                                        "description": "Array of steps that execute in sequence. Each step can be a script, subflow, loop, or branch",
                                                                        "items": {
                                                                                "type": "object",
                                                                                "description": "A single step in a flow. Can be a script, subflow, loop, or branch",
                                                                                "properties": {
                                                                                        "id": {
                                                                                                "type": "string",
                                                                                                "description": "Unique identifier for this step. Used to reference results via 'results.step_id'. Must be a valid identifier (alphanumeric, underscore, hyphen)"
                                                                                        },
                                                                                        "value": {
                                                                                                "description": "The actual implementation of a flow step. Can be a script (inline or referenced), subflow, loop, branch, or special module type",
                                                                                                "oneOf": [
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "Inline script with code defined directly in the flow. Use 'bun' as default language if unspecified. The script receives arguments from input_transforms",
                                                                                                                "properties": {
                                                                                                                        "input_transforms": {
                                                                                                                                "type": "object",
                                                                                                                                "description": "Map of parameter names to their values (static or JavaScript expressions). These become the script's input arguments",
                                                                                                                                "additionalProperties": {
                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                        "oneOf": [
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                        "properties": {
                                                                                                                                                                "value": {
                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "static"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                        "properties": {
                                                                                                                                                                "expr": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "javascript"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "expr",
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                        "properties": {
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "ai"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "discriminator": {
                                                                                                                                                "propertyName": "type",
                                                                                                                                                "mapping": {
                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "content": {
                                                                                                                                "type": "string",
                                                                                                                                "description": "The script source code. Should export a 'main' function"
                                                                                                                        },
                                                                                                                        "language": {
                                                                                                                                "type": "string",
                                                                                                                                "description": "Programming language for this script",
                                                                                                                                "enum": [
                                                                                                                                        "deno",
                                                                                                                                        "bun",
                                                                                                                                        "python3",
                                                                                                                                        "go",
                                                                                                                                        "bash",
                                                                                                                                        "powershell",
                                                                                                                                        "postgresql",
                                                                                                                                        "mysql",
                                                                                                                                        "bigquery",
                                                                                                                                        "snowflake",
                                                                                                                                        "mssql",
                                                                                                                                        "oracledb",
                                                                                                                                        "graphql",
                                                                                                                                        "nativets",
                                                                                                                                        "php",
                                                                                                                                        "rust",
                                                                                                                                        "ansible",
                                                                                                                                        "csharp",
                                                                                                                                        "nu",
                                                                                                                                        "java",
                                                                                                                                        "ruby",
                                                                                                                                        "duckdb"
                                                                                                                                ]
                                                                                                                        },
                                                                                                                        "path": {
                                                                                                                                "type": "string",
                                                                                                                                "description": "Optional path for saving this script"
                                                                                                                        },
                                                                                                                        "lock": {
                                                                                                                                "type": "string",
                                                                                                                                "description": "Lock file content for dependencies"
                                                                                                                        },
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "rawscript"
                                                                                                                                ]
                                                                                                                        },
                                                                                                                        "tag": {
                                                                                                                                "type": "string",
                                                                                                                                "description": "Worker group tag for execution routing"
                                                                                                                        },
                                                                                                                        "concurrent_limit": {
                                                                                                                                "type": "number",
                                                                                                                                "description": "Maximum concurrent executions of this script"
                                                                                                                        },
                                                                                                                        "concurrency_time_window_s": {
                                                                                                                                "type": "number",
                                                                                                                                "description": "Time window for concurrent_limit"
                                                                                                                        },
                                                                                                                        "custom_concurrency_key": {
                                                                                                                                "type": "string",
                                                                                                                                "description": "Custom key for grouping concurrent executions"
                                                                                                                        },
                                                                                                                        "is_trigger": {
                                                                                                                                "type": "boolean",
                                                                                                                                "description": "If true, this script is a trigger that can start the flow"
                                                                                                                        },
                                                                                                                        "assets": {
                                                                                                                                "type": "array",
                                                                                                                                "description": "External resources this script accesses (S3 objects, resources, etc.)",
                                                                                                                                "items": {
                                                                                                                                        "type": "object",
                                                                                                                                        "required": [
                                                                                                                                                "path",
                                                                                                                                                "kind"
                                                                                                                                        ],
                                                                                                                                        "properties": {
                                                                                                                                                "path": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "description": "Path to the asset"
                                                                                                                                                },
                                                                                                                                                "kind": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "description": "Type of asset",
                                                                                                                                                        "enum": [
                                                                                                                                                                "s3object",
                                                                                                                                                                "resource",
                                                                                                                                                                "ducklake",
                                                                                                                                                                "datatable"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                "access_type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "nullable": true,
                                                                                                                                                        "description": "Access level for this asset",
                                                                                                                                                        "enum": [
                                                                                                                                                                "r",
                                                                                                                                                                "w",
                                                                                                                                                                "rw"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                "alt_access_type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "nullable": true,
                                                                                                                                                        "description": "Alternative access level",
                                                                                                                                                        "enum": [
                                                                                                                                                                "r",
                                                                                                                                                                "w",
                                                                                                                                                                "rw"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "type",
                                                                                                                        "content",
                                                                                                                        "language",
                                                                                                                        "input_transforms"
                                                                                                                ]
                                                                                                        },
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "Reference to an existing script by path. Use this when calling a previously saved script instead of writing inline code",
                                                                                                                "properties": {
                                                                                                                        "input_transforms": {
                                                                                                                                "type": "object",
                                                                                                                                "description": "Map of parameter names to their values (static or JavaScript expressions). These become the script's input arguments",
                                                                                                                                "additionalProperties": {
                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                        "oneOf": [
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                        "properties": {
                                                                                                                                                                "value": {
                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "static"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                        "properties": {
                                                                                                                                                                "expr": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "javascript"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "expr",
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                        "properties": {
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "ai"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "discriminator": {
                                                                                                                                                "propertyName": "type",
                                                                                                                                                "mapping": {
                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "path": {
                                                                                                                                "type": "string",
                                                                                                                                "description": "Path to the script in the workspace (e.g., 'f/scripts/send_email')"
                                                                                                                        },
                                                                                                                        "hash": {
                                                                                                                                "type": "string",
                                                                                                                                "description": "Optional specific version hash of the script to use"
                                                                                                                        },
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "script"
                                                                                                                                ]
                                                                                                                        },
                                                                                                                        "tag_override": {
                                                                                                                                "type": "string",
                                                                                                                                "description": "Override the script's default worker group tag"
                                                                                                                        },
                                                                                                                        "is_trigger": {
                                                                                                                                "type": "boolean",
                                                                                                                                "description": "If true, this script is a trigger that can start the flow"
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "type",
                                                                                                                        "path",
                                                                                                                        "input_transforms"
                                                                                                                ]
                                                                                                        },
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "Reference to an existing flow by path. Use this to call another flow as a subflow",
                                                                                                                "properties": {
                                                                                                                        "input_transforms": {
                                                                                                                                "type": "object",
                                                                                                                                "description": "Map of parameter names to their values (static or JavaScript expressions). These become the subflow's input arguments",
                                                                                                                                "additionalProperties": {
                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                        "oneOf": [
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                        "properties": {
                                                                                                                                                                "value": {
                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "static"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                        "properties": {
                                                                                                                                                                "expr": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "javascript"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "expr",
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                        "properties": {
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "ai"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "discriminator": {
                                                                                                                                                "propertyName": "type",
                                                                                                                                                "mapping": {
                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "path": {
                                                                                                                                "type": "string",
                                                                                                                                "description": "Path to the flow in the workspace (e.g., 'f/flows/process_user')"
                                                                                                                        },
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "flow"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "type",
                                                                                                                        "path",
                                                                                                                        "input_transforms"
                                                                                                                ]
                                                                                                        },
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "Executes nested modules in a loop over an iterator. Inside the loop, use 'flow_input.iter.value' to access the current iteration value, and 'flow_input.iter.index' for the index. Supports parallel execution for better performance on I/O-bound operations",
                                                                                                                "properties": {
                                                                                                                        "modules": {
                                                                                                                                "type": "array",
                                                                                                                                "description": "Steps to execute for each iteration. These can reference the iteration value via 'flow_input.iter.value'",
                                                                                                                                "items": {
                                                                                                                                        "type": "object"
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "iterator": {
                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                "oneOf": [
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                "properties": {
                                                                                                                                                        "value": {
                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "static"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                "properties": {
                                                                                                                                                        "expr": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "javascript"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "expr",
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                "properties": {
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "ai"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                ],
                                                                                                                                "discriminator": {
                                                                                                                                        "propertyName": "type",
                                                                                                                                        "mapping": {
                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "skip_failures": {
                                                                                                                                "type": "boolean",
                                                                                                                                "description": "If true, iteration failures don't stop the loop. Failed iterations return null"
                                                                                                                        },
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "forloopflow"
                                                                                                                                ]
                                                                                                                        },
                                                                                                                        "parallel": {
                                                                                                                                "type": "boolean",
                                                                                                                                "description": "If true, iterations run concurrently (faster for I/O-bound operations). Use with parallelism to control concurrency"
                                                                                                                        },
                                                                                                                        "parallelism": {
                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                "oneOf": [
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                "properties": {
                                                                                                                                                        "value": {
                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "static"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                "properties": {
                                                                                                                                                        "expr": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "javascript"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "expr",
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                "properties": {
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "ai"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                ],
                                                                                                                                "discriminator": {
                                                                                                                                        "propertyName": "type",
                                                                                                                                        "mapping": {
                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "squash": {
                                                                                                                                "type": "boolean"
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "modules",
                                                                                                                        "iterator",
                                                                                                                        "skip_failures",
                                                                                                                        "type"
                                                                                                                ]
                                                                                                        },
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "Executes nested modules repeatedly while a condition is true. The loop checks the condition after each iteration. Use stop_after_if on modules to control loop termination",
                                                                                                                "properties": {
                                                                                                                        "modules": {
                                                                                                                                "type": "array",
                                                                                                                                "description": "Steps to execute in each iteration. Use stop_after_if to control when the loop ends",
                                                                                                                                "items": {
                                                                                                                                        "type": "object"
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "skip_failures": {
                                                                                                                                "type": "boolean",
                                                                                                                                "description": "If true, iteration failures don't stop the loop. Failed iterations return null"
                                                                                                                        },
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "whileloopflow"
                                                                                                                                ]
                                                                                                                        },
                                                                                                                        "parallel": {
                                                                                                                                "type": "boolean",
                                                                                                                                "description": "If true, iterations run concurrently (use with caution in while loops)"
                                                                                                                        },
                                                                                                                        "parallelism": {
                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                "oneOf": [
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                "properties": {
                                                                                                                                                        "value": {
                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "static"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                "properties": {
                                                                                                                                                        "expr": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "javascript"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "expr",
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                "properties": {
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "ai"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                ],
                                                                                                                                "discriminator": {
                                                                                                                                        "propertyName": "type",
                                                                                                                                        "mapping": {
                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "squash": {
                                                                                                                                "type": "boolean"
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "modules",
                                                                                                                        "skip_failures",
                                                                                                                        "type"
                                                                                                                ]
                                                                                                        },
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "Conditional branching where only the first matching branch executes. Branches are evaluated in order, and the first one with a true expression runs. If no branches match, the default branch executes",
                                                                                                                "properties": {
                                                                                                                        "branches": {
                                                                                                                                "type": "array",
                                                                                                                                "description": "Array of branches to evaluate in order. The first branch with expr evaluating to true executes",
                                                                                                                                "items": {
                                                                                                                                        "type": "object",
                                                                                                                                        "properties": {
                                                                                                                                                "summary": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "description": "Short description of this branch condition"
                                                                                                                                                },
                                                                                                                                                "expr": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "description": "JavaScript expression that returns boolean. Can use 'results.step_id' or 'flow_input'. First true expr wins"
                                                                                                                                                },
                                                                                                                                                "modules": {
                                                                                                                                                        "type": "array",
                                                                                                                                                        "description": "Steps to execute if this branch's expr is true",
                                                                                                                                                        "items": {
                                                                                                                                                                "type": "object"
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "modules",
                                                                                                                                                "expr"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "default": {
                                                                                                                                "type": "array",
                                                                                                                                "description": "Steps to execute if no branch expressions match",
                                                                                                                                "items": {
                                                                                                                                        "type": "object"
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "branchone"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "branches",
                                                                                                                        "default",
                                                                                                                        "type"
                                                                                                                ]
                                                                                                        },
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "Parallel branching where all branches execute simultaneously. Unlike BranchOne, all branches run regardless of conditions. Useful for executing independent tasks concurrently",
                                                                                                                "properties": {
                                                                                                                        "branches": {
                                                                                                                                "type": "array",
                                                                                                                                "description": "Array of branches that all execute (either in parallel or sequentially)",
                                                                                                                                "items": {
                                                                                                                                        "type": "object",
                                                                                                                                        "properties": {
                                                                                                                                                "summary": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "description": "Short description of this branch's purpose"
                                                                                                                                                },
                                                                                                                                                "skip_failure": {
                                                                                                                                                        "type": "boolean",
                                                                                                                                                        "description": "If true, failure in this branch doesn't fail the entire flow"
                                                                                                                                                },
                                                                                                                                                "modules": {
                                                                                                                                                        "type": "array",
                                                                                                                                                        "description": "Steps to execute in this branch",
                                                                                                                                                        "items": {
                                                                                                                                                                "type": "object"
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "modules"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "branchall"
                                                                                                                                ]
                                                                                                                        },
                                                                                                                        "parallel": {
                                                                                                                                "type": "boolean",
                                                                                                                                "description": "If true, all branches execute concurrently. If false, they execute sequentially"
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "branches",
                                                                                                                        "type"
                                                                                                                ]
                                                                                                        },
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "Pass-through module that returns its input unchanged. Useful for flow structure or as a placeholder",
                                                                                                                "properties": {
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "identity"
                                                                                                                                ]
                                                                                                                        },
                                                                                                                        "flow": {
                                                                                                                                "type": "boolean",
                                                                                                                                "description": "If true, marks this as a flow identity (special handling)"
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "type"
                                                                                                                ]
                                                                                                        },
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "AI agent step that can use tools to accomplish tasks. The agent receives inputs and can call any of its configured tools to complete the task",
                                                                                                                "properties": {
                                                                                                                        "input_transforms": {
                                                                                                                                "type": "object",
                                                                                                                                "description": "Input parameters for the AI agent mapped to their values",
                                                                                                                                "properties": {
                                                                                                                                        "provider": {
                                                                                                                                                "description": "Provider configuration - can be static (ProviderConfig), JavaScript expression, or AI-determined",
                                                                                                                                                "oneOf": [
                                                                                                                                                        {
                                                                                                                                                                "type": "object",
                                                                                                                                                                "description": "Static provider configuration passed directly to the AI agent",
                                                                                                                                                                "properties": {
                                                                                                                                                                        "value": {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Complete AI provider configuration with resource reference and model selection",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "kind": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "description": "Supported AI provider types",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "openai",
                                                                                                                                                                                                        "azure_openai",
                                                                                                                                                                                                        "anthropic",
                                                                                                                                                                                                        "mistral",
                                                                                                                                                                                                        "deepseek",
                                                                                                                                                                                                        "googleai",
                                                                                                                                                                                                        "groq",
                                                                                                                                                                                                        "openrouter",
                                                                                                                                                                                                        "togetherai",
                                                                                                                                                                                                        "customai",
                                                                                                                                                                                                        "aws_bedrock"
                                                                                                                                                                                                ]
                                                                                                                                                                                        },
                                                                                                                                                                                        "resource": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "description": "Resource reference in format '$res:{resource_path}' pointing to provider credentials"
                                                                                                                                                                                        },
                                                                                                                                                                                        "model": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "description": "Model identifier (e.g., 'gpt-4', 'claude-3-opus-20240229', 'gemini-pro')"
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "kind",
                                                                                                                                                                                        "resource",
                                                                                                                                                                                        "model"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        "type": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "enum": [
                                                                                                                                                                                        "static"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                },
                                                                                                                                                                "required": [
                                                                                                                                                                        "type",
                                                                                                                                                                        "value"
                                                                                                                                                                ]
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                                "type": "object",
                                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                "properties": {
                                                                                                                                                                        "expr": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                        },
                                                                                                                                                                        "type": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "enum": [
                                                                                                                                                                                        "javascript"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                },
                                                                                                                                                                "required": [
                                                                                                                                                                        "expr",
                                                                                                                                                                        "type"
                                                                                                                                                                ]
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                                "type": "object",
                                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                "properties": {
                                                                                                                                                                        "type": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "enum": [
                                                                                                                                                                                        "ai"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                },
                                                                                                                                                                "required": [
                                                                                                                                                                        "type"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                ],
                                                                                                                                                "discriminator": {
                                                                                                                                                        "propertyName": "type",
                                                                                                                                                        "mapping": {
                                                                                                                                                                "static": "#/components/schemas/StaticProviderTransform",
                                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "output_type": {
                                                                                                                                                "allOf": [
                                                                                                                                                        {
                                                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                                "oneOf": [
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "value": {
                                                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "static"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "expr": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "javascript"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "expr",
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "ai"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                ],
                                                                                                                                                                "discriminator": {
                                                                                                                                                                        "propertyName": "type",
                                                                                                                                                                        "mapping": {
                                                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                        }
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                ],
                                                                                                                                                "description": "Output format type.\nValid values: 'text' (default) - plain text response, 'image' - image generation\n"
                                                                                                                                        },
                                                                                                                                        "user_message": {
                                                                                                                                                "allOf": [
                                                                                                                                                        {
                                                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                                "oneOf": [
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "value": {
                                                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "static"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "expr": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "javascript"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "expr",
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "ai"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                ],
                                                                                                                                                                "discriminator": {
                                                                                                                                                                        "propertyName": "type",
                                                                                                                                                                        "mapping": {
                                                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                        }
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                ],
                                                                                                                                                "description": "The user's prompt/message to the AI agent. Supports variable interpolation with flow.input syntax."
                                                                                                                                        },
                                                                                                                                        "system_prompt": {
                                                                                                                                                "allOf": [
                                                                                                                                                        {
                                                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                                "oneOf": [
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "value": {
                                                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "static"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "expr": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "javascript"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "expr",
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "ai"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                ],
                                                                                                                                                                "discriminator": {
                                                                                                                                                                        "propertyName": "type",
                                                                                                                                                                        "mapping": {
                                                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                        }
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                ],
                                                                                                                                                "description": "System instructions that guide the AI's behavior, persona, and response style. Optional."
                                                                                                                                        },
                                                                                                                                        "streaming": {
                                                                                                                                                "allOf": [
                                                                                                                                                        {
                                                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                                "oneOf": [
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "value": {
                                                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "static"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "expr": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "javascript"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "expr",
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "ai"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                ],
                                                                                                                                                                "discriminator": {
                                                                                                                                                                        "propertyName": "type",
                                                                                                                                                                        "mapping": {
                                                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                        }
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                ],
                                                                                                                                                "description": "Boolean. If true, stream the AI response incrementally.\nStreaming events include: token_delta, tool_call, tool_call_arguments, tool_execution, tool_result\n"
                                                                                                                                        },
                                                                                                                                        "memory": {
                                                                                                                                                "description": "Memory configuration - can be static (MemoryConfig), JavaScript expression, or AI-determined",
                                                                                                                                                "oneOf": [
                                                                                                                                                        {
                                                                                                                                                                "type": "object",
                                                                                                                                                                "description": "Static memory configuration passed directly to the AI agent",
                                                                                                                                                                "properties": {
                                                                                                                                                                        "value": {
                                                                                                                                                                                "description": "Conversation memory configuration",
                                                                                                                                                                                "oneOf": [
                                                                                                                                                                                        {
                                                                                                                                                                                                "type": "object",
                                                                                                                                                                                                "description": "No conversation memory/context",
                                                                                                                                                                                                "properties": {
                                                                                                                                                                                                        "kind": {
                                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                                        "off"
                                                                                                                                                                                                                ]
                                                                                                                                                                                                        }
                                                                                                                                                                                                },
                                                                                                                                                                                                "required": [
                                                                                                                                                                                                        "kind"
                                                                                                                                                                                                ]
                                                                                                                                                                                        },
                                                                                                                                                                                        {
                                                                                                                                                                                                "type": "object",
                                                                                                                                                                                                "description": "Automatic context management",
                                                                                                                                                                                                "properties": {
                                                                                                                                                                                                        "kind": {
                                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                                        "auto"
                                                                                                                                                                                                                ]
                                                                                                                                                                                                        },
                                                                                                                                                                                                        "context_length": {
                                                                                                                                                                                                                "type": "integer",
                                                                                                                                                                                                                "description": "Maximum number of messages to retain in context"
                                                                                                                                                                                                        },
                                                                                                                                                                                                        "memory_id": {
                                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                                "description": "Identifier for persistent memory across agent invocations"
                                                                                                                                                                                                        }
                                                                                                                                                                                                },
                                                                                                                                                                                                "required": [
                                                                                                                                                                                                        "kind"
                                                                                                                                                                                                ]
                                                                                                                                                                                        },
                                                                                                                                                                                        {
                                                                                                                                                                                                "type": "object",
                                                                                                                                                                                                "description": "Explicit message history",
                                                                                                                                                                                                "properties": {
                                                                                                                                                                                                        "kind": {
                                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                                        "manual"
                                                                                                                                                                                                                ]
                                                                                                                                                                                                        },
                                                                                                                                                                                                        "messages": {
                                                                                                                                                                                                                "type": "array",
                                                                                                                                                                                                                "items": {
                                                                                                                                                                                                                        "type": "object",
                                                                                                                                                                                                                        "description": "A single message in conversation history",
                                                                                                                                                                                                                        "properties": {
                                                                                                                                                                                                                                "role": {
                                                                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                                                                "user",
                                                                                                                                                                                                                                                "assistant",
                                                                                                                                                                                                                                                "system"
                                                                                                                                                                                                                                        ]
                                                                                                                                                                                                                                },
                                                                                                                                                                                                                                "content": {
                                                                                                                                                                                                                                        "type": "string"
                                                                                                                                                                                                                                }
                                                                                                                                                                                                                        },
                                                                                                                                                                                                                        "required": [
                                                                                                                                                                                                                                "role",
                                                                                                                                                                                                                                "content"
                                                                                                                                                                                                                        ]
                                                                                                                                                                                                                }
                                                                                                                                                                                                        }
                                                                                                                                                                                                },
                                                                                                                                                                                                "required": [
                                                                                                                                                                                                        "kind",
                                                                                                                                                                                                        "messages"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                ],
                                                                                                                                                                                "discriminator": {
                                                                                                                                                                                        "propertyName": "kind",
                                                                                                                                                                                        "mapping": {
                                                                                                                                                                                                "off": "#/components/schemas/MemoryOff",
                                                                                                                                                                                                "auto": "#/components/schemas/MemoryAuto",
                                                                                                                                                                                                "manual": "#/components/schemas/MemoryManual"
                                                                                                                                                                                        }
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "type": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "enum": [
                                                                                                                                                                                        "static"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                },
                                                                                                                                                                "required": [
                                                                                                                                                                        "type",
                                                                                                                                                                        "value"
                                                                                                                                                                ]
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                                "type": "object",
                                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                "properties": {
                                                                                                                                                                        "expr": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                        },
                                                                                                                                                                        "type": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "enum": [
                                                                                                                                                                                        "javascript"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                },
                                                                                                                                                                "required": [
                                                                                                                                                                        "expr",
                                                                                                                                                                        "type"
                                                                                                                                                                ]
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                                "type": "object",
                                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                "properties": {
                                                                                                                                                                        "type": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "enum": [
                                                                                                                                                                                        "ai"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                },
                                                                                                                                                                "required": [
                                                                                                                                                                        "type"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                ],
                                                                                                                                                "discriminator": {
                                                                                                                                                        "propertyName": "type",
                                                                                                                                                        "mapping": {
                                                                                                                                                                "static": "#/components/schemas/StaticMemoryTransform",
                                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "output_schema": {
                                                                                                                                                "allOf": [
                                                                                                                                                        {
                                                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                                "oneOf": [
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "value": {
                                                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "static"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "expr": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "javascript"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "expr",
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "ai"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                ],
                                                                                                                                                                "discriminator": {
                                                                                                                                                                        "propertyName": "type",
                                                                                                                                                                        "mapping": {
                                                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                        }
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                ],
                                                                                                                                                "description": "JSON Schema object defining structured output format. Used when you need the AI to return data in a specific shape.\nSupports standard JSON Schema properties: type, properties, required, items, enum, pattern, minLength, maxLength, minimum, maximum, etc.\nExample: { type: 'object', properties: { name: { type: 'string' }, age: { type: 'integer' } }, required: ['name'] }\n"
                                                                                                                                        },
                                                                                                                                        "user_images": {
                                                                                                                                                "allOf": [
                                                                                                                                                        {
                                                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                                "oneOf": [
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "value": {
                                                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "static"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "expr": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "javascript"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "expr",
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "ai"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                ],
                                                                                                                                                                "discriminator": {
                                                                                                                                                                        "propertyName": "type",
                                                                                                                                                                        "mapping": {
                                                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                        }
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                ],
                                                                                                                                                "description": "Array of image references for vision-capable models.\nFormat: Array<{ bucket: string, key: string }> - S3 object references\nExample: [{ bucket: 'my-bucket', key: 'images/photo.jpg' }]\n"
                                                                                                                                        },
                                                                                                                                        "max_completion_tokens": {
                                                                                                                                                "allOf": [
                                                                                                                                                        {
                                                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                                "oneOf": [
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "value": {
                                                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "static"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "expr": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "javascript"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "expr",
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "ai"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                ],
                                                                                                                                                                "discriminator": {
                                                                                                                                                                        "propertyName": "type",
                                                                                                                                                                        "mapping": {
                                                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                        }
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                ],
                                                                                                                                                "description": "Integer. Maximum number of tokens the AI will generate in its response.\nRange: 1 to 4,294,967,295. Typical values: 256-4096 for most use cases.\n"
                                                                                                                                        },
                                                                                                                                        "temperature": {
                                                                                                                                                "allOf": [
                                                                                                                                                        {
                                                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                                "oneOf": [
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "value": {
                                                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "static"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "expr": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "javascript"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "expr",
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "ai"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                ],
                                                                                                                                                                "discriminator": {
                                                                                                                                                                        "propertyName": "type",
                                                                                                                                                                        "mapping": {
                                                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                        }
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                ],
                                                                                                                                                "description": "Float. Controls randomness/creativity of responses.\nRange: 0.0 to 2.0 (provider-dependent)\n- 0.0 = deterministic, focused responses\n- 0.7 = balanced (common default)\n- 1.0+ = more creative/random\n"
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "required": [
                                                                                                                                        "provider",
                                                                                                                                        "user_message",
                                                                                                                                        "output_type"
                                                                                                                                ]
                                                                                                                        },
                                                                                                                        "tools": {
                                                                                                                                "type": "array",
                                                                                                                                "description": "Array of tools the agent can use. The agent decides which tools to call based on the task",
                                                                                                                                "items": {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "A tool available to an AI agent. Can be a flow module or an external MCP (Model Context Protocol) tool",
                                                                                                                                        "properties": {
                                                                                                                                                "id": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "description": "Unique identifier for this tool. Cannot contain spaces - use underscores instead (e.g., 'get_user_data' not 'get user data')"
                                                                                                                                                },
                                                                                                                                                "summary": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "description": "Short description of what this tool does (shown to the AI)"
                                                                                                                                                },
                                                                                                                                                "value": {
                                                                                                                                                        "description": "The implementation of a tool. Can be a flow module (script/flow) or an MCP tool reference",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "description": "A tool implemented as a flow module (script, flow, etc.). The AI can call this like any other flow module",
                                                                                                                                                                        "allOf": [
                                                                                                                                                                                {
                                                                                                                                                                                        "type": "object",
                                                                                                                                                                                        "properties": {
                                                                                                                                                                                                "tool_type": {
                                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                                "flowmodule"
                                                                                                                                                                                                        ]
                                                                                                                                                                                                }
                                                                                                                                                                                        },
                                                                                                                                                                                        "required": [
                                                                                                                                                                                                "tool_type"
                                                                                                                                                                                        ]
                                                                                                                                                                                },
                                                                                                                                                                                {
                                                                                                                                                                                        "type": "object"
                                                                                                                                                                                }
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Reference to an external MCP (Model Context Protocol) tool. The AI can call tools from MCP servers",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "tool_type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "mcp"
                                                                                                                                                                                        ]
                                                                                                                                                                                },
                                                                                                                                                                                "resource_path": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "Path to the MCP resource/server configuration"
                                                                                                                                                                                },
                                                                                                                                                                                "include_tools": {
                                                                                                                                                                                        "type": "array",
                                                                                                                                                                                        "description": "Whitelist of specific tools to include from this MCP server",
                                                                                                                                                                                        "items": {
                                                                                                                                                                                                "type": "string"
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "exclude_tools": {
                                                                                                                                                                                        "type": "array",
                                                                                                                                                                                        "description": "Blacklist of tools to exclude from this MCP server",
                                                                                                                                                                                        "items": {
                                                                                                                                                                                                "type": "string"
                                                                                                                                                                                        }
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "tool_type",
                                                                                                                                                                                "resource_path"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "A tool implemented as a websearch tool. The AI can call this like any other websearch tool",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "tool_type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "websearch"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "tool_type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "tool_type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "flowmodule": "#/components/schemas/FlowModuleTool",
                                                                                                                                                                        "mcp": "#/components/schemas/McpToolValue",
                                                                                                                                                                        "websearch": "#/components/schemas/WebsearchToolValue"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "id",
                                                                                                                                                "value"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "aiagent"
                                                                                                                                ]
                                                                                                                        },
                                                                                                                        "parallel": {
                                                                                                                                "type": "boolean",
                                                                                                                                "description": "If true, the agent can execute multiple tool calls in parallel"
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "tools",
                                                                                                                        "type",
                                                                                                                        "input_transforms"
                                                                                                                ]
                                                                                                        }
                                                                                                ],
                                                                                                "discriminator": {
                                                                                                        "propertyName": "type",
                                                                                                        "mapping": {
                                                                                                                "rawscript": "#/components/schemas/RawScript",
                                                                                                                "script": "#/components/schemas/PathScript",
                                                                                                                "flow": "#/components/schemas/PathFlow",
                                                                                                                "forloopflow": "#/components/schemas/ForloopFlow",
                                                                                                                "whileloopflow": "#/components/schemas/WhileloopFlow",
                                                                                                                "branchone": "#/components/schemas/BranchOne",
                                                                                                                "branchall": "#/components/schemas/BranchAll",
                                                                                                                "identity": "#/components/schemas/Identity",
                                                                                                                "aiagent": "#/components/schemas/AiAgent"
                                                                                                        }
                                                                                                }
                                                                                        },
                                                                                        "stop_after_if": {
                                                                                                "type": "object",
                                                                                                "description": "Early termination condition for a module",
                                                                                                "properties": {
                                                                                                        "skip_if_stopped": {
                                                                                                                "type": "boolean",
                                                                                                                "description": "If true, following steps are skipped when this condition triggers"
                                                                                                        },
                                                                                                        "expr": {
                                                                                                                "type": "string",
                                                                                                                "description": "JavaScript expression evaluated after the module runs. Can use 'result' (step's result) or 'flow_input'. Return true to stop"
                                                                                                        },
                                                                                                        "error_message": {
                                                                                                                "type": "string",
                                                                                                                "description": "Custom error message shown when stopping"
                                                                                                        }
                                                                                                },
                                                                                                "required": [
                                                                                                        "expr"
                                                                                                ]
                                                                                        },
                                                                                        "stop_after_all_iters_if": {
                                                                                                "type": "object",
                                                                                                "description": "Early termination condition for a module",
                                                                                                "properties": {
                                                                                                        "skip_if_stopped": {
                                                                                                                "type": "boolean",
                                                                                                                "description": "If true, following steps are skipped when this condition triggers"
                                                                                                        },
                                                                                                        "expr": {
                                                                                                                "type": "string",
                                                                                                                "description": "JavaScript expression evaluated after the module runs. Can use 'result' (step's result) or 'flow_input'. Return true to stop"
                                                                                                        },
                                                                                                        "error_message": {
                                                                                                                "type": "string",
                                                                                                                "description": "Custom error message shown when stopping"
                                                                                                        }
                                                                                                },
                                                                                                "required": [
                                                                                                        "expr"
                                                                                                ]
                                                                                        },
                                                                                        "skip_if": {
                                                                                                "type": "object",
                                                                                                "description": "Conditionally skip this step based on previous results or flow inputs",
                                                                                                "properties": {
                                                                                                        "expr": {
                                                                                                                "type": "string",
                                                                                                                "description": "JavaScript expression that returns true to skip. Can use 'flow_input' or 'results.<step_id>'"
                                                                                                        }
                                                                                                },
                                                                                                "required": [
                                                                                                        "expr"
                                                                                                ]
                                                                                        },
                                                                                        "sleep": {
                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                "oneOf": [
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                "properties": {
                                                                                                                        "value": {
                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                        },
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "static"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "type"
                                                                                                                ]
                                                                                                        },
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                "properties": {
                                                                                                                        "expr": {
                                                                                                                                "type": "string",
                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                        },
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "javascript"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "expr",
                                                                                                                        "type"
                                                                                                                ]
                                                                                                        },
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                "properties": {
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "ai"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "type"
                                                                                                                ]
                                                                                                        }
                                                                                                ],
                                                                                                "discriminator": {
                                                                                                        "propertyName": "type",
                                                                                                        "mapping": {
                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                        }
                                                                                                }
                                                                                        },
                                                                                        "cache_ttl": {
                                                                                                "type": "number",
                                                                                                "description": "Cache duration in seconds for this step's results"
                                                                                        },
                                                                                        "cache_ignore_s3_path": {
                                                                                                "type": "boolean"
                                                                                        },
                                                                                        "timeout": {
                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                "oneOf": [
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                "properties": {
                                                                                                                        "value": {
                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                        },
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "static"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "type"
                                                                                                                ]
                                                                                                        },
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                "properties": {
                                                                                                                        "expr": {
                                                                                                                                "type": "string",
                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                        },
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "javascript"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "expr",
                                                                                                                        "type"
                                                                                                                ]
                                                                                                        },
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                "properties": {
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "ai"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "type"
                                                                                                                ]
                                                                                                        }
                                                                                                ],
                                                                                                "discriminator": {
                                                                                                        "propertyName": "type",
                                                                                                        "mapping": {
                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                        }
                                                                                                }
                                                                                        },
                                                                                        "delete_after_use": {
                                                                                                "type": "boolean",
                                                                                                "description": "If true, this step's result is deleted after use to save memory"
                                                                                        },
                                                                                        "summary": {
                                                                                                "type": "string",
                                                                                                "description": "Short description of what this step does"
                                                                                        },
                                                                                        "mock": {
                                                                                                "type": "object",
                                                                                                "description": "Mock configuration for testing without executing the actual step",
                                                                                                "properties": {
                                                                                                        "enabled": {
                                                                                                                "type": "boolean",
                                                                                                                "description": "If true, return mock value instead of executing"
                                                                                                        },
                                                                                                        "return_value": {
                                                                                                                "description": "Value to return when mocked"
                                                                                                        }
                                                                                                }
                                                                                        },
                                                                                        "suspend": {
                                                                                                "type": "object",
                                                                                                "description": "Configuration for approval/resume steps that wait for user input",
                                                                                                "properties": {
                                                                                                        "required_events": {
                                                                                                                "type": "integer",
                                                                                                                "description": "Number of approvals required before continuing"
                                                                                                        },
                                                                                                        "timeout": {
                                                                                                                "type": "integer",
                                                                                                                "description": "Timeout in seconds before auto-continuing or canceling"
                                                                                                        },
                                                                                                        "resume_form": {
                                                                                                                "type": "object",
                                                                                                                "description": "Form schema for collecting input when resuming",
                                                                                                                "properties": {
                                                                                                                        "schema": {
                                                                                                                                "type": "object",
                                                                                                                                "description": "JSON Schema for the resume form"
                                                                                                                        }
                                                                                                                }
                                                                                                        },
                                                                                                        "user_auth_required": {
                                                                                                                "type": "boolean",
                                                                                                                "description": "If true, only authenticated users can approve"
                                                                                                        },
                                                                                                        "user_groups_required": {
                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                "oneOf": [
                                                                                                                        {
                                                                                                                                "type": "object",
                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                "properties": {
                                                                                                                                        "value": {
                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                        },
                                                                                                                                        "type": {
                                                                                                                                                "type": "string",
                                                                                                                                                "enum": [
                                                                                                                                                        "static"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "required": [
                                                                                                                                        "type"
                                                                                                                                ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                                "type": "object",
                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                "properties": {
                                                                                                                                        "expr": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                        },
                                                                                                                                        "type": {
                                                                                                                                                "type": "string",
                                                                                                                                                "enum": [
                                                                                                                                                        "javascript"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "required": [
                                                                                                                                        "expr",
                                                                                                                                        "type"
                                                                                                                                ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                                "type": "object",
                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                "properties": {
                                                                                                                                        "type": {
                                                                                                                                                "type": "string",
                                                                                                                                                "enum": [
                                                                                                                                                        "ai"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "required": [
                                                                                                                                        "type"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                ],
                                                                                                                "discriminator": {
                                                                                                                        "propertyName": "type",
                                                                                                                        "mapping": {
                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                        }
                                                                                                                }
                                                                                                        },
                                                                                                        "self_approval_disabled": {
                                                                                                                "type": "boolean",
                                                                                                                "description": "If true, the user who started the flow cannot approve"
                                                                                                        },
                                                                                                        "hide_cancel": {
                                                                                                                "type": "boolean",
                                                                                                                "description": "If true, hide the cancel button on the approval form"
                                                                                                        },
                                                                                                        "continue_on_disapprove_timeout": {
                                                                                                                "type": "boolean",
                                                                                                                "description": "If true, continue flow on timeout instead of canceling"
                                                                                                        }
                                                                                                }
                                                                                        },
                                                                                        "priority": {
                                                                                                "type": "number",
                                                                                                "description": "Execution priority for this step (higher numbers run first)"
                                                                                        },
                                                                                        "continue_on_error": {
                                                                                                "type": "boolean",
                                                                                                "description": "If true, flow continues even if this step fails"
                                                                                        },
                                                                                        "retry": {
                                                                                                "type": "object",
                                                                                                "description": "Retry configuration for failed module executions",
                                                                                                "properties": {
                                                                                                        "constant": {
                                                                                                                "type": "object",
                                                                                                                "description": "Retry with constant delay between attempts",
                                                                                                                "properties": {
                                                                                                                        "attempts": {
                                                                                                                                "type": "integer",
                                                                                                                                "description": "Number of retry attempts"
                                                                                                                        },
                                                                                                                        "seconds": {
                                                                                                                                "type": "integer",
                                                                                                                                "description": "Seconds to wait between retries"
                                                                                                                        }
                                                                                                                }
                                                                                                        },
                                                                                                        "exponential": {
                                                                                                                "type": "object",
                                                                                                                "description": "Retry with exponential backoff (delay doubles each time)",
                                                                                                                "properties": {
                                                                                                                        "attempts": {
                                                                                                                                "type": "integer",
                                                                                                                                "description": "Number of retry attempts"
                                                                                                                        },
                                                                                                                        "multiplier": {
                                                                                                                                "type": "integer",
                                                                                                                                "description": "Multiplier for exponential backoff"
                                                                                                                        },
                                                                                                                        "seconds": {
                                                                                                                                "type": "integer",
                                                                                                                                "minimum": 1,
                                                                                                                                "description": "Initial delay in seconds"
                                                                                                                        },
                                                                                                                        "random_factor": {
                                                                                                                                "type": "integer",
                                                                                                                                "minimum": 0,
                                                                                                                                "maximum": 100,
                                                                                                                                "description": "Random jitter percentage (0-100) to avoid thundering herd"
                                                                                                                        }
                                                                                                                }
                                                                                                        },
                                                                                                        "retry_if": {
                                                                                                                "type": "object",
                                                                                                                "description": "Conditional retry based on error or result",
                                                                                                                "properties": {
                                                                                                                        "expr": {
                                                                                                                                "type": "string",
                                                                                                                                "description": "JavaScript expression that returns true to retry. Has access to 'result' and 'error' variables"
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "expr"
                                                                                                                ]
                                                                                                        }
                                                                                                }
                                                                                        }
                                                                                },
                                                                                "required": [
                                                                                        "value",
                                                                                        "id"
                                                                                ]
                                                                        }
                                                                },
                                                                "failure_module": {
                                                                        "type": "object",
                                                                        "description": "A single step in a flow. Can be a script, subflow, loop, or branch",
                                                                        "properties": {
                                                                                "id": {
                                                                                        "type": "string",
                                                                                        "description": "Unique identifier for this step. Used to reference results via 'results.step_id'. Must be a valid identifier (alphanumeric, underscore, hyphen)"
                                                                                },
                                                                                "value": {
                                                                                        "description": "The actual implementation of a flow step. Can be a script (inline or referenced), subflow, loop, branch, or special module type",
                                                                                        "oneOf": [
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Inline script with code defined directly in the flow. Use 'bun' as default language if unspecified. The script receives arguments from input_transforms",
                                                                                                        "properties": {
                                                                                                                "input_transforms": {
                                                                                                                        "type": "object",
                                                                                                                        "description": "Map of parameter names to their values (static or JavaScript expressions). These become the script's input arguments",
                                                                                                                        "additionalProperties": {
                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                "oneOf": [
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                "properties": {
                                                                                                                                                        "value": {
                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "static"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                "properties": {
                                                                                                                                                        "expr": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "javascript"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "expr",
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                "properties": {
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "ai"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                ],
                                                                                                                                "discriminator": {
                                                                                                                                        "propertyName": "type",
                                                                                                                                        "mapping": {
                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        }
                                                                                                                },
                                                                                                                "content": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "The script source code. Should export a 'main' function"
                                                                                                                },
                                                                                                                "language": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Programming language for this script",
                                                                                                                        "enum": [
                                                                                                                                "deno",
                                                                                                                                "bun",
                                                                                                                                "python3",
                                                                                                                                "go",
                                                                                                                                "bash",
                                                                                                                                "powershell",
                                                                                                                                "postgresql",
                                                                                                                                "mysql",
                                                                                                                                "bigquery",
                                                                                                                                "snowflake",
                                                                                                                                "mssql",
                                                                                                                                "oracledb",
                                                                                                                                "graphql",
                                                                                                                                "nativets",
                                                                                                                                "php",
                                                                                                                                "rust",
                                                                                                                                "ansible",
                                                                                                                                "csharp",
                                                                                                                                "nu",
                                                                                                                                "java",
                                                                                                                                "ruby",
                                                                                                                                "duckdb"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "path": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Optional path for saving this script"
                                                                                                                },
                                                                                                                "lock": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Lock file content for dependencies"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "rawscript"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "tag": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Worker group tag for execution routing"
                                                                                                                },
                                                                                                                "concurrent_limit": {
                                                                                                                        "type": "number",
                                                                                                                        "description": "Maximum concurrent executions of this script"
                                                                                                                },
                                                                                                                "concurrency_time_window_s": {
                                                                                                                        "type": "number",
                                                                                                                        "description": "Time window for concurrent_limit"
                                                                                                                },
                                                                                                                "custom_concurrency_key": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Custom key for grouping concurrent executions"
                                                                                                                },
                                                                                                                "is_trigger": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, this script is a trigger that can start the flow"
                                                                                                                },
                                                                                                                "assets": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "External resources this script accesses (S3 objects, resources, etc.)",
                                                                                                                        "items": {
                                                                                                                                "type": "object",
                                                                                                                                "required": [
                                                                                                                                        "path",
                                                                                                                                        "kind"
                                                                                                                                ],
                                                                                                                                "properties": {
                                                                                                                                        "path": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "Path to the asset"
                                                                                                                                        },
                                                                                                                                        "kind": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "Type of asset",
                                                                                                                                                "enum": [
                                                                                                                                                        "s3object",
                                                                                                                                                        "resource",
                                                                                                                                                        "ducklake",
                                                                                                                                                        "datatable"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        "access_type": {
                                                                                                                                                "type": "string",
                                                                                                                                                "nullable": true,
                                                                                                                                                "description": "Access level for this asset",
                                                                                                                                                "enum": [
                                                                                                                                                        "r",
                                                                                                                                                        "w",
                                                                                                                                                        "rw"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        "alt_access_type": {
                                                                                                                                                "type": "string",
                                                                                                                                                "nullable": true,
                                                                                                                                                "description": "Alternative access level",
                                                                                                                                                "enum": [
                                                                                                                                                        "r",
                                                                                                                                                        "w",
                                                                                                                                                        "rw"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        }
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type",
                                                                                                                "content",
                                                                                                                "language",
                                                                                                                "input_transforms"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Reference to an existing script by path. Use this when calling a previously saved script instead of writing inline code",
                                                                                                        "properties": {
                                                                                                                "input_transforms": {
                                                                                                                        "type": "object",
                                                                                                                        "description": "Map of parameter names to their values (static or JavaScript expressions). These become the script's input arguments",
                                                                                                                        "additionalProperties": {
                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                "oneOf": [
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                "properties": {
                                                                                                                                                        "value": {
                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "static"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                "properties": {
                                                                                                                                                        "expr": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "javascript"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "expr",
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                "properties": {
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "ai"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                ],
                                                                                                                                "discriminator": {
                                                                                                                                        "propertyName": "type",
                                                                                                                                        "mapping": {
                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        }
                                                                                                                },
                                                                                                                "path": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Path to the script in the workspace (e.g., 'f/scripts/send_email')"
                                                                                                                },
                                                                                                                "hash": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Optional specific version hash of the script to use"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "script"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "tag_override": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Override the script's default worker group tag"
                                                                                                                },
                                                                                                                "is_trigger": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, this script is a trigger that can start the flow"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type",
                                                                                                                "path",
                                                                                                                "input_transforms"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Reference to an existing flow by path. Use this to call another flow as a subflow",
                                                                                                        "properties": {
                                                                                                                "input_transforms": {
                                                                                                                        "type": "object",
                                                                                                                        "description": "Map of parameter names to their values (static or JavaScript expressions). These become the subflow's input arguments",
                                                                                                                        "additionalProperties": {
                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                "oneOf": [
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                "properties": {
                                                                                                                                                        "value": {
                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "static"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                "properties": {
                                                                                                                                                        "expr": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "javascript"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "expr",
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                "properties": {
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "ai"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                ],
                                                                                                                                "discriminator": {
                                                                                                                                        "propertyName": "type",
                                                                                                                                        "mapping": {
                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        }
                                                                                                                },
                                                                                                                "path": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Path to the flow in the workspace (e.g., 'f/flows/process_user')"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "flow"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type",
                                                                                                                "path",
                                                                                                                "input_transforms"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Executes nested modules in a loop over an iterator. Inside the loop, use 'flow_input.iter.value' to access the current iteration value, and 'flow_input.iter.index' for the index. Supports parallel execution for better performance on I/O-bound operations",
                                                                                                        "properties": {
                                                                                                                "modules": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "Steps to execute for each iteration. These can reference the iteration value via 'flow_input.iter.value'",
                                                                                                                        "items": {
                                                                                                                                "type": "object"
                                                                                                                        }
                                                                                                                },
                                                                                                                "iterator": {
                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                        "oneOf": [
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                        "properties": {
                                                                                                                                                "value": {
                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                },
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "static"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                        "properties": {
                                                                                                                                                "expr": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                },
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "javascript"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "expr",
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                        "properties": {
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "ai"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        ],
                                                                                                                        "discriminator": {
                                                                                                                                "propertyName": "type",
                                                                                                                                "mapping": {
                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                }
                                                                                                                        }
                                                                                                                },
                                                                                                                "skip_failures": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, iteration failures don't stop the loop. Failed iterations return null"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "forloopflow"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "parallel": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, iterations run concurrently (faster for I/O-bound operations). Use with parallelism to control concurrency"
                                                                                                                },
                                                                                                                "parallelism": {
                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                        "oneOf": [
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                        "properties": {
                                                                                                                                                "value": {
                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                },
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "static"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                        "properties": {
                                                                                                                                                "expr": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                },
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "javascript"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "expr",
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                        "properties": {
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "ai"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        ],
                                                                                                                        "discriminator": {
                                                                                                                                "propertyName": "type",
                                                                                                                                "mapping": {
                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                }
                                                                                                                        }
                                                                                                                },
                                                                                                                "squash": {
                                                                                                                        "type": "boolean"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "modules",
                                                                                                                "iterator",
                                                                                                                "skip_failures",
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Executes nested modules repeatedly while a condition is true. The loop checks the condition after each iteration. Use stop_after_if on modules to control loop termination",
                                                                                                        "properties": {
                                                                                                                "modules": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "Steps to execute in each iteration. Use stop_after_if to control when the loop ends",
                                                                                                                        "items": {
                                                                                                                                "type": "object"
                                                                                                                        }
                                                                                                                },
                                                                                                                "skip_failures": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, iteration failures don't stop the loop. Failed iterations return null"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "whileloopflow"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "parallel": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, iterations run concurrently (use with caution in while loops)"
                                                                                                                },
                                                                                                                "parallelism": {
                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                        "oneOf": [
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                        "properties": {
                                                                                                                                                "value": {
                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                },
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "static"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                        "properties": {
                                                                                                                                                "expr": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                },
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "javascript"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "expr",
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                        "properties": {
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "ai"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        ],
                                                                                                                        "discriminator": {
                                                                                                                                "propertyName": "type",
                                                                                                                                "mapping": {
                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                }
                                                                                                                        }
                                                                                                                },
                                                                                                                "squash": {
                                                                                                                        "type": "boolean"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "modules",
                                                                                                                "skip_failures",
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Conditional branching where only the first matching branch executes. Branches are evaluated in order, and the first one with a true expression runs. If no branches match, the default branch executes",
                                                                                                        "properties": {
                                                                                                                "branches": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "Array of branches to evaluate in order. The first branch with expr evaluating to true executes",
                                                                                                                        "items": {
                                                                                                                                "type": "object",
                                                                                                                                "properties": {
                                                                                                                                        "summary": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "Short description of this branch condition"
                                                                                                                                        },
                                                                                                                                        "expr": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "JavaScript expression that returns boolean. Can use 'results.step_id' or 'flow_input'. First true expr wins"
                                                                                                                                        },
                                                                                                                                        "modules": {
                                                                                                                                                "type": "array",
                                                                                                                                                "description": "Steps to execute if this branch's expr is true",
                                                                                                                                                "items": {
                                                                                                                                                        "type": "object"
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "required": [
                                                                                                                                        "modules",
                                                                                                                                        "expr"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "default": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "Steps to execute if no branch expressions match",
                                                                                                                        "items": {
                                                                                                                                "type": "object"
                                                                                                                        }
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "branchone"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "branches",
                                                                                                                "default",
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Parallel branching where all branches execute simultaneously. Unlike BranchOne, all branches run regardless of conditions. Useful for executing independent tasks concurrently",
                                                                                                        "properties": {
                                                                                                                "branches": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "Array of branches that all execute (either in parallel or sequentially)",
                                                                                                                        "items": {
                                                                                                                                "type": "object",
                                                                                                                                "properties": {
                                                                                                                                        "summary": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "Short description of this branch's purpose"
                                                                                                                                        },
                                                                                                                                        "skip_failure": {
                                                                                                                                                "type": "boolean",
                                                                                                                                                "description": "If true, failure in this branch doesn't fail the entire flow"
                                                                                                                                        },
                                                                                                                                        "modules": {
                                                                                                                                                "type": "array",
                                                                                                                                                "description": "Steps to execute in this branch",
                                                                                                                                                "items": {
                                                                                                                                                        "type": "object"
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "required": [
                                                                                                                                        "modules"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "branchall"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "parallel": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, all branches execute concurrently. If false, they execute sequentially"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "branches",
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Pass-through module that returns its input unchanged. Useful for flow structure or as a placeholder",
                                                                                                        "properties": {
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "identity"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "flow": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, marks this as a flow identity (special handling)"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "AI agent step that can use tools to accomplish tasks. The agent receives inputs and can call any of its configured tools to complete the task",
                                                                                                        "properties": {
                                                                                                                "input_transforms": {
                                                                                                                        "type": "object",
                                                                                                                        "description": "Input parameters for the AI agent mapped to their values",
                                                                                                                        "properties": {
                                                                                                                                "provider": {
                                                                                                                                        "description": "Provider configuration - can be static (ProviderConfig), JavaScript expression, or AI-determined",
                                                                                                                                        "oneOf": [
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Static provider configuration passed directly to the AI agent",
                                                                                                                                                        "properties": {
                                                                                                                                                                "value": {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Complete AI provider configuration with resource reference and model selection",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "kind": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "Supported AI provider types",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "openai",
                                                                                                                                                                                                "azure_openai",
                                                                                                                                                                                                "anthropic",
                                                                                                                                                                                                "mistral",
                                                                                                                                                                                                "deepseek",
                                                                                                                                                                                                "googleai",
                                                                                                                                                                                                "groq",
                                                                                                                                                                                                "openrouter",
                                                                                                                                                                                                "togetherai",
                                                                                                                                                                                                "customai",
                                                                                                                                                                                                "aws_bedrock"
                                                                                                                                                                                        ]
                                                                                                                                                                                },
                                                                                                                                                                                "resource": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "Resource reference in format '$res:{resource_path}' pointing to provider credentials"
                                                                                                                                                                                },
                                                                                                                                                                                "model": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "Model identifier (e.g., 'gpt-4', 'claude-3-opus-20240229', 'gemini-pro')"
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "kind",
                                                                                                                                                                                "resource",
                                                                                                                                                                                "model"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "static"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type",
                                                                                                                                                                "value"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                        "properties": {
                                                                                                                                                                "expr": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "javascript"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "expr",
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                        "properties": {
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "ai"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "discriminator": {
                                                                                                                                                "propertyName": "type",
                                                                                                                                                "mapping": {
                                                                                                                                                        "static": "#/components/schemas/StaticProviderTransform",
                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "output_type": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "Output format type.\nValid values: 'text' (default) - plain text response, 'image' - image generation\n"
                                                                                                                                },
                                                                                                                                "user_message": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "The user's prompt/message to the AI agent. Supports variable interpolation with flow.input syntax."
                                                                                                                                },
                                                                                                                                "system_prompt": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "System instructions that guide the AI's behavior, persona, and response style. Optional."
                                                                                                                                },
                                                                                                                                "streaming": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "Boolean. If true, stream the AI response incrementally.\nStreaming events include: token_delta, tool_call, tool_call_arguments, tool_execution, tool_result\n"
                                                                                                                                },
                                                                                                                                "memory": {
                                                                                                                                        "description": "Memory configuration - can be static (MemoryConfig), JavaScript expression, or AI-determined",
                                                                                                                                        "oneOf": [
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Static memory configuration passed directly to the AI agent",
                                                                                                                                                        "properties": {
                                                                                                                                                                "value": {
                                                                                                                                                                        "description": "Conversation memory configuration",
                                                                                                                                                                        "oneOf": [
                                                                                                                                                                                {
                                                                                                                                                                                        "type": "object",
                                                                                                                                                                                        "description": "No conversation memory/context",
                                                                                                                                                                                        "properties": {
                                                                                                                                                                                                "kind": {
                                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                                "off"
                                                                                                                                                                                                        ]
                                                                                                                                                                                                }
                                                                                                                                                                                        },
                                                                                                                                                                                        "required": [
                                                                                                                                                                                                "kind"
                                                                                                                                                                                        ]
                                                                                                                                                                                },
                                                                                                                                                                                {
                                                                                                                                                                                        "type": "object",
                                                                                                                                                                                        "description": "Automatic context management",
                                                                                                                                                                                        "properties": {
                                                                                                                                                                                                "kind": {
                                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                                "auto"
                                                                                                                                                                                                        ]
                                                                                                                                                                                                },
                                                                                                                                                                                                "context_length": {
                                                                                                                                                                                                        "type": "integer",
                                                                                                                                                                                                        "description": "Maximum number of messages to retain in context"
                                                                                                                                                                                                },
                                                                                                                                                                                                "memory_id": {
                                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                                        "description": "Identifier for persistent memory across agent invocations"
                                                                                                                                                                                                }
                                                                                                                                                                                        },
                                                                                                                                                                                        "required": [
                                                                                                                                                                                                "kind"
                                                                                                                                                                                        ]
                                                                                                                                                                                },
                                                                                                                                                                                {
                                                                                                                                                                                        "type": "object",
                                                                                                                                                                                        "description": "Explicit message history",
                                                                                                                                                                                        "properties": {
                                                                                                                                                                                                "kind": {
                                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                                "manual"
                                                                                                                                                                                                        ]
                                                                                                                                                                                                },
                                                                                                                                                                                                "messages": {
                                                                                                                                                                                                        "type": "array",
                                                                                                                                                                                                        "items": {
                                                                                                                                                                                                                "type": "object",
                                                                                                                                                                                                                "description": "A single message in conversation history",
                                                                                                                                                                                                                "properties": {
                                                                                                                                                                                                                        "role": {
                                                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                                                        "user",
                                                                                                                                                                                                                                        "assistant",
                                                                                                                                                                                                                                        "system"
                                                                                                                                                                                                                                ]
                                                                                                                                                                                                                        },
                                                                                                                                                                                                                        "content": {
                                                                                                                                                                                                                                "type": "string"
                                                                                                                                                                                                                        }
                                                                                                                                                                                                                },
                                                                                                                                                                                                                "required": [
                                                                                                                                                                                                                        "role",
                                                                                                                                                                                                                        "content"
                                                                                                                                                                                                                ]
                                                                                                                                                                                                        }
                                                                                                                                                                                                }
                                                                                                                                                                                        },
                                                                                                                                                                                        "required": [
                                                                                                                                                                                                "kind",
                                                                                                                                                                                                "messages"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        ],
                                                                                                                                                                        "discriminator": {
                                                                                                                                                                                "propertyName": "kind",
                                                                                                                                                                                "mapping": {
                                                                                                                                                                                        "off": "#/components/schemas/MemoryOff",
                                                                                                                                                                                        "auto": "#/components/schemas/MemoryAuto",
                                                                                                                                                                                        "manual": "#/components/schemas/MemoryManual"
                                                                                                                                                                                }
                                                                                                                                                                        }
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "static"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type",
                                                                                                                                                                "value"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                        "properties": {
                                                                                                                                                                "expr": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "javascript"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "expr",
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                        "properties": {
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "ai"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "discriminator": {
                                                                                                                                                "propertyName": "type",
                                                                                                                                                "mapping": {
                                                                                                                                                        "static": "#/components/schemas/StaticMemoryTransform",
                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "output_schema": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "JSON Schema object defining structured output format. Used when you need the AI to return data in a specific shape.\nSupports standard JSON Schema properties: type, properties, required, items, enum, pattern, minLength, maxLength, minimum, maximum, etc.\nExample: { type: 'object', properties: { name: { type: 'string' }, age: { type: 'integer' } }, required: ['name'] }\n"
                                                                                                                                },
                                                                                                                                "user_images": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "Array of image references for vision-capable models.\nFormat: Array<{ bucket: string, key: string }> - S3 object references\nExample: [{ bucket: 'my-bucket', key: 'images/photo.jpg' }]\n"
                                                                                                                                },
                                                                                                                                "max_completion_tokens": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "Integer. Maximum number of tokens the AI will generate in its response.\nRange: 1 to 4,294,967,295. Typical values: 256-4096 for most use cases.\n"
                                                                                                                                },
                                                                                                                                "temperature": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "Float. Controls randomness/creativity of responses.\nRange: 0.0 to 2.0 (provider-dependent)\n- 0.0 = deterministic, focused responses\n- 0.7 = balanced (common default)\n- 1.0+ = more creative/random\n"
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "required": [
                                                                                                                                "provider",
                                                                                                                                "user_message",
                                                                                                                                "output_type"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "tools": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "Array of tools the agent can use. The agent decides which tools to call based on the task",
                                                                                                                        "items": {
                                                                                                                                "type": "object",
                                                                                                                                "description": "A tool available to an AI agent. Can be a flow module or an external MCP (Model Context Protocol) tool",
                                                                                                                                "properties": {
                                                                                                                                        "id": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "Unique identifier for this tool. Cannot contain spaces - use underscores instead (e.g., 'get_user_data' not 'get user data')"
                                                                                                                                        },
                                                                                                                                        "summary": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "Short description of what this tool does (shown to the AI)"
                                                                                                                                        },
                                                                                                                                        "value": {
                                                                                                                                                "description": "The implementation of a tool. Can be a flow module (script/flow) or an MCP tool reference",
                                                                                                                                                "oneOf": [
                                                                                                                                                        {
                                                                                                                                                                "description": "A tool implemented as a flow module (script, flow, etc.). The AI can call this like any other flow module",
                                                                                                                                                                "allOf": [
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "tool_type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "flowmodule"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "tool_type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object"
                                                                                                                                                                        }
                                                                                                                                                                ]
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                                "type": "object",
                                                                                                                                                                "description": "Reference to an external MCP (Model Context Protocol) tool. The AI can call tools from MCP servers",
                                                                                                                                                                "properties": {
                                                                                                                                                                        "tool_type": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "enum": [
                                                                                                                                                                                        "mcp"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        "resource_path": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "description": "Path to the MCP resource/server configuration"
                                                                                                                                                                        },
                                                                                                                                                                        "include_tools": {
                                                                                                                                                                                "type": "array",
                                                                                                                                                                                "description": "Whitelist of specific tools to include from this MCP server",
                                                                                                                                                                                "items": {
                                                                                                                                                                                        "type": "string"
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "exclude_tools": {
                                                                                                                                                                                "type": "array",
                                                                                                                                                                                "description": "Blacklist of tools to exclude from this MCP server",
                                                                                                                                                                                "items": {
                                                                                                                                                                                        "type": "string"
                                                                                                                                                                                }
                                                                                                                                                                        }
                                                                                                                                                                },
                                                                                                                                                                "required": [
                                                                                                                                                                        "tool_type",
                                                                                                                                                                        "resource_path"
                                                                                                                                                                ]
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                                "type": "object",
                                                                                                                                                                "description": "A tool implemented as a websearch tool. The AI can call this like any other websearch tool",
                                                                                                                                                                "properties": {
                                                                                                                                                                        "tool_type": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "enum": [
                                                                                                                                                                                        "websearch"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                },
                                                                                                                                                                "required": [
                                                                                                                                                                        "tool_type"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                ],
                                                                                                                                                "discriminator": {
                                                                                                                                                        "propertyName": "tool_type",
                                                                                                                                                        "mapping": {
                                                                                                                                                                "flowmodule": "#/components/schemas/FlowModuleTool",
                                                                                                                                                                "mcp": "#/components/schemas/McpToolValue",
                                                                                                                                                                "websearch": "#/components/schemas/WebsearchToolValue"
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "required": [
                                                                                                                                        "id",
                                                                                                                                        "value"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "aiagent"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "parallel": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, the agent can execute multiple tool calls in parallel"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "tools",
                                                                                                                "type",
                                                                                                                "input_transforms"
                                                                                                        ]
                                                                                                }
                                                                                        ],
                                                                                        "discriminator": {
                                                                                                "propertyName": "type",
                                                                                                "mapping": {
                                                                                                        "rawscript": "#/components/schemas/RawScript",
                                                                                                        "script": "#/components/schemas/PathScript",
                                                                                                        "flow": "#/components/schemas/PathFlow",
                                                                                                        "forloopflow": "#/components/schemas/ForloopFlow",
                                                                                                        "whileloopflow": "#/components/schemas/WhileloopFlow",
                                                                                                        "branchone": "#/components/schemas/BranchOne",
                                                                                                        "branchall": "#/components/schemas/BranchAll",
                                                                                                        "identity": "#/components/schemas/Identity",
                                                                                                        "aiagent": "#/components/schemas/AiAgent"
                                                                                                }
                                                                                        }
                                                                                },
                                                                                "stop_after_if": {
                                                                                        "type": "object",
                                                                                        "description": "Early termination condition for a module",
                                                                                        "properties": {
                                                                                                "skip_if_stopped": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, following steps are skipped when this condition triggers"
                                                                                                },
                                                                                                "expr": {
                                                                                                        "type": "string",
                                                                                                        "description": "JavaScript expression evaluated after the module runs. Can use 'result' (step's result) or 'flow_input'. Return true to stop"
                                                                                                },
                                                                                                "error_message": {
                                                                                                        "type": "string",
                                                                                                        "description": "Custom error message shown when stopping"
                                                                                                }
                                                                                        },
                                                                                        "required": [
                                                                                                "expr"
                                                                                        ]
                                                                                },
                                                                                "stop_after_all_iters_if": {
                                                                                        "type": "object",
                                                                                        "description": "Early termination condition for a module",
                                                                                        "properties": {
                                                                                                "skip_if_stopped": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, following steps are skipped when this condition triggers"
                                                                                                },
                                                                                                "expr": {
                                                                                                        "type": "string",
                                                                                                        "description": "JavaScript expression evaluated after the module runs. Can use 'result' (step's result) or 'flow_input'. Return true to stop"
                                                                                                },
                                                                                                "error_message": {
                                                                                                        "type": "string",
                                                                                                        "description": "Custom error message shown when stopping"
                                                                                                }
                                                                                        },
                                                                                        "required": [
                                                                                                "expr"
                                                                                        ]
                                                                                },
                                                                                "skip_if": {
                                                                                        "type": "object",
                                                                                        "description": "Conditionally skip this step based on previous results or flow inputs",
                                                                                        "properties": {
                                                                                                "expr": {
                                                                                                        "type": "string",
                                                                                                        "description": "JavaScript expression that returns true to skip. Can use 'flow_input' or 'results.<step_id>'"
                                                                                                }
                                                                                        },
                                                                                        "required": [
                                                                                                "expr"
                                                                                        ]
                                                                                },
                                                                                "sleep": {
                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                        "oneOf": [
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                        "properties": {
                                                                                                                "value": {
                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "static"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                        "properties": {
                                                                                                                "expr": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "javascript"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "expr",
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                        "properties": {
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "ai"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type"
                                                                                                        ]
                                                                                                }
                                                                                        ],
                                                                                        "discriminator": {
                                                                                                "propertyName": "type",
                                                                                                "mapping": {
                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                }
                                                                                        }
                                                                                },
                                                                                "cache_ttl": {
                                                                                        "type": "number",
                                                                                        "description": "Cache duration in seconds for this step's results"
                                                                                },
                                                                                "cache_ignore_s3_path": {
                                                                                        "type": "boolean"
                                                                                },
                                                                                "timeout": {
                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                        "oneOf": [
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                        "properties": {
                                                                                                                "value": {
                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "static"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                        "properties": {
                                                                                                                "expr": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "javascript"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "expr",
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                        "properties": {
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "ai"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type"
                                                                                                        ]
                                                                                                }
                                                                                        ],
                                                                                        "discriminator": {
                                                                                                "propertyName": "type",
                                                                                                "mapping": {
                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                }
                                                                                        }
                                                                                },
                                                                                "delete_after_use": {
                                                                                        "type": "boolean",
                                                                                        "description": "If true, this step's result is deleted after use to save memory"
                                                                                },
                                                                                "summary": {
                                                                                        "type": "string",
                                                                                        "description": "Short description of what this step does"
                                                                                },
                                                                                "mock": {
                                                                                        "type": "object",
                                                                                        "description": "Mock configuration for testing without executing the actual step",
                                                                                        "properties": {
                                                                                                "enabled": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, return mock value instead of executing"
                                                                                                },
                                                                                                "return_value": {
                                                                                                        "description": "Value to return when mocked"
                                                                                                }
                                                                                        }
                                                                                },
                                                                                "suspend": {
                                                                                        "type": "object",
                                                                                        "description": "Configuration for approval/resume steps that wait for user input",
                                                                                        "properties": {
                                                                                                "required_events": {
                                                                                                        "type": "integer",
                                                                                                        "description": "Number of approvals required before continuing"
                                                                                                },
                                                                                                "timeout": {
                                                                                                        "type": "integer",
                                                                                                        "description": "Timeout in seconds before auto-continuing or canceling"
                                                                                                },
                                                                                                "resume_form": {
                                                                                                        "type": "object",
                                                                                                        "description": "Form schema for collecting input when resuming",
                                                                                                        "properties": {
                                                                                                                "schema": {
                                                                                                                        "type": "object",
                                                                                                                        "description": "JSON Schema for the resume form"
                                                                                                                }
                                                                                                        }
                                                                                                },
                                                                                                "user_auth_required": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, only authenticated users can approve"
                                                                                                },
                                                                                                "user_groups_required": {
                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                        "oneOf": [
                                                                                                                {
                                                                                                                        "type": "object",
                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                        "properties": {
                                                                                                                                "value": {
                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                },
                                                                                                                                "type": {
                                                                                                                                        "type": "string",
                                                                                                                                        "enum": [
                                                                                                                                                "static"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "required": [
                                                                                                                                "type"
                                                                                                                        ]
                                                                                                                },
                                                                                                                {
                                                                                                                        "type": "object",
                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                        "properties": {
                                                                                                                                "expr": {
                                                                                                                                        "type": "string",
                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                },
                                                                                                                                "type": {
                                                                                                                                        "type": "string",
                                                                                                                                        "enum": [
                                                                                                                                                "javascript"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "required": [
                                                                                                                                "expr",
                                                                                                                                "type"
                                                                                                                        ]
                                                                                                                },
                                                                                                                {
                                                                                                                        "type": "object",
                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                        "properties": {
                                                                                                                                "type": {
                                                                                                                                        "type": "string",
                                                                                                                                        "enum": [
                                                                                                                                                "ai"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "required": [
                                                                                                                                "type"
                                                                                                                        ]
                                                                                                                }
                                                                                                        ],
                                                                                                        "discriminator": {
                                                                                                                "propertyName": "type",
                                                                                                                "mapping": {
                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                }
                                                                                                        }
                                                                                                },
                                                                                                "self_approval_disabled": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, the user who started the flow cannot approve"
                                                                                                },
                                                                                                "hide_cancel": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, hide the cancel button on the approval form"
                                                                                                },
                                                                                                "continue_on_disapprove_timeout": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, continue flow on timeout instead of canceling"
                                                                                                }
                                                                                        }
                                                                                },
                                                                                "priority": {
                                                                                        "type": "number",
                                                                                        "description": "Execution priority for this step (higher numbers run first)"
                                                                                },
                                                                                "continue_on_error": {
                                                                                        "type": "boolean",
                                                                                        "description": "If true, flow continues even if this step fails"
                                                                                },
                                                                                "retry": {
                                                                                        "type": "object",
                                                                                        "description": "Retry configuration for failed module executions",
                                                                                        "properties": {
                                                                                                "constant": {
                                                                                                        "type": "object",
                                                                                                        "description": "Retry with constant delay between attempts",
                                                                                                        "properties": {
                                                                                                                "attempts": {
                                                                                                                        "type": "integer",
                                                                                                                        "description": "Number of retry attempts"
                                                                                                                },
                                                                                                                "seconds": {
                                                                                                                        "type": "integer",
                                                                                                                        "description": "Seconds to wait between retries"
                                                                                                                }
                                                                                                        }
                                                                                                },
                                                                                                "exponential": {
                                                                                                        "type": "object",
                                                                                                        "description": "Retry with exponential backoff (delay doubles each time)",
                                                                                                        "properties": {
                                                                                                                "attempts": {
                                                                                                                        "type": "integer",
                                                                                                                        "description": "Number of retry attempts"
                                                                                                                },
                                                                                                                "multiplier": {
                                                                                                                        "type": "integer",
                                                                                                                        "description": "Multiplier for exponential backoff"
                                                                                                                },
                                                                                                                "seconds": {
                                                                                                                        "type": "integer",
                                                                                                                        "minimum": 1,
                                                                                                                        "description": "Initial delay in seconds"
                                                                                                                },
                                                                                                                "random_factor": {
                                                                                                                        "type": "integer",
                                                                                                                        "minimum": 0,
                                                                                                                        "maximum": 100,
                                                                                                                        "description": "Random jitter percentage (0-100) to avoid thundering herd"
                                                                                                                }
                                                                                                        }
                                                                                                },
                                                                                                "retry_if": {
                                                                                                        "type": "object",
                                                                                                        "description": "Conditional retry based on error or result",
                                                                                                        "properties": {
                                                                                                                "expr": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "JavaScript expression that returns true to retry. Has access to 'result' and 'error' variables"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "expr"
                                                                                                        ]
                                                                                                }
                                                                                        }
                                                                                }
                                                                        },
                                                                        "required": [
                                                                                "value",
                                                                                "id"
                                                                        ]
                                                                },
                                                                "preprocessor_module": {
                                                                        "type": "object",
                                                                        "description": "A single step in a flow. Can be a script, subflow, loop, or branch",
                                                                        "properties": {
                                                                                "id": {
                                                                                        "type": "string",
                                                                                        "description": "Unique identifier for this step. Used to reference results via 'results.step_id'. Must be a valid identifier (alphanumeric, underscore, hyphen)"
                                                                                },
                                                                                "value": {
                                                                                        "description": "The actual implementation of a flow step. Can be a script (inline or referenced), subflow, loop, branch, or special module type",
                                                                                        "oneOf": [
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Inline script with code defined directly in the flow. Use 'bun' as default language if unspecified. The script receives arguments from input_transforms",
                                                                                                        "properties": {
                                                                                                                "input_transforms": {
                                                                                                                        "type": "object",
                                                                                                                        "description": "Map of parameter names to their values (static or JavaScript expressions). These become the script's input arguments",
                                                                                                                        "additionalProperties": {
                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                "oneOf": [
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                "properties": {
                                                                                                                                                        "value": {
                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "static"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                "properties": {
                                                                                                                                                        "expr": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "javascript"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "expr",
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                "properties": {
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "ai"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                ],
                                                                                                                                "discriminator": {
                                                                                                                                        "propertyName": "type",
                                                                                                                                        "mapping": {
                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        }
                                                                                                                },
                                                                                                                "content": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "The script source code. Should export a 'main' function"
                                                                                                                },
                                                                                                                "language": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Programming language for this script",
                                                                                                                        "enum": [
                                                                                                                                "deno",
                                                                                                                                "bun",
                                                                                                                                "python3",
                                                                                                                                "go",
                                                                                                                                "bash",
                                                                                                                                "powershell",
                                                                                                                                "postgresql",
                                                                                                                                "mysql",
                                                                                                                                "bigquery",
                                                                                                                                "snowflake",
                                                                                                                                "mssql",
                                                                                                                                "oracledb",
                                                                                                                                "graphql",
                                                                                                                                "nativets",
                                                                                                                                "php",
                                                                                                                                "rust",
                                                                                                                                "ansible",
                                                                                                                                "csharp",
                                                                                                                                "nu",
                                                                                                                                "java",
                                                                                                                                "ruby",
                                                                                                                                "duckdb"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "path": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Optional path for saving this script"
                                                                                                                },
                                                                                                                "lock": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Lock file content for dependencies"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "rawscript"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "tag": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Worker group tag for execution routing"
                                                                                                                },
                                                                                                                "concurrent_limit": {
                                                                                                                        "type": "number",
                                                                                                                        "description": "Maximum concurrent executions of this script"
                                                                                                                },
                                                                                                                "concurrency_time_window_s": {
                                                                                                                        "type": "number",
                                                                                                                        "description": "Time window for concurrent_limit"
                                                                                                                },
                                                                                                                "custom_concurrency_key": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Custom key for grouping concurrent executions"
                                                                                                                },
                                                                                                                "is_trigger": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, this script is a trigger that can start the flow"
                                                                                                                },
                                                                                                                "assets": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "External resources this script accesses (S3 objects, resources, etc.)",
                                                                                                                        "items": {
                                                                                                                                "type": "object",
                                                                                                                                "required": [
                                                                                                                                        "path",
                                                                                                                                        "kind"
                                                                                                                                ],
                                                                                                                                "properties": {
                                                                                                                                        "path": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "Path to the asset"
                                                                                                                                        },
                                                                                                                                        "kind": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "Type of asset",
                                                                                                                                                "enum": [
                                                                                                                                                        "s3object",
                                                                                                                                                        "resource",
                                                                                                                                                        "ducklake",
                                                                                                                                                        "datatable"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        "access_type": {
                                                                                                                                                "type": "string",
                                                                                                                                                "nullable": true,
                                                                                                                                                "description": "Access level for this asset",
                                                                                                                                                "enum": [
                                                                                                                                                        "r",
                                                                                                                                                        "w",
                                                                                                                                                        "rw"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        "alt_access_type": {
                                                                                                                                                "type": "string",
                                                                                                                                                "nullable": true,
                                                                                                                                                "description": "Alternative access level",
                                                                                                                                                "enum": [
                                                                                                                                                        "r",
                                                                                                                                                        "w",
                                                                                                                                                        "rw"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        }
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type",
                                                                                                                "content",
                                                                                                                "language",
                                                                                                                "input_transforms"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Reference to an existing script by path. Use this when calling a previously saved script instead of writing inline code",
                                                                                                        "properties": {
                                                                                                                "input_transforms": {
                                                                                                                        "type": "object",
                                                                                                                        "description": "Map of parameter names to their values (static or JavaScript expressions). These become the script's input arguments",
                                                                                                                        "additionalProperties": {
                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                "oneOf": [
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                "properties": {
                                                                                                                                                        "value": {
                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "static"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                "properties": {
                                                                                                                                                        "expr": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "javascript"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "expr",
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                "properties": {
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "ai"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                ],
                                                                                                                                "discriminator": {
                                                                                                                                        "propertyName": "type",
                                                                                                                                        "mapping": {
                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        }
                                                                                                                },
                                                                                                                "path": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Path to the script in the workspace (e.g., 'f/scripts/send_email')"
                                                                                                                },
                                                                                                                "hash": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Optional specific version hash of the script to use"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "script"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "tag_override": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Override the script's default worker group tag"
                                                                                                                },
                                                                                                                "is_trigger": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, this script is a trigger that can start the flow"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type",
                                                                                                                "path",
                                                                                                                "input_transforms"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Reference to an existing flow by path. Use this to call another flow as a subflow",
                                                                                                        "properties": {
                                                                                                                "input_transforms": {
                                                                                                                        "type": "object",
                                                                                                                        "description": "Map of parameter names to their values (static or JavaScript expressions). These become the subflow's input arguments",
                                                                                                                        "additionalProperties": {
                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                "oneOf": [
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                "properties": {
                                                                                                                                                        "value": {
                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "static"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                "properties": {
                                                                                                                                                        "expr": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "javascript"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "expr",
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                "properties": {
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "ai"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                ],
                                                                                                                                "discriminator": {
                                                                                                                                        "propertyName": "type",
                                                                                                                                        "mapping": {
                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        }
                                                                                                                },
                                                                                                                "path": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Path to the flow in the workspace (e.g., 'f/flows/process_user')"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "flow"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type",
                                                                                                                "path",
                                                                                                                "input_transforms"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Executes nested modules in a loop over an iterator. Inside the loop, use 'flow_input.iter.value' to access the current iteration value, and 'flow_input.iter.index' for the index. Supports parallel execution for better performance on I/O-bound operations",
                                                                                                        "properties": {
                                                                                                                "modules": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "Steps to execute for each iteration. These can reference the iteration value via 'flow_input.iter.value'",
                                                                                                                        "items": {
                                                                                                                                "type": "object"
                                                                                                                        }
                                                                                                                },
                                                                                                                "iterator": {
                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                        "oneOf": [
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                        "properties": {
                                                                                                                                                "value": {
                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                },
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "static"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                        "properties": {
                                                                                                                                                "expr": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                },
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "javascript"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "expr",
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                        "properties": {
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "ai"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        ],
                                                                                                                        "discriminator": {
                                                                                                                                "propertyName": "type",
                                                                                                                                "mapping": {
                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                }
                                                                                                                        }
                                                                                                                },
                                                                                                                "skip_failures": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, iteration failures don't stop the loop. Failed iterations return null"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "forloopflow"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "parallel": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, iterations run concurrently (faster for I/O-bound operations). Use with parallelism to control concurrency"
                                                                                                                },
                                                                                                                "parallelism": {
                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                        "oneOf": [
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                        "properties": {
                                                                                                                                                "value": {
                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                },
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "static"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                        "properties": {
                                                                                                                                                "expr": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                },
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "javascript"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "expr",
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                        "properties": {
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "ai"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        ],
                                                                                                                        "discriminator": {
                                                                                                                                "propertyName": "type",
                                                                                                                                "mapping": {
                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                }
                                                                                                                        }
                                                                                                                },
                                                                                                                "squash": {
                                                                                                                        "type": "boolean"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "modules",
                                                                                                                "iterator",
                                                                                                                "skip_failures",
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Executes nested modules repeatedly while a condition is true. The loop checks the condition after each iteration. Use stop_after_if on modules to control loop termination",
                                                                                                        "properties": {
                                                                                                                "modules": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "Steps to execute in each iteration. Use stop_after_if to control when the loop ends",
                                                                                                                        "items": {
                                                                                                                                "type": "object"
                                                                                                                        }
                                                                                                                },
                                                                                                                "skip_failures": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, iteration failures don't stop the loop. Failed iterations return null"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "whileloopflow"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "parallel": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, iterations run concurrently (use with caution in while loops)"
                                                                                                                },
                                                                                                                "parallelism": {
                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                        "oneOf": [
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                        "properties": {
                                                                                                                                                "value": {
                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                },
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "static"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                        "properties": {
                                                                                                                                                "expr": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                },
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "javascript"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "expr",
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                        "properties": {
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "ai"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        ],
                                                                                                                        "discriminator": {
                                                                                                                                "propertyName": "type",
                                                                                                                                "mapping": {
                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                }
                                                                                                                        }
                                                                                                                },
                                                                                                                "squash": {
                                                                                                                        "type": "boolean"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "modules",
                                                                                                                "skip_failures",
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Conditional branching where only the first matching branch executes. Branches are evaluated in order, and the first one with a true expression runs. If no branches match, the default branch executes",
                                                                                                        "properties": {
                                                                                                                "branches": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "Array of branches to evaluate in order. The first branch with expr evaluating to true executes",
                                                                                                                        "items": {
                                                                                                                                "type": "object",
                                                                                                                                "properties": {
                                                                                                                                        "summary": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "Short description of this branch condition"
                                                                                                                                        },
                                                                                                                                        "expr": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "JavaScript expression that returns boolean. Can use 'results.step_id' or 'flow_input'. First true expr wins"
                                                                                                                                        },
                                                                                                                                        "modules": {
                                                                                                                                                "type": "array",
                                                                                                                                                "description": "Steps to execute if this branch's expr is true",
                                                                                                                                                "items": {
                                                                                                                                                        "type": "object"
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "required": [
                                                                                                                                        "modules",
                                                                                                                                        "expr"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "default": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "Steps to execute if no branch expressions match",
                                                                                                                        "items": {
                                                                                                                                "type": "object"
                                                                                                                        }
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "branchone"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "branches",
                                                                                                                "default",
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Parallel branching where all branches execute simultaneously. Unlike BranchOne, all branches run regardless of conditions. Useful for executing independent tasks concurrently",
                                                                                                        "properties": {
                                                                                                                "branches": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "Array of branches that all execute (either in parallel or sequentially)",
                                                                                                                        "items": {
                                                                                                                                "type": "object",
                                                                                                                                "properties": {
                                                                                                                                        "summary": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "Short description of this branch's purpose"
                                                                                                                                        },
                                                                                                                                        "skip_failure": {
                                                                                                                                                "type": "boolean",
                                                                                                                                                "description": "If true, failure in this branch doesn't fail the entire flow"
                                                                                                                                        },
                                                                                                                                        "modules": {
                                                                                                                                                "type": "array",
                                                                                                                                                "description": "Steps to execute in this branch",
                                                                                                                                                "items": {
                                                                                                                                                        "type": "object"
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "required": [
                                                                                                                                        "modules"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "branchall"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "parallel": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, all branches execute concurrently. If false, they execute sequentially"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "branches",
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Pass-through module that returns its input unchanged. Useful for flow structure or as a placeholder",
                                                                                                        "properties": {
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "identity"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "flow": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, marks this as a flow identity (special handling)"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "AI agent step that can use tools to accomplish tasks. The agent receives inputs and can call any of its configured tools to complete the task",
                                                                                                        "properties": {
                                                                                                                "input_transforms": {
                                                                                                                        "type": "object",
                                                                                                                        "description": "Input parameters for the AI agent mapped to their values",
                                                                                                                        "properties": {
                                                                                                                                "provider": {
                                                                                                                                        "description": "Provider configuration - can be static (ProviderConfig), JavaScript expression, or AI-determined",
                                                                                                                                        "oneOf": [
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Static provider configuration passed directly to the AI agent",
                                                                                                                                                        "properties": {
                                                                                                                                                                "value": {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Complete AI provider configuration with resource reference and model selection",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "kind": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "Supported AI provider types",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "openai",
                                                                                                                                                                                                "azure_openai",
                                                                                                                                                                                                "anthropic",
                                                                                                                                                                                                "mistral",
                                                                                                                                                                                                "deepseek",
                                                                                                                                                                                                "googleai",
                                                                                                                                                                                                "groq",
                                                                                                                                                                                                "openrouter",
                                                                                                                                                                                                "togetherai",
                                                                                                                                                                                                "customai",
                                                                                                                                                                                                "aws_bedrock"
                                                                                                                                                                                        ]
                                                                                                                                                                                },
                                                                                                                                                                                "resource": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "Resource reference in format '$res:{resource_path}' pointing to provider credentials"
                                                                                                                                                                                },
                                                                                                                                                                                "model": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "Model identifier (e.g., 'gpt-4', 'claude-3-opus-20240229', 'gemini-pro')"
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "kind",
                                                                                                                                                                                "resource",
                                                                                                                                                                                "model"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "static"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type",
                                                                                                                                                                "value"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                        "properties": {
                                                                                                                                                                "expr": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "javascript"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "expr",
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                        "properties": {
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "ai"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "discriminator": {
                                                                                                                                                "propertyName": "type",
                                                                                                                                                "mapping": {
                                                                                                                                                        "static": "#/components/schemas/StaticProviderTransform",
                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "output_type": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "Output format type.\nValid values: 'text' (default) - plain text response, 'image' - image generation\n"
                                                                                                                                },
                                                                                                                                "user_message": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "The user's prompt/message to the AI agent. Supports variable interpolation with flow.input syntax."
                                                                                                                                },
                                                                                                                                "system_prompt": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "System instructions that guide the AI's behavior, persona, and response style. Optional."
                                                                                                                                },
                                                                                                                                "streaming": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "Boolean. If true, stream the AI response incrementally.\nStreaming events include: token_delta, tool_call, tool_call_arguments, tool_execution, tool_result\n"
                                                                                                                                },
                                                                                                                                "memory": {
                                                                                                                                        "description": "Memory configuration - can be static (MemoryConfig), JavaScript expression, or AI-determined",
                                                                                                                                        "oneOf": [
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Static memory configuration passed directly to the AI agent",
                                                                                                                                                        "properties": {
                                                                                                                                                                "value": {
                                                                                                                                                                        "description": "Conversation memory configuration",
                                                                                                                                                                        "oneOf": [
                                                                                                                                                                                {
                                                                                                                                                                                        "type": "object",
                                                                                                                                                                                        "description": "No conversation memory/context",
                                                                                                                                                                                        "properties": {
                                                                                                                                                                                                "kind": {
                                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                                "off"
                                                                                                                                                                                                        ]
                                                                                                                                                                                                }
                                                                                                                                                                                        },
                                                                                                                                                                                        "required": [
                                                                                                                                                                                                "kind"
                                                                                                                                                                                        ]
                                                                                                                                                                                },
                                                                                                                                                                                {
                                                                                                                                                                                        "type": "object",
                                                                                                                                                                                        "description": "Automatic context management",
                                                                                                                                                                                        "properties": {
                                                                                                                                                                                                "kind": {
                                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                                "auto"
                                                                                                                                                                                                        ]
                                                                                                                                                                                                },
                                                                                                                                                                                                "context_length": {
                                                                                                                                                                                                        "type": "integer",
                                                                                                                                                                                                        "description": "Maximum number of messages to retain in context"
                                                                                                                                                                                                },
                                                                                                                                                                                                "memory_id": {
                                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                                        "description": "Identifier for persistent memory across agent invocations"
                                                                                                                                                                                                }
                                                                                                                                                                                        },
                                                                                                                                                                                        "required": [
                                                                                                                                                                                                "kind"
                                                                                                                                                                                        ]
                                                                                                                                                                                },
                                                                                                                                                                                {
                                                                                                                                                                                        "type": "object",
                                                                                                                                                                                        "description": "Explicit message history",
                                                                                                                                                                                        "properties": {
                                                                                                                                                                                                "kind": {
                                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                                "manual"
                                                                                                                                                                                                        ]
                                                                                                                                                                                                },
                                                                                                                                                                                                "messages": {
                                                                                                                                                                                                        "type": "array",
                                                                                                                                                                                                        "items": {
                                                                                                                                                                                                                "type": "object",
                                                                                                                                                                                                                "description": "A single message in conversation history",
                                                                                                                                                                                                                "properties": {
                                                                                                                                                                                                                        "role": {
                                                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                                                        "user",
                                                                                                                                                                                                                                        "assistant",
                                                                                                                                                                                                                                        "system"
                                                                                                                                                                                                                                ]
                                                                                                                                                                                                                        },
                                                                                                                                                                                                                        "content": {
                                                                                                                                                                                                                                "type": "string"
                                                                                                                                                                                                                        }
                                                                                                                                                                                                                },
                                                                                                                                                                                                                "required": [
                                                                                                                                                                                                                        "role",
                                                                                                                                                                                                                        "content"
                                                                                                                                                                                                                ]
                                                                                                                                                                                                        }
                                                                                                                                                                                                }
                                                                                                                                                                                        },
                                                                                                                                                                                        "required": [
                                                                                                                                                                                                "kind",
                                                                                                                                                                                                "messages"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        ],
                                                                                                                                                                        "discriminator": {
                                                                                                                                                                                "propertyName": "kind",
                                                                                                                                                                                "mapping": {
                                                                                                                                                                                        "off": "#/components/schemas/MemoryOff",
                                                                                                                                                                                        "auto": "#/components/schemas/MemoryAuto",
                                                                                                                                                                                        "manual": "#/components/schemas/MemoryManual"
                                                                                                                                                                                }
                                                                                                                                                                        }
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "static"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type",
                                                                                                                                                                "value"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                        "properties": {
                                                                                                                                                                "expr": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "javascript"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "expr",
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                        "properties": {
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "ai"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "discriminator": {
                                                                                                                                                "propertyName": "type",
                                                                                                                                                "mapping": {
                                                                                                                                                        "static": "#/components/schemas/StaticMemoryTransform",
                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "output_schema": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "JSON Schema object defining structured output format. Used when you need the AI to return data in a specific shape.\nSupports standard JSON Schema properties: type, properties, required, items, enum, pattern, minLength, maxLength, minimum, maximum, etc.\nExample: { type: 'object', properties: { name: { type: 'string' }, age: { type: 'integer' } }, required: ['name'] }\n"
                                                                                                                                },
                                                                                                                                "user_images": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "Array of image references for vision-capable models.\nFormat: Array<{ bucket: string, key: string }> - S3 object references\nExample: [{ bucket: 'my-bucket', key: 'images/photo.jpg' }]\n"
                                                                                                                                },
                                                                                                                                "max_completion_tokens": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "Integer. Maximum number of tokens the AI will generate in its response.\nRange: 1 to 4,294,967,295. Typical values: 256-4096 for most use cases.\n"
                                                                                                                                },
                                                                                                                                "temperature": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "Float. Controls randomness/creativity of responses.\nRange: 0.0 to 2.0 (provider-dependent)\n- 0.0 = deterministic, focused responses\n- 0.7 = balanced (common default)\n- 1.0+ = more creative/random\n"
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "required": [
                                                                                                                                "provider",
                                                                                                                                "user_message",
                                                                                                                                "output_type"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "tools": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "Array of tools the agent can use. The agent decides which tools to call based on the task",
                                                                                                                        "items": {
                                                                                                                                "type": "object",
                                                                                                                                "description": "A tool available to an AI agent. Can be a flow module or an external MCP (Model Context Protocol) tool",
                                                                                                                                "properties": {
                                                                                                                                        "id": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "Unique identifier for this tool. Cannot contain spaces - use underscores instead (e.g., 'get_user_data' not 'get user data')"
                                                                                                                                        },
                                                                                                                                        "summary": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "Short description of what this tool does (shown to the AI)"
                                                                                                                                        },
                                                                                                                                        "value": {
                                                                                                                                                "description": "The implementation of a tool. Can be a flow module (script/flow) or an MCP tool reference",
                                                                                                                                                "oneOf": [
                                                                                                                                                        {
                                                                                                                                                                "description": "A tool implemented as a flow module (script, flow, etc.). The AI can call this like any other flow module",
                                                                                                                                                                "allOf": [
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "tool_type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "flowmodule"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "tool_type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object"
                                                                                                                                                                        }
                                                                                                                                                                ]
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                                "type": "object",
                                                                                                                                                                "description": "Reference to an external MCP (Model Context Protocol) tool. The AI can call tools from MCP servers",
                                                                                                                                                                "properties": {
                                                                                                                                                                        "tool_type": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "enum": [
                                                                                                                                                                                        "mcp"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        "resource_path": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "description": "Path to the MCP resource/server configuration"
                                                                                                                                                                        },
                                                                                                                                                                        "include_tools": {
                                                                                                                                                                                "type": "array",
                                                                                                                                                                                "description": "Whitelist of specific tools to include from this MCP server",
                                                                                                                                                                                "items": {
                                                                                                                                                                                        "type": "string"
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "exclude_tools": {
                                                                                                                                                                                "type": "array",
                                                                                                                                                                                "description": "Blacklist of tools to exclude from this MCP server",
                                                                                                                                                                                "items": {
                                                                                                                                                                                        "type": "string"
                                                                                                                                                                                }
                                                                                                                                                                        }
                                                                                                                                                                },
                                                                                                                                                                "required": [
                                                                                                                                                                        "tool_type",
                                                                                                                                                                        "resource_path"
                                                                                                                                                                ]
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                                "type": "object",
                                                                                                                                                                "description": "A tool implemented as a websearch tool. The AI can call this like any other websearch tool",
                                                                                                                                                                "properties": {
                                                                                                                                                                        "tool_type": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "enum": [
                                                                                                                                                                                        "websearch"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                },
                                                                                                                                                                "required": [
                                                                                                                                                                        "tool_type"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                ],
                                                                                                                                                "discriminator": {
                                                                                                                                                        "propertyName": "tool_type",
                                                                                                                                                        "mapping": {
                                                                                                                                                                "flowmodule": "#/components/schemas/FlowModuleTool",
                                                                                                                                                                "mcp": "#/components/schemas/McpToolValue",
                                                                                                                                                                "websearch": "#/components/schemas/WebsearchToolValue"
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "required": [
                                                                                                                                        "id",
                                                                                                                                        "value"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "aiagent"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "parallel": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, the agent can execute multiple tool calls in parallel"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "tools",
                                                                                                                "type",
                                                                                                                "input_transforms"
                                                                                                        ]
                                                                                                }
                                                                                        ],
                                                                                        "discriminator": {
                                                                                                "propertyName": "type",
                                                                                                "mapping": {
                                                                                                        "rawscript": "#/components/schemas/RawScript",
                                                                                                        "script": "#/components/schemas/PathScript",
                                                                                                        "flow": "#/components/schemas/PathFlow",
                                                                                                        "forloopflow": "#/components/schemas/ForloopFlow",
                                                                                                        "whileloopflow": "#/components/schemas/WhileloopFlow",
                                                                                                        "branchone": "#/components/schemas/BranchOne",
                                                                                                        "branchall": "#/components/schemas/BranchAll",
                                                                                                        "identity": "#/components/schemas/Identity",
                                                                                                        "aiagent": "#/components/schemas/AiAgent"
                                                                                                }
                                                                                        }
                                                                                },
                                                                                "stop_after_if": {
                                                                                        "type": "object",
                                                                                        "description": "Early termination condition for a module",
                                                                                        "properties": {
                                                                                                "skip_if_stopped": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, following steps are skipped when this condition triggers"
                                                                                                },
                                                                                                "expr": {
                                                                                                        "type": "string",
                                                                                                        "description": "JavaScript expression evaluated after the module runs. Can use 'result' (step's result) or 'flow_input'. Return true to stop"
                                                                                                },
                                                                                                "error_message": {
                                                                                                        "type": "string",
                                                                                                        "description": "Custom error message shown when stopping"
                                                                                                }
                                                                                        },
                                                                                        "required": [
                                                                                                "expr"
                                                                                        ]
                                                                                },
                                                                                "stop_after_all_iters_if": {
                                                                                        "type": "object",
                                                                                        "description": "Early termination condition for a module",
                                                                                        "properties": {
                                                                                                "skip_if_stopped": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, following steps are skipped when this condition triggers"
                                                                                                },
                                                                                                "expr": {
                                                                                                        "type": "string",
                                                                                                        "description": "JavaScript expression evaluated after the module runs. Can use 'result' (step's result) or 'flow_input'. Return true to stop"
                                                                                                },
                                                                                                "error_message": {
                                                                                                        "type": "string",
                                                                                                        "description": "Custom error message shown when stopping"
                                                                                                }
                                                                                        },
                                                                                        "required": [
                                                                                                "expr"
                                                                                        ]
                                                                                },
                                                                                "skip_if": {
                                                                                        "type": "object",
                                                                                        "description": "Conditionally skip this step based on previous results or flow inputs",
                                                                                        "properties": {
                                                                                                "expr": {
                                                                                                        "type": "string",
                                                                                                        "description": "JavaScript expression that returns true to skip. Can use 'flow_input' or 'results.<step_id>'"
                                                                                                }
                                                                                        },
                                                                                        "required": [
                                                                                                "expr"
                                                                                        ]
                                                                                },
                                                                                "sleep": {
                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                        "oneOf": [
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                        "properties": {
                                                                                                                "value": {
                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "static"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                        "properties": {
                                                                                                                "expr": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "javascript"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "expr",
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                        "properties": {
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "ai"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type"
                                                                                                        ]
                                                                                                }
                                                                                        ],
                                                                                        "discriminator": {
                                                                                                "propertyName": "type",
                                                                                                "mapping": {
                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                }
                                                                                        }
                                                                                },
                                                                                "cache_ttl": {
                                                                                        "type": "number",
                                                                                        "description": "Cache duration in seconds for this step's results"
                                                                                },
                                                                                "cache_ignore_s3_path": {
                                                                                        "type": "boolean"
                                                                                },
                                                                                "timeout": {
                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                        "oneOf": [
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                        "properties": {
                                                                                                                "value": {
                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "static"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                        "properties": {
                                                                                                                "expr": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "javascript"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "expr",
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                        "properties": {
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "ai"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type"
                                                                                                        ]
                                                                                                }
                                                                                        ],
                                                                                        "discriminator": {
                                                                                                "propertyName": "type",
                                                                                                "mapping": {
                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                }
                                                                                        }
                                                                                },
                                                                                "delete_after_use": {
                                                                                        "type": "boolean",
                                                                                        "description": "If true, this step's result is deleted after use to save memory"
                                                                                },
                                                                                "summary": {
                                                                                        "type": "string",
                                                                                        "description": "Short description of what this step does"
                                                                                },
                                                                                "mock": {
                                                                                        "type": "object",
                                                                                        "description": "Mock configuration for testing without executing the actual step",
                                                                                        "properties": {
                                                                                                "enabled": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, return mock value instead of executing"
                                                                                                },
                                                                                                "return_value": {
                                                                                                        "description": "Value to return when mocked"
                                                                                                }
                                                                                        }
                                                                                },
                                                                                "suspend": {
                                                                                        "type": "object",
                                                                                        "description": "Configuration for approval/resume steps that wait for user input",
                                                                                        "properties": {
                                                                                                "required_events": {
                                                                                                        "type": "integer",
                                                                                                        "description": "Number of approvals required before continuing"
                                                                                                },
                                                                                                "timeout": {
                                                                                                        "type": "integer",
                                                                                                        "description": "Timeout in seconds before auto-continuing or canceling"
                                                                                                },
                                                                                                "resume_form": {
                                                                                                        "type": "object",
                                                                                                        "description": "Form schema for collecting input when resuming",
                                                                                                        "properties": {
                                                                                                                "schema": {
                                                                                                                        "type": "object",
                                                                                                                        "description": "JSON Schema for the resume form"
                                                                                                                }
                                                                                                        }
                                                                                                },
                                                                                                "user_auth_required": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, only authenticated users can approve"
                                                                                                },
                                                                                                "user_groups_required": {
                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                        "oneOf": [
                                                                                                                {
                                                                                                                        "type": "object",
                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                        "properties": {
                                                                                                                                "value": {
                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                },
                                                                                                                                "type": {
                                                                                                                                        "type": "string",
                                                                                                                                        "enum": [
                                                                                                                                                "static"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "required": [
                                                                                                                                "type"
                                                                                                                        ]
                                                                                                                },
                                                                                                                {
                                                                                                                        "type": "object",
                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                        "properties": {
                                                                                                                                "expr": {
                                                                                                                                        "type": "string",
                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                },
                                                                                                                                "type": {
                                                                                                                                        "type": "string",
                                                                                                                                        "enum": [
                                                                                                                                                "javascript"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "required": [
                                                                                                                                "expr",
                                                                                                                                "type"
                                                                                                                        ]
                                                                                                                },
                                                                                                                {
                                                                                                                        "type": "object",
                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                        "properties": {
                                                                                                                                "type": {
                                                                                                                                        "type": "string",
                                                                                                                                        "enum": [
                                                                                                                                                "ai"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "required": [
                                                                                                                                "type"
                                                                                                                        ]
                                                                                                                }
                                                                                                        ],
                                                                                                        "discriminator": {
                                                                                                                "propertyName": "type",
                                                                                                                "mapping": {
                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                }
                                                                                                        }
                                                                                                },
                                                                                                "self_approval_disabled": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, the user who started the flow cannot approve"
                                                                                                },
                                                                                                "hide_cancel": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, hide the cancel button on the approval form"
                                                                                                },
                                                                                                "continue_on_disapprove_timeout": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, continue flow on timeout instead of canceling"
                                                                                                }
                                                                                        }
                                                                                },
                                                                                "priority": {
                                                                                        "type": "number",
                                                                                        "description": "Execution priority for this step (higher numbers run first)"
                                                                                },
                                                                                "continue_on_error": {
                                                                                        "type": "boolean",
                                                                                        "description": "If true, flow continues even if this step fails"
                                                                                },
                                                                                "retry": {
                                                                                        "type": "object",
                                                                                        "description": "Retry configuration for failed module executions",
                                                                                        "properties": {
                                                                                                "constant": {
                                                                                                        "type": "object",
                                                                                                        "description": "Retry with constant delay between attempts",
                                                                                                        "properties": {
                                                                                                                "attempts": {
                                                                                                                        "type": "integer",
                                                                                                                        "description": "Number of retry attempts"
                                                                                                                },
                                                                                                                "seconds": {
                                                                                                                        "type": "integer",
                                                                                                                        "description": "Seconds to wait between retries"
                                                                                                                }
                                                                                                        }
                                                                                                },
                                                                                                "exponential": {
                                                                                                        "type": "object",
                                                                                                        "description": "Retry with exponential backoff (delay doubles each time)",
                                                                                                        "properties": {
                                                                                                                "attempts": {
                                                                                                                        "type": "integer",
                                                                                                                        "description": "Number of retry attempts"
                                                                                                                },
                                                                                                                "multiplier": {
                                                                                                                        "type": "integer",
                                                                                                                        "description": "Multiplier for exponential backoff"
                                                                                                                },
                                                                                                                "seconds": {
                                                                                                                        "type": "integer",
                                                                                                                        "minimum": 1,
                                                                                                                        "description": "Initial delay in seconds"
                                                                                                                },
                                                                                                                "random_factor": {
                                                                                                                        "type": "integer",
                                                                                                                        "minimum": 0,
                                                                                                                        "maximum": 100,
                                                                                                                        "description": "Random jitter percentage (0-100) to avoid thundering herd"
                                                                                                                }
                                                                                                        }
                                                                                                },
                                                                                                "retry_if": {
                                                                                                        "type": "object",
                                                                                                        "description": "Conditional retry based on error or result",
                                                                                                        "properties": {
                                                                                                                "expr": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "JavaScript expression that returns true to retry. Has access to 'result' and 'error' variables"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "expr"
                                                                                                        ]
                                                                                                }
                                                                                        }
                                                                                }
                                                                        },
                                                                        "required": [
                                                                                "value",
                                                                                "id"
                                                                        ]
                                                                },
                                                                "same_worker": {
                                                                        "type": "boolean",
                                                                        "description": "If true, all steps run on the same worker for better performance"
                                                                },
                                                                "concurrent_limit": {
                                                                        "type": "number",
                                                                        "description": "Maximum number of concurrent executions of this flow"
                                                                },
                                                                "concurrency_key": {
                                                                        "type": "string",
                                                                        "description": "Expression to group concurrent executions (e.g., by user ID)"
                                                                },
                                                                "concurrency_time_window_s": {
                                                                        "type": "number",
                                                                        "description": "Time window in seconds for concurrent_limit"
                                                                },
                                                                "debounce_delay_s": {
                                                                        "type": "number",
                                                                        "description": "Delay in seconds to debounce flow executions"
                                                                },
                                                                "debounce_key": {
                                                                        "type": "string",
                                                                        "description": "Expression to group debounced executions"
                                                                },
                                                                "debounce_args_to_accumulate": {
                                                                        "type": "array",
                                                                        "description": "Arguments to accumulate across debounced executions",
                                                                        "items": {
                                                                                "type": "string"
                                                                        }
                                                                },
                                                                "max_total_debouncing_time": {
                                                                        "type": "number",
                                                                        "description": "Maximum total time in seconds that a job can be debounced"
                                                                },
                                                                "max_total_debounces_amount": {
                                                                        "type": "number",
                                                                        "description": "Maximum number of times a job can be debounced"
                                                                },
                                                                "skip_expr": {
                                                                        "type": "string",
                                                                        "description": "JavaScript expression to conditionally skip the entire flow"
                                                                },
                                                                "cache_ttl": {
                                                                        "type": "number",
                                                                        "description": "Cache duration in seconds for flow results"
                                                                },
                                                                "cache_ignore_s3_path": {
                                                                        "type": "boolean"
                                                                },
                                                                "flow_env": {
                                                                        "type": "object",
                                                                        "description": "Environment variables available to all steps",
                                                                        "additionalProperties": {
                                                                                "type": "string"
                                                                        }
                                                                },
                                                                "priority": {
                                                                        "type": "number",
                                                                        "description": "Execution priority (higher numbers run first)"
                                                                },
                                                                "early_return": {
                                                                        "type": "string",
                                                                        "description": "JavaScript expression to return early from the flow"
                                                                },
                                                                "chat_input_enabled": {
                                                                        "type": "boolean",
                                                                        "description": "Whether this flow accepts chat-style input"
                                                                },
                                                                "notes": {
                                                                        "type": "array",
                                                                        "description": "Sticky notes attached to the flow",
                                                                        "items": {
                                                                                "type": "object",
                                                                                "description": "A sticky note attached to a flow for documentation and annotation",
                                                                                "properties": {
                                                                                        "id": {
                                                                                                "type": "string",
                                                                                                "description": "Unique identifier for the note"
                                                                                        },
                                                                                        "text": {
                                                                                                "type": "string",
                                                                                                "description": "Content of the note"
                                                                                        },
                                                                                        "position": {
                                                                                                "type": "object",
                                                                                                "description": "Position of the note in the flow editor",
                                                                                                "properties": {
                                                                                                        "x": {
                                                                                                                "type": "number",
                                                                                                                "description": "X coordinate"
                                                                                                        },
                                                                                                        "y": {
                                                                                                                "type": "number",
                                                                                                                "description": "Y coordinate"
                                                                                                        }
                                                                                                },
                                                                                                "required": [
                                                                                                        "x",
                                                                                                        "y"
                                                                                                ]
                                                                                        },
                                                                                        "size": {
                                                                                                "type": "object",
                                                                                                "description": "Size of the note in the flow editor",
                                                                                                "properties": {
                                                                                                        "width": {
                                                                                                                "type": "number",
                                                                                                                "description": "Width in pixels"
                                                                                                        },
                                                                                                        "height": {
                                                                                                                "type": "number",
                                                                                                                "description": "Height in pixels"
                                                                                                        }
                                                                                                },
                                                                                                "required": [
                                                                                                        "width",
                                                                                                        "height"
                                                                                                ]
                                                                                        },
                                                                                        "color": {
                                                                                                "type": "string",
                                                                                                "description": "Color of the note (e.g., \"yellow\", \"#ffff00\")"
                                                                                        },
                                                                                        "type": {
                                                                                                "type": "string",
                                                                                                "enum": [
                                                                                                        "free",
                                                                                                        "group"
                                                                                                ],
                                                                                                "description": "Type of note - 'free' for standalone notes, 'group' for notes that group other nodes"
                                                                                        },
                                                                                        "locked": {
                                                                                                "type": "boolean",
                                                                                                "default": false,
                                                                                                "description": "Whether the note is locked and cannot be edited or moved"
                                                                                        },
                                                                                        "contained_node_ids": {
                                                                                                "type": "array",
                                                                                                "items": {
                                                                                                        "type": "string"
                                                                                                },
                                                                                                "description": "For group notes, the IDs of nodes contained within this group"
                                                                                        }
                                                                                },
                                                                                "required": [
                                                                                        "id",
                                                                                        "text",
                                                                                        "color",
                                                                                        "type"
                                                                                ]
                                                                        }
                                                                }
                                                        },
                                                        "required": [
                                                                "modules"
                                                        ]
                                                },
                                                "schema": {
                                                        "type": "object",
                                                        "description": "JSON Schema for flow inputs. Use this to define input parameters, their types, defaults, and validation. For resource inputs, set type to 'object' and format to 'resource-<type>' (e.g., 'resource-stripe')"
                                                }
                                        },
                                        "required": [
                                                "summary",
                                                "value"
                                        ]
                                },
                                {
                                        "type": "object",
                                        "properties": {
                                                "path": {
                                                        "type": "string"
                                                },
                                                "tag": {
                                                        "type": "string"
                                                },
                                                "ws_error_handler_muted": {
                                                        "type": "boolean"
                                                },
                                                "priority": {
                                                        "type": "integer"
                                                },
                                                "dedicated_worker": {
                                                        "type": "boolean"
                                                },
                                                "timeout": {
                                                        "type": "number"
                                                },
                                                "visible_to_runner_only": {
                                                        "type": "boolean"
                                                },
                                                "on_behalf_of_email": {
                                                        "type": "string"
                                                }
                                        },
                                        "required": [
                                                "path"
                                        ]
                                }
                        ]
                },
                {
                        "type": "object",
                        "properties": {
                                "draft_only": {
                                        "type": "boolean"
                                },
                                "deployment_message": {
                                        "type": "string"
                                }
                        }
                }
        ]
}
    },
    {
        name: "updateFlow",
        description: "update flow",
        instructions: "",
        path: "/w/{workspace}/flows/update/{path}",
        method: "POST",
        pathParamsSchema: {
        "type": "object",
        "properties": {
                "path": {
                        "type": "string"
                }
        },
        "required": [
                "path"
        ]
},
        queryParamsSchema: undefined,
        bodySchema: {
        "allOf": [
                {
                        "allOf": [
                                {
                                        "type": "object",
                                        "description": "Top-level flow definition containing metadata, configuration, and the flow structure",
                                        "properties": {
                                                "summary": {
                                                        "type": "string",
                                                        "description": "Short description of what this flow does"
                                                },
                                                "description": {
                                                        "type": "string",
                                                        "description": "Detailed documentation for this flow"
                                                },
                                                "value": {
                                                        "type": "object",
                                                        "description": "The flow structure containing modules and optional preprocessor/failure handlers",
                                                        "properties": {
                                                                "modules": {
                                                                        "type": "array",
                                                                        "description": "Array of steps that execute in sequence. Each step can be a script, subflow, loop, or branch",
                                                                        "items": {
                                                                                "type": "object",
                                                                                "description": "A single step in a flow. Can be a script, subflow, loop, or branch",
                                                                                "properties": {
                                                                                        "id": {
                                                                                                "type": "string",
                                                                                                "description": "Unique identifier for this step. Used to reference results via 'results.step_id'. Must be a valid identifier (alphanumeric, underscore, hyphen)"
                                                                                        },
                                                                                        "value": {
                                                                                                "description": "The actual implementation of a flow step. Can be a script (inline or referenced), subflow, loop, branch, or special module type",
                                                                                                "oneOf": [
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "Inline script with code defined directly in the flow. Use 'bun' as default language if unspecified. The script receives arguments from input_transforms",
                                                                                                                "properties": {
                                                                                                                        "input_transforms": {
                                                                                                                                "type": "object",
                                                                                                                                "description": "Map of parameter names to their values (static or JavaScript expressions). These become the script's input arguments",
                                                                                                                                "additionalProperties": {
                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                        "oneOf": [
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                        "properties": {
                                                                                                                                                                "value": {
                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "static"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                        "properties": {
                                                                                                                                                                "expr": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "javascript"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "expr",
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                        "properties": {
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "ai"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "discriminator": {
                                                                                                                                                "propertyName": "type",
                                                                                                                                                "mapping": {
                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "content": {
                                                                                                                                "type": "string",
                                                                                                                                "description": "The script source code. Should export a 'main' function"
                                                                                                                        },
                                                                                                                        "language": {
                                                                                                                                "type": "string",
                                                                                                                                "description": "Programming language for this script",
                                                                                                                                "enum": [
                                                                                                                                        "deno",
                                                                                                                                        "bun",
                                                                                                                                        "python3",
                                                                                                                                        "go",
                                                                                                                                        "bash",
                                                                                                                                        "powershell",
                                                                                                                                        "postgresql",
                                                                                                                                        "mysql",
                                                                                                                                        "bigquery",
                                                                                                                                        "snowflake",
                                                                                                                                        "mssql",
                                                                                                                                        "oracledb",
                                                                                                                                        "graphql",
                                                                                                                                        "nativets",
                                                                                                                                        "php",
                                                                                                                                        "rust",
                                                                                                                                        "ansible",
                                                                                                                                        "csharp",
                                                                                                                                        "nu",
                                                                                                                                        "java",
                                                                                                                                        "ruby",
                                                                                                                                        "duckdb"
                                                                                                                                ]
                                                                                                                        },
                                                                                                                        "path": {
                                                                                                                                "type": "string",
                                                                                                                                "description": "Optional path for saving this script"
                                                                                                                        },
                                                                                                                        "lock": {
                                                                                                                                "type": "string",
                                                                                                                                "description": "Lock file content for dependencies"
                                                                                                                        },
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "rawscript"
                                                                                                                                ]
                                                                                                                        },
                                                                                                                        "tag": {
                                                                                                                                "type": "string",
                                                                                                                                "description": "Worker group tag for execution routing"
                                                                                                                        },
                                                                                                                        "concurrent_limit": {
                                                                                                                                "type": "number",
                                                                                                                                "description": "Maximum concurrent executions of this script"
                                                                                                                        },
                                                                                                                        "concurrency_time_window_s": {
                                                                                                                                "type": "number",
                                                                                                                                "description": "Time window for concurrent_limit"
                                                                                                                        },
                                                                                                                        "custom_concurrency_key": {
                                                                                                                                "type": "string",
                                                                                                                                "description": "Custom key for grouping concurrent executions"
                                                                                                                        },
                                                                                                                        "is_trigger": {
                                                                                                                                "type": "boolean",
                                                                                                                                "description": "If true, this script is a trigger that can start the flow"
                                                                                                                        },
                                                                                                                        "assets": {
                                                                                                                                "type": "array",
                                                                                                                                "description": "External resources this script accesses (S3 objects, resources, etc.)",
                                                                                                                                "items": {
                                                                                                                                        "type": "object",
                                                                                                                                        "required": [
                                                                                                                                                "path",
                                                                                                                                                "kind"
                                                                                                                                        ],
                                                                                                                                        "properties": {
                                                                                                                                                "path": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "description": "Path to the asset"
                                                                                                                                                },
                                                                                                                                                "kind": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "description": "Type of asset",
                                                                                                                                                        "enum": [
                                                                                                                                                                "s3object",
                                                                                                                                                                "resource",
                                                                                                                                                                "ducklake",
                                                                                                                                                                "datatable"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                "access_type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "nullable": true,
                                                                                                                                                        "description": "Access level for this asset",
                                                                                                                                                        "enum": [
                                                                                                                                                                "r",
                                                                                                                                                                "w",
                                                                                                                                                                "rw"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                "alt_access_type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "nullable": true,
                                                                                                                                                        "description": "Alternative access level",
                                                                                                                                                        "enum": [
                                                                                                                                                                "r",
                                                                                                                                                                "w",
                                                                                                                                                                "rw"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "type",
                                                                                                                        "content",
                                                                                                                        "language",
                                                                                                                        "input_transforms"
                                                                                                                ]
                                                                                                        },
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "Reference to an existing script by path. Use this when calling a previously saved script instead of writing inline code",
                                                                                                                "properties": {
                                                                                                                        "input_transforms": {
                                                                                                                                "type": "object",
                                                                                                                                "description": "Map of parameter names to their values (static or JavaScript expressions). These become the script's input arguments",
                                                                                                                                "additionalProperties": {
                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                        "oneOf": [
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                        "properties": {
                                                                                                                                                                "value": {
                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "static"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                        "properties": {
                                                                                                                                                                "expr": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "javascript"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "expr",
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                        "properties": {
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "ai"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "discriminator": {
                                                                                                                                                "propertyName": "type",
                                                                                                                                                "mapping": {
                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "path": {
                                                                                                                                "type": "string",
                                                                                                                                "description": "Path to the script in the workspace (e.g., 'f/scripts/send_email')"
                                                                                                                        },
                                                                                                                        "hash": {
                                                                                                                                "type": "string",
                                                                                                                                "description": "Optional specific version hash of the script to use"
                                                                                                                        },
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "script"
                                                                                                                                ]
                                                                                                                        },
                                                                                                                        "tag_override": {
                                                                                                                                "type": "string",
                                                                                                                                "description": "Override the script's default worker group tag"
                                                                                                                        },
                                                                                                                        "is_trigger": {
                                                                                                                                "type": "boolean",
                                                                                                                                "description": "If true, this script is a trigger that can start the flow"
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "type",
                                                                                                                        "path",
                                                                                                                        "input_transforms"
                                                                                                                ]
                                                                                                        },
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "Reference to an existing flow by path. Use this to call another flow as a subflow",
                                                                                                                "properties": {
                                                                                                                        "input_transforms": {
                                                                                                                                "type": "object",
                                                                                                                                "description": "Map of parameter names to their values (static or JavaScript expressions). These become the subflow's input arguments",
                                                                                                                                "additionalProperties": {
                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                        "oneOf": [
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                        "properties": {
                                                                                                                                                                "value": {
                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "static"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                        "properties": {
                                                                                                                                                                "expr": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "javascript"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "expr",
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                        "properties": {
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "ai"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "discriminator": {
                                                                                                                                                "propertyName": "type",
                                                                                                                                                "mapping": {
                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "path": {
                                                                                                                                "type": "string",
                                                                                                                                "description": "Path to the flow in the workspace (e.g., 'f/flows/process_user')"
                                                                                                                        },
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "flow"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "type",
                                                                                                                        "path",
                                                                                                                        "input_transforms"
                                                                                                                ]
                                                                                                        },
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "Executes nested modules in a loop over an iterator. Inside the loop, use 'flow_input.iter.value' to access the current iteration value, and 'flow_input.iter.index' for the index. Supports parallel execution for better performance on I/O-bound operations",
                                                                                                                "properties": {
                                                                                                                        "modules": {
                                                                                                                                "type": "array",
                                                                                                                                "description": "Steps to execute for each iteration. These can reference the iteration value via 'flow_input.iter.value'",
                                                                                                                                "items": {
                                                                                                                                        "type": "object"
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "iterator": {
                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                "oneOf": [
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                "properties": {
                                                                                                                                                        "value": {
                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "static"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                "properties": {
                                                                                                                                                        "expr": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "javascript"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "expr",
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                "properties": {
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "ai"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                ],
                                                                                                                                "discriminator": {
                                                                                                                                        "propertyName": "type",
                                                                                                                                        "mapping": {
                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "skip_failures": {
                                                                                                                                "type": "boolean",
                                                                                                                                "description": "If true, iteration failures don't stop the loop. Failed iterations return null"
                                                                                                                        },
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "forloopflow"
                                                                                                                                ]
                                                                                                                        },
                                                                                                                        "parallel": {
                                                                                                                                "type": "boolean",
                                                                                                                                "description": "If true, iterations run concurrently (faster for I/O-bound operations). Use with parallelism to control concurrency"
                                                                                                                        },
                                                                                                                        "parallelism": {
                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                "oneOf": [
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                "properties": {
                                                                                                                                                        "value": {
                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "static"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                "properties": {
                                                                                                                                                        "expr": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "javascript"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "expr",
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                "properties": {
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "ai"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                ],
                                                                                                                                "discriminator": {
                                                                                                                                        "propertyName": "type",
                                                                                                                                        "mapping": {
                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "squash": {
                                                                                                                                "type": "boolean"
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "modules",
                                                                                                                        "iterator",
                                                                                                                        "skip_failures",
                                                                                                                        "type"
                                                                                                                ]
                                                                                                        },
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "Executes nested modules repeatedly while a condition is true. The loop checks the condition after each iteration. Use stop_after_if on modules to control loop termination",
                                                                                                                "properties": {
                                                                                                                        "modules": {
                                                                                                                                "type": "array",
                                                                                                                                "description": "Steps to execute in each iteration. Use stop_after_if to control when the loop ends",
                                                                                                                                "items": {
                                                                                                                                        "type": "object"
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "skip_failures": {
                                                                                                                                "type": "boolean",
                                                                                                                                "description": "If true, iteration failures don't stop the loop. Failed iterations return null"
                                                                                                                        },
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "whileloopflow"
                                                                                                                                ]
                                                                                                                        },
                                                                                                                        "parallel": {
                                                                                                                                "type": "boolean",
                                                                                                                                "description": "If true, iterations run concurrently (use with caution in while loops)"
                                                                                                                        },
                                                                                                                        "parallelism": {
                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                "oneOf": [
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                "properties": {
                                                                                                                                                        "value": {
                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "static"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                "properties": {
                                                                                                                                                        "expr": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "javascript"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "expr",
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                "properties": {
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "ai"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                ],
                                                                                                                                "discriminator": {
                                                                                                                                        "propertyName": "type",
                                                                                                                                        "mapping": {
                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "squash": {
                                                                                                                                "type": "boolean"
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "modules",
                                                                                                                        "skip_failures",
                                                                                                                        "type"
                                                                                                                ]
                                                                                                        },
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "Conditional branching where only the first matching branch executes. Branches are evaluated in order, and the first one with a true expression runs. If no branches match, the default branch executes",
                                                                                                                "properties": {
                                                                                                                        "branches": {
                                                                                                                                "type": "array",
                                                                                                                                "description": "Array of branches to evaluate in order. The first branch with expr evaluating to true executes",
                                                                                                                                "items": {
                                                                                                                                        "type": "object",
                                                                                                                                        "properties": {
                                                                                                                                                "summary": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "description": "Short description of this branch condition"
                                                                                                                                                },
                                                                                                                                                "expr": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "description": "JavaScript expression that returns boolean. Can use 'results.step_id' or 'flow_input'. First true expr wins"
                                                                                                                                                },
                                                                                                                                                "modules": {
                                                                                                                                                        "type": "array",
                                                                                                                                                        "description": "Steps to execute if this branch's expr is true",
                                                                                                                                                        "items": {
                                                                                                                                                                "type": "object"
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "modules",
                                                                                                                                                "expr"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "default": {
                                                                                                                                "type": "array",
                                                                                                                                "description": "Steps to execute if no branch expressions match",
                                                                                                                                "items": {
                                                                                                                                        "type": "object"
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "branchone"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "branches",
                                                                                                                        "default",
                                                                                                                        "type"
                                                                                                                ]
                                                                                                        },
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "Parallel branching where all branches execute simultaneously. Unlike BranchOne, all branches run regardless of conditions. Useful for executing independent tasks concurrently",
                                                                                                                "properties": {
                                                                                                                        "branches": {
                                                                                                                                "type": "array",
                                                                                                                                "description": "Array of branches that all execute (either in parallel or sequentially)",
                                                                                                                                "items": {
                                                                                                                                        "type": "object",
                                                                                                                                        "properties": {
                                                                                                                                                "summary": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "description": "Short description of this branch's purpose"
                                                                                                                                                },
                                                                                                                                                "skip_failure": {
                                                                                                                                                        "type": "boolean",
                                                                                                                                                        "description": "If true, failure in this branch doesn't fail the entire flow"
                                                                                                                                                },
                                                                                                                                                "modules": {
                                                                                                                                                        "type": "array",
                                                                                                                                                        "description": "Steps to execute in this branch",
                                                                                                                                                        "items": {
                                                                                                                                                                "type": "object"
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "modules"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "branchall"
                                                                                                                                ]
                                                                                                                        },
                                                                                                                        "parallel": {
                                                                                                                                "type": "boolean",
                                                                                                                                "description": "If true, all branches execute concurrently. If false, they execute sequentially"
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "branches",
                                                                                                                        "type"
                                                                                                                ]
                                                                                                        },
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "Pass-through module that returns its input unchanged. Useful for flow structure or as a placeholder",
                                                                                                                "properties": {
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "identity"
                                                                                                                                ]
                                                                                                                        },
                                                                                                                        "flow": {
                                                                                                                                "type": "boolean",
                                                                                                                                "description": "If true, marks this as a flow identity (special handling)"
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "type"
                                                                                                                ]
                                                                                                        },
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "AI agent step that can use tools to accomplish tasks. The agent receives inputs and can call any of its configured tools to complete the task",
                                                                                                                "properties": {
                                                                                                                        "input_transforms": {
                                                                                                                                "type": "object",
                                                                                                                                "description": "Input parameters for the AI agent mapped to their values",
                                                                                                                                "properties": {
                                                                                                                                        "provider": {
                                                                                                                                                "description": "Provider configuration - can be static (ProviderConfig), JavaScript expression, or AI-determined",
                                                                                                                                                "oneOf": [
                                                                                                                                                        {
                                                                                                                                                                "type": "object",
                                                                                                                                                                "description": "Static provider configuration passed directly to the AI agent",
                                                                                                                                                                "properties": {
                                                                                                                                                                        "value": {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Complete AI provider configuration with resource reference and model selection",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "kind": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "description": "Supported AI provider types",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "openai",
                                                                                                                                                                                                        "azure_openai",
                                                                                                                                                                                                        "anthropic",
                                                                                                                                                                                                        "mistral",
                                                                                                                                                                                                        "deepseek",
                                                                                                                                                                                                        "googleai",
                                                                                                                                                                                                        "groq",
                                                                                                                                                                                                        "openrouter",
                                                                                                                                                                                                        "togetherai",
                                                                                                                                                                                                        "customai",
                                                                                                                                                                                                        "aws_bedrock"
                                                                                                                                                                                                ]
                                                                                                                                                                                        },
                                                                                                                                                                                        "resource": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "description": "Resource reference in format '$res:{resource_path}' pointing to provider credentials"
                                                                                                                                                                                        },
                                                                                                                                                                                        "model": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "description": "Model identifier (e.g., 'gpt-4', 'claude-3-opus-20240229', 'gemini-pro')"
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "kind",
                                                                                                                                                                                        "resource",
                                                                                                                                                                                        "model"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        "type": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "enum": [
                                                                                                                                                                                        "static"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                },
                                                                                                                                                                "required": [
                                                                                                                                                                        "type",
                                                                                                                                                                        "value"
                                                                                                                                                                ]
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                                "type": "object",
                                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                "properties": {
                                                                                                                                                                        "expr": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                        },
                                                                                                                                                                        "type": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "enum": [
                                                                                                                                                                                        "javascript"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                },
                                                                                                                                                                "required": [
                                                                                                                                                                        "expr",
                                                                                                                                                                        "type"
                                                                                                                                                                ]
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                                "type": "object",
                                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                "properties": {
                                                                                                                                                                        "type": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "enum": [
                                                                                                                                                                                        "ai"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                },
                                                                                                                                                                "required": [
                                                                                                                                                                        "type"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                ],
                                                                                                                                                "discriminator": {
                                                                                                                                                        "propertyName": "type",
                                                                                                                                                        "mapping": {
                                                                                                                                                                "static": "#/components/schemas/StaticProviderTransform",
                                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "output_type": {
                                                                                                                                                "allOf": [
                                                                                                                                                        {
                                                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                                "oneOf": [
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "value": {
                                                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "static"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "expr": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "javascript"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "expr",
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "ai"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                ],
                                                                                                                                                                "discriminator": {
                                                                                                                                                                        "propertyName": "type",
                                                                                                                                                                        "mapping": {
                                                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                        }
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                ],
                                                                                                                                                "description": "Output format type.\nValid values: 'text' (default) - plain text response, 'image' - image generation\n"
                                                                                                                                        },
                                                                                                                                        "user_message": {
                                                                                                                                                "allOf": [
                                                                                                                                                        {
                                                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                                "oneOf": [
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "value": {
                                                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "static"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "expr": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "javascript"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "expr",
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "ai"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                ],
                                                                                                                                                                "discriminator": {
                                                                                                                                                                        "propertyName": "type",
                                                                                                                                                                        "mapping": {
                                                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                        }
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                ],
                                                                                                                                                "description": "The user's prompt/message to the AI agent. Supports variable interpolation with flow.input syntax."
                                                                                                                                        },
                                                                                                                                        "system_prompt": {
                                                                                                                                                "allOf": [
                                                                                                                                                        {
                                                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                                "oneOf": [
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "value": {
                                                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "static"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "expr": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "javascript"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "expr",
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "ai"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                ],
                                                                                                                                                                "discriminator": {
                                                                                                                                                                        "propertyName": "type",
                                                                                                                                                                        "mapping": {
                                                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                        }
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                ],
                                                                                                                                                "description": "System instructions that guide the AI's behavior, persona, and response style. Optional."
                                                                                                                                        },
                                                                                                                                        "streaming": {
                                                                                                                                                "allOf": [
                                                                                                                                                        {
                                                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                                "oneOf": [
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "value": {
                                                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "static"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "expr": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "javascript"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "expr",
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "ai"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                ],
                                                                                                                                                                "discriminator": {
                                                                                                                                                                        "propertyName": "type",
                                                                                                                                                                        "mapping": {
                                                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                        }
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                ],
                                                                                                                                                "description": "Boolean. If true, stream the AI response incrementally.\nStreaming events include: token_delta, tool_call, tool_call_arguments, tool_execution, tool_result\n"
                                                                                                                                        },
                                                                                                                                        "memory": {
                                                                                                                                                "description": "Memory configuration - can be static (MemoryConfig), JavaScript expression, or AI-determined",
                                                                                                                                                "oneOf": [
                                                                                                                                                        {
                                                                                                                                                                "type": "object",
                                                                                                                                                                "description": "Static memory configuration passed directly to the AI agent",
                                                                                                                                                                "properties": {
                                                                                                                                                                        "value": {
                                                                                                                                                                                "description": "Conversation memory configuration",
                                                                                                                                                                                "oneOf": [
                                                                                                                                                                                        {
                                                                                                                                                                                                "type": "object",
                                                                                                                                                                                                "description": "No conversation memory/context",
                                                                                                                                                                                                "properties": {
                                                                                                                                                                                                        "kind": {
                                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                                        "off"
                                                                                                                                                                                                                ]
                                                                                                                                                                                                        }
                                                                                                                                                                                                },
                                                                                                                                                                                                "required": [
                                                                                                                                                                                                        "kind"
                                                                                                                                                                                                ]
                                                                                                                                                                                        },
                                                                                                                                                                                        {
                                                                                                                                                                                                "type": "object",
                                                                                                                                                                                                "description": "Automatic context management",
                                                                                                                                                                                                "properties": {
                                                                                                                                                                                                        "kind": {
                                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                                        "auto"
                                                                                                                                                                                                                ]
                                                                                                                                                                                                        },
                                                                                                                                                                                                        "context_length": {
                                                                                                                                                                                                                "type": "integer",
                                                                                                                                                                                                                "description": "Maximum number of messages to retain in context"
                                                                                                                                                                                                        },
                                                                                                                                                                                                        "memory_id": {
                                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                                "description": "Identifier for persistent memory across agent invocations"
                                                                                                                                                                                                        }
                                                                                                                                                                                                },
                                                                                                                                                                                                "required": [
                                                                                                                                                                                                        "kind"
                                                                                                                                                                                                ]
                                                                                                                                                                                        },
                                                                                                                                                                                        {
                                                                                                                                                                                                "type": "object",
                                                                                                                                                                                                "description": "Explicit message history",
                                                                                                                                                                                                "properties": {
                                                                                                                                                                                                        "kind": {
                                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                                        "manual"
                                                                                                                                                                                                                ]
                                                                                                                                                                                                        },
                                                                                                                                                                                                        "messages": {
                                                                                                                                                                                                                "type": "array",
                                                                                                                                                                                                                "items": {
                                                                                                                                                                                                                        "type": "object",
                                                                                                                                                                                                                        "description": "A single message in conversation history",
                                                                                                                                                                                                                        "properties": {
                                                                                                                                                                                                                                "role": {
                                                                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                                                                "user",
                                                                                                                                                                                                                                                "assistant",
                                                                                                                                                                                                                                                "system"
                                                                                                                                                                                                                                        ]
                                                                                                                                                                                                                                },
                                                                                                                                                                                                                                "content": {
                                                                                                                                                                                                                                        "type": "string"
                                                                                                                                                                                                                                }
                                                                                                                                                                                                                        },
                                                                                                                                                                                                                        "required": [
                                                                                                                                                                                                                                "role",
                                                                                                                                                                                                                                "content"
                                                                                                                                                                                                                        ]
                                                                                                                                                                                                                }
                                                                                                                                                                                                        }
                                                                                                                                                                                                },
                                                                                                                                                                                                "required": [
                                                                                                                                                                                                        "kind",
                                                                                                                                                                                                        "messages"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                ],
                                                                                                                                                                                "discriminator": {
                                                                                                                                                                                        "propertyName": "kind",
                                                                                                                                                                                        "mapping": {
                                                                                                                                                                                                "off": "#/components/schemas/MemoryOff",
                                                                                                                                                                                                "auto": "#/components/schemas/MemoryAuto",
                                                                                                                                                                                                "manual": "#/components/schemas/MemoryManual"
                                                                                                                                                                                        }
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "type": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "enum": [
                                                                                                                                                                                        "static"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                },
                                                                                                                                                                "required": [
                                                                                                                                                                        "type",
                                                                                                                                                                        "value"
                                                                                                                                                                ]
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                                "type": "object",
                                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                "properties": {
                                                                                                                                                                        "expr": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                        },
                                                                                                                                                                        "type": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "enum": [
                                                                                                                                                                                        "javascript"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                },
                                                                                                                                                                "required": [
                                                                                                                                                                        "expr",
                                                                                                                                                                        "type"
                                                                                                                                                                ]
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                                "type": "object",
                                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                "properties": {
                                                                                                                                                                        "type": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "enum": [
                                                                                                                                                                                        "ai"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                },
                                                                                                                                                                "required": [
                                                                                                                                                                        "type"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                ],
                                                                                                                                                "discriminator": {
                                                                                                                                                        "propertyName": "type",
                                                                                                                                                        "mapping": {
                                                                                                                                                                "static": "#/components/schemas/StaticMemoryTransform",
                                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "output_schema": {
                                                                                                                                                "allOf": [
                                                                                                                                                        {
                                                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                                "oneOf": [
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "value": {
                                                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "static"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "expr": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "javascript"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "expr",
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "ai"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                ],
                                                                                                                                                                "discriminator": {
                                                                                                                                                                        "propertyName": "type",
                                                                                                                                                                        "mapping": {
                                                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                        }
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                ],
                                                                                                                                                "description": "JSON Schema object defining structured output format. Used when you need the AI to return data in a specific shape.\nSupports standard JSON Schema properties: type, properties, required, items, enum, pattern, minLength, maxLength, minimum, maximum, etc.\nExample: { type: 'object', properties: { name: { type: 'string' }, age: { type: 'integer' } }, required: ['name'] }\n"
                                                                                                                                        },
                                                                                                                                        "user_images": {
                                                                                                                                                "allOf": [
                                                                                                                                                        {
                                                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                                "oneOf": [
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "value": {
                                                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "static"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "expr": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "javascript"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "expr",
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "ai"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                ],
                                                                                                                                                                "discriminator": {
                                                                                                                                                                        "propertyName": "type",
                                                                                                                                                                        "mapping": {
                                                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                        }
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                ],
                                                                                                                                                "description": "Array of image references for vision-capable models.\nFormat: Array<{ bucket: string, key: string }> - S3 object references\nExample: [{ bucket: 'my-bucket', key: 'images/photo.jpg' }]\n"
                                                                                                                                        },
                                                                                                                                        "max_completion_tokens": {
                                                                                                                                                "allOf": [
                                                                                                                                                        {
                                                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                                "oneOf": [
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "value": {
                                                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "static"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "expr": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "javascript"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "expr",
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "ai"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                ],
                                                                                                                                                                "discriminator": {
                                                                                                                                                                        "propertyName": "type",
                                                                                                                                                                        "mapping": {
                                                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                        }
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                ],
                                                                                                                                                "description": "Integer. Maximum number of tokens the AI will generate in its response.\nRange: 1 to 4,294,967,295. Typical values: 256-4096 for most use cases.\n"
                                                                                                                                        },
                                                                                                                                        "temperature": {
                                                                                                                                                "allOf": [
                                                                                                                                                        {
                                                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                                "oneOf": [
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "value": {
                                                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "static"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "expr": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                        },
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "javascript"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "expr",
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "ai"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "type"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                ],
                                                                                                                                                                "discriminator": {
                                                                                                                                                                        "propertyName": "type",
                                                                                                                                                                        "mapping": {
                                                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                        }
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                ],
                                                                                                                                                "description": "Float. Controls randomness/creativity of responses.\nRange: 0.0 to 2.0 (provider-dependent)\n- 0.0 = deterministic, focused responses\n- 0.7 = balanced (common default)\n- 1.0+ = more creative/random\n"
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "required": [
                                                                                                                                        "provider",
                                                                                                                                        "user_message",
                                                                                                                                        "output_type"
                                                                                                                                ]
                                                                                                                        },
                                                                                                                        "tools": {
                                                                                                                                "type": "array",
                                                                                                                                "description": "Array of tools the agent can use. The agent decides which tools to call based on the task",
                                                                                                                                "items": {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "A tool available to an AI agent. Can be a flow module or an external MCP (Model Context Protocol) tool",
                                                                                                                                        "properties": {
                                                                                                                                                "id": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "description": "Unique identifier for this tool. Cannot contain spaces - use underscores instead (e.g., 'get_user_data' not 'get user data')"
                                                                                                                                                },
                                                                                                                                                "summary": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "description": "Short description of what this tool does (shown to the AI)"
                                                                                                                                                },
                                                                                                                                                "value": {
                                                                                                                                                        "description": "The implementation of a tool. Can be a flow module (script/flow) or an MCP tool reference",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "description": "A tool implemented as a flow module (script, flow, etc.). The AI can call this like any other flow module",
                                                                                                                                                                        "allOf": [
                                                                                                                                                                                {
                                                                                                                                                                                        "type": "object",
                                                                                                                                                                                        "properties": {
                                                                                                                                                                                                "tool_type": {
                                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                                "flowmodule"
                                                                                                                                                                                                        ]
                                                                                                                                                                                                }
                                                                                                                                                                                        },
                                                                                                                                                                                        "required": [
                                                                                                                                                                                                "tool_type"
                                                                                                                                                                                        ]
                                                                                                                                                                                },
                                                                                                                                                                                {
                                                                                                                                                                                        "type": "object"
                                                                                                                                                                                }
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Reference to an external MCP (Model Context Protocol) tool. The AI can call tools from MCP servers",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "tool_type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "mcp"
                                                                                                                                                                                        ]
                                                                                                                                                                                },
                                                                                                                                                                                "resource_path": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "Path to the MCP resource/server configuration"
                                                                                                                                                                                },
                                                                                                                                                                                "include_tools": {
                                                                                                                                                                                        "type": "array",
                                                                                                                                                                                        "description": "Whitelist of specific tools to include from this MCP server",
                                                                                                                                                                                        "items": {
                                                                                                                                                                                                "type": "string"
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "exclude_tools": {
                                                                                                                                                                                        "type": "array",
                                                                                                                                                                                        "description": "Blacklist of tools to exclude from this MCP server",
                                                                                                                                                                                        "items": {
                                                                                                                                                                                                "type": "string"
                                                                                                                                                                                        }
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "tool_type",
                                                                                                                                                                                "resource_path"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "A tool implemented as a websearch tool. The AI can call this like any other websearch tool",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "tool_type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "websearch"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "tool_type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "tool_type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "flowmodule": "#/components/schemas/FlowModuleTool",
                                                                                                                                                                        "mcp": "#/components/schemas/McpToolValue",
                                                                                                                                                                        "websearch": "#/components/schemas/WebsearchToolValue"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "id",
                                                                                                                                                "value"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "aiagent"
                                                                                                                                ]
                                                                                                                        },
                                                                                                                        "parallel": {
                                                                                                                                "type": "boolean",
                                                                                                                                "description": "If true, the agent can execute multiple tool calls in parallel"
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "tools",
                                                                                                                        "type",
                                                                                                                        "input_transforms"
                                                                                                                ]
                                                                                                        }
                                                                                                ],
                                                                                                "discriminator": {
                                                                                                        "propertyName": "type",
                                                                                                        "mapping": {
                                                                                                                "rawscript": "#/components/schemas/RawScript",
                                                                                                                "script": "#/components/schemas/PathScript",
                                                                                                                "flow": "#/components/schemas/PathFlow",
                                                                                                                "forloopflow": "#/components/schemas/ForloopFlow",
                                                                                                                "whileloopflow": "#/components/schemas/WhileloopFlow",
                                                                                                                "branchone": "#/components/schemas/BranchOne",
                                                                                                                "branchall": "#/components/schemas/BranchAll",
                                                                                                                "identity": "#/components/schemas/Identity",
                                                                                                                "aiagent": "#/components/schemas/AiAgent"
                                                                                                        }
                                                                                                }
                                                                                        },
                                                                                        "stop_after_if": {
                                                                                                "type": "object",
                                                                                                "description": "Early termination condition for a module",
                                                                                                "properties": {
                                                                                                        "skip_if_stopped": {
                                                                                                                "type": "boolean",
                                                                                                                "description": "If true, following steps are skipped when this condition triggers"
                                                                                                        },
                                                                                                        "expr": {
                                                                                                                "type": "string",
                                                                                                                "description": "JavaScript expression evaluated after the module runs. Can use 'result' (step's result) or 'flow_input'. Return true to stop"
                                                                                                        },
                                                                                                        "error_message": {
                                                                                                                "type": "string",
                                                                                                                "description": "Custom error message shown when stopping"
                                                                                                        }
                                                                                                },
                                                                                                "required": [
                                                                                                        "expr"
                                                                                                ]
                                                                                        },
                                                                                        "stop_after_all_iters_if": {
                                                                                                "type": "object",
                                                                                                "description": "Early termination condition for a module",
                                                                                                "properties": {
                                                                                                        "skip_if_stopped": {
                                                                                                                "type": "boolean",
                                                                                                                "description": "If true, following steps are skipped when this condition triggers"
                                                                                                        },
                                                                                                        "expr": {
                                                                                                                "type": "string",
                                                                                                                "description": "JavaScript expression evaluated after the module runs. Can use 'result' (step's result) or 'flow_input'. Return true to stop"
                                                                                                        },
                                                                                                        "error_message": {
                                                                                                                "type": "string",
                                                                                                                "description": "Custom error message shown when stopping"
                                                                                                        }
                                                                                                },
                                                                                                "required": [
                                                                                                        "expr"
                                                                                                ]
                                                                                        },
                                                                                        "skip_if": {
                                                                                                "type": "object",
                                                                                                "description": "Conditionally skip this step based on previous results or flow inputs",
                                                                                                "properties": {
                                                                                                        "expr": {
                                                                                                                "type": "string",
                                                                                                                "description": "JavaScript expression that returns true to skip. Can use 'flow_input' or 'results.<step_id>'"
                                                                                                        }
                                                                                                },
                                                                                                "required": [
                                                                                                        "expr"
                                                                                                ]
                                                                                        },
                                                                                        "sleep": {
                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                "oneOf": [
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                "properties": {
                                                                                                                        "value": {
                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                        },
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "static"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "type"
                                                                                                                ]
                                                                                                        },
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                "properties": {
                                                                                                                        "expr": {
                                                                                                                                "type": "string",
                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                        },
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "javascript"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "expr",
                                                                                                                        "type"
                                                                                                                ]
                                                                                                        },
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                "properties": {
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "ai"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "type"
                                                                                                                ]
                                                                                                        }
                                                                                                ],
                                                                                                "discriminator": {
                                                                                                        "propertyName": "type",
                                                                                                        "mapping": {
                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                        }
                                                                                                }
                                                                                        },
                                                                                        "cache_ttl": {
                                                                                                "type": "number",
                                                                                                "description": "Cache duration in seconds for this step's results"
                                                                                        },
                                                                                        "cache_ignore_s3_path": {
                                                                                                "type": "boolean"
                                                                                        },
                                                                                        "timeout": {
                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                "oneOf": [
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                "properties": {
                                                                                                                        "value": {
                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                        },
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "static"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "type"
                                                                                                                ]
                                                                                                        },
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                "properties": {
                                                                                                                        "expr": {
                                                                                                                                "type": "string",
                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                        },
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "javascript"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "expr",
                                                                                                                        "type"
                                                                                                                ]
                                                                                                        },
                                                                                                        {
                                                                                                                "type": "object",
                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                "properties": {
                                                                                                                        "type": {
                                                                                                                                "type": "string",
                                                                                                                                "enum": [
                                                                                                                                        "ai"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "type"
                                                                                                                ]
                                                                                                        }
                                                                                                ],
                                                                                                "discriminator": {
                                                                                                        "propertyName": "type",
                                                                                                        "mapping": {
                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                        }
                                                                                                }
                                                                                        },
                                                                                        "delete_after_use": {
                                                                                                "type": "boolean",
                                                                                                "description": "If true, this step's result is deleted after use to save memory"
                                                                                        },
                                                                                        "summary": {
                                                                                                "type": "string",
                                                                                                "description": "Short description of what this step does"
                                                                                        },
                                                                                        "mock": {
                                                                                                "type": "object",
                                                                                                "description": "Mock configuration for testing without executing the actual step",
                                                                                                "properties": {
                                                                                                        "enabled": {
                                                                                                                "type": "boolean",
                                                                                                                "description": "If true, return mock value instead of executing"
                                                                                                        },
                                                                                                        "return_value": {
                                                                                                                "description": "Value to return when mocked"
                                                                                                        }
                                                                                                }
                                                                                        },
                                                                                        "suspend": {
                                                                                                "type": "object",
                                                                                                "description": "Configuration for approval/resume steps that wait for user input",
                                                                                                "properties": {
                                                                                                        "required_events": {
                                                                                                                "type": "integer",
                                                                                                                "description": "Number of approvals required before continuing"
                                                                                                        },
                                                                                                        "timeout": {
                                                                                                                "type": "integer",
                                                                                                                "description": "Timeout in seconds before auto-continuing or canceling"
                                                                                                        },
                                                                                                        "resume_form": {
                                                                                                                "type": "object",
                                                                                                                "description": "Form schema for collecting input when resuming",
                                                                                                                "properties": {
                                                                                                                        "schema": {
                                                                                                                                "type": "object",
                                                                                                                                "description": "JSON Schema for the resume form"
                                                                                                                        }
                                                                                                                }
                                                                                                        },
                                                                                                        "user_auth_required": {
                                                                                                                "type": "boolean",
                                                                                                                "description": "If true, only authenticated users can approve"
                                                                                                        },
                                                                                                        "user_groups_required": {
                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                "oneOf": [
                                                                                                                        {
                                                                                                                                "type": "object",
                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                "properties": {
                                                                                                                                        "value": {
                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                        },
                                                                                                                                        "type": {
                                                                                                                                                "type": "string",
                                                                                                                                                "enum": [
                                                                                                                                                        "static"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "required": [
                                                                                                                                        "type"
                                                                                                                                ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                                "type": "object",
                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                "properties": {
                                                                                                                                        "expr": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                        },
                                                                                                                                        "type": {
                                                                                                                                                "type": "string",
                                                                                                                                                "enum": [
                                                                                                                                                        "javascript"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "required": [
                                                                                                                                        "expr",
                                                                                                                                        "type"
                                                                                                                                ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                                "type": "object",
                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                "properties": {
                                                                                                                                        "type": {
                                                                                                                                                "type": "string",
                                                                                                                                                "enum": [
                                                                                                                                                        "ai"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "required": [
                                                                                                                                        "type"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                ],
                                                                                                                "discriminator": {
                                                                                                                        "propertyName": "type",
                                                                                                                        "mapping": {
                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                        }
                                                                                                                }
                                                                                                        },
                                                                                                        "self_approval_disabled": {
                                                                                                                "type": "boolean",
                                                                                                                "description": "If true, the user who started the flow cannot approve"
                                                                                                        },
                                                                                                        "hide_cancel": {
                                                                                                                "type": "boolean",
                                                                                                                "description": "If true, hide the cancel button on the approval form"
                                                                                                        },
                                                                                                        "continue_on_disapprove_timeout": {
                                                                                                                "type": "boolean",
                                                                                                                "description": "If true, continue flow on timeout instead of canceling"
                                                                                                        }
                                                                                                }
                                                                                        },
                                                                                        "priority": {
                                                                                                "type": "number",
                                                                                                "description": "Execution priority for this step (higher numbers run first)"
                                                                                        },
                                                                                        "continue_on_error": {
                                                                                                "type": "boolean",
                                                                                                "description": "If true, flow continues even if this step fails"
                                                                                        },
                                                                                        "retry": {
                                                                                                "type": "object",
                                                                                                "description": "Retry configuration for failed module executions",
                                                                                                "properties": {
                                                                                                        "constant": {
                                                                                                                "type": "object",
                                                                                                                "description": "Retry with constant delay between attempts",
                                                                                                                "properties": {
                                                                                                                        "attempts": {
                                                                                                                                "type": "integer",
                                                                                                                                "description": "Number of retry attempts"
                                                                                                                        },
                                                                                                                        "seconds": {
                                                                                                                                "type": "integer",
                                                                                                                                "description": "Seconds to wait between retries"
                                                                                                                        }
                                                                                                                }
                                                                                                        },
                                                                                                        "exponential": {
                                                                                                                "type": "object",
                                                                                                                "description": "Retry with exponential backoff (delay doubles each time)",
                                                                                                                "properties": {
                                                                                                                        "attempts": {
                                                                                                                                "type": "integer",
                                                                                                                                "description": "Number of retry attempts"
                                                                                                                        },
                                                                                                                        "multiplier": {
                                                                                                                                "type": "integer",
                                                                                                                                "description": "Multiplier for exponential backoff"
                                                                                                                        },
                                                                                                                        "seconds": {
                                                                                                                                "type": "integer",
                                                                                                                                "minimum": 1,
                                                                                                                                "description": "Initial delay in seconds"
                                                                                                                        },
                                                                                                                        "random_factor": {
                                                                                                                                "type": "integer",
                                                                                                                                "minimum": 0,
                                                                                                                                "maximum": 100,
                                                                                                                                "description": "Random jitter percentage (0-100) to avoid thundering herd"
                                                                                                                        }
                                                                                                                }
                                                                                                        },
                                                                                                        "retry_if": {
                                                                                                                "type": "object",
                                                                                                                "description": "Conditional retry based on error or result",
                                                                                                                "properties": {
                                                                                                                        "expr": {
                                                                                                                                "type": "string",
                                                                                                                                "description": "JavaScript expression that returns true to retry. Has access to 'result' and 'error' variables"
                                                                                                                        }
                                                                                                                },
                                                                                                                "required": [
                                                                                                                        "expr"
                                                                                                                ]
                                                                                                        }
                                                                                                }
                                                                                        }
                                                                                },
                                                                                "required": [
                                                                                        "value",
                                                                                        "id"
                                                                                ]
                                                                        }
                                                                },
                                                                "failure_module": {
                                                                        "type": "object",
                                                                        "description": "A single step in a flow. Can be a script, subflow, loop, or branch",
                                                                        "properties": {
                                                                                "id": {
                                                                                        "type": "string",
                                                                                        "description": "Unique identifier for this step. Used to reference results via 'results.step_id'. Must be a valid identifier (alphanumeric, underscore, hyphen)"
                                                                                },
                                                                                "value": {
                                                                                        "description": "The actual implementation of a flow step. Can be a script (inline or referenced), subflow, loop, branch, or special module type",
                                                                                        "oneOf": [
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Inline script with code defined directly in the flow. Use 'bun' as default language if unspecified. The script receives arguments from input_transforms",
                                                                                                        "properties": {
                                                                                                                "input_transforms": {
                                                                                                                        "type": "object",
                                                                                                                        "description": "Map of parameter names to their values (static or JavaScript expressions). These become the script's input arguments",
                                                                                                                        "additionalProperties": {
                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                "oneOf": [
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                "properties": {
                                                                                                                                                        "value": {
                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "static"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                "properties": {
                                                                                                                                                        "expr": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "javascript"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "expr",
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                "properties": {
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "ai"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                ],
                                                                                                                                "discriminator": {
                                                                                                                                        "propertyName": "type",
                                                                                                                                        "mapping": {
                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        }
                                                                                                                },
                                                                                                                "content": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "The script source code. Should export a 'main' function"
                                                                                                                },
                                                                                                                "language": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Programming language for this script",
                                                                                                                        "enum": [
                                                                                                                                "deno",
                                                                                                                                "bun",
                                                                                                                                "python3",
                                                                                                                                "go",
                                                                                                                                "bash",
                                                                                                                                "powershell",
                                                                                                                                "postgresql",
                                                                                                                                "mysql",
                                                                                                                                "bigquery",
                                                                                                                                "snowflake",
                                                                                                                                "mssql",
                                                                                                                                "oracledb",
                                                                                                                                "graphql",
                                                                                                                                "nativets",
                                                                                                                                "php",
                                                                                                                                "rust",
                                                                                                                                "ansible",
                                                                                                                                "csharp",
                                                                                                                                "nu",
                                                                                                                                "java",
                                                                                                                                "ruby",
                                                                                                                                "duckdb"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "path": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Optional path for saving this script"
                                                                                                                },
                                                                                                                "lock": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Lock file content for dependencies"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "rawscript"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "tag": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Worker group tag for execution routing"
                                                                                                                },
                                                                                                                "concurrent_limit": {
                                                                                                                        "type": "number",
                                                                                                                        "description": "Maximum concurrent executions of this script"
                                                                                                                },
                                                                                                                "concurrency_time_window_s": {
                                                                                                                        "type": "number",
                                                                                                                        "description": "Time window for concurrent_limit"
                                                                                                                },
                                                                                                                "custom_concurrency_key": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Custom key for grouping concurrent executions"
                                                                                                                },
                                                                                                                "is_trigger": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, this script is a trigger that can start the flow"
                                                                                                                },
                                                                                                                "assets": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "External resources this script accesses (S3 objects, resources, etc.)",
                                                                                                                        "items": {
                                                                                                                                "type": "object",
                                                                                                                                "required": [
                                                                                                                                        "path",
                                                                                                                                        "kind"
                                                                                                                                ],
                                                                                                                                "properties": {
                                                                                                                                        "path": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "Path to the asset"
                                                                                                                                        },
                                                                                                                                        "kind": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "Type of asset",
                                                                                                                                                "enum": [
                                                                                                                                                        "s3object",
                                                                                                                                                        "resource",
                                                                                                                                                        "ducklake",
                                                                                                                                                        "datatable"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        "access_type": {
                                                                                                                                                "type": "string",
                                                                                                                                                "nullable": true,
                                                                                                                                                "description": "Access level for this asset",
                                                                                                                                                "enum": [
                                                                                                                                                        "r",
                                                                                                                                                        "w",
                                                                                                                                                        "rw"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        "alt_access_type": {
                                                                                                                                                "type": "string",
                                                                                                                                                "nullable": true,
                                                                                                                                                "description": "Alternative access level",
                                                                                                                                                "enum": [
                                                                                                                                                        "r",
                                                                                                                                                        "w",
                                                                                                                                                        "rw"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        }
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type",
                                                                                                                "content",
                                                                                                                "language",
                                                                                                                "input_transforms"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Reference to an existing script by path. Use this when calling a previously saved script instead of writing inline code",
                                                                                                        "properties": {
                                                                                                                "input_transforms": {
                                                                                                                        "type": "object",
                                                                                                                        "description": "Map of parameter names to their values (static or JavaScript expressions). These become the script's input arguments",
                                                                                                                        "additionalProperties": {
                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                "oneOf": [
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                "properties": {
                                                                                                                                                        "value": {
                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "static"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                "properties": {
                                                                                                                                                        "expr": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "javascript"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "expr",
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                "properties": {
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "ai"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                ],
                                                                                                                                "discriminator": {
                                                                                                                                        "propertyName": "type",
                                                                                                                                        "mapping": {
                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        }
                                                                                                                },
                                                                                                                "path": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Path to the script in the workspace (e.g., 'f/scripts/send_email')"
                                                                                                                },
                                                                                                                "hash": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Optional specific version hash of the script to use"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "script"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "tag_override": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Override the script's default worker group tag"
                                                                                                                },
                                                                                                                "is_trigger": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, this script is a trigger that can start the flow"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type",
                                                                                                                "path",
                                                                                                                "input_transforms"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Reference to an existing flow by path. Use this to call another flow as a subflow",
                                                                                                        "properties": {
                                                                                                                "input_transforms": {
                                                                                                                        "type": "object",
                                                                                                                        "description": "Map of parameter names to their values (static or JavaScript expressions). These become the subflow's input arguments",
                                                                                                                        "additionalProperties": {
                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                "oneOf": [
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                "properties": {
                                                                                                                                                        "value": {
                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "static"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                "properties": {
                                                                                                                                                        "expr": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "javascript"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "expr",
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                "properties": {
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "ai"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                ],
                                                                                                                                "discriminator": {
                                                                                                                                        "propertyName": "type",
                                                                                                                                        "mapping": {
                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        }
                                                                                                                },
                                                                                                                "path": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Path to the flow in the workspace (e.g., 'f/flows/process_user')"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "flow"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type",
                                                                                                                "path",
                                                                                                                "input_transforms"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Executes nested modules in a loop over an iterator. Inside the loop, use 'flow_input.iter.value' to access the current iteration value, and 'flow_input.iter.index' for the index. Supports parallel execution for better performance on I/O-bound operations",
                                                                                                        "properties": {
                                                                                                                "modules": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "Steps to execute for each iteration. These can reference the iteration value via 'flow_input.iter.value'",
                                                                                                                        "items": {
                                                                                                                                "type": "object"
                                                                                                                        }
                                                                                                                },
                                                                                                                "iterator": {
                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                        "oneOf": [
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                        "properties": {
                                                                                                                                                "value": {
                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                },
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "static"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                        "properties": {
                                                                                                                                                "expr": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                },
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "javascript"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "expr",
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                        "properties": {
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "ai"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        ],
                                                                                                                        "discriminator": {
                                                                                                                                "propertyName": "type",
                                                                                                                                "mapping": {
                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                }
                                                                                                                        }
                                                                                                                },
                                                                                                                "skip_failures": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, iteration failures don't stop the loop. Failed iterations return null"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "forloopflow"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "parallel": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, iterations run concurrently (faster for I/O-bound operations). Use with parallelism to control concurrency"
                                                                                                                },
                                                                                                                "parallelism": {
                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                        "oneOf": [
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                        "properties": {
                                                                                                                                                "value": {
                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                },
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "static"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                        "properties": {
                                                                                                                                                "expr": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                },
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "javascript"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "expr",
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                        "properties": {
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "ai"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        ],
                                                                                                                        "discriminator": {
                                                                                                                                "propertyName": "type",
                                                                                                                                "mapping": {
                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                }
                                                                                                                        }
                                                                                                                },
                                                                                                                "squash": {
                                                                                                                        "type": "boolean"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "modules",
                                                                                                                "iterator",
                                                                                                                "skip_failures",
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Executes nested modules repeatedly while a condition is true. The loop checks the condition after each iteration. Use stop_after_if on modules to control loop termination",
                                                                                                        "properties": {
                                                                                                                "modules": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "Steps to execute in each iteration. Use stop_after_if to control when the loop ends",
                                                                                                                        "items": {
                                                                                                                                "type": "object"
                                                                                                                        }
                                                                                                                },
                                                                                                                "skip_failures": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, iteration failures don't stop the loop. Failed iterations return null"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "whileloopflow"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "parallel": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, iterations run concurrently (use with caution in while loops)"
                                                                                                                },
                                                                                                                "parallelism": {
                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                        "oneOf": [
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                        "properties": {
                                                                                                                                                "value": {
                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                },
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "static"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                        "properties": {
                                                                                                                                                "expr": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                },
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "javascript"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "expr",
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                        "properties": {
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "ai"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        ],
                                                                                                                        "discriminator": {
                                                                                                                                "propertyName": "type",
                                                                                                                                "mapping": {
                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                }
                                                                                                                        }
                                                                                                                },
                                                                                                                "squash": {
                                                                                                                        "type": "boolean"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "modules",
                                                                                                                "skip_failures",
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Conditional branching where only the first matching branch executes. Branches are evaluated in order, and the first one with a true expression runs. If no branches match, the default branch executes",
                                                                                                        "properties": {
                                                                                                                "branches": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "Array of branches to evaluate in order. The first branch with expr evaluating to true executes",
                                                                                                                        "items": {
                                                                                                                                "type": "object",
                                                                                                                                "properties": {
                                                                                                                                        "summary": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "Short description of this branch condition"
                                                                                                                                        },
                                                                                                                                        "expr": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "JavaScript expression that returns boolean. Can use 'results.step_id' or 'flow_input'. First true expr wins"
                                                                                                                                        },
                                                                                                                                        "modules": {
                                                                                                                                                "type": "array",
                                                                                                                                                "description": "Steps to execute if this branch's expr is true",
                                                                                                                                                "items": {
                                                                                                                                                        "type": "object"
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "required": [
                                                                                                                                        "modules",
                                                                                                                                        "expr"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "default": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "Steps to execute if no branch expressions match",
                                                                                                                        "items": {
                                                                                                                                "type": "object"
                                                                                                                        }
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "branchone"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "branches",
                                                                                                                "default",
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Parallel branching where all branches execute simultaneously. Unlike BranchOne, all branches run regardless of conditions. Useful for executing independent tasks concurrently",
                                                                                                        "properties": {
                                                                                                                "branches": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "Array of branches that all execute (either in parallel or sequentially)",
                                                                                                                        "items": {
                                                                                                                                "type": "object",
                                                                                                                                "properties": {
                                                                                                                                        "summary": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "Short description of this branch's purpose"
                                                                                                                                        },
                                                                                                                                        "skip_failure": {
                                                                                                                                                "type": "boolean",
                                                                                                                                                "description": "If true, failure in this branch doesn't fail the entire flow"
                                                                                                                                        },
                                                                                                                                        "modules": {
                                                                                                                                                "type": "array",
                                                                                                                                                "description": "Steps to execute in this branch",
                                                                                                                                                "items": {
                                                                                                                                                        "type": "object"
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "required": [
                                                                                                                                        "modules"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "branchall"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "parallel": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, all branches execute concurrently. If false, they execute sequentially"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "branches",
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Pass-through module that returns its input unchanged. Useful for flow structure or as a placeholder",
                                                                                                        "properties": {
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "identity"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "flow": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, marks this as a flow identity (special handling)"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "AI agent step that can use tools to accomplish tasks. The agent receives inputs and can call any of its configured tools to complete the task",
                                                                                                        "properties": {
                                                                                                                "input_transforms": {
                                                                                                                        "type": "object",
                                                                                                                        "description": "Input parameters for the AI agent mapped to their values",
                                                                                                                        "properties": {
                                                                                                                                "provider": {
                                                                                                                                        "description": "Provider configuration - can be static (ProviderConfig), JavaScript expression, or AI-determined",
                                                                                                                                        "oneOf": [
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Static provider configuration passed directly to the AI agent",
                                                                                                                                                        "properties": {
                                                                                                                                                                "value": {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Complete AI provider configuration with resource reference and model selection",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "kind": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "Supported AI provider types",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "openai",
                                                                                                                                                                                                "azure_openai",
                                                                                                                                                                                                "anthropic",
                                                                                                                                                                                                "mistral",
                                                                                                                                                                                                "deepseek",
                                                                                                                                                                                                "googleai",
                                                                                                                                                                                                "groq",
                                                                                                                                                                                                "openrouter",
                                                                                                                                                                                                "togetherai",
                                                                                                                                                                                                "customai",
                                                                                                                                                                                                "aws_bedrock"
                                                                                                                                                                                        ]
                                                                                                                                                                                },
                                                                                                                                                                                "resource": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "Resource reference in format '$res:{resource_path}' pointing to provider credentials"
                                                                                                                                                                                },
                                                                                                                                                                                "model": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "Model identifier (e.g., 'gpt-4', 'claude-3-opus-20240229', 'gemini-pro')"
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "kind",
                                                                                                                                                                                "resource",
                                                                                                                                                                                "model"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "static"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type",
                                                                                                                                                                "value"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                        "properties": {
                                                                                                                                                                "expr": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "javascript"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "expr",
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                        "properties": {
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "ai"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "discriminator": {
                                                                                                                                                "propertyName": "type",
                                                                                                                                                "mapping": {
                                                                                                                                                        "static": "#/components/schemas/StaticProviderTransform",
                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "output_type": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "Output format type.\nValid values: 'text' (default) - plain text response, 'image' - image generation\n"
                                                                                                                                },
                                                                                                                                "user_message": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "The user's prompt/message to the AI agent. Supports variable interpolation with flow.input syntax."
                                                                                                                                },
                                                                                                                                "system_prompt": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "System instructions that guide the AI's behavior, persona, and response style. Optional."
                                                                                                                                },
                                                                                                                                "streaming": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "Boolean. If true, stream the AI response incrementally.\nStreaming events include: token_delta, tool_call, tool_call_arguments, tool_execution, tool_result\n"
                                                                                                                                },
                                                                                                                                "memory": {
                                                                                                                                        "description": "Memory configuration - can be static (MemoryConfig), JavaScript expression, or AI-determined",
                                                                                                                                        "oneOf": [
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Static memory configuration passed directly to the AI agent",
                                                                                                                                                        "properties": {
                                                                                                                                                                "value": {
                                                                                                                                                                        "description": "Conversation memory configuration",
                                                                                                                                                                        "oneOf": [
                                                                                                                                                                                {
                                                                                                                                                                                        "type": "object",
                                                                                                                                                                                        "description": "No conversation memory/context",
                                                                                                                                                                                        "properties": {
                                                                                                                                                                                                "kind": {
                                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                                "off"
                                                                                                                                                                                                        ]
                                                                                                                                                                                                }
                                                                                                                                                                                        },
                                                                                                                                                                                        "required": [
                                                                                                                                                                                                "kind"
                                                                                                                                                                                        ]
                                                                                                                                                                                },
                                                                                                                                                                                {
                                                                                                                                                                                        "type": "object",
                                                                                                                                                                                        "description": "Automatic context management",
                                                                                                                                                                                        "properties": {
                                                                                                                                                                                                "kind": {
                                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                                "auto"
                                                                                                                                                                                                        ]
                                                                                                                                                                                                },
                                                                                                                                                                                                "context_length": {
                                                                                                                                                                                                        "type": "integer",
                                                                                                                                                                                                        "description": "Maximum number of messages to retain in context"
                                                                                                                                                                                                },
                                                                                                                                                                                                "memory_id": {
                                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                                        "description": "Identifier for persistent memory across agent invocations"
                                                                                                                                                                                                }
                                                                                                                                                                                        },
                                                                                                                                                                                        "required": [
                                                                                                                                                                                                "kind"
                                                                                                                                                                                        ]
                                                                                                                                                                                },
                                                                                                                                                                                {
                                                                                                                                                                                        "type": "object",
                                                                                                                                                                                        "description": "Explicit message history",
                                                                                                                                                                                        "properties": {
                                                                                                                                                                                                "kind": {
                                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                                "manual"
                                                                                                                                                                                                        ]
                                                                                                                                                                                                },
                                                                                                                                                                                                "messages": {
                                                                                                                                                                                                        "type": "array",
                                                                                                                                                                                                        "items": {
                                                                                                                                                                                                                "type": "object",
                                                                                                                                                                                                                "description": "A single message in conversation history",
                                                                                                                                                                                                                "properties": {
                                                                                                                                                                                                                        "role": {
                                                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                                                        "user",
                                                                                                                                                                                                                                        "assistant",
                                                                                                                                                                                                                                        "system"
                                                                                                                                                                                                                                ]
                                                                                                                                                                                                                        },
                                                                                                                                                                                                                        "content": {
                                                                                                                                                                                                                                "type": "string"
                                                                                                                                                                                                                        }
                                                                                                                                                                                                                },
                                                                                                                                                                                                                "required": [
                                                                                                                                                                                                                        "role",
                                                                                                                                                                                                                        "content"
                                                                                                                                                                                                                ]
                                                                                                                                                                                                        }
                                                                                                                                                                                                }
                                                                                                                                                                                        },
                                                                                                                                                                                        "required": [
                                                                                                                                                                                                "kind",
                                                                                                                                                                                                "messages"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        ],
                                                                                                                                                                        "discriminator": {
                                                                                                                                                                                "propertyName": "kind",
                                                                                                                                                                                "mapping": {
                                                                                                                                                                                        "off": "#/components/schemas/MemoryOff",
                                                                                                                                                                                        "auto": "#/components/schemas/MemoryAuto",
                                                                                                                                                                                        "manual": "#/components/schemas/MemoryManual"
                                                                                                                                                                                }
                                                                                                                                                                        }
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "static"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type",
                                                                                                                                                                "value"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                        "properties": {
                                                                                                                                                                "expr": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "javascript"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "expr",
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                        "properties": {
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "ai"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "discriminator": {
                                                                                                                                                "propertyName": "type",
                                                                                                                                                "mapping": {
                                                                                                                                                        "static": "#/components/schemas/StaticMemoryTransform",
                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "output_schema": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "JSON Schema object defining structured output format. Used when you need the AI to return data in a specific shape.\nSupports standard JSON Schema properties: type, properties, required, items, enum, pattern, minLength, maxLength, minimum, maximum, etc.\nExample: { type: 'object', properties: { name: { type: 'string' }, age: { type: 'integer' } }, required: ['name'] }\n"
                                                                                                                                },
                                                                                                                                "user_images": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "Array of image references for vision-capable models.\nFormat: Array<{ bucket: string, key: string }> - S3 object references\nExample: [{ bucket: 'my-bucket', key: 'images/photo.jpg' }]\n"
                                                                                                                                },
                                                                                                                                "max_completion_tokens": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "Integer. Maximum number of tokens the AI will generate in its response.\nRange: 1 to 4,294,967,295. Typical values: 256-4096 for most use cases.\n"
                                                                                                                                },
                                                                                                                                "temperature": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "Float. Controls randomness/creativity of responses.\nRange: 0.0 to 2.0 (provider-dependent)\n- 0.0 = deterministic, focused responses\n- 0.7 = balanced (common default)\n- 1.0+ = more creative/random\n"
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "required": [
                                                                                                                                "provider",
                                                                                                                                "user_message",
                                                                                                                                "output_type"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "tools": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "Array of tools the agent can use. The agent decides which tools to call based on the task",
                                                                                                                        "items": {
                                                                                                                                "type": "object",
                                                                                                                                "description": "A tool available to an AI agent. Can be a flow module or an external MCP (Model Context Protocol) tool",
                                                                                                                                "properties": {
                                                                                                                                        "id": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "Unique identifier for this tool. Cannot contain spaces - use underscores instead (e.g., 'get_user_data' not 'get user data')"
                                                                                                                                        },
                                                                                                                                        "summary": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "Short description of what this tool does (shown to the AI)"
                                                                                                                                        },
                                                                                                                                        "value": {
                                                                                                                                                "description": "The implementation of a tool. Can be a flow module (script/flow) or an MCP tool reference",
                                                                                                                                                "oneOf": [
                                                                                                                                                        {
                                                                                                                                                                "description": "A tool implemented as a flow module (script, flow, etc.). The AI can call this like any other flow module",
                                                                                                                                                                "allOf": [
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "tool_type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "flowmodule"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "tool_type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object"
                                                                                                                                                                        }
                                                                                                                                                                ]
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                                "type": "object",
                                                                                                                                                                "description": "Reference to an external MCP (Model Context Protocol) tool. The AI can call tools from MCP servers",
                                                                                                                                                                "properties": {
                                                                                                                                                                        "tool_type": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "enum": [
                                                                                                                                                                                        "mcp"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        "resource_path": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "description": "Path to the MCP resource/server configuration"
                                                                                                                                                                        },
                                                                                                                                                                        "include_tools": {
                                                                                                                                                                                "type": "array",
                                                                                                                                                                                "description": "Whitelist of specific tools to include from this MCP server",
                                                                                                                                                                                "items": {
                                                                                                                                                                                        "type": "string"
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "exclude_tools": {
                                                                                                                                                                                "type": "array",
                                                                                                                                                                                "description": "Blacklist of tools to exclude from this MCP server",
                                                                                                                                                                                "items": {
                                                                                                                                                                                        "type": "string"
                                                                                                                                                                                }
                                                                                                                                                                        }
                                                                                                                                                                },
                                                                                                                                                                "required": [
                                                                                                                                                                        "tool_type",
                                                                                                                                                                        "resource_path"
                                                                                                                                                                ]
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                                "type": "object",
                                                                                                                                                                "description": "A tool implemented as a websearch tool. The AI can call this like any other websearch tool",
                                                                                                                                                                "properties": {
                                                                                                                                                                        "tool_type": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "enum": [
                                                                                                                                                                                        "websearch"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                },
                                                                                                                                                                "required": [
                                                                                                                                                                        "tool_type"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                ],
                                                                                                                                                "discriminator": {
                                                                                                                                                        "propertyName": "tool_type",
                                                                                                                                                        "mapping": {
                                                                                                                                                                "flowmodule": "#/components/schemas/FlowModuleTool",
                                                                                                                                                                "mcp": "#/components/schemas/McpToolValue",
                                                                                                                                                                "websearch": "#/components/schemas/WebsearchToolValue"
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "required": [
                                                                                                                                        "id",
                                                                                                                                        "value"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "aiagent"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "parallel": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, the agent can execute multiple tool calls in parallel"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "tools",
                                                                                                                "type",
                                                                                                                "input_transforms"
                                                                                                        ]
                                                                                                }
                                                                                        ],
                                                                                        "discriminator": {
                                                                                                "propertyName": "type",
                                                                                                "mapping": {
                                                                                                        "rawscript": "#/components/schemas/RawScript",
                                                                                                        "script": "#/components/schemas/PathScript",
                                                                                                        "flow": "#/components/schemas/PathFlow",
                                                                                                        "forloopflow": "#/components/schemas/ForloopFlow",
                                                                                                        "whileloopflow": "#/components/schemas/WhileloopFlow",
                                                                                                        "branchone": "#/components/schemas/BranchOne",
                                                                                                        "branchall": "#/components/schemas/BranchAll",
                                                                                                        "identity": "#/components/schemas/Identity",
                                                                                                        "aiagent": "#/components/schemas/AiAgent"
                                                                                                }
                                                                                        }
                                                                                },
                                                                                "stop_after_if": {
                                                                                        "type": "object",
                                                                                        "description": "Early termination condition for a module",
                                                                                        "properties": {
                                                                                                "skip_if_stopped": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, following steps are skipped when this condition triggers"
                                                                                                },
                                                                                                "expr": {
                                                                                                        "type": "string",
                                                                                                        "description": "JavaScript expression evaluated after the module runs. Can use 'result' (step's result) or 'flow_input'. Return true to stop"
                                                                                                },
                                                                                                "error_message": {
                                                                                                        "type": "string",
                                                                                                        "description": "Custom error message shown when stopping"
                                                                                                }
                                                                                        },
                                                                                        "required": [
                                                                                                "expr"
                                                                                        ]
                                                                                },
                                                                                "stop_after_all_iters_if": {
                                                                                        "type": "object",
                                                                                        "description": "Early termination condition for a module",
                                                                                        "properties": {
                                                                                                "skip_if_stopped": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, following steps are skipped when this condition triggers"
                                                                                                },
                                                                                                "expr": {
                                                                                                        "type": "string",
                                                                                                        "description": "JavaScript expression evaluated after the module runs. Can use 'result' (step's result) or 'flow_input'. Return true to stop"
                                                                                                },
                                                                                                "error_message": {
                                                                                                        "type": "string",
                                                                                                        "description": "Custom error message shown when stopping"
                                                                                                }
                                                                                        },
                                                                                        "required": [
                                                                                                "expr"
                                                                                        ]
                                                                                },
                                                                                "skip_if": {
                                                                                        "type": "object",
                                                                                        "description": "Conditionally skip this step based on previous results or flow inputs",
                                                                                        "properties": {
                                                                                                "expr": {
                                                                                                        "type": "string",
                                                                                                        "description": "JavaScript expression that returns true to skip. Can use 'flow_input' or 'results.<step_id>'"
                                                                                                }
                                                                                        },
                                                                                        "required": [
                                                                                                "expr"
                                                                                        ]
                                                                                },
                                                                                "sleep": {
                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                        "oneOf": [
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                        "properties": {
                                                                                                                "value": {
                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "static"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                        "properties": {
                                                                                                                "expr": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "javascript"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "expr",
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                        "properties": {
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "ai"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type"
                                                                                                        ]
                                                                                                }
                                                                                        ],
                                                                                        "discriminator": {
                                                                                                "propertyName": "type",
                                                                                                "mapping": {
                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                }
                                                                                        }
                                                                                },
                                                                                "cache_ttl": {
                                                                                        "type": "number",
                                                                                        "description": "Cache duration in seconds for this step's results"
                                                                                },
                                                                                "cache_ignore_s3_path": {
                                                                                        "type": "boolean"
                                                                                },
                                                                                "timeout": {
                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                        "oneOf": [
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                        "properties": {
                                                                                                                "value": {
                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "static"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                        "properties": {
                                                                                                                "expr": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "javascript"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "expr",
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                        "properties": {
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "ai"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type"
                                                                                                        ]
                                                                                                }
                                                                                        ],
                                                                                        "discriminator": {
                                                                                                "propertyName": "type",
                                                                                                "mapping": {
                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                }
                                                                                        }
                                                                                },
                                                                                "delete_after_use": {
                                                                                        "type": "boolean",
                                                                                        "description": "If true, this step's result is deleted after use to save memory"
                                                                                },
                                                                                "summary": {
                                                                                        "type": "string",
                                                                                        "description": "Short description of what this step does"
                                                                                },
                                                                                "mock": {
                                                                                        "type": "object",
                                                                                        "description": "Mock configuration for testing without executing the actual step",
                                                                                        "properties": {
                                                                                                "enabled": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, return mock value instead of executing"
                                                                                                },
                                                                                                "return_value": {
                                                                                                        "description": "Value to return when mocked"
                                                                                                }
                                                                                        }
                                                                                },
                                                                                "suspend": {
                                                                                        "type": "object",
                                                                                        "description": "Configuration for approval/resume steps that wait for user input",
                                                                                        "properties": {
                                                                                                "required_events": {
                                                                                                        "type": "integer",
                                                                                                        "description": "Number of approvals required before continuing"
                                                                                                },
                                                                                                "timeout": {
                                                                                                        "type": "integer",
                                                                                                        "description": "Timeout in seconds before auto-continuing or canceling"
                                                                                                },
                                                                                                "resume_form": {
                                                                                                        "type": "object",
                                                                                                        "description": "Form schema for collecting input when resuming",
                                                                                                        "properties": {
                                                                                                                "schema": {
                                                                                                                        "type": "object",
                                                                                                                        "description": "JSON Schema for the resume form"
                                                                                                                }
                                                                                                        }
                                                                                                },
                                                                                                "user_auth_required": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, only authenticated users can approve"
                                                                                                },
                                                                                                "user_groups_required": {
                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                        "oneOf": [
                                                                                                                {
                                                                                                                        "type": "object",
                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                        "properties": {
                                                                                                                                "value": {
                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                },
                                                                                                                                "type": {
                                                                                                                                        "type": "string",
                                                                                                                                        "enum": [
                                                                                                                                                "static"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "required": [
                                                                                                                                "type"
                                                                                                                        ]
                                                                                                                },
                                                                                                                {
                                                                                                                        "type": "object",
                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                        "properties": {
                                                                                                                                "expr": {
                                                                                                                                        "type": "string",
                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                },
                                                                                                                                "type": {
                                                                                                                                        "type": "string",
                                                                                                                                        "enum": [
                                                                                                                                                "javascript"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "required": [
                                                                                                                                "expr",
                                                                                                                                "type"
                                                                                                                        ]
                                                                                                                },
                                                                                                                {
                                                                                                                        "type": "object",
                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                        "properties": {
                                                                                                                                "type": {
                                                                                                                                        "type": "string",
                                                                                                                                        "enum": [
                                                                                                                                                "ai"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "required": [
                                                                                                                                "type"
                                                                                                                        ]
                                                                                                                }
                                                                                                        ],
                                                                                                        "discriminator": {
                                                                                                                "propertyName": "type",
                                                                                                                "mapping": {
                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                }
                                                                                                        }
                                                                                                },
                                                                                                "self_approval_disabled": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, the user who started the flow cannot approve"
                                                                                                },
                                                                                                "hide_cancel": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, hide the cancel button on the approval form"
                                                                                                },
                                                                                                "continue_on_disapprove_timeout": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, continue flow on timeout instead of canceling"
                                                                                                }
                                                                                        }
                                                                                },
                                                                                "priority": {
                                                                                        "type": "number",
                                                                                        "description": "Execution priority for this step (higher numbers run first)"
                                                                                },
                                                                                "continue_on_error": {
                                                                                        "type": "boolean",
                                                                                        "description": "If true, flow continues even if this step fails"
                                                                                },
                                                                                "retry": {
                                                                                        "type": "object",
                                                                                        "description": "Retry configuration for failed module executions",
                                                                                        "properties": {
                                                                                                "constant": {
                                                                                                        "type": "object",
                                                                                                        "description": "Retry with constant delay between attempts",
                                                                                                        "properties": {
                                                                                                                "attempts": {
                                                                                                                        "type": "integer",
                                                                                                                        "description": "Number of retry attempts"
                                                                                                                },
                                                                                                                "seconds": {
                                                                                                                        "type": "integer",
                                                                                                                        "description": "Seconds to wait between retries"
                                                                                                                }
                                                                                                        }
                                                                                                },
                                                                                                "exponential": {
                                                                                                        "type": "object",
                                                                                                        "description": "Retry with exponential backoff (delay doubles each time)",
                                                                                                        "properties": {
                                                                                                                "attempts": {
                                                                                                                        "type": "integer",
                                                                                                                        "description": "Number of retry attempts"
                                                                                                                },
                                                                                                                "multiplier": {
                                                                                                                        "type": "integer",
                                                                                                                        "description": "Multiplier for exponential backoff"
                                                                                                                },
                                                                                                                "seconds": {
                                                                                                                        "type": "integer",
                                                                                                                        "minimum": 1,
                                                                                                                        "description": "Initial delay in seconds"
                                                                                                                },
                                                                                                                "random_factor": {
                                                                                                                        "type": "integer",
                                                                                                                        "minimum": 0,
                                                                                                                        "maximum": 100,
                                                                                                                        "description": "Random jitter percentage (0-100) to avoid thundering herd"
                                                                                                                }
                                                                                                        }
                                                                                                },
                                                                                                "retry_if": {
                                                                                                        "type": "object",
                                                                                                        "description": "Conditional retry based on error or result",
                                                                                                        "properties": {
                                                                                                                "expr": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "JavaScript expression that returns true to retry. Has access to 'result' and 'error' variables"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "expr"
                                                                                                        ]
                                                                                                }
                                                                                        }
                                                                                }
                                                                        },
                                                                        "required": [
                                                                                "value",
                                                                                "id"
                                                                        ]
                                                                },
                                                                "preprocessor_module": {
                                                                        "type": "object",
                                                                        "description": "A single step in a flow. Can be a script, subflow, loop, or branch",
                                                                        "properties": {
                                                                                "id": {
                                                                                        "type": "string",
                                                                                        "description": "Unique identifier for this step. Used to reference results via 'results.step_id'. Must be a valid identifier (alphanumeric, underscore, hyphen)"
                                                                                },
                                                                                "value": {
                                                                                        "description": "The actual implementation of a flow step. Can be a script (inline or referenced), subflow, loop, branch, or special module type",
                                                                                        "oneOf": [
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Inline script with code defined directly in the flow. Use 'bun' as default language if unspecified. The script receives arguments from input_transforms",
                                                                                                        "properties": {
                                                                                                                "input_transforms": {
                                                                                                                        "type": "object",
                                                                                                                        "description": "Map of parameter names to their values (static or JavaScript expressions). These become the script's input arguments",
                                                                                                                        "additionalProperties": {
                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                "oneOf": [
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                "properties": {
                                                                                                                                                        "value": {
                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "static"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                "properties": {
                                                                                                                                                        "expr": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "javascript"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "expr",
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                "properties": {
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "ai"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                ],
                                                                                                                                "discriminator": {
                                                                                                                                        "propertyName": "type",
                                                                                                                                        "mapping": {
                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        }
                                                                                                                },
                                                                                                                "content": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "The script source code. Should export a 'main' function"
                                                                                                                },
                                                                                                                "language": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Programming language for this script",
                                                                                                                        "enum": [
                                                                                                                                "deno",
                                                                                                                                "bun",
                                                                                                                                "python3",
                                                                                                                                "go",
                                                                                                                                "bash",
                                                                                                                                "powershell",
                                                                                                                                "postgresql",
                                                                                                                                "mysql",
                                                                                                                                "bigquery",
                                                                                                                                "snowflake",
                                                                                                                                "mssql",
                                                                                                                                "oracledb",
                                                                                                                                "graphql",
                                                                                                                                "nativets",
                                                                                                                                "php",
                                                                                                                                "rust",
                                                                                                                                "ansible",
                                                                                                                                "csharp",
                                                                                                                                "nu",
                                                                                                                                "java",
                                                                                                                                "ruby",
                                                                                                                                "duckdb"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "path": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Optional path for saving this script"
                                                                                                                },
                                                                                                                "lock": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Lock file content for dependencies"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "rawscript"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "tag": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Worker group tag for execution routing"
                                                                                                                },
                                                                                                                "concurrent_limit": {
                                                                                                                        "type": "number",
                                                                                                                        "description": "Maximum concurrent executions of this script"
                                                                                                                },
                                                                                                                "concurrency_time_window_s": {
                                                                                                                        "type": "number",
                                                                                                                        "description": "Time window for concurrent_limit"
                                                                                                                },
                                                                                                                "custom_concurrency_key": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Custom key for grouping concurrent executions"
                                                                                                                },
                                                                                                                "is_trigger": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, this script is a trigger that can start the flow"
                                                                                                                },
                                                                                                                "assets": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "External resources this script accesses (S3 objects, resources, etc.)",
                                                                                                                        "items": {
                                                                                                                                "type": "object",
                                                                                                                                "required": [
                                                                                                                                        "path",
                                                                                                                                        "kind"
                                                                                                                                ],
                                                                                                                                "properties": {
                                                                                                                                        "path": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "Path to the asset"
                                                                                                                                        },
                                                                                                                                        "kind": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "Type of asset",
                                                                                                                                                "enum": [
                                                                                                                                                        "s3object",
                                                                                                                                                        "resource",
                                                                                                                                                        "ducklake",
                                                                                                                                                        "datatable"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        "access_type": {
                                                                                                                                                "type": "string",
                                                                                                                                                "nullable": true,
                                                                                                                                                "description": "Access level for this asset",
                                                                                                                                                "enum": [
                                                                                                                                                        "r",
                                                                                                                                                        "w",
                                                                                                                                                        "rw"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        "alt_access_type": {
                                                                                                                                                "type": "string",
                                                                                                                                                "nullable": true,
                                                                                                                                                "description": "Alternative access level",
                                                                                                                                                "enum": [
                                                                                                                                                        "r",
                                                                                                                                                        "w",
                                                                                                                                                        "rw"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        }
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type",
                                                                                                                "content",
                                                                                                                "language",
                                                                                                                "input_transforms"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Reference to an existing script by path. Use this when calling a previously saved script instead of writing inline code",
                                                                                                        "properties": {
                                                                                                                "input_transforms": {
                                                                                                                        "type": "object",
                                                                                                                        "description": "Map of parameter names to their values (static or JavaScript expressions). These become the script's input arguments",
                                                                                                                        "additionalProperties": {
                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                "oneOf": [
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                "properties": {
                                                                                                                                                        "value": {
                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "static"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                "properties": {
                                                                                                                                                        "expr": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "javascript"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "expr",
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                "properties": {
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "ai"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                ],
                                                                                                                                "discriminator": {
                                                                                                                                        "propertyName": "type",
                                                                                                                                        "mapping": {
                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        }
                                                                                                                },
                                                                                                                "path": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Path to the script in the workspace (e.g., 'f/scripts/send_email')"
                                                                                                                },
                                                                                                                "hash": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Optional specific version hash of the script to use"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "script"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "tag_override": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Override the script's default worker group tag"
                                                                                                                },
                                                                                                                "is_trigger": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, this script is a trigger that can start the flow"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type",
                                                                                                                "path",
                                                                                                                "input_transforms"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Reference to an existing flow by path. Use this to call another flow as a subflow",
                                                                                                        "properties": {
                                                                                                                "input_transforms": {
                                                                                                                        "type": "object",
                                                                                                                        "description": "Map of parameter names to their values (static or JavaScript expressions). These become the subflow's input arguments",
                                                                                                                        "additionalProperties": {
                                                                                                                                "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                "oneOf": [
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                "properties": {
                                                                                                                                                        "value": {
                                                                                                                                                                "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "static"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                "properties": {
                                                                                                                                                        "expr": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                        },
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "javascript"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "expr",
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                                "type": "object",
                                                                                                                                                "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                "properties": {
                                                                                                                                                        "type": {
                                                                                                                                                                "type": "string",
                                                                                                                                                                "enum": [
                                                                                                                                                                        "ai"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                },
                                                                                                                                                "required": [
                                                                                                                                                        "type"
                                                                                                                                                ]
                                                                                                                                        }
                                                                                                                                ],
                                                                                                                                "discriminator": {
                                                                                                                                        "propertyName": "type",
                                                                                                                                        "mapping": {
                                                                                                                                                "static": "#/components/schemas/StaticTransform",
                                                                                                                                                "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                "ai": "#/components/schemas/AiTransform"
                                                                                                                                        }
                                                                                                                                }
                                                                                                                        }
                                                                                                                },
                                                                                                                "path": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "Path to the flow in the workspace (e.g., 'f/flows/process_user')"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "flow"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type",
                                                                                                                "path",
                                                                                                                "input_transforms"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Executes nested modules in a loop over an iterator. Inside the loop, use 'flow_input.iter.value' to access the current iteration value, and 'flow_input.iter.index' for the index. Supports parallel execution for better performance on I/O-bound operations",
                                                                                                        "properties": {
                                                                                                                "modules": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "Steps to execute for each iteration. These can reference the iteration value via 'flow_input.iter.value'",
                                                                                                                        "items": {
                                                                                                                                "type": "object"
                                                                                                                        }
                                                                                                                },
                                                                                                                "iterator": {
                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                        "oneOf": [
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                        "properties": {
                                                                                                                                                "value": {
                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                },
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "static"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                        "properties": {
                                                                                                                                                "expr": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                },
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "javascript"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "expr",
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                        "properties": {
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "ai"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        ],
                                                                                                                        "discriminator": {
                                                                                                                                "propertyName": "type",
                                                                                                                                "mapping": {
                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                }
                                                                                                                        }
                                                                                                                },
                                                                                                                "skip_failures": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, iteration failures don't stop the loop. Failed iterations return null"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "forloopflow"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "parallel": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, iterations run concurrently (faster for I/O-bound operations). Use with parallelism to control concurrency"
                                                                                                                },
                                                                                                                "parallelism": {
                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                        "oneOf": [
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                        "properties": {
                                                                                                                                                "value": {
                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                },
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "static"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                        "properties": {
                                                                                                                                                "expr": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                },
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "javascript"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "expr",
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                        "properties": {
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "ai"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        ],
                                                                                                                        "discriminator": {
                                                                                                                                "propertyName": "type",
                                                                                                                                "mapping": {
                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                }
                                                                                                                        }
                                                                                                                },
                                                                                                                "squash": {
                                                                                                                        "type": "boolean"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "modules",
                                                                                                                "iterator",
                                                                                                                "skip_failures",
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Executes nested modules repeatedly while a condition is true. The loop checks the condition after each iteration. Use stop_after_if on modules to control loop termination",
                                                                                                        "properties": {
                                                                                                                "modules": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "Steps to execute in each iteration. Use stop_after_if to control when the loop ends",
                                                                                                                        "items": {
                                                                                                                                "type": "object"
                                                                                                                        }
                                                                                                                },
                                                                                                                "skip_failures": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, iteration failures don't stop the loop. Failed iterations return null"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "whileloopflow"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "parallel": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, iterations run concurrently (use with caution in while loops)"
                                                                                                                },
                                                                                                                "parallelism": {
                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                        "oneOf": [
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                        "properties": {
                                                                                                                                                "value": {
                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                },
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "static"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                        "properties": {
                                                                                                                                                "expr": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                },
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "javascript"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "expr",
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                        "type": "object",
                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                        "properties": {
                                                                                                                                                "type": {
                                                                                                                                                        "type": "string",
                                                                                                                                                        "enum": [
                                                                                                                                                                "ai"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        },
                                                                                                                                        "required": [
                                                                                                                                                "type"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        ],
                                                                                                                        "discriminator": {
                                                                                                                                "propertyName": "type",
                                                                                                                                "mapping": {
                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                }
                                                                                                                        }
                                                                                                                },
                                                                                                                "squash": {
                                                                                                                        "type": "boolean"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "modules",
                                                                                                                "skip_failures",
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Conditional branching where only the first matching branch executes. Branches are evaluated in order, and the first one with a true expression runs. If no branches match, the default branch executes",
                                                                                                        "properties": {
                                                                                                                "branches": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "Array of branches to evaluate in order. The first branch with expr evaluating to true executes",
                                                                                                                        "items": {
                                                                                                                                "type": "object",
                                                                                                                                "properties": {
                                                                                                                                        "summary": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "Short description of this branch condition"
                                                                                                                                        },
                                                                                                                                        "expr": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "JavaScript expression that returns boolean. Can use 'results.step_id' or 'flow_input'. First true expr wins"
                                                                                                                                        },
                                                                                                                                        "modules": {
                                                                                                                                                "type": "array",
                                                                                                                                                "description": "Steps to execute if this branch's expr is true",
                                                                                                                                                "items": {
                                                                                                                                                        "type": "object"
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "required": [
                                                                                                                                        "modules",
                                                                                                                                        "expr"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "default": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "Steps to execute if no branch expressions match",
                                                                                                                        "items": {
                                                                                                                                "type": "object"
                                                                                                                        }
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "branchone"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "branches",
                                                                                                                "default",
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Parallel branching where all branches execute simultaneously. Unlike BranchOne, all branches run regardless of conditions. Useful for executing independent tasks concurrently",
                                                                                                        "properties": {
                                                                                                                "branches": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "Array of branches that all execute (either in parallel or sequentially)",
                                                                                                                        "items": {
                                                                                                                                "type": "object",
                                                                                                                                "properties": {
                                                                                                                                        "summary": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "Short description of this branch's purpose"
                                                                                                                                        },
                                                                                                                                        "skip_failure": {
                                                                                                                                                "type": "boolean",
                                                                                                                                                "description": "If true, failure in this branch doesn't fail the entire flow"
                                                                                                                                        },
                                                                                                                                        "modules": {
                                                                                                                                                "type": "array",
                                                                                                                                                "description": "Steps to execute in this branch",
                                                                                                                                                "items": {
                                                                                                                                                        "type": "object"
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "required": [
                                                                                                                                        "modules"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "branchall"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "parallel": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, all branches execute concurrently. If false, they execute sequentially"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "branches",
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Pass-through module that returns its input unchanged. Useful for flow structure or as a placeholder",
                                                                                                        "properties": {
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "identity"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "flow": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, marks this as a flow identity (special handling)"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "AI agent step that can use tools to accomplish tasks. The agent receives inputs and can call any of its configured tools to complete the task",
                                                                                                        "properties": {
                                                                                                                "input_transforms": {
                                                                                                                        "type": "object",
                                                                                                                        "description": "Input parameters for the AI agent mapped to their values",
                                                                                                                        "properties": {
                                                                                                                                "provider": {
                                                                                                                                        "description": "Provider configuration - can be static (ProviderConfig), JavaScript expression, or AI-determined",
                                                                                                                                        "oneOf": [
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Static provider configuration passed directly to the AI agent",
                                                                                                                                                        "properties": {
                                                                                                                                                                "value": {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Complete AI provider configuration with resource reference and model selection",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "kind": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "Supported AI provider types",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "openai",
                                                                                                                                                                                                "azure_openai",
                                                                                                                                                                                                "anthropic",
                                                                                                                                                                                                "mistral",
                                                                                                                                                                                                "deepseek",
                                                                                                                                                                                                "googleai",
                                                                                                                                                                                                "groq",
                                                                                                                                                                                                "openrouter",
                                                                                                                                                                                                "togetherai",
                                                                                                                                                                                                "customai",
                                                                                                                                                                                                "aws_bedrock"
                                                                                                                                                                                        ]
                                                                                                                                                                                },
                                                                                                                                                                                "resource": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "Resource reference in format '$res:{resource_path}' pointing to provider credentials"
                                                                                                                                                                                },
                                                                                                                                                                                "model": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "Model identifier (e.g., 'gpt-4', 'claude-3-opus-20240229', 'gemini-pro')"
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "kind",
                                                                                                                                                                                "resource",
                                                                                                                                                                                "model"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "static"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type",
                                                                                                                                                                "value"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                        "properties": {
                                                                                                                                                                "expr": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "javascript"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "expr",
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                        "properties": {
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "ai"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "discriminator": {
                                                                                                                                                "propertyName": "type",
                                                                                                                                                "mapping": {
                                                                                                                                                        "static": "#/components/schemas/StaticProviderTransform",
                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "output_type": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "Output format type.\nValid values: 'text' (default) - plain text response, 'image' - image generation\n"
                                                                                                                                },
                                                                                                                                "user_message": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "The user's prompt/message to the AI agent. Supports variable interpolation with flow.input syntax."
                                                                                                                                },
                                                                                                                                "system_prompt": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "System instructions that guide the AI's behavior, persona, and response style. Optional."
                                                                                                                                },
                                                                                                                                "streaming": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "Boolean. If true, stream the AI response incrementally.\nStreaming events include: token_delta, tool_call, tool_call_arguments, tool_execution, tool_result\n"
                                                                                                                                },
                                                                                                                                "memory": {
                                                                                                                                        "description": "Memory configuration - can be static (MemoryConfig), JavaScript expression, or AI-determined",
                                                                                                                                        "oneOf": [
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Static memory configuration passed directly to the AI agent",
                                                                                                                                                        "properties": {
                                                                                                                                                                "value": {
                                                                                                                                                                        "description": "Conversation memory configuration",
                                                                                                                                                                        "oneOf": [
                                                                                                                                                                                {
                                                                                                                                                                                        "type": "object",
                                                                                                                                                                                        "description": "No conversation memory/context",
                                                                                                                                                                                        "properties": {
                                                                                                                                                                                                "kind": {
                                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                                "off"
                                                                                                                                                                                                        ]
                                                                                                                                                                                                }
                                                                                                                                                                                        },
                                                                                                                                                                                        "required": [
                                                                                                                                                                                                "kind"
                                                                                                                                                                                        ]
                                                                                                                                                                                },
                                                                                                                                                                                {
                                                                                                                                                                                        "type": "object",
                                                                                                                                                                                        "description": "Automatic context management",
                                                                                                                                                                                        "properties": {
                                                                                                                                                                                                "kind": {
                                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                                "auto"
                                                                                                                                                                                                        ]
                                                                                                                                                                                                },
                                                                                                                                                                                                "context_length": {
                                                                                                                                                                                                        "type": "integer",
                                                                                                                                                                                                        "description": "Maximum number of messages to retain in context"
                                                                                                                                                                                                },
                                                                                                                                                                                                "memory_id": {
                                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                                        "description": "Identifier for persistent memory across agent invocations"
                                                                                                                                                                                                }
                                                                                                                                                                                        },
                                                                                                                                                                                        "required": [
                                                                                                                                                                                                "kind"
                                                                                                                                                                                        ]
                                                                                                                                                                                },
                                                                                                                                                                                {
                                                                                                                                                                                        "type": "object",
                                                                                                                                                                                        "description": "Explicit message history",
                                                                                                                                                                                        "properties": {
                                                                                                                                                                                                "kind": {
                                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                                "manual"
                                                                                                                                                                                                        ]
                                                                                                                                                                                                },
                                                                                                                                                                                                "messages": {
                                                                                                                                                                                                        "type": "array",
                                                                                                                                                                                                        "items": {
                                                                                                                                                                                                                "type": "object",
                                                                                                                                                                                                                "description": "A single message in conversation history",
                                                                                                                                                                                                                "properties": {
                                                                                                                                                                                                                        "role": {
                                                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                                                        "user",
                                                                                                                                                                                                                                        "assistant",
                                                                                                                                                                                                                                        "system"
                                                                                                                                                                                                                                ]
                                                                                                                                                                                                                        },
                                                                                                                                                                                                                        "content": {
                                                                                                                                                                                                                                "type": "string"
                                                                                                                                                                                                                        }
                                                                                                                                                                                                                },
                                                                                                                                                                                                                "required": [
                                                                                                                                                                                                                        "role",
                                                                                                                                                                                                                        "content"
                                                                                                                                                                                                                ]
                                                                                                                                                                                                        }
                                                                                                                                                                                                }
                                                                                                                                                                                        },
                                                                                                                                                                                        "required": [
                                                                                                                                                                                                "kind",
                                                                                                                                                                                                "messages"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        ],
                                                                                                                                                                        "discriminator": {
                                                                                                                                                                                "propertyName": "kind",
                                                                                                                                                                                "mapping": {
                                                                                                                                                                                        "off": "#/components/schemas/MemoryOff",
                                                                                                                                                                                        "auto": "#/components/schemas/MemoryAuto",
                                                                                                                                                                                        "manual": "#/components/schemas/MemoryManual"
                                                                                                                                                                                }
                                                                                                                                                                        }
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "static"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type",
                                                                                                                                                                "value"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                        "properties": {
                                                                                                                                                                "expr": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                },
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "javascript"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "expr",
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                        "type": "object",
                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                        "properties": {
                                                                                                                                                                "type": {
                                                                                                                                                                        "type": "string",
                                                                                                                                                                        "enum": [
                                                                                                                                                                                "ai"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        },
                                                                                                                                                        "required": [
                                                                                                                                                                "type"
                                                                                                                                                        ]
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "discriminator": {
                                                                                                                                                "propertyName": "type",
                                                                                                                                                "mapping": {
                                                                                                                                                        "static": "#/components/schemas/StaticMemoryTransform",
                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "output_schema": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "JSON Schema object defining structured output format. Used when you need the AI to return data in a specific shape.\nSupports standard JSON Schema properties: type, properties, required, items, enum, pattern, minLength, maxLength, minimum, maximum, etc.\nExample: { type: 'object', properties: { name: { type: 'string' }, age: { type: 'integer' } }, required: ['name'] }\n"
                                                                                                                                },
                                                                                                                                "user_images": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "Array of image references for vision-capable models.\nFormat: Array<{ bucket: string, key: string }> - S3 object references\nExample: [{ bucket: 'my-bucket', key: 'images/photo.jpg' }]\n"
                                                                                                                                },
                                                                                                                                "max_completion_tokens": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "Integer. Maximum number of tokens the AI will generate in its response.\nRange: 1 to 4,294,967,295. Typical values: 256-4096 for most use cases.\n"
                                                                                                                                },
                                                                                                                                "temperature": {
                                                                                                                                        "allOf": [
                                                                                                                                                {
                                                                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                                                                        "oneOf": [
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "value": {
                                                                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "static"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "expr": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                                                                },
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "javascript"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "expr",
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                        "type": "object",
                                                                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                                                                        "properties": {
                                                                                                                                                                                "type": {
                                                                                                                                                                                        "type": "string",
                                                                                                                                                                                        "enum": [
                                                                                                                                                                                                "ai"
                                                                                                                                                                                        ]
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "required": [
                                                                                                                                                                                "type"
                                                                                                                                                                        ]
                                                                                                                                                                }
                                                                                                                                                        ],
                                                                                                                                                        "discriminator": {
                                                                                                                                                                "propertyName": "type",
                                                                                                                                                                "mapping": {
                                                                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                                                                }
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        ],
                                                                                                                                        "description": "Float. Controls randomness/creativity of responses.\nRange: 0.0 to 2.0 (provider-dependent)\n- 0.0 = deterministic, focused responses\n- 0.7 = balanced (common default)\n- 1.0+ = more creative/random\n"
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "required": [
                                                                                                                                "provider",
                                                                                                                                "user_message",
                                                                                                                                "output_type"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "tools": {
                                                                                                                        "type": "array",
                                                                                                                        "description": "Array of tools the agent can use. The agent decides which tools to call based on the task",
                                                                                                                        "items": {
                                                                                                                                "type": "object",
                                                                                                                                "description": "A tool available to an AI agent. Can be a flow module or an external MCP (Model Context Protocol) tool",
                                                                                                                                "properties": {
                                                                                                                                        "id": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "Unique identifier for this tool. Cannot contain spaces - use underscores instead (e.g., 'get_user_data' not 'get user data')"
                                                                                                                                        },
                                                                                                                                        "summary": {
                                                                                                                                                "type": "string",
                                                                                                                                                "description": "Short description of what this tool does (shown to the AI)"
                                                                                                                                        },
                                                                                                                                        "value": {
                                                                                                                                                "description": "The implementation of a tool. Can be a flow module (script/flow) or an MCP tool reference",
                                                                                                                                                "oneOf": [
                                                                                                                                                        {
                                                                                                                                                                "description": "A tool implemented as a flow module (script, flow, etc.). The AI can call this like any other flow module",
                                                                                                                                                                "allOf": [
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object",
                                                                                                                                                                                "properties": {
                                                                                                                                                                                        "tool_type": {
                                                                                                                                                                                                "type": "string",
                                                                                                                                                                                                "enum": [
                                                                                                                                                                                                        "flowmodule"
                                                                                                                                                                                                ]
                                                                                                                                                                                        }
                                                                                                                                                                                },
                                                                                                                                                                                "required": [
                                                                                                                                                                                        "tool_type"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                                "type": "object"
                                                                                                                                                                        }
                                                                                                                                                                ]
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                                "type": "object",
                                                                                                                                                                "description": "Reference to an external MCP (Model Context Protocol) tool. The AI can call tools from MCP servers",
                                                                                                                                                                "properties": {
                                                                                                                                                                        "tool_type": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "enum": [
                                                                                                                                                                                        "mcp"
                                                                                                                                                                                ]
                                                                                                                                                                        },
                                                                                                                                                                        "resource_path": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "description": "Path to the MCP resource/server configuration"
                                                                                                                                                                        },
                                                                                                                                                                        "include_tools": {
                                                                                                                                                                                "type": "array",
                                                                                                                                                                                "description": "Whitelist of specific tools to include from this MCP server",
                                                                                                                                                                                "items": {
                                                                                                                                                                                        "type": "string"
                                                                                                                                                                                }
                                                                                                                                                                        },
                                                                                                                                                                        "exclude_tools": {
                                                                                                                                                                                "type": "array",
                                                                                                                                                                                "description": "Blacklist of tools to exclude from this MCP server",
                                                                                                                                                                                "items": {
                                                                                                                                                                                        "type": "string"
                                                                                                                                                                                }
                                                                                                                                                                        }
                                                                                                                                                                },
                                                                                                                                                                "required": [
                                                                                                                                                                        "tool_type",
                                                                                                                                                                        "resource_path"
                                                                                                                                                                ]
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                                "type": "object",
                                                                                                                                                                "description": "A tool implemented as a websearch tool. The AI can call this like any other websearch tool",
                                                                                                                                                                "properties": {
                                                                                                                                                                        "tool_type": {
                                                                                                                                                                                "type": "string",
                                                                                                                                                                                "enum": [
                                                                                                                                                                                        "websearch"
                                                                                                                                                                                ]
                                                                                                                                                                        }
                                                                                                                                                                },
                                                                                                                                                                "required": [
                                                                                                                                                                        "tool_type"
                                                                                                                                                                ]
                                                                                                                                                        }
                                                                                                                                                ],
                                                                                                                                                "discriminator": {
                                                                                                                                                        "propertyName": "tool_type",
                                                                                                                                                        "mapping": {
                                                                                                                                                                "flowmodule": "#/components/schemas/FlowModuleTool",
                                                                                                                                                                "mcp": "#/components/schemas/McpToolValue",
                                                                                                                                                                "websearch": "#/components/schemas/WebsearchToolValue"
                                                                                                                                                        }
                                                                                                                                                }
                                                                                                                                        }
                                                                                                                                },
                                                                                                                                "required": [
                                                                                                                                        "id",
                                                                                                                                        "value"
                                                                                                                                ]
                                                                                                                        }
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "aiagent"
                                                                                                                        ]
                                                                                                                },
                                                                                                                "parallel": {
                                                                                                                        "type": "boolean",
                                                                                                                        "description": "If true, the agent can execute multiple tool calls in parallel"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "tools",
                                                                                                                "type",
                                                                                                                "input_transforms"
                                                                                                        ]
                                                                                                }
                                                                                        ],
                                                                                        "discriminator": {
                                                                                                "propertyName": "type",
                                                                                                "mapping": {
                                                                                                        "rawscript": "#/components/schemas/RawScript",
                                                                                                        "script": "#/components/schemas/PathScript",
                                                                                                        "flow": "#/components/schemas/PathFlow",
                                                                                                        "forloopflow": "#/components/schemas/ForloopFlow",
                                                                                                        "whileloopflow": "#/components/schemas/WhileloopFlow",
                                                                                                        "branchone": "#/components/schemas/BranchOne",
                                                                                                        "branchall": "#/components/schemas/BranchAll",
                                                                                                        "identity": "#/components/schemas/Identity",
                                                                                                        "aiagent": "#/components/schemas/AiAgent"
                                                                                                }
                                                                                        }
                                                                                },
                                                                                "stop_after_if": {
                                                                                        "type": "object",
                                                                                        "description": "Early termination condition for a module",
                                                                                        "properties": {
                                                                                                "skip_if_stopped": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, following steps are skipped when this condition triggers"
                                                                                                },
                                                                                                "expr": {
                                                                                                        "type": "string",
                                                                                                        "description": "JavaScript expression evaluated after the module runs. Can use 'result' (step's result) or 'flow_input'. Return true to stop"
                                                                                                },
                                                                                                "error_message": {
                                                                                                        "type": "string",
                                                                                                        "description": "Custom error message shown when stopping"
                                                                                                }
                                                                                        },
                                                                                        "required": [
                                                                                                "expr"
                                                                                        ]
                                                                                },
                                                                                "stop_after_all_iters_if": {
                                                                                        "type": "object",
                                                                                        "description": "Early termination condition for a module",
                                                                                        "properties": {
                                                                                                "skip_if_stopped": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, following steps are skipped when this condition triggers"
                                                                                                },
                                                                                                "expr": {
                                                                                                        "type": "string",
                                                                                                        "description": "JavaScript expression evaluated after the module runs. Can use 'result' (step's result) or 'flow_input'. Return true to stop"
                                                                                                },
                                                                                                "error_message": {
                                                                                                        "type": "string",
                                                                                                        "description": "Custom error message shown when stopping"
                                                                                                }
                                                                                        },
                                                                                        "required": [
                                                                                                "expr"
                                                                                        ]
                                                                                },
                                                                                "skip_if": {
                                                                                        "type": "object",
                                                                                        "description": "Conditionally skip this step based on previous results or flow inputs",
                                                                                        "properties": {
                                                                                                "expr": {
                                                                                                        "type": "string",
                                                                                                        "description": "JavaScript expression that returns true to skip. Can use 'flow_input' or 'results.<step_id>'"
                                                                                                }
                                                                                        },
                                                                                        "required": [
                                                                                                "expr"
                                                                                        ]
                                                                                },
                                                                                "sleep": {
                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                        "oneOf": [
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                        "properties": {
                                                                                                                "value": {
                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "static"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                        "properties": {
                                                                                                                "expr": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "javascript"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "expr",
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                        "properties": {
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "ai"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type"
                                                                                                        ]
                                                                                                }
                                                                                        ],
                                                                                        "discriminator": {
                                                                                                "propertyName": "type",
                                                                                                "mapping": {
                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                }
                                                                                        }
                                                                                },
                                                                                "cache_ttl": {
                                                                                        "type": "number",
                                                                                        "description": "Cache duration in seconds for this step's results"
                                                                                },
                                                                                "cache_ignore_s3_path": {
                                                                                        "type": "boolean"
                                                                                },
                                                                                "timeout": {
                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                        "oneOf": [
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                        "properties": {
                                                                                                                "value": {
                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "static"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                        "properties": {
                                                                                                                "expr": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                },
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "javascript"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "expr",
                                                                                                                "type"
                                                                                                        ]
                                                                                                },
                                                                                                {
                                                                                                        "type": "object",
                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                        "properties": {
                                                                                                                "type": {
                                                                                                                        "type": "string",
                                                                                                                        "enum": [
                                                                                                                                "ai"
                                                                                                                        ]
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "type"
                                                                                                        ]
                                                                                                }
                                                                                        ],
                                                                                        "discriminator": {
                                                                                                "propertyName": "type",
                                                                                                "mapping": {
                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                }
                                                                                        }
                                                                                },
                                                                                "delete_after_use": {
                                                                                        "type": "boolean",
                                                                                        "description": "If true, this step's result is deleted after use to save memory"
                                                                                },
                                                                                "summary": {
                                                                                        "type": "string",
                                                                                        "description": "Short description of what this step does"
                                                                                },
                                                                                "mock": {
                                                                                        "type": "object",
                                                                                        "description": "Mock configuration for testing without executing the actual step",
                                                                                        "properties": {
                                                                                                "enabled": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, return mock value instead of executing"
                                                                                                },
                                                                                                "return_value": {
                                                                                                        "description": "Value to return when mocked"
                                                                                                }
                                                                                        }
                                                                                },
                                                                                "suspend": {
                                                                                        "type": "object",
                                                                                        "description": "Configuration for approval/resume steps that wait for user input",
                                                                                        "properties": {
                                                                                                "required_events": {
                                                                                                        "type": "integer",
                                                                                                        "description": "Number of approvals required before continuing"
                                                                                                },
                                                                                                "timeout": {
                                                                                                        "type": "integer",
                                                                                                        "description": "Timeout in seconds before auto-continuing or canceling"
                                                                                                },
                                                                                                "resume_form": {
                                                                                                        "type": "object",
                                                                                                        "description": "Form schema for collecting input when resuming",
                                                                                                        "properties": {
                                                                                                                "schema": {
                                                                                                                        "type": "object",
                                                                                                                        "description": "JSON Schema for the resume form"
                                                                                                                }
                                                                                                        }
                                                                                                },
                                                                                                "user_auth_required": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, only authenticated users can approve"
                                                                                                },
                                                                                                "user_groups_required": {
                                                                                                        "description": "Maps input parameters for a step. Can be a static value or a JavaScript expression that references previous results or flow inputs",
                                                                                                        "oneOf": [
                                                                                                                {
                                                                                                                        "type": "object",
                                                                                                                        "description": "Static value passed directly to the step. Use for hardcoded values or resource references like '$res:path/to/resource'",
                                                                                                                        "properties": {
                                                                                                                                "value": {
                                                                                                                                        "description": "The static value. For resources, use format '$res:path/to/resource'"
                                                                                                                                },
                                                                                                                                "type": {
                                                                                                                                        "type": "string",
                                                                                                                                        "enum": [
                                                                                                                                                "static"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "required": [
                                                                                                                                "type"
                                                                                                                        ]
                                                                                                                },
                                                                                                                {
                                                                                                                        "type": "object",
                                                                                                                        "description": "JavaScript expression evaluated at runtime. Can reference previous step results via 'results.step_id' or flow inputs via 'flow_input.property'. Inside loops, use 'flow_input.iter.value' for the current iteration value",
                                                                                                                        "properties": {
                                                                                                                                "expr": {
                                                                                                                                        "type": "string",
                                                                                                                                        "description": "JavaScript expression returning the value. Available variables - results (object with all previous step results), flow_input (flow inputs), flow_input.iter (in loops)"
                                                                                                                                },
                                                                                                                                "type": {
                                                                                                                                        "type": "string",
                                                                                                                                        "enum": [
                                                                                                                                                "javascript"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "required": [
                                                                                                                                "expr",
                                                                                                                                "type"
                                                                                                                        ]
                                                                                                                },
                                                                                                                {
                                                                                                                        "type": "object",
                                                                                                                        "description": "Value resolved by the AI runtime for this input. The AI engine decides how to satisfy the parameter.",
                                                                                                                        "properties": {
                                                                                                                                "type": {
                                                                                                                                        "type": "string",
                                                                                                                                        "enum": [
                                                                                                                                                "ai"
                                                                                                                                        ]
                                                                                                                                }
                                                                                                                        },
                                                                                                                        "required": [
                                                                                                                                "type"
                                                                                                                        ]
                                                                                                                }
                                                                                                        ],
                                                                                                        "discriminator": {
                                                                                                                "propertyName": "type",
                                                                                                                "mapping": {
                                                                                                                        "static": "#/components/schemas/StaticTransform",
                                                                                                                        "javascript": "#/components/schemas/JavascriptTransform",
                                                                                                                        "ai": "#/components/schemas/AiTransform"
                                                                                                                }
                                                                                                        }
                                                                                                },
                                                                                                "self_approval_disabled": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, the user who started the flow cannot approve"
                                                                                                },
                                                                                                "hide_cancel": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, hide the cancel button on the approval form"
                                                                                                },
                                                                                                "continue_on_disapprove_timeout": {
                                                                                                        "type": "boolean",
                                                                                                        "description": "If true, continue flow on timeout instead of canceling"
                                                                                                }
                                                                                        }
                                                                                },
                                                                                "priority": {
                                                                                        "type": "number",
                                                                                        "description": "Execution priority for this step (higher numbers run first)"
                                                                                },
                                                                                "continue_on_error": {
                                                                                        "type": "boolean",
                                                                                        "description": "If true, flow continues even if this step fails"
                                                                                },
                                                                                "retry": {
                                                                                        "type": "object",
                                                                                        "description": "Retry configuration for failed module executions",
                                                                                        "properties": {
                                                                                                "constant": {
                                                                                                        "type": "object",
                                                                                                        "description": "Retry with constant delay between attempts",
                                                                                                        "properties": {
                                                                                                                "attempts": {
                                                                                                                        "type": "integer",
                                                                                                                        "description": "Number of retry attempts"
                                                                                                                },
                                                                                                                "seconds": {
                                                                                                                        "type": "integer",
                                                                                                                        "description": "Seconds to wait between retries"
                                                                                                                }
                                                                                                        }
                                                                                                },
                                                                                                "exponential": {
                                                                                                        "type": "object",
                                                                                                        "description": "Retry with exponential backoff (delay doubles each time)",
                                                                                                        "properties": {
                                                                                                                "attempts": {
                                                                                                                        "type": "integer",
                                                                                                                        "description": "Number of retry attempts"
                                                                                                                },
                                                                                                                "multiplier": {
                                                                                                                        "type": "integer",
                                                                                                                        "description": "Multiplier for exponential backoff"
                                                                                                                },
                                                                                                                "seconds": {
                                                                                                                        "type": "integer",
                                                                                                                        "minimum": 1,
                                                                                                                        "description": "Initial delay in seconds"
                                                                                                                },
                                                                                                                "random_factor": {
                                                                                                                        "type": "integer",
                                                                                                                        "minimum": 0,
                                                                                                                        "maximum": 100,
                                                                                                                        "description": "Random jitter percentage (0-100) to avoid thundering herd"
                                                                                                                }
                                                                                                        }
                                                                                                },
                                                                                                "retry_if": {
                                                                                                        "type": "object",
                                                                                                        "description": "Conditional retry based on error or result",
                                                                                                        "properties": {
                                                                                                                "expr": {
                                                                                                                        "type": "string",
                                                                                                                        "description": "JavaScript expression that returns true to retry. Has access to 'result' and 'error' variables"
                                                                                                                }
                                                                                                        },
                                                                                                        "required": [
                                                                                                                "expr"
                                                                                                        ]
                                                                                                }
                                                                                        }
                                                                                }
                                                                        },
                                                                        "required": [
                                                                                "value",
                                                                                "id"
                                                                        ]
                                                                },
                                                                "same_worker": {
                                                                        "type": "boolean",
                                                                        "description": "If true, all steps run on the same worker for better performance"
                                                                },
                                                                "concurrent_limit": {
                                                                        "type": "number",
                                                                        "description": "Maximum number of concurrent executions of this flow"
                                                                },
                                                                "concurrency_key": {
                                                                        "type": "string",
                                                                        "description": "Expression to group concurrent executions (e.g., by user ID)"
                                                                },
                                                                "concurrency_time_window_s": {
                                                                        "type": "number",
                                                                        "description": "Time window in seconds for concurrent_limit"
                                                                },
                                                                "debounce_delay_s": {
                                                                        "type": "number",
                                                                        "description": "Delay in seconds to debounce flow executions"
                                                                },
                                                                "debounce_key": {
                                                                        "type": "string",
                                                                        "description": "Expression to group debounced executions"
                                                                },
                                                                "debounce_args_to_accumulate": {
                                                                        "type": "array",
                                                                        "description": "Arguments to accumulate across debounced executions",
                                                                        "items": {
                                                                                "type": "string"
                                                                        }
                                                                },
                                                                "max_total_debouncing_time": {
                                                                        "type": "number",
                                                                        "description": "Maximum total time in seconds that a job can be debounced"
                                                                },
                                                                "max_total_debounces_amount": {
                                                                        "type": "number",
                                                                        "description": "Maximum number of times a job can be debounced"
                                                                },
                                                                "skip_expr": {
                                                                        "type": "string",
                                                                        "description": "JavaScript expression to conditionally skip the entire flow"
                                                                },
                                                                "cache_ttl": {
                                                                        "type": "number",
                                                                        "description": "Cache duration in seconds for flow results"
                                                                },
                                                                "cache_ignore_s3_path": {
                                                                        "type": "boolean"
                                                                },
                                                                "flow_env": {
                                                                        "type": "object",
                                                                        "description": "Environment variables available to all steps",
                                                                        "additionalProperties": {
                                                                                "type": "string"
                                                                        }
                                                                },
                                                                "priority": {
                                                                        "type": "number",
                                                                        "description": "Execution priority (higher numbers run first)"
                                                                },
                                                                "early_return": {
                                                                        "type": "string",
                                                                        "description": "JavaScript expression to return early from the flow"
                                                                },
                                                                "chat_input_enabled": {
                                                                        "type": "boolean",
                                                                        "description": "Whether this flow accepts chat-style input"
                                                                },
                                                                "notes": {
                                                                        "type": "array",
                                                                        "description": "Sticky notes attached to the flow",
                                                                        "items": {
                                                                                "type": "object",
                                                                                "description": "A sticky note attached to a flow for documentation and annotation",
                                                                                "properties": {
                                                                                        "id": {
                                                                                                "type": "string",
                                                                                                "description": "Unique identifier for the note"
                                                                                        },
                                                                                        "text": {
                                                                                                "type": "string",
                                                                                                "description": "Content of the note"
                                                                                        },
                                                                                        "position": {
                                                                                                "type": "object",
                                                                                                "description": "Position of the note in the flow editor",
                                                                                                "properties": {
                                                                                                        "x": {
                                                                                                                "type": "number",
                                                                                                                "description": "X coordinate"
                                                                                                        },
                                                                                                        "y": {
                                                                                                                "type": "number",
                                                                                                                "description": "Y coordinate"
                                                                                                        }
                                                                                                },
                                                                                                "required": [
                                                                                                        "x",
                                                                                                        "y"
                                                                                                ]
                                                                                        },
                                                                                        "size": {
                                                                                                "type": "object",
                                                                                                "description": "Size of the note in the flow editor",
                                                                                                "properties": {
                                                                                                        "width": {
                                                                                                                "type": "number",
                                                                                                                "description": "Width in pixels"
                                                                                                        },
                                                                                                        "height": {
                                                                                                                "type": "number",
                                                                                                                "description": "Height in pixels"
                                                                                                        }
                                                                                                },
                                                                                                "required": [
                                                                                                        "width",
                                                                                                        "height"
                                                                                                ]
                                                                                        },
                                                                                        "color": {
                                                                                                "type": "string",
                                                                                                "description": "Color of the note (e.g., \"yellow\", \"#ffff00\")"
                                                                                        },
                                                                                        "type": {
                                                                                                "type": "string",
                                                                                                "enum": [
                                                                                                        "free",
                                                                                                        "group"
                                                                                                ],
                                                                                                "description": "Type of note - 'free' for standalone notes, 'group' for notes that group other nodes"
                                                                                        },
                                                                                        "locked": {
                                                                                                "type": "boolean",
                                                                                                "default": false,
                                                                                                "description": "Whether the note is locked and cannot be edited or moved"
                                                                                        },
                                                                                        "contained_node_ids": {
                                                                                                "type": "array",
                                                                                                "items": {
                                                                                                        "type": "string"
                                                                                                },
                                                                                                "description": "For group notes, the IDs of nodes contained within this group"
                                                                                        }
                                                                                },
                                                                                "required": [
                                                                                        "id",
                                                                                        "text",
                                                                                        "color",
                                                                                        "type"
                                                                                ]
                                                                        }
                                                                }
                                                        },
                                                        "required": [
                                                                "modules"
                                                        ]
                                                },
                                                "schema": {
                                                        "type": "object",
                                                        "description": "JSON Schema for flow inputs. Use this to define input parameters, their types, defaults, and validation. For resource inputs, set type to 'object' and format to 'resource-<type>' (e.g., 'resource-stripe')"
                                                }
                                        },
                                        "required": [
                                                "summary",
                                                "value"
                                        ]
                                },
                                {
                                        "type": "object",
                                        "properties": {
                                                "path": {
                                                        "type": "string"
                                                },
                                                "tag": {
                                                        "type": "string"
                                                },
                                                "ws_error_handler_muted": {
                                                        "type": "boolean"
                                                },
                                                "priority": {
                                                        "type": "integer"
                                                },
                                                "dedicated_worker": {
                                                        "type": "boolean"
                                                },
                                                "timeout": {
                                                        "type": "number"
                                                },
                                                "visible_to_runner_only": {
                                                        "type": "boolean"
                                                },
                                                "on_behalf_of_email": {
                                                        "type": "string"
                                                }
                                        },
                                        "required": [
                                                "path"
                                        ]
                                }
                        ]
                },
                {
                        "type": "object",
                        "properties": {
                                "deployment_message": {
                                        "type": "string"
                                }
                        }
                }
        ]
}
    },
    {
        name: "deleteFlowByPath",
        description: "delete flow by path",
        instructions: "",
        path: "/w/{workspace}/flows/delete/{path}",
        method: "DELETE",
        pathParamsSchema: {
        "type": "object",
        "properties": {
                "path": {
                        "type": "string"
                }
        },
        "required": [
                "path"
        ]
},
        queryParamsSchema: {
        "type": "object",
        "properties": {
                "keep_captures": {
                        "type": "boolean",
                        "description": "keep captures"
                }
        },
        "required": []
},
        bodySchema: undefined
    },
    {
        name: "createApp",
        description: "create app",
        instructions: "",
        path: "/w/{workspace}/apps/create",
        method: "POST",
        pathParamsSchema: undefined,
        queryParamsSchema: undefined,
        bodySchema: {
        "type": "object",
        "properties": {
                "path": {
                        "type": "string"
                },
                "value": {},
                "summary": {
                        "type": "string"
                },
                "policy": {
                        "type": "object",
                        "properties": {
                                "triggerables": {
                                        "type": "object",
                                        "additionalProperties": {
                                                "type": "object"
                                        }
                                },
                                "triggerables_v2": {
                                        "type": "object",
                                        "additionalProperties": {
                                                "type": "object"
                                        }
                                },
                                "s3_inputs": {
                                        "type": "array",
                                        "items": {
                                                "type": "object"
                                        }
                                },
                                "allowed_s3_keys": {
                                        "type": "array",
                                        "items": {
                                                "type": "object",
                                                "properties": {
                                                        "s3_path": {
                                                                "type": "string"
                                                        },
                                                        "resource": {
                                                                "type": "string"
                                                        }
                                                }
                                        }
                                },
                                "execution_mode": {
                                        "type": "string",
                                        "enum": [
                                                "viewer",
                                                "publisher",
                                                "anonymous"
                                        ]
                                },
                                "on_behalf_of": {
                                        "type": "string"
                                },
                                "on_behalf_of_email": {
                                        "type": "string"
                                }
                        }
                },
                "draft_only": {
                        "type": "boolean"
                },
                "deployment_message": {
                        "type": "string"
                },
                "custom_path": {
                        "type": "string"
                }
        },
        "required": [
                "path",
                "value",
                "summary",
                "policy"
        ]
}
    },
    {
        name: "updateApp",
        description: "update app",
        instructions: "",
        path: "/w/{workspace}/apps/update/{path}",
        method: "POST",
        pathParamsSchema: {
        "type": "object",
        "properties": {
                "path": {
                        "type": "string"
                }
        },
        "required": [
                "path"
        ]
},
        queryParamsSchema: undefined,
        bodySchema: {
        "type": "object",
        "properties": {
                "path": {
                        "type": "string"
                },
                "summary": {
                        "type": "string"
                },
                "value": {},
                "policy": {
                        "type": "object",
                        "properties": {
                                "triggerables": {
                                        "type": "object",
                                        "additionalProperties": {
                                                "type": "object"
                                        }
                                },
                                "triggerables_v2": {
                                        "type": "object",
                                        "additionalProperties": {
                                                "type": "object"
                                        }
                                },
                                "s3_inputs": {
                                        "type": "array",
                                        "items": {
                                                "type": "object"
                                        }
                                },
                                "allowed_s3_keys": {
                                        "type": "array",
                                        "items": {
                                                "type": "object",
                                                "properties": {
                                                        "s3_path": {
                                                                "type": "string"
                                                        },
                                                        "resource": {
                                                                "type": "string"
                                                        }
                                                }
                                        }
                                },
                                "execution_mode": {
                                        "type": "string",
                                        "enum": [
                                                "viewer",
                                                "publisher",
                                                "anonymous"
                                        ]
                                },
                                "on_behalf_of": {
                                        "type": "string"
                                },
                                "on_behalf_of_email": {
                                        "type": "string"
                                }
                        }
                },
                "deployment_message": {
                        "type": "string"
                },
                "custom_path": {
                        "type": "string"
                }
        }
}
    },
    {
        name: "runFlowByPath",
        description: "run flow by path",
        instructions: "",
        path: "/w/{workspace}/jobs/run/f/{path}",
        method: "POST",
        pathParamsSchema: {
        "type": "object",
        "properties": {
                "path": {
                        "type": "string"
                }
        },
        "required": [
                "path"
        ]
},
        queryParamsSchema: {
        "type": "object",
        "properties": {
                "scheduled_for": {
                        "type": "string",
                        "format": "date-time",
                        "description": "when to schedule this job (leave empty for immediate run)"
                },
                "scheduled_in_secs": {
                        "type": "integer",
                        "description": "schedule the script to execute in the number of seconds starting now"
                },
                "skip_preprocessor": {
                        "type": "boolean",
                        "description": "skip the preprocessor"
                },
                "parent_job": {
                        "type": "string",
                        "format": "uuid",
                        "description": "The parent job that is at the origin and responsible for the execution of this script if any"
                },
                "tag": {
                        "type": "string",
                        "description": "Override the tag to use"
                },
                "job_id": {
                        "type": "string",
                        "format": "uuid",
                        "description": "The job id to assign to the created job. if missing, job is chosen randomly using the ULID scheme. If a job id already exists in the queue or as a completed job, the request to create one will fail (Bad Request)"
                },
                "include_header": {
                        "type": "string",
                        "description": "List of headers's keys (separated with ',') whove value are added to the args\nHeader's key lowercased and '-'' replaced to '_' such that 'Content-Type' becomes the 'content_type' arg key\n"
                },
                "invisible_to_owner": {
                        "type": "boolean",
                        "description": "make the run invisible to the the flow owner (default false)"
                },
                "memory_id": {
                        "type": "string",
                        "format": "uuid",
                        "description": "memory ID for chat-enabled flows"
                }
        },
        "required": []
},
        bodySchema: {
        "type": "object",
        "description": "The arguments to pass to the script or flow",
        "additionalProperties": {}
}
    },
    {
        name: "runScriptPreviewAndWaitResult",
        description: "run script preview and wait for result",
        instructions: "Allows testing a script before deploying it. For typescript code, the language to send is either bun or deno. By default, send bun if no deno specific code is detected.",
        path: "/w/{workspace}/jobs/run_wait_result/preview",
        method: "POST",
        pathParamsSchema: undefined,
        queryParamsSchema: undefined,
        bodySchema: {
        "type": "object",
        "properties": {
                "content": {
                        "type": "string",
                        "description": "The code to run"
                },
                "path": {
                        "type": "string",
                        "description": "The path to the script"
                },
                "script_hash": {
                        "type": "string",
                        "description": "The hash of the script"
                },
                "args": {
                        "type": "object",
                        "description": "The arguments to pass to the script or flow",
                        "additionalProperties": {}
                },
                "language": {
                        "type": "string",
                        "enum": [
                                "python3",
                                "deno",
                                "go",
                                "bash",
                                "powershell",
                                "postgresql",
                                "mysql",
                                "bigquery",
                                "snowflake",
                                "mssql",
                                "oracledb",
                                "graphql",
                                "nativets",
                                "bun",
                                "php",
                                "rust",
                                "ansible",
                                "csharp",
                                "nu",
                                "java",
                                "ruby",
                                "duckdb",
                                "bunnative"
                        ]
                },
                "tag": {
                        "type": "string"
                },
                "kind": {
                        "type": "string",
                        "enum": [
                                "code",
                                "identity",
                                "http"
                        ]
                },
                "dedicated_worker": {
                        "type": "boolean"
                },
                "lock": {
                        "type": "string"
                }
        },
        "required": [
                "args",
                "content",
                "language"
        ]
}
    },
    {
        name: "listQueue",
        description: "list all queued jobs",
        instructions: "",
        path: "/w/{workspace}/jobs/queue/list",
        method: "GET",
        pathParamsSchema: undefined,
        queryParamsSchema: {
        "type": "object",
        "properties": {
                "order_desc": {
                        "type": "boolean",
                        "description": "order by desc order (default true)"
                },
                "created_by": {
                        "type": "string",
                        "description": "mask to filter exact matching user creator"
                },
                "parent_job": {
                        "type": "string",
                        "format": "uuid",
                        "description": "The parent job that is at the origin and responsible for the execution of this script if any"
                },
                "worker": {
                        "type": "string",
                        "description": "worker this job was ran on"
                },
                "script_path_exact": {
                        "type": "string",
                        "description": "mask to filter exact matching path"
                },
                "script_path_start": {
                        "type": "string",
                        "description": "mask to filter matching starting path"
                },
                "schedule_path": {
                        "type": "string",
                        "description": "mask to filter by schedule path"
                },
                "trigger_path": {
                        "type": "string",
                        "description": "mask to filter by trigger path"
                },
                "trigger_kind": {
                        "description": "trigger kind (schedule, http, websocket...)",
                        "type": "string",
                        "enum": [
                                "webhook",
                                "default_email",
                                "email",
                                "schedule",
                                "http",
                                "websocket",
                                "postgres",
                                "kafka",
                                "nats",
                                "mqtt",
                                "sqs",
                                "gcp"
                        ]
                },
                "script_hash": {
                        "type": "string",
                        "description": "mask to filter exact matching path"
                },
                "started_before": {
                        "type": "string",
                        "format": "date-time",
                        "description": "filter on started before (inclusive) timestamp"
                },
                "started_after": {
                        "type": "string",
                        "format": "date-time",
                        "description": "filter on started after (exclusive) timestamp"
                },
                "success": {
                        "type": "boolean",
                        "description": "filter on successful jobs"
                },
                "scheduled_for_before_now": {
                        "type": "boolean",
                        "description": "filter on jobs scheduled_for before now (hence waitinf for a worker)"
                },
                "job_kinds": {
                        "type": "string",
                        "description": "filter on job kind (values 'preview', 'script', 'dependencies', 'flow') separated by,"
                },
                "suspended": {
                        "type": "boolean",
                        "description": "filter on suspended jobs"
                },
                "running": {
                        "type": "boolean",
                        "description": "filter on running jobs"
                },
                "args": {
                        "type": "string",
                        "description": "filter on jobs containing those args as a json subset (@> in postgres)"
                },
                "result": {
                        "type": "string",
                        "description": "filter on jobs containing those result as a json subset (@> in postgres)"
                },
                "allow_wildcards": {
                        "type": "boolean",
                        "description": "allow wildcards (*) in the filter of label, tag, worker"
                },
                "tag": {
                        "type": "string",
                        "description": "filter on jobs with a given tag/worker group"
                },
                "page": {
                        "type": "integer",
                        "description": "which page to return (start at 1, default 1)"
                },
                "per_page": {
                        "type": "integer",
                        "description": "number of items to return for a given page (default 30, max 100)"
                },
                "all_workspaces": {
                        "type": "boolean",
                        "description": "get jobs from all workspaces (only valid if request come from the `admins` workspace)"
                },
                "is_not_schedule": {
                        "type": "boolean",
                        "description": "is not a scheduled job"
                }
        },
        "required": []
},
        bodySchema: undefined
    },
    {
        name: "listJobs",
        description: "list all jobs",
        instructions: "",
        path: "/w/{workspace}/jobs/list",
        method: "GET",
        pathParamsSchema: undefined,
        queryParamsSchema: {
        "type": "object",
        "properties": {
                "created_by": {
                        "type": "string",
                        "description": "mask to filter exact matching user creator"
                },
                "label": {
                        "type": "string",
                        "description": "mask to filter exact matching job's label (job labels are completed jobs with as a result an object containing a string in the array at key 'wm_labels')"
                },
                "worker": {
                        "type": "string",
                        "description": "worker this job was ran on"
                },
                "parent_job": {
                        "type": "string",
                        "format": "uuid",
                        "description": "The parent job that is at the origin and responsible for the execution of this script if any"
                },
                "script_path_exact": {
                        "type": "string",
                        "description": "mask to filter exact matching path"
                },
                "script_path_start": {
                        "type": "string",
                        "description": "mask to filter matching starting path"
                },
                "schedule_path": {
                        "type": "string",
                        "description": "mask to filter by schedule path"
                },
                "script_hash": {
                        "type": "string",
                        "description": "mask to filter exact matching path"
                },
                "started_before": {
                        "type": "string",
                        "format": "date-time",
                        "description": "filter on started before (inclusive) timestamp"
                },
                "started_after": {
                        "type": "string",
                        "format": "date-time",
                        "description": "filter on started after (exclusive) timestamp"
                },
                "created_before": {
                        "type": "string",
                        "format": "date-time",
                        "description": "filter on created before (inclusive) timestamp"
                },
                "created_after": {
                        "type": "string",
                        "format": "date-time",
                        "description": "filter on created after (exclusive) timestamp"
                },
                "completed_before": {
                        "type": "string",
                        "format": "date-time",
                        "description": "filter on started before (inclusive) timestamp"
                },
                "completed_after": {
                        "type": "string",
                        "format": "date-time",
                        "description": "filter on started after (exclusive) timestamp"
                },
                "created_before_queue": {
                        "type": "string",
                        "format": "date-time",
                        "description": "filter on jobs created before X for jobs in the queue only"
                },
                "created_after_queue": {
                        "type": "string",
                        "format": "date-time",
                        "description": "filter on jobs created after X for jobs in the queue only"
                },
                "running": {
                        "type": "boolean",
                        "description": "filter on running jobs"
                },
                "scheduled_for_before_now": {
                        "type": "boolean",
                        "description": "filter on jobs scheduled_for before now (hence waitinf for a worker)"
                },
                "job_kinds": {
                        "type": "string",
                        "description": "filter on job kind (values 'preview', 'script', 'dependencies', 'flow') separated by,"
                },
                "suspended": {
                        "type": "boolean",
                        "description": "filter on suspended jobs"
                },
                "args": {
                        "type": "string",
                        "description": "filter on jobs containing those args as a json subset (@> in postgres)"
                },
                "tag": {
                        "type": "string",
                        "description": "filter on jobs with a given tag/worker group"
                },
                "result": {
                        "type": "string",
                        "description": "filter on jobs containing those result as a json subset (@> in postgres)"
                },
                "allow_wildcards": {
                        "type": "boolean",
                        "description": "allow wildcards (*) in the filter of label, tag, worker"
                },
                "per_page": {
                        "type": "integer",
                        "description": "number of items to return for a given page (default 30, max 100)"
                },
                "trigger_kind": {
                        "description": "trigger kind (schedule, http, websocket...)",
                        "type": "string",
                        "enum": [
                                "webhook",
                                "default_email",
                                "email",
                                "schedule",
                                "http",
                                "websocket",
                                "postgres",
                                "kafka",
                                "nats",
                                "mqtt",
                                "sqs",
                                "gcp"
                        ]
                },
                "is_skipped": {
                        "type": "boolean",
                        "description": "is the job skipped"
                },
                "is_flow_step": {
                        "type": "boolean",
                        "description": "is the job a flow step"
                },
                "has_null_parent": {
                        "type": "boolean",
                        "description": "has null parent"
                },
                "success": {
                        "type": "boolean",
                        "description": "filter on successful jobs"
                },
                "all_workspaces": {
                        "type": "boolean",
                        "description": "get jobs from all workspaces (only valid if request come from the `admins` workspace)"
                },
                "is_not_schedule": {
                        "type": "boolean",
                        "description": "is not a scheduled job"
                }
        },
        "required": []
},
        bodySchema: undefined
    },
    {
        name: "createSchedule",
        description: "create schedule",
        instructions: "Creates a new schedule.\nThe schedule should include seconds.\nYou should get the schema of the script or flow before creating the schedule to correctly specify the arguments needed.\n",
        path: "/w/{workspace}/schedules/create",
        method: "POST",
        pathParamsSchema: undefined,
        queryParamsSchema: undefined,
        bodySchema: {
        "type": "object",
        "properties": {
                "path": {
                        "type": "string",
                        "description": "The unique path identifier for this schedule"
                },
                "schedule": {
                        "type": "string",
                        "description": "Cron expression with 6 fields (seconds, minutes, hours, day of month, month, day of week). Example '0 0 12 * * *' for daily at noon"
                },
                "timezone": {
                        "type": "string",
                        "description": "IANA timezone for the schedule (e.g., 'UTC', 'Europe/Paris', 'America/New_York')"
                },
                "script_path": {
                        "type": "string",
                        "description": "Path to the script or flow to execute when triggered"
                },
                "is_flow": {
                        "type": "boolean",
                        "description": "True if script_path points to a flow, false if it points to a script"
                },
                "args": {
                        "type": "object",
                        "description": "The arguments to pass to the script or flow",
                        "additionalProperties": {}
                },
                "enabled": {
                        "type": "boolean",
                        "description": "Whether the schedule is currently active and will trigger jobs"
                },
                "on_failure": {
                        "type": "string",
                        "description": "Path to a script or flow to run when the scheduled job fails"
                },
                "on_failure_times": {
                        "type": "number",
                        "description": "Number of consecutive failures before the on_failure handler is triggered (default 1)"
                },
                "on_failure_exact": {
                        "type": "boolean",
                        "description": "If true, trigger on_failure handler only on exactly N failures, not on every failure after N"
                },
                "on_failure_extra_args": {
                        "type": "object",
                        "description": "The arguments to pass to the script or flow",
                        "additionalProperties": {}
                },
                "on_recovery": {
                        "type": "string",
                        "description": "Path to a script or flow to run when the schedule recovers after failures"
                },
                "on_recovery_times": {
                        "type": "number",
                        "description": "Number of consecutive successes before the on_recovery handler is triggered (default 1)"
                },
                "on_recovery_extra_args": {
                        "type": "object",
                        "description": "The arguments to pass to the script or flow",
                        "additionalProperties": {}
                },
                "on_success": {
                        "type": "string",
                        "description": "Path to a script or flow to run after each successful execution"
                },
                "on_success_extra_args": {
                        "type": "object",
                        "description": "The arguments to pass to the script or flow",
                        "additionalProperties": {}
                },
                "ws_error_handler_muted": {
                        "type": "boolean",
                        "description": "If true, the workspace-level error handler will not be triggered for this schedule's failures"
                },
                "retry": {
                        "type": "object",
                        "description": "Retry configuration for failed module executions",
                        "properties": {
                                "constant": {
                                        "type": "object",
                                        "description": "Retry with constant delay between attempts",
                                        "properties": {
                                                "attempts": {
                                                        "type": "integer",
                                                        "description": "Number of retry attempts"
                                                },
                                                "seconds": {
                                                        "type": "integer",
                                                        "description": "Seconds to wait between retries"
                                                }
                                        }
                                },
                                "exponential": {
                                        "type": "object",
                                        "description": "Retry with exponential backoff (delay doubles each time)",
                                        "properties": {
                                                "attempts": {
                                                        "type": "integer",
                                                        "description": "Number of retry attempts"
                                                },
                                                "multiplier": {
                                                        "type": "integer",
                                                        "description": "Multiplier for exponential backoff"
                                                },
                                                "seconds": {
                                                        "type": "integer",
                                                        "minimum": 1,
                                                        "description": "Initial delay in seconds"
                                                },
                                                "random_factor": {
                                                        "type": "integer",
                                                        "minimum": 0,
                                                        "maximum": 100,
                                                        "description": "Random jitter percentage (0-100) to avoid thundering herd"
                                                }
                                        }
                                },
                                "retry_if": {
                                        "type": "object",
                                        "description": "Conditional retry based on error or result",
                                        "properties": {
                                                "expr": {
                                                        "type": "string",
                                                        "description": "JavaScript expression that returns true to retry. Has access to 'result' and 'error' variables"
                                                }
                                        },
                                        "required": [
                                                "expr"
                                        ]
                                }
                        }
                },
                "no_flow_overlap": {
                        "type": "boolean",
                        "description": "If true, skip this schedule's execution if the previous run is still in progress (prevents concurrent runs)"
                },
                "summary": {
                        "type": "string",
                        "description": "Short summary describing the purpose of this schedule"
                },
                "description": {
                        "type": "string",
                        "description": "Detailed description of what this schedule does"
                },
                "tag": {
                        "type": "string",
                        "description": "Worker tag to route jobs to specific worker groups"
                },
                "paused_until": {
                        "type": "string",
                        "format": "date-time",
                        "description": "ISO 8601 datetime until which the schedule is paused. Schedule resumes automatically after this time"
                },
                "cron_version": {
                        "type": "string",
                        "description": "Cron parser version. Use 'v2' for extended syntax with additional features"
                },
                "dynamic_skip": {
                        "type": "string",
                        "description": "Path to a script that validates scheduled datetimes. Receives scheduled_for datetime and returns boolean to skip (true) or run (false)"
                }
        },
        "required": [
                "path",
                "schedule",
                "timezone",
                "script_path",
                "is_flow",
                "args"
        ]
}
    },
    {
        name: "updateSchedule",
        description: "update schedule",
        instructions: "Updates a schedule.\nThe schedule should include seconds.\nYou should get the schema of the script or flow before updating the schedule to correctly specify the arguments needed.\n",
        path: "/w/{workspace}/schedules/update/{path}",
        method: "POST",
        pathParamsSchema: {
        "type": "object",
        "properties": {
                "path": {
                        "type": "string"
                }
        },
        "required": [
                "path"
        ]
},
        queryParamsSchema: undefined,
        bodySchema: {
        "type": "object",
        "properties": {
                "schedule": {
                        "type": "string",
                        "description": "Cron expression with 6 fields (seconds, minutes, hours, day of month, month, day of week). Example '0 0 12 * * *' for daily at noon"
                },
                "timezone": {
                        "type": "string",
                        "description": "IANA timezone for the schedule (e.g., 'UTC', 'Europe/Paris', 'America/New_York')"
                },
                "args": {
                        "type": "object",
                        "description": "The arguments to pass to the script or flow",
                        "additionalProperties": {}
                },
                "on_failure": {
                        "type": "string",
                        "description": "Path to a script or flow to run when the scheduled job fails"
                },
                "on_failure_times": {
                        "type": "number",
                        "description": "Number of consecutive failures before the on_failure handler is triggered (default 1)"
                },
                "on_failure_exact": {
                        "type": "boolean",
                        "description": "If true, trigger on_failure handler only on exactly N failures, not on every failure after N"
                },
                "on_failure_extra_args": {
                        "type": "object",
                        "description": "The arguments to pass to the script or flow",
                        "additionalProperties": {}
                },
                "on_recovery": {
                        "type": "string",
                        "description": "Path to a script or flow to run when the schedule recovers after failures"
                },
                "on_recovery_times": {
                        "type": "number",
                        "description": "Number of consecutive successes before the on_recovery handler is triggered (default 1)"
                },
                "on_recovery_extra_args": {
                        "type": "object",
                        "description": "The arguments to pass to the script or flow",
                        "additionalProperties": {}
                },
                "on_success": {
                        "type": "string",
                        "description": "Path to a script or flow to run after each successful execution"
                },
                "on_success_extra_args": {
                        "type": "object",
                        "description": "The arguments to pass to the script or flow",
                        "additionalProperties": {}
                },
                "ws_error_handler_muted": {
                        "type": "boolean",
                        "description": "If true, the workspace-level error handler will not be triggered for this schedule's failures"
                },
                "retry": {
                        "type": "object",
                        "description": "Retry configuration for failed module executions",
                        "properties": {
                                "constant": {
                                        "type": "object",
                                        "description": "Retry with constant delay between attempts",
                                        "properties": {
                                                "attempts": {
                                                        "type": "integer",
                                                        "description": "Number of retry attempts"
                                                },
                                                "seconds": {
                                                        "type": "integer",
                                                        "description": "Seconds to wait between retries"
                                                }
                                        }
                                },
                                "exponential": {
                                        "type": "object",
                                        "description": "Retry with exponential backoff (delay doubles each time)",
                                        "properties": {
                                                "attempts": {
                                                        "type": "integer",
                                                        "description": "Number of retry attempts"
                                                },
                                                "multiplier": {
                                                        "type": "integer",
                                                        "description": "Multiplier for exponential backoff"
                                                },
                                                "seconds": {
                                                        "type": "integer",
                                                        "minimum": 1,
                                                        "description": "Initial delay in seconds"
                                                },
                                                "random_factor": {
                                                        "type": "integer",
                                                        "minimum": 0,
                                                        "maximum": 100,
                                                        "description": "Random jitter percentage (0-100) to avoid thundering herd"
                                                }
                                        }
                                },
                                "retry_if": {
                                        "type": "object",
                                        "description": "Conditional retry based on error or result",
                                        "properties": {
                                                "expr": {
                                                        "type": "string",
                                                        "description": "JavaScript expression that returns true to retry. Has access to 'result' and 'error' variables"
                                                }
                                        },
                                        "required": [
                                                "expr"
                                        ]
                                }
                        }
                },
                "no_flow_overlap": {
                        "type": "boolean",
                        "description": "If true, skip this schedule's execution if the previous run is still in progress (prevents concurrent runs)"
                },
                "summary": {
                        "type": "string",
                        "description": "Short summary describing the purpose of this schedule"
                },
                "description": {
                        "type": "string",
                        "description": "Detailed description of what this schedule does"
                },
                "tag": {
                        "type": "string",
                        "description": "Worker tag to route jobs to specific worker groups"
                },
                "paused_until": {
                        "type": "string",
                        "format": "date-time",
                        "description": "ISO 8601 datetime until which the schedule is paused. Schedule resumes automatically after this time"
                },
                "cron_version": {
                        "type": "string",
                        "description": "Cron parser version. Use 'v2' for extended syntax with additional features"
                },
                "dynamic_skip": {
                        "type": "string",
                        "description": "Path to a script that validates scheduled datetimes. Receives scheduled_for datetime and returns boolean to skip (true) or run (false)"
                }
        },
        "required": [
                "schedule",
                "timezone",
                "args"
        ]
}
    },
    {
        name: "deleteSchedule",
        description: "delete schedule",
        instructions: "",
        path: "/w/{workspace}/schedules/delete/{path}",
        method: "DELETE",
        pathParamsSchema: {
        "type": "object",
        "properties": {
                "path": {
                        "type": "string"
                }
        },
        "required": [
                "path"
        ]
},
        queryParamsSchema: undefined,
        bodySchema: undefined
    },
    {
        name: "getSchedule",
        description: "get schedule",
        instructions: "",
        path: "/w/{workspace}/schedules/get/{path}",
        method: "GET",
        pathParamsSchema: {
        "type": "object",
        "properties": {
                "path": {
                        "type": "string"
                }
        },
        "required": [
                "path"
        ]
},
        queryParamsSchema: undefined,
        bodySchema: undefined
    },
    {
        name: "listSchedules",
        description: "list schedules",
        instructions: "",
        path: "/w/{workspace}/schedules/list",
        method: "GET",
        pathParamsSchema: undefined,
        queryParamsSchema: {
        "type": "object",
        "properties": {
                "page": {
                        "type": "integer",
                        "description": "which page to return (start at 1, default 1)"
                },
                "per_page": {
                        "type": "integer",
                        "description": "number of items to return for a given page (default 30, max 100)"
                },
                "args": {
                        "type": "string",
                        "description": "filter on jobs containing those args as a json subset (@> in postgres)"
                },
                "path": {
                        "type": "string",
                        "description": "filter by path"
                },
                "is_flow": {
                        "type": "boolean",
                        "description": "filter schedules by whether they target a flow"
                },
                "path_start": {
                        "type": "string",
                        "description": "filter schedules by path prefix"
                }
        },
        "required": []
},
        bodySchema: undefined
    },
    {
        name: "listWorkers",
        description: "list workers",
        instructions: "",
        path: "/workers/list",
        method: "GET",
        pathParamsSchema: undefined,
        queryParamsSchema: {
        "type": "object",
        "properties": {
                "page": {
                        "type": "integer",
                        "description": "which page to return (start at 1, default 1)"
                },
                "per_page": {
                        "type": "integer",
                        "description": "number of items to return for a given page (default 30, max 100)"
                },
                "ping_since": {
                        "type": "integer",
                        "description": "number of seconds the worker must have had a last ping more recent of (default to 300)"
                }
        },
        "required": []
},
        bodySchema: undefined
    }
];
